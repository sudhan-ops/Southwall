var hR=Object.defineProperty;var fR=(n,e,t)=>e in n?hR(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var xe=(n,e,t)=>fR(n,typeof e!="symbol"?e+"":e,t);function ST(n,e){for(var t=0;t<e.length;t++){const s=e[t];if(typeof s!="string"&&!Array.isArray(s)){for(const r in s)if(r!=="default"&&!(r in n)){const i=Object.getOwnPropertyDescriptor(s,r);i&&Object.defineProperty(n,r,i.get?i:{enumerable:!0,get:()=>s[r]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();var NT=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jp(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function g0(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function s(){return this instanceof s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(s){var r=Object.getOwnPropertyDescriptor(n,s);Object.defineProperty(t,s,r.get?r:{enumerable:!0,get:function(){return n[s]}})}),t}var jT={exports:{}},Qp={},CT={exports:{}},vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var vh=Symbol.for("react.element"),mR=Symbol.for("react.portal"),pR=Symbol.for("react.fragment"),gR=Symbol.for("react.strict_mode"),yR=Symbol.for("react.profiler"),xR=Symbol.for("react.provider"),vR=Symbol.for("react.context"),bR=Symbol.for("react.forward_ref"),wR=Symbol.for("react.suspense"),_R=Symbol.for("react.memo"),SR=Symbol.for("react.lazy"),zS=Symbol.iterator;function NR(n){return n===null||typeof n!="object"?null:(n=zS&&n[zS]||n["@@iterator"],typeof n=="function"?n:null)}var kT={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},TT=Object.assign,ET={};function od(n,e,t){this.props=n,this.context=e,this.refs=ET,this.updater=t||kT}od.prototype.isReactComponent={};od.prototype.setState=function(n,e){if(typeof n!="object"&&typeof n!="function"&&n!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,n,e,"setState")};od.prototype.forceUpdate=function(n){this.updater.enqueueForceUpdate(this,n,"forceUpdate")};function PT(){}PT.prototype=od.prototype;function y0(n,e,t){this.props=n,this.context=e,this.refs=ET,this.updater=t||kT}var x0=y0.prototype=new PT;x0.constructor=y0;TT(x0,od.prototype);x0.isPureReactComponent=!0;var US=Array.isArray,MT=Object.prototype.hasOwnProperty,v0={current:null},DT={key:!0,ref:!0,__self:!0,__source:!0};function AT(n,e,t){var s,r={},i=null,o=null;if(e!=null)for(s in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)MT.call(e,s)&&!DT.hasOwnProperty(s)&&(r[s]=e[s]);var l=arguments.length-2;if(l===1)r.children=t;else if(1<l){for(var c=Array(l),d=0;d<l;d++)c[d]=arguments[d+2];r.children=c}if(n&&n.defaultProps)for(s in l=n.defaultProps,l)r[s]===void 0&&(r[s]=l[s]);return{$$typeof:vh,type:n,key:i,ref:o,props:r,_owner:v0.current}}function jR(n,e){return{$$typeof:vh,type:n.type,key:e,ref:n.ref,props:n.props,_owner:n._owner}}function b0(n){return typeof n=="object"&&n!==null&&n.$$typeof===vh}function CR(n){var e={"=":"=0",":":"=2"};return"$"+n.replace(/[=:]/g,function(t){return e[t]})}var VS=/\/+/g;function Ty(n,e){return typeof n=="object"&&n!==null&&n.key!=null?CR(""+n.key):e.toString(36)}function dm(n,e,t,s,r){var i=typeof n;(i==="undefined"||i==="boolean")&&(n=null);var o=!1;if(n===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(n.$$typeof){case vh:case mR:o=!0}}if(o)return o=n,r=r(o),n=s===""?"."+Ty(o,0):s,US(r)?(t="",n!=null&&(t=n.replace(VS,"$&/")+"/"),dm(r,e,t,"",function(d){return d})):r!=null&&(b0(r)&&(r=jR(r,t+(!r.key||o&&o.key===r.key?"":(""+r.key).replace(VS,"$&/")+"/")+n)),e.push(r)),1;if(o=0,s=s===""?".":s+":",US(n))for(var l=0;l<n.length;l++){i=n[l];var c=s+Ty(i,l);o+=dm(i,e,t,c,r)}else if(c=NR(n),typeof c=="function")for(n=c.call(n),l=0;!(i=n.next()).done;)i=i.value,c=s+Ty(i,l++),o+=dm(i,e,t,c,r);else if(i==="object")throw e=String(n),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(n).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function of(n,e,t){if(n==null)return n;var s=[],r=0;return dm(n,s,"","",function(i){return e.call(t,i,r++)}),s}function kR(n){if(n._status===-1){var e=n._result;e=e(),e.then(function(t){(n._status===0||n._status===-1)&&(n._status=1,n._result=t)},function(t){(n._status===0||n._status===-1)&&(n._status=2,n._result=t)}),n._status===-1&&(n._status=0,n._result=e)}if(n._status===1)return n._result.default;throw n._result}var _s={current:null},um={transition:null},TR={ReactCurrentDispatcher:_s,ReactCurrentBatchConfig:um,ReactCurrentOwner:v0};function IT(){throw Error("act(...) is not supported in production builds of React.")}vt.Children={map:of,forEach:function(n,e,t){of(n,function(){e.apply(this,arguments)},t)},count:function(n){var e=0;return of(n,function(){e++}),e},toArray:function(n){return of(n,function(e){return e})||[]},only:function(n){if(!b0(n))throw Error("React.Children.only expected to receive a single React element child.");return n}};vt.Component=od;vt.Fragment=pR;vt.Profiler=yR;vt.PureComponent=y0;vt.StrictMode=gR;vt.Suspense=wR;vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=TR;vt.act=IT;vt.cloneElement=function(n,e,t){if(n==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+n+".");var s=TT({},n.props),r=n.key,i=n.ref,o=n._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=v0.current),e.key!==void 0&&(r=""+e.key),n.type&&n.type.defaultProps)var l=n.type.defaultProps;for(c in e)MT.call(e,c)&&!DT.hasOwnProperty(c)&&(s[c]=e[c]===void 0&&l!==void 0?l[c]:e[c])}var c=arguments.length-2;if(c===1)s.children=t;else if(1<c){l=Array(c);for(var d=0;d<c;d++)l[d]=arguments[d+2];s.children=l}return{$$typeof:vh,type:n.type,key:r,ref:i,props:s,_owner:o}};vt.createContext=function(n){return n={$$typeof:vR,_currentValue:n,_currentValue2:n,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},n.Provider={$$typeof:xR,_context:n},n.Consumer=n};vt.createElement=AT;vt.createFactory=function(n){var e=AT.bind(null,n);return e.type=n,e};vt.createRef=function(){return{current:null}};vt.forwardRef=function(n){return{$$typeof:bR,render:n}};vt.isValidElement=b0;vt.lazy=function(n){return{$$typeof:SR,_payload:{_status:-1,_result:n},_init:kR}};vt.memo=function(n,e){return{$$typeof:_R,type:n,compare:e===void 0?null:e}};vt.startTransition=function(n){var e=um.transition;um.transition={};try{n()}finally{um.transition=e}};vt.unstable_act=IT;vt.useCallback=function(n,e){return _s.current.useCallback(n,e)};vt.useContext=function(n){return _s.current.useContext(n)};vt.useDebugValue=function(){};vt.useDeferredValue=function(n){return _s.current.useDeferredValue(n)};vt.useEffect=function(n,e){return _s.current.useEffect(n,e)};vt.useId=function(){return _s.current.useId()};vt.useImperativeHandle=function(n,e,t){return _s.current.useImperativeHandle(n,e,t)};vt.useInsertionEffect=function(n,e){return _s.current.useInsertionEffect(n,e)};vt.useLayoutEffect=function(n,e){return _s.current.useLayoutEffect(n,e)};vt.useMemo=function(n,e){return _s.current.useMemo(n,e)};vt.useReducer=function(n,e,t){return _s.current.useReducer(n,e,t)};vt.useRef=function(n){return _s.current.useRef(n)};vt.useState=function(n){return _s.current.useState(n)};vt.useSyncExternalStore=function(n,e,t){return _s.current.useSyncExternalStore(n,e,t)};vt.useTransition=function(){return _s.current.useTransition()};vt.version="18.3.1";CT.exports=vt;var C=CT.exports;const Fe=Jp(C),ER=ST({__proto__:null,default:Fe},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PR=C,MR=Symbol.for("react.element"),DR=Symbol.for("react.fragment"),AR=Object.prototype.hasOwnProperty,IR=PR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,OR={key:!0,ref:!0,__self:!0,__source:!0};function OT(n,e,t){var s,r={},i=null,o=null;t!==void 0&&(i=""+t),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(s in e)AR.call(e,s)&&!OR.hasOwnProperty(s)&&(r[s]=e[s]);if(n&&n.defaultProps)for(s in e=n.defaultProps,e)r[s]===void 0&&(r[s]=e[s]);return{$$typeof:MR,type:n,key:i,ref:o,props:r,_owner:IR.current}}Qp.Fragment=DR;Qp.jsx=OT;Qp.jsxs=OT;jT.exports=Qp;var a=jT.exports,Jx={},RT={exports:{}},lr={},LT={exports:{}},FT={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(n){function e(B,q){var Q=B.length;B.push(q);e:for(;0<Q;){var le=Q-1>>>1,X=B[le];if(0<r(X,q))B[le]=q,B[Q]=X,Q=le;else break e}}function t(B){return B.length===0?null:B[0]}function s(B){if(B.length===0)return null;var q=B[0],Q=B.pop();if(Q!==q){B[0]=Q;e:for(var le=0,X=B.length,Z=X>>>1;le<Z;){var se=2*(le+1)-1,G=B[se],ne=se+1,ge=B[ne];if(0>r(G,Q))ne<X&&0>r(ge,G)?(B[le]=ge,B[ne]=Q,le=ne):(B[le]=G,B[se]=Q,le=se);else if(ne<X&&0>r(ge,Q))B[le]=ge,B[ne]=Q,le=ne;else break e}}return q}function r(B,q){var Q=B.sortIndex-q.sortIndex;return Q!==0?Q:B.id-q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;n.unstable_now=function(){return i.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,f=null,p=3,g=!1,b=!1,v=!1,_=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,j=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function k(B){for(var q=t(d);q!==null;){if(q.callback===null)s(d);else if(q.startTime<=B)s(d),q.sortIndex=q.expirationTime,e(c,q);else break;q=t(d)}}function S(B){if(v=!1,k(B),!b)if(t(c)!==null)b=!0,U(P);else{var q=t(d);q!==null&&W(S,q.startTime-B)}}function P(B,q){b=!1,v&&(v=!1,N(I),I=-1),g=!0;var Q=p;try{for(k(q),f=t(c);f!==null&&(!(f.expirationTime>q)||B&&!z());){var le=f.callback;if(typeof le=="function"){f.callback=null,p=f.priorityLevel;var X=le(f.expirationTime<=q);q=n.unstable_now(),typeof X=="function"?f.callback=X:f===t(c)&&s(c),k(q)}else s(c);f=t(c)}if(f!==null)var Z=!0;else{var se=t(d);se!==null&&W(S,se.startTime-q),Z=!1}return Z}finally{f=null,p=Q,g=!1}}var E=!1,M=null,I=-1,O=5,D=-1;function z(){return!(n.unstable_now()-D<O)}function H(){if(M!==null){var B=n.unstable_now();D=B;var q=!0;try{q=M(!0,B)}finally{q?F():(E=!1,M=null)}}else E=!1}var F;if(typeof j=="function")F=function(){j(H)};else if(typeof MessageChannel<"u"){var R=new MessageChannel,V=R.port2;R.port1.onmessage=H,F=function(){V.postMessage(null)}}else F=function(){_(H,0)};function U(B){M=B,E||(E=!0,F())}function W(B,q){I=_(function(){B(n.unstable_now())},q)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function(B){B.callback=null},n.unstable_continueExecution=function(){b||g||(b=!0,U(P))},n.unstable_forceFrameRate=function(B){0>B||125<B?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):O=0<B?Math.floor(1e3/B):5},n.unstable_getCurrentPriorityLevel=function(){return p},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function(B){switch(p){case 1:case 2:case 3:var q=3;break;default:q=p}var Q=p;p=q;try{return B()}finally{p=Q}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function(B,q){switch(B){case 1:case 2:case 3:case 4:case 5:break;default:B=3}var Q=p;p=B;try{return q()}finally{p=Q}},n.unstable_scheduleCallback=function(B,q,Q){var le=n.unstable_now();switch(typeof Q=="object"&&Q!==null?(Q=Q.delay,Q=typeof Q=="number"&&0<Q?le+Q:le):Q=le,B){case 1:var X=-1;break;case 2:X=250;break;case 5:X=1073741823;break;case 4:X=1e4;break;default:X=5e3}return X=Q+X,B={id:h++,callback:q,priorityLevel:B,startTime:Q,expirationTime:X,sortIndex:-1},Q>le?(B.sortIndex=Q,e(d,B),t(c)===null&&B===t(d)&&(v?(N(I),I=-1):v=!0,W(S,Q-le))):(B.sortIndex=X,e(c,B),b||g||(b=!0,U(P))),B},n.unstable_shouldYield=z,n.unstable_wrapCallback=function(B){var q=p;return function(){var Q=p;p=q;try{return B.apply(this,arguments)}finally{p=Q}}}})(FT);LT.exports=FT;var RR=LT.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var LR=C,ar=RR;function ke(n){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+n,t=1;t<arguments.length;t++)e+="&args[]="+encodeURIComponent(arguments[t]);return"Minified React error #"+n+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var $T=new Set,Ru={};function jl(n,e){$c(n,e),$c(n+"Capture",e)}function $c(n,e){for(Ru[n]=e,n=0;n<e.length;n++)$T.add(e[n])}var na=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Qx=Object.prototype.hasOwnProperty,FR=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,BS={},qS={};function $R(n){return Qx.call(qS,n)?!0:Qx.call(BS,n)?!1:FR.test(n)?qS[n]=!0:(BS[n]=!0,!1)}function zR(n,e,t,s){if(t!==null&&t.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return s?!1:t!==null?!t.acceptsBooleans:(n=n.toLowerCase().slice(0,5),n!=="data-"&&n!=="aria-");default:return!1}}function UR(n,e,t,s){if(e===null||typeof e>"u"||zR(n,e,t,s))return!0;if(s)return!1;if(t!==null)switch(t.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ss(n,e,t,s,r,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=s,this.attributeNamespace=r,this.mustUseProperty=t,this.propertyName=n,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Qn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(n){Qn[n]=new Ss(n,0,!1,n,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(n){var e=n[0];Qn[e]=new Ss(e,1,!1,n[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(n){Qn[n]=new Ss(n,2,!1,n.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(n){Qn[n]=new Ss(n,2,!1,n,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(n){Qn[n]=new Ss(n,3,!1,n.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(n){Qn[n]=new Ss(n,3,!0,n,null,!1,!1)});["capture","download"].forEach(function(n){Qn[n]=new Ss(n,4,!1,n,null,!1,!1)});["cols","rows","size","span"].forEach(function(n){Qn[n]=new Ss(n,6,!1,n,null,!1,!1)});["rowSpan","start"].forEach(function(n){Qn[n]=new Ss(n,5,!1,n.toLowerCase(),null,!1,!1)});var w0=/[\-:]([a-z])/g;function _0(n){return n[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(n){var e=n.replace(w0,_0);Qn[e]=new Ss(e,1,!1,n,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(n){var e=n.replace(w0,_0);Qn[e]=new Ss(e,1,!1,n,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(n){var e=n.replace(w0,_0);Qn[e]=new Ss(e,1,!1,n,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(n){Qn[n]=new Ss(n,1,!1,n.toLowerCase(),null,!1,!1)});Qn.xlinkHref=new Ss("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(n){Qn[n]=new Ss(n,1,!1,n.toLowerCase(),null,!0,!0)});function S0(n,e,t,s){var r=Qn.hasOwnProperty(e)?Qn[e]:null;(r!==null?r.type!==0:s||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(UR(e,t,r,s)&&(t=null),s||r===null?$R(e)&&(t===null?n.removeAttribute(e):n.setAttribute(e,""+t)):r.mustUseProperty?n[r.propertyName]=t===null?r.type===3?!1:"":t:(e=r.attributeName,s=r.attributeNamespace,t===null?n.removeAttribute(e):(r=r.type,t=r===3||r===4&&t===!0?"":""+t,s?n.setAttributeNS(s,e,t):n.setAttribute(e,t))))}var fa=LR.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,lf=Symbol.for("react.element"),uc=Symbol.for("react.portal"),hc=Symbol.for("react.fragment"),N0=Symbol.for("react.strict_mode"),Xx=Symbol.for("react.profiler"),zT=Symbol.for("react.provider"),UT=Symbol.for("react.context"),j0=Symbol.for("react.forward_ref"),ev=Symbol.for("react.suspense"),tv=Symbol.for("react.suspense_list"),C0=Symbol.for("react.memo"),Ca=Symbol.for("react.lazy"),VT=Symbol.for("react.offscreen"),HS=Symbol.iterator;function Ad(n){return n===null||typeof n!="object"?null:(n=HS&&n[HS]||n["@@iterator"],typeof n=="function"?n:null)}var pn=Object.assign,Ey;function iu(n){if(Ey===void 0)try{throw Error()}catch(t){var e=t.stack.trim().match(/\n( *(at )?)/);Ey=e&&e[1]||""}return`
`+Ey+n}var Py=!1;function My(n,e){if(!n||Py)return"";Py=!0;var t=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(d){var s=d}Reflect.construct(n,[],e)}else{try{e.call()}catch(d){s=d}n.call(e.prototype)}else{try{throw Error()}catch(d){s=d}n()}}catch(d){if(d&&s&&typeof d.stack=="string"){for(var r=d.stack.split(`
`),i=s.stack.split(`
`),o=r.length-1,l=i.length-1;1<=o&&0<=l&&r[o]!==i[l];)l--;for(;1<=o&&0<=l;o--,l--)if(r[o]!==i[l]){if(o!==1||l!==1)do if(o--,l--,0>l||r[o]!==i[l]){var c=`
`+r[o].replace(" at new "," at ");return n.displayName&&c.includes("<anonymous>")&&(c=c.replace("<anonymous>",n.displayName)),c}while(1<=o&&0<=l);break}}}finally{Py=!1,Error.prepareStackTrace=t}return(n=n?n.displayName||n.name:"")?iu(n):""}function VR(n){switch(n.tag){case 5:return iu(n.type);case 16:return iu("Lazy");case 13:return iu("Suspense");case 19:return iu("SuspenseList");case 0:case 2:case 15:return n=My(n.type,!1),n;case 11:return n=My(n.type.render,!1),n;case 1:return n=My(n.type,!0),n;default:return""}}function nv(n){if(n==null)return null;if(typeof n=="function")return n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case hc:return"Fragment";case uc:return"Portal";case Xx:return"Profiler";case N0:return"StrictMode";case ev:return"Suspense";case tv:return"SuspenseList"}if(typeof n=="object")switch(n.$$typeof){case UT:return(n.displayName||"Context")+".Consumer";case zT:return(n._context.displayName||"Context")+".Provider";case j0:var e=n.render;return n=n.displayName,n||(n=e.displayName||e.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case C0:return e=n.displayName||null,e!==null?e:nv(n.type)||"Memo";case Ca:e=n._payload,n=n._init;try{return nv(n(e))}catch{}}return null}function BR(n){var e=n.type;switch(n.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return n=e.render,n=n.displayName||n.name||"",e.displayName||(n!==""?"ForwardRef("+n+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return nv(e);case 8:return e===N0?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Qa(n){switch(typeof n){case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function BT(n){var e=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qR(n){var e=BT(n)?"checked":"value",t=Object.getOwnPropertyDescriptor(n.constructor.prototype,e),s=""+n[e];if(!n.hasOwnProperty(e)&&typeof t<"u"&&typeof t.get=="function"&&typeof t.set=="function"){var r=t.get,i=t.set;return Object.defineProperty(n,e,{configurable:!0,get:function(){return r.call(this)},set:function(o){s=""+o,i.call(this,o)}}),Object.defineProperty(n,e,{enumerable:t.enumerable}),{getValue:function(){return s},setValue:function(o){s=""+o},stopTracking:function(){n._valueTracker=null,delete n[e]}}}}function cf(n){n._valueTracker||(n._valueTracker=qR(n))}function qT(n){if(!n)return!1;var e=n._valueTracker;if(!e)return!0;var t=e.getValue(),s="";return n&&(s=BT(n)?n.checked?"true":"false":n.value),n=s,n!==t?(e.setValue(n),!0):!1}function $m(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}function sv(n,e){var t=e.checked;return pn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:t??n._wrapperState.initialChecked})}function WS(n,e){var t=e.defaultValue==null?"":e.defaultValue,s=e.checked!=null?e.checked:e.defaultChecked;t=Qa(e.value!=null?e.value:t),n._wrapperState={initialChecked:s,initialValue:t,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function HT(n,e){e=e.checked,e!=null&&S0(n,"checked",e,!1)}function rv(n,e){HT(n,e);var t=Qa(e.value),s=e.type;if(t!=null)s==="number"?(t===0&&n.value===""||n.value!=t)&&(n.value=""+t):n.value!==""+t&&(n.value=""+t);else if(s==="submit"||s==="reset"){n.removeAttribute("value");return}e.hasOwnProperty("value")?iv(n,e.type,t):e.hasOwnProperty("defaultValue")&&iv(n,e.type,Qa(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(n.defaultChecked=!!e.defaultChecked)}function GS(n,e,t){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var s=e.type;if(!(s!=="submit"&&s!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+n._wrapperState.initialValue,t||e===n.value||(n.value=e),n.defaultValue=e}t=n.name,t!==""&&(n.name=""),n.defaultChecked=!!n._wrapperState.initialChecked,t!==""&&(n.name=t)}function iv(n,e,t){(e!=="number"||$m(n.ownerDocument)!==n)&&(t==null?n.defaultValue=""+n._wrapperState.initialValue:n.defaultValue!==""+t&&(n.defaultValue=""+t))}var au=Array.isArray;function kc(n,e,t,s){if(n=n.options,e){e={};for(var r=0;r<t.length;r++)e["$"+t[r]]=!0;for(t=0;t<n.length;t++)r=e.hasOwnProperty("$"+n[t].value),n[t].selected!==r&&(n[t].selected=r),r&&s&&(n[t].defaultSelected=!0)}else{for(t=""+Qa(t),e=null,r=0;r<n.length;r++){if(n[r].value===t){n[r].selected=!0,s&&(n[r].defaultSelected=!0);return}e!==null||n[r].disabled||(e=n[r])}e!==null&&(e.selected=!0)}}function av(n,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ke(91));return pn({},e,{value:void 0,defaultValue:void 0,children:""+n._wrapperState.initialValue})}function YS(n,e){var t=e.value;if(t==null){if(t=e.children,e=e.defaultValue,t!=null){if(e!=null)throw Error(ke(92));if(au(t)){if(1<t.length)throw Error(ke(93));t=t[0]}e=t}e==null&&(e=""),t=e}n._wrapperState={initialValue:Qa(t)}}function WT(n,e){var t=Qa(e.value),s=Qa(e.defaultValue);t!=null&&(t=""+t,t!==n.value&&(n.value=t),e.defaultValue==null&&n.defaultValue!==t&&(n.defaultValue=t)),s!=null&&(n.defaultValue=""+s)}function ZS(n){var e=n.textContent;e===n._wrapperState.initialValue&&e!==""&&e!==null&&(n.value=e)}function GT(n){switch(n){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function ov(n,e){return n==null||n==="http://www.w3.org/1999/xhtml"?GT(e):n==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":n}var df,YT=function(n){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,t,s,r){MSApp.execUnsafeLocalFunction(function(){return n(e,t,s,r)})}:n}(function(n,e){if(n.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in n)n.innerHTML=e;else{for(df=df||document.createElement("div"),df.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=df.firstChild;n.firstChild;)n.removeChild(n.firstChild);for(;e.firstChild;)n.appendChild(e.firstChild)}});function Lu(n,e){if(e){var t=n.firstChild;if(t&&t===n.lastChild&&t.nodeType===3){t.nodeValue=e;return}}n.textContent=e}var yu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},HR=["Webkit","ms","Moz","O"];Object.keys(yu).forEach(function(n){HR.forEach(function(e){e=e+n.charAt(0).toUpperCase()+n.substring(1),yu[e]=yu[n]})});function ZT(n,e,t){return e==null||typeof e=="boolean"||e===""?"":t||typeof e!="number"||e===0||yu.hasOwnProperty(n)&&yu[n]?(""+e).trim():e+"px"}function KT(n,e){n=n.style;for(var t in e)if(e.hasOwnProperty(t)){var s=t.indexOf("--")===0,r=ZT(t,e[t],s);t==="float"&&(t="cssFloat"),s?n.setProperty(t,r):n[t]=r}}var WR=pn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function lv(n,e){if(e){if(WR[n]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ke(137,n));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ke(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ke(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ke(62))}}function cv(n,e){if(n.indexOf("-")===-1)return typeof e.is=="string";switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var dv=null;function k0(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var uv=null,Tc=null,Ec=null;function KS(n){if(n=_h(n)){if(typeof uv!="function")throw Error(ke(280));var e=n.stateNode;e&&(e=sg(e),uv(n.stateNode,n.type,e))}}function JT(n){Tc?Ec?Ec.push(n):Ec=[n]:Tc=n}function QT(){if(Tc){var n=Tc,e=Ec;if(Ec=Tc=null,KS(n),e)for(n=0;n<e.length;n++)KS(e[n])}}function XT(n,e){return n(e)}function eE(){}var Dy=!1;function tE(n,e,t){if(Dy)return n(e,t);Dy=!0;try{return XT(n,e,t)}finally{Dy=!1,(Tc!==null||Ec!==null)&&(eE(),QT())}}function Fu(n,e){var t=n.stateNode;if(t===null)return null;var s=sg(t);if(s===null)return null;t=s[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(s=!s.disabled)||(n=n.type,s=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!s;break e;default:n=!1}if(n)return null;if(t&&typeof t!="function")throw Error(ke(231,e,typeof t));return t}var hv=!1;if(na)try{var Id={};Object.defineProperty(Id,"passive",{get:function(){hv=!0}}),window.addEventListener("test",Id,Id),window.removeEventListener("test",Id,Id)}catch{hv=!1}function GR(n,e,t,s,r,i,o,l,c){var d=Array.prototype.slice.call(arguments,3);try{e.apply(t,d)}catch(h){this.onError(h)}}var xu=!1,zm=null,Um=!1,fv=null,YR={onError:function(n){xu=!0,zm=n}};function ZR(n,e,t,s,r,i,o,l,c){xu=!1,zm=null,GR.apply(YR,arguments)}function KR(n,e,t,s,r,i,o,l,c){if(ZR.apply(this,arguments),xu){if(xu){var d=zm;xu=!1,zm=null}else throw Error(ke(198));Um||(Um=!0,fv=d)}}function Cl(n){var e=n,t=n;if(n.alternate)for(;e.return;)e=e.return;else{n=e;do e=n,e.flags&4098&&(t=e.return),n=e.return;while(n)}return e.tag===3?t:null}function nE(n){if(n.tag===13){var e=n.memoizedState;if(e===null&&(n=n.alternate,n!==null&&(e=n.memoizedState)),e!==null)return e.dehydrated}return null}function JS(n){if(Cl(n)!==n)throw Error(ke(188))}function JR(n){var e=n.alternate;if(!e){if(e=Cl(n),e===null)throw Error(ke(188));return e!==n?null:n}for(var t=n,s=e;;){var r=t.return;if(r===null)break;var i=r.alternate;if(i===null){if(s=r.return,s!==null){t=s;continue}break}if(r.child===i.child){for(i=r.child;i;){if(i===t)return JS(r),n;if(i===s)return JS(r),e;i=i.sibling}throw Error(ke(188))}if(t.return!==s.return)t=r,s=i;else{for(var o=!1,l=r.child;l;){if(l===t){o=!0,t=r,s=i;break}if(l===s){o=!0,s=r,t=i;break}l=l.sibling}if(!o){for(l=i.child;l;){if(l===t){o=!0,t=i,s=r;break}if(l===s){o=!0,s=i,t=r;break}l=l.sibling}if(!o)throw Error(ke(189))}}if(t.alternate!==s)throw Error(ke(190))}if(t.tag!==3)throw Error(ke(188));return t.stateNode.current===t?n:e}function sE(n){return n=JR(n),n!==null?rE(n):null}function rE(n){if(n.tag===5||n.tag===6)return n;for(n=n.child;n!==null;){var e=rE(n);if(e!==null)return e;n=n.sibling}return null}var iE=ar.unstable_scheduleCallback,QS=ar.unstable_cancelCallback,QR=ar.unstable_shouldYield,XR=ar.unstable_requestPaint,wn=ar.unstable_now,eL=ar.unstable_getCurrentPriorityLevel,T0=ar.unstable_ImmediatePriority,aE=ar.unstable_UserBlockingPriority,Vm=ar.unstable_NormalPriority,tL=ar.unstable_LowPriority,oE=ar.unstable_IdlePriority,Xp=null,_i=null;function nL(n){if(_i&&typeof _i.onCommitFiberRoot=="function")try{_i.onCommitFiberRoot(Xp,n,void 0,(n.current.flags&128)===128)}catch{}}var Br=Math.clz32?Math.clz32:iL,sL=Math.log,rL=Math.LN2;function iL(n){return n>>>=0,n===0?32:31-(sL(n)/rL|0)|0}var uf=64,hf=4194304;function ou(n){switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return n&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return n}}function Bm(n,e){var t=n.pendingLanes;if(t===0)return 0;var s=0,r=n.suspendedLanes,i=n.pingedLanes,o=t&268435455;if(o!==0){var l=o&~r;l!==0?s=ou(l):(i&=o,i!==0&&(s=ou(i)))}else o=t&~r,o!==0?s=ou(o):i!==0&&(s=ou(i));if(s===0)return 0;if(e!==0&&e!==s&&!(e&r)&&(r=s&-s,i=e&-e,r>=i||r===16&&(i&4194240)!==0))return e;if(s&4&&(s|=t&16),e=n.entangledLanes,e!==0)for(n=n.entanglements,e&=s;0<e;)t=31-Br(e),r=1<<t,s|=n[t],e&=~r;return s}function aL(n,e){switch(n){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function oL(n,e){for(var t=n.suspendedLanes,s=n.pingedLanes,r=n.expirationTimes,i=n.pendingLanes;0<i;){var o=31-Br(i),l=1<<o,c=r[o];c===-1?(!(l&t)||l&s)&&(r[o]=aL(l,e)):c<=e&&(n.expiredLanes|=l),i&=~l}}function mv(n){return n=n.pendingLanes&-1073741825,n!==0?n:n&1073741824?1073741824:0}function lE(){var n=uf;return uf<<=1,!(uf&4194240)&&(uf=64),n}function Ay(n){for(var e=[],t=0;31>t;t++)e.push(n);return e}function bh(n,e,t){n.pendingLanes|=e,e!==536870912&&(n.suspendedLanes=0,n.pingedLanes=0),n=n.eventTimes,e=31-Br(e),n[e]=t}function lL(n,e){var t=n.pendingLanes&~e;n.pendingLanes=e,n.suspendedLanes=0,n.pingedLanes=0,n.expiredLanes&=e,n.mutableReadLanes&=e,n.entangledLanes&=e,e=n.entanglements;var s=n.eventTimes;for(n=n.expirationTimes;0<t;){var r=31-Br(t),i=1<<r;e[r]=0,s[r]=-1,n[r]=-1,t&=~i}}function E0(n,e){var t=n.entangledLanes|=e;for(n=n.entanglements;t;){var s=31-Br(t),r=1<<s;r&e|n[s]&e&&(n[s]|=e),t&=~r}}var Ot=0;function cE(n){return n&=-n,1<n?4<n?n&268435455?16:536870912:4:1}var dE,P0,uE,hE,fE,pv=!1,ff=[],Ua=null,Va=null,Ba=null,$u=new Map,zu=new Map,Ea=[],cL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function XS(n,e){switch(n){case"focusin":case"focusout":Ua=null;break;case"dragenter":case"dragleave":Va=null;break;case"mouseover":case"mouseout":Ba=null;break;case"pointerover":case"pointerout":$u.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":zu.delete(e.pointerId)}}function Od(n,e,t,s,r,i){return n===null||n.nativeEvent!==i?(n={blockedOn:e,domEventName:t,eventSystemFlags:s,nativeEvent:i,targetContainers:[r]},e!==null&&(e=_h(e),e!==null&&P0(e)),n):(n.eventSystemFlags|=s,e=n.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),n)}function dL(n,e,t,s,r){switch(e){case"focusin":return Ua=Od(Ua,n,e,t,s,r),!0;case"dragenter":return Va=Od(Va,n,e,t,s,r),!0;case"mouseover":return Ba=Od(Ba,n,e,t,s,r),!0;case"pointerover":var i=r.pointerId;return $u.set(i,Od($u.get(i)||null,n,e,t,s,r)),!0;case"gotpointercapture":return i=r.pointerId,zu.set(i,Od(zu.get(i)||null,n,e,t,s,r)),!0}return!1}function mE(n){var e=Qo(n.target);if(e!==null){var t=Cl(e);if(t!==null){if(e=t.tag,e===13){if(e=nE(t),e!==null){n.blockedOn=e,fE(n.priority,function(){uE(t)});return}}else if(e===3&&t.stateNode.current.memoizedState.isDehydrated){n.blockedOn=t.tag===3?t.stateNode.containerInfo:null;return}}}n.blockedOn=null}function hm(n){if(n.blockedOn!==null)return!1;for(var e=n.targetContainers;0<e.length;){var t=gv(n.domEventName,n.eventSystemFlags,e[0],n.nativeEvent);if(t===null){t=n.nativeEvent;var s=new t.constructor(t.type,t);dv=s,t.target.dispatchEvent(s),dv=null}else return e=_h(t),e!==null&&P0(e),n.blockedOn=t,!1;e.shift()}return!0}function eN(n,e,t){hm(n)&&t.delete(e)}function uL(){pv=!1,Ua!==null&&hm(Ua)&&(Ua=null),Va!==null&&hm(Va)&&(Va=null),Ba!==null&&hm(Ba)&&(Ba=null),$u.forEach(eN),zu.forEach(eN)}function Rd(n,e){n.blockedOn===e&&(n.blockedOn=null,pv||(pv=!0,ar.unstable_scheduleCallback(ar.unstable_NormalPriority,uL)))}function Uu(n){function e(r){return Rd(r,n)}if(0<ff.length){Rd(ff[0],n);for(var t=1;t<ff.length;t++){var s=ff[t];s.blockedOn===n&&(s.blockedOn=null)}}for(Ua!==null&&Rd(Ua,n),Va!==null&&Rd(Va,n),Ba!==null&&Rd(Ba,n),$u.forEach(e),zu.forEach(e),t=0;t<Ea.length;t++)s=Ea[t],s.blockedOn===n&&(s.blockedOn=null);for(;0<Ea.length&&(t=Ea[0],t.blockedOn===null);)mE(t),t.blockedOn===null&&Ea.shift()}var Pc=fa.ReactCurrentBatchConfig,qm=!0;function hL(n,e,t,s){var r=Ot,i=Pc.transition;Pc.transition=null;try{Ot=1,M0(n,e,t,s)}finally{Ot=r,Pc.transition=i}}function fL(n,e,t,s){var r=Ot,i=Pc.transition;Pc.transition=null;try{Ot=4,M0(n,e,t,s)}finally{Ot=r,Pc.transition=i}}function M0(n,e,t,s){if(qm){var r=gv(n,e,t,s);if(r===null)By(n,e,s,Hm,t),XS(n,s);else if(dL(r,n,e,t,s))s.stopPropagation();else if(XS(n,s),e&4&&-1<cL.indexOf(n)){for(;r!==null;){var i=_h(r);if(i!==null&&dE(i),i=gv(n,e,t,s),i===null&&By(n,e,s,Hm,t),i===r)break;r=i}r!==null&&s.stopPropagation()}else By(n,e,s,null,t)}}var Hm=null;function gv(n,e,t,s){if(Hm=null,n=k0(s),n=Qo(n),n!==null)if(e=Cl(n),e===null)n=null;else if(t=e.tag,t===13){if(n=nE(e),n!==null)return n;n=null}else if(t===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;n=null}else e!==n&&(n=null);return Hm=n,null}function pE(n){switch(n){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(eL()){case T0:return 1;case aE:return 4;case Vm:case tL:return 16;case oE:return 536870912;default:return 16}default:return 16}}var Da=null,D0=null,fm=null;function gE(){if(fm)return fm;var n,e=D0,t=e.length,s,r="value"in Da?Da.value:Da.textContent,i=r.length;for(n=0;n<t&&e[n]===r[n];n++);var o=t-n;for(s=1;s<=o&&e[t-s]===r[i-s];s++);return fm=r.slice(n,1<s?1-s:void 0)}function mm(n){var e=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&e===13&&(n=13)):n=e,n===10&&(n=13),32<=n||n===13?n:0}function mf(){return!0}function tN(){return!1}function cr(n){function e(t,s,r,i,o){this._reactName=t,this._targetInst=r,this.type=s,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var l in n)n.hasOwnProperty(l)&&(t=n[l],this[l]=t?t(i):i[l]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?mf:tN,this.isPropagationStopped=tN,this}return pn(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():typeof t.returnValue!="unknown"&&(t.returnValue=!1),this.isDefaultPrevented=mf)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():typeof t.cancelBubble!="unknown"&&(t.cancelBubble=!0),this.isPropagationStopped=mf)},persist:function(){},isPersistent:mf}),e}var ld={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},A0=cr(ld),wh=pn({},ld,{view:0,detail:0}),mL=cr(wh),Iy,Oy,Ld,eg=pn({},wh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:I0,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==Ld&&(Ld&&n.type==="mousemove"?(Iy=n.screenX-Ld.screenX,Oy=n.screenY-Ld.screenY):Oy=Iy=0,Ld=n),Iy)},movementY:function(n){return"movementY"in n?n.movementY:Oy}}),nN=cr(eg),pL=pn({},eg,{dataTransfer:0}),gL=cr(pL),yL=pn({},wh,{relatedTarget:0}),Ry=cr(yL),xL=pn({},ld,{animationName:0,elapsedTime:0,pseudoElement:0}),vL=cr(xL),bL=pn({},ld,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),wL=cr(bL),_L=pn({},ld,{data:0}),sN=cr(_L),SL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},NL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},jL={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function CL(n){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(n):(n=jL[n])?!!e[n]:!1}function I0(){return CL}var kL=pn({},wh,{key:function(n){if(n.key){var e=SL[n.key]||n.key;if(e!=="Unidentified")return e}return n.type==="keypress"?(n=mm(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?NL[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:I0,charCode:function(n){return n.type==="keypress"?mm(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?mm(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),TL=cr(kL),EL=pn({},eg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rN=cr(EL),PL=pn({},wh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:I0}),ML=cr(PL),DL=pn({},ld,{propertyName:0,elapsedTime:0,pseudoElement:0}),AL=cr(DL),IL=pn({},eg,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),OL=cr(IL),RL=[9,13,27,32],O0=na&&"CompositionEvent"in window,vu=null;na&&"documentMode"in document&&(vu=document.documentMode);var LL=na&&"TextEvent"in window&&!vu,yE=na&&(!O0||vu&&8<vu&&11>=vu),iN=" ",aN=!1;function xE(n,e){switch(n){case"keyup":return RL.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function vE(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var fc=!1;function FL(n,e){switch(n){case"compositionend":return vE(e);case"keypress":return e.which!==32?null:(aN=!0,iN);case"textInput":return n=e.data,n===iN&&aN?null:n;default:return null}}function $L(n,e){if(fc)return n==="compositionend"||!O0&&xE(n,e)?(n=gE(),fm=D0=Da=null,fc=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return yE&&e.locale!=="ko"?null:e.data;default:return null}}var zL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function oN(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e==="input"?!!zL[n.type]:e==="textarea"}function bE(n,e,t,s){JT(s),e=Wm(e,"onChange"),0<e.length&&(t=new A0("onChange","change",null,t,s),n.push({event:t,listeners:e}))}var bu=null,Vu=null;function UL(n){ME(n,0)}function tg(n){var e=gc(n);if(qT(e))return n}function VL(n,e){if(n==="change")return e}var wE=!1;if(na){var Ly;if(na){var Fy="oninput"in document;if(!Fy){var lN=document.createElement("div");lN.setAttribute("oninput","return;"),Fy=typeof lN.oninput=="function"}Ly=Fy}else Ly=!1;wE=Ly&&(!document.documentMode||9<document.documentMode)}function cN(){bu&&(bu.detachEvent("onpropertychange",_E),Vu=bu=null)}function _E(n){if(n.propertyName==="value"&&tg(Vu)){var e=[];bE(e,Vu,n,k0(n)),tE(UL,e)}}function BL(n,e,t){n==="focusin"?(cN(),bu=e,Vu=t,bu.attachEvent("onpropertychange",_E)):n==="focusout"&&cN()}function qL(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return tg(Vu)}function HL(n,e){if(n==="click")return tg(e)}function WL(n,e){if(n==="input"||n==="change")return tg(e)}function GL(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var Gr=typeof Object.is=="function"?Object.is:GL;function Bu(n,e){if(Gr(n,e))return!0;if(typeof n!="object"||n===null||typeof e!="object"||e===null)return!1;var t=Object.keys(n),s=Object.keys(e);if(t.length!==s.length)return!1;for(s=0;s<t.length;s++){var r=t[s];if(!Qx.call(e,r)||!Gr(n[r],e[r]))return!1}return!0}function dN(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function uN(n,e){var t=dN(n);n=0;for(var s;t;){if(t.nodeType===3){if(s=n+t.textContent.length,n<=e&&s>=e)return{node:t,offset:e-n};n=s}e:{for(;t;){if(t.nextSibling){t=t.nextSibling;break e}t=t.parentNode}t=void 0}t=dN(t)}}function SE(n,e){return n&&e?n===e?!0:n&&n.nodeType===3?!1:e&&e.nodeType===3?SE(n,e.parentNode):"contains"in n?n.contains(e):n.compareDocumentPosition?!!(n.compareDocumentPosition(e)&16):!1:!1}function NE(){for(var n=window,e=$m();e instanceof n.HTMLIFrameElement;){try{var t=typeof e.contentWindow.location.href=="string"}catch{t=!1}if(t)n=e.contentWindow;else break;e=$m(n.document)}return e}function R0(n){var e=n&&n.nodeName&&n.nodeName.toLowerCase();return e&&(e==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||e==="textarea"||n.contentEditable==="true")}function YL(n){var e=NE(),t=n.focusedElem,s=n.selectionRange;if(e!==t&&t&&t.ownerDocument&&SE(t.ownerDocument.documentElement,t)){if(s!==null&&R0(t)){if(e=s.start,n=s.end,n===void 0&&(n=e),"selectionStart"in t)t.selectionStart=e,t.selectionEnd=Math.min(n,t.value.length);else if(n=(e=t.ownerDocument||document)&&e.defaultView||window,n.getSelection){n=n.getSelection();var r=t.textContent.length,i=Math.min(s.start,r);s=s.end===void 0?i:Math.min(s.end,r),!n.extend&&i>s&&(r=s,s=i,i=r),r=uN(t,i);var o=uN(t,s);r&&o&&(n.rangeCount!==1||n.anchorNode!==r.node||n.anchorOffset!==r.offset||n.focusNode!==o.node||n.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),n.removeAllRanges(),i>s?(n.addRange(e),n.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),n.addRange(e)))}}for(e=[],n=t;n=n.parentNode;)n.nodeType===1&&e.push({element:n,left:n.scrollLeft,top:n.scrollTop});for(typeof t.focus=="function"&&t.focus(),t=0;t<e.length;t++)n=e[t],n.element.scrollLeft=n.left,n.element.scrollTop=n.top}}var ZL=na&&"documentMode"in document&&11>=document.documentMode,mc=null,yv=null,wu=null,xv=!1;function hN(n,e,t){var s=t.window===t?t.document:t.nodeType===9?t:t.ownerDocument;xv||mc==null||mc!==$m(s)||(s=mc,"selectionStart"in s&&R0(s)?s={start:s.selectionStart,end:s.selectionEnd}:(s=(s.ownerDocument&&s.ownerDocument.defaultView||window).getSelection(),s={anchorNode:s.anchorNode,anchorOffset:s.anchorOffset,focusNode:s.focusNode,focusOffset:s.focusOffset}),wu&&Bu(wu,s)||(wu=s,s=Wm(yv,"onSelect"),0<s.length&&(e=new A0("onSelect","select",null,e,t),n.push({event:e,listeners:s}),e.target=mc)))}function pf(n,e){var t={};return t[n.toLowerCase()]=e.toLowerCase(),t["Webkit"+n]="webkit"+e,t["Moz"+n]="moz"+e,t}var pc={animationend:pf("Animation","AnimationEnd"),animationiteration:pf("Animation","AnimationIteration"),animationstart:pf("Animation","AnimationStart"),transitionend:pf("Transition","TransitionEnd")},$y={},jE={};na&&(jE=document.createElement("div").style,"AnimationEvent"in window||(delete pc.animationend.animation,delete pc.animationiteration.animation,delete pc.animationstart.animation),"TransitionEvent"in window||delete pc.transitionend.transition);function ng(n){if($y[n])return $y[n];if(!pc[n])return n;var e=pc[n],t;for(t in e)if(e.hasOwnProperty(t)&&t in jE)return $y[n]=e[t];return n}var CE=ng("animationend"),kE=ng("animationiteration"),TE=ng("animationstart"),EE=ng("transitionend"),PE=new Map,fN="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function co(n,e){PE.set(n,e),jl(e,[n])}for(var zy=0;zy<fN.length;zy++){var Uy=fN[zy],KL=Uy.toLowerCase(),JL=Uy[0].toUpperCase()+Uy.slice(1);co(KL,"on"+JL)}co(CE,"onAnimationEnd");co(kE,"onAnimationIteration");co(TE,"onAnimationStart");co("dblclick","onDoubleClick");co("focusin","onFocus");co("focusout","onBlur");co(EE,"onTransitionEnd");$c("onMouseEnter",["mouseout","mouseover"]);$c("onMouseLeave",["mouseout","mouseover"]);$c("onPointerEnter",["pointerout","pointerover"]);$c("onPointerLeave",["pointerout","pointerover"]);jl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));jl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));jl("onBeforeInput",["compositionend","keypress","textInput","paste"]);jl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));jl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lu="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QL=new Set("cancel close invalid load scroll toggle".split(" ").concat(lu));function mN(n,e,t){var s=n.type||"unknown-event";n.currentTarget=t,KR(s,e,void 0,n),n.currentTarget=null}function ME(n,e){e=(e&4)!==0;for(var t=0;t<n.length;t++){var s=n[t],r=s.event;s=s.listeners;e:{var i=void 0;if(e)for(var o=s.length-1;0<=o;o--){var l=s[o],c=l.instance,d=l.currentTarget;if(l=l.listener,c!==i&&r.isPropagationStopped())break e;mN(r,l,d),i=c}else for(o=0;o<s.length;o++){if(l=s[o],c=l.instance,d=l.currentTarget,l=l.listener,c!==i&&r.isPropagationStopped())break e;mN(r,l,d),i=c}}}if(Um)throw n=fv,Um=!1,fv=null,n}function Kt(n,e){var t=e[Sv];t===void 0&&(t=e[Sv]=new Set);var s=n+"__bubble";t.has(s)||(DE(e,n,2,!1),t.add(s))}function Vy(n,e,t){var s=0;e&&(s|=4),DE(t,n,s,e)}var gf="_reactListening"+Math.random().toString(36).slice(2);function qu(n){if(!n[gf]){n[gf]=!0,$T.forEach(function(t){t!=="selectionchange"&&(QL.has(t)||Vy(t,!1,n),Vy(t,!0,n))});var e=n.nodeType===9?n:n.ownerDocument;e===null||e[gf]||(e[gf]=!0,Vy("selectionchange",!1,e))}}function DE(n,e,t,s){switch(pE(e)){case 1:var r=hL;break;case 4:r=fL;break;default:r=M0}t=r.bind(null,e,t,n),r=void 0,!hv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),s?r!==void 0?n.addEventListener(e,t,{capture:!0,passive:r}):n.addEventListener(e,t,!0):r!==void 0?n.addEventListener(e,t,{passive:r}):n.addEventListener(e,t,!1)}function By(n,e,t,s,r){var i=s;if(!(e&1)&&!(e&2)&&s!==null)e:for(;;){if(s===null)return;var o=s.tag;if(o===3||o===4){var l=s.stateNode.containerInfo;if(l===r||l.nodeType===8&&l.parentNode===r)break;if(o===4)for(o=s.return;o!==null;){var c=o.tag;if((c===3||c===4)&&(c=o.stateNode.containerInfo,c===r||c.nodeType===8&&c.parentNode===r))return;o=o.return}for(;l!==null;){if(o=Qo(l),o===null)return;if(c=o.tag,c===5||c===6){s=i=o;continue e}l=l.parentNode}}s=s.return}tE(function(){var d=i,h=k0(t),f=[];e:{var p=PE.get(n);if(p!==void 0){var g=A0,b=n;switch(n){case"keypress":if(mm(t)===0)break e;case"keydown":case"keyup":g=TL;break;case"focusin":b="focus",g=Ry;break;case"focusout":b="blur",g=Ry;break;case"beforeblur":case"afterblur":g=Ry;break;case"click":if(t.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":g=nN;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":g=gL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":g=ML;break;case CE:case kE:case TE:g=vL;break;case EE:g=AL;break;case"scroll":g=mL;break;case"wheel":g=OL;break;case"copy":case"cut":case"paste":g=wL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":g=rN}var v=(e&4)!==0,_=!v&&n==="scroll",N=v?p!==null?p+"Capture":null:p;v=[];for(var j=d,k;j!==null;){k=j;var S=k.stateNode;if(k.tag===5&&S!==null&&(k=S,N!==null&&(S=Fu(j,N),S!=null&&v.push(Hu(j,S,k)))),_)break;j=j.return}0<v.length&&(p=new g(p,b,null,t,h),f.push({event:p,listeners:v}))}}if(!(e&7)){e:{if(p=n==="mouseover"||n==="pointerover",g=n==="mouseout"||n==="pointerout",p&&t!==dv&&(b=t.relatedTarget||t.fromElement)&&(Qo(b)||b[sa]))break e;if((g||p)&&(p=h.window===h?h:(p=h.ownerDocument)?p.defaultView||p.parentWindow:window,g?(b=t.relatedTarget||t.toElement,g=d,b=b?Qo(b):null,b!==null&&(_=Cl(b),b!==_||b.tag!==5&&b.tag!==6)&&(b=null)):(g=null,b=d),g!==b)){if(v=nN,S="onMouseLeave",N="onMouseEnter",j="mouse",(n==="pointerout"||n==="pointerover")&&(v=rN,S="onPointerLeave",N="onPointerEnter",j="pointer"),_=g==null?p:gc(g),k=b==null?p:gc(b),p=new v(S,j+"leave",g,t,h),p.target=_,p.relatedTarget=k,S=null,Qo(h)===d&&(v=new v(N,j+"enter",b,t,h),v.target=k,v.relatedTarget=_,S=v),_=S,g&&b)t:{for(v=g,N=b,j=0,k=v;k;k=Wl(k))j++;for(k=0,S=N;S;S=Wl(S))k++;for(;0<j-k;)v=Wl(v),j--;for(;0<k-j;)N=Wl(N),k--;for(;j--;){if(v===N||N!==null&&v===N.alternate)break t;v=Wl(v),N=Wl(N)}v=null}else v=null;g!==null&&pN(f,p,g,v,!1),b!==null&&_!==null&&pN(f,_,b,v,!0)}}e:{if(p=d?gc(d):window,g=p.nodeName&&p.nodeName.toLowerCase(),g==="select"||g==="input"&&p.type==="file")var P=VL;else if(oN(p))if(wE)P=WL;else{P=qL;var E=BL}else(g=p.nodeName)&&g.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(P=HL);if(P&&(P=P(n,d))){bE(f,P,t,h);break e}E&&E(n,p,d),n==="focusout"&&(E=p._wrapperState)&&E.controlled&&p.type==="number"&&iv(p,"number",p.value)}switch(E=d?gc(d):window,n){case"focusin":(oN(E)||E.contentEditable==="true")&&(mc=E,yv=d,wu=null);break;case"focusout":wu=yv=mc=null;break;case"mousedown":xv=!0;break;case"contextmenu":case"mouseup":case"dragend":xv=!1,hN(f,t,h);break;case"selectionchange":if(ZL)break;case"keydown":case"keyup":hN(f,t,h)}var M;if(O0)e:{switch(n){case"compositionstart":var I="onCompositionStart";break e;case"compositionend":I="onCompositionEnd";break e;case"compositionupdate":I="onCompositionUpdate";break e}I=void 0}else fc?xE(n,t)&&(I="onCompositionEnd"):n==="keydown"&&t.keyCode===229&&(I="onCompositionStart");I&&(yE&&t.locale!=="ko"&&(fc||I!=="onCompositionStart"?I==="onCompositionEnd"&&fc&&(M=gE()):(Da=h,D0="value"in Da?Da.value:Da.textContent,fc=!0)),E=Wm(d,I),0<E.length&&(I=new sN(I,n,null,t,h),f.push({event:I,listeners:E}),M?I.data=M:(M=vE(t),M!==null&&(I.data=M)))),(M=LL?FL(n,t):$L(n,t))&&(d=Wm(d,"onBeforeInput"),0<d.length&&(h=new sN("onBeforeInput","beforeinput",null,t,h),f.push({event:h,listeners:d}),h.data=M))}ME(f,e)})}function Hu(n,e,t){return{instance:n,listener:e,currentTarget:t}}function Wm(n,e){for(var t=e+"Capture",s=[];n!==null;){var r=n,i=r.stateNode;r.tag===5&&i!==null&&(r=i,i=Fu(n,t),i!=null&&s.unshift(Hu(n,i,r)),i=Fu(n,e),i!=null&&s.push(Hu(n,i,r))),n=n.return}return s}function Wl(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5);return n||null}function pN(n,e,t,s,r){for(var i=e._reactName,o=[];t!==null&&t!==s;){var l=t,c=l.alternate,d=l.stateNode;if(c!==null&&c===s)break;l.tag===5&&d!==null&&(l=d,r?(c=Fu(t,i),c!=null&&o.unshift(Hu(t,c,l))):r||(c=Fu(t,i),c!=null&&o.push(Hu(t,c,l)))),t=t.return}o.length!==0&&n.push({event:e,listeners:o})}var XL=/\r\n?/g,e4=/\u0000|\uFFFD/g;function gN(n){return(typeof n=="string"?n:""+n).replace(XL,`
`).replace(e4,"")}function yf(n,e,t){if(e=gN(e),gN(n)!==e&&t)throw Error(ke(425))}function Gm(){}var vv=null,bv=null;function wv(n,e){return n==="textarea"||n==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var _v=typeof setTimeout=="function"?setTimeout:void 0,t4=typeof clearTimeout=="function"?clearTimeout:void 0,yN=typeof Promise=="function"?Promise:void 0,n4=typeof queueMicrotask=="function"?queueMicrotask:typeof yN<"u"?function(n){return yN.resolve(null).then(n).catch(s4)}:_v;function s4(n){setTimeout(function(){throw n})}function qy(n,e){var t=e,s=0;do{var r=t.nextSibling;if(n.removeChild(t),r&&r.nodeType===8)if(t=r.data,t==="/$"){if(s===0){n.removeChild(r),Uu(e);return}s--}else t!=="$"&&t!=="$?"&&t!=="$!"||s++;t=r}while(t);Uu(e)}function qa(n){for(;n!=null;n=n.nextSibling){var e=n.nodeType;if(e===1||e===3)break;if(e===8){if(e=n.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return n}function xN(n){n=n.previousSibling;for(var e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="$"||t==="$!"||t==="$?"){if(e===0)return n;e--}else t==="/$"&&e++}n=n.previousSibling}return null}var cd=Math.random().toString(36).slice(2),yi="__reactFiber$"+cd,Wu="__reactProps$"+cd,sa="__reactContainer$"+cd,Sv="__reactEvents$"+cd,r4="__reactListeners$"+cd,i4="__reactHandles$"+cd;function Qo(n){var e=n[yi];if(e)return e;for(var t=n.parentNode;t;){if(e=t[sa]||t[yi]){if(t=e.alternate,e.child!==null||t!==null&&t.child!==null)for(n=xN(n);n!==null;){if(t=n[yi])return t;n=xN(n)}return e}n=t,t=n.parentNode}return null}function _h(n){return n=n[yi]||n[sa],!n||n.tag!==5&&n.tag!==6&&n.tag!==13&&n.tag!==3?null:n}function gc(n){if(n.tag===5||n.tag===6)return n.stateNode;throw Error(ke(33))}function sg(n){return n[Wu]||null}var Nv=[],yc=-1;function uo(n){return{current:n}}function en(n){0>yc||(n.current=Nv[yc],Nv[yc]=null,yc--)}function Yt(n,e){yc++,Nv[yc]=n.current,n.current=e}var Xa={},ls=uo(Xa),Fs=uo(!1),hl=Xa;function zc(n,e){var t=n.type.contextTypes;if(!t)return Xa;var s=n.stateNode;if(s&&s.__reactInternalMemoizedUnmaskedChildContext===e)return s.__reactInternalMemoizedMaskedChildContext;var r={},i;for(i in t)r[i]=e[i];return s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=e,n.__reactInternalMemoizedMaskedChildContext=r),r}function $s(n){return n=n.childContextTypes,n!=null}function Ym(){en(Fs),en(ls)}function vN(n,e,t){if(ls.current!==Xa)throw Error(ke(168));Yt(ls,e),Yt(Fs,t)}function AE(n,e,t){var s=n.stateNode;if(e=e.childContextTypes,typeof s.getChildContext!="function")return t;s=s.getChildContext();for(var r in s)if(!(r in e))throw Error(ke(108,BR(n)||"Unknown",r));return pn({},t,s)}function Zm(n){return n=(n=n.stateNode)&&n.__reactInternalMemoizedMergedChildContext||Xa,hl=ls.current,Yt(ls,n),Yt(Fs,Fs.current),!0}function bN(n,e,t){var s=n.stateNode;if(!s)throw Error(ke(169));t?(n=AE(n,e,hl),s.__reactInternalMemoizedMergedChildContext=n,en(Fs),en(ls),Yt(ls,n)):en(Fs),Yt(Fs,t)}var Hi=null,rg=!1,Hy=!1;function IE(n){Hi===null?Hi=[n]:Hi.push(n)}function a4(n){rg=!0,IE(n)}function ho(){if(!Hy&&Hi!==null){Hy=!0;var n=0,e=Ot;try{var t=Hi;for(Ot=1;n<t.length;n++){var s=t[n];do s=s(!0);while(s!==null)}Hi=null,rg=!1}catch(r){throw Hi!==null&&(Hi=Hi.slice(n+1)),iE(T0,ho),r}finally{Ot=e,Hy=!1}}return null}var xc=[],vc=0,Km=null,Jm=0,br=[],wr=0,fl=null,Yi=1,Zi="";function Vo(n,e){xc[vc++]=Jm,xc[vc++]=Km,Km=n,Jm=e}function OE(n,e,t){br[wr++]=Yi,br[wr++]=Zi,br[wr++]=fl,fl=n;var s=Yi;n=Zi;var r=32-Br(s)-1;s&=~(1<<r),t+=1;var i=32-Br(e)+r;if(30<i){var o=r-r%5;i=(s&(1<<o)-1).toString(32),s>>=o,r-=o,Yi=1<<32-Br(e)+r|t<<r|s,Zi=i+n}else Yi=1<<i|t<<r|s,Zi=n}function L0(n){n.return!==null&&(Vo(n,1),OE(n,1,0))}function F0(n){for(;n===Km;)Km=xc[--vc],xc[vc]=null,Jm=xc[--vc],xc[vc]=null;for(;n===fl;)fl=br[--wr],br[wr]=null,Zi=br[--wr],br[wr]=null,Yi=br[--wr],br[wr]=null}var sr=null,nr=null,sn=!1,Fr=null;function RE(n,e){var t=Sr(5,null,null,0);t.elementType="DELETED",t.stateNode=e,t.return=n,e=n.deletions,e===null?(n.deletions=[t],n.flags|=16):e.push(t)}function wN(n,e){switch(n.tag){case 5:var t=n.type;return e=e.nodeType!==1||t.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(n.stateNode=e,sr=n,nr=qa(e.firstChild),!0):!1;case 6:return e=n.pendingProps===""||e.nodeType!==3?null:e,e!==null?(n.stateNode=e,sr=n,nr=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(t=fl!==null?{id:Yi,overflow:Zi}:null,n.memoizedState={dehydrated:e,treeContext:t,retryLane:1073741824},t=Sr(18,null,null,0),t.stateNode=e,t.return=n,n.child=t,sr=n,nr=null,!0):!1;default:return!1}}function jv(n){return(n.mode&1)!==0&&(n.flags&128)===0}function Cv(n){if(sn){var e=nr;if(e){var t=e;if(!wN(n,e)){if(jv(n))throw Error(ke(418));e=qa(t.nextSibling);var s=sr;e&&wN(n,e)?RE(s,t):(n.flags=n.flags&-4097|2,sn=!1,sr=n)}}else{if(jv(n))throw Error(ke(418));n.flags=n.flags&-4097|2,sn=!1,sr=n}}}function _N(n){for(n=n.return;n!==null&&n.tag!==5&&n.tag!==3&&n.tag!==13;)n=n.return;sr=n}function xf(n){if(n!==sr)return!1;if(!sn)return _N(n),sn=!0,!1;var e;if((e=n.tag!==3)&&!(e=n.tag!==5)&&(e=n.type,e=e!=="head"&&e!=="body"&&!wv(n.type,n.memoizedProps)),e&&(e=nr)){if(jv(n))throw LE(),Error(ke(418));for(;e;)RE(n,e),e=qa(e.nextSibling)}if(_N(n),n.tag===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(ke(317));e:{for(n=n.nextSibling,e=0;n;){if(n.nodeType===8){var t=n.data;if(t==="/$"){if(e===0){nr=qa(n.nextSibling);break e}e--}else t!=="$"&&t!=="$!"&&t!=="$?"||e++}n=n.nextSibling}nr=null}}else nr=sr?qa(n.stateNode.nextSibling):null;return!0}function LE(){for(var n=nr;n;)n=qa(n.nextSibling)}function Uc(){nr=sr=null,sn=!1}function $0(n){Fr===null?Fr=[n]:Fr.push(n)}var o4=fa.ReactCurrentBatchConfig;function Fd(n,e,t){if(n=t.ref,n!==null&&typeof n!="function"&&typeof n!="object"){if(t._owner){if(t=t._owner,t){if(t.tag!==1)throw Error(ke(309));var s=t.stateNode}if(!s)throw Error(ke(147,n));var r=s,i=""+n;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var l=r.refs;o===null?delete l[i]:l[i]=o},e._stringRef=i,e)}if(typeof n!="string")throw Error(ke(284));if(!t._owner)throw Error(ke(290,n))}return n}function vf(n,e){throw n=Object.prototype.toString.call(e),Error(ke(31,n==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":n))}function SN(n){var e=n._init;return e(n._payload)}function FE(n){function e(N,j){if(n){var k=N.deletions;k===null?(N.deletions=[j],N.flags|=16):k.push(j)}}function t(N,j){if(!n)return null;for(;j!==null;)e(N,j),j=j.sibling;return null}function s(N,j){for(N=new Map;j!==null;)j.key!==null?N.set(j.key,j):N.set(j.index,j),j=j.sibling;return N}function r(N,j){return N=Ya(N,j),N.index=0,N.sibling=null,N}function i(N,j,k){return N.index=k,n?(k=N.alternate,k!==null?(k=k.index,k<j?(N.flags|=2,j):k):(N.flags|=2,j)):(N.flags|=1048576,j)}function o(N){return n&&N.alternate===null&&(N.flags|=2),N}function l(N,j,k,S){return j===null||j.tag!==6?(j=Qy(k,N.mode,S),j.return=N,j):(j=r(j,k),j.return=N,j)}function c(N,j,k,S){var P=k.type;return P===hc?h(N,j,k.props.children,S,k.key):j!==null&&(j.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ca&&SN(P)===j.type)?(S=r(j,k.props),S.ref=Fd(N,j,k),S.return=N,S):(S=wm(k.type,k.key,k.props,null,N.mode,S),S.ref=Fd(N,j,k),S.return=N,S)}function d(N,j,k,S){return j===null||j.tag!==4||j.stateNode.containerInfo!==k.containerInfo||j.stateNode.implementation!==k.implementation?(j=Xy(k,N.mode,S),j.return=N,j):(j=r(j,k.children||[]),j.return=N,j)}function h(N,j,k,S,P){return j===null||j.tag!==7?(j=al(k,N.mode,S,P),j.return=N,j):(j=r(j,k),j.return=N,j)}function f(N,j,k){if(typeof j=="string"&&j!==""||typeof j=="number")return j=Qy(""+j,N.mode,k),j.return=N,j;if(typeof j=="object"&&j!==null){switch(j.$$typeof){case lf:return k=wm(j.type,j.key,j.props,null,N.mode,k),k.ref=Fd(N,null,j),k.return=N,k;case uc:return j=Xy(j,N.mode,k),j.return=N,j;case Ca:var S=j._init;return f(N,S(j._payload),k)}if(au(j)||Ad(j))return j=al(j,N.mode,k,null),j.return=N,j;vf(N,j)}return null}function p(N,j,k,S){var P=j!==null?j.key:null;if(typeof k=="string"&&k!==""||typeof k=="number")return P!==null?null:l(N,j,""+k,S);if(typeof k=="object"&&k!==null){switch(k.$$typeof){case lf:return k.key===P?c(N,j,k,S):null;case uc:return k.key===P?d(N,j,k,S):null;case Ca:return P=k._init,p(N,j,P(k._payload),S)}if(au(k)||Ad(k))return P!==null?null:h(N,j,k,S,null);vf(N,k)}return null}function g(N,j,k,S,P){if(typeof S=="string"&&S!==""||typeof S=="number")return N=N.get(k)||null,l(j,N,""+S,P);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case lf:return N=N.get(S.key===null?k:S.key)||null,c(j,N,S,P);case uc:return N=N.get(S.key===null?k:S.key)||null,d(j,N,S,P);case Ca:var E=S._init;return g(N,j,k,E(S._payload),P)}if(au(S)||Ad(S))return N=N.get(k)||null,h(j,N,S,P,null);vf(j,S)}return null}function b(N,j,k,S){for(var P=null,E=null,M=j,I=j=0,O=null;M!==null&&I<k.length;I++){M.index>I?(O=M,M=null):O=M.sibling;var D=p(N,M,k[I],S);if(D===null){M===null&&(M=O);break}n&&M&&D.alternate===null&&e(N,M),j=i(D,j,I),E===null?P=D:E.sibling=D,E=D,M=O}if(I===k.length)return t(N,M),sn&&Vo(N,I),P;if(M===null){for(;I<k.length;I++)M=f(N,k[I],S),M!==null&&(j=i(M,j,I),E===null?P=M:E.sibling=M,E=M);return sn&&Vo(N,I),P}for(M=s(N,M);I<k.length;I++)O=g(M,N,I,k[I],S),O!==null&&(n&&O.alternate!==null&&M.delete(O.key===null?I:O.key),j=i(O,j,I),E===null?P=O:E.sibling=O,E=O);return n&&M.forEach(function(z){return e(N,z)}),sn&&Vo(N,I),P}function v(N,j,k,S){var P=Ad(k);if(typeof P!="function")throw Error(ke(150));if(k=P.call(k),k==null)throw Error(ke(151));for(var E=P=null,M=j,I=j=0,O=null,D=k.next();M!==null&&!D.done;I++,D=k.next()){M.index>I?(O=M,M=null):O=M.sibling;var z=p(N,M,D.value,S);if(z===null){M===null&&(M=O);break}n&&M&&z.alternate===null&&e(N,M),j=i(z,j,I),E===null?P=z:E.sibling=z,E=z,M=O}if(D.done)return t(N,M),sn&&Vo(N,I),P;if(M===null){for(;!D.done;I++,D=k.next())D=f(N,D.value,S),D!==null&&(j=i(D,j,I),E===null?P=D:E.sibling=D,E=D);return sn&&Vo(N,I),P}for(M=s(N,M);!D.done;I++,D=k.next())D=g(M,N,I,D.value,S),D!==null&&(n&&D.alternate!==null&&M.delete(D.key===null?I:D.key),j=i(D,j,I),E===null?P=D:E.sibling=D,E=D);return n&&M.forEach(function(H){return e(N,H)}),sn&&Vo(N,I),P}function _(N,j,k,S){if(typeof k=="object"&&k!==null&&k.type===hc&&k.key===null&&(k=k.props.children),typeof k=="object"&&k!==null){switch(k.$$typeof){case lf:e:{for(var P=k.key,E=j;E!==null;){if(E.key===P){if(P=k.type,P===hc){if(E.tag===7){t(N,E.sibling),j=r(E,k.props.children),j.return=N,N=j;break e}}else if(E.elementType===P||typeof P=="object"&&P!==null&&P.$$typeof===Ca&&SN(P)===E.type){t(N,E.sibling),j=r(E,k.props),j.ref=Fd(N,E,k),j.return=N,N=j;break e}t(N,E);break}else e(N,E);E=E.sibling}k.type===hc?(j=al(k.props.children,N.mode,S,k.key),j.return=N,N=j):(S=wm(k.type,k.key,k.props,null,N.mode,S),S.ref=Fd(N,j,k),S.return=N,N=S)}return o(N);case uc:e:{for(E=k.key;j!==null;){if(j.key===E)if(j.tag===4&&j.stateNode.containerInfo===k.containerInfo&&j.stateNode.implementation===k.implementation){t(N,j.sibling),j=r(j,k.children||[]),j.return=N,N=j;break e}else{t(N,j);break}else e(N,j);j=j.sibling}j=Xy(k,N.mode,S),j.return=N,N=j}return o(N);case Ca:return E=k._init,_(N,j,E(k._payload),S)}if(au(k))return b(N,j,k,S);if(Ad(k))return v(N,j,k,S);vf(N,k)}return typeof k=="string"&&k!==""||typeof k=="number"?(k=""+k,j!==null&&j.tag===6?(t(N,j.sibling),j=r(j,k),j.return=N,N=j):(t(N,j),j=Qy(k,N.mode,S),j.return=N,N=j),o(N)):t(N,j)}return _}var Vc=FE(!0),$E=FE(!1),Qm=uo(null),Xm=null,bc=null,z0=null;function U0(){z0=bc=Xm=null}function V0(n){var e=Qm.current;en(Qm),n._currentValue=e}function kv(n,e,t){for(;n!==null;){var s=n.alternate;if((n.childLanes&e)!==e?(n.childLanes|=e,s!==null&&(s.childLanes|=e)):s!==null&&(s.childLanes&e)!==e&&(s.childLanes|=e),n===t)break;n=n.return}}function Mc(n,e){Xm=n,z0=bc=null,n=n.dependencies,n!==null&&n.firstContext!==null&&(n.lanes&e&&(Is=!0),n.firstContext=null)}function Cr(n){var e=n._currentValue;if(z0!==n)if(n={context:n,memoizedValue:e,next:null},bc===null){if(Xm===null)throw Error(ke(308));bc=n,Xm.dependencies={lanes:0,firstContext:n}}else bc=bc.next=n;return e}var Xo=null;function B0(n){Xo===null?Xo=[n]:Xo.push(n)}function zE(n,e,t,s){var r=e.interleaved;return r===null?(t.next=t,B0(e)):(t.next=r.next,r.next=t),e.interleaved=t,ra(n,s)}function ra(n,e){n.lanes|=e;var t=n.alternate;for(t!==null&&(t.lanes|=e),t=n,n=n.return;n!==null;)n.childLanes|=e,t=n.alternate,t!==null&&(t.childLanes|=e),t=n,n=n.return;return t.tag===3?t.stateNode:null}var ka=!1;function q0(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function UE(n,e){n=n.updateQueue,e.updateQueue===n&&(e.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,effects:n.effects})}function Xi(n,e){return{eventTime:n,lane:e,tag:0,payload:null,callback:null,next:null}}function Ha(n,e,t){var s=n.updateQueue;if(s===null)return null;if(s=s.shared,Ct&2){var r=s.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),s.pending=e,ra(n,t)}return r=s.interleaved,r===null?(e.next=e,B0(s)):(e.next=r.next,r.next=e),s.interleaved=e,ra(n,t)}function pm(n,e,t){if(e=e.updateQueue,e!==null&&(e=e.shared,(t&4194240)!==0)){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,E0(n,t)}}function NN(n,e){var t=n.updateQueue,s=n.alternate;if(s!==null&&(s=s.updateQueue,t===s)){var r=null,i=null;if(t=t.firstBaseUpdate,t!==null){do{var o={eventTime:t.eventTime,lane:t.lane,tag:t.tag,payload:t.payload,callback:t.callback,next:null};i===null?r=i=o:i=i.next=o,t=t.next}while(t!==null);i===null?r=i=e:i=i.next=e}else r=i=e;t={baseState:s.baseState,firstBaseUpdate:r,lastBaseUpdate:i,shared:s.shared,effects:s.effects},n.updateQueue=t;return}n=t.lastBaseUpdate,n===null?t.firstBaseUpdate=e:n.next=e,t.lastBaseUpdate=e}function ep(n,e,t,s){var r=n.updateQueue;ka=!1;var i=r.firstBaseUpdate,o=r.lastBaseUpdate,l=r.shared.pending;if(l!==null){r.shared.pending=null;var c=l,d=c.next;c.next=null,o===null?i=d:o.next=d,o=c;var h=n.alternate;h!==null&&(h=h.updateQueue,l=h.lastBaseUpdate,l!==o&&(l===null?h.firstBaseUpdate=d:l.next=d,h.lastBaseUpdate=c))}if(i!==null){var f=r.baseState;o=0,h=d=c=null,l=i;do{var p=l.lane,g=l.eventTime;if((s&p)===p){h!==null&&(h=h.next={eventTime:g,lane:0,tag:l.tag,payload:l.payload,callback:l.callback,next:null});e:{var b=n,v=l;switch(p=e,g=t,v.tag){case 1:if(b=v.payload,typeof b=="function"){f=b.call(g,f,p);break e}f=b;break e;case 3:b.flags=b.flags&-65537|128;case 0:if(b=v.payload,p=typeof b=="function"?b.call(g,f,p):b,p==null)break e;f=pn({},f,p);break e;case 2:ka=!0}}l.callback!==null&&l.lane!==0&&(n.flags|=64,p=r.effects,p===null?r.effects=[l]:p.push(l))}else g={eventTime:g,lane:p,tag:l.tag,payload:l.payload,callback:l.callback,next:null},h===null?(d=h=g,c=f):h=h.next=g,o|=p;if(l=l.next,l===null){if(l=r.shared.pending,l===null)break;p=l,l=p.next,p.next=null,r.lastBaseUpdate=p,r.shared.pending=null}}while(!0);if(h===null&&(c=f),r.baseState=c,r.firstBaseUpdate=d,r.lastBaseUpdate=h,e=r.shared.interleaved,e!==null){r=e;do o|=r.lane,r=r.next;while(r!==e)}else i===null&&(r.shared.lanes=0);pl|=o,n.lanes=o,n.memoizedState=f}}function jN(n,e,t){if(n=e.effects,e.effects=null,n!==null)for(e=0;e<n.length;e++){var s=n[e],r=s.callback;if(r!==null){if(s.callback=null,s=t,typeof r!="function")throw Error(ke(191,r));r.call(s)}}}var Sh={},Si=uo(Sh),Gu=uo(Sh),Yu=uo(Sh);function el(n){if(n===Sh)throw Error(ke(174));return n}function H0(n,e){switch(Yt(Yu,e),Yt(Gu,n),Yt(Si,Sh),n=e.nodeType,n){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:ov(null,"");break;default:n=n===8?e.parentNode:e,e=n.namespaceURI||null,n=n.tagName,e=ov(e,n)}en(Si),Yt(Si,e)}function Bc(){en(Si),en(Gu),en(Yu)}function VE(n){el(Yu.current);var e=el(Si.current),t=ov(e,n.type);e!==t&&(Yt(Gu,n),Yt(Si,t))}function W0(n){Gu.current===n&&(en(Si),en(Gu))}var dn=uo(0);function tp(n){for(var e=n;e!==null;){if(e.tag===13){var t=e.memoizedState;if(t!==null&&(t=t.dehydrated,t===null||t.data==="$?"||t.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Wy=[];function G0(){for(var n=0;n<Wy.length;n++)Wy[n]._workInProgressVersionPrimary=null;Wy.length=0}var gm=fa.ReactCurrentDispatcher,Gy=fa.ReactCurrentBatchConfig,ml=0,fn=null,In=null,Bn=null,np=!1,_u=!1,Zu=0,l4=0;function Xn(){throw Error(ke(321))}function Y0(n,e){if(e===null)return!1;for(var t=0;t<e.length&&t<n.length;t++)if(!Gr(n[t],e[t]))return!1;return!0}function Z0(n,e,t,s,r,i){if(ml=i,fn=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,gm.current=n===null||n.memoizedState===null?h4:f4,n=t(s,r),_u){i=0;do{if(_u=!1,Zu=0,25<=i)throw Error(ke(301));i+=1,Bn=In=null,e.updateQueue=null,gm.current=m4,n=t(s,r)}while(_u)}if(gm.current=sp,e=In!==null&&In.next!==null,ml=0,Bn=In=fn=null,np=!1,e)throw Error(ke(300));return n}function K0(){var n=Zu!==0;return Zu=0,n}function ui(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Bn===null?fn.memoizedState=Bn=n:Bn=Bn.next=n,Bn}function kr(){if(In===null){var n=fn.alternate;n=n!==null?n.memoizedState:null}else n=In.next;var e=Bn===null?fn.memoizedState:Bn.next;if(e!==null)Bn=e,In=n;else{if(n===null)throw Error(ke(310));In=n,n={memoizedState:In.memoizedState,baseState:In.baseState,baseQueue:In.baseQueue,queue:In.queue,next:null},Bn===null?fn.memoizedState=Bn=n:Bn=Bn.next=n}return Bn}function Ku(n,e){return typeof e=="function"?e(n):e}function Yy(n){var e=kr(),t=e.queue;if(t===null)throw Error(ke(311));t.lastRenderedReducer=n;var s=In,r=s.baseQueue,i=t.pending;if(i!==null){if(r!==null){var o=r.next;r.next=i.next,i.next=o}s.baseQueue=r=i,t.pending=null}if(r!==null){i=r.next,s=s.baseState;var l=o=null,c=null,d=i;do{var h=d.lane;if((ml&h)===h)c!==null&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),s=d.hasEagerState?d.eagerState:n(s,d.action);else{var f={lane:h,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};c===null?(l=c=f,o=s):c=c.next=f,fn.lanes|=h,pl|=h}d=d.next}while(d!==null&&d!==i);c===null?o=s:c.next=l,Gr(s,e.memoizedState)||(Is=!0),e.memoizedState=s,e.baseState=o,e.baseQueue=c,t.lastRenderedState=s}if(n=t.interleaved,n!==null){r=n;do i=r.lane,fn.lanes|=i,pl|=i,r=r.next;while(r!==n)}else r===null&&(t.lanes=0);return[e.memoizedState,t.dispatch]}function Zy(n){var e=kr(),t=e.queue;if(t===null)throw Error(ke(311));t.lastRenderedReducer=n;var s=t.dispatch,r=t.pending,i=e.memoizedState;if(r!==null){t.pending=null;var o=r=r.next;do i=n(i,o.action),o=o.next;while(o!==r);Gr(i,e.memoizedState)||(Is=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),t.lastRenderedState=i}return[i,s]}function BE(){}function qE(n,e){var t=fn,s=kr(),r=e(),i=!Gr(s.memoizedState,r);if(i&&(s.memoizedState=r,Is=!0),s=s.queue,J0(GE.bind(null,t,s,n),[n]),s.getSnapshot!==e||i||Bn!==null&&Bn.memoizedState.tag&1){if(t.flags|=2048,Ju(9,WE.bind(null,t,s,r,e),void 0,null),qn===null)throw Error(ke(349));ml&30||HE(t,e,r)}return r}function HE(n,e,t){n.flags|=16384,n={getSnapshot:e,value:t},e=fn.updateQueue,e===null?(e={lastEffect:null,stores:null},fn.updateQueue=e,e.stores=[n]):(t=e.stores,t===null?e.stores=[n]:t.push(n))}function WE(n,e,t,s){e.value=t,e.getSnapshot=s,YE(e)&&ZE(n)}function GE(n,e,t){return t(function(){YE(e)&&ZE(n)})}function YE(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!Gr(n,t)}catch{return!0}}function ZE(n){var e=ra(n,1);e!==null&&qr(e,n,1,-1)}function CN(n){var e=ui();return typeof n=="function"&&(n=n()),e.memoizedState=e.baseState=n,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Ku,lastRenderedState:n},e.queue=n,n=n.dispatch=u4.bind(null,fn,n),[e.memoizedState,n]}function Ju(n,e,t,s){return n={tag:n,create:e,destroy:t,deps:s,next:null},e=fn.updateQueue,e===null?(e={lastEffect:null,stores:null},fn.updateQueue=e,e.lastEffect=n.next=n):(t=e.lastEffect,t===null?e.lastEffect=n.next=n:(s=t.next,t.next=n,n.next=s,e.lastEffect=n)),n}function KE(){return kr().memoizedState}function ym(n,e,t,s){var r=ui();fn.flags|=n,r.memoizedState=Ju(1|e,t,void 0,s===void 0?null:s)}function ig(n,e,t,s){var r=kr();s=s===void 0?null:s;var i=void 0;if(In!==null){var o=In.memoizedState;if(i=o.destroy,s!==null&&Y0(s,o.deps)){r.memoizedState=Ju(e,t,i,s);return}}fn.flags|=n,r.memoizedState=Ju(1|e,t,i,s)}function kN(n,e){return ym(8390656,8,n,e)}function J0(n,e){return ig(2048,8,n,e)}function JE(n,e){return ig(4,2,n,e)}function QE(n,e){return ig(4,4,n,e)}function XE(n,e){if(typeof e=="function")return n=n(),e(n),function(){e(null)};if(e!=null)return n=n(),e.current=n,function(){e.current=null}}function eP(n,e,t){return t=t!=null?t.concat([n]):null,ig(4,4,XE.bind(null,e,n),t)}function Q0(){}function tP(n,e){var t=kr();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Y0(e,s[1])?s[0]:(t.memoizedState=[n,e],n)}function nP(n,e){var t=kr();e=e===void 0?null:e;var s=t.memoizedState;return s!==null&&e!==null&&Y0(e,s[1])?s[0]:(n=n(),t.memoizedState=[n,e],n)}function sP(n,e,t){return ml&21?(Gr(t,e)||(t=lE(),fn.lanes|=t,pl|=t,n.baseState=!0),e):(n.baseState&&(n.baseState=!1,Is=!0),n.memoizedState=t)}function c4(n,e){var t=Ot;Ot=t!==0&&4>t?t:4,n(!0);var s=Gy.transition;Gy.transition={};try{n(!1),e()}finally{Ot=t,Gy.transition=s}}function rP(){return kr().memoizedState}function d4(n,e,t){var s=Ga(n);if(t={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null},iP(n))aP(e,t);else if(t=zE(n,e,t,s),t!==null){var r=bs();qr(t,n,s,r),oP(t,e,s)}}function u4(n,e,t){var s=Ga(n),r={lane:s,action:t,hasEagerState:!1,eagerState:null,next:null};if(iP(n))aP(e,r);else{var i=n.alternate;if(n.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,l=i(o,t);if(r.hasEagerState=!0,r.eagerState=l,Gr(l,o)){var c=e.interleaved;c===null?(r.next=r,B0(e)):(r.next=c.next,c.next=r),e.interleaved=r;return}}catch{}finally{}t=zE(n,e,r,s),t!==null&&(r=bs(),qr(t,n,s,r),oP(t,e,s))}}function iP(n){var e=n.alternate;return n===fn||e!==null&&e===fn}function aP(n,e){_u=np=!0;var t=n.pending;t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e}function oP(n,e,t){if(t&4194240){var s=e.lanes;s&=n.pendingLanes,t|=s,e.lanes=t,E0(n,t)}}var sp={readContext:Cr,useCallback:Xn,useContext:Xn,useEffect:Xn,useImperativeHandle:Xn,useInsertionEffect:Xn,useLayoutEffect:Xn,useMemo:Xn,useReducer:Xn,useRef:Xn,useState:Xn,useDebugValue:Xn,useDeferredValue:Xn,useTransition:Xn,useMutableSource:Xn,useSyncExternalStore:Xn,useId:Xn,unstable_isNewReconciler:!1},h4={readContext:Cr,useCallback:function(n,e){return ui().memoizedState=[n,e===void 0?null:e],n},useContext:Cr,useEffect:kN,useImperativeHandle:function(n,e,t){return t=t!=null?t.concat([n]):null,ym(4194308,4,XE.bind(null,e,n),t)},useLayoutEffect:function(n,e){return ym(4194308,4,n,e)},useInsertionEffect:function(n,e){return ym(4,2,n,e)},useMemo:function(n,e){var t=ui();return e=e===void 0?null:e,n=n(),t.memoizedState=[n,e],n},useReducer:function(n,e,t){var s=ui();return e=t!==void 0?t(e):e,s.memoizedState=s.baseState=e,n={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:e},s.queue=n,n=n.dispatch=d4.bind(null,fn,n),[s.memoizedState,n]},useRef:function(n){var e=ui();return n={current:n},e.memoizedState=n},useState:CN,useDebugValue:Q0,useDeferredValue:function(n){return ui().memoizedState=n},useTransition:function(){var n=CN(!1),e=n[0];return n=c4.bind(null,n[1]),ui().memoizedState=n,[e,n]},useMutableSource:function(){},useSyncExternalStore:function(n,e,t){var s=fn,r=ui();if(sn){if(t===void 0)throw Error(ke(407));t=t()}else{if(t=e(),qn===null)throw Error(ke(349));ml&30||HE(s,e,t)}r.memoizedState=t;var i={value:t,getSnapshot:e};return r.queue=i,kN(GE.bind(null,s,i,n),[n]),s.flags|=2048,Ju(9,WE.bind(null,s,i,t,e),void 0,null),t},useId:function(){var n=ui(),e=qn.identifierPrefix;if(sn){var t=Zi,s=Yi;t=(s&~(1<<32-Br(s)-1)).toString(32)+t,e=":"+e+"R"+t,t=Zu++,0<t&&(e+="H"+t.toString(32)),e+=":"}else t=l4++,e=":"+e+"r"+t.toString(32)+":";return n.memoizedState=e},unstable_isNewReconciler:!1},f4={readContext:Cr,useCallback:tP,useContext:Cr,useEffect:J0,useImperativeHandle:eP,useInsertionEffect:JE,useLayoutEffect:QE,useMemo:nP,useReducer:Yy,useRef:KE,useState:function(){return Yy(Ku)},useDebugValue:Q0,useDeferredValue:function(n){var e=kr();return sP(e,In.memoizedState,n)},useTransition:function(){var n=Yy(Ku)[0],e=kr().memoizedState;return[n,e]},useMutableSource:BE,useSyncExternalStore:qE,useId:rP,unstable_isNewReconciler:!1},m4={readContext:Cr,useCallback:tP,useContext:Cr,useEffect:J0,useImperativeHandle:eP,useInsertionEffect:JE,useLayoutEffect:QE,useMemo:nP,useReducer:Zy,useRef:KE,useState:function(){return Zy(Ku)},useDebugValue:Q0,useDeferredValue:function(n){var e=kr();return In===null?e.memoizedState=n:sP(e,In.memoizedState,n)},useTransition:function(){var n=Zy(Ku)[0],e=kr().memoizedState;return[n,e]},useMutableSource:BE,useSyncExternalStore:qE,useId:rP,unstable_isNewReconciler:!1};function Or(n,e){if(n&&n.defaultProps){e=pn({},e),n=n.defaultProps;for(var t in n)e[t]===void 0&&(e[t]=n[t]);return e}return e}function Tv(n,e,t,s){e=n.memoizedState,t=t(s,e),t=t==null?e:pn({},e,t),n.memoizedState=t,n.lanes===0&&(n.updateQueue.baseState=t)}var ag={isMounted:function(n){return(n=n._reactInternals)?Cl(n)===n:!1},enqueueSetState:function(n,e,t){n=n._reactInternals;var s=bs(),r=Ga(n),i=Xi(s,r);i.payload=e,t!=null&&(i.callback=t),e=Ha(n,i,r),e!==null&&(qr(e,n,r,s),pm(e,n,r))},enqueueReplaceState:function(n,e,t){n=n._reactInternals;var s=bs(),r=Ga(n),i=Xi(s,r);i.tag=1,i.payload=e,t!=null&&(i.callback=t),e=Ha(n,i,r),e!==null&&(qr(e,n,r,s),pm(e,n,r))},enqueueForceUpdate:function(n,e){n=n._reactInternals;var t=bs(),s=Ga(n),r=Xi(t,s);r.tag=2,e!=null&&(r.callback=e),e=Ha(n,r,s),e!==null&&(qr(e,n,s,t),pm(e,n,s))}};function TN(n,e,t,s,r,i,o){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(s,i,o):e.prototype&&e.prototype.isPureReactComponent?!Bu(t,s)||!Bu(r,i):!0}function lP(n,e,t){var s=!1,r=Xa,i=e.contextType;return typeof i=="object"&&i!==null?i=Cr(i):(r=$s(e)?hl:ls.current,s=e.contextTypes,i=(s=s!=null)?zc(n,r):Xa),e=new e(t,i),n.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=ag,n.stateNode=e,e._reactInternals=n,s&&(n=n.stateNode,n.__reactInternalMemoizedUnmaskedChildContext=r,n.__reactInternalMemoizedMaskedChildContext=i),e}function EN(n,e,t,s){n=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(t,s),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(t,s),e.state!==n&&ag.enqueueReplaceState(e,e.state,null)}function Ev(n,e,t,s){var r=n.stateNode;r.props=t,r.state=n.memoizedState,r.refs={},q0(n);var i=e.contextType;typeof i=="object"&&i!==null?r.context=Cr(i):(i=$s(e)?hl:ls.current,r.context=zc(n,i)),r.state=n.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(Tv(n,e,i,t),r.state=n.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&ag.enqueueReplaceState(r,r.state,null),ep(n,t,r,s),r.state=n.memoizedState),typeof r.componentDidMount=="function"&&(n.flags|=4194308)}function qc(n,e){try{var t="",s=e;do t+=VR(s),s=s.return;while(s);var r=t}catch(i){r=`
Error generating stack: `+i.message+`
`+i.stack}return{value:n,source:e,stack:r,digest:null}}function Ky(n,e,t){return{value:n,source:null,stack:t??null,digest:e??null}}function Pv(n,e){try{console.error(e.value)}catch(t){setTimeout(function(){throw t})}}var p4=typeof WeakMap=="function"?WeakMap:Map;function cP(n,e,t){t=Xi(-1,t),t.tag=3,t.payload={element:null};var s=e.value;return t.callback=function(){ip||(ip=!0,zv=s),Pv(n,e)},t}function dP(n,e,t){t=Xi(-1,t),t.tag=3;var s=n.type.getDerivedStateFromError;if(typeof s=="function"){var r=e.value;t.payload=function(){return s(r)},t.callback=function(){Pv(n,e)}}var i=n.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(t.callback=function(){Pv(n,e),typeof s!="function"&&(Wa===null?Wa=new Set([this]):Wa.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),t}function PN(n,e,t){var s=n.pingCache;if(s===null){s=n.pingCache=new p4;var r=new Set;s.set(e,r)}else r=s.get(e),r===void 0&&(r=new Set,s.set(e,r));r.has(t)||(r.add(t),n=E4.bind(null,n,e,t),e.then(n,n))}function MN(n){do{var e;if((e=n.tag===13)&&(e=n.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return n;n=n.return}while(n!==null);return null}function DN(n,e,t,s,r){return n.mode&1?(n.flags|=65536,n.lanes=r,n):(n===e?n.flags|=65536:(n.flags|=128,t.flags|=131072,t.flags&=-52805,t.tag===1&&(t.alternate===null?t.tag=17:(e=Xi(-1,1),e.tag=2,Ha(t,e,1))),t.lanes|=1),n)}var g4=fa.ReactCurrentOwner,Is=!1;function ps(n,e,t,s){e.child=n===null?$E(e,null,t,s):Vc(e,n.child,t,s)}function AN(n,e,t,s,r){t=t.render;var i=e.ref;return Mc(e,r),s=Z0(n,e,t,s,i,r),t=K0(),n!==null&&!Is?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,ia(n,e,r)):(sn&&t&&L0(e),e.flags|=1,ps(n,e,s,r),e.child)}function IN(n,e,t,s,r){if(n===null){var i=t.type;return typeof i=="function"&&!aw(i)&&i.defaultProps===void 0&&t.compare===null&&t.defaultProps===void 0?(e.tag=15,e.type=i,uP(n,e,i,s,r)):(n=wm(t.type,null,s,e,e.mode,r),n.ref=e.ref,n.return=e,e.child=n)}if(i=n.child,!(n.lanes&r)){var o=i.memoizedProps;if(t=t.compare,t=t!==null?t:Bu,t(o,s)&&n.ref===e.ref)return ia(n,e,r)}return e.flags|=1,n=Ya(i,s),n.ref=e.ref,n.return=e,e.child=n}function uP(n,e,t,s,r){if(n!==null){var i=n.memoizedProps;if(Bu(i,s)&&n.ref===e.ref)if(Is=!1,e.pendingProps=s=i,(n.lanes&r)!==0)n.flags&131072&&(Is=!0);else return e.lanes=n.lanes,ia(n,e,r)}return Mv(n,e,t,s,r)}function hP(n,e,t){var s=e.pendingProps,r=s.children,i=n!==null?n.memoizedState:null;if(s.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yt(_c,Ks),Ks|=t;else{if(!(t&1073741824))return n=i!==null?i.baseLanes|t:t,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:n,cachePool:null,transitions:null},e.updateQueue=null,Yt(_c,Ks),Ks|=n,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},s=i!==null?i.baseLanes:t,Yt(_c,Ks),Ks|=s}else i!==null?(s=i.baseLanes|t,e.memoizedState=null):s=t,Yt(_c,Ks),Ks|=s;return ps(n,e,r,t),e.child}function fP(n,e){var t=e.ref;(n===null&&t!==null||n!==null&&n.ref!==t)&&(e.flags|=512,e.flags|=2097152)}function Mv(n,e,t,s,r){var i=$s(t)?hl:ls.current;return i=zc(e,i),Mc(e,r),t=Z0(n,e,t,s,i,r),s=K0(),n!==null&&!Is?(e.updateQueue=n.updateQueue,e.flags&=-2053,n.lanes&=~r,ia(n,e,r)):(sn&&s&&L0(e),e.flags|=1,ps(n,e,t,r),e.child)}function ON(n,e,t,s,r){if($s(t)){var i=!0;Zm(e)}else i=!1;if(Mc(e,r),e.stateNode===null)xm(n,e),lP(e,t,s),Ev(e,t,s,r),s=!0;else if(n===null){var o=e.stateNode,l=e.memoizedProps;o.props=l;var c=o.context,d=t.contextType;typeof d=="object"&&d!==null?d=Cr(d):(d=$s(t)?hl:ls.current,d=zc(e,d));var h=t.getDerivedStateFromProps,f=typeof h=="function"||typeof o.getSnapshotBeforeUpdate=="function";f||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==s||c!==d)&&EN(e,o,s,d),ka=!1;var p=e.memoizedState;o.state=p,ep(e,s,o,r),c=e.memoizedState,l!==s||p!==c||Fs.current||ka?(typeof h=="function"&&(Tv(e,t,h,s),c=e.memoizedState),(l=ka||TN(e,t,l,s,p,c,d))?(f||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=s,e.memoizedState=c),o.props=s,o.state=c,o.context=d,s=l):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),s=!1)}else{o=e.stateNode,UE(n,e),l=e.memoizedProps,d=e.type===e.elementType?l:Or(e.type,l),o.props=d,f=e.pendingProps,p=o.context,c=t.contextType,typeof c=="object"&&c!==null?c=Cr(c):(c=$s(t)?hl:ls.current,c=zc(e,c));var g=t.getDerivedStateFromProps;(h=typeof g=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(l!==f||p!==c)&&EN(e,o,s,c),ka=!1,p=e.memoizedState,o.state=p,ep(e,s,o,r);var b=e.memoizedState;l!==f||p!==b||Fs.current||ka?(typeof g=="function"&&(Tv(e,t,g,s),b=e.memoizedState),(d=ka||TN(e,t,d,s,p,b,c)||!1)?(h||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(s,b,c),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(s,b,c)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),e.memoizedProps=s,e.memoizedState=b),o.props=s,o.state=b,o.context=c,s=d):(typeof o.componentDidUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||l===n.memoizedProps&&p===n.memoizedState||(e.flags|=1024),s=!1)}return Dv(n,e,t,s,i,r)}function Dv(n,e,t,s,r,i){fP(n,e);var o=(e.flags&128)!==0;if(!s&&!o)return r&&bN(e,t,!1),ia(n,e,i);s=e.stateNode,g4.current=e;var l=o&&typeof t.getDerivedStateFromError!="function"?null:s.render();return e.flags|=1,n!==null&&o?(e.child=Vc(e,n.child,null,i),e.child=Vc(e,null,l,i)):ps(n,e,l,i),e.memoizedState=s.state,r&&bN(e,t,!0),e.child}function mP(n){var e=n.stateNode;e.pendingContext?vN(n,e.pendingContext,e.pendingContext!==e.context):e.context&&vN(n,e.context,!1),H0(n,e.containerInfo)}function RN(n,e,t,s,r){return Uc(),$0(r),e.flags|=256,ps(n,e,t,s),e.child}var Av={dehydrated:null,treeContext:null,retryLane:0};function Iv(n){return{baseLanes:n,cachePool:null,transitions:null}}function pP(n,e,t){var s=e.pendingProps,r=dn.current,i=!1,o=(e.flags&128)!==0,l;if((l=o)||(l=n!==null&&n.memoizedState===null?!1:(r&2)!==0),l?(i=!0,e.flags&=-129):(n===null||n.memoizedState!==null)&&(r|=1),Yt(dn,r&1),n===null)return Cv(e),n=e.memoizedState,n!==null&&(n=n.dehydrated,n!==null)?(e.mode&1?n.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=s.children,n=s.fallback,i?(s=e.mode,i=e.child,o={mode:"hidden",children:o},!(s&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=cg(o,s,0,null),n=al(n,s,t,null),i.return=e,n.return=e,i.sibling=n,e.child=i,e.child.memoizedState=Iv(t),e.memoizedState=Av,n):X0(e,o));if(r=n.memoizedState,r!==null&&(l=r.dehydrated,l!==null))return y4(n,e,o,s,l,r,t);if(i){i=s.fallback,o=e.mode,r=n.child,l=r.sibling;var c={mode:"hidden",children:s.children};return!(o&1)&&e.child!==r?(s=e.child,s.childLanes=0,s.pendingProps=c,e.deletions=null):(s=Ya(r,c),s.subtreeFlags=r.subtreeFlags&14680064),l!==null?i=Ya(l,i):(i=al(i,o,t,null),i.flags|=2),i.return=e,s.return=e,s.sibling=i,e.child=s,s=i,i=e.child,o=n.child.memoizedState,o=o===null?Iv(t):{baseLanes:o.baseLanes|t,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=n.childLanes&~t,e.memoizedState=Av,s}return i=n.child,n=i.sibling,s=Ya(i,{mode:"visible",children:s.children}),!(e.mode&1)&&(s.lanes=t),s.return=e,s.sibling=null,n!==null&&(t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)),e.child=s,e.memoizedState=null,s}function X0(n,e){return e=cg({mode:"visible",children:e},n.mode,0,null),e.return=n,n.child=e}function bf(n,e,t,s){return s!==null&&$0(s),Vc(e,n.child,null,t),n=X0(e,e.pendingProps.children),n.flags|=2,e.memoizedState=null,n}function y4(n,e,t,s,r,i,o){if(t)return e.flags&256?(e.flags&=-257,s=Ky(Error(ke(422))),bf(n,e,o,s)):e.memoizedState!==null?(e.child=n.child,e.flags|=128,null):(i=s.fallback,r=e.mode,s=cg({mode:"visible",children:s.children},r,0,null),i=al(i,r,o,null),i.flags|=2,s.return=e,i.return=e,s.sibling=i,e.child=s,e.mode&1&&Vc(e,n.child,null,o),e.child.memoizedState=Iv(o),e.memoizedState=Av,i);if(!(e.mode&1))return bf(n,e,o,null);if(r.data==="$!"){if(s=r.nextSibling&&r.nextSibling.dataset,s)var l=s.dgst;return s=l,i=Error(ke(419)),s=Ky(i,s,void 0),bf(n,e,o,s)}if(l=(o&n.childLanes)!==0,Is||l){if(s=qn,s!==null){switch(o&-o){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(s.suspendedLanes|o)?0:r,r!==0&&r!==i.retryLane&&(i.retryLane=r,ra(n,r),qr(s,n,r,-1))}return iw(),s=Ky(Error(ke(421))),bf(n,e,o,s)}return r.data==="$?"?(e.flags|=128,e.child=n.child,e=P4.bind(null,n),r._reactRetry=e,null):(n=i.treeContext,nr=qa(r.nextSibling),sr=e,sn=!0,Fr=null,n!==null&&(br[wr++]=Yi,br[wr++]=Zi,br[wr++]=fl,Yi=n.id,Zi=n.overflow,fl=e),e=X0(e,s.children),e.flags|=4096,e)}function LN(n,e,t){n.lanes|=e;var s=n.alternate;s!==null&&(s.lanes|=e),kv(n.return,e,t)}function Jy(n,e,t,s,r){var i=n.memoizedState;i===null?n.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:s,tail:t,tailMode:r}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=s,i.tail=t,i.tailMode=r)}function gP(n,e,t){var s=e.pendingProps,r=s.revealOrder,i=s.tail;if(ps(n,e,s.children,t),s=dn.current,s&2)s=s&1|2,e.flags|=128;else{if(n!==null&&n.flags&128)e:for(n=e.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&LN(n,t,e);else if(n.tag===19)LN(n,t,e);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break e;for(;n.sibling===null;){if(n.return===null||n.return===e)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}s&=1}if(Yt(dn,s),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(t=e.child,r=null;t!==null;)n=t.alternate,n!==null&&tp(n)===null&&(r=t),t=t.sibling;t=r,t===null?(r=e.child,e.child=null):(r=t.sibling,t.sibling=null),Jy(e,!1,r,t,i);break;case"backwards":for(t=null,r=e.child,e.child=null;r!==null;){if(n=r.alternate,n!==null&&tp(n)===null){e.child=r;break}n=r.sibling,r.sibling=t,t=r,r=n}Jy(e,!0,t,null,i);break;case"together":Jy(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function xm(n,e){!(e.mode&1)&&n!==null&&(n.alternate=null,e.alternate=null,e.flags|=2)}function ia(n,e,t){if(n!==null&&(e.dependencies=n.dependencies),pl|=e.lanes,!(t&e.childLanes))return null;if(n!==null&&e.child!==n.child)throw Error(ke(153));if(e.child!==null){for(n=e.child,t=Ya(n,n.pendingProps),e.child=t,t.return=e;n.sibling!==null;)n=n.sibling,t=t.sibling=Ya(n,n.pendingProps),t.return=e;t.sibling=null}return e.child}function x4(n,e,t){switch(e.tag){case 3:mP(e),Uc();break;case 5:VE(e);break;case 1:$s(e.type)&&Zm(e);break;case 4:H0(e,e.stateNode.containerInfo);break;case 10:var s=e.type._context,r=e.memoizedProps.value;Yt(Qm,s._currentValue),s._currentValue=r;break;case 13:if(s=e.memoizedState,s!==null)return s.dehydrated!==null?(Yt(dn,dn.current&1),e.flags|=128,null):t&e.child.childLanes?pP(n,e,t):(Yt(dn,dn.current&1),n=ia(n,e,t),n!==null?n.sibling:null);Yt(dn,dn.current&1);break;case 19:if(s=(t&e.childLanes)!==0,n.flags&128){if(s)return gP(n,e,t);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Yt(dn,dn.current),s)break;return null;case 22:case 23:return e.lanes=0,hP(n,e,t)}return ia(n,e,t)}var yP,Ov,xP,vP;yP=function(n,e){for(var t=e.child;t!==null;){if(t.tag===5||t.tag===6)n.appendChild(t.stateNode);else if(t.tag!==4&&t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return;t=t.return}t.sibling.return=t.return,t=t.sibling}};Ov=function(){};xP=function(n,e,t,s){var r=n.memoizedProps;if(r!==s){n=e.stateNode,el(Si.current);var i=null;switch(t){case"input":r=sv(n,r),s=sv(n,s),i=[];break;case"select":r=pn({},r,{value:void 0}),s=pn({},s,{value:void 0}),i=[];break;case"textarea":r=av(n,r),s=av(n,s),i=[];break;default:typeof r.onClick!="function"&&typeof s.onClick=="function"&&(n.onclick=Gm)}lv(t,s);var o;t=null;for(d in r)if(!s.hasOwnProperty(d)&&r.hasOwnProperty(d)&&r[d]!=null)if(d==="style"){var l=r[d];for(o in l)l.hasOwnProperty(o)&&(t||(t={}),t[o]="")}else d!=="dangerouslySetInnerHTML"&&d!=="children"&&d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&d!=="autoFocus"&&(Ru.hasOwnProperty(d)?i||(i=[]):(i=i||[]).push(d,null));for(d in s){var c=s[d];if(l=r!=null?r[d]:void 0,s.hasOwnProperty(d)&&c!==l&&(c!=null||l!=null))if(d==="style")if(l){for(o in l)!l.hasOwnProperty(o)||c&&c.hasOwnProperty(o)||(t||(t={}),t[o]="");for(o in c)c.hasOwnProperty(o)&&l[o]!==c[o]&&(t||(t={}),t[o]=c[o])}else t||(i||(i=[]),i.push(d,t)),t=c;else d==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,l=l?l.__html:void 0,c!=null&&l!==c&&(i=i||[]).push(d,c)):d==="children"?typeof c!="string"&&typeof c!="number"||(i=i||[]).push(d,""+c):d!=="suppressContentEditableWarning"&&d!=="suppressHydrationWarning"&&(Ru.hasOwnProperty(d)?(c!=null&&d==="onScroll"&&Kt("scroll",n),i||l===c||(i=[])):(i=i||[]).push(d,c))}t&&(i=i||[]).push("style",t);var d=i;(e.updateQueue=d)&&(e.flags|=4)}};vP=function(n,e,t,s){t!==s&&(e.flags|=4)};function $d(n,e){if(!sn)switch(n.tailMode){case"hidden":e=n.tail;for(var t=null;e!==null;)e.alternate!==null&&(t=e),e=e.sibling;t===null?n.tail=null:t.sibling=null;break;case"collapsed":t=n.tail;for(var s=null;t!==null;)t.alternate!==null&&(s=t),t=t.sibling;s===null?e||n.tail===null?n.tail=null:n.tail.sibling=null:s.sibling=null}}function es(n){var e=n.alternate!==null&&n.alternate.child===n.child,t=0,s=0;if(e)for(var r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags&14680064,s|=r.flags&14680064,r.return=n,r=r.sibling;else for(r=n.child;r!==null;)t|=r.lanes|r.childLanes,s|=r.subtreeFlags,s|=r.flags,r.return=n,r=r.sibling;return n.subtreeFlags|=s,n.childLanes=t,e}function v4(n,e,t){var s=e.pendingProps;switch(F0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return es(e),null;case 1:return $s(e.type)&&Ym(),es(e),null;case 3:return s=e.stateNode,Bc(),en(Fs),en(ls),G0(),s.pendingContext&&(s.context=s.pendingContext,s.pendingContext=null),(n===null||n.child===null)&&(xf(e)?e.flags|=4:n===null||n.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Fr!==null&&(Bv(Fr),Fr=null))),Ov(n,e),es(e),null;case 5:W0(e);var r=el(Yu.current);if(t=e.type,n!==null&&e.stateNode!=null)xP(n,e,t,s,r),n.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!s){if(e.stateNode===null)throw Error(ke(166));return es(e),null}if(n=el(Si.current),xf(e)){s=e.stateNode,t=e.type;var i=e.memoizedProps;switch(s[yi]=e,s[Wu]=i,n=(e.mode&1)!==0,t){case"dialog":Kt("cancel",s),Kt("close",s);break;case"iframe":case"object":case"embed":Kt("load",s);break;case"video":case"audio":for(r=0;r<lu.length;r++)Kt(lu[r],s);break;case"source":Kt("error",s);break;case"img":case"image":case"link":Kt("error",s),Kt("load",s);break;case"details":Kt("toggle",s);break;case"input":WS(s,i),Kt("invalid",s);break;case"select":s._wrapperState={wasMultiple:!!i.multiple},Kt("invalid",s);break;case"textarea":YS(s,i),Kt("invalid",s)}lv(t,i),r=null;for(var o in i)if(i.hasOwnProperty(o)){var l=i[o];o==="children"?typeof l=="string"?s.textContent!==l&&(i.suppressHydrationWarning!==!0&&yf(s.textContent,l,n),r=["children",l]):typeof l=="number"&&s.textContent!==""+l&&(i.suppressHydrationWarning!==!0&&yf(s.textContent,l,n),r=["children",""+l]):Ru.hasOwnProperty(o)&&l!=null&&o==="onScroll"&&Kt("scroll",s)}switch(t){case"input":cf(s),GS(s,i,!0);break;case"textarea":cf(s),ZS(s);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(s.onclick=Gm)}s=r,e.updateQueue=s,s!==null&&(e.flags|=4)}else{o=r.nodeType===9?r:r.ownerDocument,n==="http://www.w3.org/1999/xhtml"&&(n=GT(t)),n==="http://www.w3.org/1999/xhtml"?t==="script"?(n=o.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild)):typeof s.is=="string"?n=o.createElement(t,{is:s.is}):(n=o.createElement(t),t==="select"&&(o=n,s.multiple?o.multiple=!0:s.size&&(o.size=s.size))):n=o.createElementNS(n,t),n[yi]=e,n[Wu]=s,yP(n,e,!1,!1),e.stateNode=n;e:{switch(o=cv(t,s),t){case"dialog":Kt("cancel",n),Kt("close",n),r=s;break;case"iframe":case"object":case"embed":Kt("load",n),r=s;break;case"video":case"audio":for(r=0;r<lu.length;r++)Kt(lu[r],n);r=s;break;case"source":Kt("error",n),r=s;break;case"img":case"image":case"link":Kt("error",n),Kt("load",n),r=s;break;case"details":Kt("toggle",n),r=s;break;case"input":WS(n,s),r=sv(n,s),Kt("invalid",n);break;case"option":r=s;break;case"select":n._wrapperState={wasMultiple:!!s.multiple},r=pn({},s,{value:void 0}),Kt("invalid",n);break;case"textarea":YS(n,s),r=av(n,s),Kt("invalid",n);break;default:r=s}lv(t,r),l=r;for(i in l)if(l.hasOwnProperty(i)){var c=l[i];i==="style"?KT(n,c):i==="dangerouslySetInnerHTML"?(c=c?c.__html:void 0,c!=null&&YT(n,c)):i==="children"?typeof c=="string"?(t!=="textarea"||c!=="")&&Lu(n,c):typeof c=="number"&&Lu(n,""+c):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Ru.hasOwnProperty(i)?c!=null&&i==="onScroll"&&Kt("scroll",n):c!=null&&S0(n,i,c,o))}switch(t){case"input":cf(n),GS(n,s,!1);break;case"textarea":cf(n),ZS(n);break;case"option":s.value!=null&&n.setAttribute("value",""+Qa(s.value));break;case"select":n.multiple=!!s.multiple,i=s.value,i!=null?kc(n,!!s.multiple,i,!1):s.defaultValue!=null&&kc(n,!!s.multiple,s.defaultValue,!0);break;default:typeof r.onClick=="function"&&(n.onclick=Gm)}switch(t){case"button":case"input":case"select":case"textarea":s=!!s.autoFocus;break e;case"img":s=!0;break e;default:s=!1}}s&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return es(e),null;case 6:if(n&&e.stateNode!=null)vP(n,e,n.memoizedProps,s);else{if(typeof s!="string"&&e.stateNode===null)throw Error(ke(166));if(t=el(Yu.current),el(Si.current),xf(e)){if(s=e.stateNode,t=e.memoizedProps,s[yi]=e,(i=s.nodeValue!==t)&&(n=sr,n!==null))switch(n.tag){case 3:yf(s.nodeValue,t,(n.mode&1)!==0);break;case 5:n.memoizedProps.suppressHydrationWarning!==!0&&yf(s.nodeValue,t,(n.mode&1)!==0)}i&&(e.flags|=4)}else s=(t.nodeType===9?t:t.ownerDocument).createTextNode(s),s[yi]=e,e.stateNode=s}return es(e),null;case 13:if(en(dn),s=e.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(sn&&nr!==null&&e.mode&1&&!(e.flags&128))LE(),Uc(),e.flags|=98560,i=!1;else if(i=xf(e),s!==null&&s.dehydrated!==null){if(n===null){if(!i)throw Error(ke(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(ke(317));i[yi]=e}else Uc(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;es(e),i=!1}else Fr!==null&&(Bv(Fr),Fr=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=t,e):(s=s!==null,s!==(n!==null&&n.memoizedState!==null)&&s&&(e.child.flags|=8192,e.mode&1&&(n===null||dn.current&1?Rn===0&&(Rn=3):iw())),e.updateQueue!==null&&(e.flags|=4),es(e),null);case 4:return Bc(),Ov(n,e),n===null&&qu(e.stateNode.containerInfo),es(e),null;case 10:return V0(e.type._context),es(e),null;case 17:return $s(e.type)&&Ym(),es(e),null;case 19:if(en(dn),i=e.memoizedState,i===null)return es(e),null;if(s=(e.flags&128)!==0,o=i.rendering,o===null)if(s)$d(i,!1);else{if(Rn!==0||n!==null&&n.flags&128)for(n=e.child;n!==null;){if(o=tp(n),o!==null){for(e.flags|=128,$d(i,!1),s=o.updateQueue,s!==null&&(e.updateQueue=s,e.flags|=4),e.subtreeFlags=0,s=t,t=e.child;t!==null;)i=t,n=s,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=n,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,n=o.dependencies,i.dependencies=n===null?null:{lanes:n.lanes,firstContext:n.firstContext}),t=t.sibling;return Yt(dn,dn.current&1|2),e.child}n=n.sibling}i.tail!==null&&wn()>Hc&&(e.flags|=128,s=!0,$d(i,!1),e.lanes=4194304)}else{if(!s)if(n=tp(o),n!==null){if(e.flags|=128,s=!0,t=n.updateQueue,t!==null&&(e.updateQueue=t,e.flags|=4),$d(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!sn)return es(e),null}else 2*wn()-i.renderingStartTime>Hc&&t!==1073741824&&(e.flags|=128,s=!0,$d(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(t=i.last,t!==null?t.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=wn(),e.sibling=null,t=dn.current,Yt(dn,s?t&1|2:t&1),e):(es(e),null);case 22:case 23:return rw(),s=e.memoizedState!==null,n!==null&&n.memoizedState!==null!==s&&(e.flags|=8192),s&&e.mode&1?Ks&1073741824&&(es(e),e.subtreeFlags&6&&(e.flags|=8192)):es(e),null;case 24:return null;case 25:return null}throw Error(ke(156,e.tag))}function b4(n,e){switch(F0(e),e.tag){case 1:return $s(e.type)&&Ym(),n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 3:return Bc(),en(Fs),en(ls),G0(),n=e.flags,n&65536&&!(n&128)?(e.flags=n&-65537|128,e):null;case 5:return W0(e),null;case 13:if(en(dn),n=e.memoizedState,n!==null&&n.dehydrated!==null){if(e.alternate===null)throw Error(ke(340));Uc()}return n=e.flags,n&65536?(e.flags=n&-65537|128,e):null;case 19:return en(dn),null;case 4:return Bc(),null;case 10:return V0(e.type._context),null;case 22:case 23:return rw(),null;case 24:return null;default:return null}}var wf=!1,rs=!1,w4=typeof WeakSet=="function"?WeakSet:Set,$e=null;function wc(n,e){var t=n.ref;if(t!==null)if(typeof t=="function")try{t(null)}catch(s){gn(n,e,s)}else t.current=null}function Rv(n,e,t){try{t()}catch(s){gn(n,e,s)}}var FN=!1;function _4(n,e){if(vv=qm,n=NE(),R0(n)){if("selectionStart"in n)var t={start:n.selectionStart,end:n.selectionEnd};else e:{t=(t=n.ownerDocument)&&t.defaultView||window;var s=t.getSelection&&t.getSelection();if(s&&s.rangeCount!==0){t=s.anchorNode;var r=s.anchorOffset,i=s.focusNode;s=s.focusOffset;try{t.nodeType,i.nodeType}catch{t=null;break e}var o=0,l=-1,c=-1,d=0,h=0,f=n,p=null;t:for(;;){for(var g;f!==t||r!==0&&f.nodeType!==3||(l=o+r),f!==i||s!==0&&f.nodeType!==3||(c=o+s),f.nodeType===3&&(o+=f.nodeValue.length),(g=f.firstChild)!==null;)p=f,f=g;for(;;){if(f===n)break t;if(p===t&&++d===r&&(l=o),p===i&&++h===s&&(c=o),(g=f.nextSibling)!==null)break;f=p,p=f.parentNode}f=g}t=l===-1||c===-1?null:{start:l,end:c}}else t=null}t=t||{start:0,end:0}}else t=null;for(bv={focusedElem:n,selectionRange:t},qm=!1,$e=e;$e!==null;)if(e=$e,n=e.child,(e.subtreeFlags&1028)!==0&&n!==null)n.return=e,$e=n;else for(;$e!==null;){e=$e;try{var b=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(b!==null){var v=b.memoizedProps,_=b.memoizedState,N=e.stateNode,j=N.getSnapshotBeforeUpdate(e.elementType===e.type?v:Or(e.type,v),_);N.__reactInternalSnapshotBeforeUpdate=j}break;case 3:var k=e.stateNode.containerInfo;k.nodeType===1?k.textContent="":k.nodeType===9&&k.documentElement&&k.removeChild(k.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(S){gn(e,e.return,S)}if(n=e.sibling,n!==null){n.return=e.return,$e=n;break}$e=e.return}return b=FN,FN=!1,b}function Su(n,e,t){var s=e.updateQueue;if(s=s!==null?s.lastEffect:null,s!==null){var r=s=s.next;do{if((r.tag&n)===n){var i=r.destroy;r.destroy=void 0,i!==void 0&&Rv(e,t,i)}r=r.next}while(r!==s)}}function og(n,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var t=e=e.next;do{if((t.tag&n)===n){var s=t.create;t.destroy=s()}t=t.next}while(t!==e)}}function Lv(n){var e=n.ref;if(e!==null){var t=n.stateNode;switch(n.tag){case 5:n=t;break;default:n=t}typeof e=="function"?e(n):e.current=n}}function bP(n){var e=n.alternate;e!==null&&(n.alternate=null,bP(e)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(e=n.stateNode,e!==null&&(delete e[yi],delete e[Wu],delete e[Sv],delete e[r4],delete e[i4])),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}function wP(n){return n.tag===5||n.tag===3||n.tag===4}function $N(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||wP(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function Fv(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.nodeType===8?t.parentNode.insertBefore(n,e):t.insertBefore(n,e):(t.nodeType===8?(e=t.parentNode,e.insertBefore(n,t)):(e=t,e.appendChild(n)),t=t._reactRootContainer,t!=null||e.onclick!==null||(e.onclick=Gm));else if(s!==4&&(n=n.child,n!==null))for(Fv(n,e,t),n=n.sibling;n!==null;)Fv(n,e,t),n=n.sibling}function $v(n,e,t){var s=n.tag;if(s===5||s===6)n=n.stateNode,e?t.insertBefore(n,e):t.appendChild(n);else if(s!==4&&(n=n.child,n!==null))for($v(n,e,t),n=n.sibling;n!==null;)$v(n,e,t),n=n.sibling}var Gn=null,Lr=!1;function ba(n,e,t){for(t=t.child;t!==null;)_P(n,e,t),t=t.sibling}function _P(n,e,t){if(_i&&typeof _i.onCommitFiberUnmount=="function")try{_i.onCommitFiberUnmount(Xp,t)}catch{}switch(t.tag){case 5:rs||wc(t,e);case 6:var s=Gn,r=Lr;Gn=null,ba(n,e,t),Gn=s,Lr=r,Gn!==null&&(Lr?(n=Gn,t=t.stateNode,n.nodeType===8?n.parentNode.removeChild(t):n.removeChild(t)):Gn.removeChild(t.stateNode));break;case 18:Gn!==null&&(Lr?(n=Gn,t=t.stateNode,n.nodeType===8?qy(n.parentNode,t):n.nodeType===1&&qy(n,t),Uu(n)):qy(Gn,t.stateNode));break;case 4:s=Gn,r=Lr,Gn=t.stateNode.containerInfo,Lr=!0,ba(n,e,t),Gn=s,Lr=r;break;case 0:case 11:case 14:case 15:if(!rs&&(s=t.updateQueue,s!==null&&(s=s.lastEffect,s!==null))){r=s=s.next;do{var i=r,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&Rv(t,e,o),r=r.next}while(r!==s)}ba(n,e,t);break;case 1:if(!rs&&(wc(t,e),s=t.stateNode,typeof s.componentWillUnmount=="function"))try{s.props=t.memoizedProps,s.state=t.memoizedState,s.componentWillUnmount()}catch(l){gn(t,e,l)}ba(n,e,t);break;case 21:ba(n,e,t);break;case 22:t.mode&1?(rs=(s=rs)||t.memoizedState!==null,ba(n,e,t),rs=s):ba(n,e,t);break;default:ba(n,e,t)}}function zN(n){var e=n.updateQueue;if(e!==null){n.updateQueue=null;var t=n.stateNode;t===null&&(t=n.stateNode=new w4),e.forEach(function(s){var r=M4.bind(null,n,s);t.has(s)||(t.add(s),s.then(r,r))})}}function Dr(n,e){var t=e.deletions;if(t!==null)for(var s=0;s<t.length;s++){var r=t[s];try{var i=n,o=e,l=o;e:for(;l!==null;){switch(l.tag){case 5:Gn=l.stateNode,Lr=!1;break e;case 3:Gn=l.stateNode.containerInfo,Lr=!0;break e;case 4:Gn=l.stateNode.containerInfo,Lr=!0;break e}l=l.return}if(Gn===null)throw Error(ke(160));_P(i,o,r),Gn=null,Lr=!1;var c=r.alternate;c!==null&&(c.return=null),r.return=null}catch(d){gn(r,e,d)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)SP(e,n),e=e.sibling}function SP(n,e){var t=n.alternate,s=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:if(Dr(e,n),ai(n),s&4){try{Su(3,n,n.return),og(3,n)}catch(v){gn(n,n.return,v)}try{Su(5,n,n.return)}catch(v){gn(n,n.return,v)}}break;case 1:Dr(e,n),ai(n),s&512&&t!==null&&wc(t,t.return);break;case 5:if(Dr(e,n),ai(n),s&512&&t!==null&&wc(t,t.return),n.flags&32){var r=n.stateNode;try{Lu(r,"")}catch(v){gn(n,n.return,v)}}if(s&4&&(r=n.stateNode,r!=null)){var i=n.memoizedProps,o=t!==null?t.memoizedProps:i,l=n.type,c=n.updateQueue;if(n.updateQueue=null,c!==null)try{l==="input"&&i.type==="radio"&&i.name!=null&&HT(r,i),cv(l,o);var d=cv(l,i);for(o=0;o<c.length;o+=2){var h=c[o],f=c[o+1];h==="style"?KT(r,f):h==="dangerouslySetInnerHTML"?YT(r,f):h==="children"?Lu(r,f):S0(r,h,f,d)}switch(l){case"input":rv(r,i);break;case"textarea":WT(r,i);break;case"select":var p=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!i.multiple;var g=i.value;g!=null?kc(r,!!i.multiple,g,!1):p!==!!i.multiple&&(i.defaultValue!=null?kc(r,!!i.multiple,i.defaultValue,!0):kc(r,!!i.multiple,i.multiple?[]:"",!1))}r[Wu]=i}catch(v){gn(n,n.return,v)}}break;case 6:if(Dr(e,n),ai(n),s&4){if(n.stateNode===null)throw Error(ke(162));r=n.stateNode,i=n.memoizedProps;try{r.nodeValue=i}catch(v){gn(n,n.return,v)}}break;case 3:if(Dr(e,n),ai(n),s&4&&t!==null&&t.memoizedState.isDehydrated)try{Uu(e.containerInfo)}catch(v){gn(n,n.return,v)}break;case 4:Dr(e,n),ai(n);break;case 13:Dr(e,n),ai(n),r=n.child,r.flags&8192&&(i=r.memoizedState!==null,r.stateNode.isHidden=i,!i||r.alternate!==null&&r.alternate.memoizedState!==null||(nw=wn())),s&4&&zN(n);break;case 22:if(h=t!==null&&t.memoizedState!==null,n.mode&1?(rs=(d=rs)||h,Dr(e,n),rs=d):Dr(e,n),ai(n),s&8192){if(d=n.memoizedState!==null,(n.stateNode.isHidden=d)&&!h&&n.mode&1)for($e=n,h=n.child;h!==null;){for(f=$e=h;$e!==null;){switch(p=$e,g=p.child,p.tag){case 0:case 11:case 14:case 15:Su(4,p,p.return);break;case 1:wc(p,p.return);var b=p.stateNode;if(typeof b.componentWillUnmount=="function"){s=p,t=p.return;try{e=s,b.props=e.memoizedProps,b.state=e.memoizedState,b.componentWillUnmount()}catch(v){gn(s,t,v)}}break;case 5:wc(p,p.return);break;case 22:if(p.memoizedState!==null){VN(f);continue}}g!==null?(g.return=p,$e=g):VN(f)}h=h.sibling}e:for(h=null,f=n;;){if(f.tag===5){if(h===null){h=f;try{r=f.stateNode,d?(i=r.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(l=f.stateNode,c=f.memoizedProps.style,o=c!=null&&c.hasOwnProperty("display")?c.display:null,l.style.display=ZT("display",o))}catch(v){gn(n,n.return,v)}}}else if(f.tag===6){if(h===null)try{f.stateNode.nodeValue=d?"":f.memoizedProps}catch(v){gn(n,n.return,v)}}else if((f.tag!==22&&f.tag!==23||f.memoizedState===null||f===n)&&f.child!==null){f.child.return=f,f=f.child;continue}if(f===n)break e;for(;f.sibling===null;){if(f.return===null||f.return===n)break e;h===f&&(h=null),f=f.return}h===f&&(h=null),f.sibling.return=f.return,f=f.sibling}}break;case 19:Dr(e,n),ai(n),s&4&&zN(n);break;case 21:break;default:Dr(e,n),ai(n)}}function ai(n){var e=n.flags;if(e&2){try{e:{for(var t=n.return;t!==null;){if(wP(t)){var s=t;break e}t=t.return}throw Error(ke(160))}switch(s.tag){case 5:var r=s.stateNode;s.flags&32&&(Lu(r,""),s.flags&=-33);var i=$N(n);$v(n,i,r);break;case 3:case 4:var o=s.stateNode.containerInfo,l=$N(n);Fv(n,l,o);break;default:throw Error(ke(161))}}catch(c){gn(n,n.return,c)}n.flags&=-3}e&4096&&(n.flags&=-4097)}function S4(n,e,t){$e=n,NP(n)}function NP(n,e,t){for(var s=(n.mode&1)!==0;$e!==null;){var r=$e,i=r.child;if(r.tag===22&&s){var o=r.memoizedState!==null||wf;if(!o){var l=r.alternate,c=l!==null&&l.memoizedState!==null||rs;l=wf;var d=rs;if(wf=o,(rs=c)&&!d)for($e=r;$e!==null;)o=$e,c=o.child,o.tag===22&&o.memoizedState!==null?BN(r):c!==null?(c.return=o,$e=c):BN(r);for(;i!==null;)$e=i,NP(i),i=i.sibling;$e=r,wf=l,rs=d}UN(n)}else r.subtreeFlags&8772&&i!==null?(i.return=r,$e=i):UN(n)}}function UN(n){for(;$e!==null;){var e=$e;if(e.flags&8772){var t=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:rs||og(5,e);break;case 1:var s=e.stateNode;if(e.flags&4&&!rs)if(t===null)s.componentDidMount();else{var r=e.elementType===e.type?t.memoizedProps:Or(e.type,t.memoizedProps);s.componentDidUpdate(r,t.memoizedState,s.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&jN(e,i,s);break;case 3:var o=e.updateQueue;if(o!==null){if(t=null,e.child!==null)switch(e.child.tag){case 5:t=e.child.stateNode;break;case 1:t=e.child.stateNode}jN(e,o,t)}break;case 5:var l=e.stateNode;if(t===null&&e.flags&4){t=l;var c=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&t.focus();break;case"img":c.src&&(t.src=c.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var d=e.alternate;if(d!==null){var h=d.memoizedState;if(h!==null){var f=h.dehydrated;f!==null&&Uu(f)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}rs||e.flags&512&&Lv(e)}catch(p){gn(e,e.return,p)}}if(e===n){$e=null;break}if(t=e.sibling,t!==null){t.return=e.return,$e=t;break}$e=e.return}}function VN(n){for(;$e!==null;){var e=$e;if(e===n){$e=null;break}var t=e.sibling;if(t!==null){t.return=e.return,$e=t;break}$e=e.return}}function BN(n){for(;$e!==null;){var e=$e;try{switch(e.tag){case 0:case 11:case 15:var t=e.return;try{og(4,e)}catch(c){gn(e,t,c)}break;case 1:var s=e.stateNode;if(typeof s.componentDidMount=="function"){var r=e.return;try{s.componentDidMount()}catch(c){gn(e,r,c)}}var i=e.return;try{Lv(e)}catch(c){gn(e,i,c)}break;case 5:var o=e.return;try{Lv(e)}catch(c){gn(e,o,c)}}}catch(c){gn(e,e.return,c)}if(e===n){$e=null;break}var l=e.sibling;if(l!==null){l.return=e.return,$e=l;break}$e=e.return}}var N4=Math.ceil,rp=fa.ReactCurrentDispatcher,ew=fa.ReactCurrentOwner,Nr=fa.ReactCurrentBatchConfig,Ct=0,qn=null,Mn=null,Kn=0,Ks=0,_c=uo(0),Rn=0,Qu=null,pl=0,lg=0,tw=0,Nu=null,Ds=null,nw=0,Hc=1/0,Bi=null,ip=!1,zv=null,Wa=null,_f=!1,Aa=null,ap=0,ju=0,Uv=null,vm=-1,bm=0;function bs(){return Ct&6?wn():vm!==-1?vm:vm=wn()}function Ga(n){return n.mode&1?Ct&2&&Kn!==0?Kn&-Kn:o4.transition!==null?(bm===0&&(bm=lE()),bm):(n=Ot,n!==0||(n=window.event,n=n===void 0?16:pE(n.type)),n):1}function qr(n,e,t,s){if(50<ju)throw ju=0,Uv=null,Error(ke(185));bh(n,t,s),(!(Ct&2)||n!==qn)&&(n===qn&&(!(Ct&2)&&(lg|=t),Rn===4&&Pa(n,Kn)),zs(n,s),t===1&&Ct===0&&!(e.mode&1)&&(Hc=wn()+500,rg&&ho()))}function zs(n,e){var t=n.callbackNode;oL(n,e);var s=Bm(n,n===qn?Kn:0);if(s===0)t!==null&&QS(t),n.callbackNode=null,n.callbackPriority=0;else if(e=s&-s,n.callbackPriority!==e){if(t!=null&&QS(t),e===1)n.tag===0?a4(qN.bind(null,n)):IE(qN.bind(null,n)),n4(function(){!(Ct&6)&&ho()}),t=null;else{switch(cE(s)){case 1:t=T0;break;case 4:t=aE;break;case 16:t=Vm;break;case 536870912:t=oE;break;default:t=Vm}t=DP(t,jP.bind(null,n))}n.callbackPriority=e,n.callbackNode=t}}function jP(n,e){if(vm=-1,bm=0,Ct&6)throw Error(ke(327));var t=n.callbackNode;if(Dc()&&n.callbackNode!==t)return null;var s=Bm(n,n===qn?Kn:0);if(s===0)return null;if(s&30||s&n.expiredLanes||e)e=op(n,s);else{e=s;var r=Ct;Ct|=2;var i=kP();(qn!==n||Kn!==e)&&(Bi=null,Hc=wn()+500,il(n,e));do try{k4();break}catch(l){CP(n,l)}while(!0);U0(),rp.current=i,Ct=r,Mn!==null?e=0:(qn=null,Kn=0,e=Rn)}if(e!==0){if(e===2&&(r=mv(n),r!==0&&(s=r,e=Vv(n,r))),e===1)throw t=Qu,il(n,0),Pa(n,s),zs(n,wn()),t;if(e===6)Pa(n,s);else{if(r=n.current.alternate,!(s&30)&&!j4(r)&&(e=op(n,s),e===2&&(i=mv(n),i!==0&&(s=i,e=Vv(n,i))),e===1))throw t=Qu,il(n,0),Pa(n,s),zs(n,wn()),t;switch(n.finishedWork=r,n.finishedLanes=s,e){case 0:case 1:throw Error(ke(345));case 2:Bo(n,Ds,Bi);break;case 3:if(Pa(n,s),(s&130023424)===s&&(e=nw+500-wn(),10<e)){if(Bm(n,0)!==0)break;if(r=n.suspendedLanes,(r&s)!==s){bs(),n.pingedLanes|=n.suspendedLanes&r;break}n.timeoutHandle=_v(Bo.bind(null,n,Ds,Bi),e);break}Bo(n,Ds,Bi);break;case 4:if(Pa(n,s),(s&4194240)===s)break;for(e=n.eventTimes,r=-1;0<s;){var o=31-Br(s);i=1<<o,o=e[o],o>r&&(r=o),s&=~i}if(s=r,s=wn()-s,s=(120>s?120:480>s?480:1080>s?1080:1920>s?1920:3e3>s?3e3:4320>s?4320:1960*N4(s/1960))-s,10<s){n.timeoutHandle=_v(Bo.bind(null,n,Ds,Bi),s);break}Bo(n,Ds,Bi);break;case 5:Bo(n,Ds,Bi);break;default:throw Error(ke(329))}}}return zs(n,wn()),n.callbackNode===t?jP.bind(null,n):null}function Vv(n,e){var t=Nu;return n.current.memoizedState.isDehydrated&&(il(n,e).flags|=256),n=op(n,e),n!==2&&(e=Ds,Ds=t,e!==null&&Bv(e)),n}function Bv(n){Ds===null?Ds=n:Ds.push.apply(Ds,n)}function j4(n){for(var e=n;;){if(e.flags&16384){var t=e.updateQueue;if(t!==null&&(t=t.stores,t!==null))for(var s=0;s<t.length;s++){var r=t[s],i=r.getSnapshot;r=r.value;try{if(!Gr(i(),r))return!1}catch{return!1}}}if(t=e.child,e.subtreeFlags&16384&&t!==null)t.return=e,e=t;else{if(e===n)break;for(;e.sibling===null;){if(e.return===null||e.return===n)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Pa(n,e){for(e&=~tw,e&=~lg,n.suspendedLanes|=e,n.pingedLanes&=~e,n=n.expirationTimes;0<e;){var t=31-Br(e),s=1<<t;n[t]=-1,e&=~s}}function qN(n){if(Ct&6)throw Error(ke(327));Dc();var e=Bm(n,0);if(!(e&1))return zs(n,wn()),null;var t=op(n,e);if(n.tag!==0&&t===2){var s=mv(n);s!==0&&(e=s,t=Vv(n,s))}if(t===1)throw t=Qu,il(n,0),Pa(n,e),zs(n,wn()),t;if(t===6)throw Error(ke(345));return n.finishedWork=n.current.alternate,n.finishedLanes=e,Bo(n,Ds,Bi),zs(n,wn()),null}function sw(n,e){var t=Ct;Ct|=1;try{return n(e)}finally{Ct=t,Ct===0&&(Hc=wn()+500,rg&&ho())}}function gl(n){Aa!==null&&Aa.tag===0&&!(Ct&6)&&Dc();var e=Ct;Ct|=1;var t=Nr.transition,s=Ot;try{if(Nr.transition=null,Ot=1,n)return n()}finally{Ot=s,Nr.transition=t,Ct=e,!(Ct&6)&&ho()}}function rw(){Ks=_c.current,en(_c)}function il(n,e){n.finishedWork=null,n.finishedLanes=0;var t=n.timeoutHandle;if(t!==-1&&(n.timeoutHandle=-1,t4(t)),Mn!==null)for(t=Mn.return;t!==null;){var s=t;switch(F0(s),s.tag){case 1:s=s.type.childContextTypes,s!=null&&Ym();break;case 3:Bc(),en(Fs),en(ls),G0();break;case 5:W0(s);break;case 4:Bc();break;case 13:en(dn);break;case 19:en(dn);break;case 10:V0(s.type._context);break;case 22:case 23:rw()}t=t.return}if(qn=n,Mn=n=Ya(n.current,null),Kn=Ks=e,Rn=0,Qu=null,tw=lg=pl=0,Ds=Nu=null,Xo!==null){for(e=0;e<Xo.length;e++)if(t=Xo[e],s=t.interleaved,s!==null){t.interleaved=null;var r=s.next,i=t.pending;if(i!==null){var o=i.next;i.next=r,s.next=o}t.pending=s}Xo=null}return n}function CP(n,e){do{var t=Mn;try{if(U0(),gm.current=sp,np){for(var s=fn.memoizedState;s!==null;){var r=s.queue;r!==null&&(r.pending=null),s=s.next}np=!1}if(ml=0,Bn=In=fn=null,_u=!1,Zu=0,ew.current=null,t===null||t.return===null){Rn=1,Qu=e,Mn=null;break}e:{var i=n,o=t.return,l=t,c=e;if(e=Kn,l.flags|=32768,c!==null&&typeof c=="object"&&typeof c.then=="function"){var d=c,h=l,f=h.tag;if(!(h.mode&1)&&(f===0||f===11||f===15)){var p=h.alternate;p?(h.updateQueue=p.updateQueue,h.memoizedState=p.memoizedState,h.lanes=p.lanes):(h.updateQueue=null,h.memoizedState=null)}var g=MN(o);if(g!==null){g.flags&=-257,DN(g,o,l,i,e),g.mode&1&&PN(i,d,e),e=g,c=d;var b=e.updateQueue;if(b===null){var v=new Set;v.add(c),e.updateQueue=v}else b.add(c);break e}else{if(!(e&1)){PN(i,d,e),iw();break e}c=Error(ke(426))}}else if(sn&&l.mode&1){var _=MN(o);if(_!==null){!(_.flags&65536)&&(_.flags|=256),DN(_,o,l,i,e),$0(qc(c,l));break e}}i=c=qc(c,l),Rn!==4&&(Rn=2),Nu===null?Nu=[i]:Nu.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var N=cP(i,c,e);NN(i,N);break e;case 1:l=c;var j=i.type,k=i.stateNode;if(!(i.flags&128)&&(typeof j.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(Wa===null||!Wa.has(k)))){i.flags|=65536,e&=-e,i.lanes|=e;var S=dP(i,l,e);NN(i,S);break e}}i=i.return}while(i!==null)}EP(t)}catch(P){e=P,Mn===t&&t!==null&&(Mn=t=t.return);continue}break}while(!0)}function kP(){var n=rp.current;return rp.current=sp,n===null?sp:n}function iw(){(Rn===0||Rn===3||Rn===2)&&(Rn=4),qn===null||!(pl&268435455)&&!(lg&268435455)||Pa(qn,Kn)}function op(n,e){var t=Ct;Ct|=2;var s=kP();(qn!==n||Kn!==e)&&(Bi=null,il(n,e));do try{C4();break}catch(r){CP(n,r)}while(!0);if(U0(),Ct=t,rp.current=s,Mn!==null)throw Error(ke(261));return qn=null,Kn=0,Rn}function C4(){for(;Mn!==null;)TP(Mn)}function k4(){for(;Mn!==null&&!QR();)TP(Mn)}function TP(n){var e=MP(n.alternate,n,Ks);n.memoizedProps=n.pendingProps,e===null?EP(n):Mn=e,ew.current=null}function EP(n){var e=n;do{var t=e.alternate;if(n=e.return,e.flags&32768){if(t=b4(t,e),t!==null){t.flags&=32767,Mn=t;return}if(n!==null)n.flags|=32768,n.subtreeFlags=0,n.deletions=null;else{Rn=6,Mn=null;return}}else if(t=v4(t,e,Ks),t!==null){Mn=t;return}if(e=e.sibling,e!==null){Mn=e;return}Mn=e=n}while(e!==null);Rn===0&&(Rn=5)}function Bo(n,e,t){var s=Ot,r=Nr.transition;try{Nr.transition=null,Ot=1,T4(n,e,t,s)}finally{Nr.transition=r,Ot=s}return null}function T4(n,e,t,s){do Dc();while(Aa!==null);if(Ct&6)throw Error(ke(327));t=n.finishedWork;var r=n.finishedLanes;if(t===null)return null;if(n.finishedWork=null,n.finishedLanes=0,t===n.current)throw Error(ke(177));n.callbackNode=null,n.callbackPriority=0;var i=t.lanes|t.childLanes;if(lL(n,i),n===qn&&(Mn=qn=null,Kn=0),!(t.subtreeFlags&2064)&&!(t.flags&2064)||_f||(_f=!0,DP(Vm,function(){return Dc(),null})),i=(t.flags&15990)!==0,t.subtreeFlags&15990||i){i=Nr.transition,Nr.transition=null;var o=Ot;Ot=1;var l=Ct;Ct|=4,ew.current=null,_4(n,t),SP(t,n),YL(bv),qm=!!vv,bv=vv=null,n.current=t,S4(t),XR(),Ct=l,Ot=o,Nr.transition=i}else n.current=t;if(_f&&(_f=!1,Aa=n,ap=r),i=n.pendingLanes,i===0&&(Wa=null),nL(t.stateNode),zs(n,wn()),e!==null)for(s=n.onRecoverableError,t=0;t<e.length;t++)r=e[t],s(r.value,{componentStack:r.stack,digest:r.digest});if(ip)throw ip=!1,n=zv,zv=null,n;return ap&1&&n.tag!==0&&Dc(),i=n.pendingLanes,i&1?n===Uv?ju++:(ju=0,Uv=n):ju=0,ho(),null}function Dc(){if(Aa!==null){var n=cE(ap),e=Nr.transition,t=Ot;try{if(Nr.transition=null,Ot=16>n?16:n,Aa===null)var s=!1;else{if(n=Aa,Aa=null,ap=0,Ct&6)throw Error(ke(331));var r=Ct;for(Ct|=4,$e=n.current;$e!==null;){var i=$e,o=i.child;if($e.flags&16){var l=i.deletions;if(l!==null){for(var c=0;c<l.length;c++){var d=l[c];for($e=d;$e!==null;){var h=$e;switch(h.tag){case 0:case 11:case 15:Su(8,h,i)}var f=h.child;if(f!==null)f.return=h,$e=f;else for(;$e!==null;){h=$e;var p=h.sibling,g=h.return;if(bP(h),h===d){$e=null;break}if(p!==null){p.return=g,$e=p;break}$e=g}}}var b=i.alternate;if(b!==null){var v=b.child;if(v!==null){b.child=null;do{var _=v.sibling;v.sibling=null,v=_}while(v!==null)}}$e=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,$e=o;else e:for(;$e!==null;){if(i=$e,i.flags&2048)switch(i.tag){case 0:case 11:case 15:Su(9,i,i.return)}var N=i.sibling;if(N!==null){N.return=i.return,$e=N;break e}$e=i.return}}var j=n.current;for($e=j;$e!==null;){o=$e;var k=o.child;if(o.subtreeFlags&2064&&k!==null)k.return=o,$e=k;else e:for(o=j;$e!==null;){if(l=$e,l.flags&2048)try{switch(l.tag){case 0:case 11:case 15:og(9,l)}}catch(P){gn(l,l.return,P)}if(l===o){$e=null;break e}var S=l.sibling;if(S!==null){S.return=l.return,$e=S;break e}$e=l.return}}if(Ct=r,ho(),_i&&typeof _i.onPostCommitFiberRoot=="function")try{_i.onPostCommitFiberRoot(Xp,n)}catch{}s=!0}return s}finally{Ot=t,Nr.transition=e}}return!1}function HN(n,e,t){e=qc(t,e),e=cP(n,e,1),n=Ha(n,e,1),e=bs(),n!==null&&(bh(n,1,e),zs(n,e))}function gn(n,e,t){if(n.tag===3)HN(n,n,t);else for(;e!==null;){if(e.tag===3){HN(e,n,t);break}else if(e.tag===1){var s=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof s.componentDidCatch=="function"&&(Wa===null||!Wa.has(s))){n=qc(t,n),n=dP(e,n,1),e=Ha(e,n,1),n=bs(),e!==null&&(bh(e,1,n),zs(e,n));break}}e=e.return}}function E4(n,e,t){var s=n.pingCache;s!==null&&s.delete(e),e=bs(),n.pingedLanes|=n.suspendedLanes&t,qn===n&&(Kn&t)===t&&(Rn===4||Rn===3&&(Kn&130023424)===Kn&&500>wn()-nw?il(n,0):tw|=t),zs(n,e)}function PP(n,e){e===0&&(n.mode&1?(e=hf,hf<<=1,!(hf&130023424)&&(hf=4194304)):e=1);var t=bs();n=ra(n,e),n!==null&&(bh(n,e,t),zs(n,t))}function P4(n){var e=n.memoizedState,t=0;e!==null&&(t=e.retryLane),PP(n,t)}function M4(n,e){var t=0;switch(n.tag){case 13:var s=n.stateNode,r=n.memoizedState;r!==null&&(t=r.retryLane);break;case 19:s=n.stateNode;break;default:throw Error(ke(314))}s!==null&&s.delete(e),PP(n,t)}var MP;MP=function(n,e,t){if(n!==null)if(n.memoizedProps!==e.pendingProps||Fs.current)Is=!0;else{if(!(n.lanes&t)&&!(e.flags&128))return Is=!1,x4(n,e,t);Is=!!(n.flags&131072)}else Is=!1,sn&&e.flags&1048576&&OE(e,Jm,e.index);switch(e.lanes=0,e.tag){case 2:var s=e.type;xm(n,e),n=e.pendingProps;var r=zc(e,ls.current);Mc(e,t),r=Z0(null,e,s,n,r,t);var i=K0();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,$s(s)?(i=!0,Zm(e)):i=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,q0(e),r.updater=ag,e.stateNode=r,r._reactInternals=e,Ev(e,s,n,t),e=Dv(null,e,s,!0,i,t)):(e.tag=0,sn&&i&&L0(e),ps(null,e,r,t),e=e.child),e;case 16:s=e.elementType;e:{switch(xm(n,e),n=e.pendingProps,r=s._init,s=r(s._payload),e.type=s,r=e.tag=A4(s),n=Or(s,n),r){case 0:e=Mv(null,e,s,n,t);break e;case 1:e=ON(null,e,s,n,t);break e;case 11:e=AN(null,e,s,n,t);break e;case 14:e=IN(null,e,s,Or(s.type,n),t);break e}throw Error(ke(306,s,""))}return e;case 0:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Or(s,r),Mv(n,e,s,r,t);case 1:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Or(s,r),ON(n,e,s,r,t);case 3:e:{if(mP(e),n===null)throw Error(ke(387));s=e.pendingProps,i=e.memoizedState,r=i.element,UE(n,e),ep(e,s,null,t);var o=e.memoizedState;if(s=o.element,i.isDehydrated)if(i={element:s,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){r=qc(Error(ke(423)),e),e=RN(n,e,s,t,r);break e}else if(s!==r){r=qc(Error(ke(424)),e),e=RN(n,e,s,t,r);break e}else for(nr=qa(e.stateNode.containerInfo.firstChild),sr=e,sn=!0,Fr=null,t=$E(e,null,s,t),e.child=t;t;)t.flags=t.flags&-3|4096,t=t.sibling;else{if(Uc(),s===r){e=ia(n,e,t);break e}ps(n,e,s,t)}e=e.child}return e;case 5:return VE(e),n===null&&Cv(e),s=e.type,r=e.pendingProps,i=n!==null?n.memoizedProps:null,o=r.children,wv(s,r)?o=null:i!==null&&wv(s,i)&&(e.flags|=32),fP(n,e),ps(n,e,o,t),e.child;case 6:return n===null&&Cv(e),null;case 13:return pP(n,e,t);case 4:return H0(e,e.stateNode.containerInfo),s=e.pendingProps,n===null?e.child=Vc(e,null,s,t):ps(n,e,s,t),e.child;case 11:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Or(s,r),AN(n,e,s,r,t);case 7:return ps(n,e,e.pendingProps,t),e.child;case 8:return ps(n,e,e.pendingProps.children,t),e.child;case 12:return ps(n,e,e.pendingProps.children,t),e.child;case 10:e:{if(s=e.type._context,r=e.pendingProps,i=e.memoizedProps,o=r.value,Yt(Qm,s._currentValue),s._currentValue=o,i!==null)if(Gr(i.value,o)){if(i.children===r.children&&!Fs.current){e=ia(n,e,t);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var l=i.dependencies;if(l!==null){o=i.child;for(var c=l.firstContext;c!==null;){if(c.context===s){if(i.tag===1){c=Xi(-1,t&-t),c.tag=2;var d=i.updateQueue;if(d!==null){d=d.shared;var h=d.pending;h===null?c.next=c:(c.next=h.next,h.next=c),d.pending=c}}i.lanes|=t,c=i.alternate,c!==null&&(c.lanes|=t),kv(i.return,t,e),l.lanes|=t;break}c=c.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(ke(341));o.lanes|=t,l=o.alternate,l!==null&&(l.lanes|=t),kv(o,t,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}ps(n,e,r.children,t),e=e.child}return e;case 9:return r=e.type,s=e.pendingProps.children,Mc(e,t),r=Cr(r),s=s(r),e.flags|=1,ps(n,e,s,t),e.child;case 14:return s=e.type,r=Or(s,e.pendingProps),r=Or(s.type,r),IN(n,e,s,r,t);case 15:return uP(n,e,e.type,e.pendingProps,t);case 17:return s=e.type,r=e.pendingProps,r=e.elementType===s?r:Or(s,r),xm(n,e),e.tag=1,$s(s)?(n=!0,Zm(e)):n=!1,Mc(e,t),lP(e,s,r),Ev(e,s,r,t),Dv(null,e,s,!0,n,t);case 19:return gP(n,e,t);case 22:return hP(n,e,t)}throw Error(ke(156,e.tag))};function DP(n,e){return iE(n,e)}function D4(n,e,t,s){this.tag=n,this.key=t,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=s,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Sr(n,e,t,s){return new D4(n,e,t,s)}function aw(n){return n=n.prototype,!(!n||!n.isReactComponent)}function A4(n){if(typeof n=="function")return aw(n)?1:0;if(n!=null){if(n=n.$$typeof,n===j0)return 11;if(n===C0)return 14}return 2}function Ya(n,e){var t=n.alternate;return t===null?(t=Sr(n.tag,e,n.key,n.mode),t.elementType=n.elementType,t.type=n.type,t.stateNode=n.stateNode,t.alternate=n,n.alternate=t):(t.pendingProps=e,t.type=n.type,t.flags=0,t.subtreeFlags=0,t.deletions=null),t.flags=n.flags&14680064,t.childLanes=n.childLanes,t.lanes=n.lanes,t.child=n.child,t.memoizedProps=n.memoizedProps,t.memoizedState=n.memoizedState,t.updateQueue=n.updateQueue,e=n.dependencies,t.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},t.sibling=n.sibling,t.index=n.index,t.ref=n.ref,t}function wm(n,e,t,s,r,i){var o=2;if(s=n,typeof n=="function")aw(n)&&(o=1);else if(typeof n=="string")o=5;else e:switch(n){case hc:return al(t.children,r,i,e);case N0:o=8,r|=8;break;case Xx:return n=Sr(12,t,e,r|2),n.elementType=Xx,n.lanes=i,n;case ev:return n=Sr(13,t,e,r),n.elementType=ev,n.lanes=i,n;case tv:return n=Sr(19,t,e,r),n.elementType=tv,n.lanes=i,n;case VT:return cg(t,r,i,e);default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case zT:o=10;break e;case UT:o=9;break e;case j0:o=11;break e;case C0:o=14;break e;case Ca:o=16,s=null;break e}throw Error(ke(130,n==null?n:typeof n,""))}return e=Sr(o,t,e,r),e.elementType=n,e.type=s,e.lanes=i,e}function al(n,e,t,s){return n=Sr(7,n,s,e),n.lanes=t,n}function cg(n,e,t,s){return n=Sr(22,n,s,e),n.elementType=VT,n.lanes=t,n.stateNode={isHidden:!1},n}function Qy(n,e,t){return n=Sr(6,n,null,e),n.lanes=t,n}function Xy(n,e,t){return e=Sr(4,n.children!==null?n.children:[],n.key,e),e.lanes=t,e.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},e}function I4(n,e,t,s,r){this.tag=e,this.containerInfo=n,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ay(0),this.expirationTimes=Ay(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ay(0),this.identifierPrefix=s,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function ow(n,e,t,s,r,i,o,l,c){return n=new I4(n,e,t,l,c),e===1?(e=1,i===!0&&(e|=8)):e=0,i=Sr(3,null,null,e),n.current=i,i.stateNode=n,i.memoizedState={element:s,isDehydrated:t,cache:null,transitions:null,pendingSuspenseBoundaries:null},q0(i),n}function O4(n,e,t){var s=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:uc,key:s==null?null:""+s,children:n,containerInfo:e,implementation:t}}function AP(n){if(!n)return Xa;n=n._reactInternals;e:{if(Cl(n)!==n||n.tag!==1)throw Error(ke(170));var e=n;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if($s(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ke(171))}if(n.tag===1){var t=n.type;if($s(t))return AE(n,t,e)}return e}function IP(n,e,t,s,r,i,o,l,c){return n=ow(t,s,!0,n,r,i,o,l,c),n.context=AP(null),t=n.current,s=bs(),r=Ga(t),i=Xi(s,r),i.callback=e??null,Ha(t,i,r),n.current.lanes=r,bh(n,r,s),zs(n,s),n}function dg(n,e,t,s){var r=e.current,i=bs(),o=Ga(r);return t=AP(t),e.context===null?e.context=t:e.pendingContext=t,e=Xi(i,o),e.payload={element:n},s=s===void 0?null:s,s!==null&&(e.callback=s),n=Ha(r,e,o),n!==null&&(qr(n,r,o,i),pm(n,r,o)),o}function lp(n){if(n=n.current,!n.child)return null;switch(n.child.tag){case 5:return n.child.stateNode;default:return n.child.stateNode}}function WN(n,e){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var t=n.retryLane;n.retryLane=t!==0&&t<e?t:e}}function lw(n,e){WN(n,e),(n=n.alternate)&&WN(n,e)}function R4(){return null}var OP=typeof reportError=="function"?reportError:function(n){console.error(n)};function cw(n){this._internalRoot=n}ug.prototype.render=cw.prototype.render=function(n){var e=this._internalRoot;if(e===null)throw Error(ke(409));dg(n,e,null,null)};ug.prototype.unmount=cw.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var e=n.containerInfo;gl(function(){dg(null,n,null,null)}),e[sa]=null}};function ug(n){this._internalRoot=n}ug.prototype.unstable_scheduleHydration=function(n){if(n){var e=hE();n={blockedOn:null,target:n,priority:e};for(var t=0;t<Ea.length&&e!==0&&e<Ea[t].priority;t++);Ea.splice(t,0,n),t===0&&mE(n)}};function dw(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function hg(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11&&(n.nodeType!==8||n.nodeValue!==" react-mount-point-unstable "))}function GN(){}function L4(n,e,t,s,r){if(r){if(typeof s=="function"){var i=s;s=function(){var d=lp(o);i.call(d)}}var o=IP(e,s,n,0,null,!1,!1,"",GN);return n._reactRootContainer=o,n[sa]=o.current,qu(n.nodeType===8?n.parentNode:n),gl(),o}for(;r=n.lastChild;)n.removeChild(r);if(typeof s=="function"){var l=s;s=function(){var d=lp(c);l.call(d)}}var c=ow(n,0,!1,null,null,!1,!1,"",GN);return n._reactRootContainer=c,n[sa]=c.current,qu(n.nodeType===8?n.parentNode:n),gl(function(){dg(e,c,t,s)}),c}function fg(n,e,t,s,r){var i=t._reactRootContainer;if(i){var o=i;if(typeof r=="function"){var l=r;r=function(){var c=lp(o);l.call(c)}}dg(e,o,n,r)}else o=L4(t,e,n,r,s);return lp(o)}dE=function(n){switch(n.tag){case 3:var e=n.stateNode;if(e.current.memoizedState.isDehydrated){var t=ou(e.pendingLanes);t!==0&&(E0(e,t|1),zs(e,wn()),!(Ct&6)&&(Hc=wn()+500,ho()))}break;case 13:gl(function(){var s=ra(n,1);if(s!==null){var r=bs();qr(s,n,1,r)}}),lw(n,1)}};P0=function(n){if(n.tag===13){var e=ra(n,134217728);if(e!==null){var t=bs();qr(e,n,134217728,t)}lw(n,134217728)}};uE=function(n){if(n.tag===13){var e=Ga(n),t=ra(n,e);if(t!==null){var s=bs();qr(t,n,e,s)}lw(n,e)}};hE=function(){return Ot};fE=function(n,e){var t=Ot;try{return Ot=n,e()}finally{Ot=t}};uv=function(n,e,t){switch(e){case"input":if(rv(n,t),e=t.name,t.type==="radio"&&e!=null){for(t=n;t.parentNode;)t=t.parentNode;for(t=t.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<t.length;e++){var s=t[e];if(s!==n&&s.form===n.form){var r=sg(s);if(!r)throw Error(ke(90));qT(s),rv(s,r)}}}break;case"textarea":WT(n,t);break;case"select":e=t.value,e!=null&&kc(n,!!t.multiple,e,!1)}};XT=sw;eE=gl;var F4={usingClientEntryPoint:!1,Events:[_h,gc,sg,JT,QT,sw]},zd={findFiberByHostInstance:Qo,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},$4={bundleType:zd.bundleType,version:zd.version,rendererPackageName:zd.rendererPackageName,rendererConfig:zd.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:fa.ReactCurrentDispatcher,findHostInstanceByFiber:function(n){return n=sE(n),n===null?null:n.stateNode},findFiberByHostInstance:zd.findFiberByHostInstance||R4,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Sf=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Sf.isDisabled&&Sf.supportsFiber)try{Xp=Sf.inject($4),_i=Sf}catch{}}lr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=F4;lr.createPortal=function(n,e){var t=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!dw(e))throw Error(ke(200));return O4(n,e,null,t)};lr.createRoot=function(n,e){if(!dw(n))throw Error(ke(299));var t=!1,s="",r=OP;return e!=null&&(e.unstable_strictMode===!0&&(t=!0),e.identifierPrefix!==void 0&&(s=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=ow(n,1,!1,null,null,t,!1,s,r),n[sa]=e.current,qu(n.nodeType===8?n.parentNode:n),new cw(e)};lr.findDOMNode=function(n){if(n==null)return null;if(n.nodeType===1)return n;var e=n._reactInternals;if(e===void 0)throw typeof n.render=="function"?Error(ke(188)):(n=Object.keys(n).join(","),Error(ke(268,n)));return n=sE(e),n=n===null?null:n.stateNode,n};lr.flushSync=function(n){return gl(n)};lr.hydrate=function(n,e,t){if(!hg(e))throw Error(ke(200));return fg(null,n,e,!0,t)};lr.hydrateRoot=function(n,e,t){if(!dw(n))throw Error(ke(405));var s=t!=null&&t.hydratedSources||null,r=!1,i="",o=OP;if(t!=null&&(t.unstable_strictMode===!0&&(r=!0),t.identifierPrefix!==void 0&&(i=t.identifierPrefix),t.onRecoverableError!==void 0&&(o=t.onRecoverableError)),e=IP(e,null,n,1,t??null,r,!1,i,o),n[sa]=e.current,qu(n),s)for(n=0;n<s.length;n++)t=s[n],r=t._getVersion,r=r(t._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[t,r]:e.mutableSourceEagerHydrationData.push(t,r);return new ug(e)};lr.render=function(n,e,t){if(!hg(e))throw Error(ke(200));return fg(null,n,e,!1,t)};lr.unmountComponentAtNode=function(n){if(!hg(n))throw Error(ke(40));return n._reactRootContainer?(gl(function(){fg(null,null,n,!1,function(){n._reactRootContainer=null,n[sa]=null})}),!0):!1};lr.unstable_batchedUpdates=sw;lr.unstable_renderSubtreeIntoContainer=function(n,e,t,s){if(!hg(t))throw Error(ke(200));if(n==null||n._reactInternals===void 0)throw Error(ke(38));return fg(n,e,t,!1,s)};lr.version="18.3.1-next-f1338f8080-20240426";function RP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(RP)}catch(n){console.error(n)}}RP(),RT.exports=lr;var LP=RT.exports,YN=LP;Jx.createRoot=YN.createRoot,Jx.hydrateRoot=YN.hydrateRoot;/**
 * @remix-run/router v1.23.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function Xu(){return Xu=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Xu.apply(this,arguments)}var Ia;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ia||(Ia={}));const ZN="popstate";function z4(n){n===void 0&&(n={});function e(r,i){let{pathname:o="/",search:l="",hash:c=""}=kl(r.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),qv("",{pathname:o,search:l,hash:c},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function t(r,i){let o=r.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=r.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof i=="string"?i:cp(i))}function s(r,i){uw(r.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(i)+")")}return V4(e,t,s,n)}function mn(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function uw(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function U4(){return Math.random().toString(36).substr(2,8)}function KN(n,e){return{usr:n.state,key:n.key,idx:e}}function qv(n,e,t,s){return t===void 0&&(t=null),Xu({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?kl(e):e,{state:t,key:e&&e.key||s||U4()})}function cp(n){let{pathname:e="/",search:t="",hash:s=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),s&&s!=="#"&&(e+=s.charAt(0)==="#"?s:"#"+s),e}function kl(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let s=n.indexOf("?");s>=0&&(e.search=n.substr(s),n=n.substr(0,s)),n&&(e.pathname=n)}return e}function V4(n,e,t,s){s===void 0&&(s={});let{window:r=document.defaultView,v5Compat:i=!1}=s,o=r.history,l=Ia.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(Xu({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function f(){l=Ia.Pop;let _=h(),N=_==null?null:_-d;d=_,c&&c({action:l,location:v.location,delta:N})}function p(_,N){l=Ia.Push;let j=qv(v.location,_,N);t&&t(j,_),d=h()+1;let k=KN(j,d),S=v.createHref(j);try{o.pushState(k,"",S)}catch(P){if(P instanceof DOMException&&P.name==="DataCloneError")throw P;r.location.assign(S)}i&&c&&c({action:l,location:v.location,delta:1})}function g(_,N){l=Ia.Replace;let j=qv(v.location,_,N);t&&t(j,_),d=h();let k=KN(j,d),S=v.createHref(j);o.replaceState(k,"",S),i&&c&&c({action:l,location:v.location,delta:0})}function b(_){let N=r.location.origin!=="null"?r.location.origin:r.location.href,j=typeof _=="string"?_:cp(_);return j=j.replace(/ $/,"%20"),mn(N,"No window.location.(origin|href) available to create URL for href: "+j),new URL(j,N)}let v={get action(){return l},get location(){return n(r,o)},listen(_){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(ZN,f),c=_,()=>{r.removeEventListener(ZN,f),c=null}},createHref(_){return e(r,_)},createURL:b,encodeLocation(_){let N=b(_);return{pathname:N.pathname,search:N.search,hash:N.hash}},push:p,replace:g,go(_){return o.go(_)}};return v}var JN;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(JN||(JN={}));function B4(n,e,t){return t===void 0&&(t="/"),q4(n,e,t)}function q4(n,e,t,s){let r=typeof e=="string"?kl(e):e,i=Wc(r.pathname||"/",t);if(i==null)return null;let o=FP(n);H4(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=nF(i);l=eF(o[c],d)}return l}function FP(n,e,t,s){e===void 0&&(e=[]),t===void 0&&(t=[]),s===void 0&&(s="");let r=(i,o,l)=>{let c={relativePath:l===void 0?i.path||"":l,caseSensitive:i.caseSensitive===!0,childrenIndex:o,route:i};c.relativePath.startsWith("/")&&(mn(c.relativePath.startsWith(s),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+s+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(s.length));let d=Za([s,c.relativePath]),h=t.concat(c);i.children&&i.children.length>0&&(mn(i.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),FP(i.children,e,h,d)),!(i.path==null&&!i.index)&&e.push({path:d,score:Q4(d,i.index),routesMeta:h})};return n.forEach((i,o)=>{var l;if(i.path===""||!((l=i.path)!=null&&l.includes("?")))r(i,o);else for(let c of $P(i.path))r(i,o,c)}),e}function $P(n){let e=n.split("/");if(e.length===0)return[];let[t,...s]=e,r=t.endsWith("?"),i=t.replace(/\?$/,"");if(s.length===0)return r?[i,""]:[i];let o=$P(s.join("/")),l=[];return l.push(...o.map(c=>c===""?i:[i,c].join("/"))),r&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function H4(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:X4(e.routesMeta.map(s=>s.childrenIndex),t.routesMeta.map(s=>s.childrenIndex)))}const W4=/^:[\w-]+$/,G4=3,Y4=2,Z4=1,K4=10,J4=-2,QN=n=>n==="*";function Q4(n,e){let t=n.split("/"),s=t.length;return t.some(QN)&&(s+=J4),e&&(s+=Y4),t.filter(r=>!QN(r)).reduce((r,i)=>r+(W4.test(i)?G4:i===""?Z4:K4),s)}function X4(n,e){return n.length===e.length&&n.slice(0,-1).every((s,r)=>s===e[r])?n[n.length-1]-e[e.length-1]:0}function eF(n,e,t){let{routesMeta:s}=n,r={},i="/",o=[];for(let l=0;l<s.length;++l){let c=s[l],d=l===s.length-1,h=i==="/"?e:e.slice(i.length)||"/",f=Hv({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),p=c.route;if(!f)return null;Object.assign(r,f.params),o.push({params:r,pathname:Za([i,f.pathname]),pathnameBase:aF(Za([i,f.pathnameBase])),route:p}),f.pathnameBase!=="/"&&(i=Za([i,f.pathnameBase]))}return o}function Hv(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,s]=tF(n.path,n.caseSensitive,n.end),r=e.match(t);if(!r)return null;let i=r[0],o=i.replace(/(.)\/+$/,"$1"),l=r.slice(1);return{params:s.reduce((d,h,f)=>{let{paramName:p,isOptional:g}=h;if(p==="*"){let v=l[f]||"";o=i.slice(0,i.length-v.length).replace(/(.)\/+$/,"$1")}const b=l[f];return g&&!b?d[p]=void 0:d[p]=(b||"").replace(/%2F/g,"/"),d},{}),pathname:i,pathnameBase:o,pattern:n}}function tF(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),uw(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let s=[],r="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(s.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(s.push({paramName:"*"}),r+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?r+="\\/*$":n!==""&&n!=="/"&&(r+="(?:(?=\\/|$))"),[new RegExp(r,e?void 0:"i"),s]}function nF(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return uw(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function Wc(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,s=n.charAt(t);return s&&s!=="/"?null:n.slice(t)||"/"}function sF(n,e){e===void 0&&(e="/");let{pathname:t,search:s="",hash:r=""}=typeof n=="string"?kl(n):n;return{pathname:t?t.startsWith("/")?t:rF(t,e):e,search:oF(s),hash:lF(r)}}function rF(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(r=>{r===".."?t.length>1&&t.pop():r!=="."&&t.push(r)}),t.length>1?t.join("/"):"/"}function ex(n,e,t,s){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(s)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function iF(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function hw(n,e){let t=iF(n);return e?t.map((s,r)=>r===t.length-1?s.pathname:s.pathnameBase):t.map(s=>s.pathnameBase)}function fw(n,e,t,s){s===void 0&&(s=!1);let r;typeof n=="string"?r=kl(n):(r=Xu({},n),mn(!r.pathname||!r.pathname.includes("?"),ex("?","pathname","search",r)),mn(!r.pathname||!r.pathname.includes("#"),ex("#","pathname","hash",r)),mn(!r.search||!r.search.includes("#"),ex("#","search","hash",r)));let i=n===""||r.pathname==="",o=i?"/":r.pathname,l;if(o==null)l=t;else{let f=e.length-1;if(!s&&o.startsWith("..")){let p=o.split("/");for(;p[0]==="..";)p.shift(),f-=1;r.pathname=p.join("/")}l=f>=0?e[f]:"/"}let c=sF(r,l),d=o&&o!=="/"&&o.endsWith("/"),h=(i||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const Za=n=>n.join("/").replace(/\/\/+/g,"/"),aF=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),oF=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,lF=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function cF(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const zP=["post","put","patch","delete"];new Set(zP);const dF=["get",...zP];new Set(dF);/**
 * React Router v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function eh(){return eh=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},eh.apply(this,arguments)}const mg=C.createContext(null),UP=C.createContext(null),ma=C.createContext(null),pg=C.createContext(null),Mi=C.createContext({outlet:null,matches:[],isDataRoute:!1}),VP=C.createContext(null);function uF(n,e){let{relative:t}=e===void 0?{}:e;dd()||mn(!1);let{basename:s,navigator:r}=C.useContext(ma),{hash:i,pathname:o,search:l}=gg(n,{relative:t}),c=o;return s!=="/"&&(c=o==="/"?s:Za([s,o])),r.createHref({pathname:c,search:l,hash:i})}function dd(){return C.useContext(pg)!=null}function Ns(){return dd()||mn(!1),C.useContext(pg).location}function BP(n){C.useContext(ma).static||C.useLayoutEffect(n)}function Vt(){let{isDataRoute:n}=C.useContext(Mi);return n?jF():hF()}function hF(){dd()||mn(!1);let n=C.useContext(mg),{basename:e,future:t,navigator:s}=C.useContext(ma),{matches:r}=C.useContext(Mi),{pathname:i}=Ns(),o=JSON.stringify(hw(r,t.v7_relativeSplatPath)),l=C.useRef(!1);return BP(()=>{l.current=!0}),C.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){s.go(d);return}let f=fw(d,JSON.parse(o),i,h.relative==="path");n==null&&e!=="/"&&(f.pathname=f.pathname==="/"?e:Za([e,f.pathname])),(h.replace?s.replace:s.push)(f,h.state,h)},[e,s,o,i,n])}const qP=C.createContext(null);function dr(){return C.useContext(qP)}function fF(n){let e=C.useContext(Mi).outlet;return e&&C.createElement(qP.Provider,{value:n},e)}function HP(){let{matches:n}=C.useContext(Mi),e=n[n.length-1];return e?e.params:{}}function gg(n,e){let{relative:t}=e===void 0?{}:e,{future:s}=C.useContext(ma),{matches:r}=C.useContext(Mi),{pathname:i}=Ns(),o=JSON.stringify(hw(r,s.v7_relativeSplatPath));return C.useMemo(()=>fw(n,JSON.parse(o),i,t==="path"),[n,o,i,t])}function mF(n,e){return pF(n,e)}function pF(n,e,t,s){dd()||mn(!1);let{navigator:r}=C.useContext(ma),{matches:i}=C.useContext(Mi),o=i[i.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Ns(),h;if(e){var f;let _=typeof e=="string"?kl(e):e;c==="/"||(f=_.pathname)!=null&&f.startsWith(c)||mn(!1),h=_}else h=d;let p=h.pathname||"/",g=p;if(c!=="/"){let _=c.replace(/^\//,"").split("/");g="/"+p.replace(/^\//,"").split("/").slice(_.length).join("/")}let b=B4(n,{pathname:g}),v=bF(b&&b.map(_=>Object.assign({},_,{params:Object.assign({},l,_.params),pathname:Za([c,r.encodeLocation?r.encodeLocation(_.pathname).pathname:_.pathname]),pathnameBase:_.pathnameBase==="/"?c:Za([c,r.encodeLocation?r.encodeLocation(_.pathnameBase).pathname:_.pathnameBase])})),i,t,s);return e&&v?C.createElement(pg.Provider,{value:{location:eh({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ia.Pop}},v):v}function gF(){let n=NF(),e=cF(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,r={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return C.createElement(C.Fragment,null,C.createElement("h2",null,"Unexpected Application Error!"),C.createElement("h3",{style:{fontStyle:"italic"}},e),t?C.createElement("pre",{style:r},t):null,null)}const yF=C.createElement(gF,null);class xF extends C.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?C.createElement(Mi.Provider,{value:this.props.routeContext},C.createElement(VP.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function vF(n){let{routeContext:e,match:t,children:s}=n,r=C.useContext(mg);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),C.createElement(Mi.Provider,{value:e},s)}function bF(n,e,t,s){var r;if(e===void 0&&(e=[]),t===void 0&&(t=null),s===void 0&&(s=null),n==null){var i;if(!t)return null;if(t.errors)n=t.matches;else if((i=s)!=null&&i.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(r=t)==null?void 0:r.errors;if(l!=null){let h=o.findIndex(f=>f.route.id&&(l==null?void 0:l[f.route.id])!==void 0);h>=0||mn(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(t&&s&&s.v7_partialHydration)for(let h=0;h<o.length;h++){let f=o[h];if((f.route.HydrateFallback||f.route.hydrateFallbackElement)&&(d=h),f.route.id){let{loaderData:p,errors:g}=t,b=f.route.loader&&p[f.route.id]===void 0&&(!g||g[f.route.id]===void 0);if(f.route.lazy||b){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,f,p)=>{let g,b=!1,v=null,_=null;t&&(g=l&&f.route.id?l[f.route.id]:void 0,v=f.route.errorElement||yF,c&&(d<0&&p===0?(CF("route-fallback"),b=!0,_=null):d===p&&(b=!0,_=f.route.hydrateFallbackElement||null)));let N=e.concat(o.slice(0,p+1)),j=()=>{let k;return g?k=v:b?k=_:f.route.Component?k=C.createElement(f.route.Component,null):f.route.element?k=f.route.element:k=h,C.createElement(vF,{match:f,routeContext:{outlet:h,matches:N,isDataRoute:t!=null},children:k})};return t&&(f.route.ErrorBoundary||f.route.errorElement||p===0)?C.createElement(xF,{location:t.location,revalidation:t.revalidation,component:v,error:g,children:j(),routeContext:{outlet:null,matches:N,isDataRoute:!0}}):j()},null)}var WP=function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n}(WP||{}),GP=function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n}(GP||{});function wF(n){let e=C.useContext(mg);return e||mn(!1),e}function _F(n){let e=C.useContext(UP);return e||mn(!1),e}function SF(n){let e=C.useContext(Mi);return e||mn(!1),e}function YP(n){let e=SF(),t=e.matches[e.matches.length-1];return t.route.id||mn(!1),t.route.id}function NF(){var n;let e=C.useContext(VP),t=_F(),s=YP();return e!==void 0?e:(n=t.errors)==null?void 0:n[s]}function jF(){let{router:n}=wF(WP.UseNavigateStable),e=YP(GP.UseNavigateStable),t=C.useRef(!1);return BP(()=>{t.current=!0}),C.useCallback(function(r,i){i===void 0&&(i={}),t.current&&(typeof r=="number"?n.navigate(r):n.navigate(r,eh({fromRouteId:e},i)))},[n,e])}const XN={};function CF(n,e,t){XN[n]||(XN[n]=!0)}function kF(n,e){n==null||n.v7_startTransition,n==null||n.v7_relativeSplatPath}function Ki(n){let{to:e,replace:t,state:s,relative:r}=n;dd()||mn(!1);let{future:i,static:o}=C.useContext(ma),{matches:l}=C.useContext(Mi),{pathname:c}=Ns(),d=Vt(),h=fw(e,hw(l,i.v7_relativeSplatPath),c,r==="path"),f=JSON.stringify(h);return C.useEffect(()=>d(JSON.parse(f),{replace:t,state:s,relative:r}),[d,f,r,t,s]),null}function th(n){return fF(n.context)}function Ae(n){mn(!1)}function TF(n){let{basename:e="/",children:t=null,location:s,navigationType:r=Ia.Pop,navigator:i,static:o=!1,future:l}=n;dd()&&mn(!1);let c=e.replace(/^\/*/,"/"),d=C.useMemo(()=>({basename:c,navigator:i,static:o,future:eh({v7_relativeSplatPath:!1},l)}),[c,l,i,o]);typeof s=="string"&&(s=kl(s));let{pathname:h="/",search:f="",hash:p="",state:g=null,key:b="default"}=s,v=C.useMemo(()=>{let _=Wc(h,c);return _==null?null:{location:{pathname:_,search:f,hash:p,state:g,key:b},navigationType:r}},[c,h,f,p,g,b,r]);return v==null?null:C.createElement(ma.Provider,{value:d},C.createElement(pg.Provider,{children:t,value:v}))}function EF(n){let{children:e,location:t}=n;return mF(Wv(e),t)}new Promise(()=>{});function Wv(n,e){e===void 0&&(e=[]);let t=[];return C.Children.forEach(n,(s,r)=>{if(!C.isValidElement(s))return;let i=[...e,r];if(s.type===C.Fragment){t.push.apply(t,Wv(s.props.children,i));return}s.type!==Ae&&mn(!1),!s.props.index||!s.props.children||mn(!1);let o={id:s.props.id||i.join("-"),caseSensitive:s.props.caseSensitive,element:s.props.element,Component:s.props.Component,index:s.props.index,path:s.props.path,loader:s.props.loader,action:s.props.action,errorElement:s.props.errorElement,ErrorBoundary:s.props.ErrorBoundary,hasErrorBoundary:s.props.ErrorBoundary!=null||s.props.errorElement!=null,shouldRevalidate:s.props.shouldRevalidate,handle:s.props.handle,lazy:s.props.lazy};s.props.children&&(o.children=Wv(s.props.children,i)),t.push(o)}),t}/**
 * React Router DOM v6.30.1
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */function dp(){return dp=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},dp.apply(this,arguments)}function ZP(n,e){if(n==null)return{};var t={},s=Object.keys(n),r,i;for(i=0;i<s.length;i++)r=s[i],!(e.indexOf(r)>=0)&&(t[r]=n[r]);return t}function PF(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function MF(n,e){return n.button===0&&(!e||e==="_self")&&!PF(n)}function Gv(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let s=n[t];return e.concat(Array.isArray(s)?s.map(r=>[t,r]):[[t,s]])},[]))}function DF(n,e){let t=Gv(n);return e&&e.forEach((s,r)=>{t.has(r)||e.getAll(r).forEach(i=>{t.append(r,i)})}),t}const AF=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],IF=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],OF="6";try{window.__reactRouterVersion=OF}catch{}const RF=C.createContext({isTransitioning:!1}),LF="startTransition",ej=ER[LF];function FF(n){let{basename:e,children:t,future:s,window:r}=n,i=C.useRef();i.current==null&&(i.current=z4({window:r,v5Compat:!0}));let o=i.current,[l,c]=C.useState({action:o.action,location:o.location}),{v7_startTransition:d}=s||{},h=C.useCallback(f=>{d&&ej?ej(()=>c(f)):c(f)},[c,d]);return C.useLayoutEffect(()=>o.listen(h),[o,h]),C.useEffect(()=>kF(s),[s]),C.createElement(TF,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:s})}const $F=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",zF=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Yr=C.forwardRef(function(e,t){let{onClick:s,relative:r,reloadDocument:i,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:f}=e,p=ZP(e,AF),{basename:g}=C.useContext(ma),b,v=!1;if(typeof d=="string"&&zF.test(d)&&(b=d,$F))try{let k=new URL(window.location.href),S=d.startsWith("//")?new URL(k.protocol+d):new URL(d),P=Wc(S.pathname,g);S.origin===k.origin&&P!=null?d=P+S.search+S.hash:v=!0}catch{}let _=uF(d,{relative:r}),N=VF(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:r,viewTransition:f});function j(k){s&&s(k),k.defaultPrevented||N(k)}return C.createElement("a",dp({},p,{href:b||_,onClick:v||i?s:j,ref:t,target:c}))}),KP=C.forwardRef(function(e,t){let{"aria-current":s="page",caseSensitive:r=!1,className:i="",end:o=!1,style:l,to:c,viewTransition:d,children:h}=e,f=ZP(e,IF),p=gg(c,{relative:f.relative}),g=Ns(),b=C.useContext(UP),{navigator:v,basename:_}=C.useContext(ma),N=b!=null&&BF(p)&&d===!0,j=v.encodeLocation?v.encodeLocation(p).pathname:p.pathname,k=g.pathname,S=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;r||(k=k.toLowerCase(),S=S?S.toLowerCase():null,j=j.toLowerCase()),S&&_&&(S=Wc(S,_)||S);const P=j!=="/"&&j.endsWith("/")?j.length-1:j.length;let E=k===j||!o&&k.startsWith(j)&&k.charAt(P)==="/",M=S!=null&&(S===j||!o&&S.startsWith(j)&&S.charAt(j.length)==="/"),I={isActive:E,isPending:M,isTransitioning:N},O=E?s:void 0,D;typeof i=="function"?D=i(I):D=[i,E?"active":null,M?"pending":null,N?"transitioning":null].filter(Boolean).join(" ");let z=typeof l=="function"?l(I):l;return C.createElement(Yr,dp({},f,{"aria-current":O,className:D,ref:t,style:z,to:c,viewTransition:d}),typeof h=="function"?h(I):h)});var Yv;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})(Yv||(Yv={}));var tj;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(tj||(tj={}));function UF(n){let e=C.useContext(mg);return e||mn(!1),e}function VF(n,e){let{target:t,replace:s,state:r,preventScrollReset:i,relative:o,viewTransition:l}=e===void 0?{}:e,c=Vt(),d=Ns(),h=gg(n,{relative:o});return C.useCallback(f=>{if(MF(f,t)){f.preventDefault();let p=s!==void 0?s:cp(d)===cp(h);c(n,{replace:p,state:r,preventScrollReset:i,relative:o,viewTransition:l})}},[d,c,h,s,r,t,n,i,o,l])}function JP(n){let e=C.useRef(Gv(n)),t=C.useRef(!1),s=Ns(),r=C.useMemo(()=>DF(s.search,t.current?null:e.current),[s.search]),i=Vt(),o=C.useCallback((l,c)=>{const d=Gv(typeof l=="function"?l(r):l);t.current=!0,i("?"+d,c)},[i,r]);return[r,o]}function BF(n,e){e===void 0&&(e={});let t=C.useContext(RF);t==null&&mn(!1);let{basename:s}=UF(Yv.useViewTransitionState),r=gg(n,{relative:e.relative});if(!t.isTransitioning)return!1;let i=Wc(t.currentLocation.pathname,s)||t.currentLocation.pathname,o=Wc(t.nextLocation.pathname,s)||t.nextLocation.pathname;return Hv(r.pathname,o)!=null||Hv(r.pathname,i)!=null}const qF={},nj=n=>{let e;const t=new Set,s=(h,f)=>{const p=typeof h=="function"?h(e):h;if(!Object.is(p,e)){const g=e;e=f??(typeof p!="object"||p===null)?p:Object.assign({},e,p),t.forEach(b=>b(e,g))}},r=()=>e,c={setState:s,getState:r,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(qF?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(s,r,c);return c},HF=n=>n?nj(n):nj;var QP={exports:{}},XP={},eM={exports:{}},tM={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Gc=C;function WF(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var GF=typeof Object.is=="function"?Object.is:WF,YF=Gc.useState,ZF=Gc.useEffect,KF=Gc.useLayoutEffect,JF=Gc.useDebugValue;function QF(n,e){var t=e(),s=YF({inst:{value:t,getSnapshot:e}}),r=s[0].inst,i=s[1];return KF(function(){r.value=t,r.getSnapshot=e,tx(r)&&i({inst:r})},[n,t,e]),ZF(function(){return tx(r)&&i({inst:r}),n(function(){tx(r)&&i({inst:r})})},[n]),JF(t),t}function tx(n){var e=n.getSnapshot;n=n.value;try{var t=e();return!GF(n,t)}catch{return!0}}function XF(n,e){return e()}var e3=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?XF:QF;tM.useSyncExternalStore=Gc.useSyncExternalStore!==void 0?Gc.useSyncExternalStore:e3;eM.exports=tM;var t3=eM.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yg=C,n3=t3;function s3(n,e){return n===e&&(n!==0||1/n===1/e)||n!==n&&e!==e}var r3=typeof Object.is=="function"?Object.is:s3,i3=n3.useSyncExternalStore,a3=yg.useRef,o3=yg.useEffect,l3=yg.useMemo,c3=yg.useDebugValue;XP.useSyncExternalStoreWithSelector=function(n,e,t,s,r){var i=a3(null);if(i.current===null){var o={hasValue:!1,value:null};i.current=o}else o=i.current;i=l3(function(){function c(g){if(!d){if(d=!0,h=g,g=s(g),r!==void 0&&o.hasValue){var b=o.value;if(r(b,g))return f=b}return f=g}if(b=f,r3(h,g))return b;var v=s(g);return r!==void 0&&r(b,v)?(h=g,b):(h=g,f=v)}var d=!1,h,f,p=t===void 0?null:t;return[function(){return c(e())},p===null?void 0:function(){return c(p())}]},[e,t,s,r]);var l=i3(n,i[0],i[1]);return o3(function(){o.hasValue=!0,o.value=l},[l]),c3(l),l};QP.exports=XP;var d3=QP.exports;const u3=Jp(d3),nM={},{useDebugValue:h3}=Fe,{useSyncExternalStoreWithSelector:f3}=u3;let sj=!1;const m3=n=>n;function p3(n,e=m3,t){(nM?"production":void 0)!=="production"&&t&&!sj&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),sj=!0);const s=f3(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return h3(s),s}const rj=n=>{(nM?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?HF(n):n,t=(s,r)=>p3(e,s,r);return Object.assign(t,e),t},ei=n=>n?rj(n):rj;var Zv=function(n,e){return Zv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var r in s)Object.prototype.hasOwnProperty.call(s,r)&&(t[r]=s[r])},Zv(n,e)};function sM(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");Zv(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var up=function(){return up=Object.assign||function(e){for(var t,s=1,r=arguments.length;s<r;s++){t=arguments[s];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}return e},up.apply(this,arguments)};function ud(n,e){var t={};for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&e.indexOf(s)<0&&(t[s]=n[s]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,s=Object.getOwnPropertySymbols(n);r<s.length;r++)e.indexOf(s[r])<0&&Object.prototype.propertyIsEnumerable.call(n,s[r])&&(t[s[r]]=n[s[r]]);return t}function rM(n,e,t,s){var r=arguments.length,i=r<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")i=Reflect.decorate(n,e,t,s);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(i=(r<3?o(i):r>3?o(e,t,i):o(e,t))||i);return r>3&&i&&Object.defineProperty(e,t,i),i}function iM(n,e){return function(t,s){e(t,s,n)}}function aM(n,e,t,s,r,i){function o(N){if(N!==void 0&&typeof N!="function")throw new TypeError("Function expected");return N}for(var l=s.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?s.static?n:n.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,s.name):{}),f,p=!1,g=t.length-1;g>=0;g--){var b={};for(var v in s)b[v]=v==="access"?{}:s[v];for(var v in s.access)b.access[v]=s.access[v];b.addInitializer=function(N){if(p)throw new TypeError("Cannot add initializers after decoration has completed");i.push(o(N||null))};var _=(0,t[g])(l==="accessor"?{get:h.get,set:h.set}:h[c],b);if(l==="accessor"){if(_===void 0)continue;if(_===null||typeof _!="object")throw new TypeError("Object expected");(f=o(_.get))&&(h.get=f),(f=o(_.set))&&(h.set=f),(f=o(_.init))&&r.unshift(f)}else(f=o(_))&&(l==="field"?r.unshift(f):h[c]=f)}d&&Object.defineProperty(d,s.name,h),p=!0}function oM(n,e,t){for(var s=arguments.length>2,r=0;r<e.length;r++)t=s?e[r].call(n,t):e[r].call(n);return s?t:void 0}function lM(n){return typeof n=="symbol"?n:"".concat(n)}function cM(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function dM(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function He(n,e,t,s){function r(i){return i instanceof t?i:new t(function(o){o(i)})}return new(t||(t=Promise))(function(i,o){function l(h){try{d(s.next(h))}catch(f){o(f)}}function c(h){try{d(s.throw(h))}catch(f){o(f)}}function d(h){h.done?i(h.value):r(h.value).then(l,c)}d((s=s.apply(n,e||[])).next())})}function uM(n,e){var t={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},s,r,i,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(h){return c([d,h])}}function c(d){if(s)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(s=1,r&&(i=d[0]&2?r.return:d[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,d[1])).done)return i;switch(r=0,i&&(d=[d[0]&2,i.value]),d[0]){case 0:case 1:i=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,r=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(i=t.trys,!(i=i.length>0&&i[i.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!i||d[1]>i[0]&&d[1]<i[3])){t.label=d[1];break}if(d[0]===6&&t.label<i[1]){t.label=i[1],i=d;break}if(i&&t.label<i[2]){t.label=i[2],t.ops.push(d);break}i[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],r=0}finally{s=i=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var xg=Object.create?function(n,e,t,s){s===void 0&&(s=t);var r=Object.getOwnPropertyDescriptor(e,t);(!r||("get"in r?!e.__esModule:r.writable||r.configurable))&&(r={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,s,r)}:function(n,e,t,s){s===void 0&&(s=t),n[s]=e[t]};function hM(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&xg(e,n,t)}function hp(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function mw(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var s=t.call(n),r,i=[],o;try{for(;(e===void 0||e-- >0)&&!(r=s.next()).done;)i.push(r.value)}catch(l){o={error:l}}finally{try{r&&!r.done&&(t=s.return)&&t.call(s)}finally{if(o)throw o.error}}return i}function fM(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(mw(arguments[e]));return n}function mM(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var s=Array(n),r=0,e=0;e<t;e++)for(var i=arguments[e],o=0,l=i.length;o<l;o++,r++)s[r]=i[o];return s}function pM(n,e,t){if(t||arguments.length===2)for(var s=0,r=e.length,i;s<r;s++)(i||!(s in e))&&(i||(i=Array.prototype.slice.call(e,0,s)),i[s]=e[s]);return n.concat(i||Array.prototype.slice.call(e))}function Yc(n){return this instanceof Yc?(this.v=n,this):new Yc(n)}function gM(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),r,i=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(g){return function(b){return Promise.resolve(b).then(g,f)}}function l(g,b){s[g]&&(r[g]=function(v){return new Promise(function(_,N){i.push([g,v,_,N])>1||c(g,v)})},b&&(r[g]=b(r[g])))}function c(g,b){try{d(s[g](b))}catch(v){p(i[0][3],v)}}function d(g){g.value instanceof Yc?Promise.resolve(g.value.v).then(h,f):p(i[0][2],g)}function h(g){c("next",g)}function f(g){c("throw",g)}function p(g,b){g(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function yM(n){var e,t;return e={},s("next"),s("throw",function(r){throw r}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(r,i){e[r]=n[r]?function(o){return(t=!t)?{value:Yc(n[r](o)),done:!1}:i?i(o):o}:i}}function xM(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof hp=="function"?hp(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(i){t[i]=n[i]&&function(o){return new Promise(function(l,c){o=n[i](o),r(l,c,o.done,o.value)})}}function r(i,o,l,c){Promise.resolve(c).then(function(d){i({value:d,done:l})},o)}}function vM(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var g3=Object.create?function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}:function(n,e){n.default=e},Kv=function(n){return Kv=Object.getOwnPropertyNames||function(e){var t=[];for(var s in e)Object.prototype.hasOwnProperty.call(e,s)&&(t[t.length]=s);return t},Kv(n)};function bM(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=Kv(n),s=0;s<t.length;s++)t[s]!=="default"&&xg(e,n,t[s]);return g3(e,n),e}function wM(n){return n&&n.__esModule?n:{default:n}}function _M(n,e,t,s){if(t==="a"&&!s)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?s:t==="a"?s.call(n):s?s.value:e.get(n)}function SM(n,e,t,s,r){if(s==="m")throw new TypeError("Private method is not writable");if(s==="a"&&!r)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return s==="a"?r.call(n,t):r?r.value=t:e.set(n,t),t}function NM(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function jM(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var s,r;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");s=e[Symbol.asyncDispose]}if(s===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");s=e[Symbol.dispose],t&&(r=s)}if(typeof s!="function")throw new TypeError("Object not disposable.");r&&(s=function(){try{r.call(this)}catch(i){return Promise.reject(i)}}),n.stack.push({value:e,dispose:s,async:t})}else t&&n.stack.push({async:!0});return e}var y3=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var s=new Error(t);return s.name="SuppressedError",s.error=n,s.suppressed=e,s};function CM(n){function e(i){n.error=n.hasError?new y3(i,n.error,"An error was suppressed during disposal."):i,n.hasError=!0}var t,s=0;function r(){for(;t=n.stack.pop();)try{if(!t.async&&s===1)return s=0,n.stack.push(t),Promise.resolve().then(r);if(t.dispose){var i=t.dispose.call(t.value);if(t.async)return s|=2,Promise.resolve(i).then(r,function(o){return e(o),r()})}else s|=1}catch(o){e(o)}if(s===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return r()}function kM(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,s,r,i,o){return s?e?".jsx":".js":r&&(!i||!o)?t:r+i+"."+o.toLowerCase()+"js"}):n}const x3={__extends:sM,__assign:up,__rest:ud,__decorate:rM,__param:iM,__esDecorate:aM,__runInitializers:oM,__propKey:lM,__setFunctionName:cM,__metadata:dM,__awaiter:He,__generator:uM,__createBinding:xg,__exportStar:hM,__values:hp,__read:mw,__spread:fM,__spreadArrays:mM,__spreadArray:pM,__await:Yc,__asyncGenerator:gM,__asyncDelegator:yM,__asyncValues:xM,__makeTemplateObject:vM,__importStar:bM,__importDefault:wM,__classPrivateFieldGet:_M,__classPrivateFieldSet:SM,__classPrivateFieldIn:NM,__addDisposableResource:jM,__disposeResources:CM,__rewriteRelativeImportExtension:kM},v3=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:jM,get __assign(){return up},__asyncDelegator:yM,__asyncGenerator:gM,__asyncValues:xM,__await:Yc,__awaiter:He,__classPrivateFieldGet:_M,__classPrivateFieldIn:NM,__classPrivateFieldSet:SM,__createBinding:xg,__decorate:rM,__disposeResources:CM,__esDecorate:aM,__exportStar:hM,__extends:sM,__generator:uM,__importDefault:wM,__importStar:bM,__makeTemplateObject:vM,__metadata:dM,__param:iM,__propKey:lM,__read:mw,__rest:ud,__rewriteRelativeImportExtension:kM,__runInitializers:oM,__setFunctionName:cM,__spread:fM,__spreadArray:pM,__spreadArrays:mM,__values:hp,default:x3},Symbol.toStringTag,{value:"Module"})),b3=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class pw extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class w3 extends pw{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ij extends pw{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class aj extends pw{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Jv;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(Jv||(Jv={}));class _3{constructor(e,{headers:t={},customFetch:s,region:r=Jv.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=b3(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return He(this,arguments,void 0,function*(t,s={}){var r;let i,o;try{const{headers:l,method:c,body:d,signal:h,timeout:f}=s;let p={},{region:g}=s;g||(g=this.region);const b=new URL(`${this.url}/${t}`);g&&g!=="any"&&(p["x-region"]=g,b.searchParams.set("forceFunctionRegion",g));let v;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(p["Content-Type"]="application/octet-stream",v=d):typeof d=="string"?(p["Content-Type"]="text/plain",v=d):typeof FormData<"u"&&d instanceof FormData?v=d:(p["Content-Type"]="application/json",v=JSON.stringify(d)):v=d;let _=h;f&&(o=new AbortController,i=setTimeout(()=>o.abort(),f),h?(_=o.signal,h.addEventListener("abort",()=>o.abort())):_=o.signal);const N=yield this.fetch(b.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},p),this.headers),l),body:v,signal:_}).catch(P=>{throw new w3(P)}),j=N.headers.get("x-relay-error");if(j&&j==="true")throw new ij(N);if(!N.ok)throw new aj(N);let k=((r=N.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),S;return k==="application/json"?S=yield N.json():k==="application/octet-stream"||k==="application/pdf"?S=yield N.blob():k==="text/event-stream"?S=N:k==="multipart/form-data"?S=yield N.formData():S=yield N.text(),{data:S,error:null,response:N}}catch(l){return{data:null,error:l,response:l instanceof aj||l instanceof ij?l.context:void 0}}finally{i&&clearTimeout(i)}})}}var ys={};const hd=g0(v3);var Nf={},jf={},Cf={},kf={},Tf={},Ef={},oj;function TM(){if(oj)return Ef;oj=1,Object.defineProperty(Ef,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Ef.default=n,Ef}var lj;function EM(){if(lj)return Tf;lj=1,Object.defineProperty(Tf,"__esModule",{value:!0});const e=hd.__importDefault(TM());class t{constructor(r){var i,o;this.shouldThrowOnError=!1,this.method=r.method,this.url=r.url,this.headers=new Headers(r.headers),this.schema=r.schema,this.body=r.body,this.shouldThrowOnError=(i=r.shouldThrowOnError)!==null&&i!==void 0?i:!1,this.signal=r.signal,this.isMaybeSingle=(o=r.isMaybeSingle)!==null&&o!==void 0?o:!1,r.fetch?this.fetch=r.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(r,i){return this.headers=new Headers(this.headers),this.headers.set(r,i),this}then(r,i){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,f,p;let g=null,b=null,v=null,_=c.status,N=c.statusText;if(c.ok){if(this.method!=="HEAD"){const P=await c.text();P===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?b=P:b=JSON.parse(P))}const k=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),S=(f=c.headers.get("content-range"))===null||f===void 0?void 0:f.split("/");k&&S&&S.length>1&&(v=parseInt(S[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(b)&&(b.length>1?(g={code:"PGRST116",details:`Results contain ${b.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},b=null,v=null,_=406,N="Not Acceptable"):b.length===1?b=b[0]:b=null)}else{const k=await c.text();try{g=JSON.parse(k),Array.isArray(g)&&c.status===404&&(b=[],g=null,_=200,N="OK")}catch{c.status===404&&k===""?(_=204,N="No Content"):g={message:k}}if(g&&this.isMaybeSingle&&(!((p=g==null?void 0:g.details)===null||p===void 0)&&p.includes("0 rows"))&&(g=null,_=200,N="OK"),g&&this.shouldThrowOnError)throw new e.default(g)}return{error:g,data:b,count:v,status:_,statusText:N}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,f;return{error:{message:`${(d=c==null?void 0:c.name)!==null&&d!==void 0?d:"FetchError"}: ${c==null?void 0:c.message}`,details:`${(h=c==null?void 0:c.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(f=c==null?void 0:c.code)!==null&&f!==void 0?f:""}`},data:null,count:null,status:0,statusText:""}})),l.then(r,i)}returns(){return this}overrideTypes(){return this}}return Tf.default=t,Tf}var cj;function PM(){if(cj)return kf;cj=1,Object.defineProperty(kf,"__esModule",{value:!0});const e=hd.__importDefault(EM());class t extends e.default{select(r){let i=!1;const o=(r??"*").split("").map(l=>/\s/.test(l)&&!i?"":(l==='"'&&(i=!i),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(r,{ascending:i=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${r}.${i?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(r,{foreignTable:i,referencedTable:o=i}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${r}`),this}range(r,i,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${r}`),this.url.searchParams.set(d,`${i-r+1}`),this}abortSignal(r){return this.signal=r,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:r=!1,verbose:i=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const f=[r?"analyze":null,i?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),p=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${p}"; options=${f};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(r){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${r}`),this}}return kf.default=t,kf}var dj;function gw(){if(dj)return Cf;dj=1,Object.defineProperty(Cf,"__esModule",{value:!0});const e=hd.__importDefault(PM()),t=new RegExp("[,()]");class s extends e.default{eq(i,o){return this.url.searchParams.append(i,`eq.${o}`),this}neq(i,o){return this.url.searchParams.append(i,`neq.${o}`),this}gt(i,o){return this.url.searchParams.append(i,`gt.${o}`),this}gte(i,o){return this.url.searchParams.append(i,`gte.${o}`),this}lt(i,o){return this.url.searchParams.append(i,`lt.${o}`),this}lte(i,o){return this.url.searchParams.append(i,`lte.${o}`),this}like(i,o){return this.url.searchParams.append(i,`like.${o}`),this}likeAllOf(i,o){return this.url.searchParams.append(i,`like(all).{${o.join(",")}}`),this}likeAnyOf(i,o){return this.url.searchParams.append(i,`like(any).{${o.join(",")}}`),this}ilike(i,o){return this.url.searchParams.append(i,`ilike.${o}`),this}ilikeAllOf(i,o){return this.url.searchParams.append(i,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(i,o){return this.url.searchParams.append(i,`ilike(any).{${o.join(",")}}`),this}is(i,o){return this.url.searchParams.append(i,`is.${o}`),this}in(i,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(i,`in.(${l})`),this}contains(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cs.{${o.join(",")}}`):this.url.searchParams.append(i,`cs.${JSON.stringify(o)}`),this}containedBy(i,o){return typeof o=="string"?this.url.searchParams.append(i,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(i,`cd.{${o.join(",")}}`):this.url.searchParams.append(i,`cd.${JSON.stringify(o)}`),this}rangeGt(i,o){return this.url.searchParams.append(i,`sr.${o}`),this}rangeGte(i,o){return this.url.searchParams.append(i,`nxl.${o}`),this}rangeLt(i,o){return this.url.searchParams.append(i,`sl.${o}`),this}rangeLte(i,o){return this.url.searchParams.append(i,`nxr.${o}`),this}rangeAdjacent(i,o){return this.url.searchParams.append(i,`adj.${o}`),this}overlaps(i,o){return typeof o=="string"?this.url.searchParams.append(i,`ov.${o}`):this.url.searchParams.append(i,`ov.{${o.join(",")}}`),this}textSearch(i,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(i,`${d}fts${h}.${o}`),this}match(i){return Object.entries(i).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(i,o,l){return this.url.searchParams.append(i,`not.${o}.${l}`),this}or(i,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${i})`),this}filter(i,o,l){return this.url.searchParams.append(i,`${o}.${l}`),this}}return Cf.default=s,Cf}var uj;function MM(){if(uj)return jf;uj=1,Object.defineProperty(jf,"__esModule",{value:!0});const e=hd.__importDefault(gw());class t{constructor(r,{headers:i={},schema:o,fetch:l}){this.url=r,this.headers=new Headers(i),this.schema=o,this.fetch=l}select(r,i){const{head:o=!1,count:l}=i??{},c=o?"HEAD":"GET";let d=!1;const h=(r??"*").split("").map(f=>/\s/.test(f)&&!d?"":(f==='"'&&(d=!d),f)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(r,{count:i,defaultToNull:o=!0}={}){var l;const c="POST";if(i&&this.headers.append("Prefer",`count=${i}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const d=r.reduce((h,f)=>h.concat(Object.keys(f)),[]);if(d.length>0){const h=[...new Set(d)].map(f=>`"${f}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(r,{onConflict:i,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),i!==void 0&&this.url.searchParams.set("on_conflict",i),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(r)){const f=r.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(r,{count:i}={}){var o;const l="PATCH";return i&&this.headers.append("Prefer",`count=${i}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:r,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:r}={}){var i;const o="DELETE";return r&&this.headers.append("Prefer",`count=${r}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(i=this.fetch)!==null&&i!==void 0?i:fetch})}}return jf.default=t,jf}var hj;function S3(){if(hj)return Nf;hj=1,Object.defineProperty(Nf,"__esModule",{value:!0});const n=hd,e=n.__importDefault(MM()),t=n.__importDefault(gw());class s{constructor(i,{headers:o={},schema:l,fetch:c}={}){this.url=i,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(i){const o=new URL(`${this.url}/${i}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(i){return new s(this.url,{headers:this.headers,schema:i,fetch:this.fetch})}rpc(i,o={},{head:l=!1,get:c=!1,count:d}={}){var h;let f;const p=new URL(`${this.url}/rpc/${i}`);let g;l||c?(f=l?"HEAD":"GET",Object.entries(o).filter(([v,_])=>_!==void 0).map(([v,_])=>[v,Array.isArray(_)?`{${_.join(",")}}`:`${_}`]).forEach(([v,_])=>{p.searchParams.append(v,_)})):(f="POST",g=o);const b=new Headers(this.headers);return d&&b.set("Prefer",`count=${d}`),new t.default({method:f,url:p,headers:b,schema:this.schemaName,body:g,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Nf.default=s,Nf}Object.defineProperty(ys,"__esModule",{value:!0});var DM=ys.PostgrestError=VM=ys.PostgrestBuilder=zM=ys.PostgrestTransformBuilder=FM=ys.PostgrestFilterBuilder=RM=ys.PostgrestQueryBuilder=IM=ys.PostgrestClient=void 0;const fd=hd,AM=fd.__importDefault(S3());var IM=ys.PostgrestClient=AM.default;const OM=fd.__importDefault(MM());var RM=ys.PostgrestQueryBuilder=OM.default;const LM=fd.__importDefault(gw());var FM=ys.PostgrestFilterBuilder=LM.default;const $M=fd.__importDefault(PM());var zM=ys.PostgrestTransformBuilder=$M.default;const UM=fd.__importDefault(EM());var VM=ys.PostgrestBuilder=UM.default;const BM=fd.__importDefault(TM());DM=ys.PostgrestError=BM.default;var qM=ys.default={PostgrestClient:AM.default,PostgrestQueryBuilder:OM.default,PostgrestFilterBuilder:LM.default,PostgrestTransformBuilder:$M.default,PostgrestBuilder:UM.default,PostgrestError:BM.default};const N3=ST({__proto__:null,get PostgrestBuilder(){return VM},get PostgrestClient(){return IM},get PostgrestError(){return DM},get PostgrestFilterBuilder(){return FM},get PostgrestQueryBuilder(){return RM},get PostgrestTransformBuilder(){return zM},default:qM},[ys]),{PostgrestClient:j3,PostgrestQueryBuilder:yoe,PostgrestFilterBuilder:xoe,PostgrestTransformBuilder:voe,PostgrestBuilder:boe,PostgrestError:woe}=qM||N3;class C3{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const s=t.node,r=parseInt(s.replace(/^v/,"").split(".")[0]);return r>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${r} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${r} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const s=this.getWebSocketConstructor();return new s(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const k3="2.81.1",T3=`realtime-js/${k3}`,HM="1.0.0",E3="2.0.0",fj=HM,Qv=1e4,P3=1e3,M3=100;var Yo;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(Yo||(Yo={}));var An;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(An||(An={}));var vr;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(vr||(vr={}));var Xv;(function(n){n.websocket="websocket"})(Xv||(Xv={}));var Zo;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(Zo||(Zo={}));class D3{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let s=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(s))}_binaryEncodePush(e){const{join_ref:t,ref:s,event:r,topic:i,payload:o}=e,l=this.META_LENGTH+t.length+s.length+i.length+r.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.push),d.setUint8(h++,t.length),d.setUint8(h++,s.length),d.setUint8(h++,i.length),d.setUint8(h++,r.length),Array.from(t,p=>d.setUint8(h++,p.charCodeAt(0))),Array.from(s,p=>d.setUint8(h++,p.charCodeAt(0))),Array.from(i,p=>d.setUint8(h++,p.charCodeAt(0))),Array.from(r,p=>d.setUint8(h++,p.charCodeAt(0)));var f=new Uint8Array(c.byteLength+o.byteLength);return f.set(new Uint8Array(c),0),f.set(new Uint8Array(o),c.byteLength),f.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,s;const{join_ref:r,ref:i,topic:o}=e,l=e.payload.event,c=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+r.length+i.length+o.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let f=new DataView(h),p=0;f.setUint8(p++,this.KINDS.userBroadcastPush),f.setUint8(p++,r.length),f.setUint8(p++,i.length),f.setUint8(p++,o.length),f.setUint8(p++,l.length),f.setUint8(p++,this.BINARY_ENCODING),Array.from(r,b=>f.setUint8(p++,b.charCodeAt(0))),Array.from(i,b=>f.setUint8(p++,b.charCodeAt(0))),Array.from(o,b=>f.setUint8(p++,b.charCodeAt(0))),Array.from(l,b=>f.setUint8(p++,b.charCodeAt(0)));var g=new Uint8Array(h.byteLength+c.byteLength);return g.set(new Uint8Array(h),0),g.set(new Uint8Array(c),h.byteLength),g.buffer}_encodeJsonUserBroadcastPush(e){var t,s;const{join_ref:r,ref:i,topic:o}=e,l=e.payload.event,c=(s=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&s!==void 0?s:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer,f=this.USER_BROADCAST_PUSH_META_LENGTH+r.length+i.length+o.length+l.length,p=new ArrayBuffer(this.HEADER_LENGTH+f);let g=new DataView(p),b=0;g.setUint8(b++,this.KINDS.userBroadcastPush),g.setUint8(b++,r.length),g.setUint8(b++,i.length),g.setUint8(b++,o.length),g.setUint8(b++,l.length),g.setUint8(b++,this.JSON_ENCODING),Array.from(r,_=>g.setUint8(b++,_.charCodeAt(0))),Array.from(i,_=>g.setUint8(b++,_.charCodeAt(0))),Array.from(o,_=>g.setUint8(b++,_.charCodeAt(0))),Array.from(l,_=>g.setUint8(b++,_.charCodeAt(0)));var v=new Uint8Array(p.byteLength+h.byteLength);return v.set(new Uint8Array(p),0),v.set(new Uint8Array(h),p.byteLength),v.buffer}decode(e,t){if(this._isArrayBuffer(e)){let s=this._binaryDecode(e);return t(s)}if(typeof e=="string"){const s=JSON.parse(e),[r,i,o,l,c]=s;return t({join_ref:r,ref:i,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),s=t.getUint8(0),r=new TextDecoder;switch(s){case this.KINDS.push:return this._decodePush(e,t,r);case this.KINDS.reply:return this._decodeReply(e,t,r);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,r);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,r)}}_decodePush(e,t,s){const r=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=s.decode(e.slice(l,l+r));l=l+r;const d=s.decode(e.slice(l,l+i));l=l+i;const h=s.decode(e.slice(l,l+o));l=l+o;const f=JSON.parse(s.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:h,payload:f}}_decodeReply(e,t,s){const r=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=s.decode(e.slice(c,c+r));c=c+r;const h=s.decode(e.slice(c,c+i));c=c+i;const f=s.decode(e.slice(c,c+o));c=c+o;const p=s.decode(e.slice(c,c+l));c=c+l;const g=JSON.parse(s.decode(e.slice(c,e.byteLength))),b={status:p,response:g};return{join_ref:d,ref:h,topic:f,event:vr.reply,payload:b}}_decodeBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=s.decode(e.slice(o,o+r));o=o+r;const c=s.decode(e.slice(o,o+i));o=o+i;const d=JSON.parse(s.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,s){const r=t.getUint8(1),i=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=s.decode(e.slice(c,c+r));c=c+r;const h=s.decode(e.slice(c,c+i));c=c+i;const f=s.decode(e.slice(c,c+o));c=c+o;const p=e.slice(c,e.byteLength),g=l===this.JSON_ENCODING?JSON.parse(s.decode(p)):p,b={type:this.BROADCAST,event:h,payload:g};return o>0&&(b.meta=JSON.parse(f)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:b}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e==null?void 0:e.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class WM{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ht;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ht||(Ht={}));const mj=(n,e,t={})=>{var s;const r=(s=t.skipTypes)!==null&&s!==void 0?s:[];return e?Object.keys(e).reduce((i,o)=>(i[o]=A3(o,n,e,r),i),{}):{}},A3=(n,e,t,s)=>{const r=e.find(l=>l.name===n),i=r==null?void 0:r.type,o=t[n];return i&&!s.includes(i)?GM(i,o):eb(o)},GM=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return L3(e,t)}switch(n){case Ht.bool:return I3(e);case Ht.float4:case Ht.float8:case Ht.int2:case Ht.int4:case Ht.int8:case Ht.numeric:case Ht.oid:return O3(e);case Ht.json:case Ht.jsonb:return R3(e);case Ht.timestamp:return F3(e);case Ht.abstime:case Ht.date:case Ht.daterange:case Ht.int4range:case Ht.int8range:case Ht.money:case Ht.reltime:case Ht.text:case Ht.time:case Ht.timestamptz:case Ht.timetz:case Ht.tsrange:case Ht.tstzrange:return eb(e);default:return eb(e)}},eb=n=>n,I3=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},O3=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},R3=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},L3=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,s=n[t];if(n[0]==="{"&&s==="}"){let i;const o=n.slice(1,t);try{i=JSON.parse("["+o+"]")}catch{i=o?o.split(","):[]}return i.map(l=>GM(e,l))}return n},F3=n=>typeof n=="string"?n.replace(" ","T"):n,YM=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class nx{constructor(e,t,s={},r=Qv){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t((s=this.receivedResp)===null||s===void 0?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(s=>s.status===e).forEach(s=>s.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var pj;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(pj||(pj={}));class Cu{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(t==null?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Cu.syncState(this.state,r,i,o),this.pendingDiffs.forEach(c=>{this.state=Cu.syncDiff(this.state,c,i,o)}),this.pendingDiffs=[],l()}),this.channel._on(s.diff,{},r=>{const{onJoin:i,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(r):(this.state=Cu.syncDiff(this.state,r,i,o),l())}),this.onJoin((r,i,o)=>{this.channel._trigger("presence",{event:"join",key:r,currentPresences:i,newPresences:o})}),this.onLeave((r,i,o)=>{this.channel._trigger("presence",{event:"leave",key:r,currentPresences:i,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,s,r){const i=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(i,(d,h)=>{o[d]||(c[d]=h)}),this.map(o,(d,h)=>{const f=i[d];if(f){const p=h.map(_=>_.presence_ref),g=f.map(_=>_.presence_ref),b=h.filter(_=>g.indexOf(_.presence_ref)<0),v=f.filter(_=>p.indexOf(_.presence_ref)<0);b.length>0&&(l[d]=b),v.length>0&&(c[d]=v)}else l[d]=h}),this.syncDiff(i,{joins:l,leaves:c},s,r)}static syncDiff(e,t,s,r){const{joins:i,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(i,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const f=e[l].map(g=>g.presence_ref),p=h.filter(g=>f.indexOf(g.presence_ref)<0);e[l].unshift(...p)}s(l,h,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(f=>f.presence_ref);d=d.filter(f=>h.indexOf(f.presence_ref)<0),e[l]=d,r(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(s=>t(s,e[s]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,s)=>{const r=e[s];return"metas"in r?t[s]=r.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):t[s]=r,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var gj;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(gj||(gj={}));var ku;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(ku||(ku={}));var qi;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(qi||(qi={}));class yw{constructor(e,t={config:{}},s){var r,i;if(this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=An.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new nx(this,vr.join,this.params,this.timeout),this.rejoinTimer=new WM(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=An.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=An.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=An.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=An.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=An.errored,this.rejoinTimer.scheduleTimeout())}),this._on(vr.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Cu(this),this.broadcastEndpointURL=YM(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((i=(r=this.params.config)===null||r===void 0?void 0:r.broadcast)===null||i===void 0)&&i.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var s,r,i;if(this.socket.isConnected()||this.socket.connect(),this.state==An.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(r=(s=this.bindings.postgres_changes)===null||s===void 0?void 0:s.map(g=>g.filter))!==null&&r!==void 0?r:[],h=!!this.bindings[ku.PRESENCE]&&this.bindings[ku.PRESENCE].length>0||((i=this.params.config.presence)===null||i===void 0?void 0:i.enabled)===!0,f={},p={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(f.access_token=this.socket.accessTokenValue),this._onError(g=>e==null?void 0:e(qi.CHANNEL_ERROR,g)),this._onClose(()=>e==null?void 0:e(qi.CLOSED)),this.updateJoinPayload(Object.assign({config:p},f)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:g})=>{var b;if(this.socket.setAuth(),g===void 0){e==null||e(qi.SUBSCRIBED);return}else{const v=this.bindings.postgres_changes,_=(b=v==null?void 0:v.length)!==null&&b!==void 0?b:0,N=[];for(let j=0;j<_;j++){const k=v[j],{filter:{event:S,schema:P,table:E,filter:M}}=k,I=g&&g[j];if(I&&I.event===S&&I.schema===P&&I.table===E&&I.filter===M)N.push(Object.assign(Object.assign({},k),{id:I.id}));else{this.unsubscribe(),this.state=An.errored,e==null||e(qi.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=N,e&&e(qi.SUBSCRIBED);return}}).receive("error",g=>{this.state=An.errored,e==null||e(qi.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(g).join(", ")||"error")))}).receive("timeout",()=>{e==null||e(qi.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this.state===An.joined&&e===ku.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,s)}async httpSend(e,t,s={}){var r;const i=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:i,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(r=s.timeout)!==null&&r!==void 0?r:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var s,r;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:i,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(s=t.timeout)!==null&&s!==void 0?s:this.timeout);return await((r=d.body)===null||r===void 0?void 0:r.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&i("ok"),d.receive("ok",()=>i("ok")),d.receive("error",()=>i("error")),d.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=An.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(vr.close,"leave",this._joinRef())};this.joinPush.destroy();let s=null;return new Promise(r=>{s=new nx(this,vr.leave,{},e),s.receive("ok",()=>{t(),r("ok")}).receive("timeout",()=>{t(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})}).finally(()=>{s==null||s.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=An.closed,this.bindings={}}async _fetchWithTimeout(e,t,s){const r=new AbortController,i=setTimeout(()=>r.abort(),s),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(i),o}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new nx(this,e,t,s);return this._canPush()?r.send():this._addToPushBuffer(r),r}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>M3){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,i;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=vr;if(s&&[l,c,d,h].indexOf(o)>=0&&s!==this._joinRef())return;let p=this._onMessage(o,t,s);if(t&&!p)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(r=this.bindings.postgres_changes)===null||r===void 0||r.filter(g=>{var b,v,_;return((b=g.filter)===null||b===void 0?void 0:b.event)==="*"||((_=(v=g.filter)===null||v===void 0?void 0:v.event)===null||_===void 0?void 0:_.toLocaleLowerCase())===o}).map(g=>g.callback(p,s)):(i=this.bindings[o])===null||i===void 0||i.filter(g=>{var b,v,_,N,j,k;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in g){const S=g.id,P=(b=g.filter)===null||b===void 0?void 0:b.event;return S&&((v=t.ids)===null||v===void 0?void 0:v.includes(S))&&(P==="*"||(P==null?void 0:P.toLocaleLowerCase())===((_=t.data)===null||_===void 0?void 0:_.type.toLocaleLowerCase()))}else{const S=(j=(N=g==null?void 0:g.filter)===null||N===void 0?void 0:N.event)===null||j===void 0?void 0:j.toLocaleLowerCase();return S==="*"||S===((k=t==null?void 0:t.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return g.type.toLocaleLowerCase()===o}).map(g=>{if(typeof p=="object"&&"ids"in p){const b=p.data,{schema:v,table:_,commit_timestamp:N,type:j,errors:k}=b;p=Object.assign(Object.assign({},{schema:v,table:_,commit_timestamp:N,eventType:j,new:{},old:{},errors:k}),this._getPayloadRecords(b))}g.callback(p,s)})}_isClosed(){return this.state===An.closed}_isJoined(){return this.state===An.joined}_isJoining(){return this.state===An.joining}_isLeaving(){return this.state===An.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),i={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(i):this.bindings[r]=[i],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]&&(this.bindings[s]=this.bindings[s].filter(r=>{var i;return!(((i=r.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===s&&yw.isEqual(r.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(vr.close,{},e)}_onError(e){this._on(vr.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=An.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=mj(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=mj(e.columns,e.old_record)),t}}const sx=()=>{},Pf={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},$3=[1e3,2e3,5e3,1e4],z3=1e4,U3=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class V3{constructor(e,t){var s;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Qv,this.transport=null,this.heartbeatIntervalMs=Pf.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=sx,this.ref=0,this.reconnectTimer=null,this.vsn=fj,this.logger=sx,this.conn=null,this.sendBuffer=[],this.serializer=new D3,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=r=>r?(...i)=>r(...i):(...i)=>fetch(...i),!(!((s=t==null?void 0:t.params)===null||s===void 0)&&s.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${Xv.websocket}`,this.httpEndpoint=YM(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t==null?void 0:t.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=C3.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const s=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(s),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case Yo.connecting:return Zo.Connecting;case Yo.open:return Zo.Open;case Yo.closing:return Zo.Closing;default:return Zo.Closed}}isConnected(){return this.connectionState()===Zo.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const s=`realtime:${e}`,r=this.getChannels().find(i=>i.topic===s);if(r)return r;{const i=new yw(`realtime:${e}`,t,this);return this.channels.push(i),i}}push(e){const{topic:t,event:s,payload:r,ref:i}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${s} (${i})`,r),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(P3,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Pf.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(s=>s.topic===e&&(s._isJoined()||s._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:s,event:r,payload:i,ref:o}=t,l=o?`(${o})`:"",c=i.status||"";this.log("receive",`${c} ${s} ${r} ${l}`.trim(),i),this.channels.filter(d=>d._isMember(s)).forEach(d=>d._trigger(r,i,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===Yo.open||this.conn.readyState===Yo.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(vr.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const s=e.match(/\?/)?"&":"?",r=new URLSearchParams(t);return`${e}${s}${r}`}_workerObjectUrl(e){let t;if(e)t=e;else{const s=new Blob([U3],{type:"application/javascript"});t=URL.createObjectURL(s)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(s=>{const r={access_token:t,version:T3};t&&s.updateJoinPayload(r),s.joinedOnce&&s._isJoined()&&s._push(vr.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(s=>{try{s(t)}catch(r){this.log("error",`error in ${e} callback`,r)}})}catch(s){this.log("error",`error triggering ${e} callbacks`,s)}}_setupReconnectionTimer(){this.reconnectTimer=new WM(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Pf.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,s,r,i,o,l,c,d,h,f,p,g;switch(this.transport=(t=e==null?void 0:e.transport)!==null&&t!==void 0?t:null,this.timeout=(s=e==null?void 0:e.timeout)!==null&&s!==void 0?s:Qv,this.heartbeatIntervalMs=(r=e==null?void 0:e.heartbeatIntervalMs)!==null&&r!==void 0?r:Pf.HEARTBEAT_INTERVAL,this.worker=(i=e==null?void 0:e.worker)!==null&&i!==void 0?i:!1,this.accessToken=(o=e==null?void 0:e.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e==null?void 0:e.heartbeatCallback)!==null&&l!==void 0?l:sx,this.vsn=(c=e==null?void 0:e.vsn)!==null&&c!==void 0?c:fj,e!=null&&e.params&&(this.params=e.params),e!=null&&e.logger&&(this.logger=e.logger),(e!=null&&e.logLevel||e!=null&&e.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e==null?void 0:e.reconnectAfterMs)!==null&&d!==void 0?d:b=>$3[b-1]||z3,this.vsn){case HM:this.encode=(h=e==null?void 0:e.encode)!==null&&h!==void 0?h:(b,v)=>v(JSON.stringify(b)),this.decode=(f=e==null?void 0:e.decode)!==null&&f!==void 0?f:(b,v)=>v(JSON.parse(b));break;case E3:this.encode=(p=e==null?void 0:e.encode)!==null&&p!==void 0?p:this.serializer.encode.bind(this.serializer),this.decode=(g=e==null?void 0:e.decode)!==null&&g!==void 0?g:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e==null?void 0:e.workerUrl}}}class xw extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function cn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class B3 extends xw{constructor(e,t,s){super(e),this.name="StorageApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class tb extends xw{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const vw=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),q3=()=>Response,nb=n=>{if(Array.isArray(n))return n.map(t=>nb(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,s])=>{const r=t.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[r]=nb(s)}),e},H3=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},rx=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},W3=(n,e,t)=>He(void 0,void 0,void 0,function*(){const s=yield q3();n instanceof s&&!(t!=null&&t.noResolveJson)?n.json().then(r=>{const i=n.status||500,o=(r==null?void 0:r.statusCode)||i+"";e(new B3(rx(r),i,o))}).catch(r=>{e(new tb(rx(r),r))}):e(new tb(rx(n),n))}),G3=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"||!s?r:(H3(s)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,e!=null&&e.duplex&&(r.duplex=e.duplex),Object.assign(Object.assign({},r),t))};function Nh(n,e,t,s,r,i){return He(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,G3(e,s,r,i)).then(c=>{if(!c.ok)throw c;return s!=null&&s.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>W3(c,l,s))})})}function nh(n,e,t,s){return He(this,void 0,void 0,function*(){return Nh(n,"GET",e,t,s)})}function Rr(n,e,t,s,r){return He(this,void 0,void 0,function*(){return Nh(n,"POST",e,s,r,t)})}function sb(n,e,t,s,r){return He(this,void 0,void 0,function*(){return Nh(n,"PUT",e,s,r,t)})}function Y3(n,e,t,s){return He(this,void 0,void 0,function*(){return Nh(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),s)})}function bw(n,e,t,s,r){return He(this,void 0,void 0,function*(){return Nh(n,"DELETE",e,s,r,t)})}class Z3{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return He(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cn(e))return{data:null,error:e};throw e}})}}var ZM;class K3{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[ZM]="BlobDownloadBuilder",this.promise=null}asStream(){return new Z3(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return He(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(cn(e))return{data:null,error:e};throw e}})}}ZM=Symbol.toStringTag;const J3={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},yj={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class Q3{constructor(e,t={},s,r){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=s,this.fetch=vw(r)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,s,r){return He(this,void 0,void 0,function*(){try{let i;const o=Object.assign(Object.assign({},yj),r);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&s instanceof Blob?(i=new FormData,i.append("cacheControl",o.cacheControl),c&&i.append("metadata",this.encodeMetadata(c)),i.append("",s)):typeof FormData<"u"&&s instanceof FormData?(i=s,i.has("cacheControl")||i.append("cacheControl",o.cacheControl),c&&!i.has("metadata")&&i.append("metadata",this.encodeMetadata(c))):(i=s,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&i instanceof ReadableStream||i&&typeof i=="object"&&"pipe"in i&&typeof i.pipe=="function")&&!o.duplex&&(o.duplex="half")),r!=null&&r.headers&&(l=Object.assign(Object.assign({},l),r.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),f=yield(e=="PUT"?sb:Rr)(this.fetch,`${this.url}/object/${h}`,i,Object.assign({headers:l},o!=null&&o.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:f.Id,fullPath:f.Key},error:null}}catch(i){if(this.shouldThrowOnError)throw i;if(cn(i))return{data:null,error:i};throw i}})}upload(e,t,s){return He(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,s)})}uploadToSignedUrl(e,t,s,r){return He(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),o=this._getFinalPath(i),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:yj.upsert},r),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&s instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",s)):typeof FormData<"u"&&s instanceof FormData?(c=s,c.append("cacheControl",d.cacheControl)):(c=s,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const f=yield sb(this.fetch,l.toString(),c,{headers:h});return{data:{path:i,fullPath:f.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(cn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return He(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);t!=null&&t.upsert&&(r["x-upsert"]="true");const i=yield Rr(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),o=new URL(this.url+i.url),l=o.searchParams.get("token");if(!l)throw new xw("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}update(e,t,s){return He(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,s)})}move(e,t,s){return He(this,void 0,void 0,function*(){try{return{data:yield Rr(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}copy(e,t,s){return He(this,void 0,void 0,function*(){try{return{data:{path:(yield Rr(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:s==null?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}createSignedUrl(e,t,s){return He(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e),i=yield Rr(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},s!=null&&s.transform?{transform:s.transform}:{}),{headers:this.headers});const o=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${o}`)},{data:i,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}createSignedUrls(e,t,s){return He(this,void 0,void 0,function*(){try{const r=yield Rr(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),i=s!=null&&s.download?`&download=${s.download===!0?"":s.download}`:"";return{data:r.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${i}`):null})),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}download(e,t){const r=typeof(t==null?void 0:t.transform)<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString((t==null?void 0:t.transform)||{}),o=i?`?${i}`:"",l=this._getFinalPath(e),c=()=>nh(this.fetch,`${this.url}/${r}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new K3(c,this.shouldThrowOnError)}info(e){return He(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const s=yield nh(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:nb(s),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}exists(e){return He(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield Y3(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s)&&s instanceof tb){const r=s.originalError;if([400,404].includes(r==null?void 0:r.status))return{data:!1,error:s}}throw s}})}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],i=t!=null&&t.download?`download=${t.download===!0?"":t.download}`:"";i!==""&&r.push(i);const l=typeof(t==null?void 0:t.transform)<"u"?"render/image":"object",c=this.transformOptsToQueryString((t==null?void 0:t.transform)||{});c!==""&&r.push(c);let d=r.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${s}${d}`)}}}remove(e){return He(this,void 0,void 0,function*(){try{return{data:yield bw(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}list(e,t,s){return He(this,void 0,void 0,function*(){try{const r=Object.assign(Object.assign(Object.assign({},J3),t),{prefix:e||""});return{data:yield Rr(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}listV2(e,t){return He(this,void 0,void 0,function*(){try{const s=Object.assign({},e);return{data:yield Rr(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,s,{headers:this.headers},t),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const KM="2.81.1",JM={"X-Client-Info":`storage-js/${KM}`};class X3{constructor(e,t={},s,r){this.shouldThrowOnError=!1;const i=new URL(e);r!=null&&r.useNewHostname&&/supabase\.(co|in|red)$/.test(i.hostname)&&!i.hostname.includes("storage.supabase.")&&(i.hostname=i.hostname.replace("supabase.","storage.supabase.")),this.url=i.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},JM),t),this.fetch=vw(s)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return He(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield nh(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}getBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield nh(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}createBucket(e){return He(this,arguments,void 0,function*(t,s={public:!1}){try{return{data:yield Rr(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:s.type,public:s.public,file_size_limit:s.fileSizeLimit,allowed_mime_types:s.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(cn(r))return{data:null,error:r};throw r}})}updateBucket(e,t){return He(this,void 0,void 0,function*(){try{return{data:yield sb(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(cn(s))return{data:null,error:s};throw s}})}emptyBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield Rr(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield bw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class e${constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},JM),t),this.fetch=vw(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield Rr(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}listBuckets(e){return He(this,void 0,void 0,function*(){try{const t=new URLSearchParams;(e==null?void 0:e.limit)!==void 0&&t.set("limit",e.limit.toString()),(e==null?void 0:e.offset)!==void 0&&t.set("offset",e.offset.toString()),e!=null&&e.sortColumn&&t.set("sortColumn",e.sortColumn),e!=null&&e.sortOrder&&t.set("sortOrder",e.sortOrder),e!=null&&e.search&&t.set("search",e.search);const s=t.toString(),r=s?`${this.url}/bucket?${s}`:`${this.url}/bucket`;return{data:yield nh(this.fetch,r,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield bw(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(cn(t))return{data:null,error:t};throw t}})}}const ww={"X-Client-Info":`storage-js/${KM}`,"Content-Type":"application/json"};class QM extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function Xs(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class ix extends QM{constructor(e,t,s){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=s}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class t$ extends QM{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var xj;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(xj||(xj={}));const _w=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),n$=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},vj=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),s$=(n,e,t)=>He(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!(t!=null&&t.noResolveJson)){const r=n.status||500,i=n;if(typeof i.json=="function")i.json().then(o=>{const l=(o==null?void 0:o.statusCode)||(o==null?void 0:o.code)||r+"";e(new ix(vj(o),r,l))}).catch(()=>{const o=r+"",l=i.statusText||`HTTP ${r} error`;e(new ix(l,r,o))});else{const o=r+"",l=i.statusText||`HTTP ${r} error`;e(new ix(l,r,o))}}else e(new t$(vj(n),n))}),r$=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return s?(n$(s)?(r.headers=Object.assign({"Content-Type":"application/json"},e==null?void 0:e.headers),r.body=JSON.stringify(s)):r.body=s,Object.assign(Object.assign({},r),t)):r};function i$(n,e,t,s,r,i){return He(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,r$(e,s,r,i)).then(c=>{if(!c.ok)throw c;if(s!=null&&s.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>s$(c,l,s))})})}function er(n,e,t,s,r){return He(this,void 0,void 0,function*(){return i$(n,"POST",e,s,r,t)})}class a${constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ww),t),this.fetch=_w(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return He(this,void 0,void 0,function*(){try{return{data:(yield er(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}getIndex(e,t){return He(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Xs(s))return{data:null,error:s};throw s}})}listIndexes(e){return He(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return He(this,void 0,void 0,function*(){try{return{data:(yield er(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Xs(s))return{data:null,error:s};throw s}})}}class o${constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ww),t),this.fetch=_w(s)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return He(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield er(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}getVectors(e){return He(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}listVectors(e){return He(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield er(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}queryVectors(e){return He(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}deleteVectors(e){return He(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield er(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}}class l${constructor(e,t={},s){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},ww),t),this.fetch=_w(s)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return He(this,void 0,void 0,function*(){try{return{data:(yield er(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}getBucket(e){return He(this,void 0,void 0,function*(){try{return{data:yield er(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}listBuckets(){return He(this,arguments,void 0,function*(e={}){try{return{data:yield er(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}deleteBucket(e){return He(this,void 0,void 0,function*(){try{return{data:(yield er(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Xs(t))return{data:null,error:t};throw t}})}}class c$ extends l${constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new d$(this.url,this.headers,e,this.fetch)}}class d$ extends a${constructor(e,t,s,r){super(e,t,r),this.vectorBucketName=s}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return He(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return He(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return He(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return He(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new u$(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class u$ extends o${constructor(e,t,s,r,i){super(e,t,i),this.vectorBucketName=s,this.indexName=r}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return He(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return He(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return He(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return He(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return He(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class h$ extends X3{constructor(e,t={},s,r){super(e,t,s,r)}from(e){return new Q3(this.url,this.headers,e,this.fetch)}get vectors(){return new c$(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new e$(this.url+"/iceberg",this.headers,this.fetch)}}const f$="2.81.1";let cu="";typeof Deno<"u"?cu="deno":typeof document<"u"?cu="web":typeof navigator<"u"&&navigator.product==="ReactNative"?cu="react-native":cu="node";const m$={"X-Client-Info":`supabase-js-${cu}/${f$}`},p$={headers:m$},g$={schema:"public"},y$={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},x$={},v$=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),b$=()=>Headers,w$=(n,e,t)=>{const s=v$(t),r=b$();return async(i,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new r(o==null?void 0:o.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),s(i,Object.assign(Object.assign({},o),{headers:d}))}};function _$(n){return n.endsWith("/")?n:n+"/"}function S$(n,e){var t,s;const{db:r,auth:i,realtime:o,global:l}=n,{db:c,auth:d,realtime:h,global:f}=e,p={db:Object.assign(Object.assign({},c),r),auth:Object.assign(Object.assign({},d),i),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},f),l),{headers:Object.assign(Object.assign({},(t=f==null?void 0:f.headers)!==null&&t!==void 0?t:{}),(s=l==null?void 0:l.headers)!==null&&s!==void 0?s:{})}),accessToken:async()=>""};return n.accessToken?p.accessToken=n.accessToken:delete p.accessToken,p}function N$(n){const e=n==null?void 0:n.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(_$(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const XM="2.81.1",ac=30*1e3,rb=3,ax=rb*ac,j$="http://localhost:9999",C$="supabase.auth.token",k$={"X-Client-Info":`gotrue-js/${XM}`},ib="X-Supabase-Api-Version",e2={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},T$=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,E$=10*60*1e3;class sh extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Ge(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class P$ extends sh{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}function M$(n){return Ge(n)&&n.name==="AuthApiError"}class Ko extends sh{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class fo extends sh{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class Ar extends fo{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function D$(n){return Ge(n)&&n.name==="AuthSessionMissingError"}class Gl extends fo{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class Mf extends fo{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class Df extends fo{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function A$(n){return Ge(n)&&n.name==="AuthImplicitGrantRedirectError"}class bj extends fo{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ab extends fo{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ox(n){return Ge(n)&&n.name==="AuthRetryableFetchError"}class wj extends fo{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}class ob extends fo{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const fp="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),_j=` 	
\r=`.split(""),I$=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<_j.length;e+=1)n[_j[e].charCodeAt(0)]=-2;for(let e=0;e<fp.length;e+=1)n[fp[e].charCodeAt(0)]=e;return n})();function Sj(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(fp[s]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const s=e.queue>>e.queuedBits-6&63;t(fp[s]),e.queuedBits-=6}}function t2(n,e,t){const s=I$[n];if(s>-1)for(e.queue=e.queue<<6|s,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(s===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function Nj(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},s={utf8seq:0,codepoint:0},r={queue:0,queuedBits:0},i=o=>{L$(o,s,t)};for(let o=0;o<n.length;o+=1)t2(n.charCodeAt(o),r,i);return e.join("")}function O$(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function R$(n,e){for(let t=0;t<n.length;t+=1){let s=n.charCodeAt(t);if(s>55295&&s<=56319){const r=(s-55296)*1024&65535;s=(n.charCodeAt(t+1)-56320&65535|r)+65536,t+=1}O$(s,e)}}function L$(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let s=1;s<6;s+=1)if(!(n>>7-s&1)){e.utf8seq=s;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function Ac(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};for(let r=0;r<n.length;r+=1)t2(n.charCodeAt(r),t,s);return new Uint8Array(e)}function F$(n){const e=[];return R$(n,t=>e.push(t)),new Uint8Array(e)}function tl(n){const e=[],t={queue:0,queuedBits:0},s=r=>{e.push(r)};return n.forEach(r=>Sj(r,t,s)),Sj(null,t,s),e.join("")}function $$(n){return Math.round(Date.now()/1e3)+n}function z$(){return Symbol("auth-callback")}const Wn=()=>typeof window<"u"&&typeof document<"u",Po={tested:!1,writable:!1},n2=()=>{if(!Wn())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Po.tested)return Po.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Po.tested=!0,Po.writable=!0}catch{Po.tested=!0,Po.writable=!1}return Po.writable};function U$(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((r,i)=>{e[i]=r})}catch{}return t.searchParams.forEach((s,r)=>{e[r]=s}),e}const s2=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),V$=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",oc=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Mo=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},wa=async(n,e)=>{await n.removeItem(e)};class vg{constructor(){this.promise=new vg.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}vg.promiseConstructor=Promise;function lx(n){const e=n.split(".");if(e.length!==3)throw new ob("Invalid JWT structure");for(let s=0;s<e.length;s++)if(!T$.test(e[s]))throw new ob("JWT not in base64url format");return{header:JSON.parse(Nj(e[0])),payload:JSON.parse(Nj(e[1])),signature:Ac(e[2]),raw:{header:e[0],payload:e[1]}}}async function B$(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function q$(n,e){return new Promise((s,r)=>{(async()=>{for(let i=0;i<1/0;i++)try{const o=await n(i);if(!e(i,null,o)){s(o);return}}catch(o){if(!e(i,o)){r(o);return}}})()})}function H$(n){return("0"+n.toString(16)).substr(-2)}function W$(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",s=t.length;let r="";for(let i=0;i<56;i++)r+=t.charAt(Math.floor(Math.random()*s));return r}return crypto.getRandomValues(e),Array.from(e,H$).join("")}async function G$(n){const t=new TextEncoder().encode(n),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map(i=>String.fromCharCode(i)).join("")}async function Y$(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await G$(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Yl(n,e,t=!1){const s=W$();let r=s;t&&(r+="/PASSWORD_RECOVERY"),await oc(n,`${e}-code-verifier`,r);const i=await Y$(s);return[i,s===i?"plain":"s256"]}const Z$=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function K$(n){const e=n.headers.get(ib);if(!e||!e.match(Z$))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function J$(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function Q$(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const X$=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Zl(n){if(!X$.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function cx(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const s=t.toString();if(s==="Symbol(Symbol.toPrimitive)"||s==="Symbol(Symbol.toStringTag)"||s==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function e6(n,e){return new Proxy(n,{get:(t,s,r)=>{if(s==="__isInsecureUserWarningProxy")return!0;if(typeof s=="symbol"){const i=s.toString();if(i==="Symbol(Symbol.toPrimitive)"||i==="Symbol(Symbol.toStringTag)"||i==="Symbol(util.inspect.custom)"||i==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,s,r)}return!e.value&&typeof s=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,s,r)}})}function jj(n){return JSON.parse(JSON.stringify(n))}const qo=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),t6=[502,503,504];async function Cj(n){var e;if(!V$(n))throw new ab(qo(n),0);if(t6.includes(n.status))throw new ab(qo(n),n.status);let t;try{t=await n.json()}catch(i){throw new Ko(qo(i),i)}let s;const r=K$(n);if(r&&r.getTime()>=e2["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?s=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(s=t.error_code),s){if(s==="weak_password")throw new wj(qo(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(s==="session_not_found")throw new Ar}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((i,o)=>i&&typeof o=="string",!0))throw new wj(qo(t),n.status,t.weak_password.reasons);throw new P$(qo(t),n.status||500,s)}const n6=(n,e,t,s)=>{const r={method:n,headers:(e==null?void 0:e.headers)||{}};return n==="GET"?r:(r.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e==null?void 0:e.headers),r.body=JSON.stringify(s),Object.assign(Object.assign({},r),t))};async function nt(n,e,t,s){var r;const i=Object.assign({},s==null?void 0:s.headers);i[ib]||(i[ib]=e2["2024-01-01"].name),s!=null&&s.jwt&&(i.Authorization=`Bearer ${s.jwt}`);const o=(r=s==null?void 0:s.query)!==null&&r!==void 0?r:{};s!=null&&s.redirectTo&&(o.redirect_to=s.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await s6(n,e,t+l,{headers:i,noResolveJson:s==null?void 0:s.noResolveJson},{},s==null?void 0:s.body);return s!=null&&s.xform?s==null?void 0:s.xform(c):{data:Object.assign({},c),error:null}}async function s6(n,e,t,s,r,i){const o=n6(e,s,r,i);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new ab(qo(c),0)}if(l.ok||await Cj(l),s!=null&&s.noResolveJson)return l;try{return await l.json()}catch(c){await Cj(c)}}function Ir(n){var e;let t=null;a6(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=$$(n.expires_in)));const s=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:s},error:null}}function kj(n){const e=Ir(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,s)=>t&&typeof s=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ma(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function r6(n){return{data:n,error:null}}function i6(n){const{action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i}=n,o=ud(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:s,redirect_to:r,verification_type:i},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Tj(n){return n}function a6(n){return n.access_token&&n.refresh_token&&n.expires_in}const dx=["global","local","others"];class o6{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=s2(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=dx[0]){if(dx.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${dx.join(", ")}`);try{return await nt(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ge(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await nt(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ma})}catch(s){if(Ge(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=ud(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=s==null?void 0:s.newEmail,delete r.newEmail),await nt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:i6,redirectTo:t==null?void 0:t.redirectTo})}catch(t){if(Ge(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await nt(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ma})}catch(t){if(Ge(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await nt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Tj});if(h.error)throw h.error;const f=await h.json(),p=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(b.split(";")[1].split("=")[1]);d[`${_}Page`]=v}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Ge(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Zl(e);try{return await nt(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ma})}catch(t){if(Ge(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Zl(e);try{return await nt(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ma})}catch(s){if(Ge(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){Zl(e);try{return await nt(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ma})}catch(s){if(Ge(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){Zl(e.userId);try{const{data:t,error:s}=await nt(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:r=>({data:{factors:r},error:null})});return{data:t,error:s}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Zl(e.userId),Zl(e.id);try{return{data:await nt(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,s,r,i,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await nt(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(s=(t=e==null?void 0:e.page)===null||t===void 0?void 0:t.toString())!==null&&s!==void 0?s:"",per_page:(i=(r=e==null?void 0:e.perPage)===null||r===void 0?void 0:r.toString())!==null&&i!==void 0?i:""},xform:Tj});if(h.error)throw h.error;const f=await h.json(),p=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,g=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return g.length>0&&(g.forEach(b=>{const v=parseInt(b.split(";")[0].split("=")[1].substring(0,1)),_=JSON.parse(b.split(";")[1].split("=")[1]);d[`${_}Page`]=v}),d.total=parseInt(p)),{data:Object.assign(Object.assign({},f),d),error:null}}catch(d){if(Ge(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await nt(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await nt(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await nt(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:s=>({data:s,error:null})})}catch(s){if(Ge(s))return{data:null,error:s};throw s}}async _deleteOAuthClient(e){try{return await nt(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(Ge(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await nt(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(Ge(t))return{data:null,error:t};throw t}}}function Ej(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Kl={debug:!!(globalThis&&n2()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class r2 extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class l6 extends r2{}async function c6(n,e,t){Kl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const s=new globalThis.AbortController;return e>0&&setTimeout(()=>{s.abort(),Kl.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:s.signal},async r=>{if(r){Kl.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,r.name);try{return await t()}finally{Kl.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,r.name)}}else{if(e===0)throw Kl.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new l6(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Kl.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function d6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function i2(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function u6(n){return parseInt(n,16)}function h6(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,s=>s.toString(16).padStart(2,"0")).join("")}function f6(n){var e;const{chainId:t,domain:s,expirationTime:r,issuedAt:i=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:h,uri:f,version:p}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!s)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!f)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(p!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${p}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const g=i2(n.address),b=h?`${h}://${s}`:s,v=n.statement?`${n.statement}
`:"",_=`${b} wants you to sign in with your Ethereum account:
${g}

${v}`;let N=`URI: ${f}
Version: ${p}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${i.toISOString()}`;if(r&&(N+=`
Expiration Time: ${r.toISOString()}`),l&&(N+=`
Not Before: ${l.toISOString()}`),c&&(N+=`
Request ID: ${c}`),d){let j=`
Resources:`;for(const k of d){if(!k||typeof k!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${k}`);j+=`
- ${k}`}N+=j}return`${_}
${N}`}class Tn extends Error{constructor({message:e,code:t,cause:s,name:r}){var i;super(e,{cause:s}),this.__isWebAuthnError=!0,this.name=(i=r??(s instanceof Error?s.name:void 0))!==null&&i!==void 0?i:"Unknown Error",this.code=t}}class mp extends Tn{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function m6({error:n,options:e}){var t,s,r;const{publicKey:i}=e;if(!i)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Tn({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=i.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new Tn({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((s=i.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new Tn({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((r=i.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new Tn({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new Tn({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new Tn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return i.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new Tn({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new Tn({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(a2(o)){if(i.rp.id!==o)return new Tn({message:`The RP ID "${i.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Tn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(i.user.id.byteLength<1||i.user.id.byteLength>64)return new Tn({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new Tn({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Tn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function p6({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new Tn({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new Tn({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const s=window.location.hostname;if(a2(s)){if(t.rpId!==s)return new Tn({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new Tn({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new Tn({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new Tn({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class g6{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const y6=new g6;function x6(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:s}=n,r=ud(n,["challenge","user","excludeCredentials"]),i=Ac(e).buffer,o=Object.assign(Object.assign({},t),{id:Ac(t.id).buffer}),l=Object.assign(Object.assign({},r),{challenge:i,user:o});if(s&&s.length>0){l.excludeCredentials=new Array(s.length);for(let c=0;c<s.length;c++){const d=s[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:Ac(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function v6(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,s=ud(n,["challenge","allowCredentials"]),r=Ac(e).buffer,i=Object.assign(Object.assign({},s),{challenge:r});if(t&&t.length>0){i.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];i.allowCredentials[o]=Object.assign(Object.assign({},l),{id:Ac(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return i}function b6(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:tl(new Uint8Array(n.response.attestationObject)),clientDataJSON:tl(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function w6(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,s=n.getClientExtensionResults(),r=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:tl(new Uint8Array(r.authenticatorData)),clientDataJSON:tl(new Uint8Array(r.clientDataJSON)),signature:tl(new Uint8Array(r.signature)),userHandle:r.userHandle?tl(new Uint8Array(r.userHandle)):void 0},type:"public-key",clientExtensionResults:s,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function a2(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Pj(){var n,e;return!!(Wn()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator==null?void 0:navigator.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator==null?void 0:navigator.credentials)===null||e===void 0?void 0:e.get)=="function")}async function _6(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new mp("Browser returned unexpected credential type",e)}:{data:null,error:new mp("Empty credential response",e)}}catch(e){return{data:null,error:m6({error:e,options:n})}}}async function S6(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new mp("Browser returned unexpected credential type",e)}:{data:null,error:new mp("Empty credential response",e)}}catch(e){return{data:null,error:p6({error:e,options:n})}}}const N6={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},j6={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function pp(...n){const e=r=>r!==null&&typeof r=="object"&&!Array.isArray(r),t=r=>r instanceof ArrayBuffer||ArrayBuffer.isView(r),s={};for(const r of n)if(r)for(const i in r){const o=r[i];if(o!==void 0)if(Array.isArray(o))s[i]=o;else if(t(o))s[i]=o;else if(e(o)){const l=s[i];e(l)?s[i]=pp(l,o):s[i]=pp(o)}else s[i]=o}return s}function C6(n,e){return pp(N6,n,e||{})}function k6(n,e){return pp(j6,n,e||{})}class T6{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:s,signal:r},i){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=r??y6.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${s}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=C6(o.webauthn.credential_options.publicKey,i==null?void 0:i.create),{data:h,error:f}=await _6({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}case"request":{const d=k6(o.webauthn.credential_options.publicKey,i==null?void 0:i.request),{data:h,error:f}=await S6(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:f}}}}catch(o){return Ge(o)?{data:null,error:o}:{data:null,error:new Ko("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:s}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:s})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!t)return{data:null,error:new sh("rpId is required for WebAuthn authentication")};try{if(!Pj())return{data:null,error:new Ko("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:s},signal:r},{request:i});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:s,credential_response:c.credential_response}})}catch(o){return Ge(o)?{data:null,error:o}:{data:null,error:new Ko("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:s=typeof window<"u"?[window.location.origin]:void 0,signal:r}={}},i){if(!t)return{data:null,error:new sh("rpId is required for WebAuthn registration")};try{if(!Pj())return{data:null,error:new Ko("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var f;return(f=h.data)===null||f===void 0?void 0:f.all.find(p=>p.factor_type==="webauthn"&&p.friendly_name===e&&p.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h==null?void 0:h.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:s},signal:r},{create:i});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:s,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return Ge(o)?{data:null,error:o}:{data:null,error:new Ko("Unexpected error in register",o)}}}}d6();const E6={url:j$,storageKey:C$,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:k$,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Mj(n,e,t){return await t()}const Jl={};class rh{get jwks(){var e,t;return(t=(e=Jl[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Jl[this.storageKey]=Object.assign(Object.assign({},Jl[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Jl[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Jl[this.storageKey]=Object.assign(Object.assign({},Jl[this.storageKey]),{cachedAt:e})}constructor(e){var t,s,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const i=Object.assign(Object.assign({},E6),e);if(this.storageKey=i.storageKey,this.instanceID=(t=rh.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,rh.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!i.debug,typeof i.debug=="function"&&(this.logger=i.debug),this.instanceID>0&&Wn()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=i.persistSession,this.autoRefreshToken=i.autoRefreshToken,this.admin=new o6({url:i.url,headers:i.headers,fetch:i.fetch}),this.url=i.url,this.headers=i.headers,this.fetch=s2(i.fetch),this.lock=i.lock||Mj,this.detectSessionInUrl=i.detectSessionInUrl,this.flowType=i.flowType,this.hasCustomAuthorizationHeader=i.hasCustomAuthorizationHeader,this.throwOnError=i.throwOnError,i.lock?this.lock=i.lock:Wn()&&(!((s=globalThis==null?void 0:globalThis.navigator)===null||s===void 0)&&s.locks)?this.lock=c6:this.lock=Mj,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new T6(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(i.storage?this.storage=i.storage:n2()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Ej(this.memoryStorage)),i.userStorage&&(this.userStorage=i.userStorage)):(this.memoryStorage={},this.storage=Ej(this.memoryStorage)),Wn()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${XM}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},s="none";if(Wn()&&(t=U$(window.location.href),this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce")),Wn()&&this.detectSessionInUrl&&s!=="none"){const{data:r,error:i}=await this._getSessionFromURL(t,s);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),A$(i)){const c=(e=i.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:o,redirectType:l}=r;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ge(t)?this._returnResult({error:t}):this._returnResult({error:new Ko("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const i=await nt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(s=(t=e==null?void 0:e.options)===null||t===void 0?void 0:t.data)!==null&&s!==void 0?s:{},gotrue_meta_security:{captcha_token:(r=e==null?void 0:e.options)===null||r===void 0?void 0:r.captchaToken}},xform:Ir}),{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Ge(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signUp(e){var t,s,r;try{let i;if("email"in e){const{email:h,password:f,options:p}=e;let g=null,b=null;this.flowType==="pkce"&&([g,b]=await Yl(this.storage,this.storageKey)),i=await nt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:p==null?void 0:p.emailRedirectTo,body:{email:h,password:f,data:(t=p==null?void 0:p.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken},code_challenge:g,code_challenge_method:b},xform:Ir})}else if("phone"in e){const{phone:h,password:f,options:p}=e;i=await nt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:f,data:(s=p==null?void 0:p.data)!==null&&s!==void 0?s:{},channel:(r=p==null?void 0:p.channel)!==null&&r!==void 0?r:"sms",gotrue_meta_security:{captcha_token:p==null?void 0:p.captchaToken}},xform:Ir})}else throw new Mf("You must provide either an email or phone number and a password");const{data:o,error:l}=i;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(i){if(Ge(i))return this._returnResult({data:{user:null,session:null},error:i});throw i}}async signInWithPassword(e){try{let t;if("email"in e){const{email:i,password:o,options:l}=e;t=await nt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:kj})}else if("phone"in e){const{phone:i,password:o,options:l}=e;t=await nt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},xform:kj})}else throw new Mf("You must provide either an email or phone number and a password");const{data:s,error:r}=t;if(r)return this._returnResult({data:{user:null,session:null},error:r});if(!s||!s.session||!s.user){const i=new Gl;return this._returnResult({data:{user:null,session:null},error:i})}return s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),this._returnResult({data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,s,r,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(s=e.options)===null||s===void 0?void 0:s.scopes,queryParams:(r=e.options)===null||r===void 0?void 0:r.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,s,r,i,o,l,c,d,h,f,p;let g,b;if("message"in e)g=e.message,b=e.signature;else{const{chain:v,wallet:_,statement:N,options:j}=e;let k;if(Wn())if(typeof _=="object")k=_;else{const O=window;if("ethereum"in O&&typeof O.ethereum=="object"&&"request"in O.ethereum&&typeof O.ethereum.request=="function")k=O.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof _!="object"||!(j!=null&&j.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");k=_}const S=new URL((t=j==null?void 0:j.url)!==null&&t!==void 0?t:window.location.href),P=await k.request({method:"eth_requestAccounts"}).then(O=>O).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!P||P.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const E=i2(P[0]);let M=(s=j==null?void 0:j.signInWithEthereum)===null||s===void 0?void 0:s.chainId;if(!M){const O=await k.request({method:"eth_chainId"});M=u6(O)}const I={domain:S.host,address:E,statement:N,uri:S.href,version:"1",chainId:M,nonce:(r=j==null?void 0:j.signInWithEthereum)===null||r===void 0?void 0:r.nonce,issuedAt:(o=(i=j==null?void 0:j.signInWithEthereum)===null||i===void 0?void 0:i.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=j==null?void 0:j.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=j==null?void 0:j.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=j==null?void 0:j.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=j==null?void 0:j.signInWithEthereum)===null||h===void 0?void 0:h.resources};g=f6(I),b=await k.request({method:"personal_sign",params:[h6(g),E]})}try{const{data:v,error:_}=await nt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:g,signature:b},!((f=e.options)===null||f===void 0)&&f.captchaToken?{gotrue_meta_security:{captcha_token:(p=e.options)===null||p===void 0?void 0:p.captchaToken}}:null),xform:Ir});if(_)throw _;if(!v||!v.session||!v.user){const N=new Gl;return this._returnResult({data:{user:null,session:null},error:N})}return v.session&&(await this._saveSession(v.session),await this._notifyAllSubscribers("SIGNED_IN",v.session)),this._returnResult({data:Object.assign({},v),error:_})}catch(v){if(Ge(v))return this._returnResult({data:{user:null,session:null},error:v});throw v}}async signInWithSolana(e){var t,s,r,i,o,l,c,d,h,f,p,g;let b,v;if("message"in e)b=e.message,v=e.signature;else{const{chain:_,wallet:N,statement:j,options:k}=e;let S;if(Wn())if(typeof N=="object")S=N;else{const E=window;if("solana"in E&&typeof E.solana=="object"&&("signIn"in E.solana&&typeof E.solana.signIn=="function"||"signMessage"in E.solana&&typeof E.solana.signMessage=="function"))S=E.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof N!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=N}const P=new URL((t=k==null?void 0:k.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in S&&S.signIn){const E=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:P.host,uri:P.href}),j?{statement:j}:null));let M;if(Array.isArray(E)&&E[0]&&typeof E[0]=="object")M=E[0];else if(E&&typeof E=="object"&&"signedMessage"in E&&"signature"in E)M=E;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in M&&"signature"in M&&(typeof M.signedMessage=="string"||M.signedMessage instanceof Uint8Array)&&M.signature instanceof Uint8Array)b=typeof M.signedMessage=="string"?M.signedMessage:new TextDecoder().decode(M.signedMessage),v=M.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");b=[`${P.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...j?["",j,""]:[""],"Version: 1",`URI: ${P.href}`,`Issued At: ${(r=(s=k==null?void 0:k.signInWithSolana)===null||s===void 0?void 0:s.issuedAt)!==null&&r!==void 0?r:new Date().toISOString()}`,...!((i=k==null?void 0:k.signInWithSolana)===null||i===void 0)&&i.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((o=k==null?void 0:k.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((d=k==null?void 0:k.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((f=(h=k==null?void 0:k.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||f===void 0)&&f.length?["Resources",...k.signInWithSolana.resources.map(M=>`- ${M}`)]:[]].join(`
`);const E=await S.signMessage(new TextEncoder().encode(b),"utf8");if(!E||!(E instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");v=E}}try{const{data:_,error:N}=await nt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:b,signature:tl(v)},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(g=e.options)===null||g===void 0?void 0:g.captchaToken}}:null),xform:Ir});if(N)throw N;if(!_||!_.session||!_.user){const j=new Gl;return this._returnResult({data:{user:null,session:null},error:j})}return _.session&&(await this._saveSession(_.session),await this._notifyAllSubscribers("SIGNED_IN",_.session)),this._returnResult({data:Object.assign({},_),error:N})}catch(_){if(Ge(_))return this._returnResult({data:{user:null,session:null},error:_});throw _}}async _exchangeCodeForSession(e){const t=await Mo(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(t??"").split("/");try{const{data:i,error:o}=await nt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:Ir});if(await wa(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!i||!i.session||!i.user){const l=new Gl;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),this._returnResult({data:Object.assign(Object.assign({},i),{redirectType:r??null}),error:o})}catch(i){if(Ge(i))return this._returnResult({data:{user:null,session:null,redirectType:null},error:i});throw i}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:i,nonce:o}=e,l=await nt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:i,nonce:o,gotrue_meta_security:{captcha_token:t==null?void 0:t.captchaToken}},xform:Ir}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Gl;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,s,r,i,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Yl(this.storage,this.storageKey));const{error:f}=await nt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c==null?void 0:c.data)!==null&&t!==void 0?t:{},create_user:(s=c==null?void 0:c.shouldCreateUser)!==null&&s!==void 0?s:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c==null?void 0:c.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:f})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await nt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(r=c==null?void 0:c.data)!==null&&r!==void 0?r:{},create_user:(i=c==null?void 0:c.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:c==null?void 0:c.captchaToken},channel:(o=c==null?void 0:c.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d==null?void 0:d.message_id},error:h})}throw new Mf("You must provide either an email or phone number.")}catch(l){if(Ge(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,s;try{let r,i;"options"in e&&(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo,i=(s=e.options)===null||s===void 0?void 0:s.captchaToken);const{data:o,error:l}=await nt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:r,xform:Ir});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c!=null&&c.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(r){if(Ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}}async signInWithSSO(e){var t,s,r,i,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Yl(this.storage,this.storageKey));const d=await nt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&s!==void 0?s:void 0}),!((r=e==null?void 0:e.options)===null||r===void 0)&&r.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:r6});return!((i=d.data)===null||i===void 0)&&i.url&&Wn()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(Ge(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new Ar;const{error:r}=await nt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:r})})}catch(e){if(Ge(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:i}=e,{error:o}=await nt(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}},redirectTo:i==null?void 0:i.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:s,type:r,options:i}=e,{data:o,error:l}=await nt(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:i==null?void 0:i.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o==null?void 0:o.message_id},error:l})}throw new Mf("You must provide either an email or phone number and a type")}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const s=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),r=(async()=>(await s,await t()))();return this.pendingInLock.push((async()=>{try{await r}catch{}})()),r}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const s=t();for(this.pendingInLock.push((async()=>{try{await s}catch{}})()),await s;this.pendingInLock.length;){const r=[...this.pendingInLock];await Promise.all(r),this.pendingInLock.splice(0,r.length)}return await s}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Mo(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=e.expires_at?e.expires_at*1e3-Date.now()<ax:!1;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.userStorage){const o=await Mo(this.userStorage,this.storageKey+"-user");o!=null&&o.user?e.user=o.user:e.user=cx()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=e6(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{session:null},error:i}):this._returnResult({data:{session:r},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await nt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ma}):await this._useSession(async t=>{var s,r,i;const{data:o,error:l}=t;if(l)throw l;return!(!((s=o.session)===null||s===void 0)&&s.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new Ar}:await nt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(r=o.session)===null||r===void 0?void 0:r.access_token)!==null&&i!==void 0?i:void 0,xform:Ma})})}catch(t){if(Ge(t))return D$(t)&&(await this._removeSession(),await wa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async s=>{const{data:r,error:i}=s;if(i)throw i;if(!r.session)throw new Ar;const o=r.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Yl(this.storage,this.storageKey));const{data:d,error:h}=await nt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t==null?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ma});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(s){if(Ge(s))return this._returnResult({data:{user:null},error:s});throw s}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new Ar;const t=Date.now()/1e3;let s=t,r=!0,i=null;const{payload:o}=lx(e.access_token);if(o.exp&&(s=o.exp,r=s<=t),r){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};i=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;i={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return this._returnResult({data:{user:i.user,session:i},error:null})}catch(t){if(Ge(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var s;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(s=o.session)!==null&&s!==void 0?s:void 0}if(!(e!=null&&e.refresh_token))throw new Ar;const{data:r,error:i}=await this._callRefreshToken(e.refresh_token);return i?this._returnResult({data:{user:null,session:null},error:i}):r?this._returnResult({data:{user:r.user,session:r},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(Ge(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Wn())throw new Df("No browser detected.");if(e.error||e.error_description||e.error_code)throw new Df(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new bj("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new Df("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new bj("No code detected.");const{data:j,error:k}=await this._exchangeCodeForSession(e.code);if(k)throw k;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:j.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:i,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!i||!l||!o||!d)throw new Df("No session defined in URL");const h=Math.round(Date.now()/1e3),f=parseInt(l);let p=h+f;c&&(p=parseInt(c));const g=p-h;g*1e3<=ac&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${g}s, should have been closer to ${f}s`);const b=p-f;h-b>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",b,p,h):h-b<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",b,p,h);const{data:v,error:_}=await this._getUser(i);if(_)throw _;const N={provider_token:s,provider_refresh_token:r,access_token:i,expires_in:f,expires_at:p,refresh_token:o,token_type:d,user:v.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:N,redirectType:e.type},error:null})}catch(s){if(Ge(s))return this._returnResult({data:{session:null,redirectType:null},error:s});throw s}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Mo(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({error:i});const o=(s=r.session)===null||s===void 0?void 0:s.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(M$(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await wa(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=z$(),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession(async t=>{var s,r;try{const{data:{session:i},error:o}=t;if(o)throw o;await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,t={}){let s=null,r=null;this.flowType==="pkce"&&([s,r]=await Yl(this.storage,this.storageKey,!0));try{return await nt(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(i){if(Ge(i))return this._returnResult({data:null,error:i});throw i}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:s,error:r}=await this._useSession(async i=>{var o,l,c,d,h;const{data:f,error:p}=i;if(p)throw p;const g=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await nt(this.fetch,"GET",g,{headers:this.headers,jwt:(h=(d=f.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(r)throw r;return Wn()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(s==null?void 0:s.url),this._returnResult({data:{provider:e.provider,url:s==null?void 0:s.url},error:null})}catch(s){if(Ge(s))return this._returnResult({data:{provider:e.provider,url:null},error:s});throw s}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var s;try{const{error:r,data:{session:i}}=t;if(r)throw r;const{options:o,provider:l,token:c,access_token:d,nonce:h}=e,f=await nt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(s=i==null?void 0:i.access_token)!==null&&s!==void 0?s:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o==null?void 0:o.captchaToken}},xform:Ir}),{data:p,error:g}=f;return g?this._returnResult({data:{user:null,session:null},error:g}):!p||!p.session||!p.user?this._returnResult({data:{user:null,session:null},error:new Gl}):(p.session&&(await this._saveSession(p.session),await this._notifyAllSubscribers("USER_UPDATED",p.session)),this._returnResult({data:p,error:g}))}catch(r){if(Ge(r))return this._returnResult({data:{user:null,session:null},error:r});throw r}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)throw o;return await nt(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(r=(s=i.session)===null||s===void 0?void 0:s.access_token)!==null&&r!==void 0?r:void 0})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const s=Date.now();return await q$(async r=>(r>0&&await B$(200*Math.pow(2,r-1)),this._debug(t,"refreshing attempt",r),await nt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Ir})),(r,i)=>{const o=200*Math.pow(2,r);return i&&ox(i)&&Date.now()+o-s<ac})}catch(s){if(this._debug(t,"error",s),Ge(s))return this._returnResult({data:{session:null,user:null},error:s});throw s}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Wn()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e,t;const s="#_recoverAndRefresh()";this._debug(s,"begin");try{const r=await Mo(this.storage,this.storageKey);if(r&&this.userStorage){let o=await Mo(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:r.user},await oc(this.userStorage,this.storageKey+"-user",o)),r.user=(e=o==null?void 0:o.user)!==null&&e!==void 0?e:cx()}else if(r&&!r.user&&!r.user){const o=await Mo(this.storage,this.storageKey+"-user");o&&(o!=null&&o.user)?(r.user=o.user,await wa(this.storage,this.storageKey+"-user"),await oc(this.storage,this.storageKey,r)):r.user=cx()}if(this._debug(s,"session from storage",r),!this._isValidSession(r)){this._debug(s,"session is not valid"),r!==null&&await this._removeSession();return}const i=((t=r.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ax;if(this._debug(s,`session has${i?"":" not"} expired with margin of ${ax}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:o}=await this._callRefreshToken(r.refresh_token);o&&(console.error(o),ox(o)||(this._debug(s,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(r.user&&r.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(r.access_token);!l&&(o!=null&&o.user)?(r.user=o.user,await this._saveSession(r),await this._notifyAllSubscribers("SIGNED_IN",r)):this._debug(s,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(s,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(s,"error",r),console.error(r);return}finally{this._debug(s,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new Ar;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new vg;const{data:i,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!i.session)throw new Ar;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const l={data:i.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(i){if(this._debug(r,"error",i),Ge(i)){const o={data:null,error:i};return ox(i)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(s=this.refreshingDeferred)===null||s===void 0||s.reject(i),i}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const i=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){i.push(c)}});if(await Promise.all(o),i.length>0){for(let l=0;l<i.length;l+=1)console.error(i[l]);throw i[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),s=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!s&&t.user&&await oc(this.userStorage,this.storageKey+"-user",{user:t.user});const r=Object.assign({},t);delete r.user;const i=jj(r);await oc(this.storage,this.storageKey,i)}else{const r=jj(t);await oc(this.storage,this.storageKey,r)}}async _removeSession(){this._debug("#_removeSession()"),await wa(this.storage,this.storageKey),await wa(this.storage,this.storageKey+"-code-verifier"),await wa(this.storage,this.storageKey+"-user"),this.userStorage&&await wa(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Wn()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),ac);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:s}}=t;if(!s||!s.refresh_token||!s.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const r=Math.floor((s.expires_at*1e3-e)/ac);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts ${ac}ms, refresh threshold is ${rb} ticks`),r<=rb&&await this._callRefreshToken(s.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof r2)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Wn()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if(s!=null&&s.redirectTo&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),s!=null&&s.scopes&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),this.flowType==="pkce"){const[i,o]=await Yl(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(o)}`});r.push(l.toString())}if(s!=null&&s.queryParams){const i=new URLSearchParams(s.queryParams);r.push(i.toString())}return s!=null&&s.skipBrowserRedirect&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;return i?this._returnResult({data:null,error:i}):await nt(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var s,r;const{data:i,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await nt(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(s=i==null?void 0:i.session)===null||s===void 0?void 0:s.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((r=c==null?void 0:c.totp)===null||r===void 0)&&r.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?b6(e.webauthn.credential_response):w6(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await nt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var s;const{data:r,error:i}=t;if(i)return this._returnResult({data:null,error:i});const o=await nt(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(s=r==null?void 0:r.session)===null||s===void 0?void 0:s.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:x6(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:v6(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?this._returnResult({data:null,error:s}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:s}=await this.getUser();if(s)return{data:null,error:s};const r={all:[],phone:[],totp:[],webauthn:[]};for(const i of(e=t==null?void 0:t.factors)!==null&&e!==void 0?e:[])r.all.push(i),i.status==="verified"&&r[i.factor_type].push(i);return{data:r,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:s},error:r}=await this.getSession();if(r)return this._returnResult({data:null,error:r});if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:i}=lx(s.access_token);let o=null;i.aal&&(o=i.aal);let l=o;((t=(e=s.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=i.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:s},error:r}=t;return r?this._returnResult({data:null,error:r}):s?await nt(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:s.access_token,xform:i=>({data:i,error:null})}):this._returnResult({data:null,error:new Ar})})}catch(t){if(Ge(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Ar});const o=await nt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ge(s))return this._returnResult({data:null,error:s});throw s}}async _denyAuthorization(e,t){try{return await this._useSession(async s=>{const{data:{session:r},error:i}=s;if(i)return this._returnResult({data:null,error:i});if(!r)return this._returnResult({data:null,error:new Ar});const o=await nt(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:r.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Wn()&&!(t!=null&&t.skipBrowserRedirect)&&window.location.assign(o.data.redirect_url),o})}catch(s){if(Ge(s))return this._returnResult({data:null,error:s});throw s}}async fetchJwk(e,t={keys:[]}){let s=t.keys.find(l=>l.kid===e);if(s)return s;const r=Date.now();if(s=this.jwks.keys.find(l=>l.kid===e),s&&this.jwks_cached_at+E$>r)return s;const{data:i,error:o}=await nt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!i.keys||i.keys.length===0||(this.jwks=i,this.jwks_cached_at=r,s=i.keys.find(l=>l.kid===e),!s)?null:s}async getClaims(e,t={}){try{let s=e;if(!s){const{data:g,error:b}=await this.getSession();if(b||!g.session)return this._returnResult({data:null,error:b});s=g.session.access_token}const{header:r,payload:i,signature:o,raw:{header:l,payload:c}}=lx(s);t!=null&&t.allowExpired||J$(i.exp);const d=!r.alg||r.alg.startsWith("HS")||!r.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(r.kid,t!=null&&t.keys?{keys:t.keys}:t==null?void 0:t.jwks);if(!d){const{error:g}=await this.getUser(s);if(g)throw g;return{data:{claims:i,header:r,signature:o},error:null}}const h=Q$(r.alg),f=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,f,o,F$(`${l}.${c}`)))throw new ob("Invalid JWT signature");return{data:{claims:i,header:r,signature:o},error:null}}catch(s){if(Ge(s))return this._returnResult({data:null,error:s});throw s}}}rh.nextInstanceID={};const P6=rh;class M6 extends P6{constructor(e){super(e)}}class D6{constructor(e,t,s){var r,i,o;this.supabaseUrl=e,this.supabaseKey=t;const l=N$(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:g$,realtime:x$,auth:Object.assign(Object.assign({},y$),{storageKey:c}),global:p$},h=S$(s??{},d);this.storageKey=(r=h.auth.storageKey)!==null&&r!==void 0?r:"",this.headers=(i=h.global.headers)!==null&&i!==void 0?i:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(f,p)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(p)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=w$(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(f=>this.realtime.setAuth(f)).catch(f=>console.warn("Failed to set initial Realtime auth token:",f)),this.rest=new j3(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new h$(this.storageUrl.href,this.headers,this.fetch,s==null?void 0:s.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new _3(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:s}=await this.auth.getSession();return(t=(e=s.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:i,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:h},f,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new M6({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),f),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,userStorage:i,flowType:l,lock:c,debug:d,throwOnError:h,fetch:p,hasCustomAuthorizationHeader:Object.keys(this.headers).some(b=>b.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new V3(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e==null?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,s)=>{this._handleTokenChanged(t,"CLIENT",s==null?void 0:s.access_token)})}_handleTokenChanged(e,t,s){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==s?(this.changedAccessToken=s,this.realtime.setAuth(s)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const A6=(n,e,t)=>new D6(n,e,t);function I6(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}I6()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const O6="https://fmyafuhxlorbafbacywa.supabase.co",R6="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZteWFmdWh4bG9yYmFmYmFjeXdhIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjIyMjg1NDYsImV4cCI6MjA3NzgwNDU0Nn0.RqsniEqzNec6ww35TXJtLJD3mafnGbMI82om4XRUdUU",L6=O6,F6=R6,fe=A6(L6,F6,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),$6=async n=>{try{let{data:e,error:t}=await fe.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const s={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:r,error:i}=await fe.from("users").insert(s).select("*, role_id").single();if(i)return console.error("Error creating user profile on-the-fly:",i.message,i),null;e=r,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},z6=async(n,e)=>await fe.auth.signInWithPassword({email:n,password:e}),U6=async n=>{const{email:e,password:t,options:s}=n;return await fe.auth.signUp({email:e,password:t,options:{...s,emailRedirectTo:`${window.location.origin}/`}})},V6=async(n,e)=>await fe.from("users").update({role_id:e}).eq("id",n),B6=async()=>await fe.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),q6=async()=>{const{error:n}=await fe.auth.signOut();n&&console.error("Error signing out:",n.message)},H6=async n=>{const e=window.location.origin;return await fe.auth.resetPasswordForEmail(n,{redirectTo:e})},W6=async n=>await fe.auth.updateUser({password:n}),mi={getAppUserProfile:$6,signInWithPassword:z6,signUpWithPassword:U6,signInWithGoogle:B6,signOut:q6,resetPasswordForEmail:H6,updateUserPassword:W6,approveUser:V6},G6="modulepreload",Y6=function(n){return"/"+n},Dj={},Aj=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));r=Promise.allSettled(t.map(c=>{if(c=Y6(c),c in Dj)return;Dj[c]=!0;const d=c.endsWith(".css"),h=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${h}`))return;const f=document.createElement("link");if(f.rel=d?"stylesheet":G6,d||(f.as="script"),f.crossOrigin="",f.href=c,l&&f.setAttribute("nonce",l),document.head.appendChild(f),d)return new Promise((p,g)=>{f.addEventListener("load",p),f.addEventListener("error",()=>g(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return r.then(o=>{for(const l of o||[])l.status==="rejected"&&i(l.reason);return e().catch(i)})};function ce(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function lt(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function is(n,e){const t=ce(n);return isNaN(e)?lt(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function mo(n,e){const t=ce(n);if(isNaN(e))return lt(n,NaN);if(!e)return t;const s=t.getDate(),r=lt(n,t.getTime());r.setMonth(t.getMonth()+e+1,0);const i=r.getDate();return s>=i?r:(t.setFullYear(r.getFullYear(),r.getMonth(),s),t)}function lc(n,e){const{years:t=0,months:s=0,weeks:r=0,days:i=0,hours:o=0,minutes:l=0,seconds:c=0}=e,d=ce(n),h=s||t?mo(d,s+t*12):d,f=i||r?is(h,i+r*7):h,p=l+o*60,b=(c+p*60)*1e3;return lt(n,f.getTime()+b)}function o2(n){return ce(n).getDay()===6}function l2(n){return ce(n).getDay()===0}function Ic(n){const e=ce(n).getDay();return e===0||e===6}function c2(n,e){const t=ce(n),s=Ic(t);if(isNaN(e))return lt(n,NaN);const r=t.getHours(),i=e<0?-1:1,o=Math.trunc(e/5);t.setDate(t.getDate()+o*7);let l=Math.abs(e%5);for(;l>0;)t.setDate(t.getDate()+i),Ic(t)||(l-=1);return s&&Ic(t)&&e!==0&&(o2(t)&&t.setDate(t.getDate()+(i<0?2:-1)),l2(t)&&t.setDate(t.getDate()+(i<0?1:-2))),t.setHours(r),t}function jh(n,e){const t=+ce(n);return lt(n,t+e)}const d2=7,gp=365.2425,Ch=6048e5,u2=864e5,aa=6e4,Tl=36e5,Sw=1e3,Ij=525600,Sc=43200,yp=1440,h2=60,f2=3,m2=12,p2=4,bg=3600,Nw=60,jw=bg*24,Z6=jw*7,g2=jw*gp,y2=g2/12,K6=y2*3;function Cw(n,e){return jh(n,e*Tl)}let x2={};function js(){return x2}function J6(n){x2=n}function Zn(n,e){var l,c,d,h;const t=js(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,r=ce(n),i=r.getDay(),o=(i<s?7:0)+i-s;return r.setDate(r.getDate()-o),r.setHours(0,0,0,0),r}function Zr(n){return Zn(n,{weekStartsOn:1})}function eo(n){const e=ce(n),t=e.getFullYear(),s=lt(n,0);s.setFullYear(t+1,0,4),s.setHours(0,0,0,0);const r=Zr(s),i=lt(n,0);i.setFullYear(t,0,4),i.setHours(0,0,0,0);const o=Zr(i);return e.getTime()>=r.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function to(n){const e=ce(n);return e.setHours(0,0,0,0),e}function Vs(n){const e=ce(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function rr(n,e){const t=to(n),s=to(e),r=+t-Vs(t),i=+s-Vs(s);return Math.round((r-i)/u2)}function no(n){const e=eo(n),t=lt(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),Zr(t)}function v2(n,e){let t=ce(n);const s=rr(t,no(t)),r=lt(n,0);return r.setFullYear(e,0,4),r.setHours(0,0,0,0),t=no(r),t.setDate(t.getDate()+s),t}function b2(n,e){return v2(n,eo(n)+e)}function kw(n,e){return jh(n,e*aa)}function Tw(n,e){const t=e*3;return mo(n,t)}function w2(n,e){return jh(n,e*1e3)}function wg(n,e){const t=e*7;return is(n,t)}function _2(n,e){return mo(n,e*12)}function Q6(n,e,t){const[s,r]=[+ce(n.start),+ce(n.end)].sort((l,c)=>l-c),[i,o]=[+ce(e.start),+ce(e.end)].sort((l,c)=>l-c);return t!=null&&t.inclusive?s<=o&&i<=r:s<o&&i<r}function S2(n){let e;return n.forEach(function(t){const s=ce(t);(e===void 0||e<s||isNaN(Number(s)))&&(e=s)}),e||new Date(NaN)}function N2(n){let e;return n.forEach(t=>{const s=ce(t);(!e||e>s||isNaN(+s))&&(e=s)}),e||new Date(NaN)}function X6(n,e){return N2([S2([n,e.start]),e.end])}function ez(n,e){const t=ce(n);if(isNaN(Number(t)))return NaN;const s=t.getTime();let r,i;return e.forEach(function(o,l){const c=ce(o);if(isNaN(Number(c))){r=NaN,i=NaN;return}const d=Math.abs(s-c.getTime());(r==null||d<i)&&(r=l,i=d)}),r}function tz(n,e){const t=ce(n);if(isNaN(Number(t)))return lt(n,NaN);const s=t.getTime();let r,i;return e.forEach(o=>{const l=ce(o);if(isNaN(Number(l))){r=lt(n,NaN),i=NaN;return}const c=Math.abs(s-l.getTime());(r==null||c<i)&&(r=l,i=c)}),r}function Ni(n,e){const t=ce(n),s=ce(e),r=t.getTime()-s.getTime();return r<0?-1:r>0?1:r}function nz(n,e){const t=ce(n),s=ce(e),r=t.getTime()-s.getTime();return r>0?-1:r<0?1:r}function Hs(n){return lt(n,Date.now())}function sz(n){const e=n/d2,t=Math.trunc(e);return t===0?0:t}function Hr(n,e){const t=to(n),s=to(e);return+t==+s}function j2(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function oa(n){if(!j2(n)&&typeof n!="number")return!1;const e=ce(n);return!isNaN(Number(e))}function rz(n,e){const t=ce(n);let s=ce(e);if(!oa(t)||!oa(s))return NaN;const r=rr(t,s),i=r<0?-1:1,o=Math.trunc(r/7);let l=o*5;for(s=is(s,o*7);!Hr(t,s);)l+=Ic(s)?0:i,s=is(s,i);return l===0?0:l}function C2(n,e){return eo(n)-eo(e)}function iz(n,e){const t=Zr(n),s=Zr(e),r=+t-Vs(t),i=+s-Vs(s);return Math.round((r-i)/Ch)}function xp(n,e){const t=ce(n),s=ce(e),r=t.getFullYear()-s.getFullYear(),i=t.getMonth()-s.getMonth();return r*12+i}function lb(n){const e=ce(n);return Math.trunc(e.getMonth()/3)+1}function _m(n,e){const t=ce(n),s=ce(e),r=t.getFullYear()-s.getFullYear(),i=lb(t)-lb(s);return r*4+i}function vp(n,e,t){const s=Zn(n,t),r=Zn(e,t),i=+s-Vs(s),o=+r-Vs(r);return Math.round((i-o)/Ch)}function Tu(n,e){const t=ce(n),s=ce(e);return t.getFullYear()-s.getFullYear()}function Ew(n,e){const t=ce(n),s=ce(e),r=Oj(t,s),i=Math.abs(rr(t,s));t.setDate(t.getDate()-r*i);const o=+(Oj(t,s)===-r),l=r*(i-o);return l===0?0:l}function Oj(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function po(n){return e=>{const s=(n?Math[n]:Math.trunc)(e);return s===0?0:s}}function _g(n,e){return+ce(n)-+ce(e)}function bp(n,e,t){const s=_g(n,e)/Tl;return po(t==null?void 0:t.roundingMethod)(s)}function k2(n,e){return b2(n,-e)}function az(n,e){let t=ce(n);const s=ce(e),r=Ni(t,s),i=Math.abs(C2(t,s));t=k2(t,r*i);const o=+(Ni(t,s)===-r),l=r*(i-o);return l===0?0:l}function so(n,e,t){const s=_g(n,e)/aa;return po(t==null?void 0:t.roundingMethod)(s)}function Pw(n){const e=ce(n);return e.setHours(23,59,59,999),e}function jr(n){const e=ce(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function T2(n){const e=ce(n);return+Pw(e)==+jr(e)}function Sg(n,e){const t=ce(n),s=ce(e),r=Ni(t,s),i=Math.abs(xp(t,s));let o;if(i<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-r*i);let l=Ni(t,s)===-r;T2(ce(n))&&i===1&&Ni(n,s)===1&&(l=!1),o=r*(i-Number(l))}return o===0?0:o}function oz(n,e,t){const s=Sg(n,e)/3;return po(t==null?void 0:t.roundingMethod)(s)}function Oc(n,e,t){const s=_g(n,e)/1e3;return po(t==null?void 0:t.roundingMethod)(s)}function lz(n,e,t){const s=Ew(n,e)/7;return po(t==null?void 0:t.roundingMethod)(s)}function E2(n,e){const t=ce(n),s=ce(e),r=Ni(t,s),i=Math.abs(Tu(t,s));t.setFullYear(1584),s.setFullYear(1584);const o=Ni(t,s)===-r,l=r*(i-+o);return l===0?0:l}function Ur(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=r?+t:+s,o=r?s:t;o.setHours(0,0,0,0);let l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return r?c.reverse():c}function cz(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=r?+t:+s;let o=r?s:t;o.setMinutes(0,0,0);let l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o=Cw(o,l);return r?c.reverse():c}function wp(n){const e=ce(n);return e.setSeconds(0,0),e}function dz(n,e){const t=wp(ce(n.start)),s=ce(n.end);let r=+t>+s;const i=r?+t:+s;let o=r?s:t,l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o=kw(o,l);return r?c.reverse():c}function uz(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=r?+t:+s,o=r?s:t;o.setHours(0,0,0,0),o.setDate(1);let l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o.setMonth(o.getMonth()+l);return r?c.reverse():c}function nl(n){const e=ce(n),t=e.getMonth(),s=t-t%3;return e.setMonth(s,1),e.setHours(0,0,0,0),e}function hz(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=r?+nl(t):+nl(s);let o=nl(r?s:t),l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o=Tw(o,l);return r?c.reverse():c}function fz(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=Zn(r?s:t,e),o=Zn(r?t:s,e);i.setHours(15),o.setHours(15);const l=+o.getTime();let c=i,d=(e==null?void 0:e.step)??1;if(!d)return[];d<0&&(d=-d,r=!r);const h=[];for(;+c<=l;)c.setHours(0),h.push(ce(c)),c=wg(c,d),c.setHours(15);return r?h.reverse():h}function Mw(n){const e=Ur(n),t=[];let s=0;for(;s<e.length;){const r=e[s++];Ic(r)&&t.push(r)}return t}function as(n){const e=ce(n);return e.setDate(1),e.setHours(0,0,0,0),e}function mz(n){const e=as(n),t=jr(n);return Mw({start:e,end:t})}function Dw(n){const e=ce(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function Ng(n){const e=ce(n),t=lt(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function pz(n){const e=Ng(n),t=Dw(n);return Mw({start:e,end:t})}function gz(n,e){const t=ce(n.start),s=ce(n.end);let r=+t>+s;const i=r?+t:+s,o=r?s:t;o.setHours(0,0,0,0),o.setMonth(0,1);let l=(e==null?void 0:e.step)??1;if(!l)return[];l<0&&(l=-l,r=!r);const c=[];for(;+o<=i;)c.push(ce(o)),o.setFullYear(o.getFullYear()+l);return r?c.reverse():c}function yz(n){const e=ce(n),t=e.getFullYear(),s=9+Math.floor(t/10)*10;return e.setFullYear(s,11,31),e.setHours(23,59,59,999),e}function xz(n){const e=ce(n);return e.setMinutes(59,59,999),e}function P2(n,e){var l,c,d,h;const t=js(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,r=ce(n),i=r.getDay(),o=(i<s?-7:0)+6-(i-s);return r.setDate(r.getDate()+o),r.setHours(23,59,59,999),r}function vz(n){return P2(n,{weekStartsOn:1})}function bz(n){const e=eo(n),t=lt(n,0);t.setFullYear(e+1,0,4),t.setHours(0,0,0,0);const s=Zr(t);return s.setMilliseconds(s.getMilliseconds()-1),s}function wz(n){const e=ce(n);return e.setSeconds(59,999),e}function _z(n){const e=ce(n),t=e.getMonth(),s=t-t%3+3;return e.setMonth(s,0),e.setHours(23,59,59,999),e}function Sz(n){const e=ce(n);return e.setMilliseconds(999),e}function cb(){return Pw(Date.now())}function Nz(){const n=new Date,e=n.getFullYear(),t=n.getMonth(),s=n.getDate(),r=new Date(0);return r.setFullYear(e,t,s+1),r.setHours(23,59,59,999),r}function jz(){const n=new Date,e=n.getFullYear(),t=n.getMonth(),s=n.getDate(),r=new Date(0);return r.setFullYear(e,t,s-1),r.setHours(23,59,59,999),r}const Cz={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},kz=(n,e,t)=>{let s;const r=Cz[n];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};function ux(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const Tz={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},Ez={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},Pz={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},Mz={date:ux({formats:Tz,defaultWidth:"full"}),time:ux({formats:Ez,defaultWidth:"full"}),dateTime:ux({formats:Pz,defaultWidth:"full"})},Dz={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},Az=(n,e,t,s)=>Dz[n];function Ud(n){return(e,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let r;if(s==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t!=null&&t.width?String(t.width):o;r=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[l]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return r[i]}}const Iz={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},Oz={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},Rz={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},Lz={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Fz={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},$z={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},zz=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},Uz={ordinalNumber:zz,era:Ud({values:Iz,defaultWidth:"wide"}),quarter:Ud({values:Oz,defaultWidth:"wide",argumentCallback:n=>n-1}),month:Ud({values:Rz,defaultWidth:"wide"}),day:Ud({values:Lz,defaultWidth:"wide"}),dayPeriod:Ud({values:Fz,defaultWidth:"wide",formattingValues:$z,defaultFormattingWidth:"wide"})};function Vd(n){return(e,t={})=>{const s=t.width,r=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],l=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?Bz(l,f=>f.test(o)):Vz(l,f=>f.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function Vz(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function Bz(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function qz(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const r=s[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(r.length);return{value:o,rest:l}}}const Hz=/^(\d+)(th|st|nd|rd)?/i,Wz=/\d+/i,Gz={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},Yz={any:[/^b/i,/^(a|c)/i]},Zz={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},Kz={any:[/1/i,/2/i,/3/i,/4/i]},Jz={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},Qz={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},Xz={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},e5={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},t5={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},n5={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},s5={ordinalNumber:qz({matchPattern:Hz,parsePattern:Wz,valueCallback:n=>parseInt(n,10)}),era:Vd({matchPatterns:Gz,defaultMatchWidth:"wide",parsePatterns:Yz,defaultParseWidth:"any"}),quarter:Vd({matchPatterns:Zz,defaultMatchWidth:"wide",parsePatterns:Kz,defaultParseWidth:"any",valueCallback:n=>n+1}),month:Vd({matchPatterns:Jz,defaultMatchWidth:"wide",parsePatterns:Qz,defaultParseWidth:"any"}),day:Vd({matchPatterns:Xz,defaultMatchWidth:"wide",parsePatterns:e5,defaultParseWidth:"any"}),dayPeriod:Vd({matchPatterns:t5,defaultMatchWidth:"any",parsePatterns:n5,defaultParseWidth:"any"})},md={code:"en-US",formatDistance:kz,formatLong:Mz,formatRelative:Az,localize:Uz,match:s5,options:{weekStartsOn:0,firstWeekContainsDate:1}};function M2(n){const e=ce(n);return rr(e,Ng(e))+1}function Aw(n){const e=ce(n),t=+Zr(e)-+no(e);return Math.round(t/Ch)+1}function jg(n,e){var h,f,p,g;const t=ce(n),s=t.getFullYear(),r=js(),i=(e==null?void 0:e.firstWeekContainsDate)??((f=(h=e==null?void 0:e.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??r.firstWeekContainsDate??((g=(p=r.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,o=lt(n,0);o.setFullYear(s+1,0,i),o.setHours(0,0,0,0);const l=Zn(o,e),c=lt(n,0);c.setFullYear(s,0,i),c.setHours(0,0,0,0);const d=Zn(c,e);return t.getTime()>=l.getTime()?s+1:t.getTime()>=d.getTime()?s:s-1}function _p(n,e){var l,c,d,h;const t=js(),s=(e==null?void 0:e.firstWeekContainsDate)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.firstWeekContainsDate)??t.firstWeekContainsDate??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.firstWeekContainsDate)??1,r=jg(n,e),i=lt(n,0);return i.setFullYear(r,0,s),i.setHours(0,0,0,0),Zn(i,e)}function Iw(n,e){const t=ce(n),s=+Zn(t,e)-+_p(t,e);return Math.round(s/Ch)+1}function Ye(n,e){const t=n<0?"-":"",s=Math.abs(n).toString().padStart(e,"0");return t+s}const hi={y(n,e){const t=n.getFullYear(),s=t>0?t:1-t;return Ye(e==="yy"?s%100:s,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):Ye(t+1,2)},d(n,e){return Ye(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return Ye(n.getHours()%12||12,e.length)},H(n,e){return Ye(n.getHours(),e.length)},m(n,e){return Ye(n.getMinutes(),e.length)},s(n,e){return Ye(n.getSeconds(),e.length)},S(n,e){const t=e.length,s=n.getMilliseconds(),r=Math.trunc(s*Math.pow(10,t-3));return Ye(r,e.length)}},Ql={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},db={G:function(n,e,t){const s=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(s,{width:"abbreviated"});case"GGGGG":return t.era(s,{width:"narrow"});case"GGGG":default:return t.era(s,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const s=n.getFullYear(),r=s>0?s:1-s;return t.ordinalNumber(r,{unit:"year"})}return hi.y(n,e)},Y:function(n,e,t,s){const r=jg(n,s),i=r>0?r:1-r;if(e==="YY"){const o=i%100;return Ye(o,2)}return e==="Yo"?t.ordinalNumber(i,{unit:"year"}):Ye(i,e.length)},R:function(n,e){const t=eo(n);return Ye(t,e.length)},u:function(n,e){const t=n.getFullYear();return Ye(t,e.length)},Q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(s);case"QQ":return Ye(s,2);case"Qo":return t.ordinalNumber(s,{unit:"quarter"});case"QQQ":return t.quarter(s,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(s,{width:"wide",context:"formatting"})}},q:function(n,e,t){const s=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(s);case"qq":return Ye(s,2);case"qo":return t.ordinalNumber(s,{unit:"quarter"});case"qqq":return t.quarter(s,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(s,{width:"wide",context:"standalone"})}},M:function(n,e,t){const s=n.getMonth();switch(e){case"M":case"MM":return hi.M(n,e);case"Mo":return t.ordinalNumber(s+1,{unit:"month"});case"MMM":return t.month(s,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(s,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(s,{width:"wide",context:"formatting"})}},L:function(n,e,t){const s=n.getMonth();switch(e){case"L":return String(s+1);case"LL":return Ye(s+1,2);case"Lo":return t.ordinalNumber(s+1,{unit:"month"});case"LLL":return t.month(s,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(s,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(s,{width:"wide",context:"standalone"})}},w:function(n,e,t,s){const r=Iw(n,s);return e==="wo"?t.ordinalNumber(r,{unit:"week"}):Ye(r,e.length)},I:function(n,e,t){const s=Aw(n);return e==="Io"?t.ordinalNumber(s,{unit:"week"}):Ye(s,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):hi.d(n,e)},D:function(n,e,t){const s=M2(n);return e==="Do"?t.ordinalNumber(s,{unit:"dayOfYear"}):Ye(s,e.length)},E:function(n,e,t){const s=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(s,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(s,{width:"short",context:"formatting"});case"EEEE":default:return t.day(s,{width:"wide",context:"formatting"})}},e:function(n,e,t,s){const r=n.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"e":return String(i);case"ee":return Ye(i,2);case"eo":return t.ordinalNumber(i,{unit:"day"});case"eee":return t.day(r,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(r,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(r,{width:"short",context:"formatting"});case"eeee":default:return t.day(r,{width:"wide",context:"formatting"})}},c:function(n,e,t,s){const r=n.getDay(),i=(r-s.weekStartsOn+8)%7||7;switch(e){case"c":return String(i);case"cc":return Ye(i,e.length);case"co":return t.ordinalNumber(i,{unit:"day"});case"ccc":return t.day(r,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(r,{width:"narrow",context:"standalone"});case"cccccc":return t.day(r,{width:"short",context:"standalone"});case"cccc":default:return t.day(r,{width:"wide",context:"standalone"})}},i:function(n,e,t){const s=n.getDay(),r=s===0?7:s;switch(e){case"i":return String(r);case"ii":return Ye(r,e.length);case"io":return t.ordinalNumber(r,{unit:"day"});case"iii":return t.day(s,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(s,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(s,{width:"short",context:"formatting"});case"iiii":default:return t.day(s,{width:"wide",context:"formatting"})}},a:function(n,e,t){const r=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},b:function(n,e,t){const s=n.getHours();let r;switch(s===12?r=Ql.noon:s===0?r=Ql.midnight:r=s/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},B:function(n,e,t){const s=n.getHours();let r;switch(s>=17?r=Ql.evening:s>=12?r=Ql.afternoon:s>=4?r=Ql.morning:r=Ql.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(r,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(r,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(r,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let s=n.getHours()%12;return s===0&&(s=12),t.ordinalNumber(s,{unit:"hour"})}return hi.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):hi.H(n,e)},K:function(n,e,t){const s=n.getHours()%12;return e==="Ko"?t.ordinalNumber(s,{unit:"hour"}):Ye(s,e.length)},k:function(n,e,t){let s=n.getHours();return s===0&&(s=24),e==="ko"?t.ordinalNumber(s,{unit:"hour"}):Ye(s,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):hi.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):hi.s(n,e)},S:function(n,e){return hi.S(n,e)},X:function(n,e,t){const s=n.getTimezoneOffset();if(s===0)return"Z";switch(e){case"X":return Lj(s);case"XXXX":case"XX":return Ho(s);case"XXXXX":case"XXX":default:return Ho(s,":")}},x:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"x":return Lj(s);case"xxxx":case"xx":return Ho(s);case"xxxxx":case"xxx":default:return Ho(s,":")}},O:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+Rj(s,":");case"OOOO":default:return"GMT"+Ho(s,":")}},z:function(n,e,t){const s=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+Rj(s,":");case"zzzz":default:return"GMT"+Ho(s,":")}},t:function(n,e,t){const s=Math.trunc(n.getTime()/1e3);return Ye(s,e.length)},T:function(n,e,t){const s=n.getTime();return Ye(s,e.length)}};function Rj(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),r=Math.trunc(s/60),i=s%60;return i===0?t+String(r):t+String(r)+e+Ye(i,2)}function Lj(n,e){return n%60===0?(n>0?"-":"+")+Ye(Math.abs(n)/60,2):Ho(n,e)}function Ho(n,e=""){const t=n>0?"-":"+",s=Math.abs(n),r=Ye(Math.trunc(s/60),2),i=Ye(s%60,2);return t+r+e+i}const Fj=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},D2=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},r5=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],s=t[1],r=t[2];if(!r)return Fj(n,e);let i;switch(s){case"P":i=e.dateTime({width:"short"});break;case"PP":i=e.dateTime({width:"medium"});break;case"PPP":i=e.dateTime({width:"long"});break;case"PPPP":default:i=e.dateTime({width:"full"});break}return i.replace("{{date}}",Fj(s,e)).replace("{{time}}",D2(r,e))},Sp={p:D2,P:r5},i5=/^D+$/,a5=/^Y+$/,o5=["D","DD","YY","YYYY"];function A2(n){return i5.test(n)}function I2(n){return a5.test(n)}function ub(n,e,t){const s=l5(n,e,t);if(console.warn(s),o5.includes(n))throw new RangeError(s)}function l5(n,e,t){const s=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${s} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const c5=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d5=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,u5=/^'([^]*?)'?$/,h5=/''/g,f5=/[a-zA-Z]/;function Ce(n,e,t){var h,f,p,g,b,v,_,N;const s=js(),r=(t==null?void 0:t.locale)??s.locale??md,i=(t==null?void 0:t.firstWeekContainsDate)??((f=(h=t==null?void 0:t.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??s.firstWeekContainsDate??((g=(p=s.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??1,o=(t==null?void 0:t.weekStartsOn)??((v=(b=t==null?void 0:t.locale)==null?void 0:b.options)==null?void 0:v.weekStartsOn)??s.weekStartsOn??((N=(_=s.locale)==null?void 0:_.options)==null?void 0:N.weekStartsOn)??0,l=ce(n);if(!oa(l))throw new RangeError("Invalid time value");let c=e.match(d5).map(j=>{const k=j[0];if(k==="p"||k==="P"){const S=Sp[k];return S(j,r.formatLong)}return j}).join("").match(c5).map(j=>{if(j==="''")return{isToken:!1,value:"'"};const k=j[0];if(k==="'")return{isToken:!1,value:m5(j)};if(db[k])return{isToken:!0,value:j};if(k.match(f5))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:j}});r.localize.preprocessor&&(c=r.localize.preprocessor(l,c));const d={firstWeekContainsDate:i,weekStartsOn:o,locale:r};return c.map(j=>{if(!j.isToken)return j.value;const k=j.value;(!(t!=null&&t.useAdditionalWeekYearTokens)&&I2(k)||!(t!=null&&t.useAdditionalDayOfYearTokens)&&A2(k))&&ub(k,e,String(n));const S=db[k[0]];return S(l,k,r.localize,d)}).join("")}function m5(n){const e=n.match(u5);return e?e[1].replace(h5,"'"):n}function O2(n,e,t){const s=js(),r=(t==null?void 0:t.locale)??s.locale??md,i=2520,o=Ni(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:o});let c,d;o>0?(c=ce(e),d=ce(n)):(c=ce(n),d=ce(e));const h=Oc(d,c),f=(Vs(d)-Vs(c))/1e3,p=Math.round((h-f)/60);let g;if(p<2)return t!=null&&t.includeSeconds?h<5?r.formatDistance("lessThanXSeconds",5,l):h<10?r.formatDistance("lessThanXSeconds",10,l):h<20?r.formatDistance("lessThanXSeconds",20,l):h<40?r.formatDistance("halfAMinute",0,l):h<60?r.formatDistance("lessThanXMinutes",1,l):r.formatDistance("xMinutes",1,l):p===0?r.formatDistance("lessThanXMinutes",1,l):r.formatDistance("xMinutes",p,l);if(p<45)return r.formatDistance("xMinutes",p,l);if(p<90)return r.formatDistance("aboutXHours",1,l);if(p<yp){const b=Math.round(p/60);return r.formatDistance("aboutXHours",b,l)}else{if(p<i)return r.formatDistance("xDays",1,l);if(p<Sc){const b=Math.round(p/yp);return r.formatDistance("xDays",b,l)}else if(p<Sc*2)return g=Math.round(p/Sc),r.formatDistance("aboutXMonths",g,l)}if(g=Sg(d,c),g<12){const b=Math.round(p/Sc);return r.formatDistance("xMonths",b,l)}else{const b=g%12,v=Math.trunc(g/12);return b<3?r.formatDistance("aboutXYears",v,l):b<9?r.formatDistance("overXYears",v,l):r.formatDistance("almostXYears",v+1,l)}}function R2(n,e,t){const s=js(),r=(t==null?void 0:t.locale)??s.locale??md,i=Ni(n,e);if(isNaN(i))throw new RangeError("Invalid time value");const o=Object.assign({},t,{addSuffix:t==null?void 0:t.addSuffix,comparison:i});let l,c;i>0?(l=ce(e),c=ce(n)):(l=ce(n),c=ce(e));const d=po((t==null?void 0:t.roundingMethod)??"round"),h=c.getTime()-l.getTime(),f=h/aa,p=Vs(c)-Vs(l),g=(h-p)/aa,b=t==null?void 0:t.unit;let v;if(b?v=b:f<1?v="second":f<60?v="minute":f<yp?v="hour":g<Sc?v="day":g<Ij?v="month":v="year",v==="second"){const _=d(h/1e3);return r.formatDistance("xSeconds",_,o)}else if(v==="minute"){const _=d(f);return r.formatDistance("xMinutes",_,o)}else if(v==="hour"){const _=d(f/60);return r.formatDistance("xHours",_,o)}else if(v==="day"){const _=d(g/yp);return r.formatDistance("xDays",_,o)}else if(v==="month"){const _=d(g/Sc);return _===12&&b!=="month"?r.formatDistance("xYears",1,o):r.formatDistance("xMonths",_,o)}else{const _=d(g/Ij);return r.formatDistance("xYears",_,o)}}function Zc(n,e){return O2(n,Hs(n),e)}function p5(n,e){return R2(n,Hs(n),e)}const g5=["years","months","weeks","days","hours","minutes","seconds"];function y5(n,e){const t=js(),s=(e==null?void 0:e.locale)??t.locale??md,r=(e==null?void 0:e.format)??g5,i=(e==null?void 0:e.zero)??!1,o=(e==null?void 0:e.delimiter)??" ";return s.formatDistance?r.reduce((c,d)=>{const h=`x${d.replace(/(^.)/,p=>p.toUpperCase())}`,f=n[d];return f!==void 0&&(i||n[d])?c.concat(s.formatDistance(h,f)):c},[]).join(o):""}function x5(n,e){const t=ce(n);if(isNaN(t.getTime()))throw new RangeError("Invalid time value");const s=(e==null?void 0:e.format)??"extended",r=(e==null?void 0:e.representation)??"complete";let i="",o="";const l=s==="extended"?"-":"",c=s==="extended"?":":"";if(r!=="time"){const d=Ye(t.getDate(),2),h=Ye(t.getMonth()+1,2);i=`${Ye(t.getFullYear(),4)}${l}${h}${l}${d}`}if(r!=="date"){const d=t.getTimezoneOffset();if(d!==0){const v=Math.abs(d),_=Ye(Math.trunc(v/60),2),N=Ye(v%60,2);o=`${d<0?"+":"-"}${_}:${N}`}else o="Z";const h=Ye(t.getHours(),2),f=Ye(t.getMinutes(),2),p=Ye(t.getSeconds(),2),g=i===""?"":"T",b=[h,f,p].join(c);i=`${i}${g}${b}${o}`}return i}function v5(n,e){const t=ce(n);if(!oa(t))throw new RangeError("Invalid time value");const s=(e==null?void 0:e.format)??"extended",r=(e==null?void 0:e.representation)??"complete";let i="";const o=s==="extended"?"-":"",l=s==="extended"?":":"";if(r!=="time"){const c=Ye(t.getDate(),2),d=Ye(t.getMonth()+1,2);i=`${Ye(t.getFullYear(),4)}${o}${d}${o}${c}`}if(r!=="date"){const c=Ye(t.getHours(),2),d=Ye(t.getMinutes(),2),h=Ye(t.getSeconds(),2);i=`${i}${i===""?"":" "}${c}${l}${d}${l}${h}`}return i}function b5(n){const{years:e=0,months:t=0,days:s=0,hours:r=0,minutes:i=0,seconds:o=0}=n;return`P${e}Y${t}M${s}DT${r}H${i}M${o}S`}function w5(n,e){const t=ce(n);if(!oa(t))throw new RangeError("Invalid time value");const s=(e==null?void 0:e.fractionDigits)??0,r=Ye(t.getDate(),2),i=Ye(t.getMonth()+1,2),o=t.getFullYear(),l=Ye(t.getHours(),2),c=Ye(t.getMinutes(),2),d=Ye(t.getSeconds(),2);let h="";if(s>0){const g=t.getMilliseconds(),b=Math.trunc(g*Math.pow(10,s-3));h="."+Ye(b,s)}let f="";const p=t.getTimezoneOffset();if(p!==0){const g=Math.abs(p),b=Ye(Math.trunc(g/60),2),v=Ye(g%60,2);f=`${p<0?"+":"-"}${b}:${v}`}else f="Z";return`${o}-${i}-${r}T${l}:${c}:${d}${h}${f}`}const _5=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],S5=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function N5(n){const e=ce(n);if(!oa(e))throw new RangeError("Invalid time value");const t=_5[e.getUTCDay()],s=Ye(e.getUTCDate(),2),r=S5[e.getUTCMonth()],i=e.getUTCFullYear(),o=Ye(e.getUTCHours(),2),l=Ye(e.getUTCMinutes(),2),c=Ye(e.getUTCSeconds(),2);return`${t}, ${s} ${r} ${i} ${o}:${l}:${c} GMT`}function j5(n,e,t){var f,p,g,b;const s=ce(n),r=ce(e),i=js(),o=(t==null?void 0:t.locale)??i.locale??md,l=(t==null?void 0:t.weekStartsOn)??((p=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??i.weekStartsOn??((b=(g=i.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??0,c=rr(s,r);if(isNaN(c))throw new RangeError("Invalid time value");let d;c<-6?d="other":c<-1?d="lastWeek":c<0?d="yesterday":c<1?d="today":c<2?d="tomorrow":c<7?d="nextWeek":d="other";const h=o.formatRelative(d,s,r,{locale:o,weekStartsOn:l});return Ce(s,h,{locale:o,weekStartsOn:l})}function C5(n){return ce(n*1e3)}function L2(n){return ce(n).getDate()}function El(n){return ce(n).getDay()}function F2(n){const e=ce(n),t=e.getFullYear(),s=e.getMonth(),r=lt(n,0);return r.setFullYear(t,s+1,0),r.setHours(0,0,0,0),r.getDate()}function $2(n){const t=ce(n).getFullYear();return t%400===0||t%4===0&&t%100!==0}function k5(n){const e=ce(n);return String(new Date(e))==="Invalid Date"?NaN:$2(e)?366:365}function T5(n){const t=ce(n).getFullYear();return Math.floor(t/10)*10}function z2(){return Object.assign({},js())}function E5(n){return ce(n).getHours()}function U2(n){let t=ce(n).getDay();return t===0&&(t=7),t}function P5(n){const e=no(n),s=+no(wg(e,60))-+e;return Math.round(s/Ch)}function M5(n){return ce(n).getMilliseconds()}function D5(n){return ce(n).getMinutes()}function A5(n){return ce(n).getMonth()}function I5(n,e){const[t,s]=[+ce(n.start),+ce(n.end)].sort((f,p)=>f-p),[r,i]=[+ce(e.start),+ce(e.end)].sort((f,p)=>f-p);if(!(t<i&&r<s))return 0;const l=r<t?t:r,c=l-Vs(l),d=i>s?s:i,h=d-Vs(d);return Math.ceil((h-c)/u2)}function O5(n){return ce(n).getSeconds()}function R5(n){return ce(n).getTime()}function L5(n){return Math.trunc(+ce(n)/1e3)}function F5(n,e){var c,d,h,f;const t=js(),s=(e==null?void 0:e.weekStartsOn)??((d=(c=e==null?void 0:e.locale)==null?void 0:c.options)==null?void 0:d.weekStartsOn)??t.weekStartsOn??((f=(h=t.locale)==null?void 0:h.options)==null?void 0:f.weekStartsOn)??0,r=L2(n);if(isNaN(r))return NaN;const i=El(as(n));let o=s-i;o<=0&&(o+=7);const l=r-o;return Math.ceil(l/7)+1}function V2(n){const e=ce(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(0,0,0,0),e}function $5(n,e){return vp(V2(n),as(n),e)+1}function z5(n){return ce(n).getFullYear()}function U5(n){return Math.trunc(n*Tl)}function V5(n){return Math.trunc(n*h2)}function B5(n){return Math.trunc(n*bg)}function q5(n,e,t){const s=ce(n);if(isNaN(+s))throw new TypeError("Start date is invalid");const r=ce(e);if(isNaN(+r))throw new TypeError("End date is invalid");if(t!=null&&t.assertPositive&&+s>+r)throw new TypeError("End date must be after start date");return{start:s,end:r}}function H5(n){const e=ce(n.start),t=ce(n.end),s={},r=E2(t,e);r&&(s.years=r);const i=lc(e,{years:s.years}),o=Sg(t,i);o&&(s.months=o);const l=lc(i,{months:s.months}),c=Ew(t,l);c&&(s.days=c);const d=lc(l,{days:s.days}),h=bp(t,d);h&&(s.hours=h);const f=lc(d,{hours:s.hours}),p=so(t,f);p&&(s.minutes=p);const g=lc(f,{minutes:s.minutes}),b=Oc(t,g);return b&&(s.seconds=b),s}function W5(n,e,t){let s;return G5(e)?s=e:t=e,new Intl.DateTimeFormat(t==null?void 0:t.locale,s).format(ce(n))}function G5(n){return n!==void 0&&!("locale"in n)}function Y5(n,e,t){let s=0,r;const i=ce(n),o=ce(e);if(t!=null&&t.unit)r=t==null?void 0:t.unit,r==="second"?s=Oc(i,o):r==="minute"?s=so(i,o):r==="hour"?s=bp(i,o):r==="day"?s=rr(i,o):r==="week"?s=vp(i,o):r==="month"?s=xp(i,o):r==="quarter"?s=_m(i,o):r==="year"&&(s=Tu(i,o));else{const c=Oc(i,o);Math.abs(c)<Nw?(s=Oc(i,o),r="second"):Math.abs(c)<bg?(s=so(i,o),r="minute"):Math.abs(c)<jw&&Math.abs(rr(i,o))<1?(s=bp(i,o),r="hour"):Math.abs(c)<Z6&&(s=rr(i,o))&&Math.abs(s)<7?r="day":Math.abs(c)<y2?(s=vp(i,o),r="week"):Math.abs(c)<K6?(s=xp(i,o),r="month"):Math.abs(c)<g2&&_m(i,o)<4?(s=_m(i,o),r="quarter"):(s=Tu(i,o),r="year")}return new Intl.RelativeTimeFormat(t==null?void 0:t.locale,{localeMatcher:t==null?void 0:t.localeMatcher,numeric:(t==null?void 0:t.numeric)||"auto",style:t==null?void 0:t.style}).format(s,r)}function B2(n,e){const t=ce(n),s=ce(e);return t.getTime()>s.getTime()}function Z5(n,e){const t=ce(n),s=ce(e);return+t<+s}function K5(n,e){const t=ce(n),s=ce(e);return+t==+s}function J5(n,e,t){const s=new Date(n,e,t);return s.getFullYear()===n&&s.getMonth()===e&&s.getDate()===t}function Q5(n){return ce(n).getDate()===1}function X5(n){return ce(n).getDay()===5}function eU(n){return+ce(n)>Date.now()}function q2(n,e){const t=e instanceof Date?lt(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const tU=10;class H2{constructor(){xe(this,"subPriority",0)}validate(e,t){return!0}}class nU extends H2{constructor(e,t,s,r,i){super(),this.value=e,this.validateValue=t,this.setValue=s,this.priority=r,i&&(this.subPriority=i)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,s){return this.setValue(e,t,this.value,s)}}class sU extends H2{constructor(){super(...arguments);xe(this,"priority",tU);xe(this,"subPriority",-1)}set(t,s){return s.timestampIsSet?t:lt(t,q2(t,Date))}}class Dt{run(e,t,s,r){const i=this.parse(e,t,s,r);return i?{setter:new nU(i.value,this.validate,this.set,this.priority,this.subPriority),rest:i.rest}:null}validate(e,t,s){return!0}}class rU extends Dt{constructor(){super(...arguments);xe(this,"priority",140);xe(this,"incompatibleTokens",["R","u","t","T"])}parse(t,s,r){switch(s){case"G":case"GG":case"GGG":return r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"});case"GGGGG":return r.era(t,{width:"narrow"});case"GGGG":default:return r.era(t,{width:"wide"})||r.era(t,{width:"abbreviated"})||r.era(t,{width:"narrow"})}}set(t,s,r){return s.era=r,t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}}const _n={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},xi={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function Sn(n,e){return n&&{value:e(n.value),rest:n.rest}}function un(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function vi(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const s=t[1]==="+"?1:-1,r=t[2]?parseInt(t[2],10):0,i=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:s*(r*Tl+i*aa+o*Sw),rest:e.slice(t[0].length)}}function W2(n){return un(_n.anyDigitsSigned,n)}function xn(n,e){switch(n){case 1:return un(_n.singleDigit,e);case 2:return un(_n.twoDigits,e);case 3:return un(_n.threeDigits,e);case 4:return un(_n.fourDigits,e);default:return un(new RegExp("^\\d{1,"+n+"}"),e)}}function Np(n,e){switch(n){case 1:return un(_n.singleDigitSigned,e);case 2:return un(_n.twoDigitsSigned,e);case 3:return un(_n.threeDigitsSigned,e);case 4:return un(_n.fourDigitsSigned,e);default:return un(new RegExp("^-?\\d{1,"+n+"}"),e)}}function Ow(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function G2(n,e){const t=e>0,s=t?e:1-e;let r;if(s<=50)r=n||100;else{const i=s+50,o=Math.trunc(i/100)*100,l=n>=i%100;r=n+o-(l?100:0)}return t?r:1-r}function Y2(n){return n%400===0||n%4===0&&n%100!==0}class iU extends Dt{constructor(){super(...arguments);xe(this,"priority",130);xe(this,"incompatibleTokens",["Y","R","u","w","I","i","e","c","t","T"])}parse(t,s,r){const i=o=>({year:o,isTwoDigitYear:s==="yy"});switch(s){case"y":return Sn(xn(4,t),i);case"yo":return Sn(r.ordinalNumber(t,{unit:"year"}),i);default:return Sn(xn(s.length,t),i)}}validate(t,s){return s.isTwoDigitYear||s.year>0}set(t,s,r){const i=t.getFullYear();if(r.isTwoDigitYear){const l=G2(r.year,i);return t.setFullYear(l,0,1),t.setHours(0,0,0,0),t}const o=!("era"in s)||s.era===1?r.year:1-r.year;return t.setFullYear(o,0,1),t.setHours(0,0,0,0),t}}class aU extends Dt{constructor(){super(...arguments);xe(this,"priority",130);xe(this,"incompatibleTokens",["y","R","u","Q","q","M","L","I","d","D","i","t","T"])}parse(t,s,r){const i=o=>({year:o,isTwoDigitYear:s==="YY"});switch(s){case"Y":return Sn(xn(4,t),i);case"Yo":return Sn(r.ordinalNumber(t,{unit:"year"}),i);default:return Sn(xn(s.length,t),i)}}validate(t,s){return s.isTwoDigitYear||s.year>0}set(t,s,r,i){const o=jg(t,i);if(r.isTwoDigitYear){const c=G2(r.year,o);return t.setFullYear(c,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),Zn(t,i)}const l=!("era"in s)||s.era===1?r.year:1-r.year;return t.setFullYear(l,0,i.firstWeekContainsDate),t.setHours(0,0,0,0),Zn(t,i)}}class oU extends Dt{constructor(){super(...arguments);xe(this,"priority",130);xe(this,"incompatibleTokens",["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"])}parse(t,s){return Np(s==="R"?4:s.length,t)}set(t,s,r){const i=lt(t,0);return i.setFullYear(r,0,4),i.setHours(0,0,0,0),Zr(i)}}class lU extends Dt{constructor(){super(...arguments);xe(this,"priority",130);xe(this,"incompatibleTokens",["G","y","Y","R","w","I","i","e","c","t","T"])}parse(t,s){return Np(s==="u"?4:s.length,t)}set(t,s,r){return t.setFullYear(r,0,1),t.setHours(0,0,0,0),t}}class cU extends Dt{constructor(){super(...arguments);xe(this,"priority",120);xe(this,"incompatibleTokens",["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"Q":case"QQ":return xn(s.length,t);case"Qo":return r.ordinalNumber(t,{unit:"quarter"});case"QQQ":return r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(t,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(t,{width:"wide",context:"formatting"})||r.quarter(t,{width:"abbreviated",context:"formatting"})||r.quarter(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=1&&s<=4}set(t,s,r){return t.setMonth((r-1)*3,1),t.setHours(0,0,0,0),t}}class dU extends Dt{constructor(){super(...arguments);xe(this,"priority",120);xe(this,"incompatibleTokens",["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"q":case"qq":return xn(s.length,t);case"qo":return r.ordinalNumber(t,{unit:"quarter"});case"qqq":return r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(t,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(t,{width:"wide",context:"standalone"})||r.quarter(t,{width:"abbreviated",context:"standalone"})||r.quarter(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=1&&s<=4}set(t,s,r){return t.setMonth((r-1)*3,1),t.setHours(0,0,0,0),t}}class uU extends Dt{constructor(){super(...arguments);xe(this,"incompatibleTokens",["Y","R","q","Q","L","w","I","D","i","e","c","t","T"]);xe(this,"priority",110)}parse(t,s,r){const i=o=>o-1;switch(s){case"M":return Sn(un(_n.month,t),i);case"MM":return Sn(xn(2,t),i);case"Mo":return Sn(r.ordinalNumber(t,{unit:"month"}),i);case"MMM":return r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(t,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(t,{width:"wide",context:"formatting"})||r.month(t,{width:"abbreviated",context:"formatting"})||r.month(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.setMonth(r,1),t.setHours(0,0,0,0),t}}class hU extends Dt{constructor(){super(...arguments);xe(this,"priority",110);xe(this,"incompatibleTokens",["Y","R","q","Q","M","w","I","D","i","e","c","t","T"])}parse(t,s,r){const i=o=>o-1;switch(s){case"L":return Sn(un(_n.month,t),i);case"LL":return Sn(xn(2,t),i);case"Lo":return Sn(r.ordinalNumber(t,{unit:"month"}),i);case"LLL":return r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(t,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(t,{width:"wide",context:"standalone"})||r.month(t,{width:"abbreviated",context:"standalone"})||r.month(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.setMonth(r,1),t.setHours(0,0,0,0),t}}function Z2(n,e,t){const s=ce(n),r=Iw(s,t)-e;return s.setDate(s.getDate()-r*7),s}class fU extends Dt{constructor(){super(...arguments);xe(this,"priority",100);xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","i","t","T"])}parse(t,s,r){switch(s){case"w":return un(_n.week,t);case"wo":return r.ordinalNumber(t,{unit:"week"});default:return xn(s.length,t)}}validate(t,s){return s>=1&&s<=53}set(t,s,r,i){return Zn(Z2(t,r,i),i)}}function K2(n,e){const t=ce(n),s=Aw(t)-e;return t.setDate(t.getDate()-s*7),t}class mU extends Dt{constructor(){super(...arguments);xe(this,"priority",100);xe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"])}parse(t,s,r){switch(s){case"I":return un(_n.week,t);case"Io":return r.ordinalNumber(t,{unit:"week"});default:return xn(s.length,t)}}validate(t,s){return s>=1&&s<=53}set(t,s,r){return Zr(K2(t,r))}}const pU=[31,28,31,30,31,30,31,31,30,31,30,31],gU=[31,29,31,30,31,30,31,31,30,31,30,31];class yU extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"subPriority",1);xe(this,"incompatibleTokens",["Y","R","q","Q","w","I","D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"d":return un(_n.date,t);case"do":return r.ordinalNumber(t,{unit:"date"});default:return xn(s.length,t)}}validate(t,s){const r=t.getFullYear(),i=Y2(r),o=t.getMonth();return i?s>=1&&s<=gU[o]:s>=1&&s<=pU[o]}set(t,s,r){return t.setDate(r),t.setHours(0,0,0,0),t}}class xU extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"subpriority",1);xe(this,"incompatibleTokens",["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"])}parse(t,s,r){switch(s){case"D":case"DD":return un(_n.dayOfYear,t);case"Do":return r.ordinalNumber(t,{unit:"date"});default:return xn(s.length,t)}}validate(t,s){const r=t.getFullYear();return Y2(r)?s>=1&&s<=366:s>=1&&s<=365}set(t,s,r){return t.setMonth(0,r),t.setHours(0,0,0,0),t}}function Cg(n,e,t){var f,p,g,b;const s=js(),r=(t==null?void 0:t.weekStartsOn)??((p=(f=t==null?void 0:t.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??s.weekStartsOn??((b=(g=s.locale)==null?void 0:g.options)==null?void 0:b.weekStartsOn)??0,i=ce(n),o=i.getDay(),c=(e%7+7)%7,d=7-r,h=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return is(i,h)}class vU extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"incompatibleTokens",["D","i","e","c","t","T"])}parse(t,s,r){switch(s){case"E":case"EE":case"EEE":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(t,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=Cg(t,r,i),t.setHours(0,0,0,0),t}}class bU extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"])}parse(t,s,r,i){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+i.weekStartsOn+6)%7+c};switch(s){case"e":case"ee":return Sn(xn(s.length,t),o);case"eo":return Sn(r.ordinalNumber(t,{unit:"day"}),o);case"eee":return r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"eeeee":return r.day(t,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=Cg(t,r,i),t.setHours(0,0,0,0),t}}class wU extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"incompatibleTokens",["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"])}parse(t,s,r,i){const o=l=>{const c=Math.floor((l-1)/7)*7;return(l+i.weekStartsOn+6)%7+c};switch(s){case"c":case"cc":return Sn(xn(s.length,t),o);case"co":return Sn(r.ordinalNumber(t,{unit:"day"}),o);case"ccc":return r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});case"ccccc":return r.day(t,{width:"narrow",context:"standalone"});case"cccccc":return r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(t,{width:"wide",context:"standalone"})||r.day(t,{width:"abbreviated",context:"standalone"})||r.day(t,{width:"short",context:"standalone"})||r.day(t,{width:"narrow",context:"standalone"})}}validate(t,s){return s>=0&&s<=6}set(t,s,r,i){return t=Cg(t,r,i),t.setHours(0,0,0,0),t}}function J2(n,e){const t=ce(n),s=U2(t),r=e-s;return is(t,r)}class _U extends Dt{constructor(){super(...arguments);xe(this,"priority",90);xe(this,"incompatibleTokens",["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"])}parse(t,s,r){const i=o=>o===0?7:o;switch(s){case"i":case"ii":return xn(s.length,t);case"io":return r.ordinalNumber(t,{unit:"day"});case"iii":return Sn(r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i);case"iiiii":return Sn(r.day(t,{width:"narrow",context:"formatting"}),i);case"iiiiii":return Sn(r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i);case"iiii":default:return Sn(r.day(t,{width:"wide",context:"formatting"})||r.day(t,{width:"abbreviated",context:"formatting"})||r.day(t,{width:"short",context:"formatting"})||r.day(t,{width:"narrow",context:"formatting"}),i)}}validate(t,s){return s>=1&&s<=7}set(t,s,r){return t=J2(t,r),t.setHours(0,0,0,0),t}}class SU extends Dt{constructor(){super(...arguments);xe(this,"priority",80);xe(this,"incompatibleTokens",["b","B","H","k","t","T"])}parse(t,s,r){switch(s){case"a":case"aa":case"aaa":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(Ow(r),0,0,0),t}}class NU extends Dt{constructor(){super(...arguments);xe(this,"priority",80);xe(this,"incompatibleTokens",["a","B","H","k","t","T"])}parse(t,s,r){switch(s){case"b":case"bb":case"bbb":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(Ow(r),0,0,0),t}}class jU extends Dt{constructor(){super(...arguments);xe(this,"priority",80);xe(this,"incompatibleTokens",["a","b","t","T"])}parse(t,s,r){switch(s){case"B":case"BB":case"BBB":return r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(t,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(t,{width:"wide",context:"formatting"})||r.dayPeriod(t,{width:"abbreviated",context:"formatting"})||r.dayPeriod(t,{width:"narrow",context:"formatting"})}}set(t,s,r){return t.setHours(Ow(r),0,0,0),t}}class CU extends Dt{constructor(){super(...arguments);xe(this,"priority",70);xe(this,"incompatibleTokens",["H","K","k","t","T"])}parse(t,s,r){switch(s){case"h":return un(_n.hour12h,t);case"ho":return r.ordinalNumber(t,{unit:"hour"});default:return xn(s.length,t)}}validate(t,s){return s>=1&&s<=12}set(t,s,r){const i=t.getHours()>=12;return i&&r<12?t.setHours(r+12,0,0,0):!i&&r===12?t.setHours(0,0,0,0):t.setHours(r,0,0,0),t}}class kU extends Dt{constructor(){super(...arguments);xe(this,"priority",70);xe(this,"incompatibleTokens",["a","b","h","K","k","t","T"])}parse(t,s,r){switch(s){case"H":return un(_n.hour23h,t);case"Ho":return r.ordinalNumber(t,{unit:"hour"});default:return xn(s.length,t)}}validate(t,s){return s>=0&&s<=23}set(t,s,r){return t.setHours(r,0,0,0),t}}class TU extends Dt{constructor(){super(...arguments);xe(this,"priority",70);xe(this,"incompatibleTokens",["h","H","k","t","T"])}parse(t,s,r){switch(s){case"K":return un(_n.hour11h,t);case"Ko":return r.ordinalNumber(t,{unit:"hour"});default:return xn(s.length,t)}}validate(t,s){return s>=0&&s<=11}set(t,s,r){return t.getHours()>=12&&r<12?t.setHours(r+12,0,0,0):t.setHours(r,0,0,0),t}}class EU extends Dt{constructor(){super(...arguments);xe(this,"priority",70);xe(this,"incompatibleTokens",["a","b","h","H","K","t","T"])}parse(t,s,r){switch(s){case"k":return un(_n.hour24h,t);case"ko":return r.ordinalNumber(t,{unit:"hour"});default:return xn(s.length,t)}}validate(t,s){return s>=1&&s<=24}set(t,s,r){const i=r<=24?r%24:r;return t.setHours(i,0,0,0),t}}class PU extends Dt{constructor(){super(...arguments);xe(this,"priority",60);xe(this,"incompatibleTokens",["t","T"])}parse(t,s,r){switch(s){case"m":return un(_n.minute,t);case"mo":return r.ordinalNumber(t,{unit:"minute"});default:return xn(s.length,t)}}validate(t,s){return s>=0&&s<=59}set(t,s,r){return t.setMinutes(r,0,0),t}}class MU extends Dt{constructor(){super(...arguments);xe(this,"priority",50);xe(this,"incompatibleTokens",["t","T"])}parse(t,s,r){switch(s){case"s":return un(_n.second,t);case"so":return r.ordinalNumber(t,{unit:"second"});default:return xn(s.length,t)}}validate(t,s){return s>=0&&s<=59}set(t,s,r){return t.setSeconds(r,0),t}}class DU extends Dt{constructor(){super(...arguments);xe(this,"priority",30);xe(this,"incompatibleTokens",["t","T"])}parse(t,s){const r=i=>Math.trunc(i*Math.pow(10,-s.length+3));return Sn(xn(s.length,t),r)}set(t,s,r){return t.setMilliseconds(r),t}}class AU extends Dt{constructor(){super(...arguments);xe(this,"priority",10);xe(this,"incompatibleTokens",["t","T","x"])}parse(t,s){switch(s){case"X":return vi(xi.basicOptionalMinutes,t);case"XX":return vi(xi.basic,t);case"XXXX":return vi(xi.basicOptionalSeconds,t);case"XXXXX":return vi(xi.extendedOptionalSeconds,t);case"XXX":default:return vi(xi.extended,t)}}set(t,s,r){return s.timestampIsSet?t:lt(t,t.getTime()-Vs(t)-r)}}class IU extends Dt{constructor(){super(...arguments);xe(this,"priority",10);xe(this,"incompatibleTokens",["t","T","X"])}parse(t,s){switch(s){case"x":return vi(xi.basicOptionalMinutes,t);case"xx":return vi(xi.basic,t);case"xxxx":return vi(xi.basicOptionalSeconds,t);case"xxxxx":return vi(xi.extendedOptionalSeconds,t);case"xxx":default:return vi(xi.extended,t)}}set(t,s,r){return s.timestampIsSet?t:lt(t,t.getTime()-Vs(t)-r)}}class OU extends Dt{constructor(){super(...arguments);xe(this,"priority",40);xe(this,"incompatibleTokens","*")}parse(t){return W2(t)}set(t,s,r){return[lt(t,r*1e3),{timestampIsSet:!0}]}}class RU extends Dt{constructor(){super(...arguments);xe(this,"priority",20);xe(this,"incompatibleTokens","*")}parse(t){return W2(t)}set(t,s,r){return[lt(t,r),{timestampIsSet:!0}]}}const Q2={G:new rU,y:new iU,Y:new aU,R:new oU,u:new lU,Q:new cU,q:new dU,M:new uU,L:new hU,w:new fU,I:new mU,d:new yU,D:new xU,E:new vU,e:new bU,c:new wU,i:new _U,a:new SU,b:new NU,B:new jU,h:new CU,H:new kU,K:new TU,k:new EU,m:new PU,s:new MU,S:new DU,X:new AU,x:new IU,t:new OU,T:new RU},LU=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,FU=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,$U=/^'([^]*?)'?$/,zU=/''/g,UU=/\S/,VU=/[a-zA-Z]/;function Rw(n,e,t,s){var v,_,N,j,k,S,P,E;const r=z2(),i=(s==null?void 0:s.locale)??r.locale??md,o=(s==null?void 0:s.firstWeekContainsDate)??((_=(v=s==null?void 0:s.locale)==null?void 0:v.options)==null?void 0:_.firstWeekContainsDate)??r.firstWeekContainsDate??((j=(N=r.locale)==null?void 0:N.options)==null?void 0:j.firstWeekContainsDate)??1,l=(s==null?void 0:s.weekStartsOn)??((S=(k=s==null?void 0:s.locale)==null?void 0:k.options)==null?void 0:S.weekStartsOn)??r.weekStartsOn??((E=(P=r.locale)==null?void 0:P.options)==null?void 0:E.weekStartsOn)??0;if(e==="")return n===""?ce(t):lt(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:i},d=[new sU],h=e.match(FU).map(M=>{const I=M[0];if(I in Sp){const O=Sp[I];return O(M,i.formatLong)}return M}).join("").match(LU),f=[];for(let M of h){!(s!=null&&s.useAdditionalWeekYearTokens)&&I2(M)&&ub(M,e,n),!(s!=null&&s.useAdditionalDayOfYearTokens)&&A2(M)&&ub(M,e,n);const I=M[0],O=Q2[I];if(O){const{incompatibleTokens:D}=O;if(Array.isArray(D)){const H=f.find(F=>D.includes(F.token)||F.token===I);if(H)throw new RangeError(`The format string mustn't contain \`${H.fullToken}\` and \`${M}\` at the same time`)}else if(O.incompatibleTokens==="*"&&f.length>0)throw new RangeError(`The format string mustn't contain \`${M}\` and any other token at the same time`);f.push({token:I,fullToken:M});const z=O.run(n,M,i.match,c);if(!z)return lt(t,NaN);d.push(z.setter),n=z.rest}else{if(I.match(VU))throw new RangeError("Format string contains an unescaped latin alphabet character `"+I+"`");if(M==="''"?M="'":I==="'"&&(M=BU(M)),n.indexOf(M)===0)n=n.slice(M.length);else return lt(t,NaN)}}if(n.length>0&&UU.test(n))return lt(t,NaN);const p=d.map(M=>M.priority).sort((M,I)=>I-M).filter((M,I,O)=>O.indexOf(M)===I).map(M=>d.filter(I=>I.priority===M).sort((I,O)=>O.subPriority-I.subPriority)).map(M=>M[0]);let g=ce(t);if(isNaN(g.getTime()))return lt(t,NaN);const b={};for(const M of p){if(!M.validate(g,c))return lt(t,NaN);const I=M.set(g,b,c);Array.isArray(I)?(g=I[0],Object.assign(b,I[1])):g=I}return lt(t,g)}function BU(n){return n.match($U)[1].replace(zU,"'")}function qU(n,e,t){return oa(Rw(n,e,new Date,t))}function HU(n){return ce(n).getDay()===1}function WU(n){return+ce(n)<Date.now()}function hb(n){const e=ce(n);return e.setMinutes(0,0,0),e}function X2(n,e){const t=hb(n),s=hb(e);return+t==+s}function Lw(n,e,t){const s=Zn(n,t),r=Zn(e,t);return+s==+r}function eD(n,e){return Lw(n,e,{weekStartsOn:1})}function GU(n,e){const t=no(n),s=no(e);return+t==+s}function tD(n,e){const t=wp(n),s=wp(e);return+t==+s}function nD(n,e){const t=ce(n),s=ce(e);return t.getFullYear()===s.getFullYear()&&t.getMonth()===s.getMonth()}function sD(n,e){const t=nl(n),s=nl(e);return+t==+s}function fb(n){const e=ce(n);return e.setMilliseconds(0),e}function rD(n,e){const t=fb(n),s=fb(e);return+t==+s}function iD(n,e){const t=ce(n),s=ce(e);return t.getFullYear()===s.getFullYear()}function YU(n){return X2(n,Hs(n))}function ZU(n){return eD(n,Hs(n))}function KU(n){return tD(n,Hs(n))}function JU(n){return nD(n,Hs(n))}function QU(n){return sD(n,Hs(n))}function XU(n){return rD(n,Hs(n))}function eV(n,e){return Lw(n,Hs(n),e)}function tV(n){return iD(n,Hs(n))}function nV(n){return ce(n).getDay()===4}function sV(n){return Hr(n,Hs(n))}function rV(n){return Hr(n,is(Hs(n),1))}function iV(n){return ce(n).getDay()===2}function aV(n){return ce(n).getDay()===3}function oV(n,e){const t=+ce(n),[s,r]=[+ce(e.start),+ce(e.end)].sort((i,o)=>i-o);return t>=s&&t<=r}function ji(n,e){return is(n,-e)}function lV(n){return Hr(n,ji(Hs(n),1))}function cV(n){const e=ce(n),t=e.getFullYear(),s=9+Math.floor(t/10)*10;return e.setFullYear(s+1,0,0),e.setHours(0,0,0,0),e}function aD(n,e){var l,c,d,h;const t=js(),s=(e==null?void 0:e.weekStartsOn)??((c=(l=e==null?void 0:e.locale)==null?void 0:l.options)==null?void 0:c.weekStartsOn)??t.weekStartsOn??((h=(d=t.locale)==null?void 0:d.options)==null?void 0:h.weekStartsOn)??0,r=ce(n),i=r.getDay(),o=(i<s?-7:0)+6-(i-s);return r.setHours(0,0,0,0),r.setDate(r.getDate()+o),r}function dV(n){return aD(n,{weekStartsOn:1})}function uV(n){const e=eo(n),t=lt(n,0);t.setFullYear(e+1,0,4),t.setHours(0,0,0,0);const s=Zr(t);return s.setDate(s.getDate()-1),s}function hV(n){const e=ce(n),t=e.getMonth(),s=t-t%3+3;return e.setMonth(s,0),e.setHours(0,0,0,0),e}function fV(n){const e=ce(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(0,0,0,0),e}const mV=/(\w)\1*|''|'(''|[^'])+('|$)|./g,pV=/^'([^]*?)'?$/,gV=/''/g,yV=/[a-zA-Z]/;function xV(n,e){const t=ce(n);if(!oa(t))throw new RangeError("Invalid time value");const s=e.match(mV);return s?s.map(i=>{if(i==="''")return"'";const o=i[0];if(o==="'")return vV(i);const l=hi[o];if(l)return l(t,i);if(o.match(yV))throw new RangeError("Format string contains an unescaped latin alphabet character `"+o+"`");return i}).join(""):""}function vV(n){const e=n.match(pV);return e?e[1].replace(gV,"'"):n}function bV({years:n,months:e,weeks:t,days:s,hours:r,minutes:i,seconds:o}){let l=0;n&&(l+=n*gp),e&&(l+=e*(gp/12)),t&&(l+=t*7),s&&(l+=s);let c=l*24*60*60;return r&&(c+=r*60*60),i&&(c+=i*60),o&&(c+=o),Math.trunc(c*1e3)}function wV(n){const e=n/Tl;return Math.trunc(e)}function _V(n){const e=n/aa;return Math.trunc(e)}function SV(n){const e=n/Sw;return Math.trunc(e)}function NV(n){const e=n/h2;return Math.trunc(e)}function jV(n){return Math.trunc(n*aa)}function CV(n){return Math.trunc(n*Nw)}function kV(n){const e=n/f2;return Math.trunc(e)}function TV(n){const e=n/m2;return Math.trunc(e)}function go(n,e){let t=e-El(n);return t<=0&&(t+=7),is(n,t)}function EV(n){return go(n,5)}function PV(n){return go(n,1)}function MV(n){return go(n,6)}function DV(n){return go(n,0)}function AV(n){return go(n,4)}function IV(n){return go(n,2)}function OV(n){return go(n,3)}function RV(n,e){const t=(e==null?void 0:e.additionalDigits)??2,s=zV(n);let r;if(s.date){const c=UV(s.date,t);r=VV(c.restDateString,c.year)}if(!r||isNaN(r.getTime()))return new Date(NaN);const i=r.getTime();let o=0,l;if(s.time&&(o=BV(s.time),isNaN(o)))return new Date(NaN);if(s.timezone){if(l=qV(s.timezone),isNaN(l))return new Date(NaN)}else{const c=new Date(i+o),d=new Date(0);return d.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),d.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),d}return new Date(i+o+l)}const Af={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},LV=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,FV=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,$V=/^([+-])(\d{2})(?::?(\d{2}))?$/;function zV(n){const e={},t=n.split(Af.dateTimeDelimiter);let s;if(t.length>2)return e;if(/:/.test(t[0])?s=t[0]:(e.date=t[0],s=t[1],Af.timeZoneDelimiter.test(e.date)&&(e.date=n.split(Af.timeZoneDelimiter)[0],s=n.substr(e.date.length,n.length))),s){const r=Af.timezone.exec(s);r?(e.time=s.replace(r[1],""),e.timezone=r[1]):e.time=s}return e}function UV(n,e){const t=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+e)+"})|(\\d{2}|[+-]\\d{"+(2+e)+"})$)"),s=n.match(t);if(!s)return{year:NaN,restDateString:""};const r=s[1]?parseInt(s[1]):null,i=s[2]?parseInt(s[2]):null;return{year:i===null?r:i*100,restDateString:n.slice((s[1]||s[2]).length)}}function VV(n,e){if(e===null)return new Date(NaN);const t=n.match(LV);if(!t)return new Date(NaN);const s=!!t[4],r=Bd(t[1]),i=Bd(t[2])-1,o=Bd(t[3]),l=Bd(t[4]),c=Bd(t[5])-1;if(s)return ZV(e,l,c)?HV(e,l,c):new Date(NaN);{const d=new Date(0);return!GV(e,i,o)||!YV(e,r)?new Date(NaN):(d.setUTCFullYear(e,i,Math.max(r,o)),d)}}function Bd(n){return n?parseInt(n):1}function BV(n){const e=n.match(FV);if(!e)return NaN;const t=hx(e[1]),s=hx(e[2]),r=hx(e[3]);return KV(t,s,r)?t*Tl+s*aa+r*1e3:NaN}function hx(n){return n&&parseFloat(n.replace(",","."))||0}function qV(n){if(n==="Z")return 0;const e=n.match($V);if(!e)return 0;const t=e[1]==="+"?-1:1,s=parseInt(e[2]),r=e[3]&&parseInt(e[3])||0;return JV(s,r)?t*(s*Tl+r*aa):NaN}function HV(n,e,t){const s=new Date(0);s.setUTCFullYear(n,0,4);const r=s.getUTCDay()||7,i=(e-1)*7+t+1-r;return s.setUTCDate(s.getUTCDate()+i),s}const WV=[31,null,31,30,31,30,31,31,30,31,30,31];function oD(n){return n%400===0||n%4===0&&n%100!==0}function GV(n,e,t){return e>=0&&e<=11&&t>=1&&t<=(WV[e]||(oD(n)?29:28))}function YV(n,e){return e>=1&&e<=(oD(n)?366:365)}function ZV(n,e,t){return e>=1&&e<=53&&t>=0&&t<=6}function KV(n,e,t){return n===24?e===0&&t===0:t>=0&&t<60&&e>=0&&e<60&&n>=0&&n<25}function JV(n,e){return e>=0&&e<=59}function QV(n){const e=n.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return e?new Date(Date.UTC(+e[1],+e[2]-1,+e[3],+e[4]-(+e[9]||0)*(e[8]=="-"?-1:1),+e[5]-(+e[10]||0)*(e[8]=="-"?-1:1),+e[6],+((e[7]||"0")+"00").substring(0,3))):new Date(NaN)}function yo(n,e){let t=El(n)-e;return t<=0&&(t+=7),ji(n,t)}function XV(n){return yo(n,5)}function eB(n){return yo(n,1)}function tB(n){return yo(n,6)}function nB(n){return yo(n,0)}function sB(n){return yo(n,4)}function rB(n){return yo(n,2)}function iB(n){return yo(n,3)}function aB(n){return Math.trunc(n*f2)}function oB(n){const e=n/p2;return Math.trunc(e)}function lB(n,e){const t=(e==null?void 0:e.nearestTo)??1;if(t<1||t>12)return lt(n,NaN);const s=ce(n),r=s.getMinutes()/60,i=s.getSeconds()/60/60,o=s.getMilliseconds()/1e3/60/60,l=s.getHours()+r+i+o,c=(e==null?void 0:e.roundingMethod)??"round",h=po(c)(l/t)*t,f=lt(n,s);return f.setHours(h,0,0,0),f}function cB(n,e){const t=(e==null?void 0:e.nearestTo)??1;if(t<1||t>30)return lt(n,NaN);const s=ce(n),r=s.getSeconds()/60,i=s.getMilliseconds()/1e3/60,o=s.getMinutes()+r+i,l=(e==null?void 0:e.roundingMethod)??"round",d=po(l)(o/t)*t,h=lt(n,s);return h.setMinutes(d,0,0),h}function dB(n){const e=n/bg;return Math.trunc(e)}function uB(n){return n*Sw}function hB(n){const e=n/Nw;return Math.trunc(e)}function Fw(n,e){const t=ce(n),s=t.getFullYear(),r=t.getDate(),i=lt(n,0);i.setFullYear(s,e,15),i.setHours(0,0,0,0);const o=F2(i);return t.setMonth(e,Math.min(r,o)),t}function fB(n,e){let t=ce(n);return isNaN(+t)?lt(n,NaN):(e.year!=null&&t.setFullYear(e.year),e.month!=null&&(t=Fw(t,e.month)),e.date!=null&&t.setDate(e.date),e.hours!=null&&t.setHours(e.hours),e.minutes!=null&&t.setMinutes(e.minutes),e.seconds!=null&&t.setSeconds(e.seconds),e.milliseconds!=null&&t.setMilliseconds(e.milliseconds),t)}function mB(n,e){const t=ce(n);return t.setDate(e),t}function pB(n,e){const t=ce(n);return t.setMonth(0),t.setDate(e),t}function gB(n){const e={},t=js();for(const s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(n[s]===void 0?delete e[s]:e[s]=n[s]);J6(e)}function yB(n,e){const t=ce(n);return t.setHours(e),t}function xB(n,e){const t=ce(n);return t.setMilliseconds(e),t}function vB(n,e){const t=ce(n);return t.setMinutes(e),t}function bB(n,e){const t=ce(n),s=Math.trunc(t.getMonth()/3)+1,r=e-s;return Fw(t,t.getMonth()+r*3)}function wB(n,e){const t=ce(n);return t.setSeconds(e),t}function _B(n,e,t){var c,d,h,f;const s=js(),r=(t==null?void 0:t.firstWeekContainsDate)??((d=(c=t==null?void 0:t.locale)==null?void 0:c.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((f=(h=s.locale)==null?void 0:h.options)==null?void 0:f.firstWeekContainsDate)??1;let i=ce(n);const o=rr(i,_p(i,t)),l=lt(n,0);return l.setFullYear(e,0,r),l.setHours(0,0,0,0),i=_p(l,t),i.setDate(i.getDate()+o),i}function SB(n,e){const t=ce(n);return isNaN(+t)?lt(n,NaN):(t.setFullYear(e),t)}function NB(n){const e=ce(n),t=e.getFullYear(),s=Math.floor(t/10)*10;return e.setFullYear(s,0,1),e.setHours(0,0,0,0),e}function jp(){return to(Date.now())}function jB(){const n=new Date,e=n.getFullYear(),t=n.getMonth(),s=n.getDate(),r=new Date(0);return r.setFullYear(e,t,s+1),r.setHours(0,0,0,0),r}function CB(){const n=new Date,e=n.getFullYear(),t=n.getMonth(),s=n.getDate(),r=new Date(0);return r.setFullYear(e,t,s-1),r.setHours(0,0,0,0),r}function kh(n,e){return mo(n,-e)}function kB(n,e){const{years:t=0,months:s=0,weeks:r=0,days:i=0,hours:o=0,minutes:l=0,seconds:c=0}=e,d=kh(n,s+t*12),h=ji(d,i+r*7),f=l+o*60,g=(c+f*60)*1e3;return lt(n,h.getTime()-g)}function TB(n,e){return c2(n,-e)}function EB(n,e){return Cw(n,-e)}function PB(n,e){return jh(n,-e)}function MB(n,e){return kw(n,-e)}function DB(n,e){return Tw(n,-e)}function AB(n,e){return w2(n,-e)}function IB(n,e){return wg(n,-e)}function OB(n,e){return _2(n,-e)}function RB(n){return Math.trunc(n*d2)}function LB(n){return Math.trunc(n*gp)}function FB(n){return Math.trunc(n*m2)}function $B(n){return Math.trunc(n*p2)}const zB=Object.freeze(Object.defineProperty({__proto__:null,add:lc,addBusinessDays:c2,addDays:is,addHours:Cw,addISOWeekYears:b2,addMilliseconds:jh,addMinutes:kw,addMonths:mo,addQuarters:Tw,addSeconds:w2,addWeeks:wg,addYears:_2,areIntervalsOverlapping:Q6,clamp:X6,closestIndexTo:ez,closestTo:tz,compareAsc:Ni,compareDesc:nz,constructFrom:lt,constructNow:Hs,daysToWeeks:sz,differenceInBusinessDays:rz,differenceInCalendarDays:rr,differenceInCalendarISOWeekYears:C2,differenceInCalendarISOWeeks:iz,differenceInCalendarMonths:xp,differenceInCalendarQuarters:_m,differenceInCalendarWeeks:vp,differenceInCalendarYears:Tu,differenceInDays:Ew,differenceInHours:bp,differenceInISOWeekYears:az,differenceInMilliseconds:_g,differenceInMinutes:so,differenceInMonths:Sg,differenceInQuarters:oz,differenceInSeconds:Oc,differenceInWeeks:lz,differenceInYears:E2,eachDayOfInterval:Ur,eachHourOfInterval:cz,eachMinuteOfInterval:dz,eachMonthOfInterval:uz,eachQuarterOfInterval:hz,eachWeekOfInterval:fz,eachWeekendOfInterval:Mw,eachWeekendOfMonth:mz,eachWeekendOfYear:pz,eachYearOfInterval:gz,endOfDay:Pw,endOfDecade:yz,endOfHour:xz,endOfISOWeek:vz,endOfISOWeekYear:bz,endOfMinute:wz,endOfMonth:jr,endOfQuarter:_z,endOfSecond:Sz,endOfToday:cb,endOfTomorrow:Nz,endOfWeek:P2,endOfYear:Dw,endOfYesterday:jz,format:Ce,formatDate:Ce,formatDistance:O2,formatDistanceStrict:R2,formatDistanceToNow:Zc,formatDistanceToNowStrict:p5,formatDuration:y5,formatISO:x5,formatISO9075:v5,formatISODuration:b5,formatRFC3339:w5,formatRFC7231:N5,formatRelative:j5,formatters:db,fromUnixTime:C5,getDate:L2,getDay:El,getDayOfYear:M2,getDaysInMonth:F2,getDaysInYear:k5,getDecade:T5,getDefaultOptions:z2,getHours:E5,getISODay:U2,getISOWeek:Aw,getISOWeekYear:eo,getISOWeeksInYear:P5,getMilliseconds:M5,getMinutes:D5,getMonth:A5,getOverlappingDaysInIntervals:I5,getQuarter:lb,getSeconds:O5,getTime:R5,getUnixTime:L5,getWeek:Iw,getWeekOfMonth:F5,getWeekYear:jg,getWeeksInMonth:$5,getYear:z5,hoursToMilliseconds:U5,hoursToMinutes:V5,hoursToSeconds:B5,interval:q5,intervalToDuration:H5,intlFormat:W5,intlFormatDistance:Y5,isAfter:B2,isBefore:Z5,isDate:j2,isEqual:K5,isExists:J5,isFirstDayOfMonth:Q5,isFriday:X5,isFuture:eU,isLastDayOfMonth:T2,isLeapYear:$2,isMatch:qU,isMonday:HU,isPast:WU,isSameDay:Hr,isSameHour:X2,isSameISOWeek:eD,isSameISOWeekYear:GU,isSameMinute:tD,isSameMonth:nD,isSameQuarter:sD,isSameSecond:rD,isSameWeek:Lw,isSameYear:iD,isSaturday:o2,isSunday:l2,isThisHour:YU,isThisISOWeek:ZU,isThisMinute:KU,isThisMonth:JU,isThisQuarter:QU,isThisSecond:XU,isThisWeek:eV,isThisYear:tV,isThursday:nV,isToday:sV,isTomorrow:rV,isTuesday:iV,isValid:oa,isWednesday:aV,isWeekend:Ic,isWithinInterval:oV,isYesterday:lV,lastDayOfDecade:cV,lastDayOfISOWeek:dV,lastDayOfISOWeekYear:uV,lastDayOfMonth:V2,lastDayOfQuarter:hV,lastDayOfWeek:aD,lastDayOfYear:fV,lightFormat:xV,lightFormatters:hi,longFormatters:Sp,max:S2,milliseconds:bV,millisecondsToHours:wV,millisecondsToMinutes:_V,millisecondsToSeconds:SV,min:N2,minutesToHours:NV,minutesToMilliseconds:jV,minutesToSeconds:CV,monthsToQuarters:kV,monthsToYears:TV,nextDay:go,nextFriday:EV,nextMonday:PV,nextSaturday:MV,nextSunday:DV,nextThursday:AV,nextTuesday:IV,nextWednesday:OV,parse:Rw,parseISO:RV,parseJSON:QV,parsers:Q2,previousDay:yo,previousFriday:XV,previousMonday:eB,previousSaturday:tB,previousSunday:nB,previousThursday:sB,previousTuesday:rB,previousWednesday:iB,quartersToMonths:aB,quartersToYears:oB,roundToNearestHours:lB,roundToNearestMinutes:cB,secondsToHours:dB,secondsToMilliseconds:uB,secondsToMinutes:hB,set:fB,setDate:mB,setDay:Cg,setDayOfYear:pB,setDefaultOptions:gB,setHours:yB,setISODay:J2,setISOWeek:K2,setISOWeekYear:v2,setMilliseconds:xB,setMinutes:vB,setMonth:Fw,setQuarter:bB,setSeconds:wB,setWeek:Z2,setWeekYear:_B,setYear:SB,startOfDay:to,startOfDecade:NB,startOfHour:hb,startOfISOWeek:Zr,startOfISOWeekYear:no,startOfMinute:wp,startOfMonth:as,startOfQuarter:nl,startOfSecond:fb,startOfToday:jp,startOfTomorrow:jB,startOfWeek:Zn,startOfWeekYear:_p,startOfYear:Ng,startOfYesterday:CB,sub:kB,subBusinessDays:TB,subDays:ji,subHours:EB,subISOWeekYears:k2,subMilliseconds:PB,subMinutes:MB,subMonths:kh,subQuarters:DB,subSeconds:AB,subWeeks:IB,subYears:OB,toDate:ce,transpose:q2,weeksToDays:RB,yearsToDays:LB,yearsToMonths:FB,yearsToQuarters:$B},Symbol.toStringTag,{value:"Module"}));var Et;(function(n){n.assertEqual=r=>{};function e(r){}n.assertIs=e;function t(r){throw new Error}n.assertNever=t,n.arrayToEnum=r=>{const i={};for(const o of r)i[o]=o;return i},n.getValidEnumValues=r=>{const i=n.objectKeys(r).filter(l=>typeof r[r[l]]!="number"),o={};for(const l of i)o[l]=r[l];return n.objectValues(o)},n.objectValues=r=>n.objectKeys(r).map(function(i){return r[i]}),n.objectKeys=typeof Object.keys=="function"?r=>Object.keys(r):r=>{const i=[];for(const o in r)Object.prototype.hasOwnProperty.call(r,o)&&i.push(o);return i},n.find=(r,i)=>{for(const o of r)if(i(o))return o},n.isInteger=typeof Number.isInteger=="function"?r=>Number.isInteger(r):r=>typeof r=="number"&&Number.isFinite(r)&&Math.floor(r)===r;function s(r,i=" | "){return r.map(o=>typeof o=="string"?`'${o}'`:o).join(i)}n.joinValues=s,n.jsonStringifyReplacer=(r,i)=>typeof i=="bigint"?i.toString():i})(Et||(Et={}));var $j;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})($j||($j={}));const ze=Et.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Ta=n=>{switch(typeof n){case"undefined":return ze.undefined;case"string":return ze.string;case"number":return Number.isNaN(n)?ze.nan:ze.number;case"boolean":return ze.boolean;case"function":return ze.function;case"bigint":return ze.bigint;case"symbol":return ze.symbol;case"object":return Array.isArray(n)?ze.array:n===null?ze.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ze.promise:typeof Map<"u"&&n instanceof Map?ze.map:typeof Set<"u"&&n instanceof Set?ze.set:typeof Date<"u"&&n instanceof Date?ze.date:ze.object;default:return ze.unknown}},Ee=Et.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class la extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=s=>{this.issues=[...this.issues,s]},this.addIssues=(s=[])=>{this.issues=[...this.issues,...s]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(i){return i.message},s={_errors:[]},r=i=>{for(const o of i.issues)if(o.code==="invalid_union")o.unionErrors.map(r);else if(o.code==="invalid_return_type")r(o.returnTypeError);else if(o.code==="invalid_arguments")r(o.argumentsError);else if(o.path.length===0)s._errors.push(t(o));else{let l=s,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return r(this),s}static assert(e){if(!(e instanceof la))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Et.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},s=[];for(const r of this.issues)if(r.path.length>0){const i=r.path[0];t[i]=t[i]||[],t[i].push(e(r))}else s.push(e(r));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}la.create=n=>new la(n);const mb=(n,e)=>{let t;switch(n.code){case Ee.invalid_type:n.received===ze.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Ee.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,Et.jsonStringifyReplacer)}`;break;case Ee.unrecognized_keys:t=`Unrecognized key(s) in object: ${Et.joinValues(n.keys,", ")}`;break;case Ee.invalid_union:t="Invalid input";break;case Ee.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${Et.joinValues(n.options)}`;break;case Ee.invalid_enum_value:t=`Invalid enum value. Expected ${Et.joinValues(n.options)}, received '${n.received}'`;break;case Ee.invalid_arguments:t="Invalid function arguments";break;case Ee.invalid_return_type:t="Invalid function return type";break;case Ee.invalid_date:t="Invalid date";break;case Ee.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:Et.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Ee.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Ee.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Ee.custom:t="Invalid input";break;case Ee.invalid_intersection_types:t="Intersection results could not be merged";break;case Ee.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Ee.not_finite:t="Number must be finite";break;default:t=e.defaultError,Et.assertNever(n)}return{message:t}};let UB=mb;function VB(){return UB}const BB=n=>{const{data:e,path:t,errorMaps:s,issueData:r}=n,i=[...t,...r.path||[]],o={...r,path:i};if(r.message!==void 0)return{...r,path:i,message:r.message};let l="";const c=s.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...r,path:i,message:l}};function Re(n,e){const t=VB(),s=BB({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===mb?void 0:mb].filter(r=>!!r)});n.common.issues.push(s)}class ws{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const r of t){if(r.status==="aborted")return it;r.status==="dirty"&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const r of t){const i=await r.key,o=await r.value;s.push({key:i,value:o})}return ws.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const r of t){const{key:i,value:o}=r;if(i.status==="aborted"||o.status==="aborted")return it;i.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof o.value<"u"||r.alwaysSet)&&(s[i.value]=o.value)}return{status:e.value,value:s}}}const it=Object.freeze({status:"aborted"}),du=n=>({status:"dirty",value:n}),Tr=n=>({status:"valid",value:n}),zj=n=>n.status==="aborted",Uj=n=>n.status==="dirty",Kc=n=>n.status==="valid",Cp=n=>typeof Promise<"u"&&n instanceof Promise;var Be;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e==null?void 0:e.message})(Be||(Be={}));class Ti{constructor(e,t,s,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=r}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Vj=(n,e)=>{if(Kc(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new la(n.common.issues);return this._error=t,this._error}}};function pt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:s,description:r}=n;if(e&&(t||s))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:r}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??s??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:r}}class wt{get description(){return this._def.description}_getType(e){return Ta(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new ws,ctx:{common:e.parent.common,data:e.data,parsedType:Ta(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Cp(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){const s={common:{issues:[],async:(t==null?void 0:t.async)??!1,contextualErrorMap:t==null?void 0:t.errorMap},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ta(e)},r=this._parseSync({data:e,path:s.path,parent:s});return Vj(s,r)}"~validate"(e){var s,r;const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ta(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:t});return Kc(i)?{value:i.value}:{issues:t.common.issues}}catch(i){(r=(s=i==null?void 0:i.message)==null?void 0:s.toLowerCase())!=null&&r.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(i=>Kc(i)?{value:i.value}:{issues:t.common.issues})}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:t==null?void 0:t.errorMap,async:!0},path:(t==null?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Ta(e)},r=this._parse({data:e,path:s.path,parent:s}),i=await(Cp(r)?r:Promise.resolve(r));return Vj(s,i)}refine(e,t){const s=r=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(r):t;return this._refinement((r,i)=>{const o=e(r),l=()=>i.addIssue({code:Ee.custom,...s(r)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((s,r)=>e(s)?!0:(r.addIssue(typeof t=="function"?t(s,r):t),!1))}_refinement(e){return new Xc({schema:this,typeName:rt.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Ka.create(this,this._def)}nullable(){return ed.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Ci.create(this)}promise(){return Mp.create(this,this._def)}or(e){return Tp.create([this,e],this._def)}and(e){return Ep.create(this,e,this._def)}transform(e){return new Xc({...pt(this._def),schema:this,typeName:rt.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new xb({...pt(this._def),innerType:this,defaultValue:t,typeName:rt.ZodDefault})}brand(){return new hq({typeName:rt.ZodBranded,type:this,...pt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new vb({...pt(this._def),innerType:this,catchValue:t,typeName:rt.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return $w.create(this,e)}readonly(){return bb.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const qB=/^c[^\s-]{8,}$/i,HB=/^[0-9a-z]+$/,WB=/^[0-9A-HJKMNP-TV-Z]{26}$/i,GB=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,YB=/^[a-z0-9_-]{21}$/i,ZB=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,KB=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,JB=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,QB="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let fx;const XB=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,eq=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,tq=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,nq=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,sq=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,rq=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,lD="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",iq=new RegExp(`^${lD}$`);function cD(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function aq(n){return new RegExp(`^${cD(n)}$`)}function oq(n){let e=`${lD}T${cD(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function lq(n,e){return!!((e==="v4"||!e)&&XB.test(n)||(e==="v6"||!e)&&tq.test(n))}function cq(n,e){if(!ZB.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const s=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),r=JSON.parse(atob(s));return!(typeof r!="object"||r===null||"typ"in r&&(r==null?void 0:r.typ)!=="JWT"||!r.alg||e&&r.alg!==e)}catch{return!1}}function dq(n,e){return!!((e==="v4"||!e)&&eq.test(n)||(e==="v6"||!e)&&nq.test(n))}class bi extends wt{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ze.string){const i=this._getOrReturnCtx(e);return Re(i,{code:Ee.invalid_type,expected:ze.string,received:i.parsedType}),it}const s=new ws;let r;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="max")e.data.length>i.value&&(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),s.dirty());else if(i.kind==="length"){const o=e.data.length>i.value,l=e.data.length<i.value;(o||l)&&(r=this._getOrReturnCtx(e,r),o?Re(r,{code:Ee.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):l&&Re(r,{code:Ee.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),s.dirty())}else if(i.kind==="email")JB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"email",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="emoji")fx||(fx=new RegExp(QB,"u")),fx.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"emoji",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="uuid")GB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"uuid",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="nanoid")YB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"nanoid",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid")qB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"cuid",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="cuid2")HB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"cuid2",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="ulid")WB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"ulid",code:Ee.invalid_string,message:i.message}),s.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{r=this._getOrReturnCtx(e,r),Re(r,{validation:"url",code:Ee.invalid_string,message:i.message}),s.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"regex",code:Ee.invalid_string,message:i.message}),s.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),s.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:{startsWith:i.value},message:i.message}),s.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:{endsWith:i.value},message:i.message}),s.dirty()):i.kind==="datetime"?oq(i).test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:"datetime",message:i.message}),s.dirty()):i.kind==="date"?iq.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:"date",message:i.message}),s.dirty()):i.kind==="time"?aq(i).test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.invalid_string,validation:"time",message:i.message}),s.dirty()):i.kind==="duration"?KB.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"duration",code:Ee.invalid_string,message:i.message}),s.dirty()):i.kind==="ip"?lq(e.data,i.version)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"ip",code:Ee.invalid_string,message:i.message}),s.dirty()):i.kind==="jwt"?cq(e.data,i.alg)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"jwt",code:Ee.invalid_string,message:i.message}),s.dirty()):i.kind==="cidr"?dq(e.data,i.version)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"cidr",code:Ee.invalid_string,message:i.message}),s.dirty()):i.kind==="base64"?sq.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"base64",code:Ee.invalid_string,message:i.message}),s.dirty()):i.kind==="base64url"?rq.test(e.data)||(r=this._getOrReturnCtx(e,r),Re(r,{validation:"base64url",code:Ee.invalid_string,message:i.message}),s.dirty()):Et.assertNever(i);return{status:s.value,value:e.data}}_regex(e,t,s){return this.refinement(r=>e.test(r),{validation:t,code:Ee.invalid_string,...Be.errToObj(s)})}_addCheck(e){return new bi({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Be.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Be.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Be.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Be.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Be.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Be.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Be.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Be.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Be.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Be.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Be.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Be.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Be.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,offset:(e==null?void 0:e.offset)??!1,local:(e==null?void 0:e.local)??!1,...Be.errToObj(e==null?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof(e==null?void 0:e.precision)>"u"?null:e==null?void 0:e.precision,...Be.errToObj(e==null?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Be.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Be.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t==null?void 0:t.position,...Be.errToObj(t==null?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Be.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Be.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Be.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Be.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Be.errToObj(t)})}nonempty(e){return this.min(1,Be.errToObj(e))}trim(){return new bi({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bi({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bi({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}bi.create=n=>new bi({checks:[],typeName:rt.ZodString,coerce:(n==null?void 0:n.coerce)??!1,...pt(n)});function uq(n,e){const t=(n.toString().split(".")[1]||"").length,s=(e.toString().split(".")[1]||"").length,r=t>s?t:s,i=Number.parseInt(n.toFixed(r).replace(".","")),o=Number.parseInt(e.toFixed(r).replace(".",""));return i%o/10**r}class yl extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ze.number){const i=this._getOrReturnCtx(e);return Re(i,{code:Ee.invalid_type,expected:ze.number,received:i.parsedType}),it}let s;const r=new ws;for(const i of this._def.checks)i.kind==="int"?Et.isInteger(e.data)||(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.invalid_type,expected:"integer",received:"float",message:i.message}),r.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),r.dirty()):i.kind==="multipleOf"?uq(e.data,i.value)!==0&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.not_finite,message:i.message}),r.dirty()):Et.assertNever(i);return{status:r.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Be.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Be.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Be.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Be.toString(t))}setLimit(e,t,s,r){return new yl({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Be.toString(r)}]})}_addCheck(e){return new yl({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Be.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Be.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Be.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Be.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Be.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&Et.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if(s.kind==="finite"||s.kind==="int"||s.kind==="multipleOf")return!0;s.kind==="min"?(t===null||s.value>t)&&(t=s.value):s.kind==="max"&&(e===null||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}yl.create=n=>new yl({checks:[],typeName:rt.ZodNumber,coerce:(n==null?void 0:n.coerce)||!1,...pt(n)});class xl extends wt{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ze.bigint)return this._getInvalidInput(e);let s;const r=new ws;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),r.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(s=this._getOrReturnCtx(e,s),Re(s,{code:Ee.not_multiple_of,multipleOf:i.value,message:i.message}),r.dirty()):Et.assertNever(i);return{status:r.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Re(t,{code:Ee.invalid_type,expected:ze.bigint,received:t.parsedType}),it}gte(e,t){return this.setLimit("min",e,!0,Be.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Be.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Be.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Be.toString(t))}setLimit(e,t,s,r){return new xl({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Be.toString(r)}]})}_addCheck(e){return new xl({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Be.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Be.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Be.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}xl.create=n=>new xl({checks:[],typeName:rt.ZodBigInt,coerce:(n==null?void 0:n.coerce)??!1,...pt(n)});class kp extends wt{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ze.boolean){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.boolean,received:s.parsedType}),it}return Tr(e.data)}}kp.create=n=>new kp({typeName:rt.ZodBoolean,coerce:(n==null?void 0:n.coerce)||!1,...pt(n)});class Jc extends wt{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ze.date){const i=this._getOrReturnCtx(e);return Re(i,{code:Ee.invalid_type,expected:ze.date,received:i.parsedType}),it}if(Number.isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return Re(i,{code:Ee.invalid_date}),it}const s=new ws;let r;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),s.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(r=this._getOrReturnCtx(e,r),Re(r,{code:Ee.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),s.dirty()):Et.assertNever(i);return{status:s.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Jc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Be.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Be.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}Jc.create=n=>new Jc({checks:[],coerce:(n==null?void 0:n.coerce)||!1,typeName:rt.ZodDate,...pt(n)});class Bj extends wt{_parse(e){if(this._getType(e)!==ze.symbol){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.symbol,received:s.parsedType}),it}return Tr(e.data)}}Bj.create=n=>new Bj({typeName:rt.ZodSymbol,...pt(n)});class qj extends wt{_parse(e){if(this._getType(e)!==ze.undefined){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.undefined,received:s.parsedType}),it}return Tr(e.data)}}qj.create=n=>new qj({typeName:rt.ZodUndefined,...pt(n)});class Hj extends wt{_parse(e){if(this._getType(e)!==ze.null){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.null,received:s.parsedType}),it}return Tr(e.data)}}Hj.create=n=>new Hj({typeName:rt.ZodNull,...pt(n)});class Wj extends wt{constructor(){super(...arguments),this._any=!0}_parse(e){return Tr(e.data)}}Wj.create=n=>new Wj({typeName:rt.ZodAny,...pt(n)});class pb extends wt{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Tr(e.data)}}pb.create=n=>new pb({typeName:rt.ZodUnknown,...pt(n)});class ro extends wt{_parse(e){const t=this._getOrReturnCtx(e);return Re(t,{code:Ee.invalid_type,expected:ze.never,received:t.parsedType}),it}}ro.create=n=>new ro({typeName:rt.ZodNever,...pt(n)});class Gj extends wt{_parse(e){if(this._getType(e)!==ze.undefined){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.void,received:s.parsedType}),it}return Tr(e.data)}}Gj.create=n=>new Gj({typeName:rt.ZodVoid,...pt(n)});class Ci extends wt{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),r=this._def;if(t.parsedType!==ze.array)return Re(t,{code:Ee.invalid_type,expected:ze.array,received:t.parsedType}),it;if(r.exactLength!==null){const o=t.data.length>r.exactLength.value,l=t.data.length<r.exactLength.value;(o||l)&&(Re(t,{code:o?Ee.too_big:Ee.too_small,minimum:l?r.exactLength.value:void 0,maximum:o?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(r.minLength!==null&&t.data.length<r.minLength.value&&(Re(t,{code:Ee.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),r.maxLength!==null&&t.data.length>r.maxLength.value&&(Re(t,{code:Ee.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>r.type._parseAsync(new Ti(t,o,t.path,l)))).then(o=>ws.mergeArray(s,o));const i=[...t.data].map((o,l)=>r.type._parseSync(new Ti(t,o,t.path,l)));return ws.mergeArray(s,i)}get element(){return this._def.type}min(e,t){return new Ci({...this._def,minLength:{value:e,message:Be.toString(t)}})}max(e,t){return new Ci({...this._def,maxLength:{value:e,message:Be.toString(t)}})}length(e,t){return new Ci({...this._def,exactLength:{value:e,message:Be.toString(t)}})}nonempty(e){return this.min(1,e)}}Ci.create=(n,e)=>new Ci({type:n,minLength:null,maxLength:null,exactLength:null,typeName:rt.ZodArray,...pt(e)});function cc(n){if(n instanceof En){const e={};for(const t in n.shape){const s=n.shape[t];e[t]=Ka.create(cc(s))}return new En({...n._def,shape:()=>e})}else return n instanceof Ci?new Ci({...n._def,type:cc(n.element)}):n instanceof Ka?Ka.create(cc(n.unwrap())):n instanceof ed?ed.create(cc(n.unwrap())):n instanceof vl?vl.create(n.items.map(e=>cc(e))):n}class En extends wt{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=Et.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ze.object){const d=this._getOrReturnCtx(e);return Re(d,{code:Ee.invalid_type,expected:ze.object,received:d.parsedType}),it}const{status:s,ctx:r}=this._processInputParams(e),{shape:i,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof ro&&this._def.unknownKeys==="strip"))for(const d in r.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=i[d],f=r.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new Ti(r,f,r.path,d)),alwaysSet:d in r.data})}if(this._def.catchall instanceof ro){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:r.data[h]}});else if(d==="strict")l.length>0&&(Re(r,{code:Ee.unrecognized_keys,keys:l}),s.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const f=r.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new Ti(r,f,r.path,h)),alwaysSet:h in r.data})}}return r.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const f=await h.key,p=await h.value;d.push({key:f,value:p,alwaysSet:h.alwaysSet})}return d}).then(d=>ws.mergeObjectSync(s,d)):ws.mergeObjectSync(s,c)}get shape(){return this._def.shape()}strict(e){return Be.errToObj,new En({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,s)=>{var i,o;const r=((o=(i=this._def).errorMap)==null?void 0:o.call(i,t,s).message)??s.defaultError;return t.code==="unrecognized_keys"?{message:Be.errToObj(e).message??r}:{message:r}}}:{}})}strip(){return new En({...this._def,unknownKeys:"strip"})}passthrough(){return new En({...this._def,unknownKeys:"passthrough"})}extend(e){return new En({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new En({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:rt.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new En({...this._def,catchall:e})}pick(e){const t={};for(const s of Et.objectKeys(e))e[s]&&this.shape[s]&&(t[s]=this.shape[s]);return new En({...this._def,shape:()=>t})}omit(e){const t={};for(const s of Et.objectKeys(this.shape))e[s]||(t[s]=this.shape[s]);return new En({...this._def,shape:()=>t})}deepPartial(){return cc(this)}partial(e){const t={};for(const s of Et.objectKeys(this.shape)){const r=this.shape[s];e&&!e[s]?t[s]=r:t[s]=r.optional()}return new En({...this._def,shape:()=>t})}required(e){const t={};for(const s of Et.objectKeys(this.shape))if(e&&!e[s])t[s]=this.shape[s];else{let i=this.shape[s];for(;i instanceof Ka;)i=i._def.innerType;t[s]=i}return new En({...this._def,shape:()=>t})}keyof(){return dD(Et.objectKeys(this.shape))}}En.create=(n,e)=>new En({shape:()=>n,unknownKeys:"strip",catchall:ro.create(),typeName:rt.ZodObject,...pt(e)});En.strictCreate=(n,e)=>new En({shape:()=>n,unknownKeys:"strict",catchall:ro.create(),typeName:rt.ZodObject,...pt(e)});En.lazycreate=(n,e)=>new En({shape:n,unknownKeys:"strip",catchall:ro.create(),typeName:rt.ZodObject,...pt(e)});class Tp extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;function r(i){for(const l of i)if(l.result.status==="valid")return l.result;for(const l of i)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=i.map(l=>new la(l.ctx.common.issues));return Re(t,{code:Ee.invalid_union,unionErrors:o}),it}if(t.common.async)return Promise.all(s.map(async i=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await i._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(r);{let i;const o=[];for(const c of s){const d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!i&&(i={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(i)return t.common.issues.push(...i.ctx.common.issues),i.result;const l=o.map(c=>new la(c));return Re(t,{code:Ee.invalid_union,unionErrors:l}),it}}get options(){return this._def.options}}Tp.create=(n,e)=>new Tp({options:n,typeName:rt.ZodUnion,...pt(e)});function gb(n,e){const t=Ta(n),s=Ta(e);if(n===e)return{valid:!0,data:n};if(t===ze.object&&s===ze.object){const r=Et.objectKeys(e),i=Et.objectKeys(n).filter(l=>r.indexOf(l)!==-1),o={...n,...e};for(const l of i){const c=gb(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ze.array&&s===ze.array){if(n.length!==e.length)return{valid:!1};const r=[];for(let i=0;i<n.length;i++){const o=n[i],l=e[i],c=gb(o,l);if(!c.valid)return{valid:!1};r.push(c.data)}return{valid:!0,data:r}}else return t===ze.date&&s===ze.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Ep extends wt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=(i,o)=>{if(zj(i)||zj(o))return it;const l=gb(i.value,o.value);return l.valid?((Uj(i)||Uj(o))&&t.dirty(),{status:t.value,value:l.data}):(Re(s,{code:Ee.invalid_intersection_types}),it)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then(([i,o])=>r(i,o)):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}Ep.create=(n,e,t)=>new Ep({left:n,right:e,typeName:rt.ZodIntersection,...pt(t)});class vl extends wt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==ze.array)return Re(s,{code:Ee.invalid_type,expected:ze.array,received:s.parsedType}),it;if(s.data.length<this._def.items.length)return Re(s,{code:Ee.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),it;!this._def.rest&&s.data.length>this._def.items.length&&(Re(s,{code:Ee.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const i=[...s.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new Ti(s,o,s.path,l)):null}).filter(o=>!!o);return s.common.async?Promise.all(i).then(o=>ws.mergeArray(t,o)):ws.mergeArray(t,i)}get items(){return this._def.items}rest(e){return new vl({...this._def,rest:e})}}vl.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new vl({items:n,typeName:rt.ZodTuple,rest:null,...pt(e)})};class Pp extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==ze.object)return Re(s,{code:Ee.invalid_type,expected:ze.object,received:s.parsedType}),it;const r=[],i=this._def.keyType,o=this._def.valueType;for(const l in s.data)r.push({key:i._parse(new Ti(s,l,s.path,l)),value:o._parse(new Ti(s,s.data[l],s.path,l)),alwaysSet:l in s.data});return s.common.async?ws.mergeObjectAsync(t,r):ws.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,s){return t instanceof wt?new Pp({keyType:e,valueType:t,typeName:rt.ZodRecord,...pt(s)}):new Pp({keyType:bi.create(),valueType:e,typeName:rt.ZodRecord,...pt(t)})}}class Yj extends wt{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==ze.map)return Re(s,{code:Ee.invalid_type,expected:ze.map,received:s.parsedType}),it;const r=this._def.keyType,i=this._def.valueType,o=[...s.data.entries()].map(([l,c],d)=>({key:r._parse(new Ti(s,l,s.path,[d,"key"])),value:i._parse(new Ti(s,c,s.path,[d,"value"]))}));if(s.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return it;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return it;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}}}}Yj.create=(n,e,t)=>new Yj({valueType:e,keyType:n,typeName:rt.ZodMap,...pt(t)});class ih extends wt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==ze.set)return Re(s,{code:Ee.invalid_type,expected:ze.set,received:s.parsedType}),it;const r=this._def;r.minSize!==null&&s.data.size<r.minSize.value&&(Re(s,{code:Ee.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),r.maxSize!==null&&s.data.size>r.maxSize.value&&(Re(s,{code:Ee.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const i=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return it;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}const l=[...s.data.values()].map((c,d)=>i._parse(new Ti(s,c,s.path,d)));return s.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new ih({...this._def,minSize:{value:e,message:Be.toString(t)}})}max(e,t){return new ih({...this._def,maxSize:{value:e,message:Be.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}ih.create=(n,e)=>new ih({valueType:n,minSize:null,maxSize:null,typeName:rt.ZodSet,...pt(e)});class yb extends wt{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}yb.create=(n,e)=>new yb({getter:n,typeName:rt.ZodLazy,...pt(e)});class Zj extends wt{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Re(t,{received:t.data,code:Ee.invalid_literal,expected:this._def.value}),it}return{status:"valid",value:e.data}}get value(){return this._def.value}}Zj.create=(n,e)=>new Zj({value:n,typeName:rt.ZodLiteral,...pt(e)});function dD(n,e){return new Qc({values:n,typeName:rt.ZodEnum,...pt(e)})}class Qc extends wt{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),s=this._def.values;return Re(t,{expected:Et.joinValues(s),received:t.parsedType,code:Ee.invalid_type}),it}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return Re(t,{received:t.data,code:Ee.invalid_enum_value,options:s}),it}return Tr(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Qc.create(e,{...this._def,...t})}exclude(e,t=this._def){return Qc.create(this.options.filter(s=>!e.includes(s)),{...this._def,...t})}}Qc.create=dD;class Kj extends wt{_parse(e){const t=Et.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==ze.string&&s.parsedType!==ze.number){const r=Et.objectValues(t);return Re(s,{expected:Et.joinValues(r),received:s.parsedType,code:Ee.invalid_type}),it}if(this._cache||(this._cache=new Set(Et.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const r=Et.objectValues(t);return Re(s,{received:s.data,code:Ee.invalid_enum_value,options:r}),it}return Tr(e.data)}get enum(){return this._def.values}}Kj.create=(n,e)=>new Kj({values:n,typeName:rt.ZodNativeEnum,...pt(e)});class Mp extends wt{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ze.promise&&t.common.async===!1)return Re(t,{code:Ee.invalid_type,expected:ze.promise,received:t.parsedType}),it;const s=t.parsedType===ze.promise?t.data:Promise.resolve(t.data);return Tr(s.then(r=>this._def.type.parseAsync(r,{path:t.path,errorMap:t.common.contextualErrorMap})))}}Mp.create=(n,e)=>new Mp({type:n,typeName:rt.ZodPromise,...pt(e)});class Xc extends wt{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===rt.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=this._def.effect||null,i={addIssue:o=>{Re(s,o),o.fatal?t.abort():t.dirty()},get path(){return s.path}};if(i.addIssue=i.addIssue.bind(i),r.type==="preprocess"){const o=r.transform(s.data,i);if(s.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return it;const c=await this._def.schema._parseAsync({data:l,path:s.path,parent:s});return c.status==="aborted"?it:c.status==="dirty"||t.value==="dirty"?du(c.value):c});{if(t.value==="aborted")return it;const l=this._def.schema._parseSync({data:o,path:s.path,parent:s});return l.status==="aborted"?it:l.status==="dirty"||t.value==="dirty"?du(l.value):l}}if(r.type==="refinement"){const o=l=>{const c=r.refinement(l,i);if(s.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(s.common.async===!1){const l=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return l.status==="aborted"?it:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(l=>l.status==="aborted"?it:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(r.type==="transform")if(s.common.async===!1){const o=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Kc(o))return it;const l=r.transform(o.value,i);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then(o=>Kc(o)?Promise.resolve(r.transform(o.value,i)).then(l=>({status:t.value,value:l})):it);Et.assertNever(r)}}Xc.create=(n,e,t)=>new Xc({schema:n,typeName:rt.ZodEffects,effect:e,...pt(t)});Xc.createWithPreprocess=(n,e,t)=>new Xc({schema:e,effect:{type:"preprocess",transform:n},typeName:rt.ZodEffects,...pt(t)});class Ka extends wt{_parse(e){return this._getType(e)===ze.undefined?Tr(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ka.create=(n,e)=>new Ka({innerType:n,typeName:rt.ZodOptional,...pt(e)});class ed extends wt{_parse(e){return this._getType(e)===ze.null?Tr(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ed.create=(n,e)=>new ed({innerType:n,typeName:rt.ZodNullable,...pt(e)});class xb extends wt{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===ze.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}xb.create=(n,e)=>new xb({innerType:n,typeName:rt.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...pt(e)});class vb extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Cp(r)?r.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new la(s.common.issues)},input:s.data})})):{status:"valid",value:r.status==="valid"?r.value:this._def.catchValue({get error(){return new la(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}vb.create=(n,e)=>new vb({innerType:n,typeName:rt.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...pt(e)});class Jj extends wt{_parse(e){if(this._getType(e)!==ze.nan){const s=this._getOrReturnCtx(e);return Re(s,{code:Ee.invalid_type,expected:ze.nan,received:s.parsedType}),it}return{status:"valid",value:e.data}}}Jj.create=n=>new Jj({typeName:rt.ZodNaN,...pt(n)});class hq extends wt{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class $w extends wt{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return i.status==="aborted"?it:i.status==="dirty"?(t.dirty(),du(i.value)):this._def.out._parseAsync({data:i.value,path:s.path,parent:s})})();{const r=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return r.status==="aborted"?it:r.status==="dirty"?(t.dirty(),{status:"dirty",value:r.value}):this._def.out._parseSync({data:r.value,path:s.path,parent:s})}}static create(e,t){return new $w({in:e,out:t,typeName:rt.ZodPipeline})}}class bb extends wt{_parse(e){const t=this._def.innerType._parse(e),s=r=>(Kc(r)&&(r.value=Object.freeze(r.value)),r);return Cp(t)?t.then(r=>s(r)):s(t)}unwrap(){return this._def.innerType}}bb.create=(n,e)=>new bb({innerType:n,typeName:rt.ZodReadonly,...pt(e)});var rt;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(rt||(rt={}));const Do=bi.create,Qj=yl.create;xl.create;const fq=kp.create;Jc.create;const Xj=pb.create;ro.create;const uu=Ci.create,mq=En.create,pq=Tp.create;Ep.create;vl.create;const gq=Pp.create,yq=yb.create,xq=Qc.create;Mp.create;Ka.create;ed.create;const Xl={string:n=>bi.create({...n,coerce:!0}),number:n=>yl.create({...n,coerce:!0}),boolean:n=>kp.create({...n,coerce:!0}),bigint:n=>xl.create({...n,coerce:!0}),date:n=>Jc.create({...n,coerce:!0})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let vq,bq;function wq(){return{geminiUrl:vq,vertexUrl:bq}}function _q(n,e,t){var s,r,i;if(!(!((s=n.httpOptions)===null||s===void 0)&&s.baseUrl)){const o=wq();return n.vertexai?(r=o.vertexUrl)!==null&&r!==void 0?r:e:(i=o.geminiUrl)!==null&&i!==void 0?i:t}return n.httpOptions.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Th{}function st(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(s,r)=>{if(Object.prototype.hasOwnProperty.call(e,r)){const i=e[r];return i!=null?String(i):""}else throw new Error(`Key '${r}' not found in valueMap.`)})}function x(n,e,t){for(let i=0;i<e.length-1;i++){const o=e[i];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];x(h,e.slice(i+1),t[d])}else for(const d of c)x(d,e.slice(i+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];x(c[0],e.slice(i+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const s=e[e.length-1],r=n[s];if(r!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===r)return;if(typeof r=="object"&&typeof t=="object"&&r!==null&&t!==null)Object.assign(r,t);else throw new Error(`Cannot set value for an existing key. Key: ${s}`)}else n[s]=t}function y(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const s=e[t];if(s.endsWith("[]")){const r=s.slice(0,-2);if(r in n){const i=n[r];return Array.isArray(i)?i.map(o=>y(o,e.slice(t+1))):void 0}else return}else n=n[s]}return n}catch(t){if(t instanceof TypeError)return;throw t}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var eC;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(eC||(eC={}));var tC;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(tC||(tC={}));var nC;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(nC||(nC={}));var sC;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(sC||(sC={}));var rC;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(rC||(rC={}));var De;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(De||(De={}));var iC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(iC||(iC={}));var aC;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(aC||(aC={}));var oC;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(oC||(oC={}));var lC;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(lC||(lC={}));var cC;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(cC||(cC={}));var dC;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(dC||(dC={}));var uC;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(uC||(uC={}));var ah;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(ah||(ah={}));var hC;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(hC||(hC={}));var wb;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(wb||(wb={}));var fC;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(fC||(fC={}));var mC;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(mC||(mC={}));var pC;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(pC||(pC={}));var gC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(gC||(gC={}));var yC;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(yC||(yC={}));var xC;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(xC||(xC={}));var vC;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(vC||(vC={}));var bC;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(bC||(bC={}));var wC;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(wC||(wC={}));var _C;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(_C||(_C={}));var SC;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(SC||(SC={}));var NC;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(NC||(NC={}));var jC;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(jC||(jC={}));var CC;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(CC||(CC={}));var kC;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(kC||(kC={}));var TC;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(TC||(TC={}));var EC;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(EC||(EC={}));var PC;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(PC||(PC={}));var MC;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(MC||(MC={}));var DC;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(DC||(DC={}));var AC;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(AC||(AC={}));var IC;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(IC||(IC={}));var OC;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(OC||(OC={}));var Nc;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(Nc||(Nc={}));class qd{get text(){var e,t,s,r,i,o,l,c;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const f=[];for(const p of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[g,b]of Object.entries(p))g!=="text"&&g!=="thought"&&(b!==null||b!==void 0)&&f.push(g);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;h=!0,d+=p.text}}return f.length>0&&console.warn(`there are non-text parts ${f} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,s,r,i,o,l,c;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const f of(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[p,g]of Object.entries(f))p!=="inlineData"&&(g!==null||g!==void 0)&&h.push(p);f.inlineData&&typeof f.inlineData.data=="string"&&(d+=atob(f.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,s,r,i,o,l,c;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if((d==null?void 0:d.length)!==0)return d}get executableCode(){var e,t,s,r,i,o,l,c,d;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(f=>f.executableCode).map(f=>f.executableCode).filter(f=>f!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,s,r,i,o,l,c,d;if(((r=(s=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||s===void 0?void 0:s.parts)===null||r===void 0?void 0:r.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(l=(o=(i=this.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(f=>f.codeExecutionResult).map(f=>f.codeExecutionResult).filter(f=>f!==void 0);if((h==null?void 0:h.length)!==0)return(d=h==null?void 0:h[0])===null||d===void 0?void 0:d.output}}class RC{}class LC{}class Sq{}class Nq{}class FC{}class $C{}class zC{}class jq{}class UC{}class VC{}class BC{}class Cq{}class _b{constructor(e){const t={};for(const s of e.headers.entries())t[s[0]]=s[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class kq{}class Tq{}class Eq{get text(){var e,t,s;let r="",i=!1;const o=[];for(const l of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;i=!0,r+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),i?r:void 0}get data(){var e,t,s;let r="";const i=[];for(const o of(s=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&s!==void 0?s:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&i.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(r+=atob(o.inlineData.data))}return i.length>0&&console.warn(`there are non-data parts ${i} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),r.length>0?btoa(r):void 0}}class Pq{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function uD(n,e){const t=tn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function hD(n,e){return Array.isArray(e)?e.map(t=>Dp(n,t)):[Dp(n,e)]}function Dp(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function Mq(n,e){const t=Dp(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function Dq(n,e){const t=Dp(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function qC(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function fD(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>qC(n,t)):[qC(n,e)]}function Sb(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function HC(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function WC(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Os(n,e){if(e==null)throw new Error("ContentUnion is required");return Sb(e)?e:{role:"user",parts:fD(n,e)}}function mD(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const s=Os(n,t);return s.parts&&s.parts.length>0&&s.parts[0].text!==void 0?[s.parts[0].text]:[]});if(n.isVertexAI()){const t=Os(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Os(n,t)):[Os(n,e)]}function Wr(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(HC(e)||WC(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Os(n,e)]}const t=[],s=[],r=Sb(e[0]);for(const i of e){const o=Sb(i);if(o!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(i);else{if(HC(i)||WC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");s.push(i)}}return r||t.push({role:"user",parts:fD(n,s)}),t}const GC=xq(["string","number","integer","object","array","boolean","null"]),Aq=pq([GC,uu(GC)]);function Iq(n=!0){const e=yq(()=>{const t=mq({type:Aq.optional(),format:Do().optional(),title:Do().optional(),description:Do().optional(),default:Xj().optional(),items:e.optional(),minItems:Xl.string().optional(),maxItems:Xl.string().optional(),enum:uu(Xj()).optional(),properties:gq(Do(),e).optional(),required:uu(Do()).optional(),minProperties:Xl.string().optional(),maxProperties:Xl.string().optional(),propertyOrdering:uu(Do()).optional(),minimum:Qj().optional(),maximum:Qj().optional(),minLength:Xl.string().optional(),maxLength:Xl.string().optional(),pattern:Do().optional(),anyOf:uu(e).optional(),additionalProperties:fq().optional()});return n?t.strict():t});return e}function Oq(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(s=>s!=="null");if(t.length===1)e.type=Object.keys(De).includes(t[0].toUpperCase())?De[t[0].toUpperCase()]:De.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const s of t)e.anyOf.push({type:Object.keys(De).includes(s.toUpperCase())?De[s.toUpperCase()]:De.TYPE_UNSPECIFIED})}}function Eu(n){const e={},t=["items"],s=["anyOf"],r=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const i=n.anyOf;i!=null&&i.length==2&&(i[0].type==="null"?(e.nullable=!0,n=i[1]):i[1].type==="null"&&(e.nullable=!0,n=i[0])),n.type instanceof Array&&Oq(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(De).includes(l.toUpperCase())?l.toUpperCase():De.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Eu(l);else if(s.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(Eu(d))}e[o]=c}else if(r.includes(o)){const c={};for(const[d,h]of Object.entries(l))c[d]=Eu(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function Ap(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=Iq().parse(e);return Eu(t)}else return Eu(e)}function pD(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function gD(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function kg(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Ap(n,t.parameters)),t.response&&(t.response=Ap(n,t.response));return e}function Tg(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const s of e)t.push(s);return t}function Rq(n,e,t,s=1){const r=!e.startsWith(`${t}/`)&&e.split("/").length===s;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:r?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:r?`${t}/${e}`:e}function xo(n,e){if(typeof e!="string")throw new Error("name must be a string");return Rq(n,e,"cachedContents")}function yD(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function vo(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function Lq(n){return n!=null&&typeof n=="object"&&"name"in n}function Fq(n){return n!=null&&typeof n=="object"&&"video"in n}function $q(n){return n!=null&&typeof n=="object"&&"uri"in n}function xD(n,e){var t;let s;if(Lq(e)&&(s=e.name),!($q(e)&&(s=e.uri,s===void 0))&&!(Fq(e)&&(s=(t=e.video)===null||t===void 0?void 0:t.uri,s===void 0))){if(typeof e=="string"&&(s=e),s===void 0)throw new Error("Could not extract file name from the provided input.");if(s.startsWith("https://")){const i=s.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${s}`);s=i[0]}else s.startsWith("files/")&&(s=s.split("files/")[1]);return s}}function vD(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function bD(n,e){for(const t of["models","tunedModels","publisherModels"])if(zq(e,t))return e[t];return[]}function zq(n,e){return n!==null&&typeof n=="object"&&e in n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Uq(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function Vq(n,e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function Bq(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],Uq(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],Vq(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function YC(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Bq(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function qq(n,e){const t={},s=y(e,["behavior"]);s!=null&&x(t,["behavior"],s);const r=y(e,["description"]);r!=null&&x(t,["description"],r);const i=y(e,["name"]);i!=null&&x(t,["name"],i);const o=y(e,["parameters"]);o!=null&&x(t,["parameters"],o);const l=y(e,["response"]);return l!=null&&x(t,["response"],l),t}function Hq(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function Wq(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],Hq(n,s)),t}function Gq(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function Yq(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],Gq(n,s)),t}function Zq(){return{}}function Kq(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>qq(n,d))),x(t,["functionDeclarations"],c)}if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=y(e,["googleSearch"]);r!=null&&x(t,["googleSearch"],Wq(n,r));const i=y(e,["googleSearchRetrieval"]);if(i!=null&&x(t,["googleSearchRetrieval"],Yq(n,i)),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(y(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");y(e,["urlContext"])!=null&&x(t,["urlContext"],Zq());const l=y(e,["codeExecution"]);return l!=null&&x(t,["codeExecution"],l),t}function Jq(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["allowedFunctionNames"]);return r!=null&&x(t,["allowedFunctionNames"],r),t}function Qq(n,e){const t={},s=y(e,["latitude"]);s!=null&&x(t,["latitude"],s);const r=y(e,["longitude"]);return r!=null&&x(t,["longitude"],r),t}function Xq(n,e){const t={},s=y(e,["latLng"]);return s!=null&&x(t,["latLng"],Qq(n,s)),t}function e8(n,e){const t={},s=y(e,["functionCallingConfig"]);s!=null&&x(t,["functionCallingConfig"],Jq(n,s));const r=y(e,["retrievalConfig"]);return r!=null&&x(t,["retrievalConfig"],Xq(n,r)),t}function t8(n,e,t){const s={},r=y(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const i=y(e,["expireTime"]);t!==void 0&&i!=null&&x(t,["expireTime"],i);const o=y(e,["displayName"]);t!==void 0&&o!=null&&x(t,["displayName"],o);const l=y(e,["contents"]);if(t!==void 0&&l!=null){let f=Wr(n,l);Array.isArray(f)&&(f=f.map(p=>YC(n,p))),x(t,["contents"],f)}const c=y(e,["systemInstruction"]);t!==void 0&&c!=null&&x(t,["systemInstruction"],YC(n,Os(n,c)));const d=y(e,["tools"]);if(t!==void 0&&d!=null){let f=d;Array.isArray(f)&&(f=f.map(p=>Kq(n,p))),x(t,["tools"],f)}const h=y(e,["toolConfig"]);if(t!==void 0&&h!=null&&x(t,["toolConfig"],e8(n,h)),y(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return s}function n8(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["model"],uD(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],t8(n,r,t)),t}function s8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function r8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function i8(n,e,t){const s={},r=y(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const i=y(e,["expireTime"]);return t!==void 0&&i!=null&&x(t,["expireTime"],i),s}function a8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],i8(n,r,t)),t}function o8(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);return t!==void 0&&i!=null&&x(t,["_query","pageToken"],i),s}function l8(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],o8(n,s,t)),t}function c8(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function d8(n,e){const t={},s=y(e,["displayName"]);s!=null&&x(t,["displayName"],s);const r=y(e,["data"]);r!=null&&x(t,["data"],r);const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function u8(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],c8(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],d8(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function ZC(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>u8(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function h8(n,e){const t={};if(y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=y(e,["description"]);s!=null&&x(t,["description"],s);const r=y(e,["name"]);r!=null&&x(t,["name"],r);const i=y(e,["parameters"]);i!=null&&x(t,["parameters"],i);const o=y(e,["response"]);return o!=null&&x(t,["response"],o),t}function f8(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function m8(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],f8(n,s)),t}function p8(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function g8(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],p8(n,s)),t}function y8(){return{}}function x8(n,e){const t={},s=y(e,["apiKeyString"]);return s!=null&&x(t,["apiKeyString"],s),t}function v8(n,e){const t={},s=y(e,["apiKeyConfig"]);s!=null&&x(t,["apiKeyConfig"],x8(n,s));const r=y(e,["authType"]);r!=null&&x(t,["authType"],r);const i=y(e,["googleServiceAccountConfig"]);i!=null&&x(t,["googleServiceAccountConfig"],i);const o=y(e,["httpBasicAuthConfig"]);o!=null&&x(t,["httpBasicAuthConfig"],o);const l=y(e,["oauthConfig"]);l!=null&&x(t,["oauthConfig"],l);const c=y(e,["oidcConfig"]);return c!=null&&x(t,["oidcConfig"],c),t}function b8(n,e){const t={},s=y(e,["authConfig"]);return s!=null&&x(t,["authConfig"],v8(n,s)),t}function w8(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(f=>h8(n,f))),x(t,["functionDeclarations"],h)}const r=y(e,["retrieval"]);r!=null&&x(t,["retrieval"],r);const i=y(e,["googleSearch"]);i!=null&&x(t,["googleSearch"],m8(n,i));const o=y(e,["googleSearchRetrieval"]);o!=null&&x(t,["googleSearchRetrieval"],g8(n,o)),y(e,["enterpriseWebSearch"])!=null&&x(t,["enterpriseWebSearch"],y8());const c=y(e,["googleMaps"]);if(c!=null&&x(t,["googleMaps"],b8(n,c)),y(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=y(e,["codeExecution"]);return d!=null&&x(t,["codeExecution"],d),t}function _8(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["allowedFunctionNames"]);return r!=null&&x(t,["allowedFunctionNames"],r),t}function S8(n,e){const t={},s=y(e,["latitude"]);s!=null&&x(t,["latitude"],s);const r=y(e,["longitude"]);return r!=null&&x(t,["longitude"],r),t}function N8(n,e){const t={},s=y(e,["latLng"]);return s!=null&&x(t,["latLng"],S8(n,s)),t}function j8(n,e){const t={},s=y(e,["functionCallingConfig"]);s!=null&&x(t,["functionCallingConfig"],_8(n,s));const r=y(e,["retrievalConfig"]);return r!=null&&x(t,["retrievalConfig"],N8(n,r)),t}function C8(n,e,t){const s={},r=y(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const i=y(e,["expireTime"]);t!==void 0&&i!=null&&x(t,["expireTime"],i);const o=y(e,["displayName"]);t!==void 0&&o!=null&&x(t,["displayName"],o);const l=y(e,["contents"]);if(t!==void 0&&l!=null){let p=Wr(n,l);Array.isArray(p)&&(p=p.map(g=>ZC(n,g))),x(t,["contents"],p)}const c=y(e,["systemInstruction"]);t!==void 0&&c!=null&&x(t,["systemInstruction"],ZC(n,Os(n,c)));const d=y(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(g=>w8(n,g))),x(t,["tools"],p)}const h=y(e,["toolConfig"]);t!==void 0&&h!=null&&x(t,["toolConfig"],j8(n,h));const f=y(e,["kmsKeyName"]);return t!==void 0&&f!=null&&x(t,["encryption_spec","kmsKeyName"],f),s}function k8(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["model"],uD(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],C8(n,r,t)),t}function T8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function E8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function P8(n,e,t){const s={},r=y(e,["ttl"]);t!==void 0&&r!=null&&x(t,["ttl"],r);const i=y(e,["expireTime"]);return t!==void 0&&i!=null&&x(t,["expireTime"],i),s}function M8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],xo(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],P8(n,r,t)),t}function D8(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);return t!==void 0&&i!=null&&x(t,["_query","pageToken"],i),s}function A8(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],D8(n,s,t)),t}function Sm(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["model"]);i!=null&&x(t,["model"],i);const o=y(e,["createTime"]);o!=null&&x(t,["createTime"],o);const l=y(e,["updateTime"]);l!=null&&x(t,["updateTime"],l);const c=y(e,["expireTime"]);c!=null&&x(t,["expireTime"],c);const d=y(e,["usageMetadata"]);return d!=null&&x(t,["usageMetadata"],d),t}function I8(){return{}}function O8(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["cachedContents"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Sm(n,o))),x(t,["cachedContents"],i)}return t}function Nm(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["model"]);i!=null&&x(t,["model"],i);const o=y(e,["createTime"]);o!=null&&x(t,["createTime"],o);const l=y(e,["updateTime"]);l!=null&&x(t,["updateTime"],l);const c=y(e,["expireTime"]);c!=null&&x(t,["expireTime"],c);const d=y(e,["usageMetadata"]);return d!=null&&x(t,["usageMetadata"],d),t}function R8(){return{}}function L8(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["cachedContents"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Nm(n,o))),x(t,["cachedContents"],i)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var td;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(td||(td={}));class Eg{constructor(e,t,s,r){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,s,r)}init(e,t,s){var r,i;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};s?typeof s=="object"?o=Object.assign({},s):o=s:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(i=(r=o.config)===null||r===void 0?void 0:r.pageSize)!==null&&i!==void 0?i:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class F8 extends Th{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eg(td.PAGED_ITEM_CACHED_CONTENTS,s=>this.listInternal(s),await this.listInternal(t),t)}async create(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=k8(this.apiClient,e);return l=st("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>Nm(this.apiClient,h))}else{const d=n8(this.apiClient,e);return l=st("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Sm(this.apiClient,h))}}async get(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=T8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>Nm(this.apiClient,h))}else{const d=s8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Sm(this.apiClient,h))}}async delete(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=E8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(()=>{const h=R8(),f=new VC;return Object.assign(f,h),f})}else{const d=r8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(()=>{const h=I8(),f=new VC;return Object.assign(f,h),f})}}async update(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=M8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>Nm(this.apiClient,h))}else{const d=a8(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Sm(this.apiClient,h))}}async listInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=A8(this.apiClient,e);return l=st("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=L8(this.apiClient,h),p=new BC;return Object.assign(p,f),p})}else{const d=l8(this.apiClient,e);return l=st("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=O8(this.apiClient,h),p=new BC;return Object.assign(p,f),p})}}}function KC(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],s=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&s>=n.length&&(n=void 0),{value:n&&n[s++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ln(n){return this instanceof ln?(this.v=n,this):new ln(n)}function Pu(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(n,e||[]),r,i=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),r[Symbol.asyncIterator]=function(){return this},r;function o(g){return function(b){return Promise.resolve(b).then(g,f)}}function l(g,b){s[g]&&(r[g]=function(v){return new Promise(function(_,N){i.push([g,v,_,N])>1||c(g,v)})},b&&(r[g]=b(r[g])))}function c(g,b){try{d(s[g](b))}catch(v){p(i[0][3],v)}}function d(g){g.value instanceof ln?Promise.resolve(g.value.v).then(h,f):p(i[0][2],g)}function h(g){c("next",g)}function f(g){c("throw",g)}function p(g,b){g(b),i.shift(),i.length&&c(i[0][0],i[0][1])}}function jm(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof KC=="function"?KC(n):n[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(i){t[i]=n[i]&&function(o){return new Promise(function(l,c){o=n[i](o),r(l,c,o.done,o.value)})}}function r(i,o,l,c){Promise.resolve(c).then(function(d){i({value:d,done:l})},o)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function $8(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:wD(t)}function wD(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function z8(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function JC(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let s=0;for(;s<t;)if(n[s].role==="user")e.push(n[s]),s++;else{const r=[];let i=!0;for(;s<t&&n[s].role==="model";)r.push(n[s]),i&&!wD(n[s])&&(i=!1),s++;i?e.push(...r):e.pop()}return e}class U8{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new V8(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class V8{constructor(e,t,s,r={},i=[]){this.apiClient=e,this.modelsModule=t,this.model=s,this.config=r,this.history=i,this.sendPromise=Promise.resolve(),z8(i)}async sendMessage(e){var t;await this.sendPromise;const s=Os(this.apiClient,e.message),r=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var i,o,l;const c=await r,d=(o=(i=c.candidates)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,f=this.getHistory(!0).length;let p=[];h!=null&&(p=(l=h.slice(f))!==null&&l!==void 0?l:[]);const g=d?[d]:[];this.recordHistory(s,g,p)})(),await this.sendPromise,r}async sendMessageStream(e){var t;await this.sendPromise;const s=Os(this.apiClient,e.message),r=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(s),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=r.then(()=>{}).catch(()=>{});const i=await r;return this.processStreamResponse(i,s)}getHistory(e=!1){const t=e?JC(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var s,r;return Pu(this,arguments,function*(){var o,l,c,d;const h=[];try{for(var f=!0,p=jm(e),g;g=yield ln(p.next()),o=g.done,!o;f=!0){d=g.value,f=!1;const b=d;if($8(b)){const v=(r=(s=b.candidates)===null||s===void 0?void 0:s[0])===null||r===void 0?void 0:r.content;v!==void 0&&h.push(v)}yield yield ln(b)}}catch(b){l={error:b}}finally{try{!f&&!o&&(c=p.return)&&(yield ln(c.call(p)))}finally{if(l)throw l.error}}this.recordHistory(t,h)})}recordHistory(e,t,s){let r=[];t.length>0&&t.every(i=>i.role!==void 0)?r=t:r.push({role:"model",parts:[]}),s&&s.length>0?this.history.push(...JC(s)):this.history.push(e),this.history.push(...r)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function B8(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);return t!==void 0&&i!=null&&x(t,["_query","pageToken"],i),s}function q8(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],B8(n,s,t)),t}function H8(n,e){const t={},s=y(e,["details"]);s!=null&&x(t,["details"],s);const r=y(e,["message"]);r!=null&&x(t,["message"],r);const i=y(e,["code"]);return i!=null&&x(t,["code"],i),t}function W8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["mimeType"]);i!=null&&x(t,["mimeType"],i);const o=y(e,["sizeBytes"]);o!=null&&x(t,["sizeBytes"],o);const l=y(e,["createTime"]);l!=null&&x(t,["createTime"],l);const c=y(e,["expirationTime"]);c!=null&&x(t,["expirationTime"],c);const d=y(e,["updateTime"]);d!=null&&x(t,["updateTime"],d);const h=y(e,["sha256Hash"]);h!=null&&x(t,["sha256Hash"],h);const f=y(e,["uri"]);f!=null&&x(t,["uri"],f);const p=y(e,["downloadUri"]);p!=null&&x(t,["downloadUri"],p);const g=y(e,["state"]);g!=null&&x(t,["state"],g);const b=y(e,["source"]);b!=null&&x(t,["source"],b);const v=y(e,["videoMetadata"]);v!=null&&x(t,["videoMetadata"],v);const _=y(e,["error"]);return _!=null&&x(t,["error"],H8(n,_)),t}function G8(n,e){const t={},s=y(e,["file"]);s!=null&&x(t,["file"],W8(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function Y8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","file"],xD(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function Z8(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","file"],xD(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function K8(n,e){const t={},s=y(e,["details"]);s!=null&&x(t,["details"],s);const r=y(e,["message"]);r!=null&&x(t,["message"],r);const i=y(e,["code"]);return i!=null&&x(t,["code"],i),t}function Nb(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["mimeType"]);i!=null&&x(t,["mimeType"],i);const o=y(e,["sizeBytes"]);o!=null&&x(t,["sizeBytes"],o);const l=y(e,["createTime"]);l!=null&&x(t,["createTime"],l);const c=y(e,["expirationTime"]);c!=null&&x(t,["expirationTime"],c);const d=y(e,["updateTime"]);d!=null&&x(t,["updateTime"],d);const h=y(e,["sha256Hash"]);h!=null&&x(t,["sha256Hash"],h);const f=y(e,["uri"]);f!=null&&x(t,["uri"],f);const p=y(e,["downloadUri"]);p!=null&&x(t,["downloadUri"],p);const g=y(e,["state"]);g!=null&&x(t,["state"],g);const b=y(e,["source"]);b!=null&&x(t,["source"],b);const v=y(e,["videoMetadata"]);v!=null&&x(t,["videoMetadata"],v);const _=y(e,["error"]);return _!=null&&x(t,["error"],K8(n,_)),t}function J8(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["files"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Nb(n,o))),x(t,["files"],i)}return t}function Q8(){return{}}function X8(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let eH=class extends Th{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new Eg(td.PAGED_ITEM_FILES,s=>this.listInternal(s),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>Nb(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=q8(this.apiClient,e);return i=st("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>{const d=J8(this.apiClient,c),h=new Cq;return Object.assign(h,d),h})}}async createInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=G8(this.apiClient,e);return i=st("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(()=>{const c=Q8(),d=new kq;return Object.assign(d,c),d})}}async get(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Y8(this.apiClient,e);return i=st("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>Nb(this.apiClient,c))}}async delete(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=Z8(this.apiClient,e);return i=st("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(()=>{const c=X8(),d=new Tq;return Object.assign(d,c),d})}}};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function tH(n,e){const t={},s=y(e,["voiceName"]);return s!=null&&x(t,["voiceName"],s),t}function nH(n,e){const t={},s=y(e,["voiceName"]);return s!=null&&x(t,["voiceName"],s),t}function _D(n,e){const t={},s=y(e,["prebuiltVoiceConfig"]);return s!=null&&x(t,["prebuiltVoiceConfig"],tH(n,s)),t}function sH(n,e){const t={},s=y(e,["prebuiltVoiceConfig"]);return s!=null&&x(t,["prebuiltVoiceConfig"],nH(n,s)),t}function rH(n,e){const t={},s=y(e,["speaker"]);s!=null&&x(t,["speaker"],s);const r=y(e,["voiceConfig"]);return r!=null&&x(t,["voiceConfig"],_D(n,r)),t}function iH(n,e){const t={},s=y(e,["speakerVoiceConfigs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>rH(n,i))),x(t,["speakerVoiceConfigs"],r)}return t}function aH(n,e){const t={},s=y(e,["voiceConfig"]);s!=null&&x(t,["voiceConfig"],_D(n,s));const r=y(e,["multiSpeakerVoiceConfig"]);r!=null&&x(t,["multiSpeakerVoiceConfig"],iH(n,r));const i=y(e,["languageCode"]);return i!=null&&x(t,["languageCode"],i),t}function oH(n,e){const t={},s=y(e,["voiceConfig"]);if(s!=null&&x(t,["voiceConfig"],sH(n,s)),y(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=y(e,["languageCode"]);return r!=null&&x(t,["languageCode"],r),t}function lH(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function cH(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function dH(n,e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function uH(n,e){const t={},s=y(e,["displayName"]);s!=null&&x(t,["displayName"],s);const r=y(e,["data"]);r!=null&&x(t,["data"],r);const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function hH(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],lH(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],dH(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function fH(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],cH(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],uH(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function mH(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>hH(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function pH(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>fH(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function gH(n,e){const t={},s=y(e,["behavior"]);s!=null&&x(t,["behavior"],s);const r=y(e,["description"]);r!=null&&x(t,["description"],r);const i=y(e,["name"]);i!=null&&x(t,["name"],i);const o=y(e,["parameters"]);o!=null&&x(t,["parameters"],o);const l=y(e,["response"]);return l!=null&&x(t,["response"],l),t}function yH(n,e){const t={};if(y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=y(e,["description"]);s!=null&&x(t,["description"],s);const r=y(e,["name"]);r!=null&&x(t,["name"],r);const i=y(e,["parameters"]);i!=null&&x(t,["parameters"],i);const o=y(e,["response"]);return o!=null&&x(t,["response"],o),t}function xH(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function vH(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function bH(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],xH(n,s)),t}function wH(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],vH(n,s)),t}function _H(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function SH(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function NH(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],_H(n,s)),t}function jH(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],SH(n,s)),t}function CH(){return{}}function kH(n,e){const t={},s=y(e,["apiKeyString"]);return s!=null&&x(t,["apiKeyString"],s),t}function TH(n,e){const t={},s=y(e,["apiKeyConfig"]);s!=null&&x(t,["apiKeyConfig"],kH(n,s));const r=y(e,["authType"]);r!=null&&x(t,["authType"],r);const i=y(e,["googleServiceAccountConfig"]);i!=null&&x(t,["googleServiceAccountConfig"],i);const o=y(e,["httpBasicAuthConfig"]);o!=null&&x(t,["httpBasicAuthConfig"],o);const l=y(e,["oauthConfig"]);l!=null&&x(t,["oauthConfig"],l);const c=y(e,["oidcConfig"]);return c!=null&&x(t,["oidcConfig"],c),t}function EH(n,e){const t={},s=y(e,["authConfig"]);return s!=null&&x(t,["authConfig"],TH(n,s)),t}function PH(){return{}}function MH(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>gH(n,d))),x(t,["functionDeclarations"],c)}if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=y(e,["googleSearch"]);r!=null&&x(t,["googleSearch"],bH(n,r));const i=y(e,["googleSearchRetrieval"]);if(i!=null&&x(t,["googleSearchRetrieval"],NH(n,i)),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(y(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");y(e,["urlContext"])!=null&&x(t,["urlContext"],PH());const l=y(e,["codeExecution"]);return l!=null&&x(t,["codeExecution"],l),t}function DH(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(f=>yH(n,f))),x(t,["functionDeclarations"],h)}const r=y(e,["retrieval"]);r!=null&&x(t,["retrieval"],r);const i=y(e,["googleSearch"]);i!=null&&x(t,["googleSearch"],wH(n,i));const o=y(e,["googleSearchRetrieval"]);o!=null&&x(t,["googleSearchRetrieval"],jH(n,o)),y(e,["enterpriseWebSearch"])!=null&&x(t,["enterpriseWebSearch"],CH());const c=y(e,["googleMaps"]);if(c!=null&&x(t,["googleMaps"],EH(n,c)),y(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=y(e,["codeExecution"]);return d!=null&&x(t,["codeExecution"],d),t}function AH(n,e){const t={},s=y(e,["handle"]);if(s!=null&&x(t,["handle"],s),y(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function IH(n,e){const t={},s=y(e,["handle"]);s!=null&&x(t,["handle"],s);const r=y(e,["transparent"]);return r!=null&&x(t,["transparent"],r),t}function QC(){return{}}function XC(){return{}}function OH(n,e){const t={},s=y(e,["disabled"]);s!=null&&x(t,["disabled"],s);const r=y(e,["startOfSpeechSensitivity"]);r!=null&&x(t,["startOfSpeechSensitivity"],r);const i=y(e,["endOfSpeechSensitivity"]);i!=null&&x(t,["endOfSpeechSensitivity"],i);const o=y(e,["prefixPaddingMs"]);o!=null&&x(t,["prefixPaddingMs"],o);const l=y(e,["silenceDurationMs"]);return l!=null&&x(t,["silenceDurationMs"],l),t}function RH(n,e){const t={},s=y(e,["disabled"]);s!=null&&x(t,["disabled"],s);const r=y(e,["startOfSpeechSensitivity"]);r!=null&&x(t,["startOfSpeechSensitivity"],r);const i=y(e,["endOfSpeechSensitivity"]);i!=null&&x(t,["endOfSpeechSensitivity"],i);const o=y(e,["prefixPaddingMs"]);o!=null&&x(t,["prefixPaddingMs"],o);const l=y(e,["silenceDurationMs"]);return l!=null&&x(t,["silenceDurationMs"],l),t}function LH(n,e){const t={},s=y(e,["automaticActivityDetection"]);s!=null&&x(t,["automaticActivityDetection"],OH(n,s));const r=y(e,["activityHandling"]);r!=null&&x(t,["activityHandling"],r);const i=y(e,["turnCoverage"]);return i!=null&&x(t,["turnCoverage"],i),t}function FH(n,e){const t={},s=y(e,["automaticActivityDetection"]);s!=null&&x(t,["automaticActivityDetection"],RH(n,s));const r=y(e,["activityHandling"]);r!=null&&x(t,["activityHandling"],r);const i=y(e,["turnCoverage"]);return i!=null&&x(t,["turnCoverage"],i),t}function $H(n,e){const t={},s=y(e,["targetTokens"]);return s!=null&&x(t,["targetTokens"],s),t}function zH(n,e){const t={},s=y(e,["targetTokens"]);return s!=null&&x(t,["targetTokens"],s),t}function UH(n,e){const t={},s=y(e,["triggerTokens"]);s!=null&&x(t,["triggerTokens"],s);const r=y(e,["slidingWindow"]);return r!=null&&x(t,["slidingWindow"],$H(n,r)),t}function VH(n,e){const t={},s=y(e,["triggerTokens"]);s!=null&&x(t,["triggerTokens"],s);const r=y(e,["slidingWindow"]);return r!=null&&x(t,["slidingWindow"],zH(n,r)),t}function BH(n,e){const t={},s=y(e,["proactiveAudio"]);return s!=null&&x(t,["proactiveAudio"],s),t}function qH(n,e){const t={},s=y(e,["proactiveAudio"]);return s!=null&&x(t,["proactiveAudio"],s),t}function HH(n,e,t){const s={},r=y(e,["generationConfig"]);t!==void 0&&r!=null&&x(t,["setup","generationConfig"],r);const i=y(e,["responseModalities"]);t!==void 0&&i!=null&&x(t,["setup","generationConfig","responseModalities"],i);const o=y(e,["temperature"]);t!==void 0&&o!=null&&x(t,["setup","generationConfig","temperature"],o);const l=y(e,["topP"]);t!==void 0&&l!=null&&x(t,["setup","generationConfig","topP"],l);const c=y(e,["topK"]);t!==void 0&&c!=null&&x(t,["setup","generationConfig","topK"],c);const d=y(e,["maxOutputTokens"]);t!==void 0&&d!=null&&x(t,["setup","generationConfig","maxOutputTokens"],d);const h=y(e,["mediaResolution"]);t!==void 0&&h!=null&&x(t,["setup","generationConfig","mediaResolution"],h);const f=y(e,["seed"]);t!==void 0&&f!=null&&x(t,["setup","generationConfig","seed"],f);const p=y(e,["speechConfig"]);t!==void 0&&p!=null&&x(t,["setup","generationConfig","speechConfig"],aH(n,gD(n,p)));const g=y(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&x(t,["setup","generationConfig","enableAffectiveDialog"],g);const b=y(e,["systemInstruction"]);t!==void 0&&b!=null&&x(t,["setup","systemInstruction"],mH(n,Os(n,b)));const v=y(e,["tools"]);if(t!==void 0&&v!=null){let E=Tg(n,v);Array.isArray(E)&&(E=E.map(M=>MH(n,kg(n,M)))),x(t,["setup","tools"],E)}const _=y(e,["sessionResumption"]);t!==void 0&&_!=null&&x(t,["setup","sessionResumption"],AH(n,_));const N=y(e,["inputAudioTranscription"]);t!==void 0&&N!=null&&x(t,["setup","inputAudioTranscription"],QC());const j=y(e,["outputAudioTranscription"]);t!==void 0&&j!=null&&x(t,["setup","outputAudioTranscription"],QC());const k=y(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&x(t,["setup","realtimeInputConfig"],LH(n,k));const S=y(e,["contextWindowCompression"]);t!==void 0&&S!=null&&x(t,["setup","contextWindowCompression"],UH(n,S));const P=y(e,["proactivity"]);return t!==void 0&&P!=null&&x(t,["setup","proactivity"],BH(n,P)),s}function WH(n,e,t){const s={},r=y(e,["generationConfig"]);t!==void 0&&r!=null&&x(t,["setup","generationConfig"],r);const i=y(e,["responseModalities"]);t!==void 0&&i!=null&&x(t,["setup","generationConfig","responseModalities"],i);const o=y(e,["temperature"]);t!==void 0&&o!=null&&x(t,["setup","generationConfig","temperature"],o);const l=y(e,["topP"]);t!==void 0&&l!=null&&x(t,["setup","generationConfig","topP"],l);const c=y(e,["topK"]);t!==void 0&&c!=null&&x(t,["setup","generationConfig","topK"],c);const d=y(e,["maxOutputTokens"]);t!==void 0&&d!=null&&x(t,["setup","generationConfig","maxOutputTokens"],d);const h=y(e,["mediaResolution"]);t!==void 0&&h!=null&&x(t,["setup","generationConfig","mediaResolution"],h);const f=y(e,["seed"]);t!==void 0&&f!=null&&x(t,["setup","generationConfig","seed"],f);const p=y(e,["speechConfig"]);t!==void 0&&p!=null&&x(t,["setup","generationConfig","speechConfig"],oH(n,gD(n,p)));const g=y(e,["enableAffectiveDialog"]);t!==void 0&&g!=null&&x(t,["setup","generationConfig","enableAffectiveDialog"],g);const b=y(e,["systemInstruction"]);t!==void 0&&b!=null&&x(t,["setup","systemInstruction"],pH(n,Os(n,b)));const v=y(e,["tools"]);if(t!==void 0&&v!=null){let E=Tg(n,v);Array.isArray(E)&&(E=E.map(M=>DH(n,kg(n,M)))),x(t,["setup","tools"],E)}const _=y(e,["sessionResumption"]);t!==void 0&&_!=null&&x(t,["setup","sessionResumption"],IH(n,_));const N=y(e,["inputAudioTranscription"]);t!==void 0&&N!=null&&x(t,["setup","inputAudioTranscription"],XC());const j=y(e,["outputAudioTranscription"]);t!==void 0&&j!=null&&x(t,["setup","outputAudioTranscription"],XC());const k=y(e,["realtimeInputConfig"]);t!==void 0&&k!=null&&x(t,["setup","realtimeInputConfig"],FH(n,k));const S=y(e,["contextWindowCompression"]);t!==void 0&&S!=null&&x(t,["setup","contextWindowCompression"],VH(n,S));const P=y(e,["proactivity"]);return t!==void 0&&P!=null&&x(t,["setup","proactivity"],qH(n,P)),s}function GH(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["setup","model"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],HH(n,r,t)),t}function YH(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["setup","model"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],WH(n,r,t)),t}function ZH(){return{}}function KH(){return{}}function JH(){return{}}function QH(){return{}}function XH(n,e){const t={},s=y(e,["media"]);s!=null&&x(t,["mediaChunks"],hD(n,s));const r=y(e,["audio"]);r!=null&&x(t,["audio"],Dq(n,r));const i=y(e,["audioStreamEnd"]);i!=null&&x(t,["audioStreamEnd"],i);const o=y(e,["video"]);o!=null&&x(t,["video"],Mq(n,o));const l=y(e,["text"]);return l!=null&&x(t,["text"],l),y(e,["activityStart"])!=null&&x(t,["activityStart"],ZH()),y(e,["activityEnd"])!=null&&x(t,["activityEnd"],JH()),t}function eW(n,e){const t={},s=y(e,["media"]);if(s!=null&&x(t,["mediaChunks"],hD(n,s)),y(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const r=y(e,["audioStreamEnd"]);if(r!=null&&x(t,["audioStreamEnd"],r),y(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(y(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return y(e,["activityStart"])!=null&&x(t,["activityStart"],KH()),y(e,["activityEnd"])!=null&&x(t,["activityEnd"],QH()),t}function SD(n,e){const t={},s=y(e,["text"]);s!=null&&x(t,["text"],s);const r=y(e,["weight"]);return r!=null&&x(t,["weight"],r),t}function tW(n,e){const t={},s=y(e,["weightedPrompts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>SD(n,i))),x(t,["weightedPrompts"],r)}return t}function ND(n,e){const t={},s=y(e,["temperature"]);s!=null&&x(t,["temperature"],s);const r=y(e,["topK"]);r!=null&&x(t,["topK"],r);const i=y(e,["seed"]);i!=null&&x(t,["seed"],i);const o=y(e,["guidance"]);o!=null&&x(t,["guidance"],o);const l=y(e,["bpm"]);l!=null&&x(t,["bpm"],l);const c=y(e,["density"]);c!=null&&x(t,["density"],c);const d=y(e,["brightness"]);d!=null&&x(t,["brightness"],d);const h=y(e,["scale"]);h!=null&&x(t,["scale"],h);const f=y(e,["muteBass"]);f!=null&&x(t,["muteBass"],f);const p=y(e,["muteDrums"]);p!=null&&x(t,["muteDrums"],p);const g=y(e,["onlyBassAndDrums"]);g!=null&&x(t,["onlyBassAndDrums"],g);const b=y(e,["musicGenerationMode"]);return b!=null&&x(t,["musicGenerationMode"],b),t}function nW(n,e){const t={},s=y(e,["musicGenerationConfig"]);return s!=null&&x(t,["musicGenerationConfig"],ND(n,s)),t}function jD(n,e){const t={},s=y(e,["model"]);return s!=null&&x(t,["model"],s),t}function CD(n,e){const t={},s=y(e,["weightedPrompts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>SD(n,i))),x(t,["weightedPrompts"],r)}return t}function jb(n,e){const t={},s=y(e,["setup"]);s!=null&&x(t,["setup"],jD(n,s));const r=y(e,["clientContent"]);r!=null&&x(t,["clientContent"],CD(n,r));const i=y(e,["musicGenerationConfig"]);i!=null&&x(t,["musicGenerationConfig"],ND(n,i));const o=y(e,["playbackControl"]);return o!=null&&x(t,["playbackControl"],o),t}function sW(){return{}}function rW(){return{}}function iW(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function aW(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function oW(n,e){const t={},s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function lW(n,e){const t={},s=y(e,["displayName"]);s!=null&&x(t,["displayName"],s);const r=y(e,["data"]);r!=null&&x(t,["data"],r);const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function cW(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],iW(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],oW(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function dW(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],aW(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],lW(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function uW(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>cW(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function hW(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>dW(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function ek(n,e){const t={},s=y(e,["text"]);s!=null&&x(t,["text"],s);const r=y(e,["finished"]);return r!=null&&x(t,["finished"],r),t}function tk(n,e){const t={},s=y(e,["text"]);s!=null&&x(t,["text"],s);const r=y(e,["finished"]);return r!=null&&x(t,["finished"],r),t}function fW(n,e){const t={},s=y(e,["retrievedUrl"]);s!=null&&x(t,["retrievedUrl"],s);const r=y(e,["urlRetrievalStatus"]);return r!=null&&x(t,["urlRetrievalStatus"],r),t}function mW(n,e){const t={},s=y(e,["urlMetadata"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>fW(n,i))),x(t,["urlMetadata"],r)}return t}function pW(n,e){const t={},s=y(e,["modelTurn"]);s!=null&&x(t,["modelTurn"],uW(n,s));const r=y(e,["turnComplete"]);r!=null&&x(t,["turnComplete"],r);const i=y(e,["interrupted"]);i!=null&&x(t,["interrupted"],i);const o=y(e,["groundingMetadata"]);o!=null&&x(t,["groundingMetadata"],o);const l=y(e,["generationComplete"]);l!=null&&x(t,["generationComplete"],l);const c=y(e,["inputTranscription"]);c!=null&&x(t,["inputTranscription"],ek(n,c));const d=y(e,["outputTranscription"]);d!=null&&x(t,["outputTranscription"],ek(n,d));const h=y(e,["urlContextMetadata"]);return h!=null&&x(t,["urlContextMetadata"],mW(n,h)),t}function gW(n,e){const t={},s=y(e,["modelTurn"]);s!=null&&x(t,["modelTurn"],hW(n,s));const r=y(e,["turnComplete"]);r!=null&&x(t,["turnComplete"],r);const i=y(e,["interrupted"]);i!=null&&x(t,["interrupted"],i);const o=y(e,["groundingMetadata"]);o!=null&&x(t,["groundingMetadata"],o);const l=y(e,["generationComplete"]);l!=null&&x(t,["generationComplete"],l);const c=y(e,["inputTranscription"]);c!=null&&x(t,["inputTranscription"],tk(n,c));const d=y(e,["outputTranscription"]);return d!=null&&x(t,["outputTranscription"],tk(n,d)),t}function yW(n,e){const t={},s=y(e,["id"]);s!=null&&x(t,["id"],s);const r=y(e,["args"]);r!=null&&x(t,["args"],r);const i=y(e,["name"]);return i!=null&&x(t,["name"],i),t}function xW(n,e){const t={},s=y(e,["args"]);s!=null&&x(t,["args"],s);const r=y(e,["name"]);return r!=null&&x(t,["name"],r),t}function vW(n,e){const t={},s=y(e,["functionCalls"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>yW(n,i))),x(t,["functionCalls"],r)}return t}function bW(n,e){const t={},s=y(e,["functionCalls"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>xW(n,i))),x(t,["functionCalls"],r)}return t}function wW(n,e){const t={},s=y(e,["ids"]);return s!=null&&x(t,["ids"],s),t}function _W(n,e){const t={},s=y(e,["ids"]);return s!=null&&x(t,["ids"],s),t}function If(n,e){const t={},s=y(e,["modality"]);s!=null&&x(t,["modality"],s);const r=y(e,["tokenCount"]);return r!=null&&x(t,["tokenCount"],r),t}function Of(n,e){const t={},s=y(e,["modality"]);s!=null&&x(t,["modality"],s);const r=y(e,["tokenCount"]);return r!=null&&x(t,["tokenCount"],r),t}function SW(n,e){const t={},s=y(e,["promptTokenCount"]);s!=null&&x(t,["promptTokenCount"],s);const r=y(e,["cachedContentTokenCount"]);r!=null&&x(t,["cachedContentTokenCount"],r);const i=y(e,["responseTokenCount"]);i!=null&&x(t,["responseTokenCount"],i);const o=y(e,["toolUsePromptTokenCount"]);o!=null&&x(t,["toolUsePromptTokenCount"],o);const l=y(e,["thoughtsTokenCount"]);l!=null&&x(t,["thoughtsTokenCount"],l);const c=y(e,["totalTokenCount"]);c!=null&&x(t,["totalTokenCount"],c);const d=y(e,["promptTokensDetails"]);if(d!=null){let g=d;Array.isArray(g)&&(g=g.map(b=>If(n,b))),x(t,["promptTokensDetails"],g)}const h=y(e,["cacheTokensDetails"]);if(h!=null){let g=h;Array.isArray(g)&&(g=g.map(b=>If(n,b))),x(t,["cacheTokensDetails"],g)}const f=y(e,["responseTokensDetails"]);if(f!=null){let g=f;Array.isArray(g)&&(g=g.map(b=>If(n,b))),x(t,["responseTokensDetails"],g)}const p=y(e,["toolUsePromptTokensDetails"]);if(p!=null){let g=p;Array.isArray(g)&&(g=g.map(b=>If(n,b))),x(t,["toolUsePromptTokensDetails"],g)}return t}function NW(n,e){const t={},s=y(e,["promptTokenCount"]);s!=null&&x(t,["promptTokenCount"],s);const r=y(e,["cachedContentTokenCount"]);r!=null&&x(t,["cachedContentTokenCount"],r);const i=y(e,["candidatesTokenCount"]);i!=null&&x(t,["responseTokenCount"],i);const o=y(e,["toolUsePromptTokenCount"]);o!=null&&x(t,["toolUsePromptTokenCount"],o);const l=y(e,["thoughtsTokenCount"]);l!=null&&x(t,["thoughtsTokenCount"],l);const c=y(e,["totalTokenCount"]);c!=null&&x(t,["totalTokenCount"],c);const d=y(e,["promptTokensDetails"]);if(d!=null){let b=d;Array.isArray(b)&&(b=b.map(v=>Of(n,v))),x(t,["promptTokensDetails"],b)}const h=y(e,["cacheTokensDetails"]);if(h!=null){let b=h;Array.isArray(b)&&(b=b.map(v=>Of(n,v))),x(t,["cacheTokensDetails"],b)}const f=y(e,["candidatesTokensDetails"]);if(f!=null){let b=f;Array.isArray(b)&&(b=b.map(v=>Of(n,v))),x(t,["responseTokensDetails"],b)}const p=y(e,["toolUsePromptTokensDetails"]);if(p!=null){let b=p;Array.isArray(b)&&(b=b.map(v=>Of(n,v))),x(t,["toolUsePromptTokensDetails"],b)}const g=y(e,["trafficType"]);return g!=null&&x(t,["trafficType"],g),t}function jW(n,e){const t={},s=y(e,["timeLeft"]);return s!=null&&x(t,["timeLeft"],s),t}function CW(n,e){const t={},s=y(e,["timeLeft"]);return s!=null&&x(t,["timeLeft"],s),t}function kW(n,e){const t={},s=y(e,["newHandle"]);s!=null&&x(t,["newHandle"],s);const r=y(e,["resumable"]);r!=null&&x(t,["resumable"],r);const i=y(e,["lastConsumedClientMessageIndex"]);return i!=null&&x(t,["lastConsumedClientMessageIndex"],i),t}function TW(n,e){const t={},s=y(e,["newHandle"]);s!=null&&x(t,["newHandle"],s);const r=y(e,["resumable"]);r!=null&&x(t,["resumable"],r);const i=y(e,["lastConsumedClientMessageIndex"]);return i!=null&&x(t,["lastConsumedClientMessageIndex"],i),t}function EW(n,e){const t={};y(e,["setupComplete"])!=null&&x(t,["setupComplete"],sW());const r=y(e,["serverContent"]);r!=null&&x(t,["serverContent"],pW(n,r));const i=y(e,["toolCall"]);i!=null&&x(t,["toolCall"],vW(n,i));const o=y(e,["toolCallCancellation"]);o!=null&&x(t,["toolCallCancellation"],wW(n,o));const l=y(e,["usageMetadata"]);l!=null&&x(t,["usageMetadata"],SW(n,l));const c=y(e,["goAway"]);c!=null&&x(t,["goAway"],jW(n,c));const d=y(e,["sessionResumptionUpdate"]);return d!=null&&x(t,["sessionResumptionUpdate"],kW(n,d)),t}function PW(n,e){const t={};y(e,["setupComplete"])!=null&&x(t,["setupComplete"],rW());const r=y(e,["serverContent"]);r!=null&&x(t,["serverContent"],gW(n,r));const i=y(e,["toolCall"]);i!=null&&x(t,["toolCall"],bW(n,i));const o=y(e,["toolCallCancellation"]);o!=null&&x(t,["toolCallCancellation"],_W(n,o));const l=y(e,["usageMetadata"]);l!=null&&x(t,["usageMetadata"],NW(n,l));const c=y(e,["goAway"]);c!=null&&x(t,["goAway"],CW(n,c));const d=y(e,["sessionResumptionUpdate"]);return d!=null&&x(t,["sessionResumptionUpdate"],TW(n,d)),t}function MW(){return{}}function DW(n,e){const t={},s=y(e,["text"]);s!=null&&x(t,["text"],s);const r=y(e,["weight"]);return r!=null&&x(t,["weight"],r),t}function AW(n,e){const t={},s=y(e,["weightedPrompts"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>DW(n,i))),x(t,["weightedPrompts"],r)}return t}function IW(n,e){const t={},s=y(e,["temperature"]);s!=null&&x(t,["temperature"],s);const r=y(e,["topK"]);r!=null&&x(t,["topK"],r);const i=y(e,["seed"]);i!=null&&x(t,["seed"],i);const o=y(e,["guidance"]);o!=null&&x(t,["guidance"],o);const l=y(e,["bpm"]);l!=null&&x(t,["bpm"],l);const c=y(e,["density"]);c!=null&&x(t,["density"],c);const d=y(e,["brightness"]);d!=null&&x(t,["brightness"],d);const h=y(e,["scale"]);h!=null&&x(t,["scale"],h);const f=y(e,["muteBass"]);f!=null&&x(t,["muteBass"],f);const p=y(e,["muteDrums"]);p!=null&&x(t,["muteDrums"],p);const g=y(e,["onlyBassAndDrums"]);g!=null&&x(t,["onlyBassAndDrums"],g);const b=y(e,["musicGenerationMode"]);return b!=null&&x(t,["musicGenerationMode"],b),t}function OW(n,e){const t={},s=y(e,["clientContent"]);s!=null&&x(t,["clientContent"],AW(n,s));const r=y(e,["musicGenerationConfig"]);return r!=null&&x(t,["musicGenerationConfig"],IW(n,r)),t}function RW(n,e){const t={},s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);r!=null&&x(t,["mimeType"],r);const i=y(e,["sourceMetadata"]);return i!=null&&x(t,["sourceMetadata"],OW(n,i)),t}function LW(n,e){const t={},s=y(e,["audioChunks"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>RW(n,i))),x(t,["audioChunks"],r)}return t}function FW(n,e){const t={},s=y(e,["text"]);s!=null&&x(t,["text"],s);const r=y(e,["filteredReason"]);return r!=null&&x(t,["filteredReason"],r),t}function $W(n,e){const t={};y(e,["setupComplete"])!=null&&x(t,["setupComplete"],MW());const r=y(e,["serverContent"]);r!=null&&x(t,["serverContent"],LW(n,r));const i=y(e,["filteredPrompt"]);return i!=null&&x(t,["filteredPrompt"],FW(n,i)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function zW(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function UW(n,e){const t={};if(y(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function VW(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],zW(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],UW(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function Pg(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>VW(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function BW(n,e){const t={};if(y(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const s=y(e,["category"]);s!=null&&x(t,["category"],s);const r=y(e,["threshold"]);return r!=null&&x(t,["threshold"],r),t}function qW(n,e){const t={},s=y(e,["behavior"]);s!=null&&x(t,["behavior"],s);const r=y(e,["description"]);r!=null&&x(t,["description"],r);const i=y(e,["name"]);i!=null&&x(t,["name"],i);const o=y(e,["parameters"]);o!=null&&x(t,["parameters"],o);const l=y(e,["response"]);return l!=null&&x(t,["response"],l),t}function HW(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function WW(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],HW(n,s)),t}function GW(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function YW(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],GW(n,s)),t}function ZW(){return{}}function KW(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let c=s;Array.isArray(c)&&(c=c.map(d=>qW(n,d))),x(t,["functionDeclarations"],c)}if(y(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=y(e,["googleSearch"]);r!=null&&x(t,["googleSearch"],WW(n,r));const i=y(e,["googleSearchRetrieval"]);if(i!=null&&x(t,["googleSearchRetrieval"],YW(n,i)),y(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(y(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");y(e,["urlContext"])!=null&&x(t,["urlContext"],ZW());const l=y(e,["codeExecution"]);return l!=null&&x(t,["codeExecution"],l),t}function JW(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["allowedFunctionNames"]);return r!=null&&x(t,["allowedFunctionNames"],r),t}function QW(n,e){const t={},s=y(e,["latitude"]);s!=null&&x(t,["latitude"],s);const r=y(e,["longitude"]);return r!=null&&x(t,["longitude"],r),t}function XW(n,e){const t={},s=y(e,["latLng"]);return s!=null&&x(t,["latLng"],QW(n,s)),t}function e7(n,e){const t={},s=y(e,["functionCallingConfig"]);s!=null&&x(t,["functionCallingConfig"],JW(n,s));const r=y(e,["retrievalConfig"]);return r!=null&&x(t,["retrievalConfig"],XW(n,r)),t}function t7(n,e){const t={},s=y(e,["voiceName"]);return s!=null&&x(t,["voiceName"],s),t}function kD(n,e){const t={},s=y(e,["prebuiltVoiceConfig"]);return s!=null&&x(t,["prebuiltVoiceConfig"],t7(n,s)),t}function n7(n,e){const t={},s=y(e,["speaker"]);s!=null&&x(t,["speaker"],s);const r=y(e,["voiceConfig"]);return r!=null&&x(t,["voiceConfig"],kD(n,r)),t}function s7(n,e){const t={},s=y(e,["speakerVoiceConfigs"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>n7(n,i))),x(t,["speakerVoiceConfigs"],r)}return t}function r7(n,e){const t={},s=y(e,["voiceConfig"]);s!=null&&x(t,["voiceConfig"],kD(n,s));const r=y(e,["multiSpeakerVoiceConfig"]);r!=null&&x(t,["multiSpeakerVoiceConfig"],s7(n,r));const i=y(e,["languageCode"]);return i!=null&&x(t,["languageCode"],i),t}function i7(n,e){const t={},s=y(e,["includeThoughts"]);s!=null&&x(t,["includeThoughts"],s);const r=y(e,["thinkingBudget"]);return r!=null&&x(t,["thinkingBudget"],r),t}function a7(n,e,t){const s={},r=y(e,["systemInstruction"]);t!==void 0&&r!=null&&x(t,["systemInstruction"],Pg(n,Os(n,r)));const i=y(e,["temperature"]);i!=null&&x(s,["temperature"],i);const o=y(e,["topP"]);o!=null&&x(s,["topP"],o);const l=y(e,["topK"]);l!=null&&x(s,["topK"],l);const c=y(e,["candidateCount"]);c!=null&&x(s,["candidateCount"],c);const d=y(e,["maxOutputTokens"]);d!=null&&x(s,["maxOutputTokens"],d);const h=y(e,["stopSequences"]);h!=null&&x(s,["stopSequences"],h);const f=y(e,["responseLogprobs"]);f!=null&&x(s,["responseLogprobs"],f);const p=y(e,["logprobs"]);p!=null&&x(s,["logprobs"],p);const g=y(e,["presencePenalty"]);g!=null&&x(s,["presencePenalty"],g);const b=y(e,["frequencyPenalty"]);b!=null&&x(s,["frequencyPenalty"],b);const v=y(e,["seed"]);v!=null&&x(s,["seed"],v);const _=y(e,["responseMimeType"]);_!=null&&x(s,["responseMimeType"],_);const N=y(e,["responseSchema"]);if(N!=null&&x(s,["responseSchema"],Ap(n,N)),y(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(y(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const j=y(e,["safetySettings"]);if(t!==void 0&&j!=null){let D=j;Array.isArray(D)&&(D=D.map(z=>BW(n,z))),x(t,["safetySettings"],D)}const k=y(e,["tools"]);if(t!==void 0&&k!=null){let D=Tg(n,k);Array.isArray(D)&&(D=D.map(z=>KW(n,kg(n,z)))),x(t,["tools"],D)}const S=y(e,["toolConfig"]);if(t!==void 0&&S!=null&&x(t,["toolConfig"],e7(n,S)),y(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const P=y(e,["cachedContent"]);t!==void 0&&P!=null&&x(t,["cachedContent"],xo(n,P));const E=y(e,["responseModalities"]);E!=null&&x(s,["responseModalities"],E);const M=y(e,["mediaResolution"]);M!=null&&x(s,["mediaResolution"],M);const I=y(e,["speechConfig"]);if(I!=null&&x(s,["speechConfig"],r7(n,pD(n,I))),y(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const O=y(e,["thinkingConfig"]);return O!=null&&x(s,["thinkingConfig"],i7(n,O)),s}function nk(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);if(r!=null){let o=Wr(n,r);Array.isArray(o)&&(o=o.map(l=>Pg(n,l))),x(t,["contents"],o)}const i=y(e,["config"]);return i!=null&&x(t,["generationConfig"],a7(n,i,t)),t}function o7(n,e,t){const s={},r=y(e,["taskType"]);t!==void 0&&r!=null&&x(t,["requests[]","taskType"],r);const i=y(e,["title"]);t!==void 0&&i!=null&&x(t,["requests[]","title"],i);const o=y(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&x(t,["requests[]","outputDimensionality"],o),y(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(y(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return s}function l7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);r!=null&&x(t,["requests[]","content"],mD(n,r));const i=y(e,["config"]);i!=null&&x(t,["config"],o7(n,i,t));const o=y(e,["model"]);return o!==void 0&&x(t,["requests[]","model"],tn(n,o)),t}function c7(n,e,t){const s={};if(y(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=y(e,["numberOfImages"]);t!==void 0&&r!=null&&x(t,["parameters","sampleCount"],r);const i=y(e,["aspectRatio"]);t!==void 0&&i!=null&&x(t,["parameters","aspectRatio"],i);const o=y(e,["guidanceScale"]);if(t!==void 0&&o!=null&&x(t,["parameters","guidanceScale"],o),y(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=y(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&x(t,["parameters","safetySetting"],l);const c=y(e,["personGeneration"]);t!==void 0&&c!=null&&x(t,["parameters","personGeneration"],c);const d=y(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&x(t,["parameters","includeSafetyAttributes"],d);const h=y(e,["includeRaiReason"]);t!==void 0&&h!=null&&x(t,["parameters","includeRaiReason"],h);const f=y(e,["language"]);t!==void 0&&f!=null&&x(t,["parameters","language"],f);const p=y(e,["outputMimeType"]);t!==void 0&&p!=null&&x(t,["parameters","outputOptions","mimeType"],p);const g=y(e,["outputCompressionQuality"]);if(t!==void 0&&g!=null&&x(t,["parameters","outputOptions","compressionQuality"],g),y(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(y(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function d7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["prompt"]);r!=null&&x(t,["instances[0]","prompt"],r);const i=y(e,["config"]);return i!=null&&x(t,["config"],c7(n,i,t)),t}function u7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","name"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function h7(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);t!==void 0&&i!=null&&x(t,["_query","pageToken"],i);const o=y(e,["filter"]);t!==void 0&&o!=null&&x(t,["_query","filter"],o);const l=y(e,["queryBase"]);return t!==void 0&&l!=null&&x(t,["_url","models_url"],vD(n,l)),s}function f7(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],h7(n,s,t)),t}function m7(n,e,t){const s={},r=y(e,["displayName"]);t!==void 0&&r!=null&&x(t,["displayName"],r);const i=y(e,["description"]);t!==void 0&&i!=null&&x(t,["description"],i);const o=y(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&x(t,["defaultCheckpointId"],o),s}function p7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","name"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],m7(n,r,t)),t}function g7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","name"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function y7(n,e){const t={};if(y(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(y(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(y(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function x7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);if(r!=null){let o=Wr(n,r);Array.isArray(o)&&(o=o.map(l=>Pg(n,l))),x(t,["contents"],o)}const i=y(e,["config"]);return i!=null&&x(t,["config"],y7(n,i)),t}function v7(n,e){const t={};if(y(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=y(e,["imageBytes"]);s!=null&&x(t,["bytesBase64Encoded"],vo(n,s));const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function b7(n,e,t){const s={},r=y(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&x(t,["parameters","sampleCount"],r),y(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(y(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=y(e,["durationSeconds"]);if(t!==void 0&&i!=null&&x(t,["parameters","durationSeconds"],i),y(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=y(e,["aspectRatio"]);if(t!==void 0&&o!=null&&x(t,["parameters","aspectRatio"],o),y(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=y(e,["personGeneration"]);if(t!==void 0&&l!=null&&x(t,["parameters","personGeneration"],l),y(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=y(e,["negativePrompt"]);if(t!==void 0&&c!=null&&x(t,["parameters","negativePrompt"],c),y(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return s}function w7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["prompt"]);r!=null&&x(t,["instances[0]","prompt"],r);const i=y(e,["image"]);i!=null&&x(t,["instances[0]","image"],v7(n,i));const o=y(e,["config"]);return o!=null&&x(t,["config"],b7(n,o,t)),t}function _7(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function S7(n,e){const t={},s=y(e,["displayName"]);s!=null&&x(t,["displayName"],s);const r=y(e,["data"]);r!=null&&x(t,["data"],r);const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function N7(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],_7(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],S7(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function pd(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>N7(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function j7(n,e){const t={},s=y(e,["featureSelectionPreference"]);return s!=null&&x(t,["featureSelectionPreference"],s),t}function C7(n,e){const t={},s=y(e,["method"]);s!=null&&x(t,["method"],s);const r=y(e,["category"]);r!=null&&x(t,["category"],r);const i=y(e,["threshold"]);return i!=null&&x(t,["threshold"],i),t}function k7(n,e){const t={};if(y(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const s=y(e,["description"]);s!=null&&x(t,["description"],s);const r=y(e,["name"]);r!=null&&x(t,["name"],r);const i=y(e,["parameters"]);i!=null&&x(t,["parameters"],i);const o=y(e,["response"]);return o!=null&&x(t,["response"],o),t}function T7(n,e){const t={},s=y(e,["startTime"]);s!=null&&x(t,["startTime"],s);const r=y(e,["endTime"]);return r!=null&&x(t,["endTime"],r),t}function E7(n,e){const t={},s=y(e,["timeRangeFilter"]);return s!=null&&x(t,["timeRangeFilter"],T7(n,s)),t}function P7(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["dynamicThreshold"]);return r!=null&&x(t,["dynamicThreshold"],r),t}function M7(n,e){const t={},s=y(e,["dynamicRetrievalConfig"]);return s!=null&&x(t,["dynamicRetrievalConfig"],P7(n,s)),t}function D7(){return{}}function A7(n,e){const t={},s=y(e,["apiKeyString"]);return s!=null&&x(t,["apiKeyString"],s),t}function I7(n,e){const t={},s=y(e,["apiKeyConfig"]);s!=null&&x(t,["apiKeyConfig"],A7(n,s));const r=y(e,["authType"]);r!=null&&x(t,["authType"],r);const i=y(e,["googleServiceAccountConfig"]);i!=null&&x(t,["googleServiceAccountConfig"],i);const o=y(e,["httpBasicAuthConfig"]);o!=null&&x(t,["httpBasicAuthConfig"],o);const l=y(e,["oauthConfig"]);l!=null&&x(t,["oauthConfig"],l);const c=y(e,["oidcConfig"]);return c!=null&&x(t,["oidcConfig"],c),t}function O7(n,e){const t={},s=y(e,["authConfig"]);return s!=null&&x(t,["authConfig"],I7(n,s)),t}function TD(n,e){const t={},s=y(e,["functionDeclarations"]);if(s!=null){let h=s;Array.isArray(h)&&(h=h.map(f=>k7(n,f))),x(t,["functionDeclarations"],h)}const r=y(e,["retrieval"]);r!=null&&x(t,["retrieval"],r);const i=y(e,["googleSearch"]);i!=null&&x(t,["googleSearch"],E7(n,i));const o=y(e,["googleSearchRetrieval"]);o!=null&&x(t,["googleSearchRetrieval"],M7(n,o)),y(e,["enterpriseWebSearch"])!=null&&x(t,["enterpriseWebSearch"],D7());const c=y(e,["googleMaps"]);if(c!=null&&x(t,["googleMaps"],O7(n,c)),y(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=y(e,["codeExecution"]);return d!=null&&x(t,["codeExecution"],d),t}function R7(n,e){const t={},s=y(e,["mode"]);s!=null&&x(t,["mode"],s);const r=y(e,["allowedFunctionNames"]);return r!=null&&x(t,["allowedFunctionNames"],r),t}function L7(n,e){const t={},s=y(e,["latitude"]);s!=null&&x(t,["latitude"],s);const r=y(e,["longitude"]);return r!=null&&x(t,["longitude"],r),t}function F7(n,e){const t={},s=y(e,["latLng"]);return s!=null&&x(t,["latLng"],L7(n,s)),t}function $7(n,e){const t={},s=y(e,["functionCallingConfig"]);s!=null&&x(t,["functionCallingConfig"],R7(n,s));const r=y(e,["retrievalConfig"]);return r!=null&&x(t,["retrievalConfig"],F7(n,r)),t}function z7(n,e){const t={},s=y(e,["voiceName"]);return s!=null&&x(t,["voiceName"],s),t}function U7(n,e){const t={},s=y(e,["prebuiltVoiceConfig"]);return s!=null&&x(t,["prebuiltVoiceConfig"],z7(n,s)),t}function V7(n,e){const t={},s=y(e,["voiceConfig"]);if(s!=null&&x(t,["voiceConfig"],U7(n,s)),y(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=y(e,["languageCode"]);return r!=null&&x(t,["languageCode"],r),t}function B7(n,e){const t={},s=y(e,["includeThoughts"]);s!=null&&x(t,["includeThoughts"],s);const r=y(e,["thinkingBudget"]);return r!=null&&x(t,["thinkingBudget"],r),t}function q7(n,e,t){const s={},r=y(e,["systemInstruction"]);t!==void 0&&r!=null&&x(t,["systemInstruction"],pd(n,Os(n,r)));const i=y(e,["temperature"]);i!=null&&x(s,["temperature"],i);const o=y(e,["topP"]);o!=null&&x(s,["topP"],o);const l=y(e,["topK"]);l!=null&&x(s,["topK"],l);const c=y(e,["candidateCount"]);c!=null&&x(s,["candidateCount"],c);const d=y(e,["maxOutputTokens"]);d!=null&&x(s,["maxOutputTokens"],d);const h=y(e,["stopSequences"]);h!=null&&x(s,["stopSequences"],h);const f=y(e,["responseLogprobs"]);f!=null&&x(s,["responseLogprobs"],f);const p=y(e,["logprobs"]);p!=null&&x(s,["logprobs"],p);const g=y(e,["presencePenalty"]);g!=null&&x(s,["presencePenalty"],g);const b=y(e,["frequencyPenalty"]);b!=null&&x(s,["frequencyPenalty"],b);const v=y(e,["seed"]);v!=null&&x(s,["seed"],v);const _=y(e,["responseMimeType"]);_!=null&&x(s,["responseMimeType"],_);const N=y(e,["responseSchema"]);N!=null&&x(s,["responseSchema"],Ap(n,N));const j=y(e,["routingConfig"]);j!=null&&x(s,["routingConfig"],j);const k=y(e,["modelSelectionConfig"]);k!=null&&x(s,["modelConfig"],j7(n,k));const S=y(e,["safetySettings"]);if(t!==void 0&&S!=null){let R=S;Array.isArray(R)&&(R=R.map(V=>C7(n,V))),x(t,["safetySettings"],R)}const P=y(e,["tools"]);if(t!==void 0&&P!=null){let R=Tg(n,P);Array.isArray(R)&&(R=R.map(V=>TD(n,kg(n,V)))),x(t,["tools"],R)}const E=y(e,["toolConfig"]);t!==void 0&&E!=null&&x(t,["toolConfig"],$7(n,E));const M=y(e,["labels"]);t!==void 0&&M!=null&&x(t,["labels"],M);const I=y(e,["cachedContent"]);t!==void 0&&I!=null&&x(t,["cachedContent"],xo(n,I));const O=y(e,["responseModalities"]);O!=null&&x(s,["responseModalities"],O);const D=y(e,["mediaResolution"]);D!=null&&x(s,["mediaResolution"],D);const z=y(e,["speechConfig"]);z!=null&&x(s,["speechConfig"],V7(n,pD(n,z)));const H=y(e,["audioTimestamp"]);H!=null&&x(s,["audioTimestamp"],H);const F=y(e,["thinkingConfig"]);return F!=null&&x(s,["thinkingConfig"],B7(n,F)),s}function sk(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);if(r!=null){let o=Wr(n,r);Array.isArray(o)&&(o=o.map(l=>pd(n,l))),x(t,["contents"],o)}const i=y(e,["config"]);return i!=null&&x(t,["generationConfig"],q7(n,i,t)),t}function H7(n,e,t){const s={},r=y(e,["taskType"]);t!==void 0&&r!=null&&x(t,["instances[]","task_type"],r);const i=y(e,["title"]);t!==void 0&&i!=null&&x(t,["instances[]","title"],i);const o=y(e,["outputDimensionality"]);t!==void 0&&o!=null&&x(t,["parameters","outputDimensionality"],o);const l=y(e,["mimeType"]);t!==void 0&&l!=null&&x(t,["instances[]","mimeType"],l);const c=y(e,["autoTruncate"]);return t!==void 0&&c!=null&&x(t,["parameters","autoTruncate"],c),s}function W7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);r!=null&&x(t,["instances[]","content"],mD(n,r));const i=y(e,["config"]);return i!=null&&x(t,["config"],H7(n,i,t)),t}function G7(n,e,t){const s={},r=y(e,["outputGcsUri"]);t!==void 0&&r!=null&&x(t,["parameters","storageUri"],r);const i=y(e,["negativePrompt"]);t!==void 0&&i!=null&&x(t,["parameters","negativePrompt"],i);const o=y(e,["numberOfImages"]);t!==void 0&&o!=null&&x(t,["parameters","sampleCount"],o);const l=y(e,["aspectRatio"]);t!==void 0&&l!=null&&x(t,["parameters","aspectRatio"],l);const c=y(e,["guidanceScale"]);t!==void 0&&c!=null&&x(t,["parameters","guidanceScale"],c);const d=y(e,["seed"]);t!==void 0&&d!=null&&x(t,["parameters","seed"],d);const h=y(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&x(t,["parameters","safetySetting"],h);const f=y(e,["personGeneration"]);t!==void 0&&f!=null&&x(t,["parameters","personGeneration"],f);const p=y(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&x(t,["parameters","includeSafetyAttributes"],p);const g=y(e,["includeRaiReason"]);t!==void 0&&g!=null&&x(t,["parameters","includeRaiReason"],g);const b=y(e,["language"]);t!==void 0&&b!=null&&x(t,["parameters","language"],b);const v=y(e,["outputMimeType"]);t!==void 0&&v!=null&&x(t,["parameters","outputOptions","mimeType"],v);const _=y(e,["outputCompressionQuality"]);t!==void 0&&_!=null&&x(t,["parameters","outputOptions","compressionQuality"],_);const N=y(e,["addWatermark"]);t!==void 0&&N!=null&&x(t,["parameters","addWatermark"],N);const j=y(e,["enhancePrompt"]);return t!==void 0&&j!=null&&x(t,["parameters","enhancePrompt"],j),s}function Y7(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["prompt"]);r!=null&&x(t,["instances[0]","prompt"],r);const i=y(e,["config"]);return i!=null&&x(t,["config"],G7(n,i,t)),t}function zw(n,e){const t={},s=y(e,["gcsUri"]);s!=null&&x(t,["gcsUri"],s);const r=y(e,["imageBytes"]);r!=null&&x(t,["bytesBase64Encoded"],vo(n,r));const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function Z7(n,e){const t={},s=y(e,["maskMode"]);s!=null&&x(t,["maskMode"],s);const r=y(e,["segmentationClasses"]);r!=null&&x(t,["maskClasses"],r);const i=y(e,["maskDilation"]);return i!=null&&x(t,["dilation"],i),t}function K7(n,e){const t={},s=y(e,["controlType"]);s!=null&&x(t,["controlType"],s);const r=y(e,["enableControlImageComputation"]);return r!=null&&x(t,["computeControl"],r),t}function J7(n,e){const t={},s=y(e,["styleDescription"]);return s!=null&&x(t,["styleDescription"],s),t}function Q7(n,e){const t={},s=y(e,["subjectType"]);s!=null&&x(t,["subjectType"],s);const r=y(e,["subjectDescription"]);return r!=null&&x(t,["subjectDescription"],r),t}function X7(n,e){const t={},s=y(e,["referenceImage"]);s!=null&&x(t,["referenceImage"],zw(n,s));const r=y(e,["referenceId"]);r!=null&&x(t,["referenceId"],r);const i=y(e,["referenceType"]);i!=null&&x(t,["referenceType"],i);const o=y(e,["maskImageConfig"]);o!=null&&x(t,["maskImageConfig"],Z7(n,o));const l=y(e,["controlImageConfig"]);l!=null&&x(t,["controlImageConfig"],K7(n,l));const c=y(e,["styleImageConfig"]);c!=null&&x(t,["styleImageConfig"],J7(n,c));const d=y(e,["subjectImageConfig"]);return d!=null&&x(t,["subjectImageConfig"],Q7(n,d)),t}function e9(n,e,t){const s={},r=y(e,["outputGcsUri"]);t!==void 0&&r!=null&&x(t,["parameters","storageUri"],r);const i=y(e,["negativePrompt"]);t!==void 0&&i!=null&&x(t,["parameters","negativePrompt"],i);const o=y(e,["numberOfImages"]);t!==void 0&&o!=null&&x(t,["parameters","sampleCount"],o);const l=y(e,["aspectRatio"]);t!==void 0&&l!=null&&x(t,["parameters","aspectRatio"],l);const c=y(e,["guidanceScale"]);t!==void 0&&c!=null&&x(t,["parameters","guidanceScale"],c);const d=y(e,["seed"]);t!==void 0&&d!=null&&x(t,["parameters","seed"],d);const h=y(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&x(t,["parameters","safetySetting"],h);const f=y(e,["personGeneration"]);t!==void 0&&f!=null&&x(t,["parameters","personGeneration"],f);const p=y(e,["includeSafetyAttributes"]);t!==void 0&&p!=null&&x(t,["parameters","includeSafetyAttributes"],p);const g=y(e,["includeRaiReason"]);t!==void 0&&g!=null&&x(t,["parameters","includeRaiReason"],g);const b=y(e,["language"]);t!==void 0&&b!=null&&x(t,["parameters","language"],b);const v=y(e,["outputMimeType"]);t!==void 0&&v!=null&&x(t,["parameters","outputOptions","mimeType"],v);const _=y(e,["outputCompressionQuality"]);t!==void 0&&_!=null&&x(t,["parameters","outputOptions","compressionQuality"],_);const N=y(e,["editMode"]);t!==void 0&&N!=null&&x(t,["parameters","editMode"],N);const j=y(e,["baseSteps"]);return t!==void 0&&j!=null&&x(t,["parameters","editConfig","baseSteps"],j),s}function t9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["prompt"]);r!=null&&x(t,["instances[0]","prompt"],r);const i=y(e,["referenceImages"]);if(i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>X7(n,c))),x(t,["instances[0]","referenceImages"],l)}const o=y(e,["config"]);return o!=null&&x(t,["config"],e9(n,o,t)),t}function n9(n,e,t){const s={},r=y(e,["includeRaiReason"]);t!==void 0&&r!=null&&x(t,["parameters","includeRaiReason"],r);const i=y(e,["outputMimeType"]);t!==void 0&&i!=null&&x(t,["parameters","outputOptions","mimeType"],i);const o=y(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&x(t,["parameters","outputOptions","compressionQuality"],o);const l=y(e,["numberOfImages"]);t!==void 0&&l!=null&&x(t,["parameters","sampleCount"],l);const c=y(e,["mode"]);return t!==void 0&&c!=null&&x(t,["parameters","mode"],c),s}function s9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["image"]);r!=null&&x(t,["instances[0]","image"],zw(n,r));const i=y(e,["upscaleFactor"]);i!=null&&x(t,["parameters","upscaleConfig","upscaleFactor"],i);const o=y(e,["config"]);return o!=null&&x(t,["config"],n9(n,o,t)),t}function r9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","name"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function i9(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);t!==void 0&&i!=null&&x(t,["_query","pageToken"],i);const o=y(e,["filter"]);t!==void 0&&o!=null&&x(t,["_query","filter"],o);const l=y(e,["queryBase"]);return t!==void 0&&l!=null&&x(t,["_url","models_url"],vD(n,l)),s}function a9(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],i9(n,s,t)),t}function o9(n,e,t){const s={},r=y(e,["displayName"]);t!==void 0&&r!=null&&x(t,["displayName"],r);const i=y(e,["description"]);t!==void 0&&i!=null&&x(t,["description"],i);const o=y(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&x(t,["defaultCheckpointId"],o),s}function l9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],o9(n,r,t)),t}function c9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","name"],tn(n,s));const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function d9(n,e,t){const s={},r=y(e,["systemInstruction"]);t!==void 0&&r!=null&&x(t,["systemInstruction"],pd(n,Os(n,r)));const i=y(e,["tools"]);if(t!==void 0&&i!=null){let l=i;Array.isArray(l)&&(l=l.map(c=>TD(n,c))),x(t,["tools"],l)}const o=y(e,["generationConfig"]);return t!==void 0&&o!=null&&x(t,["generationConfig"],o),s}function u9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);if(r!=null){let o=Wr(n,r);Array.isArray(o)&&(o=o.map(l=>pd(n,l))),x(t,["contents"],o)}const i=y(e,["config"]);return i!=null&&x(t,["config"],d9(n,i,t)),t}function h9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["contents"]);if(r!=null){let o=Wr(n,r);Array.isArray(o)&&(o=o.map(l=>pd(n,l))),x(t,["contents"],o)}const i=y(e,["config"]);return i!=null&&x(t,["config"],i),t}function f9(n,e,t){const s={},r=y(e,["numberOfVideos"]);t!==void 0&&r!=null&&x(t,["parameters","sampleCount"],r);const i=y(e,["outputGcsUri"]);t!==void 0&&i!=null&&x(t,["parameters","storageUri"],i);const o=y(e,["fps"]);t!==void 0&&o!=null&&x(t,["parameters","fps"],o);const l=y(e,["durationSeconds"]);t!==void 0&&l!=null&&x(t,["parameters","durationSeconds"],l);const c=y(e,["seed"]);t!==void 0&&c!=null&&x(t,["parameters","seed"],c);const d=y(e,["aspectRatio"]);t!==void 0&&d!=null&&x(t,["parameters","aspectRatio"],d);const h=y(e,["resolution"]);t!==void 0&&h!=null&&x(t,["parameters","resolution"],h);const f=y(e,["personGeneration"]);t!==void 0&&f!=null&&x(t,["parameters","personGeneration"],f);const p=y(e,["pubsubTopic"]);t!==void 0&&p!=null&&x(t,["parameters","pubsubTopic"],p);const g=y(e,["negativePrompt"]);t!==void 0&&g!=null&&x(t,["parameters","negativePrompt"],g);const b=y(e,["enhancePrompt"]);return t!==void 0&&b!=null&&x(t,["parameters","enhancePrompt"],b),s}function m9(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["_url","model"],tn(n,s));const r=y(e,["prompt"]);r!=null&&x(t,["instances[0]","prompt"],r);const i=y(e,["image"]);i!=null&&x(t,["instances[0]","image"],zw(n,i));const o=y(e,["config"]);return o!=null&&x(t,["config"],f9(n,o,t)),t}function p9(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function g9(n,e){const t={},s=y(e,["data"]);s!=null&&x(t,["data"],s);const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function y9(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],p9(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],g9(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function x9(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>y9(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function v9(n,e){const t={},s=y(e,["citationSources"]);return s!=null&&x(t,["citations"],s),t}function b9(n,e){const t={},s=y(e,["retrievedUrl"]);s!=null&&x(t,["retrievedUrl"],s);const r=y(e,["urlRetrievalStatus"]);return r!=null&&x(t,["urlRetrievalStatus"],r),t}function w9(n,e){const t={},s=y(e,["urlMetadata"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>b9(n,i))),x(t,["urlMetadata"],r)}return t}function _9(n,e){const t={},s=y(e,["content"]);s!=null&&x(t,["content"],x9(n,s));const r=y(e,["citationMetadata"]);r!=null&&x(t,["citationMetadata"],v9(n,r));const i=y(e,["tokenCount"]);i!=null&&x(t,["tokenCount"],i);const o=y(e,["finishReason"]);o!=null&&x(t,["finishReason"],o);const l=y(e,["urlContextMetadata"]);l!=null&&x(t,["urlContextMetadata"],w9(n,l));const c=y(e,["avgLogprobs"]);c!=null&&x(t,["avgLogprobs"],c);const d=y(e,["groundingMetadata"]);d!=null&&x(t,["groundingMetadata"],d);const h=y(e,["index"]);h!=null&&x(t,["index"],h);const f=y(e,["logprobsResult"]);f!=null&&x(t,["logprobsResult"],f);const p=y(e,["safetyRatings"]);return p!=null&&x(t,["safetyRatings"],p),t}function rk(n,e){const t={},s=y(e,["candidates"]);if(s!=null){let l=s;Array.isArray(l)&&(l=l.map(c=>_9(n,c))),x(t,["candidates"],l)}const r=y(e,["modelVersion"]);r!=null&&x(t,["modelVersion"],r);const i=y(e,["promptFeedback"]);i!=null&&x(t,["promptFeedback"],i);const o=y(e,["usageMetadata"]);return o!=null&&x(t,["usageMetadata"],o),t}function S9(n,e){const t={},s=y(e,["values"]);return s!=null&&x(t,["values"],s),t}function N9(){return{}}function j9(n,e){const t={},s=y(e,["embeddings"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>S9(n,o))),x(t,["embeddings"],i)}return y(e,["metadata"])!=null&&x(t,["metadata"],N9()),t}function C9(n,e){const t={},s=y(e,["bytesBase64Encoded"]);s!=null&&x(t,["imageBytes"],vo(n,s));const r=y(e,["mimeType"]);return r!=null&&x(t,["mimeType"],r),t}function ED(n,e){const t={},s=y(e,["safetyAttributes","categories"]);s!=null&&x(t,["categories"],s);const r=y(e,["safetyAttributes","scores"]);r!=null&&x(t,["scores"],r);const i=y(e,["contentType"]);return i!=null&&x(t,["contentType"],i),t}function k9(n,e){const t={},s=y(e,["_self"]);s!=null&&x(t,["image"],C9(n,s));const r=y(e,["raiFilteredReason"]);r!=null&&x(t,["raiFilteredReason"],r);const i=y(e,["_self"]);return i!=null&&x(t,["safetyAttributes"],ED(n,i)),t}function T9(n,e){const t={},s=y(e,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>k9(n,o))),x(t,["generatedImages"],i)}const r=y(e,["positivePromptSafetyAttributes"]);return r!=null&&x(t,["positivePromptSafetyAttributes"],ED(n,r)),t}function E9(n,e){const t={},s=y(e,["baseModel"]);s!=null&&x(t,["baseModel"],s);const r=y(e,["createTime"]);r!=null&&x(t,["createTime"],r);const i=y(e,["updateTime"]);return i!=null&&x(t,["updateTime"],i),t}function Cb(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["description"]);i!=null&&x(t,["description"],i);const o=y(e,["version"]);o!=null&&x(t,["version"],o);const l=y(e,["_self"]);l!=null&&x(t,["tunedModelInfo"],E9(n,l));const c=y(e,["inputTokenLimit"]);c!=null&&x(t,["inputTokenLimit"],c);const d=y(e,["outputTokenLimit"]);d!=null&&x(t,["outputTokenLimit"],d);const h=y(e,["supportedGenerationMethods"]);return h!=null&&x(t,["supportedActions"],h),t}function P9(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["_self"]);if(r!=null){let i=bD(n,r);Array.isArray(i)&&(i=i.map(o=>Cb(n,o))),x(t,["models"],i)}return t}function M9(){return{}}function D9(n,e){const t={},s=y(e,["totalTokens"]);s!=null&&x(t,["totalTokens"],s);const r=y(e,["cachedContentTokenCount"]);return r!=null&&x(t,["cachedContentTokenCount"],r),t}function A9(n,e){const t={},s=y(e,["video","uri"]);s!=null&&x(t,["uri"],s);const r=y(e,["video","encodedVideo"]);r!=null&&x(t,["videoBytes"],vo(n,r));const i=y(e,["encoding"]);return i!=null&&x(t,["mimeType"],i),t}function I9(n,e){const t={},s=y(e,["_self"]);return s!=null&&x(t,["video"],A9(n,s)),t}function O9(n,e){const t={},s=y(e,["generatedSamples"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>I9(n,l))),x(t,["generatedVideos"],o)}const r=y(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const i=y(e,["raiMediaFilteredReasons"]);return i!=null&&x(t,["raiMediaFilteredReasons"],i),t}function R9(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["metadata"]);r!=null&&x(t,["metadata"],r);const i=y(e,["done"]);i!=null&&x(t,["done"],i);const o=y(e,["error"]);o!=null&&x(t,["error"],o);const l=y(e,["response","generateVideoResponse"]);return l!=null&&x(t,["response"],O9(n,l)),t}function L9(n,e){const t={},s=y(e,["fps"]);s!=null&&x(t,["fps"],s);const r=y(e,["endOffset"]);r!=null&&x(t,["endOffset"],r);const i=y(e,["startOffset"]);return i!=null&&x(t,["startOffset"],i),t}function F9(n,e){const t={},s=y(e,["displayName"]);s!=null&&x(t,["displayName"],s);const r=y(e,["data"]);r!=null&&x(t,["data"],r);const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function $9(n,e){const t={},s=y(e,["videoMetadata"]);s!=null&&x(t,["videoMetadata"],L9(n,s));const r=y(e,["thought"]);r!=null&&x(t,["thought"],r);const i=y(e,["inlineData"]);i!=null&&x(t,["inlineData"],F9(n,i));const o=y(e,["codeExecutionResult"]);o!=null&&x(t,["codeExecutionResult"],o);const l=y(e,["executableCode"]);l!=null&&x(t,["executableCode"],l);const c=y(e,["fileData"]);c!=null&&x(t,["fileData"],c);const d=y(e,["functionCall"]);d!=null&&x(t,["functionCall"],d);const h=y(e,["functionResponse"]);h!=null&&x(t,["functionResponse"],h);const f=y(e,["text"]);return f!=null&&x(t,["text"],f),t}function z9(n,e){const t={},s=y(e,["parts"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>$9(n,o))),x(t,["parts"],i)}const r=y(e,["role"]);return r!=null&&x(t,["role"],r),t}function U9(n,e){const t={},s=y(e,["citations"]);return s!=null&&x(t,["citations"],s),t}function V9(n,e){const t={},s=y(e,["content"]);s!=null&&x(t,["content"],z9(n,s));const r=y(e,["citationMetadata"]);r!=null&&x(t,["citationMetadata"],U9(n,r));const i=y(e,["finishMessage"]);i!=null&&x(t,["finishMessage"],i);const o=y(e,["finishReason"]);o!=null&&x(t,["finishReason"],o);const l=y(e,["avgLogprobs"]);l!=null&&x(t,["avgLogprobs"],l);const c=y(e,["groundingMetadata"]);c!=null&&x(t,["groundingMetadata"],c);const d=y(e,["index"]);d!=null&&x(t,["index"],d);const h=y(e,["logprobsResult"]);h!=null&&x(t,["logprobsResult"],h);const f=y(e,["safetyRatings"]);return f!=null&&x(t,["safetyRatings"],f),t}function ik(n,e){const t={},s=y(e,["candidates"]);if(s!=null){let d=s;Array.isArray(d)&&(d=d.map(h=>V9(n,h))),x(t,["candidates"],d)}const r=y(e,["createTime"]);r!=null&&x(t,["createTime"],r);const i=y(e,["responseId"]);i!=null&&x(t,["responseId"],i);const o=y(e,["modelVersion"]);o!=null&&x(t,["modelVersion"],o);const l=y(e,["promptFeedback"]);l!=null&&x(t,["promptFeedback"],l);const c=y(e,["usageMetadata"]);return c!=null&&x(t,["usageMetadata"],c),t}function B9(n,e){const t={},s=y(e,["truncated"]);s!=null&&x(t,["truncated"],s);const r=y(e,["token_count"]);return r!=null&&x(t,["tokenCount"],r),t}function q9(n,e){const t={},s=y(e,["values"]);s!=null&&x(t,["values"],s);const r=y(e,["statistics"]);return r!=null&&x(t,["statistics"],B9(n,r)),t}function H9(n,e){const t={},s=y(e,["billableCharacterCount"]);return s!=null&&x(t,["billableCharacterCount"],s),t}function W9(n,e){const t={},s=y(e,["predictions[]","embeddings"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>q9(n,o))),x(t,["embeddings"],i)}const r=y(e,["metadata"]);return r!=null&&x(t,["metadata"],H9(n,r)),t}function G9(n,e){const t={},s=y(e,["gcsUri"]);s!=null&&x(t,["gcsUri"],s);const r=y(e,["bytesBase64Encoded"]);r!=null&&x(t,["imageBytes"],vo(n,r));const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function PD(n,e){const t={},s=y(e,["safetyAttributes","categories"]);s!=null&&x(t,["categories"],s);const r=y(e,["safetyAttributes","scores"]);r!=null&&x(t,["scores"],r);const i=y(e,["contentType"]);return i!=null&&x(t,["contentType"],i),t}function Uw(n,e){const t={},s=y(e,["_self"]);s!=null&&x(t,["image"],G9(n,s));const r=y(e,["raiFilteredReason"]);r!=null&&x(t,["raiFilteredReason"],r);const i=y(e,["_self"]);i!=null&&x(t,["safetyAttributes"],PD(n,i));const o=y(e,["prompt"]);return o!=null&&x(t,["enhancedPrompt"],o),t}function Y9(n,e){const t={},s=y(e,["predictions"]);if(s!=null){let i=s;Array.isArray(i)&&(i=i.map(o=>Uw(n,o))),x(t,["generatedImages"],i)}const r=y(e,["positivePromptSafetyAttributes"]);return r!=null&&x(t,["positivePromptSafetyAttributes"],PD(n,r)),t}function Z9(n,e){const t={},s=y(e,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>Uw(n,i))),x(t,["generatedImages"],r)}return t}function K9(n,e){const t={},s=y(e,["predictions"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>Uw(n,i))),x(t,["generatedImages"],r)}return t}function J9(n,e){const t={},s=y(e,["endpoint"]);s!=null&&x(t,["name"],s);const r=y(e,["deployedModelId"]);return r!=null&&x(t,["deployedModelId"],r),t}function Q9(n,e){const t={},s=y(e,["labels","google-vertex-llm-tuning-base-model-id"]);s!=null&&x(t,["baseModel"],s);const r=y(e,["createTime"]);r!=null&&x(t,["createTime"],r);const i=y(e,["updateTime"]);return i!=null&&x(t,["updateTime"],i),t}function X9(n,e){const t={},s=y(e,["checkpointId"]);s!=null&&x(t,["checkpointId"],s);const r=y(e,["epoch"]);r!=null&&x(t,["epoch"],r);const i=y(e,["step"]);return i!=null&&x(t,["step"],i),t}function kb(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["displayName"]);r!=null&&x(t,["displayName"],r);const i=y(e,["description"]);i!=null&&x(t,["description"],i);const o=y(e,["versionId"]);o!=null&&x(t,["version"],o);const l=y(e,["deployedModels"]);if(l!=null){let p=l;Array.isArray(p)&&(p=p.map(g=>J9(n,g))),x(t,["endpoints"],p)}const c=y(e,["labels"]);c!=null&&x(t,["labels"],c);const d=y(e,["_self"]);d!=null&&x(t,["tunedModelInfo"],Q9(n,d));const h=y(e,["defaultCheckpointId"]);h!=null&&x(t,["defaultCheckpointId"],h);const f=y(e,["checkpoints"]);if(f!=null){let p=f;Array.isArray(p)&&(p=p.map(g=>X9(n,g))),x(t,["checkpoints"],p)}return t}function eG(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["_self"]);if(r!=null){let i=bD(n,r);Array.isArray(i)&&(i=i.map(o=>kb(n,o))),x(t,["models"],i)}return t}function tG(){return{}}function nG(n,e){const t={},s=y(e,["totalTokens"]);return s!=null&&x(t,["totalTokens"],s),t}function sG(n,e){const t={},s=y(e,["tokensInfo"]);return s!=null&&x(t,["tokensInfo"],s),t}function rG(n,e){const t={},s=y(e,["gcsUri"]);s!=null&&x(t,["uri"],s);const r=y(e,["bytesBase64Encoded"]);r!=null&&x(t,["videoBytes"],vo(n,r));const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function iG(n,e){const t={},s=y(e,["_self"]);return s!=null&&x(t,["video"],rG(n,s)),t}function aG(n,e){const t={},s=y(e,["videos"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>iG(n,l))),x(t,["generatedVideos"],o)}const r=y(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const i=y(e,["raiMediaFilteredReasons"]);return i!=null&&x(t,["raiMediaFilteredReasons"],i),t}function oG(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["metadata"]);r!=null&&x(t,["metadata"],r);const i=y(e,["done"]);i!=null&&x(t,["done"],i);const o=y(e,["error"]);o!=null&&x(t,["error"],o);const l=y(e,["response"]);return l!=null&&x(t,["response"],aG(n,l)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lG="Content-Type",cG="X-Server-Timeout",dG="User-Agent",Tb="x-goog-api-client",uG="0.15.0",hG=`google-genai-sdk/${uG}`,fG="v1beta1",mG="v1beta",ak=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class MD extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class Eb extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class pG{constructor(e){var t,s;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const r={};this.clientOptions.vertexai?(r.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:fG,r.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(r.apiVersion=(s=this.clientOptions.apiVersion)!==null&&s!==void 0?s:mG,r.baseUrl="https://generativelanguage.googleapis.com/"),r.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=r,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(r,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const s=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&s.push(e.apiVersion),s.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,s){const r=[this.getRequestUrlInternal(t)];return s&&r.push(this.getBaseResourcePath()),e!==""&&r.push(e),new URL(`${r.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))r.searchParams.append(o,String(l));let i={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else i.body=e.body;return i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.unaryApiCall(r,i,e.httpMethod)}patchHttpOptions(e,t){const s=JSON.parse(JSON.stringify(e));for(const[r,i]of Object.entries(t))typeof i=="object"?s[r]=Object.assign(Object.assign({},s[r]),i):i!==void 0&&(s[r]=i);return s}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const s=this.shouldPrependVertexProjectPath(e),r=this.constructUrl(e.path,t,s);(!r.searchParams.has("alt")||r.searchParams.get("alt")!=="sse")&&r.searchParams.set("alt","sse");let i={};return i.body=e.body,i=await this.includeExtraHttpOptionsToRequestInit(i,t,e.abortSignal),this.streamApiCall(r,i,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,s){if(t&&t.timeout||s){const r=new AbortController,i=r.signal;t.timeout&&(t==null?void 0:t.timeout)>0&&setTimeout(()=>r.abort(),t.timeout),s&&s.addEventListener("abort",()=>{r.abort()}),e.signal=i}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await ok(r),new _b(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}async streamApiCall(e,t,s){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:s})).then(async r=>(await ok(r),this.processStreamResponse(r))).catch(r=>{throw r instanceof Error?r:new Error(JSON.stringify(r))})}processStreamResponse(e){var t;return Pu(this,arguments,function*(){const r=(t=e==null?void 0:e.body)===null||t===void 0?void 0:t.getReader(),i=new TextDecoder("utf-8");if(!r)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield ln(r.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=i.decode(c);try{const f=JSON.parse(d);if("error"in f){const p=JSON.parse(JSON.stringify(f.error)),g=p.status,b=p.code,v=`got status: ${g}. ${JSON.stringify(f)}`;if(b>=400&&b<500)throw new MD(v);if(b>=500&&b<600)throw new Eb(v)}}catch(f){const p=f;if(p.name==="ClientError"||p.name==="ServerError")throw f}o+=d;let h=o.match(ak);for(;h;){const f=h[1];try{const p=new Response(f,{headers:e==null?void 0:e.headers,status:e==null?void 0:e.status,statusText:e==null?void 0:e.statusText});yield yield ln(new _b(p)),o=o.slice(h[0].length),h=o.match(ak)}catch(p){throw new Error(`exception parsing stream chunk ${f}. ${p}`)}}}}finally{r.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(s=>{throw new Error(`exception ${s} sending request`)})}getDefaultHeaders(){const e={},t=hG+" "+this.clientOptions.userAgentExtra;return e[dG]=t,e[Tb]=t,e[lG]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[s,r]of Object.entries(e.headers))t.append(s,r);e.timeout&&e.timeout>0&&t.append(cG,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var s;const r={};t!=null&&(r.mimeType=t.mimeType,r.name=t.name,r.displayName=t.displayName),r.name&&!r.name.startsWith("files/")&&(r.name=`files/${r.name}`);const i=this.clientOptions.uploader,o=await i.stat(e);r.sizeBytes=String(o.size);const l=(s=t==null?void 0:t.mimeType)!==null&&s!==void 0?s:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");r.mimeType=l;const c=await this.fetchUploadUrl(r,t);return i.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var s;let r={};t!=null&&t.httpOptions?r=t.httpOptions:r={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const i={file:e},o=await this.request({path:st("upload/v1beta/files",i._url),body:JSON.stringify(i),httpMethod:"POST",httpOptions:r});if(!o||!(o!=null&&o.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(s=o==null?void 0:o.headers)===null||s===void 0?void 0:s["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function ok(n){var e;if(n===void 0)throw new Eb("response is undefined");if(!n.ok){const t=n.status,s=n.statusText;let r;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?r=await n.json():r={error:{message:await n.text(),code:n.status,status:n.statusText}};const i=`got status: ${t} ${s}. ${JSON.stringify(r)}`;throw t>=400&&t<500?new MD(i):t>=500&&t<600?new Eb(i):new Error(i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const gG="mcp_used/unknown";function Pb(n){for(const e of n)if(Vw(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function Mb(n){var e;n[Tb]=(((e=n[Tb])!==null&&e!==void 0?e:"")+` ${gG}`).trimStart()}function yG(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>Vw(r)))!==null&&s!==void 0?s:!1}function xG(n){var e,t,s;return(s=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(r=>!Vw(r)))!==null&&s!==void 0?s:!1}function Vw(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function vG(n,e,t){const s=new Pq,r=JSON.parse(t.data),i=$W(n,r);Object.assign(s,i),e(s)}class bG{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s}async connect(e){var t,s;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const r=this.apiClient.getWebsocketBaseUrl(),i=this.apiClient.getApiVersion(),o=SG(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${r}/ws/google.ai.generativelanguage.${i}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const h=new Promise(k=>{d=k}),f=e.callbacks,p=function(){d({})},g=this.apiClient,b={onopen:p,onmessage:k=>{vG(g,f.onmessage,k)},onerror:(t=f==null?void 0:f.onerror)!==null&&t!==void 0?t:function(k){},onclose:(s=f==null?void 0:f.onclose)!==null&&s!==void 0?s:function(k){}},v=this.webSocketFactory.create(c,_G(o),b);v.connect(),await h;const _=tn(this.apiClient,e.model),N=jD(this.apiClient,{model:_}),j=jb(this.apiClient,{setup:N});return v.send(JSON.stringify(j)),new wG(v,this.apiClient)}}class wG{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=tW(this.apiClient,e),s=CD(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:s}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=nW(this.apiClient,e),s=jb(this.apiClient,t);this.conn.send(JSON.stringify(s))}sendPlaybackControl(e){const t=jb(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(Nc.PLAY)}pause(){this.sendPlaybackControl(Nc.PAUSE)}stop(){this.sendPlaybackControl(Nc.STOP)}resetContext(){this.sendPlaybackControl(Nc.RESET_CONTEXT)}close(){this.conn.close()}}function _G(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function SG(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const NG="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function jG(n,e,t){const s=new Eq;let r;if(t.data instanceof Blob?r=JSON.parse(await t.data.text()):r=JSON.parse(t.data),n.isVertexAI()){const i=PW(n,r);Object.assign(s,i)}else{const i=EW(n,r);Object.assign(s,i)}e(s)}class CG{constructor(e,t,s){this.apiClient=e,this.auth=t,this.webSocketFactory=s,this.music=new bG(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,s,r,i,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const f=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&Pb(e.config.tools)&&Mb(f);const p=PG(f);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p);else{const O=this.apiClient.getApiKey();h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${O}`}let g=()=>{};const b=new Promise(O=>{g=O}),v=e.callbacks,_=function(){var O;(O=v==null?void 0:v.onopen)===null||O===void 0||O.call(v),g({})},N=this.apiClient,j={onopen:_,onmessage:O=>{jG(N,v.onmessage,O)},onerror:(t=v==null?void 0:v.onerror)!==null&&t!==void 0?t:function(O){},onclose:(s=v==null?void 0:v.onclose)!==null&&s!==void 0?s:function(O){}},k=this.webSocketFactory.create(h,EG(p),j);k.connect(),await b;let S=tn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&S.startsWith("publishers/")){const O=this.apiClient.getProject(),D=this.apiClient.getLocation();S=`projects/${O}/locations/${D}/`+S}let P={};this.apiClient.isVertexAI()&&((r=e.config)===null||r===void 0?void 0:r.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[ah.AUDIO]}:e.config.responseModalities=[ah.AUDIO]),!((i=e.config)===null||i===void 0)&&i.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const E=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],M=[];for(const O of E)if(this.isCallableTool(O)){const D=O;M.push(await D.tool())}else M.push(O);M.length>0&&(e.config.tools=M);const I={model:S,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?P=YH(this.apiClient,I):P=GH(this.apiClient,I),delete P.config,k.send(JSON.stringify(P)),new TG(k,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const kG={turnComplete:!0};class TG{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let s=[];try{s=Wr(e,t.turns),e.isVertexAI()?s=s.map(r=>pd(e,r)):s=s.map(r=>Pg(e,r))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:s,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let s=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?s=t.functionResponses:s=[t.functionResponses],s.length===0)throw new Error("functionResponses is required.");for(const i of s){if(typeof i!="object"||i===null||!("name"in i)||!("response"in i))throw new Error(`Could not parse function response, type '${typeof i}'.`);if(!e.isVertexAI()&&!("id"in i))throw new Error(NG)}return{toolResponse:{functionResponses:s}}}sendClientContent(e){e=Object.assign(Object.assign({},kG),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:eW(this.apiClient,e)}:t={realtimeInput:XH(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function EG(n){const e={};return n.forEach((t,s)=>{e[s]=t}),e}function PG(n){const e=new Headers;for(const[t,s]of Object.entries(n))e.append(t,s);return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const lk=10;function ck(n){var e,t,s;if(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let r=!1;for(const o of(t=n==null?void 0:n.tools)!==null&&t!==void 0?t:[])if(Cm(o)){r=!0;break}if(!r)return!0;const i=(s=n==null?void 0:n.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls;return i&&(i<0||!Number.isInteger(i))||i==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",i),!0):!1}function Cm(n){return"callTool"in n&&typeof n.callTool=="function"}function dk(n){var e;return!(!((e=n==null?void 0:n.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class MG extends Th{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var s,r,i,o,l;if(t.config&&t.config.tools&&Pb(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),Mb(t.config.httpOptions.headers)),!yG(t)||ck(t.config))return await this.generateContentInternal(t);if(xG(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,h;const f=Wr(this.apiClient,c.contents),p=(i=(r=(s=c.config)===null||s===void 0?void 0:s.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:lk;let g=0;for(;g<p&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const b=d.candidates[0].content,v=[];for(const _ of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(Cm(_)){const j=await _.callTool(d.functionCalls);v.push(...j)}g++,h={role:"user",parts:v},c.contents=Wr(this.apiClient,c.contents),c.contents.push(b),c.contents.push(h),dk(c.config)&&(f.push(b),f.push(h))}return dk(c.config)&&(d.automaticFunctionCallingHistory=f),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&Pb(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),Mb(t.config.httpOptions.headers)),ck(t.config)){const s=await this.transformCallableTools(t);return await this.generateContentStreamInternal(s)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(s=>{var r;let i;const o=[];if(s!=null&&s.generatedImages)for(const c of s.generatedImages)c&&(c!=null&&c.safetyAttributes)&&((r=c==null?void 0:c.safetyAttributes)===null||r===void 0?void 0:r.contentType)==="Positive Prompt"?i=c==null?void 0:c.safetyAttributes:o.push(c);let l;return i?l={generatedImages:o,positivePromptSafetyAttributes:i}:l={generatedImages:o},l}),this.list=async t=>{var s;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t==null?void 0:t.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((s=o.config)===null||s===void 0)&&s.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new Eg(td.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const s={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(s.referenceImages=t.referenceImages.map(r=>r.toReferenceImageAPI())),await this.editImageInternal(s)},this.upscaleImage=async t=>{let s={numberOfImages:1,mode:"upscale"};t.config&&(s=Object.assign(Object.assign({},s),t.config));const r={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:s};return await this.upscaleImageInternal(r)}}async transformCallableTools(e){var t;const s=(t=e.config)===null||t===void 0?void 0:t.tools;if(!s)return e;const r=await Promise.all(s.map(async o=>Cm(o)?await o.tool():o)),i={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:r})};return i.config.tools=r,i}async initAfcToolsMap(e){var t,s,r;const i=new Map;for(const o of(s=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&s!==void 0?s:[])if(Cm(o)){const l=o,c=await l.tool();for(const d of(r=c.functionDeclarations)!==null&&r!==void 0?r:[]){if(!d.name)throw new Error("Function declaration name is required.");if(i.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);i.set(d.name,l)}}return i}async processAfcStream(e){var t,s,r;const i=(r=(s=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&r!==void 0?r:lk;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return function(d,h,f){var p,g;return Pu(this,arguments,function*(){for(var b,v,_,N;l<i;){o&&(l++,o=!1);const P=yield ln(d.transformCallableTools(f)),E=yield ln(d.generateContentStreamInternal(P)),M=[],I=[];try{for(var j=!0,k=(v=void 0,jm(E)),S;S=yield ln(k.next()),b=S.done,!b;j=!0){N=S.value,j=!1;const O=N;if(yield yield ln(O),O.candidates&&(!((p=O.candidates[0])===null||p===void 0)&&p.content)){I.push(O.candidates[0].content);for(const D of(g=O.candidates[0].content.parts)!==null&&g!==void 0?g:[])if(l<i&&D.functionCall){if(!D.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(D.functionCall.name)){const z=yield ln(h.get(D.functionCall.name).callTool([D.functionCall]));M.push(...z)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${D.functionCall.name}`)}}}}catch(O){v={error:O}}finally{try{!j&&!b&&(_=k.return)&&(yield ln(_.call(k)))}finally{if(v)throw v.error}}if(M.length>0){o=!0;const O=new qd;O.candidates=[{content:{role:"user",parts:M}}],yield yield ln(O);const D=[];D.push(...I),D.push({role:"user",parts:M});const z=Wr(d.apiClient,f.contents).concat(D);f.contents=z}else break}})}(this,c,e)}async generateContentInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=sk(this.apiClient,e);return l=st("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=ik(this.apiClient,h),p=new qd;return Object.assign(p,f),p})}else{const d=nk(this.apiClient,e);return l=st("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=rk(this.apiClient,h),p=new qd;return Object.assign(p,f),p})}}async generateContentStreamInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=sk(this.apiClient,e);l=st("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}),o.then(function(f){return Pu(this,arguments,function*(){var p,g,b,v;try{for(var _=!0,N=jm(f),j;j=yield ln(N.next()),p=j.done,!p;_=!0){v=j.value,_=!1;const S=ik(h,yield ln(v.json())),P=new qd;Object.assign(P,S),yield yield ln(P)}}catch(k){g={error:k}}finally{try{!_&&!p&&(b=N.return)&&(yield ln(b.call(N)))}finally{if(g)throw g.error}}})})}else{const d=nk(this.apiClient,e);l=st("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}),o.then(function(f){return Pu(this,arguments,function*(){var p,g,b,v;try{for(var _=!0,N=jm(f),j;j=yield ln(N.next()),p=j.done,!p;_=!0){v=j.value,_=!1;const S=rk(h,yield ln(v.json())),P=new qd;Object.assign(P,S),yield yield ln(P)}}catch(k){g={error:k}}finally{try{!_&&!p&&(b=N.return)&&(yield ln(b.call(N)))}finally{if(g)throw g.error}}})})}}async embedContent(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=W7(this.apiClient,e);return l=st("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=W9(this.apiClient,h),p=new RC;return Object.assign(p,f),p})}else{const d=l7(this.apiClient,e);return l=st("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=j9(this.apiClient,h),p=new RC;return Object.assign(p,f),p})}}async generateImagesInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=Y7(this.apiClient,e);return l=st("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=Y9(this.apiClient,h),p=new LC;return Object.assign(p,f),p})}else{const d=d7(this.apiClient,e);return l=st("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=T9(this.apiClient,h),p=new LC;return Object.assign(p,f),p})}}async editImageInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI()){const l=t9(this.apiClient,e);return i=st("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>{const d=Z9(this.apiClient,c),h=new Sq;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI()){const l=s9(this.apiClient,e);return i=st("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>{const d=K9(this.apiClient,c),h=new Nq;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=r9(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>kb(this.apiClient,h))}else{const d=u7(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Cb(this.apiClient,h))}}async listInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=a9(this.apiClient,e);return l=st("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=eG(this.apiClient,h),p=new FC;return Object.assign(p,f),p})}else{const d=f7(this.apiClient,e);return l=st("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=P9(this.apiClient,h),p=new FC;return Object.assign(p,f),p})}}async update(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=l9(this.apiClient,e);return l=st("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>kb(this.apiClient,h))}else{const d=p7(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>Cb(this.apiClient,h))}}async delete(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=c9(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(()=>{const h=tG(),f=new $C;return Object.assign(f,h),f})}else{const d=g7(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(()=>{const h=M9(),f=new $C;return Object.assign(f,h),f})}}async countTokens(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=u9(this.apiClient,e);return l=st("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=nG(this.apiClient,h),p=new zC;return Object.assign(p,f),p})}else{const d=x7(this.apiClient,e);return l=st("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=D9(this.apiClient,h),p=new zC;return Object.assign(p,f),p})}}async computeTokens(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI()){const l=h9(this.apiClient,e);return i=st("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>{const d=sG(this.apiClient,c),h=new jq;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=m9(this.apiClient,e);return l=st("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>oG(this.apiClient,h))}else{const d=w7(this.apiClient,e);return l=st("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>R9(this.apiClient,h))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function DG(n,e){const t={},s=y(e,["operationName"]);s!=null&&x(t,["_url","operationName"],s);const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function AG(n,e){const t={},s=y(e,["operationName"]);s!=null&&x(t,["_url","operationName"],s);const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function IG(n,e){const t={},s=y(e,["operationName"]);s!=null&&x(t,["operationName"],s);const r=y(e,["resourceName"]);r!=null&&x(t,["_url","resourceName"],r);const i=y(e,["config"]);return i!=null&&x(t,["config"],i),t}function OG(n,e){const t={},s=y(e,["video","uri"]);s!=null&&x(t,["uri"],s);const r=y(e,["video","encodedVideo"]);r!=null&&x(t,["videoBytes"],vo(n,r));const i=y(e,["encoding"]);return i!=null&&x(t,["mimeType"],i),t}function RG(n,e){const t={},s=y(e,["_self"]);return s!=null&&x(t,["video"],OG(n,s)),t}function LG(n,e){const t={},s=y(e,["generatedSamples"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>RG(n,l))),x(t,["generatedVideos"],o)}const r=y(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const i=y(e,["raiMediaFilteredReasons"]);return i!=null&&x(t,["raiMediaFilteredReasons"],i),t}function FG(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["metadata"]);r!=null&&x(t,["metadata"],r);const i=y(e,["done"]);i!=null&&x(t,["done"],i);const o=y(e,["error"]);o!=null&&x(t,["error"],o);const l=y(e,["response","generateVideoResponse"]);return l!=null&&x(t,["response"],LG(n,l)),t}function $G(n,e){const t={},s=y(e,["gcsUri"]);s!=null&&x(t,["uri"],s);const r=y(e,["bytesBase64Encoded"]);r!=null&&x(t,["videoBytes"],vo(n,r));const i=y(e,["mimeType"]);return i!=null&&x(t,["mimeType"],i),t}function zG(n,e){const t={},s=y(e,["_self"]);return s!=null&&x(t,["video"],$G(n,s)),t}function UG(n,e){const t={},s=y(e,["videos"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>zG(n,l))),x(t,["generatedVideos"],o)}const r=y(e,["raiMediaFilteredCount"]);r!=null&&x(t,["raiMediaFilteredCount"],r);const i=y(e,["raiMediaFilteredReasons"]);return i!=null&&x(t,["raiMediaFilteredReasons"],i),t}function uk(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["metadata"]);r!=null&&x(t,["metadata"],r);const i=y(e,["done"]);i!=null&&x(t,["done"],i);const o=y(e,["error"]);o!=null&&x(t,["error"],o);const l=y(e,["response"]);return l!=null&&x(t,["response"],UG(n,l)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class VG extends Th{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,s=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const r=t.name.split("/operations/")[0];let i;return s&&"httpOptions"in s&&(i=s.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:r,config:{httpOptions:i}})}else return this.getVideosOperationInternal({operationName:t.name,config:s})}async getVideosOperationInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=AG(this.apiClient,e);return l=st("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>uk(this.apiClient,h))}else{const d=DG(this.apiClient,e);return l=st("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>FG(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI()){const l=IG(this.apiClient,e);return i=st("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>uk(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function BG(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],s);const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function qG(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);t!==void 0&&i!=null&&x(t,["_query","pageToken"],i);const o=y(e,["filter"]);return t!==void 0&&o!=null&&x(t,["_query","filter"],o),s}function HG(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],qG(n,s,t)),t}function WG(n,e){const t={},s=y(e,["textInput"]);s!=null&&x(t,["textInput"],s);const r=y(e,["output"]);return r!=null&&x(t,["output"],r),t}function GG(n,e){const t={};if(y(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const s=y(e,["examples"]);if(s!=null){let r=s;Array.isArray(r)&&(r=r.map(i=>WG(n,i))),x(t,["examples","examples"],r)}return t}function YG(n,e,t){const s={};if(y(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=y(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&x(t,["displayName"],r),y(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=y(e,["epochCount"]);t!==void 0&&i!=null&&x(t,["tuningTask","hyperparameters","epochCount"],i);const o=y(e,["learningRateMultiplier"]);if(o!=null&&x(s,["tuningTask","hyperparameters","learningRateMultiplier"],o),y(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(y(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=y(e,["batchSize"]);t!==void 0&&l!=null&&x(t,["tuningTask","hyperparameters","batchSize"],l);const c=y(e,["learningRate"]);return t!==void 0&&c!=null&&x(t,["tuningTask","hyperparameters","learningRate"],c),s}function ZG(n,e){const t={},s=y(e,["baseModel"]);s!=null&&x(t,["baseModel"],s);const r=y(e,["trainingDataset"]);r!=null&&x(t,["tuningTask","trainingData"],GG(n,r));const i=y(e,["config"]);return i!=null&&x(t,["config"],YG(n,i,t)),t}function KG(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["_url","name"],s);const r=y(e,["config"]);return r!=null&&x(t,["config"],r),t}function JG(n,e,t){const s={},r=y(e,["pageSize"]);t!==void 0&&r!=null&&x(t,["_query","pageSize"],r);const i=y(e,["pageToken"]);t!==void 0&&i!=null&&x(t,["_query","pageToken"],i);const o=y(e,["filter"]);return t!==void 0&&o!=null&&x(t,["_query","filter"],o),s}function QG(n,e){const t={},s=y(e,["config"]);return s!=null&&x(t,["config"],JG(n,s,t)),t}function XG(n,e,t){const s={},r=y(e,["gcsUri"]);if(t!==void 0&&r!=null&&x(t,["supervisedTuningSpec","trainingDatasetUri"],r),y(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return s}function eY(n,e){const t={},s=y(e,["gcsUri"]);return s!=null&&x(t,["validationDatasetUri"],s),t}function tY(n,e,t){const s={},r=y(e,["validationDataset"]);t!==void 0&&r!=null&&x(t,["supervisedTuningSpec"],eY(n,r));const i=y(e,["tunedModelDisplayName"]);t!==void 0&&i!=null&&x(t,["tunedModelDisplayName"],i);const o=y(e,["description"]);t!==void 0&&o!=null&&x(t,["description"],o);const l=y(e,["epochCount"]);t!==void 0&&l!=null&&x(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=y(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&x(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=y(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&x(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=y(e,["adapterSize"]);if(t!==void 0&&h!=null&&x(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),y(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(y(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return s}function nY(n,e){const t={},s=y(e,["baseModel"]);s!=null&&x(t,["baseModel"],s);const r=y(e,["trainingDataset"]);r!=null&&x(t,["supervisedTuningSpec","trainingDatasetUri"],XG(n,r,t));const i=y(e,["config"]);return i!=null&&x(t,["config"],tY(n,i,t)),t}function sY(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["model"],s);const r=y(e,["name"]);return r!=null&&x(t,["endpoint"],r),t}function DD(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["state"]);r!=null&&x(t,["state"],yD(n,r));const i=y(e,["createTime"]);i!=null&&x(t,["createTime"],i);const o=y(e,["tuningTask","startTime"]);o!=null&&x(t,["startTime"],o);const l=y(e,["tuningTask","completeTime"]);l!=null&&x(t,["endTime"],l);const c=y(e,["updateTime"]);c!=null&&x(t,["updateTime"],c);const d=y(e,["description"]);d!=null&&x(t,["description"],d);const h=y(e,["baseModel"]);h!=null&&x(t,["baseModel"],h);const f=y(e,["_self"]);f!=null&&x(t,["tunedModel"],sY(n,f));const p=y(e,["distillationSpec"]);p!=null&&x(t,["distillationSpec"],p);const g=y(e,["experiment"]);g!=null&&x(t,["experiment"],g);const b=y(e,["labels"]);b!=null&&x(t,["labels"],b);const v=y(e,["pipelineJob"]);v!=null&&x(t,["pipelineJob"],v);const _=y(e,["tunedModelDisplayName"]);return _!=null&&x(t,["tunedModelDisplayName"],_),t}function rY(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["tunedModels"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>DD(n,o))),x(t,["tuningJobs"],i)}return t}function iY(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["metadata"]);r!=null&&x(t,["metadata"],r);const i=y(e,["done"]);i!=null&&x(t,["done"],i);const o=y(e,["error"]);return o!=null&&x(t,["error"],o),t}function aY(n,e){const t={},s=y(e,["checkpointId"]);s!=null&&x(t,["checkpointId"],s);const r=y(e,["epoch"]);r!=null&&x(t,["epoch"],r);const i=y(e,["step"]);i!=null&&x(t,["step"],i);const o=y(e,["endpoint"]);return o!=null&&x(t,["endpoint"],o),t}function oY(n,e){const t={},s=y(e,["model"]);s!=null&&x(t,["model"],s);const r=y(e,["endpoint"]);r!=null&&x(t,["endpoint"],r);const i=y(e,["checkpoints"]);if(i!=null){let o=i;Array.isArray(o)&&(o=o.map(l=>aY(n,l))),x(t,["checkpoints"],o)}return t}function Db(n,e){const t={},s=y(e,["name"]);s!=null&&x(t,["name"],s);const r=y(e,["state"]);r!=null&&x(t,["state"],yD(n,r));const i=y(e,["createTime"]);i!=null&&x(t,["createTime"],i);const o=y(e,["startTime"]);o!=null&&x(t,["startTime"],o);const l=y(e,["endTime"]);l!=null&&x(t,["endTime"],l);const c=y(e,["updateTime"]);c!=null&&x(t,["updateTime"],c);const d=y(e,["error"]);d!=null&&x(t,["error"],d);const h=y(e,["description"]);h!=null&&x(t,["description"],h);const f=y(e,["baseModel"]);f!=null&&x(t,["baseModel"],f);const p=y(e,["tunedModel"]);p!=null&&x(t,["tunedModel"],oY(n,p));const g=y(e,["supervisedTuningSpec"]);g!=null&&x(t,["supervisedTuningSpec"],g);const b=y(e,["tuningDataStats"]);b!=null&&x(t,["tuningDataStats"],b);const v=y(e,["encryptionSpec"]);v!=null&&x(t,["encryptionSpec"],v);const _=y(e,["partnerModelTuningSpec"]);_!=null&&x(t,["partnerModelTuningSpec"],_);const N=y(e,["distillationSpec"]);N!=null&&x(t,["distillationSpec"],N);const j=y(e,["experiment"]);j!=null&&x(t,["experiment"],j);const k=y(e,["labels"]);k!=null&&x(t,["labels"],k);const S=y(e,["pipelineJob"]);S!=null&&x(t,["pipelineJob"],S);const P=y(e,["tunedModelDisplayName"]);return P!=null&&x(t,["tunedModelDisplayName"],P),t}function lY(n,e){const t={},s=y(e,["nextPageToken"]);s!=null&&x(t,["nextPageToken"],s);const r=y(e,["tuningJobs"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(o=>Db(n,o))),x(t,["tuningJobs"],i)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class cY extends Th{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new Eg(td.PAGED_ITEM_TUNING_JOBS,s=>this.listInternal(s),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const s=await this.tuneMldevInternal(t);let r="";return s.metadata!==void 0&&s.metadata.tunedModel!==void 0?r=s.metadata.tunedModel:s.name!==void 0&&s.name.includes("/operations/")&&(r=s.name.split("/operations/")[0]),{name:r,state:wb.JOB_STATE_QUEUED}}}}async getInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=KG(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>Db(this.apiClient,h))}else{const d=BG(this.apiClient,e);return l=st("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>DD(this.apiClient,h))}}async listInternal(e){var t,s,r,i;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=QG(this.apiClient,e);return l=st("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(h=>h.json()),o.then(h=>{const f=lY(this.apiClient,h),p=new UC;return Object.assign(p,f),p})}else{const d=HG(this.apiClient,e);return l=st("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(r=e.config)===null||r===void 0?void 0:r.httpOptions,abortSignal:(i=e.config)===null||i===void 0?void 0:i.abortSignal}).then(h=>h.json()),o.then(h=>{const f=rY(this.apiClient,h),p=new UC;return Object.assign(p,f),p})}}async tuneInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI()){const l=nY(this.apiClient,e);return i=st("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>Db(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,s;let r,i="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=ZG(this.apiClient,e);return i=st("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,r=this.apiClient.request({path:i,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(s=e.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),r.then(c=>iY(this.apiClient,c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class dY{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const uY=1024*1024*8,hY=3,fY=1e3,mY=2,mx="x-goog-upload-status";async function pY(n,e,t){var s,r,i;let o=0,l=0,c=new _b(new Response),d="upload";for(o=n.size;l<o;){const f=Math.min(uY,o-l),p=n.slice(l,l+f);l+f>=o&&(d+=", finalize");let g=0,b=fY;for(;g<hY&&(c=await t.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(f)}}}),!(!((s=c==null?void 0:c.headers)===null||s===void 0)&&s[mx]));)g++,await yY(b),b=b*mY;if(l+=f,((r=c==null?void 0:c.headers)===null||r===void 0?void 0:r[mx])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await(c==null?void 0:c.json());if(((i=c==null?void 0:c.headers)===null||i===void 0?void 0:i[mx])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function gY(n){return{size:n.size,type:n.type}}function yY(n){return new Promise(e=>setTimeout(e,n))}class xY{async upload(e,t,s){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await pY(e,t,s)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await gY(e)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class vY{create(e,t,s){return new bY(e,t,s)}}class bY{constructor(e,t,s){this.url=e,this.headers=t,this.callbacks=s}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const hk="x-goog-api-key";class wY{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(hk)===null&&e.append(hk,this.apiKey)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _Y="gl-node/";class SY{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const s=_q(e,void 0,void 0);s&&(e.httpOptions?e.httpOptions.baseUrl=s:e.httpOptions={baseUrl:s}),this.apiVersion=e.apiVersion;const r=new wY(this.apiKey);this.apiClient=new pG({auth:r,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:_Y+"web",uploader:new xY,downloader:new dY}),this.models=new MG(this.apiClient),this.live=new CG(this.apiClient,r,new vY),this.chats=new U8(this.models,this.apiClient),this.caches=new F8(this.apiClient),this.files=new eH(this.apiClient),this.operations=new VG(this.apiClient),this.tunings=new cY(this.apiClient)}}const oh="onboarding-documents",Ab="avatars",fk="support-attachments",Hd="logo",Wd="background",NY="task-attachments",jY="your-google-genai-api-key";let zi=null;zi=new SY({apiKey:jY});const Ib=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(Ib);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?Ab:oh,{data:{publicUrl:s}}=fe.storage.from(t).getPublicUrl(e.path);e.preview=s,e.url=s}for(const t in e)e[t]=Ib(e[t]);return e},Ob=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(r=>Ob(r,e,t)));const s={...n};if(s.file instanceof File){const r=s.file,i=`${e}/documents/${Date.now()}_${r.name}`,{error:o}=await fe.storage.from(oh).upload(i,r);if(o)throw o;try{await fe.from("user_documents").insert({user_id:e,submission_id:t||null,name:s.name||r.name,bucket:oh,path:i,file_type:r.type,file_size:r.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:s.name||r.name,type:r.type,size:r.size,path:i}}if(typeof s.name=="string"&&s.path)return{name:s.name,type:s.type,size:s.size,path:s.path};for(const r in s)Object.prototype.hasOwnProperty.call(s,r)&&(s[r]=await Ob(s[r],e,t));return s},CY=async n=>await(await fetch(n)).blob(),Pt=n=>{if(Array.isArray(n))return n.map(e=>Pt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=t.replace(/[A-Z]/g,r=>`_${r.toLowerCase()}`);e[s]=Pt(n[t])}return e}return n},Ve=n=>{if(Array.isArray(n))return n.map(e=>Ve(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const s=t.replace(/_([a-z])/g,r=>r[1].toUpperCase());e[s]=Ve(n[t])}return Ib(e)}return n},te={getInitialAppData:async()=>{const{data:n,error:e}=await fe.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:s}=await fe.from("roles").select("*");if(s)throw new Error("Failed to fetch user roles.");const{data:r,error:i}=await fe.from("holidays").select("*");if(i)throw new Error("Failed to fetch holidays.");return{settings:Ve(n),roles:(t||[]).map(Ve),holidays:(r||[]).map(Ve)}},getVerificationSubmissions:async(n,e)=>{let t=fe.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:s,error:r}=await t.order("created_at",{ascending:!1});if(r)throw r;return(s||[]).map(Ve)},getOnboardingDataById:async n=>{const{data:e,error:t}=await fe.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?Ve(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await fe.auth.getSession();if(!(t!=null&&t.user))throw new Error("User not authenticated");const s=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),r=await Ob(n,t.user.id,s),i={...Pt(r),id:s,user_id:t.user.id,status:e?"draft":n.status};delete i.file,delete i.confirm_account_number;const{data:o,error:l}=await fe.from("onboarding_submissions").upsert(i,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>te._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await te._saveSubmission(n,!1),t=await te.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await te._saveSubmission(n,n.status==="draft"),t=await te.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await fe.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await fe.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await fe.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return Ve(e)},deleteFile:async n=>{const{error:e}=await fe.storage.from(oh).remove([n]);if(e)throw e},uploadDocument:async(n,e=oh,t,s)=>{var d;const{data:{session:r}}=await fe.auth.getSession(),i=((d=r==null?void 0:r.user)==null?void 0:d.id)||"anonymous_user",o=`${i}/documents/${Date.now()}_${n.name}`,{error:l}=await fe.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=fe.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await fe.from("user_documents").insert({user_id:i,submission_id:t||null,name:s||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(h){console.error("Failed to insert user_documents record:",h)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await fe.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>Ve({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await fe.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(r=>Ve({...r,role:r.role_id})),s=new Map(t.map(r=>[r.id,r.name]));return t.map(r=>({...r,managerName:r.reportingManagerId?s.get(r.reportingManagerId):void 0}))},getFieldOfficers:async()=>te.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await te.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const s=new Date,r=await te.getAllAttendanceEvents(t.toISOString(),s.toISOString()),i={};r.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!i[l]||new Date(d)>new Date(i[l].timestamp))&&(i[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(i).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.filter(t=>["hr","operation_manager","admin","developer","site_manager"].includes(t.role)).map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...s}=e,r=Pt(s);if(t&&(r.role_id=t),"photo_url"in r){const{data:{session:l}}=await fe.auth.getSession();if(!(l!=null&&l.user))throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await fe.from("users").select("photo_url").eq("id",n).single(),h=d==null?void 0:d.photo_url,f=async p=>{if(p)try{const b=new URL(p).pathname.split("/public/")[1];if(b){const[v,..._]=b.split("/"),N=_.join("/");N&&await fe.storage.from(v).remove([N])}}catch(g){console.error("Failed to process old avatar URL for deletion:",g)}};if(r.photo_url&&r.photo_url.startsWith("data:")){await f(h);const p=await CY(r.photo_url),g=r.photo_url.split(";")[0].split("/")[1]||"jpg",b=`${c}/${Date.now()}.${g}`,{error:v}=await fe.storage.from(Ab).upload(b,p,{upsert:!0});if(v)throw v;const{data:{publicUrl:_}}=fe.storage.from(Ab).getPublicUrl(b);r.photo_url=_}else r.photo_url===null&&await f(h)}const{data:i,error:o}=await fe.from("users").update(r).eq("id",n).select().single();if(o)throw o;return Ve({...i,role:i.role_id})},createUser:async n=>{const{role:e,...t}=n,s=Pt(t);e&&(s.role_id=e);const{data:r,error:i}=await fe.from("users").insert(s).select().single();if(i)throw i;return Ve({...r,role:r.role_id})},deleteUser:async n=>{const{error:e}=await fe.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await fe.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await fe.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(Ve)},createOrganization:async n=>{const{data:e,error:t}=await fe.from("organizations").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await fe.from("organization_groups").select("*");if(e)throw e;const{data:t,error:s}=await fe.from("companies").select("*");if(s)throw s;const{data:r,error:i}=await fe.from("entities").select("*");if(i)throw i;const o=(n||[]).map(Ve),l=(t||[]).map(Ve),c=(r||[]).map(Ve),d=new Map;return l.forEach(h=>{const f={...h,entities:c.filter(p=>p.companyId===h.id)};d.has(h.groupId)||d.set(h.groupId,[]),d.get(h.groupId).push(f)}),o.map(h=>({...h,companies:d.get(h.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await fe.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(Ve)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await fe.from("organizations").upsert(Pt(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await fe.from("app_modules").select("*");if(e)throw e;return(n||[]).map(Ve)},saveModules:async n=>{const{error:e}=await fe.from("app_modules").upsert(Pt(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await fe.from("roles").select("*");if(e)throw e;return(n||[]).map(Ve)},saveRoles:async n=>{const{error:e}=await fe.from("roles").upsert(Pt(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await fe.from("holidays").select("*");if(e)throw e;return(n||[]).map(Ve)},addHoliday:async n=>{const{data:e,error:t}=await fe.from("holidays").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},removeHoliday:async n=>{const{error:e}=await fe.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:s,error:r}=await fe.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(r)throw r;return(s||[]).map(Ve)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:s}=await fe.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(s)throw s;return(t||[]).map(Ve)},getAttendanceDashboardData:async(n,e,t,s="UTC")=>{const{data:r,error:i}=await fe.rpc("get_attendance_dashboard_data",{start_date_iso:Ce(n,"yyyy-MM-dd"),end_date_iso:Ce(e,"yyyy-MM-dd"),current_date_iso:Ce(t,"yyyy-MM-dd"),p_timezone:s});if(i)throw new Error("Could not load attendance dashboard data from the database function.");return r},addAttendanceEvent:async n=>{const{error:e}=await fe.from("attendance_events").insert(Pt(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await fe.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const s=Ve(t),r=s.createdByUser,i=(r==null?void 0:r.name)||void 0,{createdByUser:o,...l}=s;return{...l,createdByName:i}})},getUserLocations:async n=>{const{data:e,error:t}=await fe.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(s=>{const r=s.location_id||{};return Ve(r)})},createLocation:async n=>{const e=Pt(n),{data:t,error:s}=await fe.from("locations").insert(e).select("*").single();if(s)throw s;return Ve(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await fe.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=Pt(e),{data:s,error:r}=await fe.from("locations").update(t).eq("id",n).select("*").single();if(r)throw r;return Ve(s)},deleteLocation:async n=>{const{error:e}=await fe.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await fe.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:s}=await fe.storage.from(Hd).upload(t,n,{upsert:!0});if(s)throw s;const{data:{publicUrl:r}}=fe.storage.from(Hd).getPublicUrl(t);return r},getLogos:async()=>{const{data:n,error:e}=await fe.storage.from(Hd).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:s}}=fe.storage.from(Hd).getPublicUrl(t.name);return{name:t.name,url:s}})},deleteLogo:async n=>{const{error:e}=await fe.storage.from(Hd).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:s}=await fe.storage.from(Wd).upload(t,n,{upsert:!0});if(s)throw s;const{data:{publicUrl:r}}=fe.storage.from(Wd).getPublicUrl(t);return r},getBackgroundImages:async()=>{const{data:n,error:e}=await fe.storage.from(Wd).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:s}}=fe.storage.from(Wd).getPublicUrl(t.name);return{name:t.name,url:s}})},deleteBackground:async n=>{const{error:e}=await fe.storage.from(Wd).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await fe.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!(n!=null&&n.attendance_settings))throw new Error("Attendance settings are not configured.");return Ve(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await fe.from("settings").upsert({id:"singleton",attendance_settings:Pt(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await fe.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:s}=await fe.from("recurring_holidays").insert(e).select().single();if(s)throw s;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await fe.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const s=(await te.getOrganizations()).find(r=>r.id===e);await te.createTask({name:`Visit ${(s==null?void 0:s.shortName)||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${s==null?void 0:s.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=v=>["hr","admin","finance"].includes(v)?"office":"field",{data:t,error:s}=await fe.from("settings").select("attendance_settings").eq("id","singleton").single();if(s||!(t!=null&&t.attendance_settings))throw new Error("Could not load attendance rules.");const{data:r,error:i}=await fe.from("users").select("role_id").eq("id",n).single();if(i)throw i;const o=e(r.role_id),l=Ve(t.attendance_settings)[o],[{data:c,error:d},{data:h,error:f},{data:p,error:g}]=await Promise.all([fe.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),fe.from("comp_off_logs").select("*").eq("user_id",n),fe.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",Ce(as(new Date),"yyyy-MM-dd")).lte("work_date",Ce(jr(new Date),"yyyy-MM-dd"))]);if(d||f||g)throw new Error("Failed to fetch all leave balance data.");const b={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(h||[]).length,compOffUsed:(h||[]).filter(v=>v.status==="used").length,otHoursThisMonth:(p||[]).reduce((v,_)=>v+(_.hours_worked||0),0)};return(c||[]).forEach(v=>{const _=v.day_option==="half"?.5:rr(new Date(v.end_date),new Date(v.start_date))+1;v.leave_type==="Earned"&&(b.earnedUsed+=_),v.leave_type==="Sick"&&(b.sickUsed+=_),v.leave_type==="Floating"&&(b.floatingUsed+=_)}),b},submitLeaveRequest:async n=>{const{data:e,error:t}=await fe.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:s,error:r}=await fe.from("leave_requests").insert({...Pt(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(r)throw r;return Ve(s)},getLeaveRequests:async n=>{let e=fe.from("leave_requests").select("*");n!=null&&n.userId&&(e=e.eq("user_id",n.userId)),n!=null&&n.userIds&&(e=e.in("user_id",n.userIds)),n!=null&&n.status&&(e=e.eq("status",n.status)),n!=null&&n.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n!=null&&n.startDate&&(n!=null&&n.endDate)&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:s}=await e.order("start_date",{ascending:!1});if(s)throw s;return(t||[]).map(Ve)},getTasks:async()=>{const{data:n,error:e}=await fe.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(Ve)},createTask:async n=>{const{data:e,error:t}=await fe.from("tasks").insert(Pt({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return Ve(e)},updateTask:async(n,e)=>{if(e!=null&&e.completionPhoto&&e.completionPhoto.file){const r=e.completionPhoto,i=r.file;try{const{path:o}=await te.uploadDocument(i,NY);e.completionPhoto={name:r.name,type:r.type,size:r.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:s}=await fe.from("tasks").update(Pt(e)).eq("id",n).select().single();if(s)throw s;return Ve(t)},deleteTask:async n=>{const{error:e}=await fe.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await fe.functions.invoke("run-escalations");if(e)throw e;return Ve(n)},getNotifications:async n=>{const{data:e,error:t}=await fe.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(Ve)},createNotification:async n=>{const{data:e,error:t}=await fe.from("notifications").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},markNotificationAsRead:async n=>{await fe.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await fe.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:s,role:r}=n;try{const{error:i}=await fe.functions.invoke("admin-create-user",{body:{name:e,email:t,password:s,role:r}});if(i)throw i;const l=(await te.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(i){const o=typeof(i==null?void 0:i.message)=="string"?i.message:String(i);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw i;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await fe.auth.signUp({email:t,password:s,options:{data:{name:e}}});if(c||!(l!=null&&l.user))throw c||new Error("Failed to sign up user");const d=l.user;try{await fe.from("users").upsert({id:d.id,name:e,email:t,role_id:r},{onConflict:"id"})}catch(h){console.warn("Failed to upsert user profile after fallback signup:",h)}return{id:d.id,name:e,email:t,role:r,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:r,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await fe.from("policies").select("*");if(e)throw e;return(n||[]).map(Ve)},createPolicy:async n=>{const{data:e,error:t}=await fe.from("policies").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},getInsurances:async()=>{const{data:n,error:e}=await fe.from("insurances").select("*");if(e)throw e;return(n||[]).map(Ve)},createInsurance:async n=>{const{data:e,error:t}=await fe.from("insurances").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await fe.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!(n!=null&&n.approval_workflow_settings))throw new Error("Approval workflow settings are not configured.");return Ve(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await fe.from("settings").update({approval_workflow_settings:Pt({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:s}=await fe.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{finalConfirmationRole:r}=await te.getApprovalWorkflowSettings(),{data:i}=await fe.from("users").select("id").eq("role_id",r).limit(1).single(),{data:o,error:l}=await fe.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:h}=await fe.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:i==null?void 0:i.id,approval_history:d}).eq("id",n);if(h)throw h},rejectLeaveRequest:async(n,e,t="")=>{const{data:s,error:r}=await fe.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{data:i,error:o}=await fe.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:i.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...s.approval_history||[],l],{error:d}=await fe.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:s}=await fe.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(s)throw s;const{data:r,error:i}=await fe.from("users").select("name").eq("id",e).single();if(i)throw i;const o={approver_id:e,approver_name:r.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await fe.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:h}=await fe.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(h&&h.code!=="PGRST116")throw h;d&&await fe.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await fe.from("extra_work_logs").insert(Pt({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=fe.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:s}=await e.order("work_date",{ascending:!1});if(s)throw s;return(t||[]).map(Ve)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:s}=await fe.from("users").select("name").eq("id",e).single();if(s)throw s;const{data:r,error:i}=await fe.from("extra_work_logs").select("*").eq("id",n).single();if(i)throw i;if(!r)throw new Error("Claim not found.");const{error:o}=await fe.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;r.claim_type==="Comp Off"&&await te.addCompOffLog({userId:r.user_id,userName:r.user_name,dateEarned:r.work_date,reason:`Claim approved: ${r.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:s,error:r}=await fe.from("users").select("name").eq("id",e).single();if(r)throw r;const{error:i}=await fe.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:s.name,rejection_reason:t}).eq("id",n);if(i)throw i},getManpowerDetails:async n=>{const{data:e,error:t}=await fe.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return Ve(e)},addCompOffLog:async n=>{const{data:e,error:t}=await fe.from("comp_off_logs").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:s,error:r}=await fe.from(t).select("*");if(r)throw new Error(`Failed to export ${t}`);e[t]=s}return Ve(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(s=>n.toLowerCase().includes(s.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,s)=>{if(!zi)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const i=(await zi.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${s||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(i)},crossVerifyNames:async(n,e)=>{if(!zi){const r=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:r,reason:r?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const s=(await zi.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:De.OBJECT,properties:{isMatch:{type:De.BOOLEAN},reason:{type:De.STRING}}}}})).text.trim();return JSON.parse(s)},verifyFingerprintImage:async(n,e)=>{if(!zi)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const s=(await zi.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:De.OBJECT,properties:{containsFingerprints:{type:De.BOOLEAN},reason:{type:De.STRING}}}}})).text.trim();return JSON.parse(s)},enhanceDocumentPhoto:async(n,e)=>{if(!zi)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await zi.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[ah.IMAGE]}});for(const s of t.candidates[0].content.parts)if(s.inlineData)return s.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await fe.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(Ve)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await fe.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(Ve)},checkCompOffTableExists:async()=>{const{error:n}=await fe.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await fe.from("back_office_id_series").select("*");if(e)throw e;return(n||[]).map(Ve)},updateBackOfficeIdSeries:async n=>{const{error:e}=await fe.from("back_office_id_series").upsert(Pt(n),{onConflict:"id"});if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await fe.from("site_staff_designations").upsert(Pt(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await fe.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(Ve)},submitUniformRequest:async n=>{const{data:e,error:t}=await fe.from("uniform_requests").insert(Pt(n)).select().single();if(t)throw t;return Ve(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await fe.from("uniform_requests").update(Pt(n)).eq("id",n.id).select().single();if(t)throw t;return Ve(e)},deleteUniformRequest:async n=>{const{error:e}=await fe.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await fe.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(Ve)},getSupportTicketById:async n=>{const{data:e,error:t}=await fe.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return Ve(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:r}=await te.uploadDocument(e.file,fk);n.attachment={name:e.name,type:e.type,size:e.size,path:r}}catch(r){console.error("Failed to upload support ticket attachment:",r),delete n.attachment}const{data:t,error:s}=await fe.from("support_tickets").insert(Pt(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return Ve(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:i}=await te.uploadDocument(t.file,fk);e.attachment={name:t.name,type:t.type,size:t.size,path:i}}catch(i){console.error("Failed to upload updated support ticket attachment:",i),delete e.attachment}const{data:s,error:r}=await fe.from("support_tickets").update(Pt(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return Ve(s)},addTicketPost:async(n,e)=>{const{data:t,error:s}=await fe.from("ticket_posts").insert(Pt(e)).select("*, comments:ticket_comments(*)").single();if(s)throw s;return Ve(t)},togglePostLike:async(n,e)=>{const{data:t,error:s}=await fe.from("ticket_posts").select("likes").eq("id",n).single();if(s)throw s;const r=t.likes||[],i=r.includes(e)?r.filter(l=>l!==e):[...r,e],{error:o}=await fe.from("ticket_posts").update({likes:i}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:s}=await fe.from("ticket_comments").insert(Pt(e)).select().single();if(s)throw s;return Ve(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:s}=await fe.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(s)throw s;return(t||[]).map(r=>{const i=Ve(r);return{id:i.id,employeeId:i.personal.employeeId,employeeName:`${i.personal.firstName} ${i.personal.lastName}`,enrollmentDate:i.enrollmentDate,totalCost:0,breakdown:i.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await Aj(async()=>{const{default:s}=await import("./html2pdf-D3lIxS6s.js").then(r=>r.h);return{default:s}},[])).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,h]=c.split(",").map(Number);return{lat:d,lon:h}}),s={},r=[],i=t.map(c=>c.lat),{data:o,error:l}=await fe.from("location_cache").select("*").in("latitude",i);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),h=e(parseFloat(c.longitude)),f=`${d},${h}`;t.some(p=>e(p.lat)===d&&e(p.lon)===h)&&(s[f]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;s[d]||r.push(c)}),console.log("Geocoding API: Found",Object.keys(s).length,"cached,",r.length,"missing");for(const c of r)try{const d=await Aj(()=>Promise.resolve().then(()=>TY),void 0).then(f=>f.reverseGeocode(c.lat,c.lon)),h=`${e(c.lat)},${e(c.lon)}`;s[h]=d,await fe.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",h,"->",d),await new Promise(f=>setTimeout(f,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const h=`${e(c.lat)},${e(c.lon)}`;s[h]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return s},sendSecurityAlert:async(n,e,t,s)=>{const{data:r,error:i}=await fe.from("users").select("reporting_manager_id").eq("id",n).single();if(i||!(r!=null&&r.reporting_manager_id)){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=s?` using device: ${s}`:"";await te.createNotification({userId:r.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,s)=>{const{data:r,error:i}=await fe.from("users").select("reporting_manager_id").eq("id",n).single();if(i||!(r!=null&&r.reporting_manager_id)){console.warn("Could not find reporting manager for device change alert");return}await te.createNotification({userId:r.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${s}`,type:"info",link:"/user-management"})}},kY=(n,e,t="Operation timed out")=>{const s=new Promise((r,i)=>{setTimeout(()=>i(new Error(t)),e)});return Promise.race([n,s])};function Rb(n,e,t,s){const r=h=>h*Math.PI/180,o=r(t-n),l=r(s-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(r(n))*Math.cos(r(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function lh(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const s=`https://nominatim.openstreetmap.org/reverse?format=jsonv2&lat=${n}&lon=${e}&zoom=16&addressdetails=1`,r=await fetch(s);if(!r.ok)return t;const i=await r.json();if(i.display_name)return i.display_name;if(i.address){const{road:o,suburb:l,city:c,village:d,town:h,state:f,country:p}=i.address;return[o,l,c||d||h,f,p].filter(Boolean).join(", ")}return t}catch(s){return console.warn("Reverse geocode failed:",s),t}}function Mg(n=50,e=1e4){return new Promise((t,s)=>{if(!("geolocation"in navigator))return s(new Error("Geolocation is not supported by this browser."));let r=null;const i=setTimeout(()=>{r?(navigator.geolocation.clearWatch(o),t(r)):(navigator.geolocation.clearWatch(o),s(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!r||l.coords.accuracy<r.coords.accuracy)&&(r=l),l.coords.accuracy<=n&&(clearTimeout(i),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(i),navigator.geolocation.clearWatch(o),s(l)},{enableHighAccuracy:!0,maximumAge:0})})}const TY=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:Rb,getPrecisePosition:Mg,reverseGeocode:lh},Symbol.toStringTag,{value:"Module"})),Rf=n=>n.includes("timed out")?n:n.includes("Invalid API key")?"Connection to the backend failed: The API key is invalid. Please contact the administrator to correct the configuration.":n.toLowerCase().includes("failed to fetch")?`Network error: Could not connect to Supabase. This is often a CORS issue. Please go to your Supabase project's "Authentication" > "URL Configuration" settings and add your app's URL to the "Redirect URLs" list. For local development, this is typically http://localhost:5173 or similar.`:n.includes("Invalid login credentials")?"Invalid email or password. Please try again.":n.includes("User already registered")?"An account with this email address already exists. Please sign in or reset your password.":n.includes("Email not confirmed")?"Please confirm your email address before logging in.":n.includes("too many requests")?"Too many attempts. Please try again later or reset your password.":(console.error("Unhandled Supabase auth error:",n),"An unexpected error occurred. Please try again or contact support."),px=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},tt=ei()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null}),setError:t=>n({error:t}),loginWithEmail:async(t,s,r)=>{n({error:null,loading:!0});try{const{data:i,error:o}=await kY(mi.signInWithPassword(t,s),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!i.user||!i.session){const c=Rf((o==null?void 0:o.message)||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}r?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",i.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await mi.getAppUserProfile(i.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=px();await te.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await mi.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(i){console.error("Unexpected error during login flow:",i);const o=Rf("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,s,r)=>{n({error:null,loading:!0});const{error:i}=await mi.signUpWithPassword({email:s,password:r,options:{data:{name:t}}});return i?(n({error:Rf(i.message),loading:!1}),{error:{message:i.message}}):(n({loading:!1}),{error:null})},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await mi.signInWithGoogle();return t?(n({error:Rf(t.message),loading:!1}),{error:{message:t.message}}):(n({loading:!1}),{error:null})},sendPasswordReset:async t=>{const{error:s}=await mi.resetPasswordForEmail(t);return s?{error:{message:s.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const s=px(),r=new Date().getHours()>=20?"Good Night":s;await te.createNotification({userId:t.id,message:`${r}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(s){console.error("Failed to send logout farewell notification",s)}localStorage.removeItem("supabase.auth.rememberMe"),await mi.signOut()},updateUserProfile:t=>n(s=>({user:s.user?{...s.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const s=new Date,r=new Date(s.getFullYear(),s.getMonth(),s.getDate(),0,0,0,0).toISOString(),i=new Date(s.getFullYear(),s.getMonth(),s.getDate(),23,59,59,999).toISOString(),o=await te.getAttendanceEvents(t.id,r,i);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((h,f)=>new Date(h.timestamp).getTime()-new Date(f.timestamp).getTime());const l=o.find(h=>h.type==="check-in"),c=[...o].reverse().find(h=>h.type==="check-out"),d=o[o.length-1];n({isCheckedIn:(d==null?void 0:d.type)==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(s){console.error("Failed to check attendance status:",s),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:s}=e();if(!t)return{success:!1,message:"User not found"};const r=s?"check-out":"check-in";try{let i=null;try{i=await Mg()}catch{}(!i||!i.coords)&&(i=await new Promise(f=>{navigator.geolocation.getCurrentPosition(p=>f(p),()=>f(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(f,p,g)=>{await te.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:r,latitude:f,longitude:p,locationId:g}),await e().checkAttendanceStatus();try{const b=px(),v=r==="check-in"?"checking in":"checking out";await te.createNotification({userId:t.id,message:`${b}, ${t.name||"there"}! Thanks for ${v}.`,type:"greeting"})}catch(b){console.warn("Failed to send user attendance notification",b)}try{const b=await te.getAttendanceSettings(),_=["admin","hr","finance","developer"].includes(t.role)?b==null?void 0:b.office:b==null?void 0:b.field;if(_!=null&&_.enableAttendanceNotifications){const N=[];t.reportingManagerId&&N.push({id:t.reportingManagerId});const j=await te.getNearbyUsers();for(const E of j)N.find(M=>M.id===E.id)||N.push({id:E.id});const k=t.name||"An employee",S=g?"":f&&p?` at ${f.toFixed(4)}, ${p.toFixed(4)}`:"",P=`${k} ${r.replace("-"," ")}${S}`;await Promise.all(N.map(E=>te.createNotification({userId:E.id,message:P,type:"greeting"})))}}catch(b){console.warn("Failed to create manager notifications:",b)}return{success:!0,message:`Successfully ${r.replace("-"," ")}!`}};if(!i||!i.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=i.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let h=null;try{const f=await te.getUserLocations(t.id);for(const p of f)if(Rb(l,c,p.latitude,p.longitude)<=p.radius){h=p.id;break}if(!h){const p=await te.getLocations();for(const g of p)if(Rb(l,c,g.latitude,g.longitude)<=g.radius){h=g.id;try{await te.assignLocationToUser(t.id,g.id)}catch(v){console.warn("Failed to autoassign location to user:",v)}break}}}catch(f){console.warn("Geofencing check failed:",f)}if(!h)try{let f=null;try{f=await lh(l,c)}catch(b){console.warn("Reverse geocode failed for new location:",b)}const g=await te.createLocation({name:f||null,latitude:l,longitude:c,radius:100,address:f||null,createdBy:t.id});try{await te.assignLocationToUser(t.id,g.id)}catch(b){console.warn("Failed to autoassign new location to user:",b)}h=g.id}catch(f){console.warn("Failed to create a new geofence location:",f),h=null}return await o(l,c,h)}catch(i){return console.error("Error during attendance update:",i),{success:!1,message:"Failed to update attendance."}}}})),EY={};function Pl(n,e){let t;try{t=n()}catch{return}return{getItem:r=>{var i;const o=c=>c===null?null:JSON.parse(c,void 0),l=(i=t.getItem(r))!=null?i:null;return l instanceof Promise?l.then(o):o(l)},setItem:(r,i)=>t.setItem(r,JSON.stringify(i,void 0)),removeItem:r=>t.removeItem(r)}}const ch=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(s){return ch(s)(t)},catch(s){return this}}}catch(t){return{then(s){return this},catch(s){return ch(s)(t)}}}},PY=(n,e)=>(t,s,r)=>{let i={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:_=>_,version:0,merge:(_,N)=>({...N,..._}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=i.getStorage()}catch{}if(!d)return n((..._)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(..._)},s,r);const h=ch(i.serialize),f=()=>{const _=i.partialize({...s()});let N;const j=h({state:_,version:i.version}).then(k=>d.setItem(i.name,k)).catch(k=>{N=k});if(N)throw N;return j},p=r.setState;r.setState=(_,N)=>{p(_,N),f()};const g=n((..._)=>{t(..._),f()},s,r);let b;const v=()=>{var _;if(!d)return;o=!1,l.forEach(j=>j(s()));const N=((_=i.onRehydrateStorage)==null?void 0:_.call(i,s()))||void 0;return ch(d.getItem.bind(d))(i.name).then(j=>{if(j)return i.deserialize(j)}).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==i.version){if(i.migrate)return i.migrate(j.state,j.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return j.state}).then(j=>{var k;return b=i.merge(j,(k=s())!=null?k:g),t(b,!0),f()}).then(()=>{N==null||N(b,void 0),o=!0,c.forEach(j=>j(b))}).catch(j=>{N==null||N(void 0,j)})};return r.persist={setOptions:_=>{i={...i,..._},_.getStorage&&(d=_.getStorage())},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>v(),hasHydrated:()=>o,onHydrate:_=>(l.add(_),()=>{l.delete(_)}),onFinishHydration:_=>(c.add(_),()=>{c.delete(_)})},v(),b||g},MY=(n,e)=>(t,s,r)=>{let i={storage:Pl(()=>localStorage),partialize:v=>v,version:0,merge:(v,_)=>({..._,...v}),...e},o=!1;const l=new Set,c=new Set;let d=i.storage;if(!d)return n((...v)=>{console.warn(`[zustand persist middleware] Unable to update item '${i.name}', the given storage is currently unavailable.`),t(...v)},s,r);const h=()=>{const v=i.partialize({...s()});return d.setItem(i.name,{state:v,version:i.version})},f=r.setState;r.setState=(v,_)=>{f(v,_),h()};const p=n((...v)=>{t(...v),h()},s,r);r.getInitialState=()=>p;let g;const b=()=>{var v,_;if(!d)return;o=!1,l.forEach(j=>{var k;return j((k=s())!=null?k:p)});const N=((_=i.onRehydrateStorage)==null?void 0:_.call(i,(v=s())!=null?v:p))||void 0;return ch(d.getItem.bind(d))(i.name).then(j=>{if(j)if(typeof j.version=="number"&&j.version!==i.version){if(i.migrate)return[!0,i.migrate(j.state,j.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,j.state];return[!1,void 0]}).then(j=>{var k;const[S,P]=j;if(g=i.merge(P,(k=s())!=null?k:p),t(g,!0),S)return h()}).then(()=>{N==null||N(g,void 0),g=s(),o=!0,c.forEach(j=>j(g))}).catch(j=>{N==null||N(void 0,j)})};return r.persist={setOptions:v=>{i={...i,...v},v.storage&&(d=v.storage)},clearStorage:()=>{d==null||d.removeItem(i.name)},getOptions:()=>i,rehydrate:()=>b(),hasHydrated:()=>o,onHydrate:v=>(l.add(v),()=>{l.delete(v)}),onFinishHydration:v=>(c.add(v),()=>{c.delete(v)})},i.skipHydration||b(),g||p},DY=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((EY?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),PY(n,e)):MY(n,e),gd=DY,Eh=ei(gd(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:Pl(()=>localStorage)})),AY={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},bo=ei()(n=>({...AY,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),IY={admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},pa=ei(gd((n,e)=>({permissions:IY,initRoles:t=>{if(!t)return;const r={...e().permissions};let i=!1;t.forEach(o=>{r[o.id]||(r[o.id]=[],i=!0)}),i&&n({permissions:r})},addRolePermissionEntry:t=>{n(s=>({permissions:{...s.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(s=>{const r={...s.permissions};return delete r[t],{permissions:r}})},renameRolePermissionEntry:(t,s)=>{n(r=>{const i={...r.permissions};return i[t]&&(i[s]=i[t],delete i[t]),{permissions:i}})},setRolePermissions:(t,s)=>{n(r=>({permissions:{...r.permissions,[t]:s}}))}}),{name:"paradigm_app_permissions",storage:Pl(()=>localStorage)})),OY={enablePincodeVerification:!0},RY={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},LY={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},FY={enabled:!0,clientId:"",clientSecret:""},$Y={enabled:!0},zY={enabled:!0},UY={email:{enabled:!1}},VY=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],BY={enableProvisionalSites:!1},ir=ei()(gd(n=>({address:OY,attendance:RY,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:LY,perfiosApi:FY,geminiApi:$Y,otp:zY,notifications:UY,verificationCosts:VY,siteManagement:BY,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:s,recurringHolidays:r}=e,i=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:i,fieldHolidays:o,attendance:s,recurringHolidays:r||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const s=await te.addHoliday({...t,type:e});n(r=>{const i=e==="office"?"officeHolidays":"fieldHolidays",o=[...r[i],s].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[i]:o}})},removeHoliday:async(e,t)=>{await te.removeHoliday(t),n(s=>{const r=e==="office"?"officeHolidays":"fieldHolidays";return{[r]:s[r].filter(i=>i.id!==t)}})},addRecurringHoliday:async e=>{const t=await te.addRecurringHoliday(e);n(s=>({recurringHolidays:[...s.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await te.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(s=>s.id!==e)}))}}),{name:"paradigm_app_settings",storage:Pl(()=>localStorage)})),Nt=n=>{const[e,t]=C.useState(window.matchMedia(n).matches);return C.useEffect(()=>{const s=window.matchMedia(n),r=()=>t(s.matches);try{s.addEventListener("change",r)}catch{s.addListener(r)}return()=>{try{s.removeEventListener("change",r)}catch{s.removeListener(r)}}},[n]),e},mk=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:Ce(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),rn=ei(n=>({data:mk(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(s=>({data:{...s.data,address:{...s.data.address,[e]:{...s.data.address[e],verifiedStatus:{...s.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const s=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),r=s.find(i=>i.name===e);return r?r.count+=1:s.push({name:e,count:1}),{data:{...t.data,verificationUsage:s}}}),reset:()=>n({data:mk()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(s=>({data:{...s.data,family:s.data.family.map(r=>r.id===e?{...r,...t}:r)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(s=>s.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(s=>({data:{...s.data,education:s.data.education.map(r=>r.id===e?{...r,...t}:r)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(s=>s.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:s}=e.data,{emergencyContactName:r,emergencyContactNumber:i,relationship:o}=t;if(r&&["Spouse","Child","Father","Mother"].includes(o)){const c=s.find(d=>d.name.toLowerCase()===r.toLowerCase()&&d.relation===o);if(c){if(c.phone!==i){const d=s.map(h=>h.id===c.id?{...h,phone:i}:h);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:r,relation:o,phone:i,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...s,d]}}}}return e})}));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qY=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),AD=(...n)=>n.filter((e,t,s)=>!!e&&s.indexOf(e)===t).join(" ");/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HY={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WY=C.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:s,className:r="",children:i,iconNode:o,...l},c)=>C.createElement("svg",{ref:c,...HY,width:e,height:e,stroke:n,strokeWidth:s?Number(t)*24/Number(e):t,className:AD("lucide",r),...l},[...o.map(([d,h])=>C.createElement(d,h)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const be=(n,e)=>{const t=C.forwardRef(({className:s,...r},i)=>C.createElement(WY,{ref:i,iconNode:e,className:AD(`lucide-${qY(n)}`,s),...r}));return t.displayName=`${n}`,t};/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GY=be("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Er=be("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YY=be("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZY=be("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KY=be("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JY=be("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QY=be("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dh=be("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XY=be("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ID=be("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bl=be("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eZ=be("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tZ=be("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nZ=be("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sZ=be("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wl=be("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bw=be("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rZ=be("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ol=be("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ml=be("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ph=be("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _l=be("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iZ=be("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aZ=be("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oZ=be("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lZ=be("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kr=be("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pk=be("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cZ=be("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qw=be("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hw=be("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OD=be("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ww=be("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dZ=be("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RD=be("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lb=be("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const or=be("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uZ=be("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=be("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hZ=be("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fZ=be("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LD=be("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fb=be("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bs=be("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mZ=be("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pZ=be("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gZ=be("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FD=be("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yZ=be("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xZ=be("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $D=be("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vZ=be("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gw=be("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yw=be("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bZ=be("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zD=be("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=be("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const km=be("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wZ=be("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UD=be("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uh=be("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VD=be("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _Z=be("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qe=be("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $b=be("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SZ=be("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mu=be("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BD=be("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mh=be("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const io=be("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qD=be("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NZ=be("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zw=be("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jZ=be("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CZ=be("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kw=be("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kZ=be("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jw=be("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HD=be("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TZ=be("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ct=be("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zb=be("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EZ=be("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cs=be("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=be("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qw=be("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dg=be("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xw=be("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dh=be("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WD=be("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PZ=be("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gk=be("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ag=be("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MZ=be("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e_=be("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jn=be("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GD=be("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YD=be("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZD=be("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DZ=be("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AZ=be("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=be("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IZ=be("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jr=be("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ao=be("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nd=be("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sd=be("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const t_=be("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yd=be("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ei=be("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KD=be("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JD=be("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Us=be("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OZ=be("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.378.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RZ=be("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]),Lf="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",n_="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",s_=ei(gd(n=>({currentLogo:Lf,defaultLogo:Lf,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:Lf,defaultLogo:Lf})}),{name:"paradigm-app-logo",storage:Pl(()=>localStorage)})),Qr=({className:n="",localPath:e})=>{const t=s_(r=>r.currentLogo),s=e||t;return a.jsx("img",{src:s,alt:"Paradigm Logo",className:`w-auto object-contain ${!n.includes("h-")&&"h-10"} ${n}`})},Y=({children:n,className:e="",variant:t="primary",size:s="md",isLoading:r=!1,...i})=>{const o="btn",l=`btn-${t}`,c=`btn-${s}`;return a.jsx("button",{className:`${o} ${l} ${c} ${e}`,disabled:r||i.disabled,...i,children:r?a.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[a.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),a.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},QD=ei(gd(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:Pl(()=>localStorage)})),yk=async n=>{try{return(await navigator.permissions.query({name:n})).state}catch(e){return console.error(`Permission query for '${n}' failed`,e),"prompt"}},xk=n=>{const[e,t]=C.useState("prompt"),s=async()=>{try{let r=!1;if(n==="camera"?((await navigator.mediaDevices.getUserMedia({video:!0})).getTracks().forEach(o=>o.stop()),r=!0):n==="geolocation"&&(await new Promise((i,o)=>{navigator.geolocation.getCurrentPosition(i,o,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),r=!0),r)return t("granted"),!0;{const i=await yk(n);return t(i),i==="granted"}}catch{return t("denied"),!1}};return C.useState(()=>{yk(n).then(t)}),{status:e,request:s}},r_=({isOpen:n,onClose:e,onCapture:t,captureGuidance:s="none"})=>{const r=C.useRef(null),i=C.useRef(null),o=C.useRef(null),[l,c]=C.useState(null),[d,h]=C.useState(null),[f,p]=C.useState(!1),[g,b]=C.useState(""),[v,_]=C.useState([]),[N,j]=C.useState(0),[k,S]=C.useState(!1),[P,E]=C.useState(!1),[M,I]=C.useState(!1),[O,D]=C.useState(!1),[z,H]=C.useState(),F=C.useCallback(()=>{o.current&&(o.current.getTracks().forEach(Q=>Q.stop()),o.current=null)},[]),R=C.useCallback(async Q=>{F(),c(null),S(!1);try{const le={video:Q?{deviceId:{exact:Q}}:{facingMode:"environment"}},X=await navigator.mediaDevices.getUserMedia(le);o.current=X,r.current&&(r.current.srcObject=X),h(null);const Z=X.getVideoTracks()[0];if(Z){const se=Z.getCapabilities();E(!!se.torch),H(Z.getSettings().facingMode)}else E(!1)}catch(le){console.error("Error accessing camera:",le),le instanceof Error?h(`Could not access camera: ${le.name}. Please check permissions and ensure it is not in use by another app.`):h("Could not access camera. Please check permissions and ensure it is not in use by another app.")}},[F]);C.useEffect(()=>{if(!n){F();return}let Q=!1;return(async()=>{try{const X=await navigator.mediaDevices.getUserMedia({video:!0});if(Q){X.getTracks().forEach(G=>G.stop());return}const se=(await navigator.mediaDevices.enumerateDevices()).filter(G=>G.kind==="videoinput");if(X.getTracks().forEach(G=>G.stop()),Q)return;if(_(se),se.length>0){let G=N;G>=se.length&&(G=0),await R(se[G].deviceId)}else h("No camera found on this device.")}catch(X){console.error("Error setting up camera:",X),h("Could not access camera. Please check permissions.")}})(),()=>{Q=!0,F()}},[n,N,R,F]);const V=()=>{if(r.current&&i.current){const Q=r.current,le=i.current;le.width=Q.videoWidth,le.height=Q.videoHeight;const X=le.getContext("2d");X==null||X.drawImage(Q,0,0,Q.videoWidth,Q.videoHeight);const Z=le.toDataURL("image/jpeg",.9);c(Z),F()}},U=()=>{z==="user"&&M?(D(!0),setTimeout(()=>{V(),D(!1)},100)):V()},W=()=>{h(null),c(null)},B=async()=>{if(!o.current||!P)return;const Q=o.current.getVideoTracks()[0];try{await Q.applyConstraints({advanced:[{torch:!k}]}),S(!k)}catch(le){console.error("Failed to toggle flash",le),h("Could not control the flash.")}},q=async()=>{if(l){p(!0);try{const Q=l.split(",")[1];b("Enhancing photo with AI...");const le=s==="document"?await te.enhanceDocumentPhoto(Q,"image/jpeg"):null,X=le||Q;le&&c(`data:image/jpeg;base64,${le}`),b("Processing..."),t(X,"image/jpeg"),e()}catch(Q){h(Q.message||"Processing failed. Please try again.")}finally{p(!1)}}};return n?a.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-black text-white",role:"dialog","aria-modal":"true","aria-labelledby":"camera-modal-title",children:[O&&a.jsx("div",{className:"absolute inset-0 bg-white z-50"}),f&&a.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80 backdrop-blur-sm",children:[a.jsx(Qe,{className:"h-12 w-12 animate-spin text-white"}),a.jsx("p",{className:"mt-4 text-lg font-semibold",children:g})]}),a.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/50 to-transparent z-20 flex justify-between items-center",children:[a.jsx("h3",{id:"camera-modal-title",className:"text-lg font-bold",children:"Capture Photo"}),a.jsx(Y,{variant:"icon",className:"!text-white hover:!bg-white/20",size:"sm",onClick:e,"aria-label":"Close camera",children:a.jsx(Us,{className:"h-6 w-6"})})]}),a.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden",children:[d&&a.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),a.jsx("video",{ref:r,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`,title:"Live camera feed"}),l&&a.jsx("img",{src:l,alt:"Captured preview",className:"w-full h-full object-contain"}),a.jsx("canvas",{ref:i,className:"hidden","aria-hidden":"true"})]}),a.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-20",children:[d&&!l&&a.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),a.jsx("div",{className:"flex justify-around items-center",children:l?a.jsxs(a.Fragment,{children:[a.jsx(Y,{onClick:W,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:a.jsx(zb,{className:"h-6 w-6"})}),a.jsx(Y,{onClick:q,size:"lg",className:"!rounded-full !p-4",children:a.jsx(ol,{className:"h-6 w-6"})})]}):a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[z==="environment"&&P&&a.jsx(Y,{onClick:B,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3","aria-label":k?"Turn off flash":"Turn on flash",children:k?a.jsx(OZ,{className:"h-6 w-6"}):a.jsx(RZ,{className:"h-6 w-6"})}),z==="user"&&a.jsx(Y,{onClick:()=>I(!M),variant:"icon",className:`!rounded-full !p-3 ${M?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,"aria-label":M?"Turn off screen flash":"Turn on screen flash",children:a.jsx(DZ,{className:"h-6 w-6"})})]}),a.jsx(Y,{onClick:U,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20","aria-label":"Capture photo",children:a.jsx(Bw,{className:"h-8 w-8"})}),a.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:v.length>1&&a.jsx(Y,{onClick:()=>j(Q=>(Q+1)%v.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3","aria-label":"Switch camera",children:a.jsx(zb,{className:"h-6 w-6"})})})]})})]})]}):null},yn=({isOpen:n,onClose:e,onConfirm:t,title:s,children:r,confirmButtonVariant:i="danger",confirmButtonText:o="Confirm",isConfirming:l=!1})=>n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text",children:s}),a.jsx("div",{className:"mt-2 text-sm text-muted",children:r}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{onClick:t,variant:i,isLoading:l,children:o})]})]})}):null,LZ=({isOpen:n,onClose:e,permissionName:t})=>a.jsx(yn,{isOpen:n,onClose:e,onConfirm:e,title:`${t} Permission Required`,children:a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(Xw,{className:"h-10 w-10 text-yellow-500"})}),a.jsx("p",{className:"mb-4",children:`To use this feature, you need to grant ${t.toLowerCase()} access.`}),a.jsx("p",{className:"mb-6 text-sm text-muted",children:`It looks like you have previously denied this permission. Please go to your device's settings, find this app, and enable the ${t.toLowerCase()} permission.`}),a.jsx(Y,{onClick:e,children:"Got it"})]})}),gt=({message:n,type:e,onDismiss:t})=>{C.useEffect(()=>{const i=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(i)}},[t]);const s=e==="success"?"bg-green-500":"bg-red-500",r=e==="success"?Kr:qw;return a.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${s}`,children:[a.jsx(r,{className:"h-6 w-6 mr-3"}),a.jsx("span",{className:"text-sm font-medium",children:n}),a.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:a.jsx(Us,{className:"h-5 w-5"})})]})},Ff=24,vk=24,Tm=56,bk=(n,e,t)=>{const s=Tm/2,r=64,i=16,o=e+t/2,l=o-s-8,c=o+s+8,d=s*.8;return[`M 0 ${i}`,`A ${i} ${i} 0 0 1 ${i} 0`,`L ${l-i} 0`,`C ${l-d} 0, ${o-s} ${r*.6}, ${o} ${r*.6}`,`C ${o+s} ${r*.6}, ${c+d} 0, ${c+i} 0`,`L ${n-i} 0`,`A ${i} ${i} 0 0 1 ${n} ${i}`,`L ${n} ${r}`,`L 0 ${r}`,"Z"].join(" ")},FZ=({isOpen:n,style:e,className:t})=>a.jsxs("div",{style:e,className:`relative ${t}`,children:[a.jsx(NZ,{className:`absolute transition-all duration-300 ease-in-out ${n?"opacity-0 rotate-90 scale-50":"opacity-100 rotate-0 scale-100"}`}),a.jsx(Us,{className:`absolute transition-all duration-300 ease-in-out ${n?"opacity-100 rotate-0 scale-100":"opacity-0 -rotate-90 scale-50"}`})]}),$Z=({user:n,permissions:e,setIsMobileMenuOpen:t,isMobileMenuOpen:s})=>{const r=Ns(),i=C.useRef(null),o=C.useRef(new Map),[l,c]=C.useState(""),[d,h]=C.useState({}),{isCheckedIn:f,toggleCheckInStatus:p}=tt(),[g,b]=C.useState(!1),[v,_]=C.useState(!1),[N,j]=C.useState("Camera"),[k,S]=C.useState(null),[P,E]=C.useState(null);xk("geolocation"),xk("camera");const M=async(D,z)=>{b(!1);try{const H=await new Promise((U,W)=>{navigator.geolocation.getCurrentPosition(U,W,{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}),{latitude:F,longitude:R}=H.coords,V=`data:${z};base64,${D}`;if(k==="check-in"){const{success:U,message:W}=await p();E({message:W,type:U?"success":"error"})}else if(k==="check-out"){const{success:U,message:W}=await p();E({message:W,type:U?"success":"error"})}}catch(H){E({message:H.message||`Failed to ${k}.`,type:"error"})}finally{S(null)}},I=C.useMemo(()=>{const D=[],z=e.includes("manage_tasks")?"/tasks":"/onboarding/tasks";return D.push({key:"tasks",to:z,label:"Tasks",icon:Hw,end:!1}),e.includes("access_support_desk")&&D.push({key:"support",to:"/support",label:"Support",icon:uh,end:!1}),D.push({key:"home",to:"/profile",label:"Home",icon:Yw,end:!0}),D.push({key:"menu",onClick:()=>t(!s),label:"Menu",icon:H=>a.jsx(FZ,{isOpen:s,...H})}),D},[e,s,t,f]),O=C.useMemo(()=>{var F;const D=r.pathname;return(F=[...I.filter(R=>R.to)].sort((R,V)=>V.to.length-R.to.length).find(R=>R.end?D===R.to:D.startsWith(R.to)))==null?void 0:F.to},[r.pathname,I]);return C.useEffect(()=>{const D=()=>{if(!i.current)return;const H=O?o.current.get(O):null,F=i.current.getBoundingClientRect();if(!H){h({opacity:0,transform:"translateX(0px) translateY(-50%)"}),c(bk(F.width,-100,0));return}const{offsetLeft:R,clientWidth:V}=H;h({opacity:1,width:`${Tm}px`,height:`${Tm}px`,transform:`translateX(${R+V/2-Tm/2}px) translateY(-50%)`}),c(bk(F.width,R,V))},z=setTimeout(D,50);return window.addEventListener("resize",D),()=>{clearTimeout(z),window.removeEventListener("resize",D)}},[O]),a.jsxs(a.Fragment,{children:[P&&a.jsx(gt,{message:P.message,type:P.type,onDismiss:()=>E(null)}),a.jsx(r_,{isOpen:g,onClose:()=>b(!1),onCapture:M,captureGuidance:"profile"}),a.jsx(LZ,{isOpen:v,onClose:()=>_(!1),permissionName:N}),a.jsx("nav",{ref:i,className:"fixed bottom-0 left-0 right-0 z-30 md:hidden",style:{height:"calc(4rem + env(safe-area-inset-bottom))"},children:a.jsxs("div",{className:"relative w-full h-full",children:[a.jsx("svg",{className:"absolute top-0 left-0 w-full h-16",fill:"#0d2c18",children:a.jsx("path",{d:l,className:"transition-all duration-300 ease-in-out"})}),a.jsx("div",{style:d,className:"absolute top-0 left-0 bg-green-500 rounded-full transition-all duration-300 ease-in-out shadow-[0_0_15px_rgba(34,197,94,0.6)] border-4 border-[#0d2c18]",children:I.map(D=>{if(!D.to)return null;const z=O===D.to;return a.jsx("div",{className:`absolute inset-0 flex items-center justify-center transition-all duration-300 ease-in-out ${z?"opacity-100 scale-110":"opacity-0 scale-50"}`,children:a.jsx(D.icon,{style:{width:vk,height:vk},className:"text-[#0d2c18]"})},`${D.key}-icon`)})}),a.jsx("div",{className:"absolute top-0 left-0 right-0 h-16 flex justify-around items-center z-10",children:I.map(D=>{if(D.onClick)return a.jsx("button",{onClick:D.onClick,className:"flex flex-col items-center justify-center w-16 h-16","aria-label":D.label,children:a.jsx(D.icon,{style:{width:Ff,height:Ff},className:s?"text-red-500":"text-white"})},D.key);const z=O===D.to;return a.jsx(KP,{to:D.to,end:D.end,ref:H=>{H&&o.current.set(D.to,H)},className:"flex flex-col items-center justify-center w-16 h-16 transition-all duration-300 ease-in-out",style:{transform:z?"translateY(-8px)":"translateY(0)"},children:a.jsx(D.icon,{style:{width:Ff,height:Ff},className:`transition-all duration-300 ${z?"opacity-0 scale-50":"opacity-100 scale-100 text-white/70 hover:text-white"}`})},D.key)})})]})})]})},Ig=ei((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=tt.getState().user;if(t){n({isLoading:!0,error:null});try{const s=await te.getNotifications(t.id),r=s.filter(i=>!i.isRead).length;n({notifications:s,unreadCount:r,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const s=e().notifications.find(r=>r.id===t);if(!(s&&s.isRead))try{await te.markNotificationAsRead(t),n(r=>({notifications:r.notifications.map(i=>i.id===t?{...i,isRead:!0}:i),unreadCount:Math.max(0,r.unreadCount-1)}))}catch(r){console.error("Failed to mark notification as read",r)}},markAllAsRead:async()=>{const t=tt.getState().user;if(t&&e().unreadCount!==0)try{await te.markAllNotificationsAsRead(t.id),n(s=>({notifications:s.notifications.map(r=>({...r,isRead:!0})),unreadCount:0}))}catch(s){console.error("Failed to mark all notifications as read",s)}}})),zZ=({type:n})=>{const e={task_assigned:sd,task_escalated:Jr,provisional_site_reminder:Hw},t={task_assigned:"text-blue-500",task_escalated:"text-orange-500",provisional_site_reminder:"text-purple-500"},s=e[n]||dh;return a.jsx(s,{className:`h-5 w-5 ${t[n]}`})},UZ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:s,markAllAsRead:r}=Ig(),[i,o]=C.useState(!1),l=C.useRef(null),c=Vt();C.useEffect(()=>{const f=p=>{l.current&&!l.current.contains(p.target)&&o(!1)};return document.addEventListener("mousedown",f),()=>document.removeEventListener("mousedown",f)},[]);const d=f=>{s(f.id),f.linkTo&&c(f.linkTo),o(!1)},h=()=>{r()};return a.jsxs("div",{className:`relative notification-bell ${n}`,ref:l,children:[a.jsxs("button",{onClick:()=>o(!i),className:"relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[a.jsx(dh,{className:"h-5 w-5"}),t>0&&a.jsx("span",{className:"absolute top-0 right-0 block h-2 w-2 rounded-full bg-red-500 ring-2 ring-card"})]}),i&&a.jsxs("div",{className:"absolute right-4 md:right-0 mt-3 w-[calc(100vw-2.5rem)] max-w-sm md:w-96 bg-card rounded-2xl shadow-lg border border-border z-20",children:[a.jsxs("div",{className:"flex justify-between items-center p-3 border-b border-border",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:"Notifications"}),t>0&&a.jsx(Y,{variant:"outline",size:"sm",onClick:h,children:"Mark all as read"})]}),a.jsx("div",{className:"max-h-96 overflow-y-auto",children:e.length>0?e.map(f=>a.jsxs("div",{onClick:()=>d(f),className:`flex items-start gap-3 p-3 border-b border-border cursor-pointer transition-colors ${f.isRead?"hover:bg-page":"bg-accent-light hover:brightness-125"}`,children:[a.jsx("div",{className:"flex-shrink-0 mt-0.5",children:a.jsx(zZ,{type:f.type})}),a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"text-sm text-primary-text",children:f.message}),a.jsx("p",{className:"text-xs text-muted mt-0.5",children:Zc(new Date(f.createdAt),{addSuffix:!0})})]}),!f.isRead&&a.jsx("div",{className:"w-2 h-2 rounded-full bg-blue-500 mt-2 flex-shrink-0"})]},f.id)):a.jsx("p",{className:"text-center text-muted p-6",children:"You have no notifications."})})]})]})},VZ=({className:n})=>a.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[a.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),a.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),a.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),a.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),a.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),a.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),gx=[VZ],ea=({className:n,photoUrl:e,seed:t})=>{const{user:s}=tt();if(e)return a.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const r=t||(s==null?void 0:s.id);if(!r){const l=gx[0];return a.jsx(l,{className:`text-muted/60 ${n||""}`})}const i=r.charCodeAt(r.length-1)%gx.length,o=gx[i];return a.jsx(o,{className:n||""})},BZ=({setIsMobileMenuOpen:n})=>{var v;const{user:e,logout:t}=tt(),{permissions:s}=pa(),r=Vt(),[i,o]=C.useState(!1),[l,c]=C.useState(!1),d=C.useRef(null),h=Nt("(max-width: 767px)");Ns(),C.useEffect(()=>{const _=N=>{d.current&&!d.current.contains(N.target)&&o(!1)};return document.addEventListener("mousedown",_),()=>document.removeEventListener("mousedown",_)},[]);const f=_=>_.replace(/_/g," ").replace(/\b\w/g,N=>N.toUpperCase()),p=()=>{n(!1),o(!1),c(!0)},g=async()=>{c(!1),await t(),r("/auth/login",{replace:!0})},b=()=>{r("/profile")};return a.jsxs(a.Fragment,{children:[a.jsx(yn,{isOpen:l,onClose:()=>c(!1),onConfirm:g,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),a.jsx("header",{className:"sticky top-0 z-30 bg-transparent md:bg-white/80 md:backdrop-blur-md border-b border-transparent md:border-gray-200/50 transition-all duration-200",children:a.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:a.jsxs("div",{className:"flex items-center h-16",children:[a.jsx("div",{className:"flex-none md:hidden w-10",children:a.jsxs("button",{onClick:b,className:"inline-flex items-center justify-center p-2 rounded-md text-muted hover:bg-page focus:outline-none","aria-label":"Go to profile page",children:[a.jsx("span",{className:"sr-only",children:"Go to profile"}),a.jsx(Er,{className:"block h-6 w-6"})]})}),a.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2"}),a.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:a.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[a.jsx(UZ,{}),!h&&e&&a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs("button",{onClick:()=>o(!i),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":i,"aria-haspopup":"true",children:[a.jsx(ea,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),a.jsxs("div",{className:"text-left hidden sm:block",children:[a.jsx("span",{className:"text-sm font-semibold",children:e.name}),a.jsx("span",{className:"text-xs text-muted block",children:f(e.role)})]}),a.jsx(Ml,{className:"h-4 w-4 text-muted"})]}),i&&a.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[a.jsxs(Yr,{to:"/profile",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[a.jsx(yd,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&((v=s[e.role])==null?void 0:v.includes("apply_for_leave"))&&a.jsxs(Yr,{to:"/leaves/dashboard",onClick:()=>o(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[a.jsx(Lb,{className:"mr-2 h-4 w-4"}),"Tracker"]}),a.jsxs("button",{onClick:p,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[a.jsx(Mu,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},qZ=[{to:"/verification/dashboard",label:"All Submissions",icon:UD,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:Dg,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:wl,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:tZ,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:uh,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:ID,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:Hw,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:WD,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:fZ,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:da,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:yZ,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:xZ,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:CZ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:sd,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:XY,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:yd,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:Dh,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:Yw,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:bl,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:VD,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Ag,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:Ei,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:qD,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:io,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:io,permission:"view_own_attendance"}],wk=({isCollapsed:n,onLinkClick:e,hideHeader:t=!1,mode:s="light"})=>{const{user:r}=tt(),{permissions:i}=pa(),o=r?qZ.filter(l=>{var c;return(c=i[r.role])==null?void 0:c.includes(l.permission)}).sort((l,c)=>l.label.localeCompare(c.label)):[];return a.jsxs("div",{className:"flex flex-col",children:[!t&&a.jsx("div",{className:"p-4 border-b border-white/10 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:n?a.jsx(Dh,{className:"h-8 w-8 text-accent"}):a.jsx(Qr,{})}),a.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:o.map(l=>a.jsx(KP,{to:l.to,onClick:e,className:({isActive:c})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?c?"text-white shadow-sm border":"text-gray-500 hover:bg-gray-50 hover:text-gray-900":c?"text-white shadow-md border":"text-gray-400 hover:bg-white/10 hover:text-white"}`,style:({isActive:c})=>c?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},title:n?l.label:void 0,children:({isActive:c})=>a.jsxs(a.Fragment,{children:[a.jsx(l.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?c?"text-white":"text-gray-400 group-hover:text-gray-600":c?"text-white":"text-gray-400 group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&a.jsx("span",{children:l.label})]})},l.to))})]})},HZ=()=>{const{user:n}=tt(),{fetchNotifications:e}=Ig(),{permissions:t}=pa(),{autoScrollOnHover:s}=QD(),r=Ns(),i=C.useRef(null),o=C.useRef(null),[l,c]=C.useState(!1),[d,h]=C.useState(!1),[f,p]=C.useState(0),[g,b]=C.useState(!1),v=Nt("(max-width: 767px)"),_=C.useCallback(()=>{o.current!==null&&(clearInterval(o.current),o.current=null)},[]),N=C.useCallback(S=>{_();const P=i.current;if(!P)return;const E=()=>{P.scrollBy({top:S==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};E(),o.current=window.setInterval(E,300)},[_]);C.useEffect(()=>{const S=()=>{const E=i.current;E&&(b(E.scrollHeight>E.clientHeight),p(E.scrollTop))},P=i.current;return P==null||P.addEventListener("scroll",S,{passive:!0}),window.addEventListener("resize",S),S(),()=>{P==null||P.removeEventListener("scroll",S),window.removeEventListener("resize",S),_()}},[_]),C.useEffect(()=>{const S=document.body;return l?S.style.overflow="hidden":S.style.overflow="",()=>{S.style.overflow=""}},[l]),C.useEffect(()=>{n&&e()},[n,e]);const k=v&&!["/onboarding/add"].some(S=>r.pathname.startsWith(S));return n?a.jsxs("div",{className:`flex min-h-screen bg-page ${v?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,children:[!v&&a.jsxs("aside",{className:`hidden md:flex md:flex-col md:flex-shrink-0 transition-all duration-300 ease-in-out ${d?"w-20":"w-72"} bg-white border-r border-gray-200/60`,children:[a.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:a.jsx(wk,{isCollapsed:d,mode:"light"})}),a.jsx("div",{className:"flex-shrink-0 px-2 pt-2 border-t border-border mt-auto flex items-center",children:a.jsx("button",{onClick:()=>h(!d),className:"flex-1 flex items-center justify-center p-2 rounded-lg text-muted hover:bg-page transition-colors",title:d?"Expand sidebar":"Collapse sidebar",children:d?a.jsx(oZ,{className:"h-5 w-5"}):a.jsx(aZ,{className:"h-5 w-5"})})})]}),l&&a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-30 md:hidden",onClick:()=>c(!1),"aria-hidden":"true"}),a.jsxs("aside",{className:"fixed inset-y-0 left-0 w-80 bg-[#0d2c18] z-40 transform transition-transform duration-300 ease-in-out md:hidden shadow-2xl flex flex-col border-r border-white/10",style:{transform:l?"translateX(0)":"translateX(-100%)"},children:[a.jsx("div",{className:"p-4 flex justify-center h-20 items-center flex-shrink-0 bg-white shadow-sm",children:a.jsx(Qr,{})}),a.jsx("div",{className:"flex-1 overflow-y-auto py-2 custom-scrollbar",children:a.jsx(wk,{isCollapsed:!1,onLinkClick:()=>c(!1),hideHeader:!0,mode:"dark"})}),a.jsx("div",{className:"p-4 border-t border-white/10 mt-auto flex-shrink-0 bg-[#0a2514]",children:a.jsxs("button",{onClick:()=>c(!1),className:"w-full flex items-center justify-center p-3.5 rounded-xl text-white/80 hover:text-white hover:bg-white/10 transition-all duration-200 group",children:[a.jsx(Er,{className:"h-5 w-5 mr-2 group-hover:-translate-x-1 transition-transform"}),a.jsx("span",{className:"font-medium",children:"Close Menu"})]})})]})]}),a.jsxs("div",{className:`flex-1 flex flex-col ${v?"":"bg-gray-50/50"}`,children:[a.jsx(BZ,{setIsMobileMenuOpen:c}),a.jsx("main",{ref:i,className:`flex-1 bg-page overflow-y-auto ${k?"pb-32":""}`,children:a.jsx("div",{className:v?"p-4":"p-4 sm:p-6 lg:p-8",children:a.jsx("div",{className:"bg-white rounded-2xl shadow-md border border-gray-200/60 overflow-hidden",children:a.jsx(th,{})})})})]}),k&&n&&a.jsx($Z,{user:n,permissions:t[n.role]||[],setIsMobileMenuOpen:c,isMobileMenuOpen:l}),g&&!v&&a.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[a.jsx(Y,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:s?()=>N("up"):void 0,onMouseLeave:_,onMouseDown:()=>N("up"),onMouseUp:_,onTouchStart:()=>N("up"),onTouchEnd:_,disabled:f<=0,"aria-label":"Scroll Up",children:a.jsx(iZ,{className:"h-5 w-5"})}),a.jsx(Y,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:s?()=>N("down"):void 0,onMouseLeave:_,onMouseDown:()=>N("down"),onMouseUp:_,onTouchStart:()=>N("down"),onTouchEnd:_,disabled:i.current?Math.ceil(i.current.clientHeight+f)>=i.current.scrollHeight:!1,"aria-label":"Scroll Down",children:a.jsx(Ml,{className:"h-5 w-5"})})]})]}):a.jsx(Ki,{to:"/auth/login",replace:!0})},WZ=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],XD=ei(gd((n,e)=>({backgroundImages:WZ,addBackgroundImage:t=>{const s=e();return s.backgroundImages.includes(t)?!1:(n({backgroundImages:[...s.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(s=>({backgroundImages:s.backgroundImages.filter((r,i)=>i!==t)}))}),{name:"paradigm-auth-layout-settings",storage:Pl(()=>localStorage)})),GZ=()=>{const{backgroundImages:n}=XD(),[e,t]=C.useState(0),s=Ns();C.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const r=C.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),i=C.useMemo(()=>s.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:s.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:s.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[s.pathname]);return a.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[a.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[r.map((o,l)=>a.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),a.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),a.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:a.jsxs("div",{className:"w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-white/10",children:[a.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[a.jsxs("div",{children:[a.jsx(Qr,{className:"h-8 lg:h-12 xl:h-14"}),a.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg",children:"Welcome to the Future of Onboarding."}),a.jsx("p",{className:"text-white/80 mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base",children:"Streamlining the journey for every new member of the Paradigm family."})]}),a.jsx("div",{children:a.jsxs("p",{className:"text-white/50 text-[10px] lg:text-xs mt-4",children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),a.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-black/40 backdrop-blur-xl border-l border-white/10",children:a.jsxs("div",{className:"w-full max-w-md mx-auto",children:[a.jsx("div",{className:"md:hidden flex justify-center mb-6",children:a.jsx(Qr,{className:"h-8"})}),a.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",children:i.title}),a.jsx("p",{className:"text-gray-300 mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",children:i.subtitle}),a.jsx(th,{})]})})]})})]})};function YZ(){const[n,e]=C.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return C.useEffect(()=>{const t=()=>{const r=[];let i=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,r.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=r.length===0;e({isSecure:c,issues:r,developerModeEnabled:i,locationSpoofingDetected:o})};t();const s=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(s),window.removeEventListener("resize",t)}},[]),n}const ZZ=({issues:n,onDismiss:e})=>{const[t,s]=C.useState(!1);return C.useEffect(()=>{const r=()=>{s(window.innerWidth<768)};return r(),window.addEventListener("resize",r),()=>window.removeEventListener("resize",r)},[]),t?a.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:a.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[a.jsx("div",{className:"flex justify-center mt-8 mb-6",children:a.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(gk,{className:"w-8 h-8 text-red-600"})})}),a.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),a.jsxs("div",{className:"space-y-3 mb-4",children:[a.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:a.jsx("ul",{className:"space-y-2",children:n.map((r,i)=>a.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[a.jsx(Jr,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),a.jsx("span",{children:r})]},i))})})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[a.jsx("li",{children:"Close browser developer tools (F12)"}),a.jsx("li",{children:"Disable any location spoofing apps or extensions"}),a.jsx("li",{children:"Refresh this page"})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:a.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&a.jsx(Y,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:a.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:a.jsx(gk,{className:"w-10 h-10 text-red-600"})})}),a.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),a.jsxs("div",{className:"space-y-3 mb-6",children:[a.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),a.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:a.jsx("ul",{className:"space-y-2",children:n.map((r,i)=>a.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[a.jsx(Jr,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),a.jsx("span",{children:r})]},i))})})]}),a.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[a.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),a.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[a.jsx("li",{children:"Close browser developer tools (F12)"}),a.jsx("li",{children:"Disable any location spoofing apps or extensions"}),a.jsx("li",{children:"Refresh this page"})]})]}),a.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:a.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&a.jsx(Y,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},KZ=({children:n})=>{const{user:e}=tt(),t=YZ(),[s,r]=C.useState(!1),i=e&&(e.role==="admin"||e.role==="developer");return C.useEffect(()=>{if(e&&!i&&!t.isSecure&&!s){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";te.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),r(!0)}},[e,t,s,i]),e&&!i&&!t.isSecure?a.jsx(ZZ,{issues:t.issues}):a.jsx(a.Fragment,{children:n})},JZ=({onComplete:n})=>{const e=Nt("(max-width: 767px)"),[t,s]=C.useState("prompt"),[r,i]=C.useState("prompt"),[o,l]=C.useState(!1),[c,d]=C.useState(null),h=t==="granted"&&r==="granted";C.useEffect(()=>{(!e||h)&&n()},[e,h,n]);const f=async()=>{l(!0),d(null);try{try{const p=await navigator.mediaDevices.getUserMedia({video:!0});i("granted"),p.getTracks().forEach(g=>g.stop())}catch{throw i("denied"),new Error("Camera permission was denied.")}try{await new Promise((p,g)=>{navigator.geolocation.getCurrentPosition(()=>{s("granted"),p(!0)},()=>{s("denied"),g(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(p){d(p.message||"Permissions are required to use this app.")}finally{l(!1)}};return e?a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4 text-center",children:[a.jsx("div",{className:"splash-logo",children:a.jsx(Qr,{className:"h-16 mb-8"})}),a.jsxs("div",{className:"max-w-md",children:[a.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Permissions Required"}),a.jsx("p",{className:"text-gray-600 mb-8",children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),a.jsxs("div",{className:"space-y-4 mb-8",children:[a.jsxs("div",{className:`p-4 rounded-lg border ${t==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[a.jsx("p",{className:"font-semibold",children:"Location Access"}),a.jsx("p",{className:"text-sm",children:t==="granted"?"Permission Granted":"Needed for check-in/out"})]}),a.jsxs("div",{className:`p-4 rounded-lg border ${r==="granted"?"bg-green-100 border-green-300":"bg-gray-100 border-gray-300"}`,children:[a.jsx("p",{className:"font-semibold",children:"Camera Access"}),a.jsx("p",{className:"text-sm",children:r==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),a.jsx(Y,{onClick:f,disabled:o,children:o?"Requesting...":"Grant Permissions"}),c&&a.jsx("p",{className:"text-red-500 mt-4",children:c}),a.jsx("p",{className:"text-xs text-gray-500 mt-8",children:"You can manage these permissions in your device settings at any time."})]})]}):null},QZ=()=>{const[n,e]=C.useState(!1),t=()=>{e(!0)};return n?a.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[a.jsx("div",{className:"splash-logo",children:a.jsx(Qr,{className:"h-16 mb-8"})}),a.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):a.jsx(JZ,{onComplete:t})};var Ah=n=>n.type==="checkbox",sl=n=>n instanceof Date,Ms=n=>n==null;const eA=n=>typeof n=="object";var Dn=n=>!Ms(n)&&!Array.isArray(n)&&eA(n)&&!sl(n),tA=n=>Dn(n)&&n.target?Ah(n.target)?n.target.checked:n.target.value:n,XZ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,nA=(n,e)=>n.has(XZ(e)),eK=n=>{const e=n.constructor&&n.constructor.prototype;return Dn(e)&&e.hasOwnProperty("isPrototypeOf")},i_=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Qt(n){let e;const t=Array.isArray(n),s=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(i_&&(n instanceof Blob||s))&&(t||Dn(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!eK(n))e=n;else for(const r in n)n.hasOwnProperty(r)&&(e[r]=Qt(n[r]));else return n;return e}var Og=n=>/^\w*$/.test(n),Gt=n=>n===void 0,Rg=n=>Array.isArray(n)?n.filter(Boolean):[],a_=n=>Rg(n.replace(/["|']|\]/g,"").split(/\.|\[/)),Ie=(n,e,t)=>{if(!e||!Dn(n))return t;const s=(Og(e)?[e]:a_(e)).reduce((r,i)=>Ms(r)?r:r[i],n);return Gt(s)||s===n?Gt(n[e])?t:n[e]:s},Js=n=>typeof n=="boolean",Mt=(n,e,t)=>{let s=-1;const r=Og(e)?[e]:a_(e),i=r.length,o=i-1;for(;++s<i;){const l=r[s];let c=t;if(s!==o){const d=n[l];c=Dn(d)||Array.isArray(d)?d:isNaN(+r[s+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const Ip={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},_r={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Ri={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},sA=Fe.createContext(null);sA.displayName="HookFormContext";const Lg=()=>Fe.useContext(sA);var rA=(n,e,t,s=!0)=>{const r={defaultValues:e._defaultValues};for(const i in n)Object.defineProperty(r,i,{get:()=>{const o=i;return e._proxyFormState[o]!==_r.all&&(e._proxyFormState[o]=!s||_r.all),t&&(t[o]=!0),n[o]}});return r};const Fg=typeof window<"u"?Fe.useLayoutEffect:Fe.useEffect;function tK(n){const e=Lg(),{control:t=e.control,disabled:s,name:r,exact:i}=n||{},[o,l]=Fe.useState(t._formState),c=Fe.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Fg(()=>t._subscribe({name:r,formState:c.current,exact:i,callback:d=>{!s&&l({...t._formState,...d})}}),[r,s,i]),Fe.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),Fe.useMemo(()=>rA(o,t,c.current,!1),[o,t])}var tr=n=>typeof n=="string",Ub=(n,e,t,s,r)=>tr(n)?(s&&e.watch.add(n),Ie(t,n,r)):Array.isArray(n)?n.map(i=>(s&&e.watch.add(i),Ie(t,i))):(s&&(e.watchAll=!0),t),Vb=n=>Ms(n)||!eA(n);function $r(n,e,t=new WeakSet){if(Vb(n)||Vb(e))return n===e;if(sl(n)&&sl(e))return n.getTime()===e.getTime();const s=Object.keys(n),r=Object.keys(e);if(s.length!==r.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const i of s){const o=n[i];if(!r.includes(i))return!1;if(i!=="ref"){const l=e[i];if(sl(o)&&sl(l)||Dn(o)&&Dn(l)||Array.isArray(o)&&Array.isArray(l)?!$r(o,l,t):o!==l)return!1}}return!0}function ll(n){const e=Lg(),{control:t=e.control,name:s,defaultValue:r,disabled:i,exact:o,compute:l}=n||{},c=Fe.useRef(r),d=Fe.useRef(l),h=Fe.useRef(void 0),f=Fe.useRef(t),p=Fe.useRef(s);d.current=l;const[g,b]=Fe.useState(()=>{const S=t._getWatch(s,c.current);return d.current?d.current(S):S}),v=Fe.useCallback(S=>{const P=Ub(s,t._names,S||t._formValues,!1,c.current);return d.current?d.current(P):P},[t._formValues,t._names,s]),_=Fe.useCallback(S=>{if(!i){const P=Ub(s,t._names,S||t._formValues,!1,c.current);if(d.current){const E=d.current(P);$r(E,h.current)||(b(E),h.current=E)}else b(P)}},[t._formValues,t._names,i,s]);Fg(()=>((f.current!==t||!$r(p.current,s))&&(f.current=t,p.current=s,_()),t._subscribe({name:s,formState:{values:!0},exact:o,callback:S=>{_(S.values)}})),[t,o,s,_]),Fe.useEffect(()=>t._removeUnmounted());const N=f.current!==t,j=p.current,k=Fe.useMemo(()=>{if(i)return null;const S=!N&&!$r(j,s);return N||S?v():null},[i,N,s,j,v]);return k!==null?k:g}function nK(n){const e=Lg(),{name:t,disabled:s,control:r=e.control,shouldUnregister:i,defaultValue:o}=n,l=nA(r._names.array,t),c=Fe.useMemo(()=>Ie(r._formValues,t,Ie(r._defaultValues,t,o)),[r,t,o]),d=ll({control:r,name:t,defaultValue:c,exact:!0}),h=tK({control:r,name:t,exact:!0}),f=Fe.useRef(n),p=Fe.useRef(void 0),g=Fe.useRef(r.register(t,{...n.rules,value:d,...Js(n.disabled)?{disabled:n.disabled}:{}}));f.current=n;const b=Fe.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Ie(h.errors,t)},isDirty:{enumerable:!0,get:()=>!!Ie(h.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!Ie(h.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!Ie(h.validatingFields,t)},error:{enumerable:!0,get:()=>Ie(h.errors,t)}}),[h,t]),v=Fe.useCallback(k=>g.current.onChange({target:{value:tA(k),name:t},type:Ip.CHANGE}),[t]),_=Fe.useCallback(()=>g.current.onBlur({target:{value:Ie(r._formValues,t),name:t},type:Ip.BLUR}),[t,r._formValues]),N=Fe.useCallback(k=>{const S=Ie(r._fields,t);S&&k&&(S._f.ref={focus:()=>k.focus&&k.focus(),select:()=>k.select&&k.select(),setCustomValidity:P=>k.setCustomValidity(P),reportValidity:()=>k.reportValidity()})},[r._fields,t]),j=Fe.useMemo(()=>({name:t,value:d,...Js(s)||h.disabled?{disabled:h.disabled||s}:{},onChange:v,onBlur:_,ref:N}),[t,s,h.disabled,v,_,N,d]);return Fe.useEffect(()=>{const k=r._options.shouldUnregister||i,S=p.current;S&&S!==t&&!l&&r.unregister(S),r.register(t,{...f.current.rules,...Js(f.current.disabled)?{disabled:f.current.disabled}:{}});const P=(E,M)=>{const I=Ie(r._fields,E);I&&I._f&&(I._f.mount=M)};if(P(t,!0),k){const E=Qt(Ie(r._options.defaultValues,t,f.current.defaultValue));Mt(r._defaultValues,t,E),Gt(Ie(r._formValues,t))&&Mt(r._formValues,t,E)}return!l&&r.register(t),p.current=t,()=>{(l?k&&!r._state.action:k)?r.unregister(t):P(t,!1)}},[t,r,l,i]),Fe.useEffect(()=>{r._setDisabledField({disabled:s,name:t})},[s,t,r]),Fe.useMemo(()=>({field:j,formState:h,fieldState:b}),[j,h,b])}const de=n=>n.render(nK(n));var iA=(n,e,t,s,r)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[s]:r||!0}}:{},Rs=n=>Array.isArray(n)?n:[n],_k=()=>{let n=[];return{get observers(){return n},next:r=>{for(const i of n)i.next&&i.next(r)},subscribe:r=>(n.push(r),{unsubscribe:()=>{n=n.filter(i=>i!==r)}}),unsubscribe:()=>{n=[]}}};function aA(n,e){const t={};for(const s in n)if(n.hasOwnProperty(s)){const r=n[s],i=e[s];if(r&&Dn(r)&&i){const o=aA(r,i);Dn(o)&&(t[s]=o)}else n[s]&&(t[s]=i)}return t}var ts=n=>Dn(n)&&!Object.keys(n).length,o_=n=>n.type==="file",zr=n=>typeof n=="function",Op=n=>{if(!i_)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},oA=n=>n.type==="select-multiple",l_=n=>n.type==="radio",sK=n=>l_(n)||Ah(n),yx=n=>Op(n)&&n.isConnected;function rK(n,e){const t=e.slice(0,-1).length;let s=0;for(;s<t;)n=Gt(n)?s++:n[e[s++]];return n}function iK(n){for(const e in n)if(n.hasOwnProperty(e)&&!Gt(n[e]))return!1;return!0}function bn(n,e){const t=Array.isArray(e)?e:Og(e)?[e]:a_(e),s=t.length===1?n:rK(n,t),r=t.length-1,i=t[r];return s&&delete s[i],r!==0&&(Dn(s)&&ts(s)||Array.isArray(s)&&iK(s))&&bn(n,t.slice(0,-1)),n}var aK=n=>{for(const e in n)if(zr(n[e]))return!0;return!1};function lA(n){return Array.isArray(n)||Dn(n)&&!aK(n)}function Bb(n,e={}){for(const t in n)lA(n[t])?(e[t]=Array.isArray(n[t])?[]:{},Bb(n[t],e[t])):Gt(n[t])||(e[t]=!0);return e}function dc(n,e,t){t||(t=Bb(e));for(const s in n)lA(n[s])?Gt(e)||Vb(t[s])?t[s]=Bb(n[s],Array.isArray(n[s])?[]:{}):dc(n[s],Ms(e)?{}:e[s],t[s]):t[s]=!$r(n[s],e[s]);return t}const Sk={value:!1,isValid:!1},Nk={value:!0,isValid:!0};var cA=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Gt(n[0].attributes.value)?Gt(n[0].value)||n[0].value===""?Nk:{value:n[0].value,isValid:!0}:Nk:Sk}return Sk},dA=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:s})=>Gt(n)?n:e?n===""?NaN:n&&+n:t&&tr(n)?new Date(n):s?s(n):n;const jk={isValid:!1,value:null};var uA=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,jk):jk;function Ck(n){const e=n.ref;return o_(e)?e.files:l_(e)?uA(n.refs).value:oA(e)?[...e.selectedOptions].map(({value:t})=>t):Ah(e)?cA(n.refs).value:dA(Gt(e.value)?n.ref.value:e.value,n)}var oK=(n,e,t,s)=>{const r={};for(const i of n){const o=Ie(e,i);o&&Mt(r,i,o._f)}return{criteriaMode:t,names:[...n],fields:r,shouldUseNativeValidation:s}},Rp=n=>n instanceof RegExp,Gd=n=>Gt(n)?n:Rp(n)?n.source:Dn(n)?Rp(n.value)?n.value.source:n.value:n,jc=n=>({isOnSubmit:!n||n===_r.onSubmit,isOnBlur:n===_r.onBlur,isOnChange:n===_r.onChange,isOnAll:n===_r.all,isOnTouch:n===_r.onTouched});const kk="AsyncFunction";var lK=n=>!!n&&!!n.validate&&!!(zr(n.validate)&&n.validate.constructor.name===kk||Dn(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===kk)),cK=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),qb=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(s=>n.startsWith(s)&&/^\.\w+/.test(n.slice(s.length))));const Rc=(n,e,t,s)=>{for(const r of t||Object.keys(n)){const i=Ie(n,r);if(i){const{_f:o,...l}=i;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],r)&&!s)return!0;if(o.ref&&e(o.ref,o.name)&&!s)return!0;if(Rc(l,e))break}else if(Dn(l)&&Rc(l,e))break}}};function Tk(n,e,t){const s=Ie(n,t);if(s||Og(t))return{error:s,name:t};const r=t.split(".");for(;r.length;){const i=r.join("."),o=Ie(e,i),l=Ie(n,i);if(o&&!Array.isArray(o)&&t!==i)return{name:t};if(l&&l.type)return{name:i,error:l};if(l&&l.root&&l.root.type)return{name:`${i}.root`,error:l.root};r.pop()}return{name:t}}var dK=(n,e,t,s)=>{t(n);const{name:r,...i}=n;return ts(i)||Object.keys(i).length>=Object.keys(e).length||Object.keys(i).find(o=>e[o]===(!s||_r.all))},uK=(n,e,t)=>!n||!e||n===e||Rs(n).some(s=>s&&(t?s===e:s.startsWith(e)||e.startsWith(s))),hK=(n,e,t,s,r)=>r.isOnAll?!1:!t&&r.isOnTouch?!(e||n):(t?s.isOnBlur:r.isOnBlur)?!n:(t?s.isOnChange:r.isOnChange)?n:!0,fK=(n,e)=>!Rg(Ie(n,e)).length&&bn(n,e),hA=(n,e,t)=>{const s=Rs(Ie(n,t));return Mt(s,"root",e[t]),Mt(n,t,s),n};function Ek(n,e,t="validate"){if(tr(n)||Array.isArray(n)&&n.every(tr)||Js(n)&&!n)return{type:t,message:tr(n)?n:"",ref:e}}var ec=n=>Dn(n)&&!Rp(n)?n:{value:n,message:""},Hb=async(n,e,t,s,r,i)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:f,max:p,pattern:g,validate:b,name:v,valueAsNumber:_,mount:N}=n._f,j=Ie(t,v);if(!N||e.has(v))return{};const k=l?l[0]:o,S=H=>{r&&k.reportValidity&&(k.setCustomValidity(Js(H)?"":H||""),k.reportValidity())},P={},E=l_(o),M=Ah(o),I=E||M,O=(_||o_(o))&&Gt(o.value)&&Gt(j)||Op(o)&&o.value===""||j===""||Array.isArray(j)&&!j.length,D=iA.bind(null,v,s,P),z=(H,F,R,V=Ri.maxLength,U=Ri.minLength)=>{const W=H?F:R;P[v]={type:H?V:U,message:W,ref:o,...D(H?V:U,W)}};if(i?!Array.isArray(j)||!j.length:c&&(!I&&(O||Ms(j))||Js(j)&&!j||M&&!cA(l).isValid||E&&!uA(l).isValid)){const{value:H,message:F}=tr(c)?{value:!!c,message:c}:ec(c);if(H&&(P[v]={type:Ri.required,message:F,ref:k,...D(Ri.required,F)},!s))return S(F),P}if(!O&&(!Ms(f)||!Ms(p))){let H,F;const R=ec(p),V=ec(f);if(!Ms(j)&&!isNaN(j)){const U=o.valueAsNumber||j&&+j;Ms(R.value)||(H=U>R.value),Ms(V.value)||(F=U<V.value)}else{const U=o.valueAsDate||new Date(j),W=Q=>new Date(new Date().toDateString()+" "+Q),B=o.type=="time",q=o.type=="week";tr(R.value)&&j&&(H=B?W(j)>W(R.value):q?j>R.value:U>new Date(R.value)),tr(V.value)&&j&&(F=B?W(j)<W(V.value):q?j<V.value:U<new Date(V.value))}if((H||F)&&(z(!!H,R.message,V.message,Ri.max,Ri.min),!s))return S(P[v].message),P}if((d||h)&&!O&&(tr(j)||i&&Array.isArray(j))){const H=ec(d),F=ec(h),R=!Ms(H.value)&&j.length>+H.value,V=!Ms(F.value)&&j.length<+F.value;if((R||V)&&(z(R,H.message,F.message),!s))return S(P[v].message),P}if(g&&!O&&tr(j)){const{value:H,message:F}=ec(g);if(Rp(H)&&!j.match(H)&&(P[v]={type:Ri.pattern,message:F,ref:o,...D(Ri.pattern,F)},!s))return S(F),P}if(b){if(zr(b)){const H=await b(j,t),F=Ek(H,k);if(F&&(P[v]={...F,...D(Ri.validate,F.message)},!s))return S(F.message),P}else if(Dn(b)){let H={};for(const F in b){if(!ts(H)&&!s)break;const R=Ek(await b[F](j,t),k,F);R&&(H={...R,...D(F,R.message)},S(R.message),s&&(P[v]=H))}if(!ts(H)&&(P[v]={ref:k,...H},!s))return P}}return S(!0),P};const mK={mode:_r.onSubmit,reValidateMode:_r.onChange,shouldFocusError:!0};function pK(n={}){let e={...mK,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:zr(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},s={},r=Dn(e.defaultValues)||Dn(e.values)?Qt(e.defaultValues||e.values)||{}:{},i=e.shouldUnregister?{}:Qt(r),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let f={...h};const p={array:_k(),state:_k()},g=e.criteriaMode===_r.all,b=J=>K=>{clearTimeout(d),d=setTimeout(J,K)},v=async J=>{if(!e.disabled&&(h.isValid||f.isValid||J)){const K=e.resolver?ts((await M()).errors):await O(s,!0);K!==t.isValid&&p.state.next({isValid:K})}},_=(J,K)=>{!e.disabled&&(h.isValidating||h.validatingFields||f.isValidating||f.validatingFields)&&((J||Array.from(l.mount)).forEach(oe=>{oe&&(K?Mt(t.validatingFields,oe,K):bn(t.validatingFields,oe))}),p.state.next({validatingFields:t.validatingFields,isValidating:!ts(t.validatingFields)}))},N=(J,K=[],oe,we,Se=!0,_e=!0)=>{if(we&&oe&&!e.disabled){if(o.action=!0,_e&&Array.isArray(Ie(s,J))){const Pe=oe(Ie(s,J),we.argA,we.argB);Se&&Mt(s,J,Pe)}if(_e&&Array.isArray(Ie(t.errors,J))){const Pe=oe(Ie(t.errors,J),we.argA,we.argB);Se&&Mt(t.errors,J,Pe),fK(t.errors,J)}if((h.touchedFields||f.touchedFields)&&_e&&Array.isArray(Ie(t.touchedFields,J))){const Pe=oe(Ie(t.touchedFields,J),we.argA,we.argB);Se&&Mt(t.touchedFields,J,Pe)}(h.dirtyFields||f.dirtyFields)&&(t.dirtyFields=dc(r,i)),p.state.next({name:J,isDirty:z(J,K),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else Mt(i,J,K)},j=(J,K)=>{Mt(t.errors,J,K),p.state.next({errors:t.errors})},k=J=>{t.errors=J,p.state.next({errors:t.errors,isValid:!1})},S=(J,K,oe,we)=>{const Se=Ie(s,J);if(Se){const _e=Ie(i,J,Gt(oe)?Ie(r,J):oe);Gt(_e)||we&&we.defaultChecked||K?Mt(i,J,K?_e:Ck(Se._f)):R(J,_e),o.mount&&v()}},P=(J,K,oe,we,Se)=>{let _e=!1,Pe=!1;const Ue={name:J};if(!e.disabled){if(!oe||we){(h.isDirty||f.isDirty)&&(Pe=t.isDirty,t.isDirty=Ue.isDirty=z(),_e=Pe!==Ue.isDirty);const ht=$r(Ie(r,J),K);Pe=!!Ie(t.dirtyFields,J),ht?bn(t.dirtyFields,J):Mt(t.dirtyFields,J,!0),Ue.dirtyFields=t.dirtyFields,_e=_e||(h.dirtyFields||f.dirtyFields)&&Pe!==!ht}if(oe){const ht=Ie(t.touchedFields,J);ht||(Mt(t.touchedFields,J,oe),Ue.touchedFields=t.touchedFields,_e=_e||(h.touchedFields||f.touchedFields)&&ht!==oe)}_e&&Se&&p.state.next(Ue)}return _e?Ue:{}},E=(J,K,oe,we)=>{const Se=Ie(t.errors,J),_e=(h.isValid||f.isValid)&&Js(K)&&t.isValid!==K;if(e.delayError&&oe?(c=b(()=>j(J,oe)),c(e.delayError)):(clearTimeout(d),c=null,oe?Mt(t.errors,J,oe):bn(t.errors,J)),(oe?!$r(Se,oe):Se)||!ts(we)||_e){const Pe={...we,..._e&&Js(K)?{isValid:K}:{},errors:t.errors,name:J};t={...t,...Pe},p.state.next(Pe)}},M=async J=>{_(J,!0);const K=await e.resolver(i,e.context,oK(J||l.mount,s,e.criteriaMode,e.shouldUseNativeValidation));return _(J),K},I=async J=>{const{errors:K}=await M(J);if(J)for(const oe of J){const we=Ie(K,oe);we?Mt(t.errors,oe,we):bn(t.errors,oe)}else t.errors=K;return K},O=async(J,K,oe={valid:!0})=>{for(const we in J){const Se=J[we];if(Se){const{_f:_e,...Pe}=Se;if(_e){const Ue=l.array.has(_e.name),ht=Se._f&&lK(Se._f);ht&&h.validatingFields&&_([_e.name],!0);const Zt=await Hb(Se,l.disabled,i,g,e.shouldUseNativeValidation&&!K,Ue);if(ht&&h.validatingFields&&_([_e.name]),Zt[_e.name]&&(oe.valid=!1,K))break;!K&&(Ie(Zt,_e.name)?Ue?hA(t.errors,Zt,_e.name):Mt(t.errors,_e.name,Zt[_e.name]):bn(t.errors,_e.name))}!ts(Pe)&&await O(Pe,K,oe)}}return oe.valid},D=()=>{for(const J of l.unMount){const K=Ie(s,J);K&&(K._f.refs?K._f.refs.every(oe=>!yx(oe)):!yx(K._f.ref))&&ge(J)}l.unMount=new Set},z=(J,K)=>!e.disabled&&(J&&K&&Mt(i,J,K),!$r(Q(),r)),H=(J,K,oe)=>Ub(J,l,{...o.mount?i:Gt(K)?r:tr(J)?{[J]:K}:K},oe,K),F=J=>Rg(Ie(o.mount?i:r,J,e.shouldUnregister?Ie(r,J,[]):[])),R=(J,K,oe={})=>{const we=Ie(s,J);let Se=K;if(we){const _e=we._f;_e&&(!_e.disabled&&Mt(i,J,dA(K,_e)),Se=Op(_e.ref)&&Ms(K)?"":K,oA(_e.ref)?[..._e.ref.options].forEach(Pe=>Pe.selected=Se.includes(Pe.value)):_e.refs?Ah(_e.ref)?_e.refs.forEach(Pe=>{(!Pe.defaultChecked||!Pe.disabled)&&(Array.isArray(Se)?Pe.checked=!!Se.find(Ue=>Ue===Pe.value):Pe.checked=Se===Pe.value||!!Se)}):_e.refs.forEach(Pe=>Pe.checked=Pe.value===Se):o_(_e.ref)?_e.ref.value="":(_e.ref.value=Se,_e.ref.type||p.state.next({name:J,values:Qt(i)})))}(oe.shouldDirty||oe.shouldTouch)&&P(J,Se,oe.shouldTouch,oe.shouldDirty,!0),oe.shouldValidate&&q(J)},V=(J,K,oe)=>{for(const we in K){if(!K.hasOwnProperty(we))return;const Se=K[we],_e=J+"."+we,Pe=Ie(s,_e);(l.array.has(J)||Dn(Se)||Pe&&!Pe._f)&&!sl(Se)?V(_e,Se,oe):R(_e,Se,oe)}},U=(J,K,oe={})=>{const we=Ie(s,J),Se=l.array.has(J),_e=Qt(K);Mt(i,J,_e),Se?(p.array.next({name:J,values:Qt(i)}),(h.isDirty||h.dirtyFields||f.isDirty||f.dirtyFields)&&oe.shouldDirty&&p.state.next({name:J,dirtyFields:dc(r,i),isDirty:z(J,_e)})):we&&!we._f&&!Ms(_e)?V(J,_e,oe):R(J,_e,oe),qb(J,l)&&p.state.next({...t,name:J}),p.state.next({name:o.mount?J:void 0,values:Qt(i)})},W=async J=>{o.mount=!0;const K=J.target;let oe=K.name,we=!0;const Se=Ie(s,oe),_e=ht=>{we=Number.isNaN(ht)||sl(ht)&&isNaN(ht.getTime())||$r(ht,Ie(i,oe,ht))},Pe=jc(e.mode),Ue=jc(e.reValidateMode);if(Se){let ht,Zt;const an=K.type?Ck(Se._f):tA(J),$n=J.type===Ip.BLUR||J.type===Ip.FOCUS_OUT,Ws=!cK(Se._f)&&!e.resolver&&!Ie(t.errors,oe)&&!Se._f.deps||hK($n,Ie(t.touchedFields,oe),t.isSubmitted,Ue,Pe),Cs=qb(oe,l,$n);Mt(i,oe,an),$n?(!K||!K.readOnly)&&(Se._f.onBlur&&Se._f.onBlur(J),c&&c(0)):Se._f.onChange&&Se._f.onChange(J);const zn=P(oe,an,$n),Bt=!ts(zn)||Cs;if(!$n&&p.state.next({name:oe,type:J.type,values:Qt(i)}),Ws)return(h.isValid||f.isValid)&&(e.mode==="onBlur"?$n&&v():$n||v()),Bt&&p.state.next({name:oe,...Cs?{}:zn});if(!$n&&Cs&&p.state.next({...t}),e.resolver){const{errors:Gs}=await M([oe]);if(_e(an),we){const us=Tk(t.errors,s,oe),hs=Tk(Gs,s,us.name||oe);ht=hs.error,oe=hs.name,Zt=ts(Gs)}}else _([oe],!0),ht=(await Hb(Se,l.disabled,i,g,e.shouldUseNativeValidation))[oe],_([oe]),_e(an),we&&(ht?Zt=!1:(h.isValid||f.isValid)&&(Zt=await O(s,!0)));we&&(Se._f.deps&&(!Array.isArray(Se._f.deps)||Se._f.deps.length>0)&&q(Se._f.deps),E(oe,Zt,ht,zn))}},B=(J,K)=>{if(Ie(t.errors,K)&&J.focus)return J.focus(),1},q=async(J,K={})=>{let oe,we;const Se=Rs(J);if(e.resolver){const _e=await I(Gt(J)?J:Se);oe=ts(_e),we=J?!Se.some(Pe=>Ie(_e,Pe)):oe}else J?(we=(await Promise.all(Se.map(async _e=>{const Pe=Ie(s,_e);return await O(Pe&&Pe._f?{[_e]:Pe}:Pe)}))).every(Boolean),!(!we&&!t.isValid)&&v()):we=oe=await O(s);return p.state.next({...!tr(J)||(h.isValid||f.isValid)&&oe!==t.isValid?{}:{name:J},...e.resolver||!J?{isValid:oe}:{},errors:t.errors}),K.shouldFocus&&!we&&Rc(s,B,J?Se:l.mount),we},Q=(J,K)=>{let oe={...o.mount?i:r};return K&&(oe=aA(K.dirtyFields?t.dirtyFields:t.touchedFields,oe)),Gt(J)?oe:tr(J)?Ie(oe,J):J.map(we=>Ie(oe,we))},le=(J,K)=>({invalid:!!Ie((K||t).errors,J),isDirty:!!Ie((K||t).dirtyFields,J),error:Ie((K||t).errors,J),isValidating:!!Ie(t.validatingFields,J),isTouched:!!Ie((K||t).touchedFields,J)}),X=J=>{J&&Rs(J).forEach(K=>bn(t.errors,K)),p.state.next({errors:J?t.errors:{}})},Z=(J,K,oe)=>{const we=(Ie(s,J,{_f:{}})._f||{}).ref,Se=Ie(t.errors,J)||{},{ref:_e,message:Pe,type:Ue,...ht}=Se;Mt(t.errors,J,{...ht,...K,ref:we}),p.state.next({name:J,errors:t.errors,isValid:!1}),oe&&oe.shouldFocus&&we&&we.focus&&we.focus()},se=(J,K)=>zr(J)?p.state.subscribe({next:oe=>"values"in oe&&J(H(void 0,K),oe)}):H(J,K,!0),G=J=>p.state.subscribe({next:K=>{uK(J.name,K.name,J.exact)&&dK(K,J.formState||h,dt,J.reRenderRoot)&&J.callback({values:{...i},...t,...K,defaultValues:r})}}).unsubscribe,ne=J=>(o.mount=!0,f={...f,...J.formState},G({...J,formState:f})),ge=(J,K={})=>{for(const oe of J?Rs(J):l.mount)l.mount.delete(oe),l.array.delete(oe),K.keepValue||(bn(s,oe),bn(i,oe)),!K.keepError&&bn(t.errors,oe),!K.keepDirty&&bn(t.dirtyFields,oe),!K.keepTouched&&bn(t.touchedFields,oe),!K.keepIsValidating&&bn(t.validatingFields,oe),!e.shouldUnregister&&!K.keepDefaultValue&&bn(r,oe);p.state.next({values:Qt(i)}),p.state.next({...t,...K.keepDirty?{isDirty:z()}:{}}),!K.keepIsValid&&v()},ye=({disabled:J,name:K})=>{(Js(J)&&o.mount||J||l.disabled.has(K))&&(J?l.disabled.add(K):l.disabled.delete(K))},re=(J,K={})=>{let oe=Ie(s,J);const we=Js(K.disabled)||Js(e.disabled);return Mt(s,J,{...oe||{},_f:{...oe&&oe._f?oe._f:{ref:{name:J}},name:J,mount:!0,...K}}),l.mount.add(J),oe?ye({disabled:Js(K.disabled)?K.disabled:e.disabled,name:J}):S(J,!0,K.value),{...we?{disabled:K.disabled||e.disabled}:{},...e.progressive?{required:!!K.required,min:Gd(K.min),max:Gd(K.max),minLength:Gd(K.minLength),maxLength:Gd(K.maxLength),pattern:Gd(K.pattern)}:{},name:J,onChange:W,onBlur:W,ref:Se=>{if(Se){re(J,K),oe=Ie(s,J);const _e=Gt(Se.value)&&Se.querySelectorAll&&Se.querySelectorAll("input,select,textarea")[0]||Se,Pe=sK(_e),Ue=oe._f.refs||[];if(Pe?Ue.find(ht=>ht===_e):_e===oe._f.ref)return;Mt(s,J,{_f:{...oe._f,...Pe?{refs:[...Ue.filter(yx),_e,...Array.isArray(Ie(r,J))?[{}]:[]],ref:{type:_e.type,name:J}}:{ref:_e}}}),S(J,!1,void 0,_e)}else oe=Ie(s,J,{}),oe._f&&(oe._f.mount=!1),(e.shouldUnregister||K.shouldUnregister)&&!(nA(l.array,J)&&o.action)&&l.unMount.add(J)}}},ae=()=>e.shouldFocusError&&Rc(s,B,l.mount),ve=J=>{Js(J)&&(p.state.next({disabled:J}),Rc(s,(K,oe)=>{const we=Ie(s,oe);we&&(K.disabled=we._f.disabled||J,Array.isArray(we._f.refs)&&we._f.refs.forEach(Se=>{Se.disabled=we._f.disabled||J}))},0,!1))},pe=(J,K)=>async oe=>{let we;oe&&(oe.preventDefault&&oe.preventDefault(),oe.persist&&oe.persist());let Se=Qt(i);if(p.state.next({isSubmitting:!0}),e.resolver){const{errors:_e,values:Pe}=await M();t.errors=_e,Se=Qt(Pe)}else await O(s);if(l.disabled.size)for(const _e of l.disabled)bn(Se,_e);if(bn(t.errors,"root"),ts(t.errors)){p.state.next({errors:{}});try{await J(Se,oe)}catch(_e){we=_e}}else K&&await K({...t.errors},oe),ae(),setTimeout(ae);if(p.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:ts(t.errors)&&!we,submitCount:t.submitCount+1,errors:t.errors}),we)throw we},Ne=(J,K={})=>{Ie(s,J)&&(Gt(K.defaultValue)?U(J,Qt(Ie(r,J))):(U(J,K.defaultValue),Mt(r,J,Qt(K.defaultValue))),K.keepTouched||bn(t.touchedFields,J),K.keepDirty||(bn(t.dirtyFields,J),t.isDirty=K.defaultValue?z(J,Qt(Ie(r,J))):z()),K.keepError||(bn(t.errors,J),h.isValid&&v()),p.state.next({...t}))},Me=(J,K={})=>{const oe=J?Qt(J):r,we=Qt(oe),Se=ts(J),_e=Se?r:we;if(K.keepDefaultValues||(r=oe),!K.keepValues){if(K.keepDirtyValues){const Pe=new Set([...l.mount,...Object.keys(dc(r,i))]);for(const Ue of Array.from(Pe))Ie(t.dirtyFields,Ue)?Mt(_e,Ue,Ie(i,Ue)):U(Ue,Ie(_e,Ue))}else{if(i_&&Gt(J))for(const Pe of l.mount){const Ue=Ie(s,Pe);if(Ue&&Ue._f){const ht=Array.isArray(Ue._f.refs)?Ue._f.refs[0]:Ue._f.ref;if(Op(ht)){const Zt=ht.closest("form");if(Zt){Zt.reset();break}}}}if(K.keepFieldsRef)for(const Pe of l.mount)U(Pe,Ie(_e,Pe));else s={}}i=e.shouldUnregister?K.keepDefaultValues?Qt(r):{}:Qt(_e),p.array.next({values:{..._e}}),p.state.next({values:{..._e}})}l={mount:K.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!K.keepIsValid||!!K.keepDirtyValues||!e.shouldUnregister&&!ts(_e),o.watch=!!e.shouldUnregister,p.state.next({submitCount:K.keepSubmitCount?t.submitCount:0,isDirty:Se?!1:K.keepDirty?t.isDirty:!!(K.keepDefaultValues&&!$r(J,r)),isSubmitted:K.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Se?{}:K.keepDirtyValues?K.keepDefaultValues&&i?dc(r,i):t.dirtyFields:K.keepDefaultValues&&J?dc(r,J):K.keepDirty?t.dirtyFields:{},touchedFields:K.keepTouched?t.touchedFields:{},errors:K.keepErrors?t.errors:{},isSubmitSuccessful:K.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:r})},Oe=(J,K)=>Me(zr(J)?J(i):J,K),Je=(J,K={})=>{const oe=Ie(s,J),we=oe&&oe._f;if(we){const Se=we.refs?we.refs[0]:we.ref;Se.focus&&(Se.focus(),K.shouldSelect&&zr(Se.select)&&Se.select())}},dt=J=>{t={...t,...J}},_t={control:{register:re,unregister:ge,getFieldState:le,handleSubmit:pe,setError:Z,_subscribe:G,_runSchema:M,_focusError:ae,_getWatch:H,_getDirty:z,_setValid:v,_setFieldArray:N,_setDisabledField:ye,_setErrors:k,_getFieldArray:F,_reset:Me,_resetDefaultValues:()=>zr(e.defaultValues)&&e.defaultValues().then(J=>{Oe(J,e.resetOptions),p.state.next({isLoading:!1})}),_removeUnmounted:D,_disableForm:ve,_subjects:p,_proxyFormState:h,get _fields(){return s},get _formValues(){return i},get _state(){return o},set _state(J){o=J},get _defaultValues(){return r},get _names(){return l},set _names(J){l=J},get _formState(){return t},get _options(){return e},set _options(J){e={...e,...J}}},subscribe:ne,trigger:q,register:re,handleSubmit:pe,watch:se,setValue:U,getValues:Q,reset:Oe,resetField:Ne,clearErrors:X,unregister:ge,setError:Z,setFocus:Je,getFieldState:le};return{..._t,formControl:_t}}var _a=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},xx=(n,e,t={})=>t.shouldFocus||Gt(t.shouldFocus)?t.focusName||`${n}.${Gt(t.focusIndex)?e:t.focusIndex}.`:"",vx=(n,e)=>[...n,...Rs(e)],bx=n=>Array.isArray(n)?n.map(()=>{}):void 0;function wx(n,e,t){return[...n.slice(0,e),...Rs(t),...n.slice(e)]}var _x=(n,e,t)=>Array.isArray(n)?(Gt(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],Sx=(n,e)=>[...Rs(e),...Rs(n)];function gK(n,e){let t=0;const s=[...n];for(const r of e)s.splice(r-t,1),t++;return Rg(s).length?s:[]}var Nx=(n,e)=>Gt(e)?[]:gK(n,Rs(e).sort((t,s)=>t-s)),jx=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},Pk=(n,e,t)=>(n[e]=t,n);function vs(n){const e=Lg(),{control:t=e.control,name:s,keyName:r="id",shouldUnregister:i,rules:o}=n,[l,c]=Fe.useState(t._getFieldArray(s)),d=Fe.useRef(t._getFieldArray(s).map(_a)),h=Fe.useRef(!1);t._names.array.add(s),Fe.useMemo(()=>o&&l.length>=0&&t.register(s,o),[t,s,l.length,o]),Fg(()=>t._subjects.array.subscribe({next:({values:S,name:P})=>{if(P===s||!P){const E=Ie(S,s);Array.isArray(E)&&(c(E),d.current=E.map(_a))}}}).unsubscribe,[t,s]);const f=Fe.useCallback(S=>{h.current=!0,t._setFieldArray(s,S)},[t,s]),p=(S,P)=>{const E=Rs(Qt(S)),M=vx(t._getFieldArray(s),E);t._names.focus=xx(s,M.length-1,P),d.current=vx(d.current,E.map(_a)),f(M),c(M),t._setFieldArray(s,M,vx,{argA:bx(S)})},g=(S,P)=>{const E=Rs(Qt(S)),M=Sx(t._getFieldArray(s),E);t._names.focus=xx(s,0,P),d.current=Sx(d.current,E.map(_a)),f(M),c(M),t._setFieldArray(s,M,Sx,{argA:bx(S)})},b=S=>{const P=Nx(t._getFieldArray(s),S);d.current=Nx(d.current,S),f(P),c(P),!Array.isArray(Ie(t._fields,s))&&Mt(t._fields,s,void 0),t._setFieldArray(s,P,Nx,{argA:S})},v=(S,P,E)=>{const M=Rs(Qt(P)),I=wx(t._getFieldArray(s),S,M);t._names.focus=xx(s,S,E),d.current=wx(d.current,S,M.map(_a)),f(I),c(I),t._setFieldArray(s,I,wx,{argA:S,argB:bx(P)})},_=(S,P)=>{const E=t._getFieldArray(s);jx(E,S,P),jx(d.current,S,P),f(E),c(E),t._setFieldArray(s,E,jx,{argA:S,argB:P},!1)},N=(S,P)=>{const E=t._getFieldArray(s);_x(E,S,P),_x(d.current,S,P),f(E),c(E),t._setFieldArray(s,E,_x,{argA:S,argB:P},!1)},j=(S,P)=>{const E=Qt(P),M=Pk(t._getFieldArray(s),S,E);d.current=[...M].map((I,O)=>!I||O===S?_a():d.current[O]),f(M),c([...M]),t._setFieldArray(s,M,Pk,{argA:S,argB:E},!0,!1)},k=S=>{const P=Rs(Qt(S));d.current=P.map(_a),f([...P]),c([...P]),t._setFieldArray(s,[...P],E=>E,{},!0,!1)};return Fe.useEffect(()=>{if(t._state.action=!1,qb(s,t._names)&&t._subjects.state.next({...t._formState}),h.current&&(!jc(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!jc(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([s]).then(S=>{const P=Ie(S.errors,s),E=Ie(t._formState.errors,s);(E?!P&&E.type||P&&(E.type!==P.type||E.message!==P.message):P&&P.type)&&(P?Mt(t._formState.errors,s,P):bn(t._formState.errors,s),t._subjects.state.next({errors:t._formState.errors}))});else{const S=Ie(t._fields,s);S&&S._f&&!(jc(t._options.reValidateMode).isOnSubmit&&jc(t._options.mode).isOnSubmit)&&Hb(S,t._names.disabled,t._formValues,t._options.criteriaMode===_r.all,t._options.shouldUseNativeValidation,!0).then(P=>!ts(P)&&t._subjects.state.next({errors:hA(t._formState.errors,P,s)}))}t._subjects.state.next({name:s,values:Qt(t._formValues)}),t._names.focus&&Rc(t._fields,(S,P)=>{if(t._names.focus&&P.startsWith(t._names.focus)&&S.focus)return S.focus(),1}),t._names.focus="",t._setValid(),h.current=!1},[l,s,t]),Fe.useEffect(()=>(!Ie(t._formValues,s)&&t._setFieldArray(s),()=>{const S=(P,E)=>{const M=Ie(t._fields,P);M&&M._f&&(M._f.mount=E)};t._options.shouldUnregister||i?t.unregister(s):S(s,!1)}),[s,t,r,i]),{swap:Fe.useCallback(_,[f,s,t]),move:Fe.useCallback(N,[f,s,t]),prepend:Fe.useCallback(g,[f,s,t]),append:Fe.useCallback(p,[f,s,t]),remove:Fe.useCallback(b,[f,s,t]),insert:Fe.useCallback(v,[f,s,t]),update:Fe.useCallback(j,[f,s,t]),replace:Fe.useCallback(k,[f,s,t]),fields:Fe.useMemo(()=>l.map((S,P)=>({...S,[r]:d.current[P]||_a()})),[l,r])}}function xt(n={}){const e=Fe.useRef(void 0),t=Fe.useRef(void 0),[s,r]=Fe.useState({isDirty:!1,isValidating:!1,isLoading:zr(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:zr(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:s},n.defaultValues&&!zr(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=pK(n);e.current={...l,formState:s}}const i=e.current.control;return i._options=n,Fg(()=>{const o=i._subscribe({formState:i._proxyFormState,callback:()=>r({...i._formState}),reRenderRoot:!0});return r(l=>({...l,isReady:!0})),i._formState.isReady=!0,o},[i]),Fe.useEffect(()=>i._disableForm(n.disabled),[i,n.disabled]),Fe.useEffect(()=>{n.mode&&(i._options.mode=n.mode),n.reValidateMode&&(i._options.reValidateMode=n.reValidateMode)},[i,n.mode,n.reValidateMode]),Fe.useEffect(()=>{n.errors&&(i._setErrors(n.errors),i._focusError())},[i,n.errors]),Fe.useEffect(()=>{n.shouldUnregister&&i._subjects.state.next({values:i._getWatch()})},[i,n.shouldUnregister]),Fe.useEffect(()=>{if(i._proxyFormState.isDirty){const o=i._getDirty();o!==s.isDirty&&i._subjects.state.next({isDirty:o})}},[i,s.isDirty]),Fe.useEffect(()=>{n.values&&!$r(n.values,t.current)?(i._reset(n.values,{keepFieldsRef:!0,...i._options.resetOptions}),t.current=n.values,r(o=>({...o}))):i._resetDefaultValues()},[i,n.values]),Fe.useEffect(()=>{i._state.mount||(i._setValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()}),e.current.formState=rA(s,i),e.current}const Mk=(n,e,t)=>{if(n&&"reportValidity"in n){const s=Ie(t,e);n.setCustomValidity(s&&s.message||""),n.reportValidity()}},fA=(n,e)=>{for(const t in e.fields){const s=e.fields[t];s&&s.ref&&"reportValidity"in s.ref?Mk(s.ref,t,n):s.refs&&s.refs.forEach(r=>Mk(r,t,n))}},yK=(n,e)=>{e.shouldUseNativeValidation&&fA(n,e);const t={};for(const s in n){const r=Ie(e.fields,s),i=Object.assign(n[s]||{},{ref:r&&r.ref});if(xK(e.names||Object.keys(n),s)){const o=Object.assign({},Ie(t,s));Mt(o,"root",i),Mt(t,s,o)}else Mt(t,s,i)}return t},xK=(n,e)=>n.some(t=>t.startsWith(e+"."));function Lt(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(s,r,i){try{return Promise.resolve(function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](s,Object.assign({abortEarly:!1},e,{context:r}))).then(function(d){return i.shouldUseNativeValidation&&fA({},i),{values:t.raw?s:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c}(0,function(o){if(!o.inner)throw o;return{values:{},errors:yK((l=o,c=!i.shouldUseNativeValidation&&i.criteriaMode==="all",(l.inner||[]).reduce(function(d,h){if(d[h.path]||(d[h.path]={message:h.message,type:h.type}),c){var f=d[h.path].types,p=f&&f[h.type];d[h.path]=iA(h.path,c,d,h.type,p?[].concat(p,h.message):h.message)}return d},{})),i)};var l,c}))}catch(o){return Promise.reject(o)}}}function Dl(n){this._maxSize=n,this.clear()}Dl.prototype.clear=function(){this._size=0,this._values=Object.create(null)};Dl.prototype.get=function(n){return this._values[n]};Dl.prototype.set=function(n,e){return this._size>=this._maxSize&&this.clear(),n in this._values||this._size++,this._values[n]=e};var vK=/[^.^\]^[]+|(?=\[\]|\.\.)/g,mA=/^\d+$/,bK=/^\d/,wK=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,_K=/^\s*(['"]?)(.*?)(\1)\s*$/,c_=512,Dk=new Dl(c_),Ak=new Dl(c_),Ik=new Dl(c_),cl={Cache:Dl,split:Wb,normalizePath:Cx,setter:function(n){var e=Cx(n);return Ak.get(n)||Ak.set(n,function(s,r){for(var i=0,o=e.length,l=s;i<o-1;){var c=e[i];if(c==="__proto__"||c==="constructor"||c==="prototype")return s;l=l[e[i++]]}l[e[i]]=r})},getter:function(n,e){var t=Cx(n);return Ik.get(n)||Ik.set(n,function(r){for(var i=0,o=t.length;i<o;)if(r!=null||!e)r=r[t[i++]];else return;return r})},join:function(n){return n.reduce(function(e,t){return e+(d_(t)||mA.test(t)?"["+t+"]":(e?".":"")+t)},"")},forEach:function(n,e,t){SK(Array.isArray(n)?n:Wb(n),e,t)}};function Cx(n){return Dk.get(n)||Dk.set(n,Wb(n).map(function(e){return e.replace(_K,"$2")}))}function Wb(n){return n.match(vK)||[""]}function SK(n,e,t){var s=n.length,r,i,o,l;for(i=0;i<s;i++)r=n[i],r&&(CK(r)&&(r='"'+r+'"'),l=d_(r),o=!l&&/^\d+$/.test(r),e.call(t,r,l,o,i,n))}function d_(n){return typeof n=="string"&&n&&["'",'"'].indexOf(n.charAt(0))!==-1}function NK(n){return n.match(bK)&&!n.match(mA)}function jK(n){return wK.test(n)}function CK(n){return!d_(n)&&(NK(n)||jK(n))}const kK=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,$g=n=>n.match(kK)||[],zg=n=>n[0].toUpperCase()+n.slice(1),u_=(n,e)=>$g(n).join(e).toLowerCase(),pA=n=>$g(n).reduce((e,t)=>`${e}${e?t[0].toUpperCase()+t.slice(1).toLowerCase():t.toLowerCase()}`,""),TK=n=>zg(pA(n)),EK=n=>u_(n,"_"),PK=n=>u_(n,"-"),MK=n=>zg(u_(n," ")),DK=n=>$g(n).map(zg).join(" ");var kx={words:$g,upperFirst:zg,camelCase:pA,pascalCase:TK,snakeCase:EK,kebabCase:PK,sentenceCase:MK,titleCase:DK},h_={exports:{}};h_.exports=function(n){return gA(AK(n),n)};h_.exports.array=gA;function gA(n,e){var t=n.length,s=new Array(t),r={},i=t,o=IK(e),l=OK(n);for(e.forEach(function(d){if(!l.has(d[0])||!l.has(d[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});i--;)r[i]||c(n[i],i,new Set);return s;function c(d,h,f){if(f.has(d)){var p;try{p=", node was:"+JSON.stringify(d)}catch{p=""}throw new Error("Cyclic dependency"+p)}if(!l.has(d))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(d));if(!r[h]){r[h]=!0;var g=o.get(d)||new Set;if(g=Array.from(g),h=g.length){f.add(d);do{var b=g[--h];c(b,l.get(b),f)}while(h);f.delete(d)}s[--t]=d}}}function AK(n){for(var e=new Set,t=0,s=n.length;t<s;t++){var r=n[t];e.add(r[0]),e.add(r[1])}return Array.from(e)}function IK(n){for(var e=new Map,t=0,s=n.length;t<s;t++){var r=n[t];e.has(r[0])||e.set(r[0],new Set),e.has(r[1])||e.set(r[1],new Set),e.get(r[0]).add(r[1])}return e}function OK(n){for(var e=new Map,t=0,s=n.length;t<s;t++)e.set(n[t],t);return e}var RK=h_.exports;const LK=Jp(RK),FK=Object.prototype.toString,$K=Error.prototype.toString,zK=RegExp.prototype.toString,UK=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",VK=/^Symbol\((.*)\)(.*)$/;function BK(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function Ok(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return BK(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return UK.call(n).replace(VK,"Symbol($1)");const s=FK.call(n).slice(8,-1);return s==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):s==="Error"||n instanceof Error?"["+$K.call(n)+"]":s==="RegExp"?zK.call(n):null}function ta(n,e){let t=Ok(n,e);return t!==null?t:JSON.stringify(n,function(s,r){let i=Ok(this[s],e);return i!==null?i:r},2)}function yA(n){return n==null?[]:[].concat(n)}let xA,vA,bA,qK=/\$\{\s*(\w+)\s*\}/g;xA=Symbol.toStringTag;class Rk{constructor(e,t,s,r){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[xA]="Error",this.name="ValidationError",this.value=t,this.path=s,this.type=r,this.errors=[],this.inner=[],yA(e).forEach(i=>{if(gs.isError(i)){this.errors.push(...i.errors);const o=i.inner.length?i.inner:[i];this.inner.push(...o)}else this.errors.push(i)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}vA=Symbol.hasInstance;bA=Symbol.toStringTag;class gs extends Error{static formatError(e,t){const s=t.label||t.path||"this";return t=Object.assign({},t,{path:s,originalPath:t.path}),typeof e=="string"?e.replace(qK,(r,i)=>ta(t[i])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,s,r,i){const o=new Rk(e,t,s,r);if(i)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[bA]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,gs)}static[vA](e){return Rk[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let pi={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:s})=>{const r=s!=null&&s!==t?` (cast from the value \`${ta(s,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${ta(t,!0)}\``+r:`${n} must match the configured type. The validated value was: \`${ta(t,!0)}\``+r}},Ps={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},ja={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},Gb={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},Yb={isValue:"${path} field must be ${value}"},Em={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},Pm={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},HK={notType:n=>{const{path:e,value:t,spec:s}=n,r=s.types.length;if(Array.isArray(t)){if(t.length<r)return`${e} tuple value has too few items, expected a length of ${r} but got ${t.length} for value: \`${ta(t,!0)}\``;if(t.length>r)return`${e} tuple value has too many items, expected a length of ${r} but got ${t.length} for value: \`${ta(t,!0)}\``}return gs.formatError(pi.notType,n)}};Object.assign(Object.create(null),{mixed:pi,string:Ps,number:ja,date:Gb,object:Em,array:Pm,boolean:Yb,tuple:HK});const Ug=n=>n&&n.__isYupSchema__;class Lp{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:s,then:r,otherwise:i}=t,o=typeof s=="function"?s:(...l)=>l.every(c=>c===s);return new Lp(e,(l,c)=>{var d;let h=o(...l)?r:i;return(d=h==null?void 0:h(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let s=this.refs.map(i=>i.getValue(t==null?void 0:t.value,t==null?void 0:t.parent,t==null?void 0:t.context)),r=this.fn(s,e,t);if(r===void 0||r===e)return e;if(!Ug(r))throw new TypeError("conditions must return a schema object");return r.resolve(t)}}const $f={context:"$",value:"."};function f_(n,e){return new wo(n,e)}class wo{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===$f.context,this.isValue=this.key[0]===$f.value,this.isSibling=!this.isContext&&!this.isValue;let s=this.isContext?$f.context:this.isValue?$f.value:"";this.path=this.key.slice(s.length),this.getter=this.path&&cl.getter(this.path,!0),this.map=t.map}getValue(e,t,s){let r=this.isContext?s:this.isValue?e:t;return this.getter&&(r=this.getter(r||{})),this.map&&(r=this.map(r)),r}cast(e,t){return this.getValue(e,t==null?void 0:t.parent,t==null?void 0:t.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}wo.prototype.__isYupRef=!0;const Vr=n=>n==null;function tc(n){function e({value:t,path:s="",options:r,originalValue:i,schema:o},l,c){const{name:d,test:h,params:f,message:p,skipAbsent:g}=n;let{parent:b,context:v,abortEarly:_=o.spec.abortEarly,disableStackTrace:N=o.spec.disableStackTrace}=r;const j={value:t,parent:b,context:v};function k(z={}){const H=wA(Object.assign({value:t,originalValue:i,label:o.spec.label,path:z.path||s,spec:o.spec,disableStackTrace:z.disableStackTrace||N},f,z.params),j),F=new gs(gs.formatError(z.message||p,H),t,H.path,z.type||d,H.disableStackTrace);return F.params=H,F}const S=_?l:c;let P={path:s,parent:b,type:d,from:r.from,createError:k,resolve(z){return _A(z,j)},options:r,originalValue:i,schema:o};const E=z=>{gs.isError(z)?S(z):z?c(null):S(k())},M=z=>{gs.isError(z)?S(z):l(z)};if(g&&Vr(t))return E(!0);let O;try{var D;if(O=h.call(P,t,P),typeof((D=O)==null?void 0:D.then)=="function"){if(r.sync)throw new Error(`Validation test of type: "${P.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(O).then(E,M)}}catch(z){M(z);return}E(O)}return e.OPTIONS=n,e}function wA(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=_A(n[t],e);return n}function _A(n,e){return wo.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function WK(n,e,t,s=t){let r,i,o;return e?(cl.forEach(e,(l,c,d)=>{let h=c?l.slice(1,l.length-1):l;n=n.resolve({context:s,parent:r,value:t});let f=n.type==="tuple",p=d?parseInt(h,10):0;if(n.innerType||f){if(f&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&p>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);r=t,t=t&&t[p],n=f?n.spec.types[p]:n.innerType}if(!d){if(!n.fields||!n.fields[h])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);r=t,t=t&&t[h],n=n.fields[h]}i=h,o=c?"["+l+"]":"."+l}),{schema:n,parent:r,parentPath:i}):{parent:r,parentPath:e,schema:n}}class Fp extends Set{describe(){const e=[];for(const t of this.values())e.push(wo.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const s of this.values())t.push(e(s));return t}clone(){return new Fp(this.values())}merge(e,t){const s=this.clone();return e.forEach(r=>s.add(r)),t.forEach(r=>s.delete(r)),s}}function Cc(n,e=new Map){if(Ug(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let s=0;s<n.length;s++)t[s]=Cc(n[s],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[s,r]of n.entries())t.set(s,Cc(r,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const s of n)t.add(Cc(s,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[s,r]of Object.entries(n))t[s]=Cc(r,e)}else throw Error(`Unable to clone ${n}`);return t}function GK(n){if(!(n!=null&&n.length))return;const e=[];let t="",s=!1,r=!1;for(let i=0;i<n.length;i++){const o=n[i];if(o==="["&&!r){t&&(e.push(...t.split(".").filter(Boolean)),t=""),s=!0;continue}if(o==="]"&&!r){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),s=!1;continue}if(o==='"'){r=!r;continue}if(o==="."&&!s&&!r){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function YK(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(s=>({message:s,path:GK(t)}))}function SA(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return YK(n,e);const s=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(r=>SA(r,s))}class qs{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new Fp,this._blacklist=new Fp,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(pi.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e==null?void 0:e.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=Cc(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let s=e(this);return this._mutate=t,s}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,s=e.clone();const r=Object.assign({},t.spec,s.spec);return s.spec=r,s.internalTests=Object.assign({},t.internalTests,s.internalTests),s._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),s._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),s.tests=t.tests,s.exclusiveTests=t.exclusiveTests,s.withMutation(i=>{e.tests.forEach(o=>{i.test(o.OPTIONS)})}),s.transforms=[...t.transforms,...s.transforms],s}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let s=t.conditions;t=t.clone(),t.conditions=[],t=s.reduce((r,i)=>i.resolve(r,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,s,r,i;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(s=e.abortEarly)!=null?s:this.spec.abortEarly,recursive:(r=e.recursive)!=null?r:this.spec.recursive,disableStackTrace:(i=e.disableStackTrace)!=null?i:this.spec.disableStackTrace})}cast(e,t={}){let s=this.resolve(Object.assign({},t,{value:e})),r=t.assert==="ignore-optionality",i=s._cast(e,t);if(t.assert!==!1&&!s.isType(i)){if(r&&Vr(i))return i;let o=ta(e),l=ta(i);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${s.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return i}_cast(e,t){let s=e===void 0?e:this.transforms.reduce((r,i)=>i.call(this,r,e,this,t),e);return s===void 0&&(s=this.getDefault(t)),s}_validate(e,t={},s,r){let{path:i,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let h of Object.values(this.internalTests))h&&d.push(h);this.runTests({path:i,value:c,originalValue:o,options:t,tests:d},s,h=>{if(h.length)return r(h,c);this.runTests({path:i,value:c,originalValue:o,options:t,tests:this.tests},s,r)})}runTests(e,t,s){let r=!1,{tests:i,value:o,originalValue:l,path:c,options:d}=e,h=v=>{r||(r=!0,t(v,o))},f=v=>{r||(r=!0,s(v,o))},p=i.length,g=[];if(!p)return f([]);let b={value:o,originalValue:l,path:c,options:d,schema:this};for(let v=0;v<i.length;v++){const _=i[v];_(b,h,function(j){j&&(Array.isArray(j)?g.push(...j):g.push(j)),--p<=0&&f(g)})}}asNestedTest({key:e,index:t,parent:s,parentPath:r,originalParent:i,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=s[l];const h=Object.assign({},o,{strict:!0,parent:s,value:d,originalValue:i[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${r||""}[${c?l:`"${l}"`}]`:(r?`${r}.`:"")+e});return(f,p,g)=>this.resolve(h)._validate(d,h,p,g)}validate(e,t){var s;let r=this.resolve(Object.assign({},t,{value:e})),i=(s=t==null?void 0:t.disableStackTrace)!=null?s:r.spec.disableStackTrace;return new Promise((o,l)=>r._validate(e,t,(c,d)=>{gs.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new gs(c,d,void 0,void 0,i)):o(d)}))}validateSync(e,t){var s;let r=this.resolve(Object.assign({},t,{value:e})),i,o=(s=t==null?void 0:t.disableStackTrace)!=null?s:r.spec.disableStackTrace;return r._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw gs.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new gs(l,e,void 0,void 0,o);i=c}),i}isValid(e,t){return this.validate(e,t).then(()=>!0,s=>{if(gs.isError(s))return!1;throw s})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(s){if(gs.isError(s))return!1;throw s}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):Cc(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const s=this.clone({nullable:e});return s.internalTests.nullable=tc({message:t,name:"nullable",test(r){return r===null?this.schema.spec.nullable:!0}}),s}optionality(e,t){const s=this.clone({optional:e});return s.internalTests.optionality=tc({message:t,name:"optionality",test(r){return r===void 0?this.schema.spec.optional:!0}}),s}optional(){return this.optionality(!0)}defined(e=pi.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=pi.notNull){return this.nullability(!1,e)}required(e=pi.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=pi.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let s=this.clone(),r=tc(t),i=t.exclusive||t.name&&s.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(s.exclusiveTests[t.name]=!!t.exclusive),s.tests=s.tests.filter(o=>!(o.OPTIONS.name===t.name&&(i||o.OPTIONS.test===r.OPTIONS.test))),s.tests.push(r),s}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let s=this.clone(),r=yA(e).map(i=>new wo(i));return r.forEach(i=>{i.isSibling&&s.deps.push(i.key)}),s.conditions.push(typeof t=="function"?new Lp(r,t):Lp.fromOptions(r,t)),s}typeError(e){let t=this.clone();return t.internalTests.typeError=tc({message:e,name:"typeError",skipAbsent:!0,test(s){return this.schema._typeCheck(s)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=pi.oneOf){let s=this.clone();return e.forEach(r=>{s._whitelist.add(r),s._blacklist.delete(r)}),s.internalTests.whiteList=tc({message:t,name:"oneOf",skipAbsent:!0,test(r){let i=this.schema._whitelist,o=i.resolveAll(this.resolve);return o.includes(r)?!0:this.createError({params:{values:Array.from(i).join(", "),resolved:o}})}}),s}notOneOf(e,t=pi.notOneOf){let s=this.clone();return e.forEach(r=>{s._blacklist.add(r),s._whitelist.delete(r)}),s.internalTests.blacklist=tc({message:t,name:"notOneOf",test(r){let i=this.schema._blacklist,o=i.resolveAll(this.resolve);return o.includes(r)?this.createError({params:{values:Array.from(i).join(", "),resolved:o}}):!0}}),s}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:s,meta:r,optional:i,nullable:o}=t.spec;return{meta:r,label:s,optional:i,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,h)=>h.findIndex(f=>f.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?wA(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(s){try{return{value:await e.validate(s,{abortEarly:!1})}}catch(r){if(r instanceof gs)return{issues:SA(r)};throw r}}}}}qs.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])qs.prototype[`${n}At`]=function(e,t,s={}){const{parent:r,parentPath:i,schema:o}=WK(this,e,t,s.context);return o[n](r&&r[i],Object.assign({},s,{parent:r,path:e}))};for(const n of["equals","is"])qs.prototype[n]=qs.prototype.oneOf;for(const n of["not","nope"])qs.prototype[n]=qs.prototype.notOneOf;const ZK=()=>!0;function ot(n){return new NA(n)}class NA extends qs{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:ZK},e))}}ot.prototype=NA.prototype;function ns(){return new jA}class jA extends qs{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=Yb.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return Vr(t)||t===!0}})}isFalse(e=Yb.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return Vr(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}ns.prototype=jA.prototype;const KK=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function JK(n){const e=Zb(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function Zb(n){var e,t;const s=KK.exec(n);return s?{year:Li(s[1]),month:Li(s[2],1)-1,day:Li(s[3],1),hour:Li(s[4]),minute:Li(s[5]),second:Li(s[6]),millisecond:s[7]?Li(s[7].substring(0,3)):0,precision:(e=(t=s[7])==null?void 0:t.length)!=null?e:void 0,z:s[8]||void 0,plusMinus:s[9]||void 0,hourOffset:Li(s[10]),minuteOffset:Li(s[11])}:null}function Li(n,e=0){return Number(n)||e}let QK=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,XK=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,eJ=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,tJ="^\\d{4}-\\d{2}-\\d{2}",nJ="\\d{2}:\\d{2}:\\d{2}",sJ="(([+-]\\d{2}(:?\\d{2})?)|Z)",rJ=new RegExp(`${tJ}T${nJ}(\\.\\d+)?${sJ}$`),iJ=n=>Vr(n)||n===n.trim(),aJ={}.toString();function ie(){return new CA}class CA extends qs{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const s=e!=null&&e.toString?e.toString():e;return s===aJ?e:s})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||pi.required,name:"required",skipAbsent:!0,test:s=>!!s.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Ps.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(s){return s.length===this.resolve(e)}})}min(e,t=Ps.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s.length>=this.resolve(e)}})}max(e,t=Ps.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(s){return s.length<=this.resolve(e)}})}matches(e,t){let s=!1,r,i;return t&&(typeof t=="object"?{excludeEmptyString:s=!1,message:r,name:i}=t:r=t),this.test({name:i||"matches",message:r||Ps.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&s||o.search(e)!==-1})}email(e=Ps.email){return this.matches(QK,{name:"email",message:e,excludeEmptyString:!0})}url(e=Ps.url){return this.matches(XK,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Ps.uuid){return this.matches(eJ,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",s,r;return e&&(typeof e=="object"?{message:t="",allowOffset:s=!1,precision:r=void 0}=e:t=e),this.matches(rJ,{name:"datetime",message:t||Ps.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Ps.datetime_offset,params:{allowOffset:s},skipAbsent:!0,test:i=>{if(!i||s)return!0;const o=Zb(i);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Ps.datetime_precision,params:{precision:r},skipAbsent:!0,test:i=>{if(!i||r==null)return!0;const o=Zb(i);return o?o.precision===r:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Ps.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:iJ})}lowercase(e=Ps.lowercase){return this.transform(t=>Vr(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Vr(t)||t===t.toLowerCase()})}uppercase(e=Ps.uppercase){return this.transform(t=>Vr(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Vr(t)||t===t.toUpperCase()})}}ie.prototype=CA.prototype;let oJ=n=>n!=+n;function ss(){return new kA}class kA extends qs{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!oJ(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let s=e;if(typeof s=="string"){if(s=s.replace(/\s/g,""),s==="")return NaN;s=+s}return this.isType(s)||s===null?s:parseFloat(s)})})}min(e,t=ja.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(e)}})}max(e,t=ja.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(e)}})}lessThan(e,t=ja.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(s){return s<this.resolve(e)}})}moreThan(e,t=ja.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(s){return s>this.resolve(e)}})}positive(e=ja.positive){return this.moreThan(0,e)}negative(e=ja.negative){return this.lessThan(0,e)}integer(e=ja.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>Vr(e)?e:e|0)}round(e){var t;let s=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(s.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+s.join(", "));return this.transform(r=>Vr(r)?r:Math[e](r))}}ss.prototype=kA.prototype;let lJ=new Date(""),cJ=n=>Object.prototype.toString.call(n)==="[object Date]";class m_ extends qs{constructor(){super({type:"date",check(e){return cJ(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=JK(e),isNaN(e)?m_.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let s;if(wo.isRef(e))s=e;else{let r=this.cast(e);if(!this._typeCheck(r))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);s=r}return s}min(e,t=Gb.min){let s=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(s)}})}max(e,t=Gb.max){let s=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(s)}})}}m_.INVALID_DATE=lJ;function dJ(n,e=[]){let t=[],s=new Set,r=new Set(e.map(([o,l])=>`${o}-${l}`));function i(o,l){let c=cl.split(o)[0];s.add(c),r.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];s.add(o),wo.isRef(l)&&l.isSibling?i(l.path,o):Ug(l)&&"deps"in l&&l.deps.forEach(c=>i(c,o))}return LK.array(Array.from(s),t).reverse()}function Lk(n,e){let t=1/0;return n.some((s,r)=>{var i;if((i=e.path)!=null&&i.includes(s))return t=r,!0}),t}function TA(n){return(e,t)=>Lk(n,e)-Lk(n,t)}const EA=(n,e,t)=>{if(typeof n!="string")return n;let s=n;try{s=JSON.parse(n)}catch{}return t.isType(s)?s:n};function Mm(n){if("fields"in n){const e={};for(const[t,s]of Object.entries(n.fields))e[t]=Mm(s);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=Mm(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(Mm)}):"optional"in n?n.optional():n}const uJ=(n,e)=>{const t=[...cl.normalizePath(e)];if(t.length===1)return t[0]in n;let s=t.pop(),r=cl.getter(cl.join(t),!0)(n);return!!(r&&s in r)};let Fk=n=>Object.prototype.toString.call(n)==="[object Object]";function $k(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(s=>t.indexOf(s)===-1)}const hJ=TA([]);function Ke(n){return new PA(n)}class PA extends qs{constructor(e){super({type:"object",check(t){return Fk(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=hJ,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var s;let r=super._cast(e,t);if(r===void 0)return this.getDefault(t);if(!this._typeCheck(r))return r;let i=this.fields,o=(s=t.stripUnknown)!=null?s:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(r).filter(f=>!this._nodes.includes(f))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),h=!1;for(const f of l){let p=i[f],g=f in r,b=r[f];if(p){let v;d.path=(t.path?`${t.path}.`:"")+f,p=p.resolve({value:b,context:t.context,parent:c});let _=p instanceof qs?p.spec:void 0,N=_==null?void 0:_.strict;if(_!=null&&_.strip){h=h||f in r;continue}v=!t.__validating||!N?p.cast(b,d):b,v!==void 0&&(c[f]=v)}else g&&!o&&(c[f]=b);(g!==f in c||c[f]!==b)&&(h=!0)}return h?c:r}_validate(e,t={},s,r){let{from:i=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...i],t.__validating=!0,t.originalValue=o,super._validate(e,t,s,(c,d)=>{if(!l||!Fk(d)){r(c,d);return}o=o||d;let h=[];for(let f of this._nodes){let p=this.fields[f];!p||wo.isRef(p)||h.push(p.asNestedTest({options:t,key:f,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:h,value:d,originalValue:o,options:t},s,f=>{r(f.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),s=t.fields;for(let[r,i]of Object.entries(this.fields)){const o=s[r];s[r]=o===void 0?i:o}return t.withMutation(r=>r.setFields(s,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(s=>{var r;const i=this.fields[s];let o=e;(r=o)!=null&&r.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[s]})),t[s]=i&&"getDefault"in i?i.getDefault(o):void 0}),t}setFields(e,t){let s=this.clone();return s.fields=e,s._nodes=dJ(e,t),s._sortErrors=TA(Object.keys(e)),t&&(s._excludedEdges=t),s}shape(e,t=[]){return this.clone().withMutation(s=>{let r=s._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),r=[...s._excludedEdges,...t]),s.setFields(Object.assign(s.fields,e),r)})}partial(){const e={};for(const[t,s]of Object.entries(this.fields))e[t]="optional"in s&&s.optional instanceof Function?s.optional():s;return this.setFields(e)}deepPartial(){return Mm(this)}pick(e){const t={};for(const s of e)this.fields[s]&&(t[s]=this.fields[s]);return this.setFields(t,this._excludedEdges.filter(([s,r])=>e.includes(s)&&e.includes(r)))}omit(e){const t=[];for(const s of Object.keys(this.fields))e.includes(s)||t.push(s);return this.pick(t)}from(e,t,s){let r=cl.getter(e,!0);return this.transform(i=>{if(!i)return i;let o=i;return uJ(i,e)&&(o=Object.assign({},i),s||delete o[e],o[t]=r(i)),o})}json(){return this.transform(EA)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||Em.exact,test(t){if(t==null)return!0;const s=$k(this.schema,t);return s.length===0||this.createError({params:{properties:s.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=Em.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let s=this.test({name:"noUnknown",exclusive:!0,message:t,test(r){if(r==null)return!0;const i=$k(this.schema,r);return!e||i.length===0||this.createError({params:{unknown:i.join(", ")}})}});return s.spec.noUnknown=e,s}unknown(e=!0,t=Em.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const s={};for(const r of Object.keys(t))s[e(r)]=t[r];return s})}camelCase(){return this.transformKeys(kx.camelCase)}snakeCase(){return this.transformKeys(kx.snakeCase)}constantCase(){return this.transformKeys(e=>kx.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),s=super.describe(e);s.fields={};for(const[i,o]of Object.entries(t.fields)){var r;let l=e;(r=l)!=null&&r.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[i]})),s.fields[i]=o.describe(l)}return s}}Ke.prototype=PA.prototype;function xs(n){return new MA(n)}class MA extends qs{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const s=super._cast(e,t);if(!this._typeCheck(s)||!this.innerType)return s;let r=!1;const i=s.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:s,originalValue:o,value:o,index:l}));return c!==o&&(r=!0),c});return r?i:s}_validate(e,t={},s,r){var i;let o=this.innerType,l=(i=t.recursive)!=null?i:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,s,(c,d)=>{var h;if(!l||!o||!this._typeCheck(d)){r(c,d);return}let f=new Array(d.length);for(let g=0;g<d.length;g++){var p;f[g]=o.asNestedTest({options:t,index:g,parent:d,parentPath:t.path,originalParent:(p=t.originalValue)!=null?p:e})}this.runTests({value:d,tests:f,originalValue:(h=t.originalValue)!=null?h:e,options:t},s,g=>r(g.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(EA)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!Ug(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+ta(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=Pm.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(s){return s.length===this.resolve(e)}})}min(e,t){return t=t||Pm.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s.length>=this.resolve(e)}})}max(e,t){return t=t||Pm.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(s,r,i)=>!e(s,r,i):s=>!!s;return this.transform(s=>s!=null?s.filter(t):s)}describe(e){const t=(e?this.resolve(e):this).clone(),s=super.describe(e);if(t.innerType){var r;let i=e;(r=i)!=null&&r.value&&(i=Object.assign({},i,{parent:i.value,value:i.value[0]})),s.innerType=t.innerType.describe(i)}return s}}xs.prototype=MA.prototype;const he=({label:n,id:e,error:t,registration:s,...r})=>{const{className:i,...o}=r,d=`form-input ${t?"form-input--error":""} ${i||""}`,h=a.jsx("input",{id:e,className:d,"aria-invalid":!!t,...s,...o});return a.jsxs("div",{children:[n&&a.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),a.jsx("div",{className:n?"mt-1":"",children:h}),t&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},zt=C.forwardRef(({id:n,label:e,description:t,className:s,labelClassName:r,...i},o)=>{const l=n||i.name;return a.jsxs("div",{className:`relative flex items-start ${s}`,children:[a.jsx("div",{className:"flex h-6 items-center",children:a.jsx("input",{id:l,"aria-describedby":t?`${l}-description`:void 0,type:"checkbox",ref:o,className:"h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer",...i})}),a.jsxs("div",{className:"ml-3 text-sm leading-6",children:[a.jsx("label",{htmlFor:l,className:`font-medium text-primary-text cursor-pointer ${r}`,children:e}),t&&a.jsx("p",{id:`${l}-description`,className:"text-muted",children:t})]})]})});zt.displayName="Checkbox";function fJ(){const[n,e]=C.useState(null),[t,s]=C.useState(!1),[r,i]=C.useState(null);return C.useEffect(()=>{const l=(()=>{const f=navigator.userAgent,p=`${window.screen.width}x${window.screen.height}`,g=Intl.DateTimeFormat().resolvedOptions().timeZone,b=navigator.language,v=navigator.platform,_=navigator.hardwareConcurrency||0,N=`${f}|${p}|${g}|${b}|${v}|${_}`;let j=0;for(let E=0;E<N.length;E++){const M=N.charCodeAt(E);j=(j<<5)-j+M,j=j&j}const k="dev_"+Math.abs(j).toString(36),S=()=>f.indexOf("Chrome")>-1?"Chrome":f.indexOf("Firefox")>-1?"Firefox":f.indexOf("Safari")>-1?"Safari":f.indexOf("Edge")>-1?"Edge":"Unknown",P=()=>f.indexOf("Win")>-1?"Windows":f.indexOf("Mac")>-1?"MacOS":f.indexOf("Linux")>-1?"Linux":f.indexOf("Android")>-1?"Android":f.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:k,deviceName:`${P()} - ${S()}`,browser:S(),os:P(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),h=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(s(!0),i({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:h||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:r}}const mJ=Ke({email:ie().email("Must be a valid email").required("Email is required"),password:ie().required("Password is required"),rememberMe:ns().optional()}).defined(),pJ=n=>n.role==="unverified"?"/pending-approval":"/profile",gJ=()=>{var S,P;const{user:n,loginWithEmail:e,loginWithGoogle:t,error:s,setError:r,loading:i}=tt(),o=Vt(),l=Ns(),{deviceInfo:c,isNewDevice:d,previousDevice:h}=fJ(),[f,p]=C.useState(!1);C.useEffect(()=>{r(null);const E=new URLSearchParams(l.hash.substring(1)),M=E.get("error_code"),I=E.get("error_description");M==="otp_expired"&&I&&(r("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),o("/auth/login",{replace:!0}))},[r,l,o]),C.useEffect(()=>{n&&d&&h&&!f&&(te.sendDeviceChangeAlert(n.id,n.name,h.deviceName,(c==null?void 0:c.deviceName)||"Unknown Device").catch(E=>console.error("Failed to send device change alert:",E)),p(!0))},[n,d,h,f,c]),C.useEffect(()=>{n&&o(pJ(n),{replace:!0})},[n,o]);const{register:g,handleSubmit:b,setValue:v,formState:{errors:_}}=xt({resolver:Lt(mJ)});C.useEffect(()=>{const E=localStorage.getItem("rememberedEmail");E&&(v("email",E),v("rememberMe",!0))},[v]);const N=async E=>{await e(E.email,E.password,E.rememberMe||!1)},j=async()=>{await t()},k=i;return a.jsxs(a.Fragment,{children:[a.jsxs("form",{onSubmit:b(N),className:"space-y-3",children:[a.jsxs("fieldset",{disabled:k,className:"space-y-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Mh,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:g("email"),error:(S=_.email)==null?void 0:S.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300 !py-2"})]}),a.jsxs("div",{className:"relative",children:[a.jsx($b,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:g("password"),error:(P=_.password)==null?void 0:P.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300 !py-2"})]}),a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsx("div",{className:"flex-shrink-0",children:a.jsx(zt,{id:"rememberMe",label:"Remember me",labelClassName:"text-white",...g("rememberMe"),className:"text-white/80"})}),a.jsx(Yr,{to:"/auth/forgot-password",className:`text-sm font-medium text-white/80 hover:text-white ${k?"pointer-events-none opacity-50":""}`,"aria-disabled":k,onClick:E=>{k&&E.preventDefault()},children:"Forgot your password?"})]})]}),a.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:s&&a.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[a.jsx(Jr,{className:"h-4 w-4 flex-shrink-0"}),a.jsx("span",{children:s})]})}),a.jsx(Y,{type:"submit",className:"w-full",isLoading:i,size:"md",disabled:k,children:"Sign in"})]}),a.jsx("div",{className:"auth-separator my-2",children:"OR"}),a.jsxs("button",{type:"button",onClick:j,className:"google-signin-btn !py-2",disabled:k,children:[a.jsxs("svg",{viewBox:"0 0 48 48",children:[a.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),a.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),a.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),a.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),a.jsx("div",{className:"text-center mt-4",children:a.jsxs("p",{className:"text-sm text-gray-300",children:["Don't have an account?"," ",a.jsx(Yr,{to:"/auth/signup",className:"font-medium text-white/80 hover:text-white",children:"Sign Up"})]})})]})},yJ=Ke({name:ie().required("Your name is required"),email:ie().email("Must be a valid email").required("Email is required"),password:ie().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ie().oneOf([f_("password")],"Passwords must match").required("Please confirm your password")}).defined(),xJ=()=>{var h,f,p,g;const{signUp:n}=tt(),[e,t]=C.useState(""),[s,r]=C.useState(!1),{register:i,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=xt({resolver:Lt(yJ)}),d=async b=>{t("");const{error:v}=await n(b.name,b.email,b.password);v?t(v.message):r(!0)};return s?a.jsxs("div",{className:"text-center",children:[a.jsx(BD,{className:"mx-auto h-12 w-12 text-accent"}),a.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Confirm your email"}),a.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),a.jsx("div",{className:"mt-6",children:a.jsx(Yr,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login"})})]}):a.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[a.jsxs("div",{className:"relative",children:[a.jsx(yd,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"name",type:"text",placeholder:"Full Name",registration:i("name"),error:(h=l.name)==null?void 0:h.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),a.jsxs("div",{className:"relative",children:[a.jsx(Mh,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"email",type:"email",placeholder:"Email Address",registration:i("email"),error:(f=l.email)==null?void 0:f.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),a.jsxs("div",{className:"relative",children:[a.jsx($b,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"password",type:"password",placeholder:"Password",registration:i("password"),error:(p=l.password)==null?void 0:p.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),a.jsxs("div",{className:"relative",children:[a.jsx($b,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:i("confirmPassword"),error:(g=l.confirmPassword)==null?void 0:g.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&a.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),a.jsx("div",{className:"pt-2",children:a.jsx(Y,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),a.jsx("div",{className:"text-center pt-2",children:a.jsx(Yr,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:"Already have an account? Sign In"})})]})},vJ=Ke({email:ie().email("Must be a valid email").required("Email is required")}).defined(),bJ=()=>{var f;const{sendPasswordReset:n}=tt(),[e,t]=C.useState(""),[s,r]=C.useState(!1),i=Vt();C.useEffect(()=>{if(s){const p=setTimeout(()=>{i("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[s,i]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=xt({resolver:Lt(vJ)}),h=async p=>{t("");const{error:g}=await n(p.email);g&&g.message.includes("rate limit")?t("Too many requests. Please wait a while before trying again."):r(!0)};return s?a.jsxs("div",{className:"text-center",children:[a.jsx(BD,{className:"mx-auto h-12 w-12 text-accent"}),a.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Check your email"}),a.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):a.jsx(a.Fragment,{children:a.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[a.jsxs("div",{className:"relative",children:[a.jsx(Mh,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),a.jsx(he,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:(f=c.email)==null?void 0:f.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&a.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),a.jsx("div",{children:a.jsx(Y,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),a.jsx("div",{className:"text-center",children:a.jsx(Yr,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",children:" Back to Login"})})]})})},wJ=Ke({password:ie().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:ie().oneOf([f_("password")],"Passwords must match").required("Please confirm your password")}).defined(),_J=n=>n.includes("weak password")?"Password is too weak. It must be at least 6 characters long.":n.includes("requires a recent login")?"This action is sensitive and requires recent authentication. Please log in again before retrying.":(console.error("Unhandled Supabase auth error:",n),"An unexpected error occurred. Please try again."),SJ=()=>{var f,p;const[n,e]=C.useState(""),[t,s]=C.useState(!1),r=Vt(),{user:i}=tt();C.useEffect(()=>{i||e("Invalid or expired password reset session. Please request a new password reset link.")},[i]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=xt({resolver:Lt(wJ)}),h=async g=>{e("");const{error:b}=await mi.updateUserPassword(g.password);b?e(_J(b.message)):(s(!0),setTimeout(()=>r("/auth/login",{replace:!0}),2e3))};return t?a.jsxs("div",{className:"text-center",children:[a.jsx(Kr,{className:"mx-auto h-12 w-12 text-accent"}),a.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),a.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),a.jsx("div",{className:"mt-6",children:a.jsx(Yr,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!i?a.jsxs("div",{className:"text-center",children:[a.jsx("h3",{className:"text-3xl font-bold text-white",children:"Invalid Session"}),a.jsx("p",{className:"text-sm text-gray-300 mt-1",children:n}),a.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[a.jsx(Yr,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),a.jsx("div",{className:"auth-separator",children:"OR"}),a.jsx(Y,{onClick:()=>r("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):a.jsxs("div",{children:[a.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",a.jsx("span",{className:"font-semibold text-white",children:i==null?void 0:i.email}),"."]}),a.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[a.jsx(he,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:o("password"),error:(f=c.password)==null?void 0:f.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),a.jsx(he,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:o("confirmPassword"),error:(p=c.confirmPassword)==null?void 0:p.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&a.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),a.jsx("div",{children:a.jsx(Y,{type:"submit",className:"w-full",isLoading:d,size:"lg",disabled:!i,children:"Update Password"})})]})]})},NJ=()=>{const{logout:n,user:e}=tt(),t=Vt(),s=async()=>{await n(),t("/auth/login",{replace:!0})};return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:a.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[a.jsx(Qr,{className:"h-10 mx-auto mb-6"}),a.jsx(bZ,{className:"h-16 w-16 text-accent mx-auto mb-4"}),a.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),a.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",(e==null?void 0:e.name)||"user","! Your account has been created successfully and is awaiting administrator approval. Please kindly contact the administrator to activate your account."]}),a.jsx("div",{className:"flex justify-center",children:a.jsxs(Y,{onClick:s,variant:"secondary",children:[a.jsx(Mu,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},jJ=()=>{const n=Vt();return a.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:a.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[a.jsx("div",{className:"flex justify-center mb-4",children:a.jsx(Xw,{className:"h-16 w-16 text-red-500"})}),a.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),a.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),a.jsxs("div",{className:"flex justify-center gap-4",children:[a.jsx(Y,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),a.jsx(Y,{onClick:()=>n("/auth/login"),children:"Login"})]})]})})},CJ=()=>{const n=Vt(),{data:e,reset:t}=rn(),{user:s}=tt(),r=e.personal.firstName||e.personal.lastName,i=Nt("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return i?a.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:a.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("div",{className:"p-4 rounded-full bg-black/20",children:a.jsx(Fb,{className:"h-10 w-10 text-emerald-400"})})}),a.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),a.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),a.jsxs("div",{className:"flex flex-col gap-3",children:[r&&a.jsx(Y,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),a.jsx(Y,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):a.jsx("div",{className:"h-full flex items-center justify-center p-4",children:a.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[a.jsx("div",{className:"flex justify-center mb-6",children:a.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:a.jsx(Fb,{className:"h-12 w-12 text-accent-dark"})})}),a.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),a.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),a.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[r&&a.jsx(Y,{onClick:l,variant:"secondary",children:"Continue Draft"}),a.jsx(Y,{onClick:o,variant:"primary",children:r?"Start Fresh":"Start New Application"})]})]})})},Te=({label:n,id:e,error:t,registration:s,children:r,...i})=>{const{className:o,...l}=i,h=`form-input ${t?"form-input--error":""} ${o||""}`,f=a.jsx("select",{id:e,className:h,"aria-invalid":!!t,...s,...l,children:r});return a.jsxs("div",{children:[n&&a.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),a.jsx("div",{className:n?"mt-1":"",children:f}),t&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},kJ=()=>{const n=Vt(),{updateOrganization:e,updatePersonal:t}=rn(),{enforceManpowerLimit:s,manpowerLimitRule:r}=bo(),{user:i}=tt(),[o,l]=C.useState(!0),[c,d]=C.useState([]),[h,f]=C.useState([]),[p,g]=C.useState([]),[b,v]=C.useState(""),[_,N]=C.useState(""),[j,k]=C.useState(""),[S,P]=C.useState(""),[E,M]=C.useState([]),[I,O]=C.useState(window.innerWidth<768);C.useEffect(()=>{const q=()=>O(window.innerWidth<768);return window.addEventListener("resize",q),()=>window.removeEventListener("resize",q)},[]);const[D,z]=C.useState({isOverLimit:!1,message:""}),H=(i==null?void 0:i.role)==="field_officer"&&I;C.useEffect(()=>{(async()=>{l(!0);try{const[Q,le,X]=await Promise.all([te.getOrganizationStructure(),te.getOrganizations(),te.getSiteStaffDesignations()]);d(Q),f(le),g(X)}catch(Q){console.error("Failed to fetch organization structure",Q)}finally{l(!1)}})()},[]);const F=C.useMemo(()=>c.find(q=>q.id===b),[c,b]),R=C.useMemo(()=>(F==null?void 0:F.companies)||[],[F]),V=C.useMemo(()=>R.find(q=>q.id===_),[R,_]),U=C.useMemo(()=>(V==null?void 0:V.entities)||[],[V]);C.useEffect(()=>{P("");const q=U.find(Q=>Q.id===j);M(q?p:[])},[j,U,p]),C.useEffect(()=>{(async()=>{if(z({isOverLimit:!1,message:""}),!j||!s)return;const Q=U.find(se=>se.id===j),le=Q==null?void 0:Q.organizationId;if(!le)return;const X=h.find(se=>se.id===le),Z=X==null?void 0:X.manpowerApprovedCount;if(Z==null){z({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const G=(await te.getVerificationSubmissions()).filter(ne=>ne.organizationId===le&&(ne.status==="verified"||ne.status==="pending")).length;if(G>=Z){const ne=`Manpower limit of ${Z} reached (${G} deployed).`;z({isOverLimit:!0,message:ne})}else{const ne=`Manpower: ${G} / ${Z} deployed.`;z({isOverLimit:!1,message:ne})}}catch{z({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[j,h,U,s]);const W=()=>{const q=U.find(Q=>Q.id===j);if(q!=null&&q.organizationId){const Q=h.find(X=>X.id===q.organizationId),le=p.find(X=>X.designation===S);Q&&le?(e({organizationId:Q.id,organizationName:Q.shortName,joiningDate:Ce(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:S,department:le.department,defaultSalary:le.monthlySalary||null}),t({salary:le.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return a.jsx("div",{className:"flex justify-center items-center h-96",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})});const B=!j||!S||D.isOverLimit&&r==="block";return H?a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[a.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",children:a.jsx(Er,{className:"h-6 w-6"})}),a.jsx("h1",{children:"New Enrollment"})]}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:a.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:a.jsx(bl,{className:"h-8 w-8 text-accent-dark"})}),a.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),a.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("select",{value:b,onChange:q=>{v(q.target.value),N(""),k("")},className:"fo-select fo-select-arrow",children:[a.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs("select",{value:_,onChange:q=>{N(q.target.value),k("")},disabled:!b,className:"fo-select fo-select-arrow",children:[a.jsx("option",{value:"",children:"-- Select a Company --"}),R.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs("select",{value:j,onChange:q=>k(q.target.value),disabled:!_,className:"fo-select fo-select-arrow",children:[a.jsx("option",{value:"",children:"-- Select a Client/Site --"}),U.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs("select",{value:S,onChange:q=>P(q.target.value),disabled:!j,className:"fo-select fo-select-arrow",children:[a.jsx("option",{value:"",children:"-- Select a Designation --"}),E.map(q=>a.jsx("option",{value:q.designation,children:q.designation},q.id))]}),D.message&&a.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${D.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:D.message})]})]})}),a.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[a.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),a.jsx("button",{onClick:W,disabled:B,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):a.jsx("div",{className:"p-4 md:p-0",children:a.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[a.jsxs("div",{className:"flex items-center mb-6",children:[a.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:a.jsx(bl,{className:"h-8 w-8 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),a.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs(Te,{label:"Company Group",id:"group",value:b,onChange:q=>{v(q.target.value),N(""),k("")},children:[a.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs(Te,{label:"Company",id:"company",value:_,onChange:q=>{N(q.target.value),k("")},disabled:!b,children:[a.jsx("option",{value:"",children:"-- Select a Company --"}),R.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs(Te,{label:"Client / Site",id:"entity",value:j,onChange:q=>k(q.target.value),disabled:!_,children:[a.jsx("option",{value:"",children:"-- Select a Client/Site --"}),U.map(q=>a.jsx("option",{value:q.id,children:q.name},q.id))]}),a.jsxs(Te,{label:"Designation",id:"designation",value:S,onChange:q=>P(q.target.value),disabled:!j,children:[a.jsx("option",{value:"",children:"-- Select a Designation --"}),E.map(q=>a.jsx("option",{value:q.designation,children:q.designation},q.id))]})]}),D.message&&a.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${D.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:D.message}),a.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:a.jsxs(Y,{onClick:W,disabled:B,children:["Continue ",a.jsx(YY,{className:"ml-2 h-4 w-4"})]})})]})})},zk=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:s,isMobileOptimized:r=!1})=>{const[i,o]=C.useState(0),l=4,c=Math.ceil(n.length/l);C.useEffect(()=>{if(r){const p=Math.floor(e/l);o(p)}},[e,r,l]);const d=()=>{o(p=>Math.min(p+1,c-1))},h=()=>{o(p=>Math.max(p-1,0))},f=C.useMemo(()=>{if(!r)return[];const p=i*l,g=p+l;return Array.from({length:n.length},(b,v)=>v).slice(p,g)},[i,l,n.length,r]);if(!r){const p=e>0?e/(n.length-1)*100:0,b=100/n.length/2;return a.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:a.jsxs("div",{className:"relative",children:[a.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${b}%`,right:`${b}%`},children:[a.jsx("div",{className:"w-full h-full bg-border rounded-full"}),a.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${p}%`}})]}),a.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((v,_)=>{const N=_<e,j=_===e,k=_<=s;return a.jsx("li",{className:"flex-1",children:a.jsxs("div",{className:"relative flex flex-col items-center group",children:[a.jsx("button",{type:"button",onClick:()=>k&&t(_),disabled:!k,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":j?"step":void 0,title:v.label,children:a.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${N?"bg-accent border-accent text-white":""} ${j?"bg-card border-accent text-accent scale-110":""} ${!N&&!j?"bg-card border-border text-muted":""} ${k?"group-hover:border-accent-dark":""}`,children:N?a.jsx(ol,{className:"w-5 h-5"}):Fe.createElement(v.icon,{className:"w-5 h-5"})})}),a.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${j?"text-accent font-bold":"text-muted"} ${k?"group-hover:text-primary-text":""}`,children:v.label})]})},v.key)})})]})})}return a.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[a.jsx("button",{type:"button",onClick:h,disabled:i===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:a.jsx(Ph,{className:"h-6 w-6"})}),a.jsx("div",{className:"flex-1 overflow-hidden",children:a.jsx("ol",{role:"list",className:"flex items-center justify-around",children:f.map(p=>{const g=n[p],b=p<e,v=p===e,_=p<=s;return a.jsx("li",{className:"flex-shrink-0",children:a.jsx("div",{className:"relative flex flex-col items-center group",children:a.jsx("button",{type:"button",onClick:()=>_&&t(p),disabled:!_,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":v?"step":void 0,title:g.label,children:a.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${b?"bg-green-600 border-green-600 text-white":""}
                      ${v?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!b&&!v?`bg-transparent ${_?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:b?a.jsx(ol,{className:"w-6 h-6 text-white"}):Fe.createElement(g.icon,{className:"w-6 h-6"})})})})},g.key)})})}),a.jsx("button",{type:"button",onClick:d,disabled:i>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:a.jsx(_l,{className:"h-6 w-6"})})]})},DA=[{key:"personal",label:"Personal",icon:yd},{key:"address",label:"Address",icon:io},{key:"organization",label:"Organization",icon:bl},{key:"family",label:"Family",icon:Ei},{key:"education",label:"Education",icon:$D},{key:"bank",label:"Bank",icon:da},{key:"uan",label:"UAN/PF",icon:ZY},{key:"esi",label:"ESI",icon:PZ},{key:"gmc",label:"GMC",icon:Gw},{key:"uniform",label:"Uniform",icon:Ag},{key:"documents",label:"Documents",icon:gZ},{key:"biometrics",label:"Biometrics",icon:FD},{key:"review",label:"Review",icon:hZ}],pr=DA.map(n=>n.key),TJ=()=>{const n=Vt(),e=Ns(),{data:t,reset:s,setData:r}=rn(),{user:i}=tt(),{salaryThreshold:o}=bo(),[l,c]=C.useState(!1),[d,h]=C.useState(!0),[f,p]=C.useState(null),[g]=JP(),[b,v]=C.useState(!1),[_,N]=C.useState("idle"),j=C.useRef(null),k=Nt("(max-width: 767px)"),S=C.useRef(null),P=e.pathname.split("/").pop(),E=C.useMemo(()=>pr.indexOf(P),[P]),[M,I]=C.useState(0);C.useEffect(()=>{const B=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||B){I(pr.length-1);return}const q=sessionStorage.getItem(`onboarding_progress_${t.id}`),Q=q?parseInt(q,10):0,le=Math.max(Q,E);I(le),E>Q&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(E))},[t,E]);const O=C.useMemo(()=>DA.map((B,q)=>({...B,status:q<E?"complete":q===E?"current":"upcoming"})),[E]);C.useEffect(()=>{const B=g.get("id");B?(async Q=>{h(!0);try{const le=await te.getOnboardingDataById(Q);le?(r(le),N("saved")):(p({message:"Could not find submission data.",type:"error"}),s())}catch(le){console.error("Failed to fetch submission data",le),p({message:"Failed to load submission data.",type:"error"}),s()}finally{h(!1)}})(B):h(!1)},[g,r,s]);const D=C.useCallback(async()=>{N("saving");try{const{draftId:B}=await te.saveDraft(t);B!==t.id&&r({...t,id:B}),N("saved")}catch{p({message:"Auto-save failed. Check your connection.",type:"error"}),N("dirty")}},[t,r]);C.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(_!=="saving"&&N("dirty"),j.current&&clearTimeout(j.current),j.current=window.setTimeout(()=>{D()},2e3)),()=>{j.current&&clearTimeout(j.current)}),[t,d,D,_]);const z=async()=>{j.current&&clearTimeout(j.current),await D();const B=S.current;if(S.current=null,B)n(`/onboarding/add/${B}`);else if(E<pr.length-1){let q=E+1;P==="esi"&&pr[q]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||q++),q<pr.length&&n(`/onboarding/add/${pr[q]}`)}},H=B=>{B<=M&&n(`/onboarding/add/${pr[B]}`)},F=()=>{if(E>0){let B=E-1;P==="uniform"&&pr[B]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||B--),B>=0?n(`/onboarding/add/${pr[B]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},R=async()=>{c(!0);const B={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await te.updateOnboarding(B),p({message:"Application updated successfully!",type:"success"})):(await te.submitOnboarding(B),p({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{s(),(i==null?void 0:i.role)==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{p({message:"Failed to submit application.",type:"error"}),c(!1)}},V=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),s(),v(!1),n("/onboarding/add/personal",{replace:!0}),p({message:"Form has been cleared.",type:"success"})},U=B=>{if(B.key!=="ArrowUp"&&B.key!=="ArrowDown"&&B.key!=="Enter")return;const q=B.target;if(B.key==="Enter"&&q.tagName!=="TEXTAREA"&&q.tagName!=="BUTTON"&&B.preventDefault(),B.key==="Enter"&&q.tagName==="BUTTON"||(B.key==="ArrowUp"||B.key==="ArrowDown")&&(q.tagName==="TEXTAREA"||q.type==="number"))return;const Q=B.currentTarget,le=Array.from(Q.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(se=>!se.hasAttribute("disabled")&&se.offsetParent!==null),X=le.indexOf(document.activeElement);if(X===-1)return;(B.key==="ArrowUp"||B.key==="ArrowDown")&&B.preventDefault();let Z=X;if(B.key==="ArrowUp"?Z=X-1:Z=X+1,Z>=0&&Z<le.length)le[Z].focus();else if(B.key==="Enter"&&Z>=le.length){const se=document.getElementById("save-and-next-button");se&&se.click()}};if(d)return a.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[a.jsx(Qe,{className:"h-8 w-8 animate-spin mr-4"}),a.jsx("p",{children:"Loading application data..."})]});const W=pr[E]==="review";return k?a.jsxs("div",{className:"h-full flex flex-col",children:[f&&a.jsx(gt,{message:f.message,type:f.type,onDismiss:()=>p(null)}),a.jsx(zk,{steps:O,currentStepIndex:E,onStepClick:H,highestStepReached:M,isMobileOptimized:!0}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:U,children:a.jsx("div",{className:"bg-card p-6 rounded-2xl",children:a.jsx(th,{context:{onValidated:z,onSubmit:R,isSubmitting:l,setToast:p}})})}),a.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[a.jsx(Y,{type:"button",onClick:F,variant:"secondary",children:"Back"}),a.jsx(Y,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:a.jsx(Yw,{className:"h-5 w-5"})}),a.jsx(Y,{id:"save-and-next-button",type:"submit",form:`${pr[E]}-form`,children:W?"Submit":"Next"})]})]}):a.jsx("div",{className:"p-4 md:p-0",children:a.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[f&&a.jsx(gt,{message:f.message,type:f.type,onDismiss:()=>p(null)}),a.jsx(yn,{isOpen:b,onClose:()=>v(!1),onConfirm:V,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),a.jsx(zk,{steps:O,currentStepIndex:E,onStepClick:H,highestStepReached:M,isMobileOptimized:k}),a.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:U,children:a.jsx(th,{context:{onValidated:z,onSubmit:R,isSubmitting:l,setToast:p}})}),a.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[a.jsx(Y,{onClick:F,disabled:E===0,variant:"secondary",children:"Back"}),a.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[_==="saving"&&a.jsxs(a.Fragment,{children:[a.jsx(Qe,{className:"h-4 w-4 animate-spin"}),a.jsx("span",{children:"Saving..."})]}),_==="saved"&&a.jsxs(a.Fragment,{children:[a.jsx(Kr,{className:"h-4 w-4 text-accent"}),a.jsx("span",{children:"Draft saved"})]}),_==="dirty"&&a.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!W&&a.jsx(Y,{id:"save-and-next-button",type:"submit",form:`${pr[E]}-form`,children:"Save & Next"})]})]})]})})},p_=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return a.jsx("span",{className:`status-chip ${t}`,children:n})},Yn=({className:n=""})=>a.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),EJ=({rows:n,cols:e})=>a.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,s)=>a.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((r,i)=>a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx(Yn,{className:"h-4 w-1/4"}),a.jsx(Yn,{className:"h-4 w-1/2"})]},i))},s))}),PJ=({rows:n,cols:e})=>a.jsx(a.Fragment,{children:Array.from({length:n}).map((t,s)=>a.jsx("tr",{children:Array.from({length:e}).map((r,i)=>a.jsx("td",{className:"px-6 py-4",children:a.jsxs("div",{className:"space-y-2",children:[a.jsx(Yn,{className:`h-4 ${i===0?"w-3/4":"w-full"}`}),i===0&&a.jsx(Yn,{className:"h-3 w-1/2"})]})},i))},s))}),Pi=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:s})=>t?a.jsx(EJ,{rows:n,cols:s||e}):a.jsx(PJ,{rows:n,cols:e}),MJ=({submission:n,isSyncing:e})=>{var o,l,c,d,h,f,p;if(n.status!=="verified"||!n.portalSyncStatus)return a.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return a.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[a.jsx(Qe,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=(o=n.uan)==null?void 0:o.hasPreviousPf,s=[{label:"Aadhaar",verified:(c=(l=n.personal)==null?void 0:l.verifiedStatus)==null?void 0:c.idProofNumber},{label:"Bank",verified:(h=(d=n.bank)==null?void 0:d.verifiedStatus)==null?void 0:h.accountNumber},...t?[{label:"UAN",verified:(p=(f=n.uan)==null?void 0:f.verifiedStatus)==null?void 0:p.uanNumber}]:[]],r=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",i=({label:g,status:b})=>{const v=r&&b===!0,_=r&&b===!1,N=v?e_:_?GD:YD,j=v?"text-green-600":_?"text-red-600":"text-muted",k=v?"Verified":_?"Failed":"Pending Verification";return a.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${j}`,title:k,children:[a.jsx(N,{className:"h-4 w-4"}),a.jsx("span",{children:g})]})};return a.jsx("div",{className:"flex flex-row gap-3 items-center",children:s.map(g=>a.jsx(i,{label:g.label,status:g.verified},g.label))})},DJ=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState("all"),[o,l]=C.useState(""),[c,d]=C.useState(null),[h,f]=C.useState(null),p=Vt(),g=Nt("(max-width: 767px)"),b=C.useCallback(async()=>{s(!0);try{const S=await te.getVerificationSubmissions(r==="all"?void 0:r);e(S)}catch(S){console.error("Failed to fetch submissions",S)}finally{s(!1)}},[r]);C.useEffect(()=>{b();const S=fe.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},P=>{console.log("Real-time change received!",P),b()}).subscribe();return()=>{fe.removeChannel(S)}},[b]);const v=C.useMemo(()=>n?n.filter(S=>{var P,E,M,I;return((P=S.personal.firstName)==null?void 0:P.toLowerCase().includes(o.toLowerCase()))||((E=S.personal.lastName)==null?void 0:E.toLowerCase().includes(o.toLowerCase()))||((M=S.personal.employeeId)==null?void 0:M.toLowerCase().includes(o.toLowerCase()))||((I=S.organizationName)==null?void 0:I.toLowerCase().includes(o.toLowerCase()))}):[],[n,o]),_=async(S,P)=>{e(E=>E.map(M=>M.id===P?{...M,status:S==="approve"?"verified":"rejected",portalSyncStatus:S==="approve"?"pending_sync":void 0}:M));try{S==="approve"?await te.verifySubmission(P):await te.requestChanges(P,"Changes requested by admin.")}catch(E){console.error(`Failed to ${S} submission`,E)}},N=async S=>{d(S);try{const P=await te.syncPortals(S);e(E=>E.map(M=>M.id===S?P:M)),P.portalSyncStatus==="synced"?f({message:"Portals synced successfully!",type:"success"}):f({message:"Portal sync failed. Check details.",type:"error"})}catch{f({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},j=["all","pending","verified","rejected"],k=r==="verified"?4:5;return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&a.jsx(gt,{message:h.message,type:h.type,onDismiss:()=>f(null)}),a.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[a.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:a.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:j.map(S=>a.jsx("button",{onClick:()=>i(S),className:`${r===S?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:S},S))})}),a.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(ua,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:S=>l(S.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),r!=="verified"&&a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?g?a.jsx("tr",{children:a.jsx("td",{colSpan:k,children:a.jsx(Pi,{rows:3,cols:4,isMobile:!0})})}):a.jsx(Pi,{rows:5,cols:k}):v.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:k,className:"text-center py-10 text-muted",children:"No submissions found."})}):v.map(S=>a.jsxs("tr",{className:S.requiresManualVerification?"bg-orange-50":"",children:[a.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:a.jsxs("div",{className:"flex items-center",children:[S.requiresManualVerification&&a.jsx("span",{title:"Manual verification required due to data mismatch.",children:a.jsx(Jr,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),a.jsxs("div",{children:[a.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[S.personal.firstName," ",S.personal.lastName]}),a.jsx("div",{className:"text-sm text-muted",children:S.personal.employeeId})]})]})}),a.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:S.organizationName}),r!=="verified"&&a.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:a.jsx(p_,{status:S.status})}),a.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:a.jsx(MJ,{submission:S,isSyncing:c===S.id})}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>p(`/onboarding/add/personal?id=${S.id}`),title:"View Details","aria-label":`View details for ${S.personal.firstName}`,children:a.jsx(ca,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>p(`/onboarding/pdf/${S.id}`),title:"Download Forms","aria-label":`Download forms for ${S.personal.firstName}`,children:a.jsx(Bs,{className:"h-4 w-4"})}),S.status==="pending"&&a.jsxs(a.Fragment,{children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>_("approve",S.id),title:"Verify","aria-label":`Verify submission for ${S.personal.firstName}`,children:a.jsx(e_,{className:"h-4 w-4 text-green-600"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>_("reject",S.id),title:"Request Changes","aria-label":`Request changes for ${S.personal.firstName}`,children:a.jsx(GD,{className:"h-4 w-4 text-red-600"})})]}),S.status==="verified"&&(S.portalSyncStatus==="pending_sync"||S.portalSyncStatus==="failed")&&a.jsxs(Y,{variant:"outline",size:"sm",onClick:()=>N(S.id),isLoading:c===S.id,title:"Push data to government portals",children:[c!==S.id&&a.jsx(Qw,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},S.id))})]})})]})},AJ=Ke({id:ie().optional(),name:ie().required("Name is required"),email:ie().email("Invalid email").required("Email is required"),role:ie().required("Role is required"),password:ie().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:ie().optional(),organizationId:ie().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ie().optional(),reportingManagerId:ie().optional(),photoUrl:ie().optional().nullable()}).defined(),IJ=Ke({id:ie().optional(),name:ie().required("Name is required"),email:ie().email("Invalid email").required("Email is required"),role:ie().required("Role is required"),phone:ie().optional(),organizationId:ie().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:ie().optional(),reportingManagerId:ie().optional(),photoUrl:ie().optional().nullable()}).defined(),OJ=({isOpen:n,onClose:e,onSave:t,initialData:s,isSaving:r})=>{var S,P,E,M,I;const i=s?IJ:AJ,{register:o,handleSubmit:l,formState:{errors:c},reset:d,watch:h,setValue:f}=xt({resolver:Lt(i)}),[p,g]=C.useState([]),[b,v]=C.useState([]),_=!!s,N=h("role");C.useEffect(()=>{n&&(Promise.all([te.getOrganizations(),te.getRoles()]).then(([O,D])=>{if(g(O),(s==null?void 0:s.role)==="unverified"&&!D.some(z=>z.id==="unverified")){const z=[{id:"unverified",displayName:"Unverified"},...D];v(z)}else v(D)}),d(s||{name:"",email:"",role:"field_officer"}))},[s,d,n]);const j=O=>{const D=O.target.value,z=p.find(H=>H.id===D);f("organizationId",D),f("organizationName",(z==null?void 0:z.shortName)||"")},k=O=>{t(O)};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:a.jsxs("form",{onSubmit:l(k),children:[a.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:[_?"Edit":"Add"," User"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(he,{label:"Full Name",id:"name",registration:o("name"),error:(S=c.name)==null?void 0:S.message}),a.jsx(he,{label:"Email",id:"email",type:"email",registration:o("email"),error:(P=c.email)==null?void 0:P.message}),a.jsx(Te,{label:"Role",id:"role",registration:o("role"),error:(E=c.role)==null?void 0:E.message,children:b.map(O=>a.jsx("option",{value:O.id,children:O.displayName},O.id))}),!_&&a.jsx(he,{label:"Password",id:"password",type:"password",registration:o("password"),error:(M=c.password)==null?void 0:M.message}),N==="site_manager"&&a.jsxs(Te,{label:"Assigned Site",id:"organizationId",...o("organizationId"),error:(I=c.organizationId)==null?void 0:I.message,onChange:j,children:[a.jsx("option",{value:"",children:"Select a Site"}),p.map(O=>a.jsx("option",{value:O.id,children:O.shortName},O.id))]})]}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",isLoading:r,children:_?"Save Changes":"Create User"})]})]})})}):null},ur=({title:n,children:e})=>a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&a.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),RJ=({isOpen:n,onClose:e,onApprove:t,user:s,isConfirming:r})=>{const[i,o]=C.useState([]),[l,c]=C.useState(""),[d,h]=C.useState(!0);C.useEffect(()=>{n&&(h(!0),te.getRoles().then(p=>{const g=p.filter(b=>b.id!=="unverified"&&b.id!=="admin");o(g),g.length>0&&c(g[0].id),h(!1)}))},[n]);const f=()=>{s&&l&&t(s.id,l)};return!n||!s?null:a.jsx(yn,{isOpen:n,onClose:e,onConfirm:f,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:r,children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("p",{children:["You are approving the account for ",a.jsx("strong",{className:"text-primary-text",children:s.name})," (",s.email,")."]}),a.jsx("p",{children:"Please assign a role to activate their account."}),d?a.jsx("p",{children:"Loading roles..."}):a.jsx(Te,{label:"Assign Role",id:"approval-role",value:l,onChange:p=>c(p.target.value),children:i.map(p=>a.jsx("option",{value:p.id,children:p.displayName},p.id))})]})})},LJ=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(!1),[o,l]=C.useState(!1),[c,d]=C.useState(!1),[h,f]=C.useState(!1),[p,g]=C.useState(null),[b,v]=C.useState(null),_=Nt("(max-width: 767px)"),N=C.useCallback(async()=>{s(!0);try{const D=await te.getUsers();e(D)}catch{v({message:"Failed to fetch users.",type:"error"})}finally{s(!1)}},[]);C.useEffect(()=>{N()},[N]);const j=()=>{g(null),l(!0)},k=D=>{g(D),l(!0)},S=D=>{g(D),f(!0)},P=D=>{g(D),d(!0)},E=async D=>{i(!0);try{if(p){const{password:z,...H}=D;await te.updateUser(p.id,H),v({message:"User updated successfully!",type:"success"})}else{const{name:z,email:H,password:F,role:R,...V}=D;if(!F)throw new Error("Password is required when creating a new user");const U=await te.createAuthUser({name:z,email:H,password:F,role:R});V&&Object.keys(V).length>0&&await te.updateUser(U.id,V),await te.createNotification({userId:U.id,message:`Welcome ${U.name}! Your account has been created.`,type:"greeting"}),v({message:"User created successfully!",type:"success"})}l(!1),N()}catch(z){v({message:z.message||"Failed to save user.",type:"error"})}finally{i(!1)}},M=async(D,z)=>{i(!0);try{await te.updateUser(D,{role:z}),v({message:"User approved successfully!",type:"success"}),f(!1),N()}catch{v({message:"Failed to approve user.",type:"error"})}finally{i(!1)}},I=async()=>{if(p){i(!0);try{await te.deleteUser(p.id),v({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),d(!1),N()}catch{v({message:"Failed to delete user.",type:"error"})}finally{i(!1)}}},O=D=>D?D.replace(/_/g," ").replace(/\b\w/g,z=>z.toUpperCase()):"N/A";return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[b&&a.jsx(gt,{message:b.message,type:b.type,onDismiss:()=>v(null)}),a.jsx(OJ,{isOpen:o,onClose:()=>l(!1),onSave:E,initialData:p,isSaving:r}),a.jsx(RJ,{isOpen:h,onClose:()=>f(!1),onApprove:M,user:p,isConfirming:r}),a.jsxs(yn,{isOpen:c,onClose:()=>d(!1),onConfirm:I,title:"Confirm Deletion",isConfirming:r,children:['Are you sure you want to delete the user "',p==null?void 0:p.name,'"? This action cannot be undone.']}),a.jsx(ur,{title:"User Management",children:a.jsxs(Y,{onClick:j,children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add User"]})}),a.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(km,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),a.jsxs("p",{className:"mt-1",children:["Use the ",a.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),a.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:t?_?a.jsx("tr",{children:a.jsx("td",{colSpan:4,children:a.jsx(Pi,{rows:3,cols:4,isMobile:!0})})}):a.jsx(Pi,{rows:5,cols:4}):n.map(D=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:D.name}),a.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:D.email}),a.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[a.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[a.jsx(Dh,{className:"h-4 w-4 mr-2 text-accent"}),O(D.role)]}),D.role==="unverified"&&a.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[D.role==="unverified"&&a.jsxs(Y,{variant:"outline",size:"sm",onClick:()=>S(D),"aria-label":`Approve user ${D.name}`,title:`Approve user ${D.name}`,children:[a.jsx(nd,{className:"h-4 w-4 mr-2"}),"Approve"]}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>k(D),"aria-label":`Edit user ${D.name}`,title:`Edit user ${D.name}`,children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>P(D),"aria-label":`Delete user ${D.name}`,title:`Delete user ${D.name}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-600"})})]})})]},D.id))})]})})]})},FJ=Ke({groupId:ie().required("Please select a group"),companyId:ie().required("Please select a company"),clientId:ie().required("Please select a client"),manpowerCount:ss().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),$J=({isOpen:n,onClose:e,onSave:t})=>{var O,D,z,H;const[s,r]=C.useState([]),[i,o]=C.useState(!0),[l,c]=C.useState(""),[d,h]=C.useState(!1),f=C.useRef(null),{register:p,handleSubmit:g,watch:b,formState:{errors:v},reset:_,setValue:N}=xt({resolver:Lt(FJ)}),j=b("groupId"),k=b("companyId");C.useEffect(()=>{n&&(o(!0),te.getOrganizationStructure().then(r).finally(()=>o(!1)),_(),c(""))},[n,_]),C.useEffect(()=>{N("companyId",""),N("clientId",""),c("")},[j,N]),C.useEffect(()=>{N("clientId",""),c("")},[k,N]),C.useEffect(()=>{const F=R=>{f.current&&!f.current.contains(R.target)&&h(!1)};return document.addEventListener("mousedown",F),()=>document.removeEventListener("mousedown",F)},[]);const S=C.useMemo(()=>{var F;return((F=s.find(R=>R.id===j))==null?void 0:F.companies)||[]},[s,j]),P=C.useMemo(()=>{var F;return((F=S.find(R=>R.id===k))==null?void 0:F.entities)||[]},[S,k]),E=C.useMemo(()=>l?P.filter(F=>F.name.toLowerCase().includes(l.toLowerCase())):P,[P,l]),M=F=>{const R=P.find(V=>V.id===F.clientId);R&&t(R,F.manpowerCount)},I=F=>{N("clientId",F.id,{shouldValidate:!0}),c(F.name),h(!1)};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:F=>F.stopPropagation(),children:a.jsxs("form",{onSubmit:g(M),children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:"Add Site from Existing Client"}),i?a.jsx("div",{className:"flex justify-center items-center h-48",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted"})}):a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Te,{label:"Group",id:"groupId",registration:p("groupId"),error:(O=v.groupId)==null?void 0:O.message,children:[a.jsx("option",{value:"",children:"Select a Group"}),s.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]}),a.jsxs(Te,{label:"Company",id:"companyId",registration:p("companyId"),error:(D=v.companyId)==null?void 0:D.message,disabled:!j,children:[a.jsx("option",{value:"",children:"Select a Company"}),S.map(F=>a.jsx("option",{value:F.id,children:F.name},F.id))]}),a.jsxs("div",{className:"relative",ref:f,children:[a.jsx(he,{label:"Client",id:"clientSearch",value:l,onChange:F=>{c(F.target.value),h(!0),N("clientId","")},onFocus:()=>h(!0),disabled:!k,error:(z=v.clientId)==null?void 0:z.message,autoComplete:"off"}),d&&E.length>0&&a.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:E.map(F=>a.jsx("li",{onClick:()=>I(F),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:F.name},F.id))})]}),a.jsx(he,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:p("manpowerCount"),error:(H=v.manpowerCount)==null?void 0:H.message})]}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",disabled:i,children:"Add Site"})]})]})})}):null},zJ=({isOpen:n,onClose:e,imageUrl:t})=>n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:a.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:s=>s.stopPropagation(),children:[a.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),a.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:a.jsx(Us,{className:"h-6 w-6"})})]})}):null,qe=({label:n,file:e,onFileChange:t,allowedTypes:s=["image/jpeg","image/png","application/pdf"],error:r,allowCapture:i=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:h,docType:f,onVerification:p})=>{const[g,b]=C.useState(!1),[v,_]=C.useState(""),[N,j]=C.useState(!1),[k,S]=C.useState(!1),{logVerificationUsage:P}=rn.getState(),E=C.useMemo(()=>{const R=n.toLowerCase();return R.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(V=>R.includes(V))?"document":"none"},[n]),M=C.useCallback(async R=>{if(!s.includes(R.type)){_(`Invalid file type. Allowed: ${s.join(", ")}.`);return}if(R.size>5*1024*1024){_("File size must be less than 5MB.");return}_(""),b(!0);const V=URL.createObjectURL(R);let U={name:R.name,type:R.type,size:R.size,preview:V,file:R};t(U),o&&P(o);try{const W=new FileReader;W.readAsDataURL(R),W.onloadend=async()=>{try{const B=W.result.split(",")[1];if(p){const q=await p(B,R.type);if(!q.success){_(q.reason),b(!1);return}}if(c&&d&&h)try{const q=await te.extractDataFromImage(B,R.type,d,f);c(q)}catch(q){console.error("OCR failed:",q),h({message:"AI extraction failed. Please check the document.",type:"error"})}}catch(B){_(B.message||"Processing failed.")}finally{b(!1)}},W.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(W){_(W.message||"Processing failed."),b(!1)}},[s,t,o,P,c,d,h,f,p]),I=C.useCallback(async(R,V)=>{const U=await(await fetch(`data:${V};base64,${R}`)).blob(),W=new File([U],`capture-${Date.now()}.jpg`,{type:V});M(W)},[M]),O=()=>{e&&URL.revokeObjectURL(e.preview),t(null),_("")},D=`file-upload-${n.replace(/\s+/g,"-")}`,z=r||v,F=(R=>{const V=R.toLowerCase();return V.includes("profile photo")?yd:V.includes("id proof")||V.includes("aadhaar")||V.includes("pan")||V.includes("voter")?RD:V.includes("bank proof")?da:V.includes("signature")?Fb:V.includes("fingerprint")?FD:V.includes("certificate")?$D:Bs})(n);return a.jsxs("div",{className:"w-full",children:[a.jsx(zJ,{isOpen:k,onClose:()=>S(!1),imageUrl:(e==null?void 0:e.preview)||""}),N&&a.jsx(r_,{isOpen:N,onClose:()=>j(!1),onCapture:I,captureGuidance:E}),a.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[a.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:D,children:n}),l===!0&&a.jsx("span",{title:"Verified",children:a.jsx(Kr,{className:"h-4 w-4 text-green-400"})}),l===!1&&a.jsx("span",{title:"Verification Failed",children:a.jsx(qw,{className:"h-4 w-4 text-red-400"})})]}),a.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?a.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[a.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[g?a.jsxs("div",{className:"flex flex-col items-center text-muted",children:[a.jsx(Qe,{className:"h-8 w-8 animate-spin"}),a.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?a.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):a.jsxs("div",{className:"text-muted p-2",children:[a.jsx(pZ,{className:"h-10 w-10 mx-auto"}),a.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),a.jsx("label",{htmlFor:D,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:a.jsx(zb,{className:"h-6 w-6 text-white"})})]}),a.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&a.jsxs("button",{type:"button",onClick:()=>S(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[a.jsx(ca,{className:"h-3 w-3"})," View"]}),a.jsxs("button",{type:"button",onClick:O,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[a.jsx(kt,{className:"h-3 w-3"})," Remove"]})]})]}):a.jsxs("label",{htmlFor:D,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${z?"!border-red-500":""}
                    `,children:[a.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:a.jsx(F,{className:"h-8 w-8"})}),a.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),a.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),i&&a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),a.jsxs(Y,{type:"button",onClick:R=>{R.preventDefault(),j(!0)},variant:"secondary",size:"sm",children:[a.jsx(Bw,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),a.jsx("input",{id:D,type:"file",className:"sr-only",onChange:R=>{var V;return((V=R.target.files)==null?void 0:V[0])&&M(R.target.files[0])},accept:s.join(",")}),a.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:z&&a.jsx("p",{className:"text-xs text-red-500",children:z})})]})};var Ih={},Oh={},AA={exports:{}},UJ="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",VJ=UJ,BJ=VJ;function IA(){}function OA(){}OA.resetWarningCache=IA;var qJ=function(){function n(s,r,i,o,l,c){if(c!==BJ){var d=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw d.name="Invariant Violation",d}}n.isRequired=n;function e(){return n}var t={array:n,bigint:n,bool:n,func:n,number:n,object:n,string:n,symbol:n,any:n,arrayOf:e,element:n,elementType:n,instanceOf:e,node:n,objectOf:e,oneOf:e,oneOfType:e,shape:e,exact:e,checkPropTypes:OA,resetWarningCache:IA};return t.PropTypes=t,t};AA.exports=qJ();var ga=AA.exports,Rh={},ha={},RA={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var i="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(i=r(i,s(l)))}return i}function s(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return t.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var l in i)e.call(i,l)&&i[l]&&(o=r(o,l));return o}function r(i,o){return o?i?i+" "+o:i+o:i}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(RA);var Al=RA.exports;const Il=g0(zB);Object.defineProperty(ha,"__esModule",{value:!0});ha.rangeShape=ha.default=void 0;var Ao=HJ(C),jt=LA(ga),Tx=LA(Al),ms=Il;function LA(n){return n&&n.__esModule?n:{default:n}}function FA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(FA=function(s){return s?t:e})(n)}function HJ(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=FA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function Kb(){return Kb=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Kb.apply(this,arguments)}function Yd(n,e,t){return e=WJ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function WJ(n){var e=GJ(n,"string");return typeof e=="symbol"?e:String(e)}function GJ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class g_ extends Ao.Component{constructor(e,t){super(e,t),Yd(this,"handleKeyEvent",s=>{const{day:r,onMouseDown:i,onMouseUp:o}=this.props;[13,32].includes(s.keyCode)&&(s.type==="keydown"?i(r):o(r))}),Yd(this,"handleMouseEvent",s=>{const{day:r,disabled:i,onPreviewChange:o,onMouseEnter:l,onMouseDown:c,onMouseUp:d}=this.props,h={};if(i){o();return}switch(s.type){case"mouseenter":l(r),o(r),h.hover=!0;break;case"blur":case"mouseleave":h.hover=!1;break;case"mousedown":h.active=!0,c(r);break;case"mouseup":s.stopPropagation(),h.active=!1,d(r);break;case"focus":o(r);break}Object.keys(h).length&&this.setState(h)}),Yd(this,"getClassNames",()=>{const{isPassive:s,isToday:r,isWeekend:i,isStartOfWeek:o,isEndOfWeek:l,isStartOfMonth:c,isEndOfMonth:d,disabled:h,styles:f}=this.props;return(0,Tx.default)(f.day,{[f.dayPassive]:s,[f.dayDisabled]:h,[f.dayToday]:r,[f.dayWeekend]:i,[f.dayStartOfWeek]:o,[f.dayEndOfWeek]:l,[f.dayStartOfMonth]:c,[f.dayEndOfMonth]:d,[f.dayHovered]:this.state.hover,[f.dayActive]:this.state.active})}),Yd(this,"renderPreviewPlaceholder",()=>{const{preview:s,day:r,styles:i}=this.props;if(!s)return null;const o=s.startDate?(0,ms.endOfDay)(s.startDate):null,l=s.endDate?(0,ms.startOfDay)(s.endDate):null,c=(!o||(0,ms.isAfter)(r,o))&&(!l||(0,ms.isBefore)(r,l)),d=!c&&(0,ms.isSameDay)(r,o),h=!c&&(0,ms.isSameDay)(r,l);return Ao.default.createElement("span",{className:(0,Tx.default)({[i.dayStartPreview]:d,[i.dayInPreview]:c,[i.dayEndPreview]:h}),style:{color:s.color}})}),Yd(this,"renderSelectionPlaceholders",()=>{const{styles:s,ranges:r,day:i}=this.props;return this.props.displayMode==="date"?(0,ms.isSameDay)(this.props.day,this.props.date)?Ao.default.createElement("span",{className:s.selected,style:{color:this.props.color}}):null:r.reduce((l,c)=>{let d=c.startDate,h=c.endDate;d&&h&&(0,ms.isBefore)(h,d)&&([d,h]=[h,d]),d=d?(0,ms.endOfDay)(d):null,h=h?(0,ms.startOfDay)(h):null;const f=(!d||(0,ms.isAfter)(i,d))&&(!h||(0,ms.isBefore)(i,h)),p=!f&&(0,ms.isSameDay)(i,d),g=!f&&(0,ms.isSameDay)(i,h);return f||p||g?[...l,{isStartEdge:p,isEndEdge:g,isInRange:f,...c}]:l},[]).map((l,c)=>Ao.default.createElement("span",{key:c,className:(0,Tx.default)({[s.startEdge]:l.isStartEdge,[s.endEdge]:l.isEndEdge,[s.inRange]:l.isInRange}),style:{color:l.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:e}=this.props;return Ao.default.createElement("button",Kb({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),Ao.default.createElement("span",{className:this.props.styles.dayNumber},(e==null?void 0:e(this.props.day))||Ao.default.createElement("span",null,(0,ms.format)(this.props.day,this.props.dayDisplayFormat))))}}g_.defaultProps={};const YJ=ha.rangeShape=jt.default.shape({startDate:jt.default.object,endDate:jt.default.object,color:jt.default.string,key:jt.default.string,autoFocus:jt.default.bool,disabled:jt.default.bool,showDateDisplay:jt.default.bool});g_.propTypes={day:jt.default.object.isRequired,dayDisplayFormat:jt.default.string,date:jt.default.object,ranges:jt.default.arrayOf(YJ),preview:jt.default.shape({startDate:jt.default.object,endDate:jt.default.object,color:jt.default.string}),onPreviewChange:jt.default.func,previewColor:jt.default.string,disabled:jt.default.bool,isPassive:jt.default.bool,isToday:jt.default.bool,isWeekend:jt.default.bool,isStartOfWeek:jt.default.bool,isEndOfWeek:jt.default.bool,isStartOfMonth:jt.default.bool,isEndOfMonth:jt.default.bool,color:jt.default.string,displayMode:jt.default.oneOf(["dateRange","date"]),styles:jt.default.object,onMouseDown:jt.default.func,onMouseUp:jt.default.func,onMouseEnter:jt.default.func,dayContentRenderer:jt.default.func};ha.default=g_;var Vg={},ya={};Object.defineProperty(ya,"__esModule",{value:!0});ya.calcFocusDate=JJ;ya.findNextRangeIndex=QJ;ya.generateStyles=eQ;ya.getMonthDisplayRange=XJ;var ZJ=KJ(Al),Wi=Il;function KJ(n){return n&&n.__esModule?n:{default:n}}function JJ(n,e){const{shownDate:t,date:s,months:r,ranges:i,focusedRange:o,displayMode:l}=e;let c;if(l==="dateRange"){const h=i[o[0]]||{};c={start:h.startDate,end:h.endDate}}else c={start:s,end:s};c.start=(0,Wi.startOfMonth)(c.start||new Date),c.end=(0,Wi.endOfMonth)(c.end||c.start);const d=c.start||c.end||t||new Date;return n?(0,Wi.differenceInCalendarMonths)(c.start,c.end)>r?n:d:t||d}function QJ(n){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const t=n.findIndex((s,r)=>r>e&&s.autoFocus!==!1&&!s.disabled);return t!==-1?t:n.findIndex(s=>s.autoFocus!==!1&&!s.disabled)}function XJ(n,e,t){const s=(0,Wi.startOfMonth)(n,e),r=(0,Wi.endOfMonth)(n,e),i=(0,Wi.startOfWeek)(s,e);let o=(0,Wi.endOfWeek)(r,e);return t&&(0,Wi.differenceInCalendarDays)(o,i)<=34&&(o=(0,Wi.addDays)(o,7)),{start:i,end:o,startDateOfMonth:s,endDateOfMonth:r}}function eQ(n){return n.length?n.filter(t=>!!t).reduce((t,s)=>(Object.keys(s).forEach(r=>{t[r]=(0,ZJ.default)(t[r],s[r])}),t),{}):{}}Object.defineProperty(Vg,"__esModule",{value:!0});Vg.default=void 0;var Jo=UA(C),Ft=nQ(ga),$A=UA(ha),kn=Il,tQ=ya;function nQ(n){return n&&n.__esModule?n:{default:n}}function zA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(zA=function(s){return s?t:e})(n)}function UA(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=zA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function Jb(){return Jb=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Jb.apply(this,arguments)}function sQ(n,e,t){const s=new Date;return Jo.default.createElement("div",{className:n.weekDays},(0,kn.eachDayOfInterval)({start:(0,kn.startOfWeek)(s,e),end:(0,kn.endOfWeek)(s,e)}).map((r,i)=>Jo.default.createElement("span",{className:n.weekDay,key:i},(0,kn.format)(r,t,e))))}class y_ extends Jo.PureComponent{render(){const e=new Date,{displayMode:t,focusedRange:s,drag:r,styles:i,disabledDates:o,disabledDay:l}=this.props,c=this.props.minDate&&(0,kn.startOfDay)(this.props.minDate),d=this.props.maxDate&&(0,kn.endOfDay)(this.props.maxDate),h=(0,tQ.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let f=this.props.ranges;if(t==="dateRange"&&r.status){let{startDate:g,endDate:b}=r.range;f=f.map((v,_)=>_!==s[0]?v:{...v,startDate:g,endDate:b})}const p=this.props.showPreview&&!r.disablePreview;return Jo.default.createElement("div",{className:i.month,style:this.props.style},this.props.showMonthName?Jo.default.createElement("div",{className:i.monthName},(0,kn.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&sQ(i,this.props.dateOptions,this.props.weekdayDisplayFormat),Jo.default.createElement("div",{className:i.days,onMouseLeave:this.props.onMouseLeave},(0,kn.eachDayOfInterval)({start:h.start,end:h.end}).map((g,b)=>{const v=(0,kn.isSameDay)(g,h.startDateOfMonth),_=(0,kn.isSameDay)(g,h.endDateOfMonth),N=c&&(0,kn.isBefore)(g,c)||d&&(0,kn.isAfter)(g,d),j=o.some(S=>(0,kn.isSameDay)(S,g)),k=l(g);return Jo.default.createElement($A.default,Jb({},this.props,{ranges:f,day:g,preview:p?this.props.preview:null,isWeekend:(0,kn.isWeekend)(g,this.props.dateOptions),isToday:(0,kn.isSameDay)(g,e),isStartOfWeek:(0,kn.isSameDay)(g,(0,kn.startOfWeek)(g,this.props.dateOptions)),isEndOfWeek:(0,kn.isSameDay)(g,(0,kn.endOfWeek)(g,this.props.dateOptions)),isStartOfMonth:v,isEndOfMonth:_,key:b,disabled:N||j||k,isPassive:!(0,kn.isWithinInterval)(g,{start:h.startDateOfMonth,end:h.endDateOfMonth}),styles:i,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:r.range,drag:r.status}))})))}}y_.defaultProps={};y_.propTypes={style:Ft.default.object,styles:Ft.default.object,month:Ft.default.object,drag:Ft.default.object,dateOptions:Ft.default.object,disabledDates:Ft.default.array,disabledDay:Ft.default.func,preview:Ft.default.shape({startDate:Ft.default.object,endDate:Ft.default.object}),showPreview:Ft.default.bool,displayMode:Ft.default.oneOf(["dateRange","date"]),minDate:Ft.default.object,maxDate:Ft.default.object,ranges:Ft.default.arrayOf($A.rangeShape),focusedRange:Ft.default.arrayOf(Ft.default.number),onDragSelectionStart:Ft.default.func,onDragSelectionEnd:Ft.default.func,onDragSelectionMove:Ft.default.func,onMouseLeave:Ft.default.func,monthDisplayFormat:Ft.default.string,weekdayDisplayFormat:Ft.default.string,dayDisplayFormat:Ft.default.string,showWeekDays:Ft.default.bool,showMonthName:Ft.default.bool,fixedHeight:Ft.default.bool};Vg.default=y_;var Bg={};Object.defineProperty(Bg,"__esModule",{value:!0});Bg.default=void 0;var zf=iQ(C),oi=VA(ga),rQ=VA(Al),Zd=Il;function VA(n){return n&&n.__esModule?n:{default:n}}function BA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(BA=function(s){return s?t:e})(n)}function iQ(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=BA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function Ex(n,e,t){return e=aQ(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aQ(n){var e=oQ(n,"string");return typeof e=="symbol"?e:String(e)}function oQ(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class x_ extends zf.PureComponent{constructor(e,t){super(e,t),Ex(this,"onKeyDown",s=>{const{value:r}=this.state;s.key==="Enter"&&this.update(r)}),Ex(this,"onChange",s=>{this.setState({value:s.target.value,changed:!0,invalid:!1})}),Ex(this,"onBlur",()=>{const{value:s}=this.state;this.update(s)}),this.state={invalid:!1,changed:!1,value:this.formatDate(e)}}componentDidUpdate(e){const{value:t}=e;(0,Zd.isEqual)(t,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(e){let{value:t,dateDisplayFormat:s,dateOptions:r}=e;return t&&(0,Zd.isValid)(t)?(0,Zd.format)(t,s,r):""}update(e){const{invalid:t,changed:s}=this.state;if(t||!s||!e)return;const{onChange:r,dateDisplayFormat:i,dateOptions:o}=this.props,l=(0,Zd.parse)(e,i,new Date,o);(0,Zd.isValid)(l)?this.setState({changed:!1},()=>r(l)):this.setState({invalid:!0})}render(){const{className:e,readOnly:t,placeholder:s,ariaLabel:r,disabled:i,onFocus:o}=this.props,{value:l,invalid:c}=this.state;return zf.default.createElement("span",{className:(0,rQ.default)("rdrDateInput",e)},zf.default.createElement("input",{readOnly:t,disabled:i,value:l,placeholder:s,"aria-label":r,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:o}),c&&zf.default.createElement("span",{className:"rdrWarning"},""))}}x_.propTypes={value:oi.default.object,placeholder:oi.default.string,disabled:oi.default.bool,readOnly:oi.default.bool,dateOptions:oi.default.object,dateDisplayFormat:oi.default.string,ariaLabel:oi.default.string,className:oi.default.string,onFocus:oi.default.func.isRequired,onChange:oi.default.func.isRequired};x_.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"};Bg.default=x_;var qA={};(function(n){(function(e,t){t(n,C,a)})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:NT,function(e,t,s){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function r(X){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(Z){return typeof Z}:function(Z){return Z&&typeof Symbol=="function"&&Z.constructor===Symbol&&Z!==Symbol.prototype?"symbol":typeof Z},r(X)}function i(X,Z){if(!(X instanceof Z))throw new TypeError("Cannot call a class as a function")}function o(X,Z){for(var se=0;se<Z.length;se++){var G=Z[se];G.enumerable=G.enumerable||!1,G.configurable=!0,"value"in G&&(G.writable=!0),Object.defineProperty(X,j(G.key),G)}}function l(X,Z,se){return Z&&o(X.prototype,Z),se&&o(X,se),Object.defineProperty(X,"prototype",{writable:!1}),X}function c(X,Z,se){return Z=p(Z),d(X,f()?Reflect.construct(Z,se||[],p(X).constructor):Z.apply(X,se))}function d(X,Z){if(Z&&(r(Z)=="object"||typeof Z=="function"))return Z;if(Z!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(X)}function h(X){if(X===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return X}function f(){try{var X=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f=function(){return!!X})()}function p(X){return p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(Z){return Z.__proto__||Object.getPrototypeOf(Z)},p(X)}function g(X,Z){if(typeof Z!="function"&&Z!==null)throw new TypeError("Super expression must either be null or a function");X.prototype=Object.create(Z&&Z.prototype,{constructor:{value:X,writable:!0,configurable:!0}}),Object.defineProperty(X,"prototype",{writable:!1}),Z&&b(X,Z)}function b(X,Z){return b=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(se,G){return se.__proto__=G,se},b(X,Z)}function v(X,Z){var se=Object.keys(X);if(Object.getOwnPropertySymbols){var G=Object.getOwnPropertySymbols(X);Z&&(G=G.filter(function(ne){return Object.getOwnPropertyDescriptor(X,ne).enumerable})),se.push.apply(se,G)}return se}function _(X){for(var Z=1;Z<arguments.length;Z++){var se=arguments[Z]!=null?arguments[Z]:{};Z%2?v(Object(se),!0).forEach(function(G){N(X,G,se[G])}):Object.getOwnPropertyDescriptors?Object.defineProperties(X,Object.getOwnPropertyDescriptors(se)):v(Object(se)).forEach(function(G){Object.defineProperty(X,G,Object.getOwnPropertyDescriptor(se,G))})}return X}function N(X,Z,se){return(Z=j(Z))in X?Object.defineProperty(X,Z,{value:se,enumerable:!0,configurable:!0,writable:!0}):X[Z]=se,X}function j(X){var Z=k(X,"string");return r(Z)=="symbol"?Z:Z+""}function k(X,Z){if(r(X)!="object"||!X)return X;var se=X[Symbol.toPrimitive];if(se!==void 0){var G=se.call(X,Z);if(r(G)!="object")return G;throw new TypeError("@@toPrimitive must return a primitive value.")}return(Z==="string"?String:Number)(X)}var S={x:"clientWidth",y:"clientHeight"},P={x:"clientTop",y:"clientLeft"},E={x:"innerWidth",y:"innerHeight"},M={x:"offsetWidth",y:"offsetHeight"},I={x:"offsetLeft",y:"offsetTop"},O={x:"overflowX",y:"overflowY"},D={x:"scrollWidth",y:"scrollHeight"},z={x:"scrollLeft",y:"scrollTop"},H={x:"width",y:"height"},F=function(){},R=function(){if(typeof window>"u")return!1;var X=!1;try{document.createElement("div").addEventListener("test",F,{get passive(){return X=!0,!1}})}catch{}return X}()?{passive:!0}:!1,V="ReactList failed to reach a stable state.",U=40,W=function(Z,se){for(var G in se)if(Z[G]!==se[G])return!1;return!0},B=function(Z){for(var se=Z.props.axis,G=Z.getEl(),ne=O[se];G=G.parentElement;)switch(window.getComputedStyle(G)[ne]){case"auto":case"scroll":case"overlay":return G}return window},q=function(Z){var se=Z.props.axis,G=Z.scrollParent;return G===window?window[E[se]]:G[S[se]]},Q=function(Z,se){var G=Z.length,ne=Z.minSize,ge=Z.type,ye=se.from,re=se.size,ae=se.itemsPerRow;re=Math.max(re,ne);var ve=re%ae;return ve&&(re+=ae-ve),re>G&&(re=G),ye=ge==="simple"||!ye?0:Math.max(Math.min(ye,G-re),0),(ve=ye%ae)&&(ye-=ve,re+=ve),ye===se.from&&re===se.size?se:_(_({},se),{},{from:ye,size:re})},le=e.default=function(X){function Z(se){var G;return i(this,Z),G=c(this,Z,[se]),G.state=Q(se,{itemsPerRow:1,from:se.initialIndex,size:0}),G.cache={},G.cachedScrollPosition=null,G.prevPrevState={},G.unstable=!1,G.updateCounter=0,G}return g(Z,X),l(Z,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(G){var ne=this;if(this.props.axis!==G.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>U)return this.unstable=!0,console.error(V);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){ne.updateCounter=0,delete ne.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(G,ne){if(W(this.state,G))return ne();this.setState(G,ne)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,R),this.scrollParent.removeEventListener("mousewheel",F,R)}},{key:"getOffset",value:function(G){var ne=this.props.axis,ge=G[P[ne]]||0,ye=I[ne];do ge+=G[ye]||0;while(G=G.offsetParent);return ge}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var G=this.scrollParent,ne=this.props.axis,ge=z[ne],ye=G===window?document.body[ge]||document.documentElement[ge]:G[ge],re=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),ae=Math.max(0,Math.min(ye,re)),ve=this.getEl();return this.cachedScrollPosition=this.getOffset(G)+ae-this.getOffset(ve),this.cachedScrollPosition}},{key:"setScroll",value:function(G){var ne=this.scrollParent,ge=this.props.axis;if(G+=this.getOffset(this.getEl()),ne===window)return window.scrollTo(0,G);G-=this.getOffset(this.scrollParent),ne[z[ge]]=G}},{key:"getScrollSize",value:function(){var G=this.scrollParent,ne=document,ge=ne.body,ye=ne.documentElement,re=D[this.props.axis];return G===window?Math.max(ge[re],ye[re]):G[re]}},{key:"hasDeterminateSize",value:function(){var G=this.props,ne=G.itemSizeGetter,ge=G.type;return ge==="uniform"||ne}},{key:"getStartAndEnd",value:function(){var G=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,ne=this.getScrollPosition(),ge=Math.max(0,ne-G),ye=ne+this.props.scrollParentViewportSizeGetter(this)+G;return this.hasDeterminateSize()&&(ye=Math.min(ye,this.getSpaceBefore(this.props.length))),{start:ge,end:ye}}},{key:"getItemSizeAndItemsPerRow",value:function(){var G=this.props,ne=G.axis,ge=G.useStaticSize,ye=this.state,re=ye.itemSize,ae=ye.itemsPerRow;if(ge&&re&&ae)return{itemSize:re,itemsPerRow:ae};var ve=this.items.children;if(!ve.length)return{};var pe=ve[0],Ne=pe[M[ne]],Me=Math.abs(Ne-re);if((isNaN(Me)||Me>=1)&&(re=Ne),!re)return{};var Oe=I[ne],Je=pe[Oe];ae=1;for(var dt=ve[ae];dt&&dt[Oe]===Je;dt=ve[ae])++ae;return{itemSize:re,itemsPerRow:ae}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(G){return this.clearSizeCache(),this.updateFrame(G)}},{key:"updateFrame",value:function(G){switch(this.updateScrollParent(),typeof G!="function"&&(G=F),this.props.type){case"simple":return this.updateSimpleFrame(G);case"variable":return this.updateVariableFrame(G);case"uniform":return this.updateUniformFrame(G)}}},{key:"updateScrollParent",value:function(){var G=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),G!==this.scrollParent&&(G&&(G.removeEventListener("scroll",this.updateFrameAndClearCache),G.removeEventListener("mousewheel",F)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,R),this.scrollParent.addEventListener("mousewheel",F,R))}},{key:"updateSimpleFrame",value:function(G){var ne=this.getStartAndEnd(),ge=ne.end,ye=this.items.children,re=0;if(ye.length){var ae=this.props.axis,ve=ye[0],pe=ye[ye.length-1];re=this.getOffset(pe)+pe[M[ae]]-this.getOffset(ve)}if(re>ge)return G();var Ne=this.props,Me=Ne.pageSize,Oe=Ne.length,Je=Math.min(this.state.size+Me,Oe);this.maybeSetState({size:Je},G)}},{key:"updateVariableFrame",value:function(G){this.props.itemSizeGetter||this.cacheSizes();for(var ne=this.getStartAndEnd(),ge=ne.start,ye=ne.end,re=this.props,ae=re.length,ve=re.pageSize,pe=0,Ne=0,Me=0,Oe=ae-1;Ne<Oe;){var Je=this.getSizeOfItem(Ne);if(Je==null||pe+Je>ge)break;pe+=Je,++Ne}for(var dt=ae-Ne;Me<dt&&pe<ye;){var at=this.getSizeOfItem(Ne+Me);if(at==null){Me=Math.min(Me+ve,dt);break}pe+=at,++Me}this.maybeSetState(Q(this.props,{from:Ne,itemsPerRow:1,size:Me}),G)}},{key:"updateUniformFrame",value:function(G){var ne=this.getItemSizeAndItemsPerRow(),ge=ne.itemSize,ye=ne.itemsPerRow;if(!ge||!ye)return G();var re=this.getStartAndEnd(),ae=re.start,ve=re.end,pe=Q(this.props,{from:Math.floor(ae/ge)*ye,size:(Math.ceil((ve-ae)/ge)+1)*ye,itemsPerRow:ye}),Ne=pe.from,Me=pe.size;return this.maybeSetState({itemsPerRow:ye,from:Ne,itemSize:ge,size:Me},G)}},{key:"getSpaceBefore",value:function(G){var ne=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(ne[G]!=null)return ne[G];var ge=this.state,ye=ge.itemSize,re=ge.itemsPerRow;if(ye)return ne[G]=Math.floor(G/re)*ye;for(var ae=G;ae>0&&ne[--ae]==null;);for(var ve=ne[ae]||0,pe=ae;pe<G;++pe){ne[pe]=ve;var Ne=this.getSizeOfItem(pe);if(Ne==null)break;ve+=Ne}return ne[G]=ve}},{key:"cacheSizes",value:function(){for(var G=this.cache,ne=this.state.from,ge=this.items.children,ye=M[this.props.axis],re=0,ae=ge.length;re<ae;++re)G[ne+re]=ge[re][ye]}},{key:"getSizeOfItem",value:function(G){var ne=this.cache,ge=this.items,ye=this.props,re=ye.axis,ae=ye.itemSizeGetter,ve=ye.itemSizeEstimator,pe=ye.type,Ne=this.state,Me=Ne.from,Oe=Ne.itemSize,Je=Ne.size;if(Oe)return Oe;if(ae)return ae(G);if(G in ne)return ne[G];if(pe==="simple"&&G>=Me&&G<Me+Je&&ge){var dt=ge.children[G-Me];if(dt)return dt[M[re]]}if(ve)return ve(G,ne)}},{key:"scrollTo",value:function(G){G!=null&&this.setScroll(this.getSpaceBefore(G))}},{key:"scrollAround",value:function(G){var ne=this.getScrollPosition(),ge=this.getSpaceBefore(G),ye=ge-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(G),re=Math.min(ye,ge),ae=Math.max(ye,ge);if(ne<=re)return this.setScroll(re);if(ne>ae)return this.setScroll(ae)}},{key:"getVisibleRange",value:function(){for(var G=this.state,ne=G.from,ge=G.size,ye=this.getStartAndEnd(0),re=ye.start,ae=ye.end,ve={},pe,Ne,Me=ne;Me<ne+ge;++Me){var Oe=this.getSpaceBefore(Me,ve),Je=Oe+this.getSizeOfItem(Me);pe==null&&Je>re&&(pe=Me),pe!=null&&Oe<ae&&(Ne=Me)}return[pe,Ne]}},{key:"renderItems",value:function(){for(var G=this,ne=this.props,ge=ne.itemRenderer,ye=ne.itemsRenderer,re=this.state,ae=re.from,ve=re.size,pe=[],Ne=0;Ne<ve;++Ne)pe.push(ge(ae+Ne,Ne));return ye(pe,function(Me){return G.items=Me})}},{key:"render",value:function(){var G=this,ne=this.props,ge=ne.axis,ye=ne.length,re=ne.type,ae=ne.useTranslate3d,ve=this.state,pe=ve.from,Ne=ve.itemsPerRow,Me=this.renderItems();if(re==="simple")return Me;var Oe={position:"relative"},Je={},dt=Math.ceil(ye/Ne)*Ne,at=this.getSpaceBefore(dt,Je);at&&(Oe[H[ge]]=at,ge==="x"&&(Oe.overflowX="hidden"));var _t=this.getSpaceBefore(pe,Je),J=ge==="x"?_t:0,K=ge==="y"?_t:0,oe=ae?"translate3d(".concat(J,"px, ").concat(K,"px, 0)"):"translate(".concat(J,"px, ").concat(K,"px)"),we={msTransform:oe,WebkitTransform:oe,transform:oe};return(0,s.jsx)("div",{style:Oe,ref:function(_e){return G.el=_e},children:(0,s.jsx)("div",{style:we,children:Me})})}}],[{key:"getDerivedStateFromProps",value:function(G,ne){var ge=Q(G,ne);return ge===ne?null:ge}}])}(t.Component);N(le,"displayName","ReactList"),N(le,"defaultProps",{axis:"y",itemRenderer:function(Z,se){return(0,s.jsx)("div",{children:Z},se)},itemsRenderer:function(Z,se){return(0,s.jsx)("div",{ref:se,children:Z})},length:0,minSize:1,pageSize:10,scrollParentGetter:B,scrollParentViewportSizeGetter:q,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(qA);function lQ(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),s=Object.keys(e),r=t.length;if(s.length!==r)return!1;for(var i=0;i<r;i++){var o=t[i];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function cQ(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var s=0;s<t;s++)if(n[s]!==e[s])return!1;return!0}const dQ=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:cQ,shallowEqualObjects:lQ},Symbol.toStringTag,{value:"Module"})),uQ=g0(dQ);var v_={},b_={};b_.formatDistance=void 0;const hQ={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},fQ=(n,e,t)=>{let s;const r=hQ[n];return typeof r=="string"?s=r:e===1?s=r.one:s=r.other.replace("{{count}}",e.toString()),t!=null&&t.addSuffix?t.comparison&&t.comparison>0?"in "+s:s+" ago":s};b_.formatDistance=fQ;var w_={},HA={};HA.buildFormatLongFn=mQ;function mQ(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}w_.formatLong=void 0;var Px=HA;const pQ={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},gQ={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},yQ={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};w_.formatLong={date:(0,Px.buildFormatLongFn)({formats:pQ,defaultWidth:"full"}),time:(0,Px.buildFormatLongFn)({formats:gQ,defaultWidth:"full"}),dateTime:(0,Px.buildFormatLongFn)({formats:yQ,defaultWidth:"full"})};var __={};__.formatRelative=void 0;const xQ={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},vQ=(n,e,t,s)=>xQ[n];__.formatRelative=vQ;var S_={},WA={};WA.buildLocalizeFn=bQ;function bQ(n){return(e,t)=>{const s=t!=null&&t.context?String(t.context):"standalone";let r;if(s==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t!=null&&t.width?String(t.width):o;r=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t!=null&&t.width?String(t.width):n.defaultWidth;r=n.values[l]||n.values[o]}const i=n.argumentCallback?n.argumentCallback(e):e;return r[i]}}S_.localize=void 0;var Kd=WA;const wQ={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},_Q={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},SQ={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},NQ={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},jQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},CQ={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},kQ=(n,e)=>{const t=Number(n),s=t%100;if(s>20||s<10)switch(s%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"};S_.localize={ordinalNumber:kQ,era:(0,Kd.buildLocalizeFn)({values:wQ,defaultWidth:"wide"}),quarter:(0,Kd.buildLocalizeFn)({values:_Q,defaultWidth:"wide",argumentCallback:n=>n-1}),month:(0,Kd.buildLocalizeFn)({values:SQ,defaultWidth:"wide"}),day:(0,Kd.buildLocalizeFn)({values:NQ,defaultWidth:"wide"}),dayPeriod:(0,Kd.buildLocalizeFn)({values:jQ,defaultWidth:"wide",formattingValues:CQ,defaultFormattingWidth:"wide"})};var N_={},GA={};GA.buildMatchFn=TQ;function TQ(n){return(e,t={})=>{const s=t.width,r=s&&n.matchPatterns[s]||n.matchPatterns[n.defaultMatchWidth],i=e.match(r);if(!i)return null;const o=i[0],l=s&&n.parsePatterns[s]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?PQ(l,f=>f.test(o)):EQ(l,f=>f.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function EQ(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function PQ(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}var YA={};YA.buildMatchPatternFn=MQ;function MQ(n){return(e,t={})=>{const s=e.match(n.matchPattern);if(!s)return null;const r=s[0],i=e.match(n.parsePattern);if(!i)return null;let o=n.valueCallback?n.valueCallback(i[0]):i[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(r.length);return{value:o,rest:l}}}N_.match=void 0;var Jd=GA,DQ=YA;const AQ=/^(\d+)(th|st|nd|rd)?/i,IQ=/\d+/i,OQ={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},RQ={any:[/^b/i,/^(a|c)/i]},LQ={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},FQ={any:[/1/i,/2/i,/3/i,/4/i]},$Q={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},zQ={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},UQ={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},VQ={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},BQ={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},qQ={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};N_.match={ordinalNumber:(0,DQ.buildMatchPatternFn)({matchPattern:AQ,parsePattern:IQ,valueCallback:n=>parseInt(n,10)}),era:(0,Jd.buildMatchFn)({matchPatterns:OQ,defaultMatchWidth:"wide",parsePatterns:RQ,defaultParseWidth:"any"}),quarter:(0,Jd.buildMatchFn)({matchPatterns:LQ,defaultMatchWidth:"wide",parsePatterns:FQ,defaultParseWidth:"any",valueCallback:n=>n+1}),month:(0,Jd.buildMatchFn)({matchPatterns:$Q,defaultMatchWidth:"wide",parsePatterns:zQ,defaultParseWidth:"any"}),day:(0,Jd.buildMatchFn)({matchPatterns:UQ,defaultMatchWidth:"wide",parsePatterns:VQ,defaultParseWidth:"any"}),dayPeriod:(0,Jd.buildMatchFn)({matchPatterns:BQ,defaultMatchWidth:"any",parsePatterns:qQ,defaultParseWidth:"any"})};v_.enUS=void 0;var HQ=b_,WQ=w_,GQ=__,YQ=S_,ZQ=N_;v_.enUS={code:"en-US",formatDistance:HQ.formatDistance,formatLong:WQ.formatLong,formatRelative:GQ.formatRelative,localize:YQ.localize,match:ZQ.match,options:{weekStartsOn:0,firstWeekContainsDate:1}};var Ol={};Object.defineProperty(Ol,"__esModule",{value:!0});Ol.default=void 0;Ol.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"};var qg={};Object.defineProperty(qg,"__esModule",{value:!0});qg.ariaLabelsShape=void 0;var Fi=KQ(ga);function KQ(n){return n&&n.__esModule?n:{default:n}}qg.ariaLabelsShape=Fi.default.shape({dateInput:Fi.default.objectOf(Fi.default.shape({startDate:Fi.default.string,endDate:Fi.default.string})),monthPicker:Fi.default.string,yearPicker:Fi.default.string,prevButton:Fi.default.string,nextButton:Fi.default.string});Object.defineProperty(Rh,"__esModule",{value:!0});Rh.default=void 0;var Rt=sX(C),Ze=xd(ga),JQ=ha,Uk=xd(Vg),Vk=xd(Bg),Uf=ya,Io=xd(Al),QQ=xd(qA),XQ=uQ,Jt=Il,eX=v_,tX=xd(Ol),nX=qg;function xd(n){return n&&n.__esModule?n:{default:n}}function ZA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(ZA=function(s){return s?t:e})(n)}function sX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=ZA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function $p(){return $p=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},$p.apply(this,arguments)}function gr(n,e,t){return e=rX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function rX(n){var e=iX(n,"string");return typeof e=="symbol"?e:String(e)}function iX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class rd extends Rt.PureComponent{constructor(e,t){var s;super(e,t),s=this,gr(this,"focusToDate",function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:s.props,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!i.scroll.enabled){if(o&&i.preventSnapRefocus){const d=(0,Jt.differenceInCalendarMonths)(r,s.state.focusedDate),h=i.calendarFocus==="forwards"&&d>=0,f=i.calendarFocus==="backwards"&&d<=0;if((h||f)&&Math.abs(d)<i.months)return}s.setState({focusedDate:r});return}const l=(0,Jt.differenceInCalendarMonths)(r,i.minDate,s.dateOptions),c=s.list.getVisibleRange();o&&c.includes(l)||(s.isFirstRender=!0,s.list.scrollTo(l),s.setState({focusedDate:r}))}),gr(this,"updateShownDate",function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:s.props;const i=r.scroll.enabled?{...r,months:s.list.getVisibleRange().length}:r,o=(0,Uf.calcFocusDate)(s.state.focusedDate,i);s.focusToDate(o,i)}),gr(this,"updatePreview",r=>{if(!r){this.setState({preview:null});return}const i={startDate:r,endDate:r,color:this.props.color};this.setState({preview:i})}),gr(this,"changeShownDate",function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:o}=s.state,{onShownDateChange:l,minDate:c,maxDate:d}=s.props,h={monthOffset:()=>(0,Jt.addMonths)(o,r),setMonth:()=>(0,Jt.setMonth)(o,r),setYear:()=>(0,Jt.setYear)(o,r),set:()=>r},f=(0,Jt.min)([(0,Jt.max)([h[i](),c]),d]);s.focusToDate(f,s.props,!1),l&&l(f)}),gr(this,"handleRangeFocusChange",(r,i)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([r,i])}),gr(this,"handleScroll",()=>{const{onShownDateChange:r,minDate:i}=this.props,{focusedDate:o}=this.state,{isFirstRender:l}=this,c=this.list.getVisibleRange();if(c[0]===void 0)return;const d=(0,Jt.addMonths)(i,c[0]||0);!(0,Jt.isSameMonth)(d,o)&&!l&&(this.setState({focusedDate:d}),r&&r(d)),this.isFirstRender=!1}),gr(this,"renderMonthAndYear",(r,i,o)=>{const{showMonthArrow:l,minDate:c,maxDate:d,showMonthAndYearPickers:h,ariaLabels:f}=o,p=(d||rd.defaultProps.maxDate).getFullYear(),g=(c||rd.defaultProps.minDate).getFullYear(),b=this.styles;return Rt.default.createElement("div",{onMouseUp:v=>v.stopPropagation(),className:b.monthAndYearWrapper},l?Rt.default.createElement("button",{type:"button",className:(0,Io.default)(b.nextPrevButton,b.prevButton),onClick:()=>i(-1,"monthOffset"),"aria-label":f.prevButton},Rt.default.createElement("i",null)):null,h?Rt.default.createElement("span",{className:b.monthAndYearPickers},Rt.default.createElement("span",{className:b.monthPicker},Rt.default.createElement("select",{value:r.getMonth(),onChange:v=>i(v.target.value,"setMonth"),"aria-label":f.monthPicker},this.state.monthNames.map((v,_)=>Rt.default.createElement("option",{key:_,value:_},v)))),Rt.default.createElement("span",{className:b.monthAndYearDivider}),Rt.default.createElement("span",{className:b.yearPicker},Rt.default.createElement("select",{value:r.getFullYear(),onChange:v=>i(v.target.value,"setYear"),"aria-label":f.yearPicker},new Array(p-g+1).fill(p).map((v,_)=>{const N=v-_;return Rt.default.createElement("option",{key:N,value:N},N)})))):Rt.default.createElement("span",{className:b.monthAndYearPickers},this.state.monthNames[r.getMonth()]," ",r.getFullYear()),l?Rt.default.createElement("button",{type:"button",className:(0,Io.default)(b.nextPrevButton,b.nextButton),onClick:()=>i(1,"monthOffset"),"aria-label":f.nextButton},Rt.default.createElement("i",null)):null)}),gr(this,"renderDateDisplay",()=>{const{focusedRange:r,color:i,ranges:o,rangeColors:l,dateDisplayFormat:c,editableDateInputs:d,startDatePlaceholder:h,endDatePlaceholder:f,ariaLabels:p}=this.props,g=l[r[0]]||i,b=this.styles;return Rt.default.createElement("div",{className:b.dateDisplayWrapper},o.map((v,_)=>v.showDateDisplay===!1||v.disabled&&!v.showDateDisplay?null:Rt.default.createElement("div",{className:b.dateDisplay,key:_,style:{color:v.color||g}},Rt.default.createElement(Vk.default,{className:(0,Io.default)(b.dateDisplayItem,{[b.dateDisplayItemActive]:r[0]===_&&r[1]===0}),readOnly:!d,disabled:v.disabled,value:v.startDate,placeholder:h,dateOptions:this.dateOptions,dateDisplayFormat:c,ariaLabel:p.dateInput&&p.dateInput[v.key]&&p.dateInput[v.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(_,0)}),Rt.default.createElement(Vk.default,{className:(0,Io.default)(b.dateDisplayItem,{[b.dateDisplayItemActive]:r[0]===_&&r[1]===1}),readOnly:!d,disabled:v.disabled,value:v.endDate,placeholder:f,dateOptions:this.dateOptions,dateDisplayFormat:c,ariaLabel:p.dateInput&&p.dateInput[v.key]&&p.dateInput[v.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(_,1)}))))}),gr(this,"onDragSelectionStart",r=>{const{onChange:i,dragSelectionEnabled:o}=this.props;o?this.setState({drag:{status:!0,range:{startDate:r,endDate:r},disablePreview:!0}}):i&&i(r)}),gr(this,"onDragSelectionEnd",r=>{const{updateRange:i,displayMode:o,onChange:l,dragSelectionEnabled:c}=this.props;if(!c)return;if(o==="date"||!this.state.drag.status){l&&l(r);return}const d={startDate:this.state.drag.range.startDate,endDate:r};o!=="dateRange"||(0,Jt.isSameDay)(d.startDate,r)?this.setState({drag:{status:!1,range:{}}},()=>l&&l(r)):this.setState({drag:{status:!1,range:{}}},()=>{i&&i(d)})}),gr(this,"onDragSelectionMove",r=>{const{drag:i}=this.state;!i.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:i.status,range:{startDate:i.range.startDate,endDate:r},disablePreview:!0}})}),gr(this,"estimateMonthSize",(r,i)=>{const{direction:o,minDate:l}=this.props,{scrollArea:c}=this.state;if(i&&(this.listSizeCache=i,i[r]))return i[r];if(o==="horizontal")return c.monthWidth;const d=(0,Jt.addMonths)(l,r),{start:h,end:f}=(0,Uf.getMonthDisplayRange)(d,this.dateOptions);return(0,Jt.differenceInDays)(f,h,this.dateOptions)+1>7*5?c.longMonthHeight:c.monthHeight}),this.dateOptions={locale:e.locale},e.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=e.weekStartsOn),this.styles=(0,Uf.generateStyles)([tX.default,e.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,Uf.calcFocusDate)(null,e),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(e)}}getMonthNames(){return[...Array(12).keys()].map(e=>this.props.locale.localize.month(e))}calcScrollArea(e){const{direction:t,months:s,scroll:r}=e;if(!r.enabled)return{enabled:!1};const i=r.longMonthHeight||r.monthHeight;return t==="vertical"?{enabled:!0,monthHeight:r.monthHeight||220,longMonthHeight:i||260,calendarWidth:"auto",calendarHeight:(r.calendarHeight||i||240)*s}:{enabled:!0,monthWidth:r.monthWidth||332,calendarWidth:(r.calendarWidth||r.monthWidth||332)*s,monthHeight:i||300,calendarHeight:i||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(e){const s={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[s]!==e[s]&&this.updateShownDate(this.props),(e.locale!==this.props.locale||e.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,XQ.shallowEqualObjects)(e.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const e=new Date;return Rt.default.createElement("div",{className:this.styles.weekDays},(0,Jt.eachDayOfInterval)({start:(0,Jt.startOfWeek)(e,this.dateOptions),end:(0,Jt.endOfWeek)(e,this.dateOptions)}).map((t,s)=>Rt.default.createElement("span",{className:this.styles.weekDay,key:s},(0,Jt.format)(t,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:e,onPreviewChange:t,scroll:s,direction:r,disabledDates:i,disabledDay:o,maxDate:l,minDate:c,rangeColors:d,color:h,navigatorRenderer:f,className:p,preview:g}=this.props,{scrollArea:b,focusedDate:v}=this.state,_=r==="vertical",N=f||this.renderMonthAndYear,j=this.props.ranges.map((k,S)=>({...k,color:k.color||d[S]||h}));return Rt.default.createElement("div",{className:(0,Io.default)(this.styles.calendarWrapper,p),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},e&&this.renderDateDisplay(),N(v,this.changeShownDate,this.props),s.enabled?Rt.default.createElement("div",null,_&&this.renderWeekdays(this.dateOptions),Rt.default.createElement("div",{className:(0,Io.default)(this.styles.infiniteMonths,_?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>t&&t(),style:{width:b.calendarWidth+11,height:b.calendarHeight+11},onScroll:this.handleScroll},Rt.default.createElement(QQ.default,{length:(0,Jt.differenceInCalendarMonths)((0,Jt.endOfMonth)(l),(0,Jt.addDays)((0,Jt.startOfMonth)(c),-1),this.dateOptions),treshold:500,type:"variable",ref:k=>this.list=k,itemSizeEstimator:this.estimateMonthSize,axis:_?"y":"x",itemRenderer:(k,S)=>{const P=(0,Jt.addMonths)(c,k);return Rt.default.createElement(Uk.default,$p({},this.props,{onPreviewChange:t||this.updatePreview,preview:g||this.state.preview,ranges:j,key:S,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:i,disabledDay:o,month:P,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>t&&t(),styles:this.styles,style:_?{height:this.estimateMonthSize(k)}:{height:b.monthHeight,width:this.estimateMonthSize(k)},showMonthName:!0,showWeekDays:!_}))}}))):Rt.default.createElement("div",{className:(0,Io.default)(this.styles.months,_?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((k,S)=>{let P=(0,Jt.addMonths)(this.state.focusedDate,S);return this.props.calendarFocus==="backwards"&&(P=(0,Jt.subMonths)(this.state.focusedDate,this.props.months-1-S)),Rt.default.createElement(Uk.default,$p({},this.props,{onPreviewChange:t||this.updatePreview,preview:g||this.state.preview,ranges:j,key:S,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:i,disabledDay:o,month:P,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>t&&t(),styles:this.styles,showWeekDays:!_||S===0,showMonthName:!_||S>0}))})))}}rd.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:eX.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,Jt.addYears)(new Date,20),minDate:(0,Jt.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}};rd.propTypes={showMonthArrow:Ze.default.bool,showMonthAndYearPickers:Ze.default.bool,disabledDates:Ze.default.array,disabledDay:Ze.default.func,minDate:Ze.default.object,maxDate:Ze.default.object,date:Ze.default.object,onChange:Ze.default.func,onPreviewChange:Ze.default.func,onRangeFocusChange:Ze.default.func,classNames:Ze.default.object,locale:Ze.default.object,shownDate:Ze.default.object,onShownDateChange:Ze.default.func,ranges:Ze.default.arrayOf(JQ.rangeShape),preview:Ze.default.shape({startDate:Ze.default.object,endDate:Ze.default.object,color:Ze.default.string}),dateDisplayFormat:Ze.default.string,monthDisplayFormat:Ze.default.string,weekdayDisplayFormat:Ze.default.string,weekStartsOn:Ze.default.number,dayDisplayFormat:Ze.default.string,focusedRange:Ze.default.arrayOf(Ze.default.number),initialFocusedRange:Ze.default.arrayOf(Ze.default.number),months:Ze.default.number,className:Ze.default.string,showDateDisplay:Ze.default.bool,showPreview:Ze.default.bool,displayMode:Ze.default.oneOf(["dateRange","date"]),color:Ze.default.string,updateRange:Ze.default.func,scroll:Ze.default.shape({enabled:Ze.default.bool,monthHeight:Ze.default.number,longMonthHeight:Ze.default.number,monthWidth:Ze.default.number,calendarWidth:Ze.default.number,calendarHeight:Ze.default.number}),direction:Ze.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:Ze.default.string,endDatePlaceholder:Ze.default.string,navigatorRenderer:Ze.default.func,rangeColors:Ze.default.arrayOf(Ze.default.string),editableDateInputs:Ze.default.bool,dragSelectionEnabled:Ze.default.bool,fixedHeight:Ze.default.bool,calendarFocus:Ze.default.string,preventSnapRefocus:Ze.default.bool,ariaLabels:nX.ariaLabelsShape};Rh.default=rd;Object.defineProperty(Oh,"__esModule",{value:!0});Oh.default=void 0;var Bk=cX(C),nc=Hg(ga),KA=Hg(Rh),aX=ha,Mx=ya,li=Il,oX=Hg(Al),lX=Hg(Ol);function Hg(n){return n&&n.__esModule?n:{default:n}}function JA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(JA=function(s){return s?t:e})(n)}function cX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=JA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function Qb(){return Qb=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},Qb.apply(this,arguments)}function Vf(n,e,t){return e=dX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function dX(n){var e=uX(n,"string");return typeof e=="symbol"?e:String(e)}function uX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class j_ extends Bk.Component{constructor(e,t){var s;super(e,t),s=this,Vf(this,"calcNewSelection",function(r){let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const o=s.props.focusedRange||s.state.focusedRange,{ranges:l,onChange:c,maxDate:d,moveRangeOnFirstSelection:h,retainEndDateOnFirstSelection:f,disabledDates:p}=s.props,g=o[0],b=l[g];if(!b||!c)return{};let{startDate:v,endDate:_}=b;const N=new Date;let j;if(!i)v=r.startDate,_=r.endDate;else if(o[1]===0){const P=(0,li.differenceInCalendarDays)(_||N,v),E=()=>h?(0,li.addDays)(r,P):f?!_||(0,li.isBefore)(r,_)?_:r:r||N;v=r,_=E(),d&&(_=(0,li.min)([_,d])),j=[o[0],1]}else _=r;let k=o[1]===0;(0,li.isBefore)(_,v)&&(k=!k,[v,_]=[_,v]);const S=p.filter(P=>(0,li.isWithinInterval)(P,{start:v,end:_}));return S.length>0&&(k?v=(0,li.addDays)((0,li.max)(S),1):_=(0,li.addDays)((0,li.min)(S),-1)),j||(j=[(0,Mx.findNextRangeIndex)(s.props.ranges,o[0]),0]),{wasValid:!(S.length>0),range:{startDate:v,endDate:_},nextFocusRange:j}}),Vf(this,"setSelection",(r,i)=>{const{onChange:o,ranges:l,onRangeFocusChange:c}=this.props,h=(this.props.focusedRange||this.state.focusedRange)[0],f=l[h];if(!f)return;const p=this.calcNewSelection(r,i);o({[f.key||`range${h+1}`]:{...f,...p.range}}),this.setState({focusedRange:p.nextFocusRange,preview:null}),c&&c(p.nextFocusRange)}),Vf(this,"handleRangeFocusChange",r=>{this.setState({focusedRange:r}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(r)}),Vf(this,"updatePreview",r=>{var d;if(!r){this.setState({preview:null});return}const{rangeColors:i,ranges:o}=this.props,l=this.props.focusedRange||this.state.focusedRange,c=((d=o[l[0]])==null?void 0:d.color)||i[l[0]]||c;this.setState({preview:{...r.range,color:c}})}),this.state={focusedRange:e.initialFocusedRange||[(0,Mx.findNextRangeIndex)(e.ranges),0],preview:null},this.styles=(0,Mx.generateStyles)([lX.default,e.classNames])}render(){return Bk.default.createElement(KA.default,Qb({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:e=>{this.updatePreview(e?this.calcNewSelection(e):null)}},this.props,{displayMode:"dateRange",className:(0,oX.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:e=>this.setSelection(e,!1),ref:e=>{this.calendar=e}}))}}j_.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]};j_.propTypes={...KA.default.propTypes,onChange:nc.default.func,onRangeFocusChange:nc.default.func,className:nc.default.string,ranges:nc.default.arrayOf(aX.rangeShape),moveRangeOnFirstSelection:nc.default.bool,retainEndDateOnFirstSelection:nc.default.bool};Oh.default=j_;var Wg={},Lh={},oo={};Object.defineProperty(oo,"__esModule",{value:!0});oo.createStaticRanges=QA;oo.defaultStaticRanges=oo.defaultInputRanges=void 0;var Wt=Il;const Vn={startOfWeek:(0,Wt.startOfWeek)(new Date),endOfWeek:(0,Wt.endOfWeek)(new Date),startOfLastWeek:(0,Wt.startOfWeek)((0,Wt.addDays)(new Date,-7)),endOfLastWeek:(0,Wt.endOfWeek)((0,Wt.addDays)(new Date,-7)),startOfToday:(0,Wt.startOfDay)(new Date),endOfToday:(0,Wt.endOfDay)(new Date),startOfYesterday:(0,Wt.startOfDay)((0,Wt.addDays)(new Date,-1)),endOfYesterday:(0,Wt.endOfDay)((0,Wt.addDays)(new Date,-1)),startOfMonth:(0,Wt.startOfMonth)(new Date),endOfMonth:(0,Wt.endOfMonth)(new Date),startOfLastMonth:(0,Wt.startOfMonth)((0,Wt.addMonths)(new Date,-1)),endOfLastMonth:(0,Wt.endOfMonth)((0,Wt.addMonths)(new Date,-1))},hX={range:{},isSelected(n){const e=this.range();return(0,Wt.isSameDay)(n.startDate,e.startDate)&&(0,Wt.isSameDay)(n.endDate,e.endDate)}};function QA(n){return n.map(e=>({...hX,...e}))}oo.defaultStaticRanges=QA([{label:"Today",range:()=>({startDate:Vn.startOfToday,endDate:Vn.endOfToday})},{label:"Yesterday",range:()=>({startDate:Vn.startOfYesterday,endDate:Vn.endOfYesterday})},{label:"This Week",range:()=>({startDate:Vn.startOfWeek,endDate:Vn.endOfWeek})},{label:"Last Week",range:()=>({startDate:Vn.startOfLastWeek,endDate:Vn.endOfLastWeek})},{label:"This Month",range:()=>({startDate:Vn.startOfMonth,endDate:Vn.endOfMonth})},{label:"Last Month",range:()=>({startDate:Vn.startOfLastMonth,endDate:Vn.endOfLastMonth})}]);oo.defaultInputRanges=[{label:"days up to today",range(n){return{startDate:(0,Wt.addDays)(Vn.startOfToday,(Math.max(Number(n),1)-1)*-1),endDate:Vn.endOfToday}},getCurrentValue(n){return(0,Wt.isSameDay)(n.endDate,Vn.endOfToday)?n.startDate?(0,Wt.differenceInCalendarDays)(Vn.endOfToday,n.startDate)+1:"":"-"}},{label:"days starting today",range(n){const e=new Date;return{startDate:e,endDate:(0,Wt.addDays)(e,Math.max(Number(n),1)-1)}},getCurrentValue(n){return(0,Wt.isSameDay)(n.startDate,Vn.startOfToday)?n.endDate?(0,Wt.differenceInCalendarDays)(n.endDate,Vn.startOfToday)+1:"":"-"}}];var Gg={};Object.defineProperty(Gg,"__esModule",{value:!0});Gg.default=void 0;var Bf=mX(C),Ts=fX(ga);function fX(n){return n&&n.__esModule?n:{default:n}}function XA(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(XA=function(s){return s?t:e})(n)}function mX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=XA(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function pX(n,e,t){return e=gX(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function gX(n){var e=yX(n,"string");return typeof e=="symbol"?e:String(e)}function yX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}const qk=0,Hk=99999;class C_ extends Bf.Component{constructor(e,t){super(e,t),pX(this,"onChange",s=>{const{onChange:r}=this.props;let i=parseInt(s.target.value,10);i=isNaN(i)?0:Math.max(Math.min(Hk,i),qk),r(i)})}shouldComponentUpdate(e){const{value:t,label:s,placeholder:r}=this.props;return t!==e.value||s!==e.label||r!==e.placeholder}render(){const{label:e,placeholder:t,value:s,styles:r,onBlur:i,onFocus:o}=this.props;return Bf.default.createElement("div",{className:r.inputRange},Bf.default.createElement("input",{className:r.inputRangeInput,placeholder:t,value:s,min:qk,max:Hk,onChange:this.onChange,onFocus:o,onBlur:i}),Bf.default.createElement("span",{className:r.inputRangeLabel},e))}}C_.propTypes={value:Ts.default.oneOfType([Ts.default.string,Ts.default.number]),label:Ts.default.oneOfType([Ts.default.element,Ts.default.node]).isRequired,placeholder:Ts.default.string,styles:Ts.default.shape({inputRange:Ts.default.string,inputRangeInput:Ts.default.string,inputRangeLabel:Ts.default.string}).isRequired,onBlur:Ts.default.func.isRequired,onFocus:Ts.default.func.isRequired,onChange:Ts.default.func.isRequired};C_.defaultProps={value:"",placeholder:"-"};Gg.default=C_;Object.defineProperty(Lh,"__esModule",{value:!0});Lh.default=void 0;var Oo=bX(C),Ys=Yg(ga),Ro=Yg(Ol),Wk=oo,xX=ha,vX=Yg(Gg),Gk=Yg(Al);function Yg(n){return n&&n.__esModule?n:{default:n}}function eI(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(eI=function(s){return s?t:e})(n)}function bX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=eI(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function wX(n,e,t){return e=_X(e),e in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function _X(n){var e=SX(n,"string");return typeof e=="symbol"?e:String(e)}function SX(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var s=t.call(n,e);if(typeof s!="object")return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}class k_ extends Oo.Component{constructor(e){super(e),wX(this,"handleRangeChange",t=>{const{onChange:s,ranges:r,focusedRange:i}=this.props,o=r[i[0]];!s||!o||s({[o.key||`range${i[0]+1}`]:{...o,...t}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(e){const{ranges:t=[],focusedRange:s=[]}=this.props;if(typeof e.getCurrentValue!="function")return"";const r=t[s[0]]||{};return e.getCurrentValue(r)||""}getSelectedRange(e,t){const s=e.findIndex(i=>!i.startDate||!i.endDate||i.disabled?!1:t.isSelected(i));return{selectedRange:e[s],focusedRangeIndex:s}}render(){const{headerContent:e,footerContent:t,onPreviewChange:s,inputRanges:r,staticRanges:i,ranges:o,renderStaticRangeLabel:l,rangeColors:c,className:d}=this.props;return Oo.default.createElement("div",{className:(0,Gk.default)(Ro.default.definedRangesWrapper,d)},e,Oo.default.createElement("div",{className:Ro.default.staticRanges},i.map((h,f)=>{const{selectedRange:p,focusedRangeIndex:g}=this.getSelectedRange(o,h);let b;return h.hasCustomRendering?b=l(h):b=h.label,Oo.default.createElement("button",{type:"button",className:(0,Gk.default)(Ro.default.staticRange,{[Ro.default.staticRangeSelected]:!!p}),style:{color:p?p.color||c[g]:null},key:f,onClick:()=>this.handleRangeChange(h.range(this.props)),onFocus:()=>s&&s(h.range(this.props)),onMouseOver:()=>s&&s(h.range(this.props)),onMouseLeave:()=>{s&&s()}},Oo.default.createElement("span",{tabIndex:-1,className:Ro.default.staticRangeLabel},b))})),Oo.default.createElement("div",{className:Ro.default.inputRanges},r.map((h,f)=>Oo.default.createElement(vX.default,{key:f,styles:Ro.default,label:h.label,onFocus:()=>this.setState({focusedInput:f,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:p=>this.handleRangeChange(h.range(p,this.props)),value:this.getRangeOptionValue(h)}))),t)}}k_.propTypes={inputRanges:Ys.default.array,staticRanges:Ys.default.array,ranges:Ys.default.arrayOf(xX.rangeShape),focusedRange:Ys.default.arrayOf(Ys.default.number),onPreviewChange:Ys.default.func,onChange:Ys.default.func,footerContent:Ys.default.any,headerContent:Ys.default.any,rangeColors:Ys.default.arrayOf(Ys.default.string),className:Ys.default.string,renderStaticRangeLabel:Ys.default.func};k_.defaultProps={inputRanges:Wk.defaultInputRanges,staticRanges:Wk.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]};Lh.default=k_;Object.defineProperty(Wg,"__esModule",{value:!0});Wg.default=void 0;var qf=kX(C),NX=Fh(ga),tI=Fh(Oh),nI=Fh(Lh),Yk=ya,jX=Fh(Al),CX=Fh(Ol);function Fh(n){return n&&n.__esModule?n:{default:n}}function sI(n){if(typeof WeakMap!="function")return null;var e=new WeakMap,t=new WeakMap;return(sI=function(s){return s?t:e})(n)}function kX(n,e){if(n&&n.__esModule)return n;if(n===null||typeof n!="object"&&typeof n!="function")return{default:n};var t=sI(e);if(t&&t.has(n))return t.get(n);var s={__proto__:null},r=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var i in n)if(i!=="default"&&Object.prototype.hasOwnProperty.call(n,i)){var o=r?Object.getOwnPropertyDescriptor(n,i):null;o&&(o.get||o.set)?Object.defineProperty(s,i,o):s[i]=n[i]}return s.default=n,t&&t.set(n,s),s}function zp(){return zp=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},zp.apply(this,arguments)}class T_ extends qf.Component{constructor(e){super(e),this.state={focusedRange:[(0,Yk.findNextRangeIndex)(e.ranges),0]},this.styles=(0,Yk.generateStyles)([CX.default,e.classNames])}render(){const{focusedRange:e}=this.state;return qf.default.createElement("div",{className:(0,jX.default)(this.styles.dateRangePickerWrapper,this.props.className)},qf.default.createElement(nI.default,zp({focusedRange:e,onPreviewChange:t=>this.dateRange.updatePreview(t?this.dateRange.calcNewSelection(t,typeof t=="string"):null)},this.props,{range:this.props.ranges[e[0]],className:void 0})),qf.default.createElement(tI.default,zp({onRangeFocusChange:t=>this.setState({focusedRange:t}),focusedRange:e},this.props,{ref:t=>this.dateRange=t,className:void 0})))}}T_.defaultProps={};T_.propTypes={...tI.default.propTypes,...nI.default.propTypes,className:NX.default.string};Wg.default=T_;(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return i.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return i.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return i.defaultStaticRanges}});var e=o(Oh),t=o(Rh),s=o(Wg),r=o(Lh),i=oo;function o(l){return l&&l.__esModule?l:{default:l}}})(Ih);const $t=({label:n,id:e,error:t,value:s,onChange:r,maxDate:i,minDate:o,...l})=>{const[c,d]=C.useState(!1),[h,f]=C.useState(!1),p=C.useRef(null);C.useEffect(()=>{f(document.body.classList.contains("field-officer-dark-theme"))},[]);const g=j=>{r&&r(Ce(j,"yyyy-MM-dd")),d(!1)};C.useEffect(()=>{const j=k=>{p.current&&!p.current.contains(k.target)&&d(!1)};return document.addEventListener("mousedown",j),()=>document.removeEventListener("mousedown",j)},[]);const _=`${h?"fo-input":"form-input"} ${t?h?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer`,N=s?new Date(s+"T12:00:00"):new Date;return a.jsxs("div",{ref:p,children:[n&&a.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),a.jsxs("div",{className:n?"mt-1 relative":"relative",children:[a.jsxs("div",{id:e,className:_,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[a.jsx("span",{className:s?"":"text-muted",children:s?Ce(N,"dd MMM, yyyy"):"Select date"}),a.jsx(wl,{className:"h-4 w-4 text-muted"})]}),c&&a.jsx("div",{className:"absolute z-10 mt-1 bg-card border border-border rounded-lg shadow-lg",children:a.jsx(Ih.Calendar,{date:N,onChange:g,maxDate:i,minDate:o,color:"#005D22"})})]}),t&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},rI=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],TX=Ke({organizationId:ie().required(),location:ie().optional().nullable(),entityId:ie().optional(),billingName:ie().optional().nullable(),registeredAddress:ie().optional().nullable(),gstNumber:ie().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:ie().optional().nullable().transform(n=>(n==null?void 0:n.toUpperCase())||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:ie().email("Invalid email format").optional().nullable(),email2:ie().email("Invalid email format").optional().nullable(),email3:ie().email("Invalid email format").optional().nullable(),eShramNumber:ie().optional().nullable(),shopAndEstablishmentCode:ie().optional().nullable(),keyAccountManager:ie().optional(),siteAreaSqFt:ss().typeError("Must be a number").nullable().optional(),projectType:ie().oneOf(rI).optional(),apartmentCount:ss().typeError("Must be a number").nullable().optional(),agreementDetails:Ke({fromDate:ie().optional().nullable(),toDate:ie().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:ss().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:ot().nullable().optional(),scannedCopy:ot().nullable().optional(),agreementDate:ie().optional().nullable(),addendum1Date:ie().optional().nullable(),addendum2Date:ie().optional().nullable()}).optional(),siteOperations:Ke({form6Applicable:ns().default(!1),form6RenewalTaskCreation:ns().optional(),form6ValidityFrom:ie().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:ie().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:ot().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:ns().default(!1),minWageRevisionTaskCreation:ns().optional(),minWageRevisionValidityFrom:ie().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:ie().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:ot().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:Ke({numberOfDays:ss().nullable().min(0),list:xs().of(Ke({id:ie(),date:ie().required(),description:ie().required()})),salaryPayment:ie().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:ie().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:ie().url("Must be a valid URL").nullable().optional(),tools:Ke({dcCopy1:ot().nullable().optional(),dcCopy2:ot().nullable().optional(),list:xs().of(Ke({id:ie(),name:ie().required(),brand:ie().optional(),size:ie().optional(),quantity:ss().nullable().min(0),issueDate:ie().required(),picture:ot().nullable().optional()}))}).optional(),sims:Ke({issuedCount:ss().nullable().min(0),details:xs().of(Ke({id:ie(),mobileNumber:ie().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:ie().optional(),plan:ie().optional(),ownerName:ie().optional()}))}).optional(),equipment:Ke({issued:xs().of(Ke({id:ie(),name:ie().required(),brand:ie().optional(),modelNumber:ie().optional(),serialNumber:ie().optional(),accessories:ie().optional(),condition:ie().oneOf(["New","Old",""]),issueDate:ie().required(),picture:ot().nullable().optional()})),intermittent:Ke({billing:ie().oneOf(["To Be Billed","Not to be Billed",""]),frequency:ie().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:ns().default(!1),durationDays:ss().nullable().min(0)}).optional()}).optional(),billingCycleFrom:ie().nullable().optional(),uniformDeductions:ns().default(!1)}).optional(),insuranceStatus:Ke({isCompliant:ns().required()}).optional().nullable(),assets:xs().optional(),issuedTools:xs().optional()}).defined(),Zk=({title:n,children:e})=>{const[t,s]=C.useState(!1);return a.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[a.jsxs("button",{type:"button",onClick:()=>s(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[a.jsx("span",{children:n}),a.jsx(Ml,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&a.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},iI=({isOpen:n,onClose:e,onSave:t,organization:s,allClients:r,initialData:i})=>{var I,O,D,z,H,F,R,V,U,W,B,q,Q,le,X;const[o,l]=C.useState("General"),c=Nt("(max-width: 767px)"),{register:d,handleSubmit:h,control:f,watch:p,setValue:g,formState:{errors:b},reset:v}=xt({resolver:Lt(TX),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:_,append:N,remove:j}=vs({control:f,name:"siteOperations.holidays.list"});vs({control:f,name:"siteOperations.tools.list"}),vs({control:f,name:"siteOperations.sims.details"}),vs({control:f,name:"siteOperations.equipment.issued"}),C.useEffect(()=>{n&&v(i||{organizationId:s.id})},[n,i,s.id,v]);const k=p("entityId"),S=p("siteOperations.form6Applicable"),P=p("siteOperations.minWageRevisionApplicable");C.useEffect(()=>{if(k){const Z=r.find(se=>se.id===k);Z&&(g("registeredAddress",Z.registeredAddress||""),g("gstNumber",Z.gstNumber||""),g("panNumber",Z.panNumber||""),g("email1",Z.email||""),g("eShramNumber",Z.eShramNumber||""),g("shopAndEstablishmentCode",Z.shopAndEstablishmentCode||""))}},[k,r,g]);const E=Z=>{t(s.id,Z)},M=({tabName:Z})=>a.jsx("button",{type:"button",onClick:()=>l(Z),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===Z?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:Z});return n?a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:Z=>Z.stopPropagation(),children:a.jsxs("form",{onSubmit:h(E),className:"p-6",children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),a.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",s.shortName]}),a.jsx("div",{className:"mb-6",children:c?a.jsxs(Te,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:Z=>l(Z.target.value),className:"pro-select pro-select-arrow",children:[a.jsx("option",{value:"General",children:"General"}),a.jsx("option",{value:"Compliance",children:"Compliance"}),a.jsx("option",{value:"Agreement",children:"Agreement"}),a.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):a.jsx("div",{className:"border-b border-border",children:a.jsxs("nav",{className:"-mb-px flex space-x-4",children:[a.jsx(M,{tabName:"General"}),a.jsx(M,{tabName:"Compliance"}),a.jsx(M,{tabName:"Agreement"}),a.jsx(M,{tabName:"Site Operations"})]})})}),a.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[a.jsx(he,{label:"Location",id:"location",registration:d("location"),error:(I=b.location)==null?void 0:I.message}),a.jsx(he,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:(O=b.billingName)==null?void 0:O.message}),a.jsx(he,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:(D=b.keyAccountManager)==null?void 0:D.message}),a.jsx(he,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:(z=b.siteAreaSqFt)==null?void 0:z.message}),a.jsxs(Te,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:(H=b.projectType)==null?void 0:H.message,children:[a.jsx("option",{value:"",children:"-- Select Type --"}),rI.filter(Boolean).map(Z=>a.jsx("option",{value:Z,children:Z},Z))]}),a.jsx(he,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:(F=b.apartmentCount)==null?void 0:F.message})]}),o==="Compliance"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[a.jsx("div",{className:"md:col-span-2",children:a.jsx(de,{name:"entityId",control:f,render:({field:Z})=>{var se;return a.jsxs(Te,{label:"Link to Client (Prefills data)",id:"entityId",...Z,error:(se=b.entityId)==null?void 0:se.message,children:[a.jsx("option",{value:"",children:"-- Select Client --"}),r.map(G=>a.jsxs("option",{value:G.id,children:[G.name," (",G.companyName,")"]},G.id))]})}})}),a.jsx(he,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:(R=b.gstNumber)==null?void 0:R.message}),a.jsx(he,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:(V=b.panNumber)==null?void 0:V.message}),a.jsx(he,{label:"Email Address 1",id:"email1",registration:d("email1"),error:(U=b.email1)==null?void 0:U.message}),a.jsx(he,{label:"Email Address 2",id:"email2",registration:d("email2"),error:(W=b.email2)==null?void 0:W.message}),a.jsx(he,{label:"Email Address 3",id:"email3",registration:d("email3"),error:(B=b.email3)==null?void 0:B.message}),a.jsx(he,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:(q=b.eShramNumber)==null?void 0:q.message}),a.jsx(he,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:(Q=b.shopAndEstablishmentCode)==null?void 0:Q.message})]}),o==="Agreement"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[a.jsx(de,{name:"agreementDetails.fromDate",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"From Date",id:"agreementDetails.fromDate",value:Z.value,onChange:Z.onChange,error:(G=(se=b.agreementDetails)==null?void 0:se.fromDate)==null?void 0:G.message})}}),a.jsx(de,{name:"agreementDetails.toDate",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"To Date",id:"agreementDetails.toDate",value:Z.value,onChange:Z.onChange,error:(G=(se=b.agreementDetails)==null?void 0:se.toDate)==null?void 0:G.message})}}),a.jsx(he,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:(X=(le=b.agreementDetails)==null?void 0:le.renewalIntervalDays)==null?void 0:X.message}),a.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(de,{name:"agreementDetails.softCopy",control:f,render:({field:Z})=>a.jsx(qe,{label:"Soft Copy",file:Z.value,onFileChange:Z.onChange})}),a.jsx(de,{name:"agreementDetails.scannedCopy",control:f,render:({field:Z})=>a.jsx(qe,{label:"Scanned Copy",file:Z.value,onFileChange:Z.onChange})})]}),a.jsx(de,{name:"agreementDetails.agreementDate",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:Z.value,onChange:Z.onChange,error:(G=(se=b.agreementDetails)==null?void 0:se.agreementDate)==null?void 0:G.message})}}),a.jsx(de,{name:"agreementDetails.addendum1Date",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:Z.value,onChange:Z.onChange,error:(G=(se=b.agreementDetails)==null?void 0:se.addendum1Date)==null?void 0:G.message})}}),a.jsx(de,{name:"agreementDetails.addendum2Date",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:Z.value,onChange:Z.onChange,error:(G=(se=b.agreementDetails)==null?void 0:se.addendum2Date)==null?void 0:G.message})}})]}),o==="Site Operations"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(Zk,{title:"Compliance Forms",children:a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx(de,{name:"siteOperations.form6Applicable",control:f,render:({field:Z})=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:Z.value,onChange:Z.onChange})," Form 6 Applicable"]})}),S&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[a.jsx(de,{name:"siteOperations.form6ValidityFrom",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Valid From",id:"form6from",value:Z.value,onChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.form6ValidityFrom)==null?void 0:G.message})}}),a.jsx(de,{name:"siteOperations.form6ValidityTo",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Valid To",id:"form6to",value:Z.value,onChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.form6ValidityTo)==null?void 0:G.message})}}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(de,{name:"siteOperations.form6Document",control:f,render:({field:Z})=>{var se,G;return a.jsx(qe,{label:"Form 6 Document",file:Z.value,onFileChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.form6Document)==null?void 0:G.message})}})})]})]}),a.jsxs("div",{children:[a.jsx(de,{name:"siteOperations.minWageRevisionApplicable",control:f,render:({field:Z})=>a.jsxs("label",{className:"flex items-center gap-2",children:[a.jsx("input",{type:"checkbox",checked:Z.value,onChange:Z.onChange})," Min. Wage Revision Applicable"]})}),P&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[a.jsx(de,{name:"siteOperations.minWageRevisionValidityFrom",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Valid From",id:"minwagefrom",value:Z.value,onChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.minWageRevisionValidityFrom)==null?void 0:G.message})}}),a.jsx(de,{name:"siteOperations.minWageRevisionValidityTo",control:f,render:({field:Z})=>{var se,G;return a.jsx($t,{label:"Valid To",id:"minwageto",value:Z.value,onChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.minWageRevisionValidityTo)==null?void 0:G.message})}}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(de,{name:"siteOperations.minWageRevisionDocument",control:f,render:({field:Z})=>{var se,G;return a.jsx(qe,{label:"Min. Wage Document",file:Z.value,onFileChange:Z.onChange,error:(G=(se=b.siteOperations)==null?void 0:se.minWageRevisionDocument)==null?void 0:G.message})}})})]})]})]})}),a.jsx(Zk,{title:"Holidays",children:a.jsxs("div",{className:"space-y-4",children:[a.jsx(he,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),a.jsxs(Te,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Full Payment"}),a.jsx("option",{children:"Duty Payment"}),a.jsx("option",{children:"Nil Payment"})]}),a.jsxs(Te,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Full Payment"}),a.jsx("option",{children:"Duty Payment"}),a.jsx("option",{children:"Nil Payment"})]}),a.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),_.map((Z,se)=>a.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[a.jsx("div",{className:"col-span-6",children:a.jsx(he,{label:"Description",id:`holiday-desc-${se}`,...d(`siteOperations.holidays.list.${se}.description`)})}),a.jsx("div",{className:"col-span-5",children:a.jsx(de,{name:`siteOperations.holidays.list.${se}.date`,control:f,render:({field:G})=>a.jsx($t,{label:"Date",id:`holiday-date-${se}`,value:G.value,onChange:G.onChange})})}),a.jsx("div",{className:"col-span-1",children:a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>j(se),children:a.jsx(kt,{className:"h-4 text-red-500"})})})]},Z.id)),a.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:()=>N({id:`hol_${Date.now()}`,date:"",description:""}),children:[a.jsx(ct,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",children:"Save Configuration"})]})]})})}):null},EX=({isOpen:n,onClose:e,siteName:t,details:s,isLoading:r,onSave:i,designations:o})=>{const[l,c]=C.useState([]),[d,h]=C.useState(!1),f=C.useRef(null),[p,g]=C.useState(!1),b=C.useMemo(()=>{const E=new Set;return o.filter(M=>E.has(M.designation)?!1:(E.add(M.designation),!0)).sort((M,I)=>M.designation.localeCompare(I.designation))},[o]),v=()=>{const E=f.current;if(E){const M=E.scrollHeight>E.clientHeight,I=E.scrollHeight-E.scrollTop<=E.clientHeight+1;g(M&&!I)}else g(!1)};C.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(s)));const E=setTimeout(v,150);return()=>clearTimeout(E)}},[s,n,r]);const _=(E,M,I)=>{const O=[...l],D=O[E];if(M==="count"){const z=Number(I);D.count=isNaN(z)?0:z}else D.designation=String(I);c(O)},N=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(v,50)},j=E=>{const M=l.filter((I,O)=>O!==E);c(M),setTimeout(v,50)},k=async()=>{h(!0);const E=l.filter(M=>M.designation.trim()!=="").map(({tempId:M,...I})=>I);await i(E),h(!1)},S=Fe.useMemo(()=>l.reduce((E,M)=>E+(Number(M.count)||0),0),[l]),P=E=>{if(E.key!=="ArrowUp"&&E.key!=="ArrowDown")return;const M=E.target;if(M.tagName!=="INPUT"&&M.tagName!=="SELECT")return;const I=M.getAttribute("data-row-index"),O=M.getAttribute("data-col-index");if(!I||!O||M.type==="number")return;E.preventDefault();const D=E.currentTarget,z=parseInt(I,10),H=parseInt(O,10),F=E.key==="ArrowUp"?z-1:z+1,R=D.querySelector(`[data-row-index="${F}"][data-col-index="${H}"]`);R&&R.focus()};return n?LP.createPortal(a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:E=>E.stopPropagation(),children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),a.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),a.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[a.jsx("div",{ref:f,onScroll:v,onKeyDown:P,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:r?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{className:"space-y-2",children:[a.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[a.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),a.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),a.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((E,M)=>a.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[a.jsx("div",{className:"col-span-6",children:a.jsxs(Te,{id:`designation-${M}`,value:E.designation,onChange:I=>_(M,"designation",I.target.value),className:"py-1.5","data-row-index":M,"data-col-index":0,"aria-label":`Designation for row ${M+1}`,children:[a.jsx("option",{value:"",children:"Select Designation"}),b.map(I=>a.jsx("option",{value:I.designation,children:I.designation},I.id))]})}),a.jsx("div",{className:"col-span-4",children:a.jsx(he,{id:`count-${M}`,type:"number",value:E.count,onChange:I=>_(M,"count",I.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":M,"data-col-index":1,"aria-label":`Count for row ${M+1}`})}),a.jsx("div",{className:"col-span-2 text-right",children:a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>j(M),title:"Remove row","aria-label":`Remove row ${M+1}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})})]},E.tempId||M)):a.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),a.jsxs(Y,{variant:"outline",size:"sm",onClick:N,className:"mt-4",children:[a.jsx(ct,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),p&&a.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),a.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[a.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",a.jsx("span",{className:"text-accent",children:S.toFixed(2)})]}),a.jsxs("div",{className:"flex gap-3",children:[a.jsx(Y,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),a.jsx(Y,{onClick:k,isLoading:d,disabled:r,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},Dx=["id","shortName","fullName","address","manpowerApprovedCount"],PX=(n,e)=>{const t=e.join(","),s=n.map(r=>e.map(i=>{const o=r[i]===null||r[i]===void 0?"":String(r[i]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...s].join(`
`)},MX=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(r=>r.trim().replace(/"/g,"")),s=[];for(let r=1;r<e.length;r++){const i={},o=e[r].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),i[l]=d}),s.push(i)}return s},DX=({isOpen:n,onClose:e,onSave:t})=>{const[s,r]=C.useState(""),[i,o]=C.useState(""),l=()=>{if(!s.trim()){o("Site name cannot be empty.");return}t(s),r(""),e()};return n?a.jsxs(yn,{isOpen:n,onClose:e,onConfirm:l,title:"Quick Add Provisional Site",confirmButtonText:"Add Site",confirmButtonVariant:"primary",children:[a.jsx("p",{className:"mb-4 text-sm",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),a.jsx(he,{label:"New Site Name",id:"quick-add-site-name",value:s,onChange:c=>{r(c.target.value),o("")},error:i,autoFocus:!0})]}):null},AX=()=>{const[n,e]=C.useState([]),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState([]),[c,d]=C.useState(!0),[h,f]=C.useState(!1),[p,g]=C.useState(!1),[b,v]=C.useState(!1),[_,N]=C.useState(!1),[j,k]=C.useState(!1),[S,P]=C.useState(null),[E,M]=C.useState(null),[I,O]=C.useState(null),[D,z]=C.useState([]),[H,F]=C.useState(!1),R=C.useRef(null),V=Nt("(max-width: 767px)"),{siteManagement:U}=ir(),W=C.useCallback(async()=>{d(!0);try{const[G,ne,ge,ye]=await Promise.all([te.getOrganizations().catch(ae=>(console.error("Failed to fetch organizations:",ae),[])),te.getOrganizationStructure().catch(ae=>(console.error("Failed to fetch organization structure:",ae),[])),te.getSiteConfigurations().catch(ae=>(console.error("Failed to fetch site configurations:",ae),[])),te.getSiteStaffDesignations().catch(ae=>(console.error("Failed to fetch site staff designations:",ae),O({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);e(G),s(ge),l(ye);const re=ne.flatMap(ae=>ae.companies.flatMap(ve=>ve.entities.map(pe=>({...pe,companyName:ve.name}))));i(re)}catch{O({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{d(!1)}},[]);C.useEffect(()=>{W()},[W]);const B=async G=>{const ne={id:`SITE-${G.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:G,fullName:G,address:"To be configured",provisionalCreationDate:new Date().toISOString()};try{await te.createOrganization(ne),O({message:`Provisional site '${G}' created.`,type:"success"}),W()}catch{O({message:"Failed to create site.",type:"error"})}},q=(G,ne)=>{if(n.some(ye=>ye.id===G.organizationId)){O({message:"A site for this client already exists.",type:"error"});return}const ge={id:G.organizationId||`site_${Date.now()}`,shortName:G.name,fullName:G.name,address:G.location||G.registeredAddress||"",manpowerApprovedCount:ne};e(ye=>[ge,...ye].sort((re,ae)=>re.shortName.localeCompare(ae.shortName))),f(!1),O({message:"Site added successfully. You can now configure it.",type:"success"})},Q=(G,ne)=>{s(ge=>{const ye=[...ge],re=ye.findIndex(ae=>ae.organizationId===G);return re>-1?ye[re]=ne:ye.push(ne),ye}),O({message:"Site configuration saved.",type:"success"}),v(!1)},le=async()=>{E&&(e(G=>G.filter(ne=>ne.id!==E.id)),s(G=>G.filter(ne=>ne.organizationId!==E.id)),O({message:"Site deleted.",type:"success"}),N(!1))},X=async G=>{if(E)try{await te.updateManpowerDetails(E.id,G);const ne=G.reduce((ge,ye)=>ge+(Number(ye.count)||0),0);e(ge=>ge.map(ye=>ye.id===E.id?{...ye,manpowerApprovedCount:ne}:ye)),k(!1),O({message:"Manpower details updated successfully.",type:"success"})}catch{O({message:"Failed to save manpower details.",type:"error"})}},Z=()=>{const G=PX(n,Dx),ne=new Blob([G],{type:"text/csv;charset=utf-8;"}),ge=document.createElement("a");ge.href=URL.createObjectURL(ne),ge.setAttribute("download","sites_export.csv"),document.body.appendChild(ge),ge.click(),document.body.removeChild(ge),O({message:"Sites exported successfully.",type:"success"})},se=G=>{var ye;const ne=(ye=G.target.files)==null?void 0:ye[0];if(!ne)return;const ge=new FileReader;ge.onload=async re=>{var ae;try{const ve=(ae=re.target)==null?void 0:ae.result;if(!ve)throw new Error("File is empty or could not be read.");const pe=MX(ve);if(pe.length===0)throw new Error("No data rows found in the CSV file.");const Ne=Object.keys(pe[0]);if(!Dx.every(dt=>Ne.includes(dt)))throw new Error(`CSV is missing headers. Required: ${Dx.join(", ")}`);const Oe=pe.map(dt=>({id:dt.id,shortName:dt.shortName,fullName:dt.fullName,address:dt.address,manpowerApprovedCount:parseFloat(dt.manpowerApprovedCount)||0})),{count:Je}=await te.bulkUploadOrganizations(Oe);O({message:`${Je} sites imported/updated successfully.`,type:"success"}),W()}catch(ve){O({message:ve.message||"Failed to import CSV.",type:"error"})}finally{G.target&&(G.target.value="")}},ge.readAsText(ne)};return a.jsxs("div",{className:"p-4 md:p-8",children:[I&&a.jsx(gt,{message:I.message,type:I.type,onDismiss:()=>O(null)}),a.jsx("input",{type:"file",ref:R,className:"hidden",accept:".csv",onChange:se}),a.jsx($J,{isOpen:h,onClose:()=>f(!1),onSave:q}),a.jsx(DX,{isOpen:p,onClose:()=>g(!1),onSave:B}),b&&S&&a.jsx(iI,{isOpen:b,onClose:()=>v(!1),onSave:Q,organization:S,allClients:r,initialData:t.find(G=>G.organizationId===S.id)}),E&&a.jsx(EX,{isOpen:j,onClose:()=>k(!1),siteName:E.shortName,details:D,isLoading:H,onSave:X,designations:o}),a.jsxs(yn,{isOpen:_,onClose:()=>N(!1),onConfirm:le,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',E==null?void 0:E.shortName,'"? This action cannot be undone.']}),a.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!V&&a.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[a.jsxs(Y,{variant:"outline",onClick:()=>g(!0),className:"mr-2 hover:bg-gray-100",children:[a.jsx(ct,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),a.jsxs(Y,{onClick:()=>f(!0),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[a.jsx(ct,{className:"w-5 h-5 mr-2"}),"Add Site"]}),a.jsxs(Y,{variant:"outline",onClick:()=>{var G;return(G=R.current)==null?void 0:G.click()},className:"mr-2 hover:bg-gray-100",children:[a.jsx(ao,{className:"w-5 h-5 mr-2"}),"Import"]}),a.jsxs(Y,{variant:"outline",onClick:Z,className:"hover:bg-gray-100",children:[a.jsx(or,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),V&&a.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[a.jsxs(Y,{onClick:()=>f(!0),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[a.jsx(ct,{className:"w-5 h-5 mr-2"}),"Add Site"]}),a.jsxs(Y,{variant:"outline",onClick:()=>g(!0),className:"w-full justify-center hover:bg-gray-100",children:[a.jsx(ct,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),a.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.jsxs(Y,{variant:"outline",onClick:()=>{var G;return(G=R.current)==null?void 0:G.click()},className:"w-full justify-center hover:bg-gray-100",children:[a.jsx(ao,{className:"w-5 h-5 mr-2"}),"Import"]}),a.jsxs(Y,{variant:"outline",onClick:Z,className:"w-full justify-center hover:bg-gray-100",children:[a.jsx(or,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]})]})},IX=({isOpen:n,onClose:e,onSave:t,title:s,initialName:r=""})=>{const[i,o]=C.useState(r),[l,c]=C.useState("");C.useEffect(()=>{n&&(o(r),c(""))},[n,r]);const d=()=>{if(!i.trim()){c("Role name cannot be empty.");return}t(i.trim()),e()};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:a.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:s}),a.jsx(he,{label:"Role Display Name",id:"role-name",value:i,onChange:h=>o(h.target.value),error:l,autoFocus:!0}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",children:"Save"})]})]})})}):null},Xb=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),OX=()=>{const{permissions:n,setRolePermissions:e,addRolePermissionEntry:t,removeRolePermissionEntry:s,renameRolePermissionEntry:r}=pa(),[i,o]=C.useState([]),[l,c]=C.useState([]),[d,h]=C.useState(!0),[f,p]=C.useState(null),[g,b]=C.useState(!1),[v,_]=C.useState(!1),[N,j]=C.useState(null),[k,S]=C.useState(!1),[P,E]=C.useState(null),M=C.useRef(null),I=Nt("(max-width: 767px)");C.useEffect(()=>{(async()=>{h(!0);try{const[U,W]=await Promise.all([te.getRoles(),te.getModules()]);o(U),c(W.sort((B,q)=>B.name.localeCompare(q.name)))}catch(U){console.error("Failed to load data",U),p({message:"Failed to load page data.",type:"error"})}finally{h(!1)}})()},[]),C.useEffect(()=>{const V=U=>{M.current&&!M.current.contains(U.target)&&E(null)};return document.addEventListener("mousedown",V),()=>document.removeEventListener("mousedown",V)},[]);const O=(V,U,W)=>{const B=n[V]||[],q=W?[...B,U]:B.filter(Q=>Q!==U);e(V,q)},D=async V=>{const U=V.toLowerCase().replace(/\s+/g,"_");if(k&&N){if(N.id==="admin"){p({message:"The Admin role cannot be renamed.",type:"error"});return}if(i.some(B=>B.id===U&&B.id!==N.id)){p({message:`A role with ID '${U}' already exists.`,type:"error"});return}const W=i.map(B=>B.id===N.id?{...B,displayName:V,id:U}:B);await te.saveRoles(W),o(W),r(N.id,U),p({message:"Role renamed.",type:"success"})}else{if(i.some(q=>q.id===U)){p({message:`A role with ID '${U}' already exists.`,type:"error"});return}const W={id:U,displayName:V},B=[...i,W];await te.saveRoles(B),o(B),t(W),p({message:"Role added successfully.",type:"success"})}},z=async()=>{if(!N||N.id==="admin"){p({message:"This role cannot be deleted.",type:"error"}),_(!1);return}const V=i.filter(U=>U.id!==N.id);await te.saveRoles(V),o(V),s(N.id),p({message:`Role '${N.displayName}' deleted.`,type:"success"}),_(!1)},H=C.useMemo(()=>new Map(Xb.map(V=>[V.key,V])),[]),F=C.useMemo(()=>{const V=new Set(l.flatMap(U=>U.permissions));return Xb.filter(U=>!V.has(U.key))},[l]),R=V=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:a.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[a.jsx("div",{className:"font-semibold text-primary-text",children:V.name}),a.jsx("div",{className:"text-xs text-muted",children:V.description})]})}),i.map(U=>{var Q;const W=(Q=n[U.id])==null?void 0:Q.includes(V.key),B=U.id==="admin",q=B?"Admin role has all permissions by default and cannot be changed.":"";return a.jsx("td",{"data-label":U.displayName,className:"px-4 py-4 text-center align-middle",children:a.jsx("div",{className:"flex justify-center",children:a.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${B?"cursor-not-allowed":"cursor-pointer"}`,children:[a.jsx("input",{type:"checkbox",className:"sr-only peer",checked:W,onChange:le=>O(U.id,V.key,le.target.checked),disabled:B,title:q}),a.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${B?"opacity-50":""}`,children:W?a.jsx(ol,{className:"w-4 h-4 text-accent"}):a.jsx(Us,{className:"w-4 h-4 text-red-500"})})]})})},U.id)})]},V.key);return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[f&&a.jsx(gt,{message:f.message,type:f.type,onDismiss:()=>p(null)}),a.jsx(IX,{isOpen:g,onClose:()=>b(!1),onSave:D,title:k?"Rename Role":"Add New Role",initialName:k?N==null?void 0:N.displayName:""}),a.jsxs(yn,{isOpen:v,onClose:()=>_(!1),onConfirm:z,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',N==null?void 0:N.displayName,'"? This action cannot be undone.']}),a.jsx(ur,{title:"Role & Permission Management",children:a.jsxs("button",{onClick:()=>{S(!1),j(null),b(!0)},className:"btn btn-primary btn-md",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Role"]})}),a.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),i.map(V=>a.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:a.jsxs("div",{className:"flex items-center justify-center gap-1",children:[a.jsx("span",{children:V.displayName}),V.id!=="admin"&&a.jsxs("div",{className:"relative",children:[a.jsx("button",{onClick:()=>E(V.id===P?null:V.id),children:a.jsx(uZ,{className:"h-4 w-4 text-muted"})}),P===V.id&&a.jsxs("div",{ref:M,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[a.jsxs("button",{onClick:()=>{S(!0),j(V),b(!0),E(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[a.jsx(Jn,{className:"mr-2 h-4 w-4"}),"Rename"]}),a.jsxs("button",{onClick:()=>{j(V),_(!0),E(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[a.jsx(kt,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},V.id))]})}),d?a.jsx("tbody",{children:I?a.jsx("tr",{children:a.jsx("td",{colSpan:i.length+1||2,children:a.jsx(Pi,{rows:3,cols:2,isMobile:!0})})}):a.jsx(Pi,{rows:10,cols:i.length+1||5})}):a.jsxs(a.Fragment,{children:[l.map(V=>a.jsxs("tbody",{className:"divide-y divide-border",children:[a.jsx("tr",{className:"bg-page/50",children:a.jsx("td",{colSpan:i.length+1,className:"p-2 font-bold text-primary-text",children:V.name})}),V.permissions.map(U=>{const W=H.get(U);return W?R(W):null})]},V.id)),F.length>0&&a.jsxs("tbody",{className:"divide-y divide-border",children:[a.jsx("tr",{className:"bg-page/50",children:a.jsx("td",{colSpan:i.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),F.map(R)]})]})]})})]})},RX=Ke({id:ie().required(),name:ie().required("Module name is required"),description:ie().required("Description is required"),permissions:xs().of(ie().required()).min(1,"At least one permission must be selected")}).defined(),LX=({isOpen:n,onClose:e,onSave:t,initialData:s})=>{var d,h,f;const{register:r,handleSubmit:i,control:o,reset:l,formState:{errors:c}}=xt({resolver:Lt(RX)});return C.useEffect(()=>{n&&l(s||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,s,l]),n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:p=>p.stopPropagation(),children:a.jsxs("form",{onSubmit:i(t),children:[a.jsx("div",{className:"p-4 border-b",children:a.jsxs("h3",{className:"text-xl font-bold",children:[s?"Edit":"Add"," Module"]})}),a.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[a.jsx(he,{label:"Module Name",...r("name"),error:(d=c.name)==null?void 0:d.message}),a.jsx(he,{label:"Description",...r("description"),error:(h=c.description)==null?void 0:h.message}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:a.jsx(de,{name:"permissions",control:o,render:({field:p})=>a.jsx(a.Fragment,{children:Xb.map(g=>{var b;return a.jsx(zt,{id:`perm-${g.key}`,label:g.name,checked:((b=p.value)==null?void 0:b.includes(g.key))||!1,onChange:v=>{const _=v?[...p.value||[],g.key]:(p.value||[]).filter(N=>N!==g.key);p.onChange(_)}},g.key)})})})}),c.permissions&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?(f=c.permissions[0])==null?void 0:f.message:c.permissions.message})]})]}),a.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(Y,{type:"submit",children:"Save Module"})]})]})})}):null},FX=({count:n=6})=>a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>a.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(Yn,{className:"h-5 w-5 rounded-full"}),a.jsx(Yn,{className:"h-5 w-1/2"})]}),a.jsx(Yn,{className:"h-4 w-full"}),a.jsx(Yn,{className:"h-4 w-3/4"}),a.jsx(Yn,{className:"h-3 w-1/4"})]},t))}),$X=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(null),[o,l]=C.useState(!1),[c,d]=C.useState(!1),[h,f]=C.useState(null);C.useEffect(()=>{(async()=>{s(!0);try{const v=await te.getModules();e(v)}catch{i({message:"Failed to load modules.",type:"error"})}finally{s(!1)}})()},[]);const p=async b=>{const v=[...n],_=v.findIndex(N=>N.id===b.id);_>-1?v[_]=b:v.push(b);try{await te.saveModules(v),e(v.sort((N,j)=>N.name.localeCompare(j.name))),i({message:`Module '${b.name}' saved.`,type:"success"}),l(!1)}catch{i({message:"Failed to save module.",type:"error"})}},g=async()=>{if(!h)return;const b=n.filter(v=>v.id!==h.id);try{await te.saveModules(b),e(b),i({message:`Module '${h.name}' deleted.`,type:"success"}),d(!1)}catch{i({message:"Failed to delete module.",type:"error"})}};return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[r&&a.jsx(gt,{...r,onDismiss:()=>i(null)}),a.jsx(LX,{isOpen:o,onClose:()=>l(!1),onSave:p,initialData:h}),a.jsxs(yn,{isOpen:c,onClose:()=>d(!1),onConfirm:g,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',h==null?void 0:h.name,'"?']}),a.jsx(ur,{title:"Module Management",children:a.jsxs(Y,{onClick:()=>{f(null),l(!0)},children:[a.jsx(ct,{className:"mr-2 h-4"})," Add Module"]})}),t?a.jsx(FX,{count:6}):a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:n.map(b=>a.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx(Kw,{className:"h-5 w-5 text-accent"}),a.jsx("h4",{className:"font-bold text-primary-text",children:b.name})]}),a.jsx("p",{className:"text-sm text-muted mb-3",children:b.description}),a.jsxs("p",{className:"text-xs font-semibold text-muted",children:[b.permissions.length," permissions"]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>{f(b),l(!0)},title:`Edit ${b.name}`,children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>{f(b),d(!0)},title:`Delete ${b.name}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]})]},b.id))})]})},Ax=({title:n,icon:e,children:t})=>a.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),a.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),a.jsx("div",{className:"space-y-4",children:t})]}),zX=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:s,setCurrentLogo:r,setDefaultLogo:i,resetToDefault:o,resetToOriginal:l}=s_(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:h}=XD(),f=QD(),[p,g]=C.useState(null),b=k=>{if(k){const S=new FileReader;S.readAsDataURL(k.file),S.onloadend=()=>{const P=S.result;r(P),g({message:"Active logo updated!",type:"success"})},S.onerror=()=>{g({message:"Failed to read logo file.",type:"error"})}}},v=()=>{i(),g({message:"Active logo has been set as the new default.",type:"success"})},_=()=>{o(),g({message:"Logo has been reset to your default.",type:"success"})},N=()=>{l(),g({message:"Logo has been reset to the system original.",type:"success"})},j=k=>{if(k&&!k.url){const S=new FileReader;S.readAsDataURL(k.file),S.onloadend=()=>{const P=S.result,E=d(P);g(E?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},S.onerror=()=>{g({message:"Failed to read image file.",type:"error"})}}};return n?a.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[p&&a.jsx(gt,{message:p.message,type:p.type,onDismiss:()=>g(null)}),a.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:k=>k.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),a.jsx(Y,{variant:"icon",onClick:e,children:a.jsx(Us,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[a.jsxs(Ax,{title:"Branding & Logo",icon:zD,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),a.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:a.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),a.jsx(qe,{label:"Change Active Logo",file:null,onFileChange:b,allowedTypes:["image/jpeg","image/png"]})]}),a.jsxs("div",{className:"flex flex-col h-full",children:[a.jsxs("div",{className:"space-y-4",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),a.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:a.jsx("img",{src:s,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),a.jsx("div",{className:"flex-grow"}),a.jsxs("div",{className:"space-y-2 mt-4",children:[a.jsx(Y,{type:"button",className:"w-full",onClick:v,children:"Set Active Logo as Default"}),a.jsx(Y,{type:"button",className:"w-full",variant:"outline",onClick:_,children:"Use Default Logo"}),a.jsx("div",{className:"text-center pt-2",children:a.jsx("button",{type:"button",onClick:N,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),a.jsxs(Ax,{title:"Login Screen Background",icon:UD,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((k,S)=>a.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[a.jsx("img",{src:k,className:"w-full h-full object-cover",alt:`Background ${S+1}`}),a.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:a.jsx(Y,{variant:"icon",onClick:()=>h(S),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:a.jsx(kt,{className:"h-5 w-5 text-white"})})})]},`${k.substring(0,30)}-${S}`))}),a.jsx("div",{className:"mt-4",children:a.jsx(qe,{label:"Add new background image",file:null,onFileChange:j,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),a.jsxs(Ax,{title:"Interaction Settings",icon:jZ,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),a.jsxs("div",{className:"space-y-4 pt-4",children:[a.jsx(zt,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:f.autoClickOnHover,onChange:f.setAutoClickOnHover}),a.jsx(zt,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:f.autoScrollOnHover,onChange:f.setAutoScrollOnHover})]})]})]}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(Y,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},sc=({title:n,icon:e,children:t,className:s})=>a.jsxs("div",{className:`md:bg-card md:p-6 md:rounded-xl md:shadow-card ${s||""}`,children:[a.jsxs("div",{className:"flex items-center mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),a.jsx("div",{children:a.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),a.jsx("div",{className:"space-y-4",children:t})]}),UX=()=>{const n=ir(),[e,t]=C.useState(!1),[s,r]=C.useState(null),[i,o]=C.useState(!1),l=async()=>{t(!0),r(null);try{const c=await te.exportAllData(),d=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(c,null,2))}`,h=document.createElement("a");h.href=d,h.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(h),h.click(),document.body.removeChild(h),r({message:"Data exported successfully!",type:"success"})}catch{r({message:"Failed to export data.",type:"error"})}finally{t(!1)}};return a.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[s&&a.jsx(gt,{message:s.message,type:s.type,onDismiss:()=>r(null)}),a.jsx(zX,{isOpen:i,onClose:()=>o(!1)}),a.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[a.jsxs("div",{className:"space-y-8",children:[a.jsxs(sc,{title:"Page Interface",icon:zD,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),a.jsx("div",{className:"pt-4",children:a.jsx(Y,{type:"button",onClick:()=>o(!0),children:"Open Interface Settings"})})]}),a.jsxs(sc,{title:"Verification APIs",icon:Dh,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),a.jsxs("div",{className:"space-y-6 pt-4",children:[a.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:a.jsx(zt,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:c=>n.updateGeminiApiSettings({enabled:c})})}),a.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[a.jsx(zt,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:c=>n.updatePerfiosApiSettings({enabled:c})}),a.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[a.jsx(he,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:c=>n.updatePerfiosApiSettings({clientId:c.target.value})}),a.jsx(he,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:c=>n.updatePerfiosApiSettings({clientSecret:c.target.value})})]})]})]})]}),a.jsxs(sc,{title:"Authentication Settings",icon:Jw,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),a.jsx("div",{className:"space-y-6 pt-4",children:a.jsx(zt,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:c=>n.updateOtpSettings({enabled:c})})})]})]}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs(sc,{title:"Client & Site Management",icon:bl,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),a.jsx("div",{className:"space-y-6 pt-4",children:a.jsx(zt,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:c=>n.updateSiteManagementSettings({enableProvisionalSites:c})})})]}),a.jsxs(sc,{title:"System & Data",icon:Dg,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),a.jsxs("div",{className:"space-y-6 pt-4",children:[a.jsx(zt,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:c=>n.updateAddressSettings({enablePincodeVerification:c})}),a.jsxs("div",{className:"pt-4 border-t",children:[a.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),a.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),a.jsxs(Y,{type:"button",variant:"outline",onClick:l,isLoading:e,children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),a.jsxs(sc,{title:"Notification Settings",icon:Mh,children:[a.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),a.jsx("div",{className:"space-y-6 pt-4",children:a.jsx(zt,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:c=>n.updateNotificationSettings({email:{enabled:c}})})})]})]})]})]})},Fn=({title:n,subtitle:e})=>a.jsxs("div",{className:"mb-6",children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),a.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),VX=({title:n,value:e,icon:t})=>a.jsxs("div",{className:"bg-card p-4 rounded-2xl flex items-center col-span-1",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted font-medium",children:n}),a.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),wi=Fe.memo(VX),BX=()=>{const[n,e]=C.useState([]),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(!0),[c,d]=C.useState(null),[h,f]=C.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[p,g]=C.useState(!1),[b,v]=C.useState(""),[_,N]=C.useState(""),[j,k]=C.useState(Ce(new Date,"yyyy-MM-dd"));C.useEffect(()=>{(async()=>{l(!0);try{const[O,D,z]=await Promise.all([te.getVerificationSubmissions(),te.getFieldOfficers(),te.getOrganizations()]);e(O),s(D),i(z)}catch{d({message:"Failed to load dashboard data.",type:"error"})}finally{l(!1)}})()},[]);const S=C.useMemo(()=>{const I=h[0].startDate,O=h[0].endDate;if(!I||!O)return n;const D=new Date(O);return D.setHours(23,59,59,999),n.filter(z=>{const H=new Date(z.enrollmentDate.replace(/-/g,"/"));return H>=I&&H<=D})},[n,h]),P=C.useMemo(()=>({total:S.length,verified:S.filter(I=>I.status==="verified").length,rejected:S.filter(I=>I.status==="rejected").length}),[S]),E=async I=>{if(I.preventDefault(),!b||!_||!j){d({message:"Please fill all fields for assignment.",type:"error"});return}try{await te.createAssignment(b,_,j),d({message:"Assignment created successfully (mocked).",type:"success"})}catch{d({message:"Failed to create assignment.",type:"error"})}},M=h[0].startDate&&h[0].endDate?`${Ce(h[0].startDate,"MMM d, yyyy")} - ${Ce(h[0].endDate,"MMM d, yyyy")}`:"Select Date";return a.jsxs("div",{className:"p-4 space-y-8",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),a.jsx("div",{className:"bg-card p-4 rounded-2xl",children:a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),a.jsxs("div",{className:"relative",children:[a.jsxs(Y,{variant:"outline",onClick:()=>g(!p),children:[a.jsx(wl,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:M})]}),p&&a.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:a.jsx(Ih.DateRangePicker,{onChange:I=>{f([I.selection]),g(!1)},months:1,ranges:h,direction:"horizontal"})})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[a.jsx(wi,{title:"Total Submissions",value:P.total,icon:Bs}),a.jsx(wi,{title:"Verified Employees",value:P.verified,icon:nd}),a.jsx(wi,{title:"Rejected Applications",value:P.rejected,icon:t_})]}),a.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[a.jsx(Fn,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),a.jsxs("form",{onSubmit:E,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[a.jsx("div",{className:"md:col-span-1",children:a.jsxs(Te,{label:"Field Officer",id:"officer",value:b,onChange:I=>v(I.target.value),children:[a.jsx("option",{value:"",children:"Select Officer"}),t.map(I=>a.jsx("option",{value:I.id,children:I.name},I.id))]})}),a.jsx("div",{className:"md:col-span-1",children:a.jsxs(Te,{label:"Organization/Site",id:"site",value:_,onChange:I=>N(I.target.value),children:[a.jsx("option",{value:"",children:"Select Site"}),r.map(I=>a.jsx("option",{value:I.id,children:I.shortName},I.id))]})}),a.jsx("div",{className:"md:col-span-1",children:a.jsx($t,{label:"Assignment Date",id:"assignmentDate",value:j,onChange:k})}),a.jsx("div",{className:"md:col-span-1",children:a.jsxs(Y,{type:"submit",className:"w-full",children:[a.jsx(Qw,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},qX=({status:n})=>{if(!n)return a.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},s=e[n];return a.jsx("span",{className:`sync-chip ${s}`,children:t[n]})},HX=()=>{var E;const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState("all"),[o,l]=C.useState(""),[c,d]=C.useState(null),h=Vt(),{user:f}=tt(),p=Nt("(max-width: 767px)"),[g,b]=C.useState([]),[v,_]=C.useState(f==null?void 0:f.organizationId),N=f&&f.role==="admin";C.useEffect(()=>{N&&te.getOrganizations().then(M=>{b(M),M.length>0&&!v&&_(M[0].id)})},[N,v]);const j=C.useCallback(async()=>{if(!v){f!=null&&f.organizationId&&s(!1);return}s(!0);try{const M=await te.getVerificationSubmissions(r==="all"?void 0:r,v);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{s(!1)}},[r,v,f==null?void 0:f.organizationId]);C.useEffect(()=>{j()},[j]);const k=C.useMemo(()=>n.filter(M=>M.personal.firstName.toLowerCase().includes(o.toLowerCase())||M.personal.lastName.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),S=((E=g.find(M=>M.id===v))==null?void 0:E.shortName)||(f==null?void 0:f.organizationName),P=["all","pending","verified","rejected"];return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),a.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",a.jsx("span",{className:"font-semibold text-accent-dark",children:S||"N/A"})]})]}),!p&&a.jsxs("div",{className:"flex items-center gap-4",children:[N&&a.jsx("div",{className:"w-full sm:w-56",children:a.jsxs(Te,{label:"",id:"org-selector",value:v,onChange:M=>_(M.target.value),children:[a.jsx("option",{value:"",children:"Select a Site"}),g.map(M=>a.jsx("option",{value:M.id,children:M.shortName},M.id))]})}),a.jsxs(Y,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(sd,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),p&&a.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[N&&a.jsxs(Te,{label:"Select Site",id:"org-selector-mobile",value:v,onChange:M=>_(M.target.value),children:[a.jsx("option",{value:"",children:"Select a Site"}),g.map(M=>a.jsx("option",{value:M.id,children:M.shortName},M.id))]}),a.jsxs(Y,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(sd,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[a.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:a.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:P.map(M=>a.jsx("button",{onClick:()=>i(M),className:`${r===M?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:M},M))})}),a.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[a.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:a.jsx(ua,{className:"h-5 w-5 text-gray-400"})}),a.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:M=>l(M.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),a.jsx("tbody",{children:t?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):v?k.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):k.map(M=>a.jsxs("tr",{children:[a.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[a.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),a.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]}),a.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:a.jsx(p_,{status:M.status})}),a.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:a.jsx(qX,{status:M.portalSyncStatus})}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:a.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/add/personal?id=${M.id}`),title:"View/Edit Details",children:a.jsx(ca,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/pdf/${M.id}`),title:"Download Forms",children:a.jsx(Bs,{className:"h-4 w-4"})})]})})]},M.id)):a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},e0=({file:n,onFileChange:e})=>{const[t,s]=C.useState(!1),[r,i]=C.useState(""),[o,l]=C.useState(!1),c=C.useCallback(async g=>{if(g&&g.type.startsWith("image/")){i("");const b={name:g.name,type:g.type,size:g.size,preview:URL.createObjectURL(g),file:g};e(b)}},[e]),d=async g=>{var v;const b=(v=g.target.files)==null?void 0:v[0];b&&c(b)},h=C.useCallback(async(g,b)=>{const v=await(await fetch(`data:${b};base64,${g}`)).blob(),_=new File([v],`capture-${Date.now()}.jpg`,{type:b});c(_)},[c]),f=()=>{n&&URL.revokeObjectURL(n.preview),e(null),i("")},p="avatar-upload";return a.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&a.jsx(r_,{isOpen:o,onClose:()=>l(!1),onCapture:h,captureGuidance:"profile"}),a.jsxs("div",{className:"relative w-40 h-40",children:[a.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${r?"border-red-500":"border-border"}`,children:t?a.jsxs("div",{className:"flex flex-col items-center text-muted",children:[a.jsx(Qe,{className:"h-8 w-8 animate-spin"}),a.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n!=null&&n.preview?a.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):a.jsx(ea,{})}),n&&!t&&a.jsx("button",{type:"button",onClick:f,className:"absolute top-2 right-2 p-1.5 bg-card/70 backdrop-blur-sm rounded-full text-red-600 hover:bg-red-100 transition-colors","aria-label":"Remove photo",children:a.jsx(kt,{className:"w-4 h-4"})})]}),a.jsxs("div",{className:"flex items-center space-x-2",children:[a.jsxs("label",{htmlFor:p,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[a.jsx(Jn,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),a.jsx("input",{id:p,name:p,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),a.jsxs(Y,{type:"button",variant:"secondary",size:"md",onClick:()=>l(!0),disabled:t,className:"px-4 py-2",children:[a.jsx(Bw,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),r&&a.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[a.jsx(Jr,{className:"h-3 w-3 flex-shrink-0"})," ",r]})]})},Kk=({onConfirm:n,isActionInProgress:e,text:t,confirmText:s,slideDirection:r,className:i="",thumbClassName:o=""})=>{const[l,c]=C.useState(!1),[d,h]=C.useState(0),[f,p]=C.useState(!1),g=C.useRef(null),b=C.useRef(null),v=C.useRef(0),_=C.useCallback(()=>{b.current&&(b.current.style.transition="transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1), scale 0.2s ease",b.current.style.transform="translateX(0px) scale(1)"),h(0),c(!1)},[]),N=P=>{e||f||(c(!0),v.current="touches"in P?P.touches[0].clientX:P.clientX,b.current&&(b.current.style.transition="none",b.current.style.transform=`translateX(${d}px) scale(1.1)`))},j=C.useCallback(P=>{if(!l||!g.current||!b.current)return;const E=g.current.getBoundingClientRect(),M=b.current.getBoundingClientRect(),I=P-v.current;let O;r==="right"?O=Math.max(0,Math.min(I,E.width-M.width-8)):O=Math.min(0,Math.max(I,-(E.width-M.width-8))),h(O),b.current.style.transform=`translateX(${O}px) scale(1.1)`},[l,r]),k=C.useCallback(()=>{if(!l||!g.current||!b.current)return;c(!1);const P=g.current.getBoundingClientRect(),E=b.current.getBoundingClientRect(),M=(P.width-E.width)*.75;let I=!1;(r==="right"&&d>M||r==="left"&&d<-M)&&(I=!0),I?(p(!0),n()):_()},[l,d,n,r,_]);C.useEffect(()=>{const P=O=>j(O.clientX),E=O=>j(O.touches[0].clientX),M=()=>k(),I=()=>k();return l&&(window.addEventListener("mousemove",P),window.addEventListener("touchmove",E),window.addEventListener("mouseup",M),window.addEventListener("touchend",I)),()=>{window.removeEventListener("mousemove",P),window.removeEventListener("touchmove",E),window.removeEventListener("mouseup",M),window.removeEventListener("touchend",I)}},[l,j,k]),C.useEffect(()=>{!e&&f&&(p(!1),_())},[e,f,_]);const S=f&&!e;return a.jsxs("div",{ref:g,className:`fo-slider ${i} ${S?"success":""}`,onMouseDown:N,onTouchStart:N,children:[a.jsx("div",{ref:b,className:`fo-slider-thumb ${o} transition-all duration-200 ease-out shadow-md`,children:e&&f?a.jsx(Qe,{className:"h-6 w-6 animate-spin"}):r==="right"?a.jsx(_l,{className:"h-6 w-6"}):a.jsx(Ph,{className:"h-6 w-6"})}),a.jsx("span",{className:`fo-slider-text ${d!==0||e&&f?"opacity-0":"opacity-100"}`,children:t}),a.jsx("span",{className:`fo-slider-text absolute transition-opacity duration-300 ${e&&f?"opacity-100":"opacity-0"}`,children:s})]})},WX=Ke({name:ie().required("Name is required"),email:ie().email("Must be a valid email").required("Email is required"),phone:ie().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),GX=()=>{var Me,Oe,Je,dt,at,_t,J;const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:s,toggleCheckInStatus:r,logout:i,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=tt(),{permissions:d}=pa(),h=Vt(),{theme:f,setTheme:p,isAutomatic:g,setAutomatic:b}=Eh(),[v,_]=C.useState(!1),[N,j]=C.useState(!1),[k,S]=C.useState(null),[P,E]=C.useState("prompt"),I=Nt("(max-width: 767px)"),[O,D]=C.useState(!1),[z,H]=C.useState(!1),[F,R]=C.useState(null);C.useEffect(()=>{const K=async()=>{var oe;if(!((oe=navigator.permissions)!=null&&oe.query)){E("prompt");return}try{const we=await navigator.permissions.query({name:"camera"}),Se=await navigator.permissions.query({name:"geolocation"});we.state==="granted"&&Se.state==="granted"?E("granted"):we.state==="denied"||Se.state==="denied"?E("denied"):E("prompt");const _e=()=>K();we.onchange=_e,Se.onchange=_e}catch(we){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",we),E("prompt")}};K()},[]);const{register:V,handleSubmit:U,formState:{errors:W,isDirty:B},getValues:q,trigger:Q,reset:le}=xt({resolver:Lt(WX),defaultValues:{name:(n==null?void 0:n.name)||"",email:(n==null?void 0:n.email)||"",phone:(n==null?void 0:n.phone)||""}});C.useEffect(()=>{n&&le({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,le]);const X=async K=>{if(!n)return;const oe=n.photoUrl;e({photoUrl:K==null?void 0:K.preview});try{let we=null;K&&K.file&&(we=await new Promise((_e,Pe)=>{const Ue=new FileReader;Ue.onloadend=()=>_e(Ue.result),Ue.onerror=Pe,Ue.readAsDataURL(K.file)}));const Se=await te.updateUser(n.id,{photoUrl:we});e(Se),S({message:`Profile photo ${we?"updated":"removed"}.`,type:"success"})}catch(we){console.error(we),S({message:"Failed to save photo.",type:"error"}),e({photoUrl:oe})}},Z=async K=>{if(n){_(!0);try{const oe=await te.updateUser(n.id,K);e(oe),le(K),S({message:"Profile updated successfully!",type:"success"})}catch{S({message:"Failed to update profile.",type:"error"})}finally{_(!1)}}},se=async()=>{j(!0);const{success:K,message:oe}=await r();S({message:oe,type:K?"success":"error"}),j(!1)},G=()=>{R(t?"check-out":"check-in"),H(!0)},ne=async()=>{H(!1),await se(),R(null)},ge=()=>{H(!1),R(null)},ye=N||z,re=()=>{D(!0)},ae=async()=>{if(D(!1),B){_(!0),S({message:"Saving profile changes...",type:"success"});try{if(!await Q()){S({message:"Profile data is invalid. Please fix errors before logging out.",type:"error"}),_(!1);return}const oe=q(),we=await te.updateUser(n.id,oe);e(we),le(oe)}catch{S({message:"Failed to save profile. Logout aborted.",type:"error"}),_(!1);return}_(!1)}await i(),h("/auth/login",{replace:!0})},ve=K=>K?Ce(new Date(K),"hh:mm a"):"--:--";n&&((Me=d[n.role])==null||Me.includes("manage_tasks"));const pe=K=>K.replace(/_/g," ").replace(/\b\w/g,oe=>oe.toUpperCase());if(!n)return a.jsx("div",{children:"Loading user profile..."});const Ne=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return I?a.jsxs("div",{className:"p-4 space-y-8",children:[k&&a.jsx(gt,{message:k.message,type:k.type,onDismiss:()=>S(null)}),a.jsx(yn,{isOpen:O,onClose:()=>D(!1),onConfirm:ae,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),a.jsx(yn,{isOpen:z,onClose:ge,onConfirm:ne,title:`Confirm ${F==="check-in"?"Check In":"Check Out"}`,confirmButtonVariant:"primary",confirmButtonText:"Yes, Proceed",children:a.jsxs("p",{className:"text-center",children:["Are you sure you want to ",F==null?void 0:F.replace("-"," "),"?"]})}),a.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[a.jsx(e0,{file:Ne,onFileChange:X}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-2xl font-bold",children:n.name}),a.jsx("p",{className:"text-muted",children:n.role.replace(/_/g," ").replace(/\b\w/g,K=>K.toUpperCase())})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("section",{children:[a.jsx("h3",{className:"fo-section-title mb-4",children:"Profile Details"}),a.jsxs("form",{onSubmit:U(Z),className:"space-y-4",children:[a.jsx(he,{label:"Full Name",id:"name",error:(Oe=W.name)==null?void 0:Oe.message,registration:V("name")}),a.jsx(he,{label:"Email Address",id:"email",type:"email",error:(Je=W.email)==null?void 0:Je.message,registration:V("email"),readOnly:!0,className:"!bg-gray-700/50"}),a.jsx(he,{label:"Phone Number",id:"phone",type:"tel",error:(dt=W.phone)==null?void 0:dt.message,registration:V("phone")}),a.jsx("div",{className:"flex justify-end pt-2",children:a.jsx(Y,{type:"submit",isLoading:v,disabled:!B,children:"Save Changes"})})]})]}),a.jsxs("section",{className:"hidden md:block",children:[a.jsx("h3",{className:"fo-section-title mb-4",children:"Appearance"}),a.jsxs("div",{className:"p-4 rounded-lg bg-[#243524] border border-[#374151] space-y-4",children:[a.jsx(zt,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:g,onChange:K=>b(K.target.checked)}),a.jsx(zt,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:f==="dark",onChange:K=>p(K.target.checked?"dark":"light"),disabled:g})]})]}),a.jsxs("section",{children:[a.jsx("h3",{className:"fo-section-title mb-4",children:"Work Hours Tracking"}),a.jsxs("div",{className:"fo-attendance-card space-y-4",children:[a.jsxs("div",{className:"flex justify-around",children:[a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"fo-attendance-time",children:"Last Check In"}),a.jsx("p",{className:"fo-attendance-time",children:a.jsx("strong",{children:ve(o)})})]}),a.jsxs("div",{className:"text-center",children:[a.jsx("p",{className:"fo-attendance-time",children:"Last Check Out"}),a.jsx("p",{className:"fo-attendance-time",children:a.jsx("strong",{children:ve(l)})})]})]}),s?a.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin"})}):t?a.jsx(Kk,{onConfirm:G,isActionInProgress:ye,text:"Slide to Check Out",confirmText:N?"Checking Out...":"Confirm...",slideDirection:"left",className:"fo-slider--checkout"}):a.jsx(Kk,{onConfirm:G,isActionInProgress:ye,text:"Slide to Check In",confirmText:N?"Checking In...":"Confirm...",slideDirection:"right",className:"fo-slider--checkin"})]})]}),a.jsxs("section",{children:[a.jsx("h3",{className:"fo-section-title mb-4",children:"Account Actions"}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Y,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center !py-3",title:"View your leave history and balances",children:[a.jsx(Lb,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),a.jsxs(Y,{onClick:re,variant:"danger",className:"w-full justify-center !py-3",children:[a.jsx(Mu,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):a.jsxs("div",{className:"w-full space-y-8",children:[k&&a.jsx(gt,{message:k.message,type:k.type,onDismiss:()=>S(null)}),a.jsx(yn,{isOpen:O,onClose:()=>D(!1),onConfirm:ae,title:"Confirm Log Out",isConfirming:v,children:"Are you sure you want to log out? Any unsaved changes on this page will be automatically saved."}),a.jsx(yn,{isOpen:z,onClose:ge,onConfirm:ne,title:`Confirm ${F==="check-in"?"Check In":"Check Out"}`,confirmButtonVariant:"primary",confirmButtonText:"Yes, Proceed",children:a.jsxs("p",{className:"text-center",children:["Are you sure you want to ",F==null?void 0:F.replace("-"," "),"?"]})}),a.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[a.jsx("div",{className:"absolute top-0 left-0 w-full h-32 bg-[#006B3F] border-b-4 border-[#005632] shadow-lg"}),a.jsx("div",{className:"relative z-10",children:a.jsx(e0,{file:Ne,onFileChange:X})}),a.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[a.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-white tracking-tight",children:n.name}),a.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:a.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:pe(n.role)})}),a.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),a.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[a.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:a.jsx(yd,{className:"h-5 w-5 text-blue-600"})}),a.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),a.jsxs("form",{onSubmit:U(Z),className:"space-y-5",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[a.jsx(he,{label:"Full Name",id:"name",error:(at=W.name)==null?void 0:at.message,registration:V("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),a.jsx(he,{label:"Phone Number",id:"phone",type:"tel",error:(_t=W.phone)==null?void 0:_t.message,registration:V("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(he,{label:"Email Address",id:"email",type:"email",error:(J=W.email)==null?void 0:J.message,registration:V("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),a.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:a.jsx(Y,{type:"submit",isLoading:v,disabled:!B,className:"px-6",children:"Save Changes"})})]})]}),a.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[a.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[a.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:a.jsx(OD,{className:"h-5 w-5 text-purple-600"})}),a.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),a.jsxs("div",{className:"space-y-5",children:[a.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[a.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[a.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),a.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:ve(o)})]}),a.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[a.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),a.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:ve(l)})]})]}),s?a.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin text-gray-400"})}):t?a.jsxs(Y,{onClick:se,variant:"danger",className:"w-full !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",isLoading:ye,children:[a.jsx(Mu,{className:"mr-2 h-5 w-5"})," Check Out"]}):a.jsxs(Y,{onClick:se,variant:"primary",className:"w-full !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",isLoading:ye,children:[a.jsx(SZ,{className:"mr-2 h-5 w-5"})," Check In"]})]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:a.jsx(zt,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:g,onChange:K=>b(K.target.checked)})}),a.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:a.jsx(zt,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:f==="dark",onChange:K=>p(K.target.checked?"dark":"light"),disabled:g})})]})]}),a.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[a.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),a.jsxs("div",{className:"space-y-3",children:[a.jsxs(Y,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[a.jsx(Lb,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),a.jsxs(Y,{onClick:re,variant:"danger",className:"w-full justify-center py-3",isLoading:v,children:[a.jsx(Mu,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function $h(n){return n+.5|0}const Oa=(n,e,t)=>Math.max(Math.min(n,t),e);function hu(n){return Oa($h(n*2.55),0,255)}function Ja(n){return Oa($h(n*255),0,255)}function Gi(n){return Oa($h(n/2.55)/100,0,1)}function Jk(n){return Oa($h(n*100),0,100)}const yr={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},t0=[..."0123456789ABCDEF"],YX=n=>t0[n&15],ZX=n=>t0[(n&240)>>4]+t0[n&15],Hf=n=>(n&240)>>4===(n&15),KX=n=>Hf(n.r)&&Hf(n.g)&&Hf(n.b)&&Hf(n.a);function JX(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&yr[n[1]]*17,g:255&yr[n[2]]*17,b:255&yr[n[3]]*17,a:e===5?yr[n[4]]*17:255}:(e===7||e===9)&&(t={r:yr[n[1]]<<4|yr[n[2]],g:yr[n[3]]<<4|yr[n[4]],b:yr[n[5]]<<4|yr[n[6]],a:e===9?yr[n[7]]<<4|yr[n[8]]:255})),t}const QX=(n,e)=>n<255?e(n):"";function XX(n){var e=KX(n)?YX:ZX;return n?"#"+e(n.r)+e(n.g)+e(n.b)+QX(n.a,e):void 0}const eee=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function aI(n,e,t){const s=e*Math.min(t,1-t),r=(i,o=(i+n/30)%12)=>t-s*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function tee(n,e,t){const s=(r,i=(r+n/60)%6)=>t-t*e*Math.max(Math.min(i,4-i,1),0);return[s(5),s(3),s(1)]}function nee(n,e,t){const s=aI(n,1,.5);let r;for(e+t>1&&(r=1/(e+t),e*=r,t*=r),r=0;r<3;r++)s[r]*=1-e-t,s[r]+=e;return s}function see(n,e,t,s,r){return n===r?(e-t)/s+(e<t?6:0):e===r?(t-n)/s+2:(n-e)/s+4}function E_(n){const t=n.r/255,s=n.g/255,r=n.b/255,i=Math.max(t,s,r),o=Math.min(t,s,r),l=(i+o)/2;let c,d,h;return i!==o&&(h=i-o,d=l>.5?h/(2-i-o):h/(i+o),c=see(t,s,r,h,i),c=c*60+.5),[c|0,d||0,l]}function P_(n,e,t,s){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,s)).map(Ja)}function M_(n,e,t){return P_(aI,n,e,t)}function ree(n,e,t){return P_(nee,n,e,t)}function iee(n,e,t){return P_(tee,n,e,t)}function oI(n){return(n%360+360)%360}function aee(n){const e=eee.exec(n);let t=255,s;if(!e)return;e[5]!==s&&(t=e[6]?hu(+e[5]):Ja(+e[5]));const r=oI(+e[2]),i=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?s=ree(r,i,o):e[1]==="hsv"?s=iee(r,i,o):s=M_(r,i,o),{r:s[0],g:s[1],b:s[2],a:t}}function oee(n,e){var t=E_(n);t[0]=oI(t[0]+e),t=M_(t),n.r=t[0],n.g=t[1],n.b=t[2]}function lee(n){if(!n)return;const e=E_(n),t=e[0],s=Jk(e[1]),r=Jk(e[2]);return n.a<255?`hsla(${t}, ${s}%, ${r}%, ${Gi(n.a)})`:`hsl(${t}, ${s}%, ${r}%)`}const Qk={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Xk={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function cee(){const n={},e=Object.keys(Xk),t=Object.keys(Qk);let s,r,i,o,l;for(s=0;s<e.length;s++){for(o=l=e[s],r=0;r<t.length;r++)i=t[r],l=l.replace(i,Qk[i]);i=parseInt(Xk[o],16),n[l]=[i>>16&255,i>>8&255,i&255]}return n}let Wf;function dee(n){Wf||(Wf=cee(),Wf.transparent=[0,0,0,0]);const e=Wf[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const uee=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function hee(n){const e=uee.exec(n);let t=255,s,r,i;if(e){if(e[7]!==s){const o=+e[7];t=e[8]?hu(o):Oa(o*255,0,255)}return s=+e[1],r=+e[3],i=+e[5],s=255&(e[2]?hu(s):Oa(s,0,255)),r=255&(e[4]?hu(r):Oa(r,0,255)),i=255&(e[6]?hu(i):Oa(i,0,255)),{r:s,g:r,b:i,a:t}}}function fee(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Gi(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const Ix=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,rc=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function mee(n,e,t){const s=rc(Gi(n.r)),r=rc(Gi(n.g)),i=rc(Gi(n.b));return{r:Ja(Ix(s+t*(rc(Gi(e.r))-s))),g:Ja(Ix(r+t*(rc(Gi(e.g))-r))),b:Ja(Ix(i+t*(rc(Gi(e.b))-i))),a:n.a+t*(e.a-n.a)}}function Gf(n,e,t){if(n){let s=E_(n);s[e]=Math.max(0,Math.min(s[e]+s[e]*t,e===0?360:1)),s=M_(s),n.r=s[0],n.g=s[1],n.b=s[2]}}function lI(n,e){return n&&Object.assign(e||{},n)}function e1(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Ja(n[3]))):(e=lI(n,{r:0,g:0,b:0,a:1}),e.a=Ja(e.a)),e}function pee(n){return n.charAt(0)==="r"?hee(n):aee(n)}class hh{constructor(e){if(e instanceof hh)return e;const t=typeof e;let s;t==="object"?s=e1(e):t==="string"&&(s=JX(e)||dee(e)||pee(e)),this._rgb=s,this._valid=!!s}get valid(){return this._valid}get rgb(){var e=lI(this._rgb);return e&&(e.a=Gi(e.a)),e}set rgb(e){this._rgb=e1(e)}rgbString(){return this._valid?fee(this._rgb):void 0}hexString(){return this._valid?XX(this._rgb):void 0}hslString(){return this._valid?lee(this._rgb):void 0}mix(e,t){if(e){const s=this.rgb,r=e.rgb;let i;const o=t===i?.5:t,l=2*o-1,c=s.a-r.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;i=1-d,s.r=255&d*s.r+i*r.r+.5,s.g=255&d*s.g+i*r.g+.5,s.b=255&d*s.b+i*r.b+.5,s.a=o*s.a+(1-o)*r.a,this.rgb=s}return this}interpolate(e,t){return e&&(this._rgb=mee(this._rgb,e._rgb,t)),this}clone(){return new hh(this.rgb)}alpha(e){return this._rgb.a=Ja(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=$h(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Gf(this._rgb,2,e),this}darken(e){return Gf(this._rgb,2,-e),this}saturate(e){return Gf(this._rgb,1,e),this}desaturate(e){return Gf(this._rgb,1,-e),this}rotate(e){return oee(this._rgb,e),this}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function $i(){}const gee=(()=>{let n=0;return()=>n++})();function At(n){return n==null}function On(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function bt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function ds(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function ci(n,e){return ds(n)?n:e}function mt(n,e){return typeof n>"u"?e:n}const yee=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,cI=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Xt(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function It(n,e,t,s){let r,i,o;if(On(n))for(i=n.length,r=0;r<i;r++)e.call(t,n[r],r);else if(bt(n))for(o=Object.keys(n),i=o.length,r=0;r<i;r++)e.call(t,n[o[r]],o[r])}function Up(n,e){let t,s,r,i;if(!n||!e||n.length!==e.length)return!1;for(t=0,s=n.length;t<s;++t)if(r=n[t],i=e[t],r.datasetIndex!==i.datasetIndex||r.index!==i.index)return!1;return!0}function Vp(n){if(On(n))return n.map(Vp);if(bt(n)){const e=Object.create(null),t=Object.keys(n),s=t.length;let r=0;for(;r<s;++r)e[t[r]]=Vp(n[t[r]]);return e}return n}function dI(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function xee(n,e,t,s){if(!dI(n))return;const r=e[n],i=t[n];bt(r)&&bt(i)?fh(r,i,s):e[n]=Vp(i)}function fh(n,e,t){const s=On(e)?e:[e],r=s.length;if(!bt(n))return n;t=t||{};const i=t.merger||xee;let o;for(let l=0;l<r;++l){if(o=s[l],!bt(o))continue;const c=Object.keys(o);for(let d=0,h=c.length;d<h;++d)i(c[d],n,o,t)}return n}function Du(n,e){return fh(n,e,{merger:vee})}function vee(n,e,t){if(!dI(n))return;const s=e[n],r=t[n];bt(s)&&bt(r)?Du(s,r):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Vp(r))}const t1={"":n=>n,x:n=>n.x,y:n=>n.y};function bee(n){const e=n.split("."),t=[];let s="";for(const r of e)s+=r,s.endsWith("\\")?s=s.slice(0,-1)+".":(t.push(s),s="");return t}function wee(n){const e=bee(n);return t=>{for(const s of e){if(s==="")break;t=t&&t[s]}return t}}function Sl(n,e){return(t1[e]||(t1[e]=wee(e)))(n)}function D_(n){return n.charAt(0).toUpperCase()+n.slice(1)}const mh=n=>typeof n<"u",lo=n=>typeof n=="function",n1=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function _ee(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const Ut=Math.PI,hn=2*Ut,See=hn+Ut,Bp=Number.POSITIVE_INFINITY,Nee=Ut/180,Ln=Ut/2,Lo=Ut/4,s1=Ut*2/3,uI=Math.log10,ki=Math.sign;function Au(n,e,t){return Math.abs(n-e)<t}function r1(n){const e=Math.round(n);n=Au(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(uI(n))),s=n/t;return(s<=1?1:s<=2?2:s<=5?5:10)*t}function jee(n){const e=[],t=Math.sqrt(n);let s;for(s=1;s<t;s++)n%s===0&&(e.push(s),e.push(n/s));return t===(t|0)&&e.push(t),e.sort((r,i)=>r-i).pop(),e}function Cee(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function ph(n){return!Cee(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function kee(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function Tee(n,e,t){let s,r,i;for(s=0,r=n.length;s<r;s++)i=n[s][t],isNaN(i)||(e.min=Math.min(e.min,i),e.max=Math.max(e.max,i))}function Ji(n){return n*(Ut/180)}function Eee(n){return n*(180/Ut)}function i1(n){if(!ds(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function hI(n,e){const t=e.x-n.x,s=e.y-n.y,r=Math.sqrt(t*t+s*s);let i=Math.atan2(s,t);return i<-.5*Ut&&(i+=hn),{angle:i,distance:r}}function n0(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function Pee(n,e){return(n-e+See)%hn-Ut}function Qs(n){return(n%hn+hn)%hn}function gh(n,e,t,s){const r=Qs(n),i=Qs(e),o=Qs(t),l=Qs(i-r),c=Qs(o-r),d=Qs(r-i),h=Qs(r-o);return r===i||r===o||s&&i===o||l>c&&d<h}function os(n,e,t){return Math.max(e,Math.min(t,n))}function Mee(n){return os(n,-32768,32767)}function Qi(n,e,t,s=1e-6){return n>=Math.min(e,t)-s&&n<=Math.max(e,t)+s}function A_(n,e,t){t=t||(o=>n[o]<e);let s=n.length-1,r=0,i;for(;s-r>1;)i=r+s>>1,t(i)?r=i:s=i;return{lo:r,hi:s}}const rl=(n,e,t,s)=>A_(n,t,s?r=>{const i=n[r][e];return i<t||i===t&&n[r+1][e]===t}:r=>n[r][e]<t),Dee=(n,e,t)=>A_(n,t,s=>n[s][e]>=t);function Aee(n,e,t){let s=0,r=n.length;for(;s<r&&n[s]<e;)s++;for(;r>s&&n[r-1]>t;)r--;return s>0||r<n.length?n.slice(s,r):n}const fI=["push","pop","shift","splice","unshift"];function Iee(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),fI.forEach(t=>{const s="_onData"+D_(t),r=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...i){const o=r.apply(this,i);return n._chartjs.listeners.forEach(l=>{typeof l[s]=="function"&&l[s](...i)}),o}})})}function a1(n,e){const t=n._chartjs;if(!t)return;const s=t.listeners,r=s.indexOf(e);r!==-1&&s.splice(r,1),!(s.length>0)&&(fI.forEach(i=>{delete n[i]}),delete n._chartjs)}function mI(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const pI=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function gI(n,e){let t=[],s=!1;return function(...r){t=r,s||(s=!0,pI.call(window,()=>{s=!1,n.apply(e,t)}))}}function Oee(n,e){let t;return function(...s){return e?(clearTimeout(t),t=setTimeout(n,e,s)):n.apply(this,s),e}}const yI=n=>n==="start"?"left":n==="end"?"right":"center",Zs=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,Ree=(n,e,t,s)=>n===(s?"left":"right")?t:n==="center"?(e+t)/2:e;function Lee(n,e,t){const s=e.length;let r=0,i=s;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:f,max:p,minDefined:g,maxDefined:b}=o.getUserBounds();if(g){if(r=Math.min(rl(c,h,f).lo,t?s:rl(e,h,o.getPixelForValue(f)).lo),d){const v=c.slice(0,r+1).reverse().findIndex(_=>!At(_[l.axis]));r-=Math.max(0,v)}r=os(r,0,s-1)}if(b){let v=Math.max(rl(c,o.axis,p,!0).hi+1,t?0:rl(e,h,o.getPixelForValue(p),!0).hi+1);if(d){const _=c.slice(v-1).findIndex(N=>!At(N[l.axis]));v+=Math.max(0,_)}i=os(v,r,s)-r}else i=s-r}return{start:r,count:i}}function Fee(n){const{xScale:e,yScale:t,_scaleRanges:s}=n,r={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!s)return n._scaleRanges=r,!0;const i=s.xmin!==e.min||s.xmax!==e.max||s.ymin!==t.min||s.ymax!==t.max;return Object.assign(s,r),i}const Yf=n=>n===0||n===1,o1=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*hn/t)),l1=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*hn/t)+1,Iu={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Ln)+1,easeOutSine:n=>Math.sin(n*Ln),easeInOutSine:n=>-.5*(Math.cos(Ut*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Yf(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Yf(n)?n:o1(n,.075,.3),easeOutElastic:n=>Yf(n)?n:l1(n,.075,.3),easeInOutElastic(n){return Yf(n)?n:n<.5?.5*o1(n*2,.1125,.45):.5+.5*l1(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-Iu.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Iu.easeInBounce(n*2)*.5:Iu.easeOutBounce(n*2-1)*.5+.5};function I_(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function c1(n){return I_(n)?n:new hh(n)}function Ox(n){return I_(n)?n:new hh(n).saturate(.5).darken(.1).hexString()}const $ee=["x","y","borderWidth","radius","tension"],zee=["color","borderColor","backgroundColor"];function Uee(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:zee},numbers:{type:"number",properties:$ee}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Vee(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const d1=new Map;function Bee(n,e){e=e||{};const t=n+JSON.stringify(e);let s=d1.get(t);return s||(s=new Intl.NumberFormat(n,e),d1.set(t,s)),s}function O_(n,e,t){return Bee(e,t).format(n)}const qee={values(n){return On(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const s=this.chart.options.locale;let r,i=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(r="scientific"),i=Hee(n,t)}const o=uI(Math.abs(i)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),O_(n,s,c)}};function Hee(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var xI={formatters:qee};function Wee(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:xI.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Nl=Object.create(null),s0=Object.create(null);function Ou(n,e){if(!e)return n;const t=e.split(".");for(let s=0,r=t.length;s<r;++s){const i=t[s];n=n[i]||(n[i]=Object.create(null))}return n}function Rx(n,e,t){return typeof e=="string"?fh(Ou(n,e),t):fh(Ou(n,""),e)}class Gee{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=s=>s.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(s,r)=>Ox(r.backgroundColor),this.hoverBorderColor=(s,r)=>Ox(r.borderColor),this.hoverColor=(s,r)=>Ox(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return Rx(this,e,t)}get(e){return Ou(this,e)}describe(e,t){return Rx(s0,e,t)}override(e,t){return Rx(Nl,e,t)}route(e,t,s,r){const i=Ou(this,e),o=Ou(this,s),l="_"+t;Object.defineProperties(i,{[l]:{value:i[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[r];return bt(c)?Object.assign({},d,c):mt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var Nn=new Gee({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Uee,Vee,Wee]);function Yee(n){return!n||At(n.size)||At(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function u1(n,e,t,s,r){let i=e[r];return i||(i=e[r]=n.measureText(r).width,t.push(r)),i>s&&(s=i),s}function Fo(n,e,t){const s=n.currentDevicePixelRatio,r=t!==0?Math.max(t/2,.5):0;return Math.round((e-r)*s)/s+r}function h1(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function r0(n,e,t,s){vI(n,e,t,s,null)}function vI(n,e,t,s,r){let i,o,l,c,d,h,f,p;const g=e.pointStyle,b=e.rotation,v=e.radius;let _=(b||0)*Nee;if(g&&typeof g=="object"&&(i=g.toString(),i==="[object HTMLImageElement]"||i==="[object HTMLCanvasElement]")){n.save(),n.translate(t,s),n.rotate(_),n.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),g){default:r?n.ellipse(t,s,r/2,v,0,0,hn):n.arc(t,s,v,0,hn),n.closePath();break;case"triangle":h=r?r/2:v,n.moveTo(t+Math.sin(_)*h,s-Math.cos(_)*v),_+=s1,n.lineTo(t+Math.sin(_)*h,s-Math.cos(_)*v),_+=s1,n.lineTo(t+Math.sin(_)*h,s-Math.cos(_)*v),n.closePath();break;case"rectRounded":d=v*.516,c=v-d,o=Math.cos(_+Lo)*c,f=Math.cos(_+Lo)*(r?r/2-d:c),l=Math.sin(_+Lo)*c,p=Math.sin(_+Lo)*(r?r/2-d:c),n.arc(t-f,s-l,d,_-Ut,_-Ln),n.arc(t+p,s-o,d,_-Ln,_),n.arc(t+f,s+l,d,_,_+Ln),n.arc(t-p,s+o,d,_+Ln,_+Ut),n.closePath();break;case"rect":if(!b){c=Math.SQRT1_2*v,h=r?r/2:c,n.rect(t-h,s-c,2*h,2*c);break}_+=Lo;case"rectRot":f=Math.cos(_)*(r?r/2:v),o=Math.cos(_)*v,l=Math.sin(_)*v,p=Math.sin(_)*(r?r/2:v),n.moveTo(t-f,s-l),n.lineTo(t+p,s-o),n.lineTo(t+f,s+l),n.lineTo(t-p,s+o),n.closePath();break;case"crossRot":_+=Lo;case"cross":f=Math.cos(_)*(r?r/2:v),o=Math.cos(_)*v,l=Math.sin(_)*v,p=Math.sin(_)*(r?r/2:v),n.moveTo(t-f,s-l),n.lineTo(t+f,s+l),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o);break;case"star":f=Math.cos(_)*(r?r/2:v),o=Math.cos(_)*v,l=Math.sin(_)*v,p=Math.sin(_)*(r?r/2:v),n.moveTo(t-f,s-l),n.lineTo(t+f,s+l),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o),_+=Lo,f=Math.cos(_)*(r?r/2:v),o=Math.cos(_)*v,l=Math.sin(_)*v,p=Math.sin(_)*(r?r/2:v),n.moveTo(t-f,s-l),n.lineTo(t+f,s+l),n.moveTo(t+p,s-o),n.lineTo(t-p,s+o);break;case"line":o=r?r/2:Math.cos(_)*v,l=Math.sin(_)*v,n.moveTo(t-o,s-l),n.lineTo(t+o,s+l);break;case"dash":n.moveTo(t,s),n.lineTo(t+Math.cos(_)*(r?r/2:v),s+Math.sin(_)*v);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function yh(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function Zg(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Kg(n){n.restore()}function Zee(n,e,t,s,r){if(!e)return n.lineTo(t.x,t.y);if(r==="middle"){const i=(e.x+t.x)/2;n.lineTo(i,e.y),n.lineTo(i,t.y)}else r==="after"!=!!s?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function Kee(n,e,t,s){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(s?e.cp1x:e.cp2x,s?e.cp1y:e.cp2y,s?t.cp2x:t.cp1x,s?t.cp2y:t.cp1y,t.x,t.y)}function Jee(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),At(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Qee(n,e,t,s,r){if(r.strikethrough||r.underline){const i=n.measureText(s),o=e-i.actualBoundingBoxLeft,l=e+i.actualBoundingBoxRight,c=t-i.actualBoundingBoxAscent,d=t+i.actualBoundingBoxDescent,h=r.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,h),n.lineTo(l,h),n.stroke()}}function Xee(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function qp(n,e,t,s,r,i={}){const o=On(e)?e:[e],l=i.strokeWidth>0&&i.strokeColor!=="";let c,d;for(n.save(),n.font=r.string,Jee(n,i),c=0;c<o.length;++c)d=o[c],i.backdrop&&Xee(n,i.backdrop),l&&(i.strokeColor&&(n.strokeStyle=i.strokeColor),At(i.strokeWidth)||(n.lineWidth=i.strokeWidth),n.strokeText(d,t,s,i.maxWidth)),n.fillText(d,t,s,i.maxWidth),Qee(n,t,s,d,i),s+=Number(r.lineHeight);n.restore()}function Hp(n,e){const{x:t,y:s,w:r,h:i,radius:o}=e;n.arc(t+o.topLeft,s+o.topLeft,o.topLeft,1.5*Ut,Ut,!0),n.lineTo(t,s+i-o.bottomLeft),n.arc(t+o.bottomLeft,s+i-o.bottomLeft,o.bottomLeft,Ut,Ln,!0),n.lineTo(t+r-o.bottomRight,s+i),n.arc(t+r-o.bottomRight,s+i-o.bottomRight,o.bottomRight,Ln,0,!0),n.lineTo(t+r,s+o.topRight),n.arc(t+r-o.topRight,s+o.topRight,o.topRight,0,-Ln,!0),n.lineTo(t+o.topLeft,s)}const ete=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,tte=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function nte(n,e){const t=(""+n).match(ete);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const ste=n=>+n||0;function R_(n,e){const t={},s=bt(e),r=s?Object.keys(e):e,i=bt(n)?s?o=>mt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of r)t[o]=ste(i(o));return t}function bI(n){return R_(n,{top:"y",right:"x",bottom:"y",left:"x"})}function Lc(n){return R_(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Xr(n){const e=bI(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Ls(n,e){n=n||{},e=e||Nn.font;let t=mt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let s=mt(n.style,e.style);s&&!(""+s).match(tte)&&(console.warn('Invalid font style specified: "'+s+'"'),s=void 0);const r={family:mt(n.family,e.family),lineHeight:nte(mt(n.lineHeight,e.lineHeight),t),size:t,style:s,weight:mt(n.weight,e.weight),string:""};return r.string=Yee(r),r}function Zf(n,e,t,s){let r,i,o;for(r=0,i=n.length;r<i;++r)if(o=n[r],o!==void 0&&o!==void 0)return o}function rte(n,e,t){const{min:s,max:r}=n,i=cI(e,(r-s)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(s,-Math.abs(i)),max:o(r,i)}}function Rl(n,e){return Object.assign(Object.create(n),e)}function L_(n,e=[""],t,s,r=()=>n[0]){const i=t||n;typeof s>"u"&&(s=NI("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:i,_fallback:s,_getTarget:r,override:l=>L_([l,...n],e,i,s)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return _I(l,c,()=>hte(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return m1(l).includes(c)},ownKeys(l){return m1(l)},set(l,c,d){const h=l._storage||(l._storage=r());return l[c]=h[c]=d,delete l._keys,!0}})}function id(n,e,t,s){const r={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:wI(n,s),setContext:i=>id(n,i,t,s),override:i=>id(n.override(i),e,t,s)};return new Proxy(r,{deleteProperty(i,o){return delete i[o],delete n[o],!0},get(i,o,l){return _I(i,o,()=>ate(i,o,l))},getOwnPropertyDescriptor(i,o){return i._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(i,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(i,o,l){return n[o]=l,delete i[o],!0}})}function wI(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:s=e.indexable,_allKeys:r=e.allKeys}=n;return{allKeys:r,scriptable:t,indexable:s,isScriptable:lo(t)?t:()=>t,isIndexable:lo(s)?s:()=>s}}const ite=(n,e)=>n?n+D_(e):e,F_=(n,e)=>bt(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function _I(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const s=t();return n[e]=s,s}function ate(n,e,t){const{_proxy:s,_context:r,_subProxy:i,_descriptors:o}=n;let l=s[e];return lo(l)&&o.isScriptable(e)&&(l=ote(e,l,n,t)),On(l)&&l.length&&(l=lte(e,l,n,o.isIndexable)),F_(e,l)&&(l=id(l,r,i&&i[e],o)),l}function ote(n,e,t,s){const{_proxy:r,_context:i,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(i,o||s);return l.delete(n),F_(n,c)&&(c=$_(r._scopes,r,n,c)),c}function lte(n,e,t,s){const{_proxy:r,_context:i,_subProxy:o,_descriptors:l}=t;if(typeof i.index<"u"&&s(n))return e[i.index%e.length];if(bt(e[0])){const c=e,d=r._scopes.filter(h=>h!==c);e=[];for(const h of c){const f=$_(d,r,n,h);e.push(id(f,i,o&&o[n],l))}}return e}function SI(n,e,t){return lo(n)?n(e,t):n}const cte=(n,e)=>n===!0?e:typeof n=="string"?Sl(e,n):void 0;function dte(n,e,t,s,r){for(const i of e){const o=cte(t,i);if(o){n.add(o);const l=SI(o._fallback,t,r);if(typeof l<"u"&&l!==t&&l!==s)return l}else if(o===!1&&typeof s<"u"&&t!==s)return null}return!1}function $_(n,e,t,s){const r=e._rootScopes,i=SI(e._fallback,t,s),o=[...n,...r],l=new Set;l.add(s);let c=f1(l,o,t,i||t,s);return c===null||typeof i<"u"&&i!==t&&(c=f1(l,o,i,c,s),c===null)?!1:L_(Array.from(l),[""],r,i,()=>ute(e,t,s))}function f1(n,e,t,s,r){for(;t;)t=dte(n,e,t,s,r);return t}function ute(n,e,t){const s=n._getTarget();e in s||(s[e]={});const r=s[e];return On(r)&&bt(t)?t:r||{}}function hte(n,e,t,s){let r;for(const i of e)if(r=NI(ite(i,n),t),typeof r<"u")return F_(n,r)?$_(t,s,n,r):r}function NI(n,e){for(const t of e){if(!t)continue;const s=t[n];if(typeof s<"u")return s}}function m1(n){let e=n._keys;return e||(e=n._keys=fte(n._scopes)),e}function fte(n){const e=new Set;for(const t of n)for(const s of Object.keys(t).filter(r=>!r.startsWith("_")))e.add(s);return Array.from(e)}const mte=Number.EPSILON||1e-14,ad=(n,e)=>e<n.length&&!n[e].skip&&n[e],jI=n=>n==="x"?"y":"x";function pte(n,e,t,s){const r=n.skip?e:n,i=e,o=t.skip?e:t,l=n0(i,r),c=n0(o,i);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const f=s*d,p=s*h;return{previous:{x:i.x-f*(o.x-r.x),y:i.y-f*(o.y-r.y)},next:{x:i.x+p*(o.x-r.x),y:i.y+p*(o.y-r.y)}}}function gte(n,e,t){const s=n.length;let r,i,o,l,c,d=ad(n,0);for(let h=0;h<s-1;++h)if(c=d,d=ad(n,h+1),!(!c||!d)){if(Au(e[h],0,mte)){t[h]=t[h+1]=0;continue}r=t[h]/e[h],i=t[h+1]/e[h],l=Math.pow(r,2)+Math.pow(i,2),!(l<=9)&&(o=3/Math.sqrt(l),t[h]=r*o*e[h],t[h+1]=i*o*e[h])}}function yte(n,e,t="x"){const s=jI(t),r=n.length;let i,o,l,c=ad(n,0);for(let d=0;d<r;++d){if(o=l,l=c,c=ad(n,d+1),!l)continue;const h=l[t],f=l[s];o&&(i=(h-o[t])/3,l[`cp1${t}`]=h-i,l[`cp1${s}`]=f-i*e[d]),c&&(i=(c[t]-h)/3,l[`cp2${t}`]=h+i,l[`cp2${s}`]=f+i*e[d])}}function xte(n,e="x"){const t=jI(e),s=n.length,r=Array(s).fill(0),i=Array(s);let o,l,c,d=ad(n,0);for(o=0;o<s;++o)if(l=c,c=d,d=ad(n,o+1),!!c){if(d){const h=d[e]-c[e];r[o]=h!==0?(d[t]-c[t])/h:0}i[o]=l?d?ki(r[o-1])!==ki(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}gte(n,r,i),yte(n,i,e)}function Kf(n,e,t){return Math.max(Math.min(n,t),e)}function vte(n,e){let t,s,r,i,o,l=yh(n[0],e);for(t=0,s=n.length;t<s;++t)o=i,i=l,l=t<s-1&&yh(n[t+1],e),i&&(r=n[t],o&&(r.cp1x=Kf(r.cp1x,e.left,e.right),r.cp1y=Kf(r.cp1y,e.top,e.bottom)),l&&(r.cp2x=Kf(r.cp2x,e.left,e.right),r.cp2y=Kf(r.cp2y,e.top,e.bottom)))}function bte(n,e,t,s,r){let i,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")xte(n,r);else{let d=s?n[n.length-1]:n[0];for(i=0,o=n.length;i<o;++i)l=n[i],c=pte(d,l,n[Math.min(i+1,o-(s?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&vte(n,t)}function z_(){return typeof window<"u"&&typeof document<"u"}function U_(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function Wp(n,e,t){let s;return typeof n=="string"?(s=parseInt(n,10),n.indexOf("%")!==-1&&(s=s/100*e.parentNode[t])):s=n,s}const Jg=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function wte(n,e){return Jg(n).getPropertyValue(e)}const _te=["top","right","bottom","left"];function dl(n,e,t){const s={};t=t?"-"+t:"";for(let r=0;r<4;r++){const i=_te[r];s[i]=parseFloat(n[e+"-"+i+t])||0}return s.width=s.left+s.right,s.height=s.top+s.bottom,s}const Ste=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function Nte(n,e){const t=n.touches,s=t&&t.length?t[0]:n,{offsetX:r,offsetY:i}=s;let o=!1,l,c;if(Ste(r,i,n.target))l=r,c=i;else{const d=e.getBoundingClientRect();l=s.clientX-d.left,c=s.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function Wo(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:s}=e,r=Jg(t),i=r.boxSizing==="border-box",o=dl(r,"padding"),l=dl(r,"border","width"),{x:c,y:d,box:h}=Nte(n,t),f=o.left+(h&&l.left),p=o.top+(h&&l.top);let{width:g,height:b}=e;return i&&(g-=o.width+l.width,b-=o.height+l.height),{x:Math.round((c-f)/g*t.width/s),y:Math.round((d-p)/b*t.height/s)}}function jte(n,e,t){let s,r;if(e===void 0||t===void 0){const i=n&&U_(n);if(!i)e=n.clientWidth,t=n.clientHeight;else{const o=i.getBoundingClientRect(),l=Jg(i),c=dl(l,"border","width"),d=dl(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,s=Wp(l.maxWidth,i,"clientWidth"),r=Wp(l.maxHeight,i,"clientHeight")}}return{width:e,height:t,maxWidth:s||Bp,maxHeight:r||Bp}}const Ra=n=>Math.round(n*10)/10;function Cte(n,e,t,s){const r=Jg(n),i=dl(r,"margin"),o=Wp(r.maxWidth,n,"clientWidth")||Bp,l=Wp(r.maxHeight,n,"clientHeight")||Bp,c=jte(n,e,t);let{width:d,height:h}=c;if(r.boxSizing==="content-box"){const p=dl(r,"border","width"),g=dl(r,"padding");d-=g.width+p.width,h-=g.height+p.height}return d=Math.max(0,d-i.width),h=Math.max(0,s?d/s:h-i.height),d=Ra(Math.min(d,o,c.maxWidth)),h=Ra(Math.min(h,l,c.maxHeight)),d&&!h&&(h=Ra(d/2)),(e!==void 0||t!==void 0)&&s&&c.height&&h>c.height&&(h=c.height,d=Ra(Math.floor(h*s))),{width:d,height:h}}function p1(n,e,t){const s=e||1,r=Ra(n.height*s),i=Ra(n.width*s);n.height=Ra(n.height),n.width=Ra(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==s||o.height!==r||o.width!==i?(n.currentDevicePixelRatio=s,o.height=r,o.width=i,n.ctx.setTransform(s,0,0,s,0,0),!0):!1}const kte=function(){let n=!1;try{const e={get passive(){return n=!0,!1}};z_()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n}();function g1(n,e){const t=wte(n,e),s=t&&t.match(/^(\d+)(\.\d+)?px$/);return s?+s[1]:void 0}function Go(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function Tte(n,e,t,s){return{x:n.x+t*(e.x-n.x),y:s==="middle"?t<.5?n.y:e.y:s==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function Ete(n,e,t,s){const r={x:n.cp2x,y:n.cp2y},i={x:e.cp1x,y:e.cp1y},o=Go(n,r,t),l=Go(r,i,t),c=Go(i,e,t),d=Go(o,l,t),h=Go(l,c,t);return Go(d,h,t)}const Pte=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,s){return t-s},leftForLtr(t,s){return t-s}}},Mte=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function Fc(n,e,t){return n?Pte(e,t):Mte()}function CI(n,e){let t,s;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,s=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=s)}function kI(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function TI(n){return n==="angle"?{between:gh,compare:Pee,normalize:Qs}:{between:Qi,compare:(e,t)=>e-t,normalize:e=>e}}function y1({start:n,end:e,count:t,loop:s,style:r}){return{start:n%t,end:e%t,loop:s&&(e-n+1)%t===0,style:r}}function Dte(n,e,t){const{property:s,start:r,end:i}=t,{between:o,normalize:l}=TI(s),c=e.length;let{start:d,end:h,loop:f}=n,p,g;if(f){for(d+=c,h+=c,p=0,g=c;p<g&&o(l(e[d%c][s]),r,i);++p)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:f,style:n.style}}function EI(n,e,t){if(!t)return[n];const{property:s,start:r,end:i}=t,o=e.length,{compare:l,between:c,normalize:d}=TI(s),{start:h,end:f,loop:p,style:g}=Dte(n,e,t),b=[];let v=!1,_=null,N,j,k;const S=()=>c(r,k,N)&&l(r,k)!==0,P=()=>l(i,N)===0||c(i,k,N),E=()=>v||S(),M=()=>!v||P();for(let I=h,O=h;I<=f;++I)j=e[I%o],!j.skip&&(N=d(j[s]),N!==k&&(v=c(N,r,i),_===null&&E()&&(_=l(N,r)===0?I:O),_!==null&&M()&&(b.push(y1({start:_,end:I,loop:p,count:o,style:g})),_=null),O=I,k=N));return _!==null&&b.push(y1({start:_,end:f,loop:p,count:o,style:g})),b}function PI(n,e){const t=[],s=n.segments;for(let r=0;r<s.length;r++){const i=EI(s[r],n.points,e);i.length&&t.push(...i)}return t}function Ate(n,e,t,s){let r=0,i=e-1;if(t&&!s)for(;r<e&&!n[r].skip;)r++;for(;r<e&&n[r].skip;)r++;for(r%=e,t&&(i+=r);i>r&&n[i%e].skip;)i--;return i%=e,{start:r,end:i}}function Ite(n,e,t,s){const r=n.length,i=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%r];d.skip||d.stop?l.skip||(s=!1,i.push({start:e%r,end:(c-1)%r,loop:s}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&i.push({start:e%r,end:o%r,loop:s}),i}function Ote(n,e){const t=n.points,s=n.options.spanGaps,r=t.length;if(!r)return[];const i=!!n._loop,{start:o,end:l}=Ate(t,r,i,s);if(s===!0)return x1(n,[{start:o,end:l,loop:i}],t,e);const c=l<o?l+r:l,d=!!n._fullLoop&&o===0&&l===r-1;return x1(n,Ite(t,o,c,d),t,e)}function x1(n,e,t,s){return!s||!s.setContext||!t?e:Rte(n,e,t,s)}function Rte(n,e,t,s){const r=n._chart.getContext(),i=v1(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let h=i,f=e[0].start,p=f;function g(b,v,_,N){const j=l?-1:1;if(b!==v){for(b+=c;t[b%c].skip;)b-=j;for(;t[v%c].skip;)v+=j;b%c!==v%c&&(d.push({start:b%c,end:v%c,loop:_,style:N}),h=N,f=v%c)}}for(const b of e){f=l?f:b.start;let v=t[f%c],_;for(p=f+1;p<=b.end;p++){const N=t[p%c];_=v1(s.setContext(Rl(r,{type:"segment",p0:v,p1:N,p0DataIndex:(p-1)%c,p1DataIndex:p%c,datasetIndex:o}))),Lte(_,h)&&g(f,p-1,b.loop,h),v=N,h=_}f<p-1&&g(f,p-1,b.loop,h)}return d}function v1(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function Lte(n,e){if(!e)return!1;const t=[],s=function(r,i){return I_(i)?(t.includes(i)||t.push(i),t.indexOf(i)):i};return JSON.stringify(n,s)!==JSON.stringify(e,s)}function Jf(n,e,t){return n.options.clip?n[t]:e[t]}function Fte(n,e){const{xScale:t,yScale:s}=n;return t&&s?{left:Jf(t,e,"left"),right:Jf(t,e,"right"),top:Jf(s,e,"top"),bottom:Jf(s,e,"bottom")}:e}function MI(n,e){const t=e._clip;if(t.disabled)return!1;const s=Fte(e,n.chartArea);return{left:t.left===!1?0:s.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:s.right+(t.right===!0?0:t.right),top:t.top===!1?0:s.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:s.bottom+(t.bottom===!0?0:t.bottom)}}/*!
 * Chart.js v4.5.1
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class $te{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,s,r){const i=t.listeners[r],o=t.duration;i.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(s-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=pI.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((s,r)=>{if(!s.running||!s.items.length)return;const i=s.items;let o=i.length-1,l=!1,c;for(;o>=0;--o)c=i[o],c._active?(c._total>s.duration&&(s.duration=c._total),c.tick(e),l=!0):(i[o]=i[i.length-1],i.pop());l&&(r.draw(),this._notify(r,s,e,"progress")),i.length||(s.running=!1,this._notify(r,s,e,"complete"),s.initial=!1),t+=i.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let s=t.get(e);return s||(s={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,s)),s}listen(e,t,s){this._getAnims(e).listeners[t].push(s)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((s,r)=>Math.max(s,r._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const s=t.items;let r=s.length-1;for(;r>=0;--r)s[r].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var Ui=new $te;const b1="transparent",zte={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const s=c1(n||b1),r=s.valid&&c1(e||b1);return r&&r.valid?r.mix(s,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class Ute{constructor(e,t,s,r){const i=t[s];r=Zf([e.to,r,i,e.from]);const o=Zf([e.from,i,r]);this._active=!0,this._fn=e.fn||zte[e.type||typeof o],this._easing=Iu[e.easing]||Iu.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=s,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(e,t,s){if(this._active){this._notify(!1);const r=this._target[this._prop],i=s-this._start,o=this._duration-i;this._start=s,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=i,this._loop=!!e.loop,this._to=Zf([e.to,t,r,e.from]),this._from=Zf([e.from,r,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,s=this._duration,r=this._prop,i=this._from,o=this._loop,l=this._to;let c;if(this._active=i!==l&&(o||t<s),!this._active){this._target[r]=l,this._notify(!0);return}if(t<0){this._target[r]=i;return}c=t/s%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(i,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,s)=>{e.push({res:t,rej:s})})}_notify(e){const t=e?"res":"rej",s=this._promises||[];for(let r=0;r<s.length;r++)s[r][t]()}}class DI{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!bt(e))return;const t=Object.keys(Nn.animation),s=this._properties;Object.getOwnPropertyNames(e).forEach(r=>{const i=e[r];if(!bt(i))return;const o={};for(const l of t)o[l]=i[l];(On(i.properties)&&i.properties||[r]).forEach(l=>{(l===r||!s.has(l))&&s.set(l,o)})})}_animateOptions(e,t){const s=t.options,r=Bte(e,s);if(!r)return[];const i=this._createAnimations(r,s);return s.$shared&&Vte(e.options.$animations,s).then(()=>{e.options=s},()=>{}),i}_createAnimations(e,t){const s=this._properties,r=[],i=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){r.push(...this._animateOptions(e,t));continue}const h=t[d];let f=i[d];const p=s.get(d);if(f)if(p&&f.active()){f.update(p,h,l);continue}else f.cancel();if(!p||!p.duration){e[d]=h;continue}i[d]=f=new Ute(p,e,d,h),r.push(f)}return r}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const s=this._createAnimations(e,t);if(s.length)return Ui.add(this._chart,s),!0}}function Vte(n,e){const t=[],s=Object.keys(e);for(let r=0;r<s.length;r++){const i=n[s[r]];i&&i.active()&&t.push(i.wait())}return Promise.all(t)}function Bte(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function w1(n,e){const t=n&&n.options||{},s=t.reverse,r=t.min===void 0?e:0,i=t.max===void 0?e:0;return{start:s?i:r,end:s?r:i}}function qte(n,e,t){if(t===!1)return!1;const s=w1(n,t),r=w1(e,t);return{top:r.end,right:s.end,bottom:r.start,left:s.start}}function Hte(n){let e,t,s,r;return bt(n)?(e=n.top,t=n.right,s=n.bottom,r=n.left):e=t=s=r=n,{top:e,right:t,bottom:s,left:r,disabled:n===!1}}function AI(n,e){const t=[],s=n._getSortedDatasetMetas(e);let r,i;for(r=0,i=s.length;r<i;++r)t.push(s[r].index);return t}function _1(n,e,t,s={}){const r=n.keys,i=s.mode==="single";let o,l,c,d;if(e===null)return;let h=!1;for(o=0,l=r.length;o<l;++o){if(c=+r[o],c===t){if(h=!0,s.all)continue;break}d=n.values[c],ds(d)&&(i||e===0||ki(e)===ki(d))&&(e+=d)}return!h&&!s.all?0:e}function Wte(n,e){const{iScale:t,vScale:s}=e,r=t.axis==="x"?"x":"y",i=s.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,h;for(c=0,d=o.length;c<d;++c)h=o[c],l[c]={[r]:h,[i]:n[h]};return l}function Lx(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function Gte(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Yte(n){const{min:e,max:t,minDefined:s,maxDefined:r}=n.getUserBounds();return{min:s?e:Number.NEGATIVE_INFINITY,max:r?t:Number.POSITIVE_INFINITY}}function Zte(n,e,t){const s=n[e]||(n[e]={});return s[t]||(s[t]={})}function S1(n,e,t,s){for(const r of e.getMatchingVisibleMetas(s).reverse()){const i=n[r.index];if(t&&i>0||!t&&i<0)return r.index}return null}function N1(n,e){const{chart:t,_cachedMeta:s}=n,r=t._stacks||(t._stacks={}),{iScale:i,vScale:o,index:l}=s,c=i.axis,d=o.axis,h=Gte(i,o,s),f=e.length;let p;for(let g=0;g<f;++g){const b=e[g],{[c]:v,[d]:_}=b,N=b._stacks||(b._stacks={});p=N[d]=Zte(r,h,v),p[l]=_,p._top=S1(p,o,!0,s.type),p._bottom=S1(p,o,!1,s.type);const j=p._visualValues||(p._visualValues={});j[l]=_}}function Fx(n,e){const t=n.scales;return Object.keys(t).filter(s=>t[s].axis===e).shift()}function Kte(n,e){return Rl(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Jte(n,e,t){return Rl(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Qd(n,e){const t=n.controller.index,s=n.vScale&&n.vScale.axis;if(s){e=e||n._parsed;for(const r of e){const i=r._stacks;if(!i||i[s]===void 0||i[s][t]===void 0)return;delete i[s][t],i[s]._visualValues!==void 0&&i[s]._visualValues[t]!==void 0&&delete i[s]._visualValues[t]}}}const $x=n=>n==="reset"||n==="none",j1=(n,e)=>e?n:Object.assign({},n),Qte=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:AI(t,!0),values:null};class ul{constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Lx(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Qd(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,s=this.getDataset(),r=(f,p,g,b)=>f==="x"?p:f==="r"?b:g,i=t.xAxisID=mt(s.xAxisID,Fx(e,"x")),o=t.yAxisID=mt(s.yAxisID,Fx(e,"y")),l=t.rAxisID=mt(s.rAxisID,Fx(e,"r")),c=t.indexAxis,d=t.iAxisID=r(c,i,o,l),h=t.vAxisID=r(c,o,i,l);t.xScale=this.getScaleForId(i),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&a1(this._data,this),e._stacked&&Qd(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),s=this._data;if(bt(t)){const r=this._cachedMeta;this._data=Wte(t,r)}else if(s!==t){if(s){a1(s,this);const r=this._cachedMeta;Qd(r),r._parsed=[]}t&&Object.isExtensible(t)&&Iee(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,s=this.getDataset();let r=!1;this._dataCheck();const i=t._stacked;t._stacked=Lx(t.vScale,t),t.stack!==s.stack&&(r=!0,Qd(t),t.stack=s.stack),this._resyncElements(e),(r||i!==t._stacked)&&(N1(this,t._parsed),t._stacked=Lx(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),s=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(s,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:s,_data:r}=this,{iScale:i,_stacked:o}=s,l=i.axis;let c=e===0&&t===r.length?!0:s._sorted,d=e>0&&s._parsed[e-1],h,f,p;if(this._parsing===!1)s._parsed=r,s._sorted=!0,p=r;else{On(r[e])?p=this.parseArrayData(s,r,e,t):bt(r[e])?p=this.parseObjectData(s,r,e,t):p=this.parsePrimitiveData(s,r,e,t);const g=()=>f[l]===null||d&&f[l]<d[l];for(h=0;h<t;++h)s._parsed[h+e]=f=p[h],c&&(g()&&(c=!1),d=f);s._sorted=c}o&&N1(this,p)}parsePrimitiveData(e,t,s,r){const{iScale:i,vScale:o}=e,l=i.axis,c=o.axis,d=i.getLabels(),h=i===o,f=new Array(r);let p,g,b;for(p=0,g=r;p<g;++p)b=p+s,f[p]={[l]:h||i.parse(d[b],b),[c]:o.parse(t[b],b)};return f}parseArrayData(e,t,s,r){const{xScale:i,yScale:o}=e,l=new Array(r);let c,d,h,f;for(c=0,d=r;c<d;++c)h=c+s,f=t[h],l[c]={x:i.parse(f[0],h),y:o.parse(f[1],h)};return l}parseObjectData(e,t,s,r){const{xScale:i,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(r);let h,f,p,g;for(h=0,f=r;h<f;++h)p=h+s,g=t[p],d[h]={x:i.parse(Sl(g,l),p),y:o.parse(Sl(g,c),p)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,s){const r=this.chart,i=this._cachedMeta,o=t[e.axis],l={keys:AI(r,!0),values:t._stacks[e.axis]._visualValues};return _1(l,o,i.index,{mode:s})}updateRangeFromParsed(e,t,s,r){const i=s[t.axis];let o=i===null?NaN:i;const l=r&&s._stacks[t.axis];r&&l&&(r.values=l,o=_1(r,i,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const s=this._cachedMeta,r=s._parsed,i=s._sorted&&e===s.iScale,o=r.length,l=this._getOtherScale(e),c=Qte(t,s,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:f}=Yte(l);let p,g;function b(){g=r[p];const v=g[l.axis];return!ds(g[e.axis])||h>v||f<v}for(p=0;p<o&&!(!b()&&(this.updateRangeFromParsed(d,e,g,c),i));++p);if(i){for(p=o-1;p>=0;--p)if(!b()){this.updateRangeFromParsed(d,e,g,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,s=[];let r,i,o;for(r=0,i=t.length;r<i;++r)o=t[r][e.axis],ds(o)&&s.push(o);return s}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,s=t.iScale,r=t.vScale,i=this.getParsed(e);return{label:s?""+s.getLabelForValue(i[s.axis]):"",value:r?""+r.getLabelForValue(i[r.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Hte(mt(this.options.clip,qte(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,s=this._cachedMeta,r=s.data||[],i=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||r.length-l,d=this.options.drawActiveElementsOnTop;let h;for(s.dataset&&s.dataset.draw(e,i,l,c),h=l;h<l+c;++h){const f=r[h];f.hidden||(f.active&&d?o.push(f):f.draw(e,i))}for(h=0;h<o.length;++h)o[h].draw(e,i)}getStyle(e,t){const s=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(s):this.resolveDataElementOptions(e||0,s)}getContext(e,t,s){const r=this.getDataset();let i;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];i=o.$context||(o.$context=Jte(this.getContext(),e,o)),i.parsed=this.getParsed(e),i.raw=r.data[e],i.index=i.dataIndex=e}else i=this.$context||(this.$context=Kte(this.chart.getContext(),this.index)),i.dataset=r,i.index=i.datasetIndex=this.index;return i.active=!!t,i.mode=s,i}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",s){const r=t==="active",i=this._cachedDataOpts,o=e+"-"+t,l=i[o],c=this.enableOptionSharing&&mh(s);if(l)return j1(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),f=r?[`${e}Hover`,"hover",e,""]:[e,""],p=d.getOptionScopes(this.getDataset(),h),g=Object.keys(Nn.elements[e]),b=()=>this.getContext(s,r,t),v=d.resolveNamedOptions(p,g,b,f);return v.$shared&&(v.$shared=c,i[o]=Object.freeze(j1(v,c))),v}_resolveAnimations(e,t,s){const r=this.chart,i=this._cachedDataOpts,o=`animation-${t}`,l=i[o];if(l)return l;let c;if(r.options.animation!==!1){const h=this.chart.config,f=h.datasetAnimationScopeKeys(this._type,t),p=h.getOptionScopes(this.getDataset(),f);c=h.createResolver(p,this.getContext(e,s,t))}const d=new DI(r,c&&c.animations);return c&&c._cacheable&&(i[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||$x(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const s=this.resolveDataElementOptions(e,t),r=this._sharedOptions,i=this.getSharedOptions(s),o=this.includeOptions(t,i)||i!==r;return this.updateSharedOptions(i,t,s),{sharedOptions:i,includeOptions:o}}updateElement(e,t,s,r){$x(r)?Object.assign(e,s):this._resolveAnimations(t,r).update(e,s)}updateSharedOptions(e,t,s){e&&!$x(t)&&this._resolveAnimations(void 0,t).update(e,s)}_setStyle(e,t,s,r){e.active=r;const i=this.getStyle(t,r);this._resolveAnimations(t,s,r).update(e,{options:!r&&this.getSharedOptions(i)||i})}removeHoverStyle(e,t,s){this._setStyle(e,s,"active",!1)}setHoverStyle(e,t,s){this._setStyle(e,s,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,s=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const r=s.length,i=t.length,o=Math.min(i,r);o&&this.parse(0,o),i>r?this._insertElements(r,i-r,e):i<r&&this._removeElements(i,r-i)}_insertElements(e,t,s=!0){const r=this._cachedMeta,i=r.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(i),l=e;l<o;++l)i[l]=new this.dataElementType;this._parsing&&c(r._parsed),this.parse(e,t),s&&this.updateElements(i,e,t,"reset")}updateElements(e,t,s,r){}_removeElements(e,t){const s=this._cachedMeta;if(this._parsing){const r=s._parsed.splice(e,t);s._stacked&&Qd(s,r)}s.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,s,r]=e;this[t](s,r)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const s=arguments.length-2;s&&this._sync(["_insertElements",e,s])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}xe(ul,"defaults",{}),xe(ul,"datasetElementType",null),xe(ul,"dataElementType",null);function Xte(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let s=[];for(let r=0,i=t.length;r<i;r++)s=s.concat(t[r].controller.getAllParsedValues(n));n._cache.$bar=mI(s.sort((r,i)=>r-i))}return n._cache.$bar}function ene(n){const e=n.iScale,t=Xte(e,n.type);let s=e._length,r,i,o,l;const c=()=>{o===32767||o===-32768||(mh(l)&&(s=Math.min(s,Math.abs(o-l)||s)),l=o)};for(r=0,i=t.length;r<i;++r)o=e.getPixelForValue(t[r]),c();for(l=void 0,r=0,i=e.ticks.length;r<i;++r)o=e.getPixelForTick(r),c();return s}function tne(n,e,t,s){const r=t.barThickness;let i,o;return At(r)?(i=e.min*t.categoryPercentage,o=t.barPercentage):(i=r*s,o=1),{chunk:i/s,ratio:o,start:e.pixels[n]-i/2}}function nne(n,e,t,s){const r=e.pixels,i=r[n];let o=n>0?r[n-1]:null,l=n<r.length-1?r[n+1]:null;const c=t.categoryPercentage;o===null&&(o=i-(l===null?e.end-e.start:l-i)),l===null&&(l=i+i-o);const d=i-(i-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/s,ratio:t.barPercentage,start:d}}function sne(n,e,t,s){const r=t.parse(n[0],s),i=t.parse(n[1],s),o=Math.min(r,i),l=Math.max(r,i);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:r,end:i,min:o,max:l}}function II(n,e,t,s){return On(n)?sne(n,e,t,s):e[t.axis]=t.parse(n,s),e}function C1(n,e,t,s){const r=n.iScale,i=n.vScale,o=r.getLabels(),l=r===i,c=[];let d,h,f,p;for(d=t,h=t+s;d<h;++d)p=e[d],f={},f[r.axis]=l||r.parse(o[d],d),c.push(II(p,f,i,d));return c}function zx(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function rne(n,e,t){return n!==0?ki(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function ine(n){let e,t,s,r,i;return n.horizontal?(e=n.base>n.x,t="left",s="right"):(e=n.base<n.y,t="bottom",s="top"),e?(r="end",i="start"):(r="start",i="end"),{start:t,end:s,reverse:e,top:r,bottom:i}}function ane(n,e,t,s){let r=e.borderSkipped;const i={};if(!r){n.borderSkipped=i;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:h}=ine(n);r==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===s?r=d:(t._bottom||0)===s?r=h:(i[k1(h,o,l,c)]=!0,r=d)),i[k1(r,o,l,c)]=!0,n.borderSkipped=i}function k1(n,e,t,s){return s?(n=one(n,e,t),n=T1(n,t,e)):n=T1(n,e,t),n}function one(n,e,t){return n===e?t:n===t?e:n}function T1(n,e,t){return n==="start"?e:n==="end"?t:n}function lne(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Dm extends ul{parsePrimitiveData(e,t,s,r){return C1(e,t,s,r)}parseArrayData(e,t,s,r){return C1(e,t,s,r)}parseObjectData(e,t,s,r){const{iScale:i,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=i.axis==="x"?l:c,h=o.axis==="x"?l:c,f=[];let p,g,b,v;for(p=s,g=s+r;p<g;++p)v=t[p],b={},b[i.axis]=i.parse(Sl(v,d),p),f.push(II(Sl(v,h),b,o,p));return f}updateRangeFromParsed(e,t,s,r){super.updateRangeFromParsed(e,t,s,r);const i=s._custom;i&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,i.min),e.max=Math.max(e.max,i.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:s,vScale:r}=t,i=this.getParsed(e),o=i._custom,l=zx(o)?"["+o.start+", "+o.end+"]":""+r.getLabelForValue(i[r.axis]);return{label:""+s.getLabelForValue(i[s.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,s,r){const i=r==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:f,includeOptions:p}=this._getSharedOptions(t,r);for(let g=t;g<t+s;g++){const b=this.getParsed(g),v=i||At(b[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(g),_=this._calculateBarIndexPixels(g,h),N=(b._stacks||{})[l.axis],j={horizontal:d,base:v.base,enableBorderRadius:!N||zx(b._custom)||o===N._top||o===N._bottom,x:d?v.head:_.center,y:d?_.center:v.head,height:d?_.size:Math.abs(v.size),width:d?Math.abs(v.size):_.size};p&&(j.options=f||this.resolveDataElementOptions(g,e[g].active?"active":r));const k=j.options||e[g].options;ane(j,k,N,o),lne(j,k,h.ratio),this.updateElement(e[g],g,j,r)}}_getStacks(e,t){const{iScale:s}=this._cachedMeta,r=s.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),i=s.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[s.axis],d=h=>{const f=h._parsed.find(g=>g[s.axis]===c),p=f&&f[h.vScale.axis];if(At(p)||isNaN(p))return!0};for(const h of r)if(!(t!==void 0&&d(h))&&((i===!1||o.indexOf(h.stack)===-1||i===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(s=>e[s].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const s of this.chart.data.datasets)e[mt(this.chart.options.indexAxis==="x"?s.xAxisID:s.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,s){const r=this._getStacks(e,s),i=t!==void 0?r.indexOf(t):-1;return i===-1?r.length-1:i}_getRuler(){const e=this.options,t=this._cachedMeta,s=t.iScale,r=[];let i,o;for(i=0,o=t.data.length;i<o;++i)r.push(s.getPixelForValue(this.getParsed(i)[s.axis],i));const l=e.barThickness;return{min:l||ene(t),pixels:r,start:s._startPixel,end:s._endPixel,stackCount:this._getStackCount(),scale:s,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:s,index:r},options:{base:i,minBarLength:o}}=this,l=i||0,c=this.getParsed(e),d=c._custom,h=zx(d);let f=c[t.axis],p=0,g=s?this.applyStack(t,c,s):f,b,v;g!==f&&(p=g-f,g=f),h&&(f=d.barStart,g=d.barEnd-d.barStart,f!==0&&ki(f)!==ki(d.barEnd)&&(p=0),p+=f);const _=!At(i)&&!h?i:p;let N=t.getPixelForValue(_);if(this.chart.getDataVisibility(e)?b=t.getPixelForValue(p+g):b=N,v=b-N,Math.abs(v)<o){v=rne(v,t,l)*o,f===l&&(N-=v/2);const j=t.getPixelForDecimal(0),k=t.getPixelForDecimal(1),S=Math.min(j,k),P=Math.max(j,k);N=Math.max(Math.min(N,P),S),b=N+v,s&&!h&&(c._stacks[t.axis]._visualValues[r]=t.getValueForPixel(b)-t.getValueForPixel(N))}if(N===t.getPixelForValue(l)){const j=ki(v)*t.getLineWidthForValue(l)/2;N+=j,v-=j}return{size:v,base:N,head:b,center:b+v/2}}_calculateBarIndexPixels(e,t){const s=t.scale,r=this.options,i=r.skipNull,o=mt(r.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const h=i?this._getStackCount(e):t.stackCount,f=r.barThickness==="flex"?nne(e,t,r,h*d):tne(e,t,r,h*d),p=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,g=this._getAxis().indexOf(mt(p,this.getFirstScaleIdForIndexAxis())),b=this._getStackIndex(this.index,this._cachedMeta.stack,i?e:void 0)+g;l=f.start+f.chunk*b+f.chunk/2,c=Math.min(o,f.chunk*f.ratio)}else l=s.getPixelForValue(this.getParsed(e)[s.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,s=e.data,r=s.length;let i=0;for(;i<r;++i)this.getParsed(i)[t.axis]!==null&&!s[i].hidden&&s[i].draw(this._ctx)}}xe(Dm,"id","bar"),xe(Dm,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),xe(Dm,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function cne(n,e,t){let s=1,r=1,i=0,o=0;if(e<hn){const l=n,c=l+e,d=Math.cos(l),h=Math.sin(l),f=Math.cos(c),p=Math.sin(c),g=(k,S,P)=>gh(k,l,c,!0)?1:Math.max(S,S*t,P,P*t),b=(k,S,P)=>gh(k,l,c,!0)?-1:Math.min(S,S*t,P,P*t),v=g(0,d,f),_=g(Ln,h,p),N=b(Ut,d,f),j=b(Ut+Ln,h,p);s=(v-N)/2,r=(_-j)/2,i=-(v+N)/2,o=-(_+j)/2}return{ratioX:s,ratioY:r,offsetX:i,offsetY:o}}class fu extends ul{constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const s=this.getDataset().data,r=this._cachedMeta;if(this._parsing===!1)r._parsed=s;else{let i=c=>+s[c];if(bt(s[e])){const{key:c="value"}=this._parsing;i=d=>+Sl(s[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)r._parsed[o]=i(o)}}_getRotation(){return Ji(this.options.rotation-90)}_getCircumference(){return Ji(this.options.circumference)}_getRotationExtents(){let e=hn,t=-hn;for(let s=0;s<this.chart.data.datasets.length;++s)if(this.chart.isDatasetVisible(s)&&this.chart.getDatasetMeta(s).type===this._type){const r=this.chart.getDatasetMeta(s).controller,i=r._getRotation(),o=r._getCircumference();e=Math.min(e,i),t=Math.max(t,i+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:s}=t,r=this._cachedMeta,i=r.data,o=this.getMaxBorderWidth()+this.getMaxOffset(i)+this.options.spacing,l=Math.max((Math.min(s.width,s.height)-o)/2,0),c=Math.min(yee(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:f}=this._getRotationExtents(),{ratioX:p,ratioY:g,offsetX:b,offsetY:v}=cne(f,h,c),_=(s.width-o)/p,N=(s.height-o)/g,j=Math.max(Math.min(_,N)/2,0),k=cI(this.options.radius,j),S=Math.max(k*c,0),P=(k-S)/this._getVisibleDatasetWeightTotal();this.offsetX=b*k,this.offsetY=v*k,r.total=this.calculateTotal(),this.outerRadius=k-P*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-P*d,0),this.updateElements(i,0,i.length,e)}_circumference(e,t){const s=this.options,r=this._cachedMeta,i=this._getCircumference();return t&&s.animation.animateRotate||!this.chart.getDataVisibility(e)||r._parsed[e]===null||r.data[e].hidden?0:this.calculateCircumference(r._parsed[e]*i/hn)}updateElements(e,t,s,r){const i=r==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,h=(l.left+l.right)/2,f=(l.top+l.bottom)/2,p=i&&d.animateScale,g=p?0:this.innerRadius,b=p?0:this.outerRadius,{sharedOptions:v,includeOptions:_}=this._getSharedOptions(t,r);let N=this._getRotation(),j;for(j=0;j<t;++j)N+=this._circumference(j,i);for(j=t;j<t+s;++j){const k=this._circumference(j,i),S=e[j],P={x:h+this.offsetX,y:f+this.offsetY,startAngle:N,endAngle:N+k,circumference:k,outerRadius:b,innerRadius:g};_&&(P.options=v||this.resolveDataElementOptions(j,S.active?"active":r)),N+=k,this.updateElement(S,j,P,r)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let s=0,r;for(r=0;r<t.length;r++){const i=e._parsed[r];i!==null&&!isNaN(i)&&this.chart.getDataVisibility(r)&&!t[r].hidden&&(s+=Math.abs(i))}return s}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?hn*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,s=this.chart,r=s.data.labels||[],i=O_(t._parsed[e],s.options.locale);return{label:r[e]||"",value:i}}getMaxBorderWidth(e){let t=0;const s=this.chart;let r,i,o,l,c;if(!e){for(r=0,i=s.data.datasets.length;r<i;++r)if(s.isDatasetVisible(r)){o=s.getDatasetMeta(r),e=o.data,l=o.controller;break}}if(!e)return 0;for(r=0,i=e.length;r<i;++r)c=l.resolveDataElementOptions(r),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let s=0,r=e.length;s<r;++s){const i=this.resolveDataElementOptions(s);t=Math.max(t,i.offset||0,i.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let s=0;s<e;++s)this.chart.isDatasetVisible(s)&&(t+=this._getRingWeight(s));return t}_getRingWeight(e){return Math.max(mt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}xe(fu,"id","doughnut"),xe(fu,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),xe(fu,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),xe(fu,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const f=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:f.backgroundColor,fontColor:i,hidden:!e.getDataVisibility(d),lineDash:f.borderDash,lineDashOffset:f.borderDashOffset,lineJoin:f.borderJoinStyle,lineWidth:f.borderWidth,strokeStyle:f.borderColor,textAlign:r,pointStyle:s,borderRadius:o&&(l||f.borderRadius),index:d}}):[]}},onClick(e,t,s){s.chart.toggleDataVisibility(t.index),s.chart.update()}}}});class Am extends ul{initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:s,data:r=[],_dataset:i}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=Lee(t,r,o);this._drawStart=l,this._drawCount=c,Fee(t)&&(l=0,c=r.length),s._chart=this.chart,s._datasetIndex=this.index,s._decimated=!!i._decimated,s.points=r;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(s,void 0,{animated:!o,options:d},e),this.updateElements(r,l,c,e)}updateElements(e,t,s,r){const i=r==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:f}=this._getSharedOptions(t,r),p=o.axis,g=l.axis,{spanGaps:b,segment:v}=this.options,_=ph(b)?b:Number.POSITIVE_INFINITY,N=this.chart._animationsDisabled||i||r==="none",j=t+s,k=e.length;let S=t>0&&this.getParsed(t-1);for(let P=0;P<k;++P){const E=e[P],M=N?E:{};if(P<t||P>=j){M.skip=!0;continue}const I=this.getParsed(P),O=At(I[g]),D=M[p]=o.getPixelForValue(I[p],P),z=M[g]=i||O?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,I,c):I[g],P);M.skip=isNaN(D)||isNaN(z)||O,M.stop=P>0&&Math.abs(I[p]-S[p])>_,v&&(M.parsed=I,M.raw=d.data[P]),f&&(M.options=h||this.resolveDataElementOptions(P,E.active?"active":r)),N||this.updateElement(E,P,M,r),S=I}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,s=t.options&&t.options.borderWidth||0,r=e.data||[];if(!r.length)return s;const i=r[0].size(this.resolveDataElementOptions(0)),o=r[r.length-1].size(this.resolveDataElementOptions(r.length-1));return Math.max(s,i,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}xe(Am,"id","line"),xe(Am,"defaults",{datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1}),xe(Am,"overrides",{scales:{_index_:{type:"category"},_value_:{type:"linear"}}});function $o(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class V_{constructor(e){xe(this,"options");this.options=e||{}}static override(e){Object.assign(V_.prototype,e)}init(){}formats(){return $o()}parse(){return $o()}format(){return $o()}add(){return $o()}diff(){return $o()}startOf(){return $o()}endOf(){return $o()}}var dne={_date:V_};function une(n,e,t,s){const{controller:r,data:i,_sorted:o}=n,l=r._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&i.length){const d=l._reversePixels?Dee:rl;if(s){if(r._sharedOptions){const h=i[0],f=typeof h.getRange=="function"&&h.getRange(e);if(f){const p=d(i,e,t-f),g=d(i,e,t+f);return{lo:p.lo,hi:g.hi}}}}else{const h=d(i,e,t);if(c){const{vScale:f}=r._cachedMeta,{_parsed:p}=n,g=p.slice(0,h.lo+1).reverse().findIndex(v=>!At(v[f.axis]));h.lo-=Math.max(0,g);const b=p.slice(h.hi).findIndex(v=>!At(v[f.axis]));h.hi+=Math.max(0,b)}return h}}return{lo:0,hi:i.length-1}}function Qg(n,e,t,s,r){const i=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=i.length;l<c;++l){const{index:d,data:h}=i[l],{lo:f,hi:p}=une(i[l],e,o,r);for(let g=f;g<=p;++g){const b=h[g];b.skip||s(b,d,g)}}}function hne(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(s,r){const i=e?Math.abs(s.x-r.x):0,o=t?Math.abs(s.y-r.y):0;return Math.sqrt(Math.pow(i,2)+Math.pow(o,2))}}function Ux(n,e,t,s,r){const i=[];return!r&&!n.isPointInArea(e)||Qg(n,t,e,function(l,c,d){!r&&!yh(l,n.chartArea,0)||l.inRange(e.x,e.y,s)&&i.push({element:l,datasetIndex:c,index:d})},!0),i}function fne(n,e,t,s){let r=[];function i(o,l,c){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],s),{angle:f}=hI(o,{x:e.x,y:e.y});gh(f,d,h)&&r.push({element:o,datasetIndex:l,index:c})}return Qg(n,t,e,i),r}function mne(n,e,t,s,r,i){let o=[];const l=hne(t);let c=Number.POSITIVE_INFINITY;function d(h,f,p){const g=h.inRange(e.x,e.y,r);if(s&&!g)return;const b=h.getCenterPoint(r);if(!(!!i||n.isPointInArea(b))&&!g)return;const _=l(e,b);_<c?(o=[{element:h,datasetIndex:f,index:p}],c=_):_===c&&o.push({element:h,datasetIndex:f,index:p})}return Qg(n,t,e,d),o}function Vx(n,e,t,s,r,i){return!i&&!n.isPointInArea(e)?[]:t==="r"&&!s?fne(n,e,t,r):mne(n,e,t,s,r,i)}function E1(n,e,t,s,r){const i=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return Qg(n,t,e,(c,d,h)=>{c[o]&&c[o](e[t],r)&&(i.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,r))}),s&&!l?[]:i}var pne={modes:{index(n,e,t,s){const r=Wo(e,n),i=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?Ux(n,r,i,s,o):Vx(n,r,i,!1,s,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,f=d.data[h];f&&!f.skip&&c.push({element:f,datasetIndex:d.index,index:h})}),c):[]},dataset(n,e,t,s){const r=Wo(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?Ux(n,r,i,s,o):Vx(n,r,i,!1,s,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(n,e,t,s){const r=Wo(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;return Ux(n,r,i,s,o)},nearest(n,e,t,s){const r=Wo(e,n),i=t.axis||"xy",o=t.includeInvisible||!1;return Vx(n,r,i,t.intersect,s,o)},x(n,e,t,s){const r=Wo(e,n);return E1(n,r,"x",t.intersect,s)},y(n,e,t,s){const r=Wo(e,n);return E1(n,r,"y",t.intersect,s)}}};const OI=["left","top","right","bottom"];function Xd(n,e){return n.filter(t=>t.pos===e)}function P1(n,e){return n.filter(t=>OI.indexOf(t.pos)===-1&&t.box.axis===e)}function eu(n,e){return n.sort((t,s)=>{const r=e?s:t,i=e?t:s;return r.weight===i.weight?r.index-i.index:r.weight-i.weight})}function gne(n){const e=[];let t,s,r,i,o,l;for(t=0,s=(n||[]).length;t<s;++t)r=n[t],{position:i,options:{stack:o,stackWeight:l=1}}=r,e.push({index:t,box:r,pos:i,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&i+o,stackWeight:l});return e}function yne(n){const e={};for(const t of n){const{stack:s,pos:r,stackWeight:i}=t;if(!s||!OI.includes(r))continue;const o=e[s]||(e[s]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=i}return e}function xne(n,e){const t=yne(n),{vBoxMaxWidth:s,hBoxMaxHeight:r}=e;let i,o,l;for(i=0,o=n.length;i<o;++i){l=n[i];const{fullSize:c}=l.box,d=t[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*s:c&&e.availableWidth,l.height=r):(l.width=s,l.height=h?h*r:c&&e.availableHeight)}return t}function vne(n){const e=gne(n),t=eu(e.filter(d=>d.box.fullSize),!0),s=eu(Xd(e,"left"),!0),r=eu(Xd(e,"right")),i=eu(Xd(e,"top"),!0),o=eu(Xd(e,"bottom")),l=P1(e,"x"),c=P1(e,"y");return{fullSize:t,leftAndTop:s.concat(i),rightAndBottom:r.concat(c).concat(o).concat(l),chartArea:Xd(e,"chartArea"),vertical:s.concat(r).concat(c),horizontal:i.concat(o).concat(l)}}function M1(n,e,t,s){return Math.max(n[t],e[t])+Math.max(n[s],e[s])}function RI(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function bne(n,e,t,s){const{pos:r,box:i}=t,o=n.maxPadding;if(!bt(r)){t.size&&(n[r]-=t.size);const f=s[t.stack]||{size:0,count:1};f.size=Math.max(f.size,t.horizontal?i.height:i.width),t.size=f.size/f.count,n[r]+=t.size}i.getPadding&&RI(o,i.getPadding());const l=Math.max(0,e.outerWidth-M1(o,n,"left","right")),c=Math.max(0,e.outerHeight-M1(o,n,"top","bottom")),d=l!==n.w,h=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:h}:{same:h,other:d}}function wne(n){const e=n.maxPadding;function t(s){const r=Math.max(e[s]-n[s],0);return n[s]+=r,r}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function _ne(n,e){const t=e.maxPadding;function s(r){const i={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{i[o]=Math.max(e[o],t[o])}),i}return s(n?["left","right"]:["top","bottom"])}function mu(n,e,t,s){const r=[];let i,o,l,c,d,h;for(i=0,o=n.length,d=0;i<o;++i){l=n[i],c=l.box,c.update(l.width||e.w,l.height||e.h,_ne(l.horizontal,e));const{same:f,other:p}=bne(e,t,l,s);d|=f&&r.length,h=h||p,c.fullSize||r.push(l)}return d&&mu(r,e,t,s)||h}function Qf(n,e,t,s,r){n.top=t,n.left=e,n.right=e+s,n.bottom=t+r,n.width=s,n.height=r}function D1(n,e,t,s){const r=t.padding;let{x:i,y:o}=e;for(const l of n){const c=l.box,d=s[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const f=e.w*h,p=d.size||c.height;mh(d.start)&&(o=d.start),c.fullSize?Qf(c,r.left,o,t.outerWidth-r.right-r.left,p):Qf(c,e.left+d.placed,o,f,p),d.start=o,d.placed+=f,o=c.bottom}else{const f=e.h*h,p=d.size||c.width;mh(d.start)&&(i=d.start),c.fullSize?Qf(c,i,r.top,p,t.outerHeight-r.bottom-r.top):Qf(c,i,e.top+d.placed,p,f),d.start=i,d.placed+=f,i=c.right}}e.x=i,e.y=o}var La={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,s){if(!n)return;const r=Xr(n.options.layout.padding),i=Math.max(e-r.width,0),o=Math.max(t-r.height,0),l=vne(n.boxes),c=l.vertical,d=l.horizontal;It(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});const h=c.reduce((v,_)=>_.box.options&&_.box.options.display===!1?v:v+1,0)||1,f=Object.freeze({outerWidth:e,outerHeight:t,padding:r,availableWidth:i,availableHeight:o,vBoxMaxWidth:i/2/h,hBoxMaxHeight:o/2}),p=Object.assign({},r);RI(p,Xr(s));const g=Object.assign({maxPadding:p,w:i,h:o,x:r.left,y:r.top},r),b=xne(c.concat(d),f);mu(l.fullSize,g,f,b),mu(c,g,f,b),mu(d,g,f,b)&&mu(c,g,f,b),wne(g),D1(l.leftAndTop,g,f,b),g.x+=g.w,g.y+=g.h,D1(l.rightAndBottom,g,f,b),n.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},It(l.chartArea,v=>{const _=v.box;Object.assign(_,n.chartArea),_.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}};class LI{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,s){}removeEventListener(e,t,s){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,s,r){return t=Math.max(0,t||e.width),s=s||e.height,{width:t,height:Math.max(0,r?Math.floor(t/r):s)}}isAttached(e){return!0}updateConfig(e){}}class Sne extends LI{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const Im="$chartjs",Nne={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},A1=n=>n===null||n==="";function jne(n,e){const t=n.style,s=n.getAttribute("height"),r=n.getAttribute("width");if(n[Im]={initial:{height:s,width:r,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",A1(r)){const i=g1(n,"width");i!==void 0&&(n.width=i)}if(A1(s))if(n.style.height==="")n.height=n.width/(e||2);else{const i=g1(n,"height");i!==void 0&&(n.height=i)}return n}const FI=kte?{passive:!0}:!1;function Cne(n,e,t){n&&n.addEventListener(e,t,FI)}function kne(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,FI)}function Tne(n,e){const t=Nne[n.type]||n.type,{x:s,y:r}=Wo(n,e);return{type:t,chart:e,native:n,x:s!==void 0?s:null,y:r!==void 0?r:null}}function Gp(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function Ene(n,e,t){const s=n.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||Gp(l.addedNodes,s),o=o&&!Gp(l.removedNodes,s);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}function Pne(n,e,t){const s=n.canvas,r=new MutationObserver(i=>{let o=!1;for(const l of i)o=o||Gp(l.removedNodes,s),o=o&&!Gp(l.addedNodes,s);o&&t()});return r.observe(document,{childList:!0,subtree:!0}),r}const xh=new Map;let I1=0;function $I(){const n=window.devicePixelRatio;n!==I1&&(I1=n,xh.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function Mne(n,e){xh.size||window.addEventListener("resize",$I),xh.set(n,e)}function Dne(n){xh.delete(n),xh.size||window.removeEventListener("resize",$I)}function Ane(n,e,t){const s=n.canvas,r=s&&U_(s);if(!r)return;const i=gI((l,c)=>{const d=r.clientWidth;t(l,c),d<r.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||i(d,h)});return o.observe(r),Mne(n,i),o}function Bx(n,e,t){t&&t.disconnect(),e==="resize"&&Dne(n)}function Ine(n,e,t){const s=n.canvas,r=gI(i=>{n.ctx!==null&&t(Tne(i,n))},n);return Cne(s,e,r),r}class One extends LI{acquireContext(e,t){const s=e&&e.getContext&&e.getContext("2d");return s&&s.canvas===e?(jne(e,t),s):null}releaseContext(e){const t=e.canvas;if(!t[Im])return!1;const s=t[Im].initial;["height","width"].forEach(i=>{const o=s[i];At(o)?t.removeAttribute(i):t.setAttribute(i,o)});const r=s.style||{};return Object.keys(r).forEach(i=>{t.style[i]=r[i]}),t.width=t.width,delete t[Im],!0}addEventListener(e,t,s){this.removeEventListener(e,t);const r=e.$proxies||(e.$proxies={}),o={attach:Ene,detach:Pne,resize:Ane}[t]||Ine;r[t]=o(e,t,s)}removeEventListener(e,t){const s=e.$proxies||(e.$proxies={}),r=s[t];if(!r)return;({attach:Bx,detach:Bx,resize:Bx}[t]||kne)(e,t,r),s[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,s,r){return Cte(e,t,s,r)}isAttached(e){const t=e&&U_(e);return!!(t&&t.isConnected)}}function Rne(n){return!z_()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?Sne:One}var cm;let _o=(cm=class{constructor(){xe(this,"x");xe(this,"y");xe(this,"active",!1);xe(this,"options");xe(this,"$animations")}tooltipPosition(e){const{x:t,y:s}=this.getProps(["x","y"],e);return{x:t,y:s}}hasValue(){return ph(this.x)&&ph(this.y)}getProps(e,t){const s=this.$animations;if(!t||!s)return this;const r={};return e.forEach(i=>{r[i]=s[i]&&s[i].active()?s[i]._to:this[i]}),r}},xe(cm,"defaults",{}),xe(cm,"defaultRoutes"),cm);function Lne(n,e){const t=n.options.ticks,s=Fne(n),r=Math.min(t.maxTicksLimit||s,s),i=t.major.enabled?zne(e):[],o=i.length,l=i[0],c=i[o-1],d=[];if(o>r)return Une(e,d,i,o/r),d;const h=$ne(i,e,r);if(o>0){let f,p;const g=o>1?Math.round((c-l)/(o-1)):null;for(Xf(e,d,h,At(g)?0:l-g,l),f=0,p=o-1;f<p;f++)Xf(e,d,h,i[f],i[f+1]);return Xf(e,d,h,c,At(g)?e.length:c+g),d}return Xf(e,d,h),d}function Fne(n){const e=n.options.offset,t=n._tickSize(),s=n._length/t+(e?0:1),r=n._maxLength/t;return Math.floor(Math.min(s,r))}function $ne(n,e,t){const s=Vne(n),r=e.length/t;if(!s)return Math.max(r,1);const i=jee(s);for(let o=0,l=i.length-1;o<l;o++){const c=i[o];if(c>r)return c}return Math.max(r,1)}function zne(n){const e=[];let t,s;for(t=0,s=n.length;t<s;t++)n[t].major&&e.push(t);return e}function Une(n,e,t,s){let r=0,i=t[0],o;for(s=Math.ceil(s),o=0;o<n.length;o++)o===i&&(e.push(n[o]),r++,i=t[r*s])}function Xf(n,e,t,s,r){const i=mt(s,0),o=Math.min(mt(r,n.length),n.length);let l=0,c,d,h;for(t=Math.ceil(t),r&&(c=r-s,t=c/Math.floor(c/t)),h=i;h<0;)l++,h=Math.round(i+l*t);for(d=Math.max(i,0);d<o;d++)d===h&&(e.push(n[d]),l++,h=Math.round(i+l*t))}function Vne(n){const e=n.length;let t,s;if(e<2)return!1;for(s=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==s)return!1;return s}const Bne=n=>n==="left"?"right":n==="right"?"left":n,O1=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,R1=(n,e)=>Math.min(e||n,n);function L1(n,e){const t=[],s=n.length/e,r=n.length;let i=0;for(;i<r;i+=s)t.push(n[Math.floor(i)]);return t}function qne(n,e,t){const s=n.ticks.length,r=Math.min(e,s-1),i=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(r),d;if(!(t&&(s===1?d=Math.max(c-i,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(r-1))/2,c+=r<e?d:-d,c<i-l||c>o+l)))return c}function Hne(n,e){It(n,t=>{const s=t.gc,r=s.length/2;let i;if(r>e){for(i=0;i<r;++i)delete t.data[s[i]];s.splice(0,r)}})}function tu(n){return n.drawTicks?n.tickLength:0}function F1(n,e){if(!n.display)return 0;const t=Ls(n.font,e),s=Xr(n.padding);return(On(n.text)?n.text.length:1)*t.lineHeight+s.height}function Wne(n,e){return Rl(n,{scale:e,type:"scale"})}function Gne(n,e,t){return Rl(n,{tick:t,index:e,type:"tick"})}function Yne(n,e,t){let s=yI(n);return(t&&e!=="right"||!t&&e==="right")&&(s=Bne(s)),s}function Zne(n,e,t,s){const{top:r,left:i,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:h}=c;let f=0,p,g,b;const v=o-r,_=l-i;if(n.isHorizontal()){if(g=Zs(s,i,l),bt(t)){const N=Object.keys(t)[0],j=t[N];b=h[N].getPixelForValue(j)+v-e}else t==="center"?b=(d.bottom+d.top)/2+v-e:b=O1(n,t,e);p=l-i}else{if(bt(t)){const N=Object.keys(t)[0],j=t[N];g=h[N].getPixelForValue(j)-_+e}else t==="center"?g=(d.left+d.right)/2-_+e:g=O1(n,t,e);b=Zs(s,o,r),f=t==="left"?-Ln:Ln}return{titleX:g,titleY:b,maxWidth:p,rotation:f}}class vd extends _o{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:s,_suggestedMax:r}=this;return e=ci(e,Number.POSITIVE_INFINITY),t=ci(t,Number.NEGATIVE_INFINITY),s=ci(s,Number.POSITIVE_INFINITY),r=ci(r,Number.NEGATIVE_INFINITY),{min:ci(e,s),max:ci(t,r),minDefined:ds(e),maxDefined:ds(t)}}getMinMax(e){let{min:t,max:s,minDefined:r,maxDefined:i}=this.getUserBounds(),o;if(r&&i)return{min:t,max:s};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),r||(t=Math.min(t,o.min)),i||(s=Math.max(s,o.max));return t=i&&t>s?s:t,s=r&&t>s?t:s,{min:ci(t,ci(s,t)),max:ci(s,ci(t,s))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Xt(this.options.beforeUpdate,[this])}update(e,t,s){const{beginAtZero:r,grace:i,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=s=Object.assign({left:0,right:0,top:0,bottom:0},s),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+s.left+s.right:this.height+s.top+s.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=rte(this,i,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?L1(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Lne(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,s;this.isHorizontal()?(t=this.left,s=this.right):(t=this.top,s=this.bottom,e=!e),this._startPixel=t,this._endPixel=s,this._reversePixels=e,this._length=s-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Xt(this.options.afterUpdate,[this])}beforeSetDimensions(){Xt(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Xt(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Xt(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Xt(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let s,r,i;for(s=0,r=e.length;s<r;s++)i=e[s],i.label=Xt(t.callback,[i.value,s,e],this)}afterTickToLabelConversion(){Xt(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Xt(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,s=R1(this.ticks.length,e.ticks.maxTicksLimit),r=t.minRotation||0,i=t.maxRotation;let o=r,l,c,d;if(!this._isVisible()||!t.display||r>=i||s<=1||!this.isHorizontal()){this.labelRotation=r;return}const h=this._getLabelSizes(),f=h.widest.width,p=h.highest.height,g=os(this.chart.width-f,0,this.maxWidth);l=e.offset?this.maxWidth/s:g/(s-1),f+6>l&&(l=g/(s-(e.offset?.5:1)),c=this.maxHeight-tu(e.grid)-t.padding-F1(e.title,this.chart.options.font),d=Math.sqrt(f*f+p*p),o=Eee(Math.min(Math.asin(os((h.highest.height+6)/l,-1,1)),Math.asin(os(c/d,-1,1))-Math.asin(os(p/d,-1,1)))),o=Math.max(r,Math.min(i,o))),this.labelRotation=o}afterCalculateLabelRotation(){Xt(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Xt(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:s,title:r,grid:i}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=F1(r,t.options.font);if(l?(e.width=this.maxWidth,e.height=tu(i)+c):(e.height=this.maxHeight,e.width=tu(i)+c),s.display&&this.ticks.length){const{first:d,last:h,widest:f,highest:p}=this._getLabelSizes(),g=s.padding*2,b=Ji(this.labelRotation),v=Math.cos(b),_=Math.sin(b);if(l){const N=s.mirror?0:_*f.width+v*p.height;e.height=Math.min(this.maxHeight,e.height+N+g)}else{const N=s.mirror?0:v*f.width+_*p.height;e.width=Math.min(this.maxWidth,e.width+N+g)}this._calculatePadding(d,h,_,v)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,s,r){const{ticks:{align:i,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,f=this.right-this.getPixelForTick(this.ticks.length-1);let p=0,g=0;c?d?(p=r*e.width,g=s*t.height):(p=s*e.height,g=r*t.width):i==="start"?g=t.width:i==="end"?p=e.width:i!=="inner"&&(p=e.width/2,g=t.width/2),this.paddingLeft=Math.max((p-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-f+o)*this.width/(this.width-f),0)}else{let h=t.height/2,f=e.height/2;i==="start"?(h=0,f=e.height):i==="end"&&(h=t.height,f=0),this.paddingTop=h+o,this.paddingBottom=f+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Xt(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,s;for(t=0,s=e.length;t<s;t++)At(e[t].label)&&(e.splice(t,1),s--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let s=this.ticks;t<s.length&&(s=L1(s,t)),this._labelSizes=e=this._computeLabelSizes(s,s.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,s){const{ctx:r,_longestTextCache:i}=this,o=[],l=[],c=Math.floor(t/R1(t,s));let d=0,h=0,f,p,g,b,v,_,N,j,k,S,P;for(f=0;f<t;f+=c){if(b=e[f].label,v=this._resolveTickFontOptions(f),r.font=_=v.string,N=i[_]=i[_]||{data:{},gc:[]},j=v.lineHeight,k=S=0,!At(b)&&!On(b))k=u1(r,N.data,N.gc,k,b),S=j;else if(On(b))for(p=0,g=b.length;p<g;++p)P=b[p],!At(P)&&!On(P)&&(k=u1(r,N.data,N.gc,k,P),S+=j);o.push(k),l.push(S),d=Math.max(k,d),h=Math.max(S,h)}Hne(i,t);const E=o.indexOf(d),M=l.indexOf(h),I=O=>({width:o[O]||0,height:l[O]||0});return{first:I(0),last:I(t-1),widest:I(E),highest:I(M),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return Mee(this._alignToPixels?Fo(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const s=t[e];return s.$context||(s.$context=Gne(this.getContext(),e,s))}return this.$context||(this.$context=Wne(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=Ji(this.labelRotation),s=Math.abs(Math.cos(t)),r=Math.abs(Math.sin(t)),i=this._getLabelSizes(),o=e.autoSkipPadding||0,l=i?i.widest.width+o:0,c=i?i.highest.height+o:0;return this.isHorizontal()?c*s>l*r?l/s:c/r:c*r<l*s?c/s:l/r}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,s=this.chart,r=this.options,{grid:i,position:o,border:l}=r,c=i.offset,d=this.isHorizontal(),f=this.ticks.length+(c?1:0),p=tu(i),g=[],b=l.setContext(this.getContext()),v=b.display?b.width:0,_=v/2,N=function(U){return Fo(s,U,v)};let j,k,S,P,E,M,I,O,D,z,H,F;if(o==="top")j=N(this.bottom),M=this.bottom-p,O=j-_,z=N(e.top)+_,F=e.bottom;else if(o==="bottom")j=N(this.top),z=e.top,F=N(e.bottom)-_,M=j+_,O=this.top+p;else if(o==="left")j=N(this.right),E=this.right-p,I=j-_,D=N(e.left)+_,H=e.right;else if(o==="right")j=N(this.left),D=e.left,H=N(e.right)-_,E=j+_,I=this.left+p;else if(t==="x"){if(o==="center")j=N((e.top+e.bottom)/2+.5);else if(bt(o)){const U=Object.keys(o)[0],W=o[U];j=N(this.chart.scales[U].getPixelForValue(W))}z=e.top,F=e.bottom,M=j+_,O=M+p}else if(t==="y"){if(o==="center")j=N((e.left+e.right)/2);else if(bt(o)){const U=Object.keys(o)[0],W=o[U];j=N(this.chart.scales[U].getPixelForValue(W))}E=j-_,I=E-p,D=e.left,H=e.right}const R=mt(r.ticks.maxTicksLimit,f),V=Math.max(1,Math.ceil(f/R));for(k=0;k<f;k+=V){const U=this.getContext(k),W=i.setContext(U),B=l.setContext(U),q=W.lineWidth,Q=W.color,le=B.dash||[],X=B.dashOffset,Z=W.tickWidth,se=W.tickColor,G=W.tickBorderDash||[],ne=W.tickBorderDashOffset;S=qne(this,k,c),S!==void 0&&(P=Fo(s,S,q),d?E=I=D=H=P:M=O=z=F=P,g.push({tx1:E,ty1:M,tx2:I,ty2:O,x1:D,y1:z,x2:H,y2:F,width:q,color:Q,borderDash:le,borderDashOffset:X,tickWidth:Z,tickColor:se,tickBorderDash:G,tickBorderDashOffset:ne}))}return this._ticksLength=f,this._borderValue=j,g}_computeLabelItems(e){const t=this.axis,s=this.options,{position:r,ticks:i}=s,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:f}=i,p=tu(s.grid),g=p+h,b=f?-h:g,v=-Ji(this.labelRotation),_=[];let N,j,k,S,P,E,M,I,O,D,z,H,F="middle";if(r==="top")E=this.bottom-b,M=this._getXAxisLabelAlignment();else if(r==="bottom")E=this.top+b,M=this._getXAxisLabelAlignment();else if(r==="left"){const V=this._getYAxisLabelAlignment(p);M=V.textAlign,P=V.x}else if(r==="right"){const V=this._getYAxisLabelAlignment(p);M=V.textAlign,P=V.x}else if(t==="x"){if(r==="center")E=(e.top+e.bottom)/2+g;else if(bt(r)){const V=Object.keys(r)[0],U=r[V];E=this.chart.scales[V].getPixelForValue(U)+g}M=this._getXAxisLabelAlignment()}else if(t==="y"){if(r==="center")P=(e.left+e.right)/2-g;else if(bt(r)){const V=Object.keys(r)[0],U=r[V];P=this.chart.scales[V].getPixelForValue(U)}M=this._getYAxisLabelAlignment(p).textAlign}t==="y"&&(c==="start"?F="top":c==="end"&&(F="bottom"));const R=this._getLabelSizes();for(N=0,j=l.length;N<j;++N){k=l[N],S=k.label;const V=i.setContext(this.getContext(N));I=this.getPixelForTick(N)+i.labelOffset,O=this._resolveTickFontOptions(N),D=O.lineHeight,z=On(S)?S.length:1;const U=z/2,W=V.color,B=V.textStrokeColor,q=V.textStrokeWidth;let Q=M;o?(P=I,M==="inner"&&(N===j-1?Q=this.options.reverse?"left":"right":N===0?Q=this.options.reverse?"right":"left":Q="center"),r==="top"?d==="near"||v!==0?H=-z*D+D/2:d==="center"?H=-R.highest.height/2-U*D+D:H=-R.highest.height+D/2:d==="near"||v!==0?H=D/2:d==="center"?H=R.highest.height/2-U*D:H=R.highest.height-z*D,f&&(H*=-1),v!==0&&!V.showLabelBackdrop&&(P+=D/2*Math.sin(v))):(E=I,H=(1-z)*D/2);let le;if(V.showLabelBackdrop){const X=Xr(V.backdropPadding),Z=R.heights[N],se=R.widths[N];let G=H-X.top,ne=0-X.left;switch(F){case"middle":G-=Z/2;break;case"bottom":G-=Z;break}switch(M){case"center":ne-=se/2;break;case"right":ne-=se;break;case"inner":N===j-1?ne-=se:N>0&&(ne-=se/2);break}le={left:ne,top:G,width:se+X.width,height:Z+X.height,color:V.backdropColor}}_.push({label:S,font:O,textOffset:H,options:{rotation:v,color:W,strokeColor:B,strokeWidth:q,textAlign:Q,textBaseline:F,translation:[P,E],backdrop:le}})}return _}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-Ji(this.labelRotation))return e==="top"?"left":"right";let r="center";return t.align==="start"?r="left":t.align==="end"?r="right":t.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:s,mirror:r,padding:i}}=this.options,o=this._getLabelSizes(),l=e+i,c=o.widest.width;let d,h;return t==="left"?r?(h=this.right+i,s==="near"?d="left":s==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,s==="near"?d="right":s==="center"?(d="center",h-=c/2):(d="left",h=this.left)):t==="right"?r?(h=this.left+i,s==="near"?d="right":s==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,s==="near"?d="left":s==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:s,top:r,width:i,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(s,r,i,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const r=this.ticks.findIndex(i=>i.value===e);return r>=0?t.setContext(this.getContext(r)).lineWidth:0}drawGrid(e){const t=this.options.grid,s=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let i,o;const l=(c,d,h)=>{!h.width||!h.color||(s.save(),s.lineWidth=h.width,s.strokeStyle=h.color,s.setLineDash(h.borderDash||[]),s.lineDashOffset=h.borderDashOffset,s.beginPath(),s.moveTo(c.x,c.y),s.lineTo(d.x,d.y),s.stroke(),s.restore())};if(t.display)for(i=0,o=r.length;i<o;++i){const c=r[i];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:s,grid:r}}=this,i=s.setContext(this.getContext()),o=s.display?i.width:0;if(!o)return;const l=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,f,p;this.isHorizontal()?(d=Fo(e,this.left,o)-o/2,h=Fo(e,this.right,l)+l/2,f=p=c):(f=Fo(e,this.top,o)-o/2,p=Fo(e,this.bottom,l)+l/2,d=h=c),t.save(),t.lineWidth=i.width,t.strokeStyle=i.color,t.beginPath(),t.moveTo(d,f),t.lineTo(h,p),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const s=this.ctx,r=this._computeLabelArea();r&&Zg(s,r);const i=this.getLabelItems(e);for(const o of i){const l=o.options,c=o.font,d=o.label,h=o.textOffset;qp(s,d,0,h,c,l)}r&&Kg(s)}drawTitle(){const{ctx:e,options:{position:t,title:s,reverse:r}}=this;if(!s.display)return;const i=Ls(s.font),o=Xr(s.padding),l=s.align;let c=i.lineHeight/2;t==="bottom"||t==="center"||bt(t)?(c+=o.bottom,On(s.text)&&(c+=i.lineHeight*(s.text.length-1))):c+=o.top;const{titleX:d,titleY:h,maxWidth:f,rotation:p}=Zne(this,c,t,l);qp(e,s.text,0,0,i,{color:s.color,maxWidth:f,rotation:p,textAlign:Yne(l,t,r),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,s=mt(e.grid&&e.grid.z,-1),r=mt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==vd.prototype.draw?[{z:t,draw:i=>{this.draw(i)}}]:[{z:s,draw:i=>{this.drawBackground(),this.drawGrid(i),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:t,draw:i=>{this.drawLabels(i)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),s=this.axis+"AxisID",r=[];let i,o;for(i=0,o=t.length;i<o;++i){const l=t[i];l[s]===this.id&&(!e||l.type===e)&&r.push(l)}return r}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Ls(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class em{constructor(e,t,s){this.type=e,this.scope=t,this.override=s,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let s;Qne(t)&&(s=this.register(t));const r=this.items,i=e.id,o=this.scope+"."+i;if(!i)throw new Error("class does not have id: "+e);return i in r||(r[i]=e,Kne(e,o,s),this.override&&Nn.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,s=e.id,r=this.scope;s in t&&delete t[s],r&&s in Nn[r]&&(delete Nn[r][s],this.override&&delete Nl[s])}}function Kne(n,e,t){const s=fh(Object.create(null),[t?Nn.get(t):{},Nn.get(e),n.defaults]);Nn.set(e,s),n.defaultRoutes&&Jne(e,n.defaultRoutes),n.descriptors&&Nn.describe(e,n.descriptors)}function Jne(n,e){Object.keys(e).forEach(t=>{const s=t.split("."),r=s.pop(),i=[n].concat(s).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");Nn.route(i,r,c,l)})}function Qne(n){return"id"in n&&"defaults"in n}class Xne{constructor(){this.controllers=new em(ul,"datasets",!0),this.elements=new em(_o,"elements"),this.plugins=new em(Object,"plugins"),this.scales=new em(vd,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,s){[...t].forEach(r=>{const i=s||this._getRegistryForType(r);s||i.isForType(r)||i===this.plugins&&r.id?this._exec(e,i,r):It(r,o=>{const l=s||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,s){const r=D_(e);Xt(s["before"+r],[],s),t[e](s),Xt(s["after"+r],[],s)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const s=this._typedRegistries[t];if(s.isForType(e))return s}return this.plugins}_get(e,t,s){const r=t.get(e);if(r===void 0)throw new Error('"'+e+'" is not a registered '+s+".");return r}}var fi=new Xne;class ese{constructor(){this._init=void 0}notify(e,t,s,r){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const i=r?this._descriptors(e).filter(r):this._descriptors(e),o=this._notify(i,e,t,s);return t==="afterDestroy"&&(this._notify(i,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,s,r){r=r||{};for(const i of e){const o=i.plugin,l=o[s],c=[t,r,i.options];if(Xt(l,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){At(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const s=e&&e.config,r=mt(s.options&&s.options.plugins,{}),i=tse(s);return r===!1&&!t?[]:sse(e,i,r,t)}_notifyStateChanges(e){const t=this._oldCache||[],s=this._cache,r=(i,o)=>i.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(r(t,s),e,"stop"),this._notify(r(s,t),e,"start")}}function tse(n){const e={},t=[],s=Object.keys(fi.plugins.items);for(let i=0;i<s.length;i++)t.push(fi.getPlugin(s[i]));const r=n.plugins||[];for(let i=0;i<r.length;i++){const o=r[i];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function nse(n,e){return!e&&n===!1?null:n===!0?{}:n}function sse(n,{plugins:e,localIds:t},s,r){const i=[],o=n.getContext();for(const l of e){const c=l.id,d=nse(s[c],r);d!==null&&i.push({plugin:l,options:rse(n.config,{plugin:l,local:t[c]},d,o)})}return i}function rse(n,{plugin:e,local:t},s,r){const i=n.pluginScopeKeys(e),o=n.getOptionScopes(s,i);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function i0(n,e){const t=Nn.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function ise(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function ase(n,e){return n===e?"_index_":"_value_"}function $1(n){if(n==="x"||n==="y"||n==="r")return n}function ose(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function a0(n,...e){if($1(n))return n;for(const t of e){const s=t.axis||ose(t.position)||n.length>1&&$1(n[0].toLowerCase());if(s)return s}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function z1(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function lse(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(s=>s.xAxisID===n||s.yAxisID===n);if(t.length)return z1(n,"x",t[0])||z1(n,"y",t[0])}return{}}function cse(n,e){const t=Nl[n.type]||{scales:{}},s=e.scales||{},r=i0(n.type,e),i=Object.create(null);return Object.keys(s).forEach(o=>{const l=s[o];if(!bt(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=a0(o,l,lse(o,n),Nn.scales[l.type]),d=ase(c,r),h=t.scales||{};i[o]=Du(Object.create(null),[{axis:c},l,h[c],h[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||i0(l,e),h=(Nl[l]||{}).scales||{};Object.keys(h).forEach(f=>{const p=ise(f,c),g=o[p+"AxisID"]||p;i[g]=i[g]||Object.create(null),Du(i[g],[{axis:p},s[g],h[f]])})}),Object.keys(i).forEach(o=>{const l=i[o];Du(l,[Nn.scales[l.type],Nn.scale])}),i}function zI(n){const e=n.options||(n.options={});e.plugins=mt(e.plugins,{}),e.scales=cse(n,e)}function UI(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function dse(n){return n=n||{},n.data=UI(n.data),zI(n),n}const U1=new Map,VI=new Set;function tm(n,e){let t=U1.get(n);return t||(t=e(),U1.set(n,t),VI.add(t)),t}const nu=(n,e,t)=>{const s=Sl(e,t);s!==void 0&&n.add(s)};class use{constructor(e){this._config=dse(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=UI(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),zI(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return tm(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return tm(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return tm(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,s=this.type;return tm(`${s}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const s=this._scopeCache;let r=s.get(e);return(!r||t)&&(r=new Map,s.set(e,r)),r}getOptionScopes(e,t,s){const{options:r,type:i}=this,o=this._cachedScopes(e,s),l=o.get(t);if(l)return l;const c=new Set;t.forEach(h=>{e&&(c.add(e),h.forEach(f=>nu(c,e,f))),h.forEach(f=>nu(c,r,f)),h.forEach(f=>nu(c,Nl[i]||{},f)),h.forEach(f=>nu(c,Nn,f)),h.forEach(f=>nu(c,s0,f))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),VI.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,Nl[t]||{},Nn.datasets[t]||{},{type:t},Nn,s0]}resolveNamedOptions(e,t,s,r=[""]){const i={$shared:!0},{resolver:o,subPrefixes:l}=V1(this._resolverCache,e,r);let c=o;if(fse(o,t)){i.$shared=!1,s=lo(s)?s():s;const d=this.createResolver(e,s,l);c=id(o,s,d)}for(const d of t)i[d]=c[d];return i}createResolver(e,t,s=[""],r){const{resolver:i}=V1(this._resolverCache,e,s);return bt(t)?id(i,t,void 0,r):i}}function V1(n,e,t){let s=n.get(e);s||(s=new Map,n.set(e,s));const r=t.join();let i=s.get(r);return i||(i={resolver:L_(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},s.set(r,i)),i}const hse=n=>bt(n)&&Object.getOwnPropertyNames(n).some(e=>lo(n[e]));function fse(n,e){const{isScriptable:t,isIndexable:s}=wI(n);for(const r of e){const i=t(r),o=s(r),l=(o||i)&&n[r];if(i&&(lo(l)||hse(l))||o&&On(l))return!0}return!1}var mse="4.5.1";const pse=["top","bottom","left","right","chartArea"];function B1(n,e){return n==="top"||n==="bottom"||pse.indexOf(n)===-1&&e==="x"}function q1(n,e){return function(t,s){return t[n]===s[n]?t[e]-s[e]:t[n]-s[n]}}function H1(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Xt(t&&t.onComplete,[n],e)}function gse(n){const e=n.chart,t=e.options.animation;Xt(t&&t.onProgress,[n],e)}function BI(n){return z_()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const Om={},W1=n=>{const e=BI(n);return Object.values(Om).filter(t=>t.canvas===e).pop()};function yse(n,e,t){const s=Object.keys(n);for(const r of s){const i=+r;if(i>=e){const o=n[r];delete n[r],(t>0||i>e)&&(n[i+t]=o)}}}function xse(n,e,t,s){return!t||n.type==="mouseout"?null:s?e:n}class gi{static register(...e){fi.add(...e),G1()}static unregister(...e){fi.remove(...e),G1()}constructor(e,t){const s=this.config=new use(t),r=BI(e),i=W1(r);if(i)throw new Error("Canvas is already in use. Chart with ID '"+i.id+"' must be destroyed before the canvas with ID '"+i.canvas.id+"' can be reused.");const o=s.createResolver(s.chartOptionScopes(),this.getContext());this.platform=new(s.platform||Rne(r)),this.platform.updateConfig(s);const l=this.platform.acquireContext(r,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=gee(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new ese,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Oee(f=>this.update(f),o.resizeDelay||0),this._dataChanges=[],Om[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}Ui.listen(this,"complete",H1),Ui.listen(this,"progress",gse),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:s,height:r,_aspectRatio:i}=this;return At(e)?t&&i?i:r?s/r:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return fi}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():p1(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return h1(this.canvas,this.ctx),this}stop(){return Ui.stop(this),this}resize(e,t){Ui.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const s=this.options,r=this.canvas,i=s.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(r,e,t,i),l=s.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,p1(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Xt(s.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};It(t,(s,r)=>{s.id=r})}buildOrUpdateScales(){const e=this.options,t=e.scales,s=this.scales,r=Object.keys(s).reduce((o,l)=>(o[l]=!1,o),{});let i=[];t&&(i=i.concat(Object.keys(t).map(o=>{const l=t[o],c=a0(o,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),It(i,o=>{const l=o.options,c=l.id,d=a0(c,l),h=mt(l.type,o.dtype);(l.position===void 0||B1(l.position,d)!==B1(o.dposition))&&(l.position=o.dposition),r[c]=!0;let f=null;if(c in s&&s[c].type===h)f=s[c];else{const p=fi.getScale(h);f=new p({id:c,type:h,ctx:this.ctx,chart:this}),s[f.id]=f}f.init(l,e)}),It(r,(o,l)=>{o||delete s[l]}),It(s,o=>{La.configure(this,o,o.options),La.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,s=e.length;if(e.sort((r,i)=>r.index-i.index),s>t){for(let r=t;r<s;++r)this._destroyDatasetMeta(r);e.splice(t,s-t)}this._sortedMetasets=e.slice(0).sort(q1("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((s,r)=>{t.filter(i=>i===s._dataset).length===0&&this._destroyDatasetMeta(r)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let s,r;for(this._removeUnreferencedMetasets(),s=0,r=t.length;s<r;s++){const i=t[s];let o=this.getDatasetMeta(s);const l=i.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(s),o=this.getDatasetMeta(s)),o.type=l,o.indexAxis=i.indexAxis||i0(l,this.options),o.order=i.order||0,o.index=s,o.label=""+i.label,o.visible=this.isDatasetVisible(s),o.controller)o.controller.updateIndex(s),o.controller.linkScales();else{const c=fi.getController(l),{datasetElementType:d,dataElementType:h}=Nn.datasets[l];Object.assign(c,{dataElementType:fi.getElement(h),datasetElementType:d&&fi.getElement(d)}),o.controller=new c(this,s),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){It(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const s=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),r=this._animationsDisabled=!s.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const i=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:f}=this.getDatasetMeta(d),p=!r&&i.indexOf(f)===-1;f.buildOrUpdateElements(p),o=Math.max(+f.getMaxOverflow(),o)}o=this._minPadding=s.layout.autoPadding?o:0,this._updateLayout(o),r||It(i,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(q1("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){It(this.scales,e=>{La.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),s=new Set(e.events);(!n1(t,s)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:s,start:r,count:i}of t){const o=s==="_removeElements"?-i:i;yse(e,r,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,s=i=>new Set(e.filter(o=>o[0]===i).map((o,l)=>l+","+o.splice(1).join(","))),r=s(0);for(let i=1;i<t;i++)if(!n1(r,s(i)))return;return Array.from(r).map(i=>i.split(",")).map(i=>({method:i[1],start:+i[2],count:+i[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;La.update(this,this.width,this.height,e);const t=this.chartArea,s=t.width<=0||t.height<=0;this._layers=[],It(this.boxes,r=>{s&&r.position==="chartArea"||(r.configure&&r.configure(),this._layers.push(...r._layers()))},this),this._layers.forEach((r,i)=>{r._idx=i}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,s=this.data.datasets.length;t<s;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,s=this.data.datasets.length;t<s;++t)this._updateDataset(t,lo(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const s=this.getDatasetMeta(e),r={meta:s,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",r)!==!1&&(s.controller._update(t),r.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",r))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ui.has(this)?this.attached&&!Ui.running(this)&&Ui.start(this):(this.draw(),H1({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:s,height:r}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(s,r)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,s=[];let r,i;for(r=0,i=t.length;r<i;++r){const o=t[r];(!e||o.visible)&&s.push(o)}return s}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,s={meta:e,index:e.index,cancelable:!0},r=MI(this,e);this.notifyPlugins("beforeDatasetDraw",s)!==!1&&(r&&Zg(t,r),e.controller.draw(),r&&Kg(t),s.cancelable=!1,this.notifyPlugins("afterDatasetDraw",s))}isPointInArea(e){return yh(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,s,r){const i=pne.modes[t];return typeof i=="function"?i(this,e,s,r):[]}getDatasetMeta(e){const t=this.data.datasets[e],s=this._metasets;let r=s.filter(i=>i&&i._dataset===t).pop();return r||(r={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},s.push(r)),r}getContext(){return this.$context||(this.$context=Rl(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const s=this.getDatasetMeta(e);return typeof s.hidden=="boolean"?!s.hidden:!t.hidden}setDatasetVisibility(e,t){const s=this.getDatasetMeta(e);s.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,s){const r=s?"show":"hide",i=this.getDatasetMeta(e),o=i.controller._resolveAnimations(void 0,r);mh(t)?(i.data[t].hidden=!s,this.update()):(this.setDatasetVisibility(e,s),o.update(i,{visible:s}),this.update(l=>l.datasetIndex===e?r:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),Ui.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),h1(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete Om[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,s=(i,o)=>{t.addEventListener(this,i,o),e[i]=o},r=(i,o,l)=>{i.offsetX=o,i.offsetY=l,this._eventHandler(i)};It(this.options.events,i=>s(i,r))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,s=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},r=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},i=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{r("attach",l),this.attached=!0,this.resize(),s("resize",i),s("detach",o)};o=()=>{this.attached=!1,r("resize",i),this._stop(),this._resize(0,0),s("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){It(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},It(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,s){const r=s?"set":"remove";let i,o,l,c;for(t==="dataset"&&(i=this.getDatasetMeta(e[0].datasetIndex),i.controller["_"+r+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[r+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],s=e.map(({datasetIndex:i,index:o})=>{const l=this.getDatasetMeta(i);if(!l)throw new Error("No dataset found at index "+i);return{datasetIndex:i,element:l.data[o],index:o}});!Up(s,t)&&(this._active=s,this._lastEvent=null,this._updateHoverStyles(s,t))}notifyPlugins(e,t,s){return this._plugins.notify(this,e,t,s)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,s){const r=this.options.hover,i=(c,d)=>c.filter(h=>!d.some(f=>h.datasetIndex===f.datasetIndex&&h.index===f.index)),o=i(t,e),l=s?e:i(e,t);o.length&&this.updateHoverStyle(o,r.mode,!1),l.length&&r.mode&&this.updateHoverStyle(l,r.mode,!0)}_eventHandler(e,t){const s={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},r=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",s,r)===!1)return;const i=this._handleEvent(e,t,s.inChartArea);return s.cancelable=!1,this.notifyPlugins("afterEvent",s,r),(i||s.changed)&&this.render(),this}_handleEvent(e,t,s){const{_active:r=[],options:i}=this,o=t,l=this._getActiveElements(e,r,s,o),c=_ee(e),d=xse(e,this._lastEvent,s,c);s&&(this._lastEvent=null,Xt(i.onHover,[e,l,this],this),c&&Xt(i.onClick,[e,l,this],this));const h=!Up(l,r);return(h||t)&&(this._active=l,this._updateHoverStyles(l,r,t)),this._lastEvent=d,h}_getActiveElements(e,t,s,r){if(e.type==="mouseout")return[];if(!s)return t;const i=this.options.hover;return this.getElementsAtEventForMode(e,i.mode,i,r)}}xe(gi,"defaults",Nn),xe(gi,"instances",Om),xe(gi,"overrides",Nl),xe(gi,"registry",fi),xe(gi,"version",mse),xe(gi,"getChart",W1);function G1(){return It(gi.instances,n=>n._plugins.invalidate())}function vse(n,e,t){const{startAngle:s,x:r,y:i,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,f=Math.min(d/o,Qs(s-t));if(n.beginPath(),n.arc(r,i,o-d/2,s+f/2,t-f/2),l>0){const p=Math.min(d/l,Qs(s-t));n.arc(r,i,l+d/2,t-p/2,s+p/2,!0)}else{const p=Math.min(d/2,o*Qs(s-t));if(h==="round")n.arc(r,i,p,t-Ut/2,s+Ut/2,!0);else if(h==="bevel"){const g=2*p*p,b=-g*Math.cos(t+Ut/2)+r,v=-g*Math.sin(t+Ut/2)+i,_=g*Math.cos(s+Ut/2)+r,N=g*Math.sin(s+Ut/2)+i;n.lineTo(b,v),n.lineTo(_,N)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function bse(n,e,t){const{startAngle:s,pixelMargin:r,x:i,y:o,outerRadius:l,innerRadius:c}=e;let d=r/l;n.beginPath(),n.arc(i,o,l,s-d,t+d),c>r?(d=r/c,n.arc(i,o,c,t+d,s-d,!0)):n.arc(i,o,r,t+Ln,s-Ln),n.closePath(),n.clip()}function wse(n){return R_(n,["outerStart","outerEnd","innerStart","innerEnd"])}function _se(n,e,t,s){const r=wse(n.options.borderRadius),i=(t-e)/2,o=Math.min(i,s*e/2),l=c=>{const d=(t-Math.min(i,c))*s/2;return os(c,0,Math.min(i,d))};return{outerStart:l(r.outerStart),outerEnd:l(r.outerEnd),innerStart:os(r.innerStart,0,o),innerEnd:os(r.innerEnd,0,o)}}function ic(n,e,t,s){return{x:t+n*Math.cos(e),y:s+n*Math.sin(e)}}function Yp(n,e,t,s,r,i){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,f=Math.max(e.outerRadius+s+t-d,0),p=h>0?h+s+t+d:0;let g=0;const b=r-c;if(s){const V=h>0?h-s:0,U=f>0?f-s:0,W=(V+U)/2,B=W!==0?b*W/(W+s):b;g=(b-B)/2}const v=Math.max(.001,b*f-t/Ut)/f,_=(b-v)/2,N=c+_+g,j=r-_-g,{outerStart:k,outerEnd:S,innerStart:P,innerEnd:E}=_se(e,p,f,j-N),M=f-k,I=f-S,O=N+k/M,D=j-S/I,z=p+P,H=p+E,F=N+P/z,R=j-E/H;if(n.beginPath(),i){const V=(O+D)/2;if(n.arc(o,l,f,O,V),n.arc(o,l,f,V,D),S>0){const q=ic(I,D,o,l);n.arc(q.x,q.y,S,D,j+Ln)}const U=ic(H,j,o,l);if(n.lineTo(U.x,U.y),E>0){const q=ic(H,R,o,l);n.arc(q.x,q.y,E,j+Ln,R+Math.PI)}const W=(j-E/p+(N+P/p))/2;if(n.arc(o,l,p,j-E/p,W,!0),n.arc(o,l,p,W,N+P/p,!0),P>0){const q=ic(z,F,o,l);n.arc(q.x,q.y,P,F+Math.PI,N-Ln)}const B=ic(M,N,o,l);if(n.lineTo(B.x,B.y),k>0){const q=ic(M,O,o,l);n.arc(q.x,q.y,k,N-Ln,O)}}else{n.moveTo(o,l);const V=Math.cos(O)*f+o,U=Math.sin(O)*f+l;n.lineTo(V,U);const W=Math.cos(D)*f+o,B=Math.sin(D)*f+l;n.lineTo(W,B)}n.closePath()}function Sse(n,e,t,s,r){const{fullCircles:i,startAngle:o,circumference:l}=e;let c=e.endAngle;if(i){Yp(n,e,t,s,c,r);for(let d=0;d<i;++d)n.fill();isNaN(l)||(c=o+(l%hn||hn))}return Yp(n,e,t,s,c,r),n.fill(),c}function Nse(n,e,t,s,r){const{fullCircles:i,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:f,borderDashOffset:p,borderRadius:g}=c,b=c.borderAlign==="inner";if(!d)return;n.setLineDash(f||[]),n.lineDashOffset=p,b?(n.lineWidth=d*2,n.lineJoin=h||"round"):(n.lineWidth=d,n.lineJoin=h||"bevel");let v=e.endAngle;if(i){Yp(n,e,t,s,v,r);for(let _=0;_<i;++_)n.stroke();isNaN(l)||(v=o+(l%hn||hn))}b&&bse(n,e,v),c.selfJoin&&v-o>=Ut&&g===0&&h!=="miter"&&vse(n,e,v),i||(Yp(n,e,t,s,v,r),n.stroke())}class pu extends _o{constructor(t){super();xe(this,"circumference");xe(this,"endAngle");xe(this,"fullCircles");xe(this,"innerRadius");xe(this,"outerRadius");xe(this,"pixelMargin");xe(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,s,r){const i=this.getProps(["x","y"],r),{angle:o,distance:l}=hI(i,{x:t,y:s}),{startAngle:c,endAngle:d,innerRadius:h,outerRadius:f,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),g=(this.options.spacing+this.options.borderWidth)/2,b=mt(p,d-c),v=gh(o,c,d)&&c!==d,_=b>=hn||v,N=Qi(l,h+g,f+g);return _&&N}getCenterPoint(t){const{x:s,y:r,startAngle:i,endAngle:o,innerRadius:l,outerRadius:c}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:d,spacing:h}=this.options,f=(i+o)/2,p=(l+c+h+d)/2;return{x:s+Math.cos(f)*p,y:r+Math.sin(f)*p}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){const{options:s,circumference:r}=this,i=(s.offset||0)/4,o=(s.spacing||0)/2,l=s.circular;if(this.pixelMargin=s.borderAlign==="inner"?.33:0,this.fullCircles=r>hn?Math.floor(r/hn):0,r===0||this.innerRadius<0||this.outerRadius<0)return;t.save();const c=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(c)*i,Math.sin(c)*i);const d=1-Math.sin(Math.min(Ut,r||0)),h=i*d;t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,Sse(t,this,h,o,l),Nse(t,this,h,o,l),t.restore()}}xe(pu,"id","arc"),xe(pu,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),xe(pu,"defaultRoutes",{backgroundColor:"backgroundColor"}),xe(pu,"descriptors",{_scriptable:!0,_indexable:t=>t!=="borderDash"});function qI(n,e,t=e){n.lineCap=mt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(mt(t.borderDash,e.borderDash)),n.lineDashOffset=mt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=mt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=mt(t.borderWidth,e.borderWidth),n.strokeStyle=mt(t.borderColor,e.borderColor)}function jse(n,e,t){n.lineTo(t.x,t.y)}function Cse(n){return n.stepped?Zee:n.tension||n.cubicInterpolationMode==="monotone"?Kee:jse}function HI(n,e,t={}){const s=n.length,{start:r=0,end:i=s-1}=t,{start:o,end:l}=e,c=Math.max(r,o),d=Math.min(i,l),h=r<o&&i<o||r>l&&i>l;return{count:s,start:c,loop:e.loop,ilen:d<c&&!h?s+d-c:d-c}}function kse(n,e,t,s){const{points:r,options:i}=e,{count:o,start:l,loop:c,ilen:d}=HI(r,t,s),h=Cse(i);let{move:f=!0,reverse:p}=s||{},g,b,v;for(g=0;g<=d;++g)b=r[(l+(p?d-g:g))%o],!b.skip&&(f?(n.moveTo(b.x,b.y),f=!1):h(n,v,b,p,i.stepped),v=b);return c&&(b=r[(l+(p?d:0))%o],h(n,v,b,p,i.stepped)),!!c}function Tse(n,e,t,s){const r=e.points,{count:i,start:o,ilen:l}=HI(r,t,s),{move:c=!0,reverse:d}=s||{};let h=0,f=0,p,g,b,v,_,N;const j=S=>(o+(d?l-S:S))%i,k=()=>{v!==_&&(n.lineTo(h,_),n.lineTo(h,v),n.lineTo(h,N))};for(c&&(g=r[j(0)],n.moveTo(g.x,g.y)),p=0;p<=l;++p){if(g=r[j(p)],g.skip)continue;const S=g.x,P=g.y,E=S|0;E===b?(P<v?v=P:P>_&&(_=P),h=(f*h+S)/++f):(k(),n.lineTo(S,P),b=E,f=0,v=_=P),N=P}k()}function o0(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?Tse:kse}function Ese(n){return n.stepped?Tte:n.tension||n.cubicInterpolationMode==="monotone"?Ete:Go}function Pse(n,e,t,s){let r=e._path;r||(r=e._path=new Path2D,e.path(r,t,s)&&r.closePath()),qI(n,e.options),n.stroke(r)}function Mse(n,e,t,s){const{segments:r,options:i}=e,o=o0(e);for(const l of r)qI(n,i,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+s-1})&&n.closePath(),n.stroke()}const Dse=typeof Path2D=="function";function Ase(n,e,t,s){Dse&&!e.options.segment?Pse(n,e,t,s):Mse(n,e,t,s)}class Fa extends _o{constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const s=this.options;if((s.tension||s.cubicInterpolationMode==="monotone")&&!s.stepped&&!this._pointsUpdated){const r=s.spanGaps?this._loop:this._fullLoop;bte(this._points,s,e,r,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=Ote(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,s=e.length;return s&&t[e[s-1].end]}interpolate(e,t){const s=this.options,r=e[t],i=this.points,o=PI(this,{property:t,start:r,end:r});if(!o.length)return;const l=[],c=Ese(s);let d,h;for(d=0,h=o.length;d<h;++d){const{start:f,end:p}=o[d],g=i[f],b=i[p];if(g===b){l.push(g);continue}const v=Math.abs((r-g[t])/(b[t]-g[t])),_=c(g,b,v,s.stepped);_[t]=e[t],l.push(_)}return l.length===1?l[0]:l}pathSegment(e,t,s){return o0(this)(e,this,t,s)}path(e,t,s){const r=this.segments,i=o0(this);let o=this._loop;t=t||0,s=s||this.points.length-t;for(const l of r)o&=i(e,this,l,{start:t,end:t+s-1});return!!o}draw(e,t,s,r){const i=this.options||{};(this.points||[]).length&&i.borderWidth&&(e.save(),Ase(e,this,s,r),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}xe(Fa,"id","line"),xe(Fa,"defaults",{borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0}),xe(Fa,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"}),xe(Fa,"descriptors",{_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"});function Y1(n,e,t,s){const r=n.options,{[t]:i}=n.getProps([t],s);return Math.abs(e-i)<r.radius+r.hitRadius}class Rm extends _o{constructor(t){super();xe(this,"parsed");xe(this,"skip");xe(this,"stop");this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,t&&Object.assign(this,t)}inRange(t,s,r){const i=this.options,{x:o,y:l}=this.getProps(["x","y"],r);return Math.pow(t-o,2)+Math.pow(s-l,2)<Math.pow(i.hitRadius+i.radius,2)}inXRange(t,s){return Y1(this,t,"x",s)}inYRange(t,s){return Y1(this,t,"y",s)}getCenterPoint(t){const{x:s,y:r}=this.getProps(["x","y"],t);return{x:s,y:r}}size(t){t=t||this.options||{};let s=t.radius||0;s=Math.max(s,s&&t.hoverRadius||0);const r=s&&t.borderWidth||0;return(s+r)*2}draw(t,s){const r=this.options;this.skip||r.radius<.1||!yh(this,s,this.size(r)/2)||(t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.fillStyle=r.backgroundColor,r0(t,r,this.x,this.y))}getRange(){const t=this.options||{};return t.radius+t.hitRadius}}xe(Rm,"id","point"),xe(Rm,"defaults",{borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0}),xe(Rm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function WI(n,e){const{x:t,y:s,base:r,width:i,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,h,f;return n.horizontal?(f=o/2,l=Math.min(t,r),c=Math.max(t,r),d=s-f,h=s+f):(f=i/2,l=t-f,c=t+f,d=Math.min(s,r),h=Math.max(s,r)),{left:l,top:d,right:c,bottom:h}}function $a(n,e,t,s){return n?0:os(e,t,s)}function Ise(n,e,t){const s=n.options.borderWidth,r=n.borderSkipped,i=bI(s);return{t:$a(r.top,i.top,0,t),r:$a(r.right,i.right,0,e),b:$a(r.bottom,i.bottom,0,t),l:$a(r.left,i.left,0,e)}}function Ose(n,e,t){const{enableBorderRadius:s}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,i=Lc(r),o=Math.min(e,t),l=n.borderSkipped,c=s||bt(r);return{topLeft:$a(!c||l.top||l.left,i.topLeft,0,o),topRight:$a(!c||l.top||l.right,i.topRight,0,o),bottomLeft:$a(!c||l.bottom||l.left,i.bottomLeft,0,o),bottomRight:$a(!c||l.bottom||l.right,i.bottomRight,0,o)}}function Rse(n){const e=WI(n),t=e.right-e.left,s=e.bottom-e.top,r=Ise(n,t/2,s/2),i=Ose(n,t/2,s/2);return{outer:{x:e.left,y:e.top,w:t,h:s,radius:i},inner:{x:e.left+r.l,y:e.top+r.t,w:t-r.l-r.r,h:s-r.t-r.b,radius:{topLeft:Math.max(0,i.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,i.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,i.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,i.bottomRight-Math.max(r.b,r.r))}}}}function qx(n,e,t,s){const r=e===null,i=t===null,l=n&&!(r&&i)&&WI(n,s);return l&&(r||Qi(e,l.left,l.right))&&(i||Qi(t,l.top,l.bottom))}function Lse(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Fse(n,e){n.rect(e.x,e.y,e.w,e.h)}function Hx(n,e,t={}){const s=n.x!==t.x?-e:0,r=n.y!==t.y?-e:0,i=(n.x+n.w!==t.x+t.w?e:0)-s,o=(n.y+n.h!==t.y+t.h?e:0)-r;return{x:n.x+s,y:n.y+r,w:n.w+i,h:n.h+o,radius:n.radius}}class Lm extends _o{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:s,backgroundColor:r}}=this,{inner:i,outer:o}=Rse(this),l=Lse(o.radius)?Hp:Fse;e.save(),(o.w!==i.w||o.h!==i.h)&&(e.beginPath(),l(e,Hx(o,t,i)),e.clip(),l(e,Hx(i,-t,o)),e.fillStyle=s,e.fill("evenodd")),e.beginPath(),l(e,Hx(i,t)),e.fillStyle=r,e.fill(),e.restore()}inRange(e,t,s){return qx(this,e,t,s)}inXRange(e,t){return qx(this,e,null,t)}inYRange(e,t){return qx(this,null,e,t)}getCenterPoint(e){const{x:t,y:s,base:r,horizontal:i}=this.getProps(["x","y","base","horizontal"],e);return{x:i?(t+r)/2:t,y:i?s:(s+r)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}xe(Lm,"id","bar"),xe(Lm,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),xe(Lm,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});function $se(n,e,t){const s=n.segments,r=n.points,i=e.points,o=[];for(const l of s){let{start:c,end:d}=l;d=Xg(c,d,r);const h=l0(t,r[c],r[d],l.loop);if(!e.segments){o.push({source:l,target:h,start:r[c],end:r[d]});continue}const f=PI(e,h);for(const p of f){const g=l0(t,i[p.start],i[p.end],p.loop),b=EI(l,r,g);for(const v of b)o.push({source:v,target:p,start:{[t]:Z1(h,g,"start",Math.max)},end:{[t]:Z1(h,g,"end",Math.min)}})}}return o}function l0(n,e,t,s){if(s)return;let r=e[n],i=t[n];return n==="angle"&&(r=Qs(r),i=Qs(i)),{property:n,start:r,end:i}}function zse(n,e){const{x:t=null,y:s=null}=n||{},r=e.points,i=[];return e.segments.forEach(({start:o,end:l})=>{l=Xg(o,l,r);const c=r[o],d=r[l];s!==null?(i.push({x:c.x,y:s}),i.push({x:d.x,y:s})):t!==null&&(i.push({x:t,y:c.y}),i.push({x:t,y:d.y}))}),i}function Xg(n,e,t){for(;e>n;e--){const s=t[e];if(!isNaN(s.x)&&!isNaN(s.y))break}return e}function Z1(n,e,t,s){return n&&e?s(n[t],e[t]):n?n[t]:e?e[t]:0}function GI(n,e){let t=[],s=!1;return On(n)?(s=!0,t=n):t=zse(n,e),t.length?new Fa({points:t,options:{tension:0},_loop:s,_fullLoop:s}):null}function K1(n){return n&&n.fill!==!1}function Use(n,e,t){let r=n[e].fill;const i=[e];let o;if(!t)return r;for(;r!==!1&&i.indexOf(r)===-1;){if(!ds(r))return r;if(o=n[r],!o)return!1;if(o.visible)return r;i.push(r),r=o.fill}return!1}function Vse(n,e,t){const s=Wse(n);if(bt(s))return isNaN(s.value)?!1:s;let r=parseFloat(s);return ds(r)&&Math.floor(r)===r?Bse(s[0],e,r,t):["origin","start","end","stack","shape"].indexOf(s)>=0&&s}function Bse(n,e,t,s){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=s?!1:t}function qse(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:bt(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Hse(n,e,t){let s;return n==="start"?s=t:n==="end"?s=e.options.reverse?e.min:e.max:bt(n)?s=n.value:s=e.getBaseValue(),s}function Wse(n){const e=n.options,t=e.fill;let s=mt(t&&t.target,t);return s===void 0&&(s=!!e.backgroundColor),s===!1||s===null?!1:s===!0?"origin":s}function Gse(n){const{scale:e,index:t,line:s}=n,r=[],i=s.segments,o=s.points,l=Yse(e,t);l.push(GI({x:null,y:e.bottom},s));for(let c=0;c<i.length;c++){const d=i[c];for(let h=d.start;h<=d.end;h++)Zse(r,o[h],l)}return new Fa({points:r,options:{}})}function Yse(n,e){const t=[],s=n.getMatchingVisibleMetas("line");for(let r=0;r<s.length;r++){const i=s[r];if(i.index===e)break;i.hidden||t.unshift(i.dataset)}return t}function Zse(n,e,t){const s=[];for(let r=0;r<t.length;r++){const i=t[r],{first:o,last:l,point:c}=Kse(i,e,"x");if(!(!c||o&&l)){if(o)s.unshift(c);else if(n.push(c),!l)break}}n.push(...s)}function Kse(n,e,t){const s=n.interpolate(e,t);if(!s)return{};const r=s[t],i=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<i.length;d++){const h=i[d],f=o[h.start][t],p=o[h.end][t];if(Qi(r,f,p)){l=r===f,c=r===p;break}}return{first:l,last:c,point:s}}class YI{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,s){const{x:r,y:i,radius:o}=this;return t=t||{start:0,end:hn},e.arc(r,i,o,t.end,t.start,!0),!s.bounds}interpolate(e){const{x:t,y:s,radius:r}=this,i=e.angle;return{x:t+Math.cos(i)*r,y:s+Math.sin(i)*r,angle:i}}}function Jse(n){const{chart:e,fill:t,line:s}=n;if(ds(t))return Qse(e,t);if(t==="stack")return Gse(n);if(t==="shape")return!0;const r=Xse(n);return r instanceof YI?r:GI(r,s)}function Qse(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function Xse(n){return(n.scale||{}).getPointPositionForValue?tre(n):ere(n)}function ere(n){const{scale:e={},fill:t}=n,s=qse(t,e);if(ds(s)){const r=e.isHorizontal();return{x:r?s:null,y:r?null:s}}return null}function tre(n){const{scale:e,fill:t}=n,s=e.options,r=e.getLabels().length,i=s.reverse?e.max:e.min,o=Hse(t,e,i),l=[];if(s.grid.circular){const c=e.getPointPositionForValue(0,i);return new YI({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<r;++c)l.push(e.getPointPositionForValue(c,o));return l}function Wx(n,e,t){const s=Jse(e),{chart:r,index:i,line:o,scale:l,axis:c}=e,d=o.options,h=d.fill,f=d.backgroundColor,{above:p=f,below:g=f}=h||{},b=r.getDatasetMeta(i),v=MI(r,b);s&&o.points.length&&(Zg(n,t),nre(n,{line:o,target:s,above:p,below:g,area:t,scale:l,axis:c,clip:v}),Kg(n))}function nre(n,e){const{line:t,target:s,above:r,below:i,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let h=i;i!==r&&(d==="x"?(J1(n,s,o.top),Gx(n,{line:t,target:s,color:r,scale:l,property:d,clip:c}),n.restore(),n.save(),J1(n,s,o.bottom)):d==="y"&&(Q1(n,s,o.left),Gx(n,{line:t,target:s,color:i,scale:l,property:d,clip:c}),n.restore(),n.save(),Q1(n,s,o.right),h=r)),Gx(n,{line:t,target:s,color:h,scale:l,property:d,clip:c}),n.restore()}function J1(n,e,t){const{segments:s,points:r}=e;let i=!0,o=!1;n.beginPath();for(const l of s){const{start:c,end:d}=l,h=r[c],f=r[Xg(c,d,r)];i?(n.moveTo(h.x,h.y),i=!1):(n.lineTo(h.x,t),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(f.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function Q1(n,e,t){const{segments:s,points:r}=e;let i=!0,o=!1;n.beginPath();for(const l of s){const{start:c,end:d}=l,h=r[c],f=r[Xg(c,d,r)];i?(n.moveTo(h.x,h.y),i=!1):(n.lineTo(t,h.y),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,f.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function Gx(n,e){const{line:t,target:s,property:r,color:i,scale:o,clip:l}=e,c=$se(t,s,r);for(const{source:d,target:h,start:f,end:p}of c){const{style:{backgroundColor:g=i}={}}=d,b=s!==!0;n.save(),n.fillStyle=g,sre(n,o,l,b&&l0(r,f,p)),n.beginPath();const v=!!t.pathSegment(n,d);let _;if(b){v?n.closePath():X1(n,s,p,r);const N=!!s.pathSegment(n,h,{move:v,reverse:!0});_=v&&N,_||X1(n,s,f,r)}n.closePath(),n.fill(_?"evenodd":"nonzero"),n.restore()}}function sre(n,e,t,s){const r=e.chart.chartArea,{property:i,start:o,end:l}=s||{};if(i==="x"||i==="y"){let c,d,h,f;i==="x"?(c=o,d=r.top,h=l,f=r.bottom):(c=r.left,d=o,h=r.right,f=l),n.beginPath(),t&&(c=Math.max(c,t.left),h=Math.min(h,t.right),d=Math.max(d,t.top),f=Math.min(f,t.bottom)),n.rect(c,d,h-c,f-d),n.clip()}}function X1(n,e,t,s){const r=e.interpolate(t,s);r&&n.lineTo(r.x,r.y)}var rre={id:"filler",afterDatasetsUpdate(n,e,t){const s=(n.data.datasets||[]).length,r=[];let i,o,l,c;for(o=0;o<s;++o)i=n.getDatasetMeta(o),l=i.dataset,c=null,l&&l.options&&l instanceof Fa&&(c={visible:n.isDatasetVisible(o),index:o,fill:Vse(l,o,s),chart:n,axis:i.controller.options.indexAxis,scale:i.vScale,line:l}),i.$filler=c,r.push(c);for(o=0;o<s;++o)c=r[o],!(!c||c.fill===!1)&&(c.fill=Use(r,o,t.propagate))},beforeDraw(n,e,t){const s=t.drawTime==="beforeDraw",r=n.getSortedVisibleDatasetMetas(),i=n.chartArea;for(let o=r.length-1;o>=0;--o){const l=r[o].$filler;l&&(l.line.updateControlPoints(i,l.axis),s&&l.fill&&Wx(n.ctx,l,i))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const s=n.getSortedVisibleDatasetMetas();for(let r=s.length-1;r>=0;--r){const i=s[r].$filler;K1(i)&&Wx(n.ctx,i,n.chartArea)}},beforeDatasetDraw(n,e,t){const s=e.meta.$filler;!K1(s)||t.drawTime!=="beforeDatasetDraw"||Wx(n.ctx,s,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const eT=(n,e)=>{let{boxHeight:t=e,boxWidth:s=e}=n;return n.usePointStyle&&(t=Math.min(t,e),s=n.pointStyleWidth||Math.min(s,e)),{boxWidth:s,boxHeight:t,itemHeight:Math.max(e,t)}},ire=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class tT extends _o{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,s){this.maxWidth=e,this.maxHeight=t,this._margins=s,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Xt(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(s=>e.filter(s,this.chart.data))),e.sort&&(t=t.sort((s,r)=>e.sort(s,r,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const s=e.labels,r=Ls(s.font),i=r.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=eT(s,i);let d,h;t.font=r.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,i,l,c)+10):(h=this.maxHeight,d=this._fitCols(o,r,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,s,r){const{ctx:i,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=r+l;let f=e;i.textAlign="left",i.textBaseline="middle";let p=-1,g=-h;return this.legendItems.forEach((b,v)=>{const _=s+t/2+i.measureText(b.text).width;(v===0||d[d.length-1]+_+2*l>o)&&(f+=h,d[d.length-(v>0?0:1)]=0,g+=h,p++),c[v]={left:0,top:g,row:p,width:_,height:r},d[d.length-1]+=_+l}),f}_fitCols(e,t,s,r){const{ctx:i,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-e;let f=l,p=0,g=0,b=0,v=0;return this.legendItems.forEach((_,N)=>{const{itemWidth:j,itemHeight:k}=are(s,t,i,_,r);N>0&&g+k+2*l>h&&(f+=p+l,d.push({width:p,height:g}),b+=p+l,v++,p=g=0),c[N]={left:b,top:g,col:v,width:j,height:k},p=Math.max(p,j),g+=k+l}),f+=p,d.push({width:p,height:g}),f}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:s,labels:{padding:r},rtl:i}}=this,o=Fc(i,this.left,this.width);if(this.isHorizontal()){let l=0,c=Zs(s,this.left+r,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=Zs(s,this.left+r,this.right-this.lineWidths[l])),d.top+=this.top+e+r,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+r}else{let l=0,c=Zs(s,this.top+e+r,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=Zs(s,this.top+e+r,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+r,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;Zg(e,this),this._draw(),Kg(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:s,ctx:r}=this,{align:i,labels:o}=e,l=Nn.color,c=Fc(e.rtl,this.left,this.width),d=Ls(o.font),{padding:h}=o,f=d.size,p=f/2;let g;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=d.string;const{boxWidth:b,boxHeight:v,itemHeight:_}=eT(o,f),N=function(E,M,I){if(isNaN(b)||b<=0||isNaN(v)||v<0)return;r.save();const O=mt(I.lineWidth,1);if(r.fillStyle=mt(I.fillStyle,l),r.lineCap=mt(I.lineCap,"butt"),r.lineDashOffset=mt(I.lineDashOffset,0),r.lineJoin=mt(I.lineJoin,"miter"),r.lineWidth=O,r.strokeStyle=mt(I.strokeStyle,l),r.setLineDash(mt(I.lineDash,[])),o.usePointStyle){const D={radius:v*Math.SQRT2/2,pointStyle:I.pointStyle,rotation:I.rotation,borderWidth:O},z=c.xPlus(E,b/2),H=M+p;vI(r,D,z,H,o.pointStyleWidth&&b)}else{const D=M+Math.max((f-v)/2,0),z=c.leftForLtr(E,b),H=Lc(I.borderRadius);r.beginPath(),Object.values(H).some(F=>F!==0)?Hp(r,{x:z,y:D,w:b,h:v,radius:H}):r.rect(z,D,b,v),r.fill(),O!==0&&r.stroke()}r.restore()},j=function(E,M,I){qp(r,I.text,E,M+_/2,d,{strikethrough:I.hidden,textAlign:c.textAlign(I.textAlign)})},k=this.isHorizontal(),S=this._computeTitleHeight();k?g={x:Zs(i,this.left+h,this.right-s[0]),y:this.top+h+S,line:0}:g={x:this.left+h,y:Zs(i,this.top+S+h,this.bottom-t[0].height),line:0},CI(this.ctx,e.textDirection);const P=_+h;this.legendItems.forEach((E,M)=>{r.strokeStyle=E.fontColor,r.fillStyle=E.fontColor;const I=r.measureText(E.text).width,O=c.textAlign(E.textAlign||(E.textAlign=o.textAlign)),D=b+p+I;let z=g.x,H=g.y;c.setWidth(this.width),k?M>0&&z+D+h>this.right&&(H=g.y+=P,g.line++,z=g.x=Zs(i,this.left+h,this.right-s[g.line])):M>0&&H+P>this.bottom&&(z=g.x=z+t[g.line].width+h,g.line++,H=g.y=Zs(i,this.top+S+h,this.bottom-t[g.line].height));const F=c.x(z);if(N(F,H,E),z=Ree(O,z+b+p,k?z+D:this.right,e.rtl),j(c.x(z),H,E),k)g.x+=D+h;else if(typeof E.text!="string"){const R=d.lineHeight;g.y+=ZI(E,R)+h}else g.y+=P}),kI(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,s=Ls(t.font),r=Xr(t.padding);if(!t.display)return;const i=Fc(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=s.size/2,d=r.top+c;let h,f=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),h=this.top+d,f=Zs(e.align,f,this.right-p);else{const b=this.columnSizes.reduce((v,_)=>Math.max(v,_.height),0);h=d+Zs(e.align,this.top,this.bottom-b-e.labels.padding-this._computeTitleHeight())}const g=Zs(l,f,f+p);o.textAlign=i.textAlign(yI(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=s.string,qp(o,t.text,g,h,s)}_computeTitleHeight(){const e=this.options.title,t=Ls(e.font),s=Xr(e.padding);return e.display?t.lineHeight+s.height:0}_getLegendItemAt(e,t){let s,r,i;if(Qi(e,this.left,this.right)&&Qi(t,this.top,this.bottom)){for(i=this.legendHitBoxes,s=0;s<i.length;++s)if(r=i[s],Qi(e,r.left,r.left+r.width)&&Qi(t,r.top,r.top+r.height))return this.legendItems[s]}return null}handleEvent(e){const t=this.options;if(!cre(e.type,t))return;const s=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const r=this._hoveredItem,i=ire(r,s);r&&!i&&Xt(t.onLeave,[e,r,this],this),this._hoveredItem=s,s&&!i&&Xt(t.onHover,[e,s,this],this)}else s&&Xt(t.onClick,[e,s,this],this)}}function are(n,e,t,s,r){const i=ore(s,n,e,t),o=lre(r,s,e.lineHeight);return{itemWidth:i,itemHeight:o}}function ore(n,e,t,s){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((i,o)=>i.length>o.length?i:o)),e+t.size/2+s.measureText(r).width}function lre(n,e,t){let s=n;return typeof e.text!="string"&&(s=ZI(e,t)),s}function ZI(n,e){const t=n.text?n.text.length:0;return e*t}function cre(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var dre={id:"legend",_element:tT,start(n,e,t){const s=n.legend=new tT({ctx:n.ctx,options:t,chart:n});La.configure(n,s,t),La.addBox(n,s)},stop(n){La.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const s=n.legend;La.configure(n,s,t),s.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const s=e.datasetIndex,r=t.chart;r.isDatasetVisible(s)?(r.hide(s),e.hidden=!0):(r.show(s),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:s,textAlign:r,color:i,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),h=Xr(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:i,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:s||d.pointStyle,rotation:d.rotation,textAlign:r||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const gu={average(n){if(!n.length)return!1;let e,t,s=new Set,r=0,i=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();s.add(c.x),r+=c.y,++i}}return i===0||s.size===0?!1:{x:[...s].reduce((l,c)=>l+c)/s.size,y:r/i}},nearest(n,e){if(!n.length)return!1;let t=e.x,s=e.y,r=Number.POSITIVE_INFINITY,i,o,l;for(i=0,o=n.length;i<o;++i){const c=n[i].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=n0(e,d);h<r&&(r=h,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,s=c.y}return{x:t,y:s}}};function di(n,e){return e&&(On(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function Vi(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function ure(n,e){const{element:t,datasetIndex:s,index:r}=e,i=n.getDatasetMeta(s).controller,{label:o,value:l}=i.getLabelAndValue(r);return{chart:n,label:o,parsed:i.getParsed(r),raw:n.data.datasets[s].data[r],formattedValue:l,dataset:i.getDataset(),dataIndex:r,datasetIndex:s,element:t}}function nT(n,e){const t=n.chart.ctx,{body:s,footer:r,title:i}=n,{boxWidth:o,boxHeight:l}=e,c=Ls(e.bodyFont),d=Ls(e.titleFont),h=Ls(e.footerFont),f=i.length,p=r.length,g=s.length,b=Xr(e.padding);let v=b.height,_=0,N=s.reduce((S,P)=>S+P.before.length+P.lines.length+P.after.length,0);if(N+=n.beforeBody.length+n.afterBody.length,f&&(v+=f*d.lineHeight+(f-1)*e.titleSpacing+e.titleMarginBottom),N){const S=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;v+=g*S+(N-g)*c.lineHeight+(N-1)*e.bodySpacing}p&&(v+=e.footerMarginTop+p*h.lineHeight+(p-1)*e.footerSpacing);let j=0;const k=function(S){_=Math.max(_,t.measureText(S).width+j)};return t.save(),t.font=d.string,It(n.title,k),t.font=c.string,It(n.beforeBody.concat(n.afterBody),k),j=e.displayColors?o+2+e.boxPadding:0,It(s,S=>{It(S.before,k),It(S.lines,k),It(S.after,k)}),j=0,t.font=h.string,It(n.footer,k),t.restore(),_+=b.width,{width:_,height:v}}function hre(n,e){const{y:t,height:s}=e;return t<s/2?"top":t>n.height-s/2?"bottom":"center"}function fre(n,e,t,s){const{x:r,width:i}=s,o=t.caretSize+t.caretPadding;if(n==="left"&&r+i+o>e.width||n==="right"&&r-i-o<0)return!0}function mre(n,e,t,s){const{x:r,width:i}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return s==="center"?d=r<=(l+c)/2?"left":"right":r<=i/2?d="left":r>=o-i/2&&(d="right"),fre(d,n,e,t)&&(d="center"),d}function sT(n,e,t){const s=t.yAlign||e.yAlign||hre(n,t);return{xAlign:t.xAlign||e.xAlign||mre(n,e,t,s),yAlign:s}}function pre(n,e){let{x:t,width:s}=n;return e==="right"?t-=s:e==="center"&&(t-=s/2),t}function gre(n,e,t){let{y:s,height:r}=n;return e==="top"?s+=t:e==="bottom"?s-=r+t:s-=r/2,s}function rT(n,e,t,s){const{caretSize:r,caretPadding:i,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=r+i,{topLeft:h,topRight:f,bottomLeft:p,bottomRight:g}=Lc(o);let b=pre(e,l);const v=gre(e,c,d);return c==="center"?l==="left"?b+=d:l==="right"&&(b-=d):l==="left"?b-=Math.max(h,p)+r:l==="right"&&(b+=Math.max(f,g)+r),{x:os(b,0,s.width-e.width),y:os(v,0,s.height-e.height)}}function nm(n,e,t){const s=Xr(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-s.right:n.x+s.left}function iT(n){return di([],Vi(n))}function yre(n,e,t){return Rl(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function aT(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const KI={beforeTitle:$i,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,s=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(s>0&&e.dataIndex<s)return t[e.dataIndex]}return""},afterTitle:$i,beforeBody:$i,beforeLabel:$i,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return At(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:$i,afterBody:$i,beforeFooter:$i,footer:$i,afterFooter:$i};function Es(n,e,t,s){const r=n[e].call(t,s);return typeof r>"u"?KI[e].call(t,s):r}class c0 extends _o{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,s=this.options.setContext(this.getContext()),r=s.enabled&&t.options.animation&&s.animations,i=new DI(this.chart,r);return r._cacheable&&(this._cachedAnimations=Object.freeze(i)),i}getContext(){return this.$context||(this.$context=yre(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:s}=t,r=Es(s,"beforeTitle",this,e),i=Es(s,"title",this,e),o=Es(s,"afterTitle",this,e);let l=[];return l=di(l,Vi(r)),l=di(l,Vi(i)),l=di(l,Vi(o)),l}getBeforeBody(e,t){return iT(Es(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:s}=t,r=[];return It(e,i=>{const o={before:[],lines:[],after:[]},l=aT(s,i);di(o.before,Vi(Es(l,"beforeLabel",this,i))),di(o.lines,Es(l,"label",this,i)),di(o.after,Vi(Es(l,"afterLabel",this,i))),r.push(o)}),r}getAfterBody(e,t){return iT(Es(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:s}=t,r=Es(s,"beforeFooter",this,e),i=Es(s,"footer",this,e),o=Es(s,"afterFooter",this,e);let l=[];return l=di(l,Vi(r)),l=di(l,Vi(i)),l=di(l,Vi(o)),l}_createItems(e){const t=this._active,s=this.chart.data,r=[],i=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push(ure(this.chart,t[c]));return e.filter&&(l=l.filter((h,f,p)=>e.filter(h,f,p,s))),e.itemSort&&(l=l.sort((h,f)=>e.itemSort(h,f,s))),It(l,h=>{const f=aT(e.callbacks,h);r.push(Es(f,"labelColor",this,h)),i.push(Es(f,"labelPointStyle",this,h)),o.push(Es(f,"labelTextColor",this,h))}),this.labelColors=r,this.labelPointStyles=i,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const s=this.options.setContext(this.getContext()),r=this._active;let i,o=[];if(!r.length)this.opacity!==0&&(i={opacity:0});else{const l=gu[s.position].call(this,r,this._eventPosition);o=this._createItems(s),this.title=this.getTitle(o,s),this.beforeBody=this.getBeforeBody(o,s),this.body=this.getBody(o,s),this.afterBody=this.getAfterBody(o,s),this.footer=this.getFooter(o,s);const c=this._size=nT(this,s),d=Object.assign({},l,c),h=sT(this.chart,s,d),f=rT(s,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,i={opacity:1,x:f.x,y:f.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,i&&this._resolveAnimations().update(this,i),e&&s.external&&s.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,s,r){const i=this.getCaretPosition(e,s,r);t.lineTo(i.x1,i.y1),t.lineTo(i.x2,i.y2),t.lineTo(i.x3,i.y3)}getCaretPosition(e,t,s){const{xAlign:r,yAlign:i}=this,{caretSize:o,cornerRadius:l}=s,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:f}=Lc(l),{x:p,y:g}=e,{width:b,height:v}=t;let _,N,j,k,S,P;return i==="center"?(S=g+v/2,r==="left"?(_=p,N=_-o,k=S+o,P=S-o):(_=p+b,N=_+o,k=S-o,P=S+o),j=_):(r==="left"?N=p+Math.max(c,h)+o:r==="right"?N=p+b-Math.max(d,f)-o:N=this.caretX,i==="top"?(k=g,S=k-o,_=N-o,j=N+o):(k=g+v,S=k+o,_=N+o,j=N-o),P=k),{x1:_,x2:N,x3:j,y1:k,y2:S,y3:P}}drawTitle(e,t,s){const r=this.title,i=r.length;let o,l,c;if(i){const d=Fc(s.rtl,this.x,this.width);for(e.x=nm(this,s.titleAlign,s),t.textAlign=d.textAlign(s.titleAlign),t.textBaseline="middle",o=Ls(s.titleFont),l=s.titleSpacing,t.fillStyle=s.titleColor,t.font=o.string,c=0;c<i;++c)t.fillText(r[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===i&&(e.y+=s.titleMarginBottom-l)}}_drawColorBox(e,t,s,r,i){const o=this.labelColors[s],l=this.labelPointStyles[s],{boxHeight:c,boxWidth:d}=i,h=Ls(i.bodyFont),f=nm(this,"left",i),p=r.x(f),g=c<h.lineHeight?(h.lineHeight-c)/2:0,b=t.y+g;if(i.usePointStyle){const v={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},_=r.leftForLtr(p,d)+d/2,N=b+c/2;e.strokeStyle=i.multiKeyBackground,e.fillStyle=i.multiKeyBackground,r0(e,v,_,N),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,r0(e,v,_,N)}else{e.lineWidth=bt(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const v=r.leftForLtr(p,d),_=r.leftForLtr(r.xPlus(p,1),d-2),N=Lc(o.borderRadius);Object.values(N).some(j=>j!==0)?(e.beginPath(),e.fillStyle=i.multiKeyBackground,Hp(e,{x:v,y:b,w:d,h:c,radius:N}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Hp(e,{x:_,y:b+1,w:d-2,h:c-2,radius:N}),e.fill()):(e.fillStyle=i.multiKeyBackground,e.fillRect(v,b,d,c),e.strokeRect(v,b,d,c),e.fillStyle=o.backgroundColor,e.fillRect(_,b+1,d-2,c-2))}e.fillStyle=this.labelTextColors[s]}drawBody(e,t,s){const{body:r}=this,{bodySpacing:i,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=s,f=Ls(s.bodyFont);let p=f.lineHeight,g=0;const b=Fc(s.rtl,this.x,this.width),v=function(I){t.fillText(I,b.x(e.x+g),e.y+p/2),e.y+=p+i},_=b.textAlign(o);let N,j,k,S,P,E,M;for(t.textAlign=o,t.textBaseline="middle",t.font=f.string,e.x=nm(this,_,s),t.fillStyle=s.bodyColor,It(this.beforeBody,v),g=l&&_!=="right"?o==="center"?d/2+h:d+2+h:0,S=0,E=r.length;S<E;++S){for(N=r[S],j=this.labelTextColors[S],t.fillStyle=j,It(N.before,v),k=N.lines,l&&k.length&&(this._drawColorBox(t,e,S,b,s),p=Math.max(f.lineHeight,c)),P=0,M=k.length;P<M;++P)v(k[P]),p=f.lineHeight;It(N.after,v)}g=0,p=f.lineHeight,It(this.afterBody,v),e.y-=i}drawFooter(e,t,s){const r=this.footer,i=r.length;let o,l;if(i){const c=Fc(s.rtl,this.x,this.width);for(e.x=nm(this,s.footerAlign,s),e.y+=s.footerMarginTop,t.textAlign=c.textAlign(s.footerAlign),t.textBaseline="middle",o=Ls(s.footerFont),t.fillStyle=s.footerColor,t.font=o.string,l=0;l<i;++l)t.fillText(r[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+s.footerSpacing}}drawBackground(e,t,s,r){const{xAlign:i,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:h}=s,{topLeft:f,topRight:p,bottomLeft:g,bottomRight:b}=Lc(r.cornerRadius);t.fillStyle=r.backgroundColor,t.strokeStyle=r.borderColor,t.lineWidth=r.borderWidth,t.beginPath(),t.moveTo(l+f,c),o==="top"&&this.drawCaret(e,t,s,r),t.lineTo(l+d-p,c),t.quadraticCurveTo(l+d,c,l+d,c+p),o==="center"&&i==="right"&&this.drawCaret(e,t,s,r),t.lineTo(l+d,c+h-b),t.quadraticCurveTo(l+d,c+h,l+d-b,c+h),o==="bottom"&&this.drawCaret(e,t,s,r),t.lineTo(l+g,c+h),t.quadraticCurveTo(l,c+h,l,c+h-g),o==="center"&&i==="left"&&this.drawCaret(e,t,s,r),t.lineTo(l,c+f),t.quadraticCurveTo(l,c,l+f,c),t.closePath(),t.fill(),r.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,s=this.$animations,r=s&&s.x,i=s&&s.y;if(r||i){const o=gu[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=nT(this,e),c=Object.assign({},o,this._size),d=sT(t,e,c),h=rT(e,c,d,t);(r._to!==h.x||i._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let s=this.opacity;if(!s)return;this._updateAnimationTarget(t);const r={width:this.width,height:this.height},i={x:this.x,y:this.y};s=Math.abs(s)<.001?0:s;const o=Xr(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=s,this.drawBackground(i,e,r,t),CI(e,t.textDirection),i.y+=o.top,this.drawTitle(i,e,t),this.drawBody(i,e,t),this.drawFooter(i,e,t),kI(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const s=this._active,r=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),i=!Up(s,r),o=this._positionChanged(r,t);(i||o)&&(this._active=r,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,s=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const r=this.options,i=this._active||[],o=this._getActiveElements(e,i,t,s),l=this._positionChanged(o,e),c=t||!Up(o,i)||l;return c&&(this._active=o,(r.enabled||r.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,s,r){const i=this.options;if(e.type==="mouseout")return[];if(!r)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,i.mode,i,s);return i.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:s,caretY:r,options:i}=this,o=gu[i.position].call(this,e,t);return o!==!1&&(s!==o.x||r!==o.y)}}xe(c0,"positioners",gu);var xre={id:"tooltip",_element:c0,positioners:gu,afterInit(n,e,t){t&&(n.tooltip=new c0({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:KI},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const vre=(n,e,t,s)=>(typeof e=="string"?(t=n.push(e)-1,s.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function bre(n,e,t,s){const r=n.indexOf(e);if(r===-1)return vre(n,e,t,s);const i=n.lastIndexOf(e);return r!==i?t:r}const wre=(n,e)=>n===null?null:os(Math.round(n),0,e);function oT(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class d0 extends vd{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const s=this.getLabels();for(const{index:r,label:i}of t)s[r]===i&&s.splice(r,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(At(e))return null;const s=this.getLabels();return t=isFinite(t)&&s[t]===e?t:bre(s,e,mt(t,e),this._addedLabels),wre(t,s.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:s,max:r}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(s=0),t||(r=this.getLabels().length-1)),this.min=s,this.max=r}buildTicks(){const e=this.min,t=this.max,s=this.options.offset,r=[];let i=this.getLabels();i=e===0&&t===i.length-1?i:i.slice(e,t+1),this._valueRange=Math.max(i.length-(s?0:1),1),this._startValue=this.min-(s?.5:0);for(let o=e;o<=t;o++)r.push({value:o});return r}getLabelForValue(e){return oT.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}xe(d0,"id","category"),xe(d0,"defaults",{ticks:{callback:oT}});function _re(n,e){const t=[],{bounds:r,step:i,min:o,max:l,precision:c,count:d,maxTicks:h,maxDigits:f,includeBounds:p}=n,g=i||1,b=h-1,{min:v,max:_}=e,N=!At(o),j=!At(l),k=!At(d),S=(_-v)/(f+1);let P=r1((_-v)/b/g)*g,E,M,I,O;if(P<1e-14&&!N&&!j)return[{value:v},{value:_}];O=Math.ceil(_/P)-Math.floor(v/P),O>b&&(P=r1(O*P/b/g)*g),At(c)||(E=Math.pow(10,c),P=Math.ceil(P*E)/E),r==="ticks"?(M=Math.floor(v/P)*P,I=Math.ceil(_/P)*P):(M=v,I=_),N&&j&&i&&kee((l-o)/i,P/1e3)?(O=Math.round(Math.min((l-o)/P,h)),P=(l-o)/O,M=o,I=l):k?(M=N?o:M,I=j?l:I,O=d-1,P=(I-M)/O):(O=(I-M)/P,Au(O,Math.round(O),P/1e3)?O=Math.round(O):O=Math.ceil(O));const D=Math.max(i1(P),i1(M));E=Math.pow(10,At(c)?D:c),M=Math.round(M*E)/E,I=Math.round(I*E)/E;let z=0;for(N&&(p&&M!==o?(t.push({value:o}),M<o&&z++,Au(Math.round((M+z*P)*E)/E,o,lT(o,S,n))&&z++):M<o&&z++);z<O;++z){const H=Math.round((M+z*P)*E)/E;if(j&&H>l)break;t.push({value:H})}return j&&p&&I!==l?t.length&&Au(t[t.length-1].value,l,lT(l,S,n))?t[t.length-1].value=l:t.push({value:l}):(!j||I===l)&&t.push({value:I}),t}function lT(n,e,{horizontal:t,minRotation:s}){const r=Ji(s),i=(t?Math.sin(r):Math.cos(r))||.001,o=.75*e*(""+n).length;return Math.min(e/i,o)}class Sre extends vd{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return At(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:s}=this.getUserBounds();let{min:r,max:i}=this;const o=c=>r=t?r:c,l=c=>i=s?i:c;if(e){const c=ki(r),d=ki(i);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(r===i){let c=i===0?1:Math.abs(i*.05);l(i+c),e||o(r-c)}this.min=r,this.max=i}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:s}=e,r;return s?(r=Math.ceil(this.max/s)-Math.floor(this.min/s)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${s} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),t=t||11),t&&(r=Math.min(t,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let s=this.getTickLimit();s=Math.max(2,s);const r={maxTicks:s,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},i=this._range||this,o=_re(r,i);return e.bounds==="ticks"&&Tee(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,s=this.max;if(super.configure(),this.options.offset&&e.length){const r=(s-t)/Math.max(e.length-1,1)/2;t-=r,s+=r}this._startValue=t,this._endValue=s,this._valueRange=s-t}getLabelForValue(e){return O_(e,this.chart.options.locale,this.options.ticks.format)}}class u0 extends Sre{determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=ds(e)?e:0,this.max=ds(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,s=Ji(this.options.ticks.minRotation),r=(e?Math.sin(s):Math.cos(s))||.001,i=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,i.lineHeight/r))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}xe(u0,"id","linear"),xe(u0,"defaults",{ticks:{callback:xI.formatters.numeric}});const ey={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},As=Object.keys(ey);function cT(n,e){return n-e}function dT(n,e){if(At(e))return null;const t=n._adapter,{parser:s,round:r,isoWeekday:i}=n._parseOpts;let o=e;return typeof s=="function"&&(o=s(o)),ds(o)||(o=typeof s=="string"?t.parse(o,s):t.parse(o)),o===null?null:(r&&(o=r==="week"&&(ph(i)||i===!0)?t.startOf(o,"isoWeek",i):t.startOf(o,r)),+o)}function uT(n,e,t,s){const r=As.length;for(let i=As.indexOf(n);i<r-1;++i){const o=ey[As[i]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=s)return As[i]}return As[r-1]}function Nre(n,e,t,s,r){for(let i=As.length-1;i>=As.indexOf(t);i--){const o=As[i];if(ey[o].common&&n._adapter.diff(r,s,o)>=e-1)return o}return As[t?As.indexOf(t):0]}function jre(n){for(let e=As.indexOf(n)+1,t=As.length;e<t;++e)if(ey[As[e]].common)return As[e]}function hT(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:s,hi:r}=A_(t,e),i=t[s]>=e?t[s]:t[r];n[i]=!0}}function Cre(n,e,t,s){const r=n._adapter,i=+r.startOf(e[0].value,s),o=e[e.length-1].value;let l,c;for(l=i;l<=o;l=+r.add(l,1,s))c=t[l],c>=0&&(e[c].major=!0);return e}function fT(n,e,t){const s=[],r={},i=e.length;let o,l;for(o=0;o<i;++o)l=e[o],r[l]=o,s.push({value:l,major:!1});return i===0||!t?s:Cre(n,s,r,t)}class Zp extends vd{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const s=e.time||(e.time={}),r=this._adapter=new dne._date(e.adapters.date);r.init(t),Du(s.displayFormats,r.formats()),this._parseOpts={parser:s.parser,round:s.round,isoWeekday:s.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:dT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,s=e.time.unit||"day";let{min:r,max:i,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(r=Math.min(r,d.min)),!l&&!isNaN(d.max)&&(i=Math.max(i,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),r=ds(r)&&!isNaN(r)?r:+t.startOf(Date.now(),s),i=ds(i)&&!isNaN(i)?i:+t.endOf(Date.now(),s)+1,this.min=Math.min(r,i-1),this.max=Math.max(r+1,i)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,s=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],s=e[e.length-1]),{min:t,max:s}}buildTicks(){const e=this.options,t=e.time,s=e.ticks,r=s.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&r.length&&(this.min=this._userMin||r[0],this.max=this._userMax||r[r.length-1]);const i=this.min,o=this.max,l=Aee(r,i,o);return this._unit=t.unit||(s.autoSkip?uT(t.minUnit,this.min,this.max,this._getLabelCapacity(i)):Nre(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!s.major.enabled||this._unit==="year"?void 0:jre(this._unit),this.initOffsets(r),e.reverse&&l.reverse(),fT(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,s=0,r,i;this.options.offset&&e.length&&(r=this.getDecimalForValue(e[0]),e.length===1?t=1-r:t=(this.getDecimalForValue(e[1])-r)/2,i=this.getDecimalForValue(e[e.length-1]),e.length===1?s=i:s=(i-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=os(t,0,o),s=os(s,0,o),this._offsets={start:t,end:s,factor:1/(t+1+s)}}_generate(){const e=this._adapter,t=this.min,s=this.max,r=this.options,i=r.time,o=i.unit||uT(i.minUnit,t,s,this._getLabelCapacity(t)),l=mt(r.ticks.stepSize,1),c=o==="week"?i.isoWeekday:!1,d=ph(c)||c===!0,h={};let f=t,p,g;if(d&&(f=+e.startOf(f,"isoWeek",c)),f=+e.startOf(f,d?"day":o),e.diff(s,t,o)>1e5*l)throw new Error(t+" and "+s+" are too far apart with stepSize of "+l+" "+o);const b=r.ticks.source==="data"&&this.getDataTimestamps();for(p=f,g=0;p<s;p=+e.add(p,l,o),g++)hT(h,p,b);return(p===s||r.bounds==="ticks"||g===1)&&hT(h,p,b),Object.keys(h).sort(cT).map(v=>+v)}getLabelForValue(e){const t=this._adapter,s=this.options.time;return s.tooltipFormat?t.format(e,s.tooltipFormat):t.format(e,s.displayFormats.datetime)}format(e,t){const r=this.options.time.displayFormats,i=this._unit,o=t||r[i];return this._adapter.format(e,o)}_tickFormatFunction(e,t,s,r){const i=this.options,o=i.ticks.callback;if(o)return Xt(o,[e,t,s],this);const l=i.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],f=d&&l[d],p=s[t],g=d&&f&&p&&p.major;return this._adapter.format(e,r||(g?f:h))}generateTickLabels(e){let t,s,r;for(t=0,s=e.length;t<s;++t)r=e[t],r.label=this._tickFormatFunction(r.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,s=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+s)*t.factor)}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+s*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,s=this.ctx.measureText(e).width,r=Ji(this.isHorizontal()?t.maxRotation:t.minRotation),i=Math.cos(r),o=Math.sin(r),l=this._resolveTickFontOptions(0).size;return{w:s*i+l*o,h:s*o+l*i}}_getLabelCapacity(e){const t=this.options.time,s=t.displayFormats,r=s[t.unit]||s.millisecond,i=this._tickFormatFunction(e,0,fT(this,[e],this._majorUnit),r),o=this._getLabelSize(i),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,s;if(e.length)return e;const r=this.getMatchingVisibleMetas();if(this._normalized&&r.length)return this._cache.data=r[0].controller.getAllParsedValues(this);for(t=0,s=r.length;t<s;++t)e=e.concat(r[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,s;if(e.length)return e;const r=this.getLabels();for(t=0,s=r.length;t<s;++t)e.push(dT(this,r[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return mI(e.sort(cT))}}xe(Zp,"id","time"),xe(Zp,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function sm(n,e,t){let s=0,r=n.length-1,i,o,l,c;t?(e>=n[s].pos&&e<=n[r].pos&&({lo:s,hi:r}=rl(n,"pos",e)),{pos:i,time:l}=n[s],{pos:o,time:c}=n[r]):(e>=n[s].time&&e<=n[r].time&&({lo:s,hi:r}=rl(n,"time",e)),{time:i,pos:l}=n[s],{time:o,pos:c}=n[r]);const d=o-i;return d?l+(c-l)*(e-i)/d:l}class mT extends Zp{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=sm(t,this.min),this._tableRange=sm(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:s}=this,r=[],i=[];let o,l,c,d,h;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=s&&r.push(d);if(r.length<2)return[{time:t,pos:0},{time:s,pos:1}];for(o=0,l=r.length;o<l;++o)h=r[o+1],c=r[o-1],d=r[o],Math.round((h+c)/2)!==d&&i.push({time:d,pos:o/(l-1)});return i}_generate(){const e=this.min,t=this.max;let s=super.getDataTimestamps();return(!s.includes(e)||!s.length)&&s.splice(0,0,e),(!s.includes(t)||s.length===1)&&s.push(t),s.sort((r,i)=>r-i)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),s=this.getLabelTimestamps();return t.length&&s.length?e=this.normalize(t.concat(s)):e=t.length?t:s,e=this._cache.all=e,e}getDecimalForValue(e){return(sm(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,s=this.getDecimalForPixel(e)/t.factor-t.end;return sm(this._table,s*this._tableRange+this._minPos,!0)}}xe(mT,"id","timeseries"),xe(mT,"defaults",Zp.defaults);gi.register(Dm,Lm,d0,u0,Am,Fa,Rm,fu,pu,xre,dre,rre);const pT=({title:n,icon:e,children:t})=>a.jsxs("div",{className:"bg-card p-6 rounded-xl shadow-card col-span-1",children:[a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),a.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),a.jsx("div",{className:"h-60 relative",children:t})]}),kre=({data:n})=>{const e=C.useRef(null),t=C.useRef(null);return C.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");s&&(t.current=new gi(s,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:"#005D22",borderColor:"#004218",borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}}))}return()=>{t.current&&t.current.destroy()}},[n]),a.jsx("div",{className:"h-full w-full flex flex-col",children:a.jsx("div",{className:"flex-grow relative",children:a.jsx("canvas",{ref:e})})})},Tre=({data:n})=>{const e=C.useRef(null),t=C.useRef(null);return C.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s){const r=s.createLinearGradient(0,0,0,200);r.addColorStop(0,"rgba(0, 93, 34, 0.4)"),r.addColorStop(1,"rgba(0, 93, 34, 0)"),t.current=new gi(s,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:"#005D22",backgroundColor:r,fill:!0,tension:.4,pointBackgroundColor:"#005D22",pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:i=>{const o=typeof i=="string"?parseFloat(i):i;return Math.round(o)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n]),a.jsx("div",{className:"h-full w-full flex flex-col",children:a.jsx("div",{className:"flex-grow relative",children:a.jsx("canvas",{ref:e})})})},Ere=({data:n,dateRange:e})=>a.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[a.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[a.jsx(Qr,{className:"h-10",localPath:n_}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),a.jsxs("p",{className:"text-gray-600",children:[Ce(e.startDate,"dd MMM yyyy")," to ",Ce(e.endDate,"dd MMM yyyy")]})]})]}),a.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-100",children:[a.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),a.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),a.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),a.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),a.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),a.jsx("tbody",{children:n.map((t,s)=>{var r,i;return a.jsxs("tr",{className:"border-b",children:[a.jsx("td",{className:"p-2 border border-gray-300",children:t.userName}),a.jsx("td",{className:"p-2 border border-gray-300",children:t.date}),a.jsx("td",{className:"p-2 border border-gray-300",children:t.time}),a.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:t.type.replace("-"," ")}),a.jsx("td",{className:"p-2 border border-gray-300",children:t.locationName||(t.latitude?`${(r=t.latitude)==null?void 0:r.toFixed(4)}, ${(i=t.longitude)==null?void 0:i.toFixed(4)}`:"N/A")})]},`${t.userName}-${t.date}-${t.time}-${s}`)})})]})]}),Pre=({data:n,dateRange:e})=>{const s=[];for(let r=0;r<n.length;r+=15)s.push(n.slice(r,r+15));return s.length===0?null:a.jsx("div",{children:s.map((r,i)=>{const o=15-r.length,l=i===s.length-1;return a.jsxs("div",{style:{padding:i===0?"40px":"0px 40px 40px 40px",paddingTop:i===0?"40px":"0px",marginTop:i===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:l?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[a.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:a.jsx("tbody",{children:a.jsxs("tr",{children:[a.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:a.jsx(Qr,{className:"h-14",localPath:n_})}),a.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[a.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),a.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[Ce(e.startDate,"dd MMM yyyy")," -"," ",Ce(e.endDate,"dd MMM yyyy")]}),a.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",Ce(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),a.jsx("div",{style:{flexGrow:1},children:a.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[a.jsx("thead",{style:{display:"table-header-group"},children:a.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),a.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),a.jsxs("tbody",{children:[r.map((c,d)=>a.jsxs("tr",{style:{backgroundColor:d%2===0?"#fff":"#fafafa"},children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:c.userName}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:Ce(new Date(String(c.date).replace(/-/g,"/")),"dd MMM yyyy")}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.status}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkIn||"-"}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.checkOut||"-"}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:c.duration||"-"})]},`${c.userName}-${c.date}-${d}`)),Array.from({length:o}).map((c,d)=>a.jsxs("tr",{style:{backgroundColor:"#fff"},children:[a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),a.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${d}`))]})]})}),a.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:["Paradigm Services - Confidential Report - Page ",i+1," of ",s.length]})]},i)})})},Mre=({data:n,dateRange:e})=>{const t=Ur({start:e.startDate,end:e.endDate});return a.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[a.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[a.jsx(Qr,{className:"h-8",localPath:n_}),a.jsxs("div",{className:"text-right",children:[a.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),a.jsxs("p",{className:"text-gray-600",children:[Ce(e.startDate,"dd MMM yyyy")," to ",Ce(e.endDate,"dd MMM yyyy")]})]})]}),a.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"bg-gray-200 font-bold",children:[a.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),t.map((s,r)=>a.jsx("td",{className:"border p-1 border-gray-400",children:Ce(s,"d")},r)),a.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),a.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),a.jsx("tbody",{children:n.map((s,r)=>a.jsxs("tr",{children:[a.jsx("td",{className:"border p-1 border-gray-400 text-left",children:s.userName}),s.statuses.map((i,o)=>a.jsx("td",{className:"border p-1 border-gray-400",children:i},o)),a.jsx("td",{className:"border p-1 border-gray-400",children:s.presentDays}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.halfDays}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.absentDays}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.weekOffs}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.holidays}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.weekendPresents}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.holidayPresents}),a.jsx("td",{className:"border p-1 border-gray-400",children:s.totalPayableDays})]},r))})]})]})},Dre=()=>{var G;const n=Nt("(max-width: 639px)"),{user:e}=tt(),{permissions:t}=pa(),{recurringHolidays:s}=ir(),[r,i]=C.useState([]),[o,l]=C.useState([]),[c,d]=C.useState(null),[h,f]=C.useState(!0),[p,g]=C.useState({startDate:ji(new Date,6),endDate:new Date,key:"selection"}),b=C.useMemo(()=>[p],[p]),[v,_]=C.useState("Last 7 Days"),[N,j]=C.useState(!1),k=C.useRef(null),[S,P]=C.useState("all"),[E,M]=C.useState("basic"),[I,O]=C.useState(!1),[D,z]=C.useState(null),[H,F]=C.useState({}),R=C.useRef(null),V=e&&((G=t[e.role])==null?void 0:G.includes("download_attendance_report"));C.useEffect(()=>{const ne=ge=>{k.current&&!k.current.contains(ge.target)&&j(!1)};return document.addEventListener("mousedown",ne),()=>document.removeEventListener("mousedown",ne)},[]),C.useEffect(()=>{V&&te.getUsers().then(i)},[V]);const U=C.useCallback(async(ne,ge)=>{f(!0);try{let ye=r;ye.length===0&&(ye=await te.getUsers(),i(ye));const re=new Date,ae=ne<re?ne:jp(),ve=ge>re?ge:cb(),[pe,Ne]=await Promise.all([te.getAllAttendanceEvents(ae.toISOString(),ve.toISOString()),te.getLeaveRequests({startDate:ae.toISOString(),endDate:ve.toISOString(),status:"approved"})]);l(pe);const Me=Ce(re,"yyyy-MM-dd"),Oe=pe.filter(Pe=>Ce(new Date(Pe.timestamp),"yyyy-MM-dd")===Me),Je=new Set(Oe.map(Pe=>Pe.userId)).size,dt=Ne.filter(Pe=>{const Ue=new Date(Pe.startDate),ht=new Date(Pe.endDate);return re>=Ue&&re<=ht}),at=new Set(dt.map(Pe=>Pe.userId)).size,_t=ye.length,J=Math.max(0,_t-Je-at),K=Ur({start:ne,end:ge}),oe=K.map(Pe=>Ce(Pe,"dd MMM")),we=[],Se=[],_e=[];K.forEach(Pe=>{const Ue=Ce(Pe,"yyyy-MM-dd"),ht=pe.filter(Bt=>Ce(new Date(Bt.timestamp),"yyyy-MM-dd")===Ue),Zt=new Set(ht.map(Bt=>Bt.userId)).size,an=Ne.filter(Bt=>{const Gs=new Date(Bt.startDate),us=new Date(Bt.endDate);return Pe>=Gs&&Pe<=us}),$n=new Set(an.map(Bt=>Bt.userId)).size,Ws=Math.max(0,_t-Zt-$n);we.push(Zt),Se.push(Ws);let Cs=0;const zn={};ht.forEach(Bt=>{zn[Bt.userId]||(zn[Bt.userId]=[]),zn[Bt.userId].push(Bt)}),Object.values(zn).forEach(Bt=>{Bt.sort((hs,bd)=>new Date(hs.timestamp).getTime()-new Date(bd.timestamp).getTime());const Gs=Bt.find(hs=>hs.type==="check-in"),us=Bt.find(hs=>hs.type==="check-out");if(Gs&&us){const hs=so(new Date(us.timestamp),new Date(Gs.timestamp));Cs+=hs/60}}),_e.push(Zt>0?parseFloat((Cs/Zt).toFixed(1)):0)}),d({totalEmployees:_t,presentToday:Je,absentToday:J,onLeaveToday:at,attendanceTrend:{labels:oe,present:we,absent:Se},productivityTrend:{labels:oe,hours:_e}})}catch(ye){console.error("Failed to load dashboard data",ye)}finally{f(!1)}},[r]);C.useEffect(()=>{p.startDate&&p.endDate&&U(p.startDate,p.endDate)},[p,U]),C.useEffect(()=>{if(E!=="log"||!p.startDate||!p.endDate)return;const ne=ye=>parseFloat(ye.toFixed(6));(async()=>{const ye=S==="all"?r:r.filter(pe=>pe.id===S),re=new Set(ye.map(pe=>pe.id)),ae=o.filter(pe=>{if(!re.has(pe.userId)||new Date(pe.timestamp)<p.startDate||new Date(pe.timestamp)>p.endDate||pe.locationName||!pe.latitude||!pe.longitude)return!1;const Ne=`${ne(pe.latitude)},${ne(pe.longitude)}`;return!H[Ne]});if(console.log("Geocoding: Events to process:",ae.length),ae.length===0)return;const ve=ae.map(pe=>({lat:pe.latitude,lon:pe.longitude}));console.log("Geocoding: Fetching addresses for",ve.length,"unique coordinates");try{const pe=await te.batchResolveAddresses(ve);console.log("Geocoding: Resolved addresses:",Object.keys(pe).length),F(Ne=>({...Ne,...pe}))}catch(pe){console.error("Batch geocoding failed:",pe)}})()},[o,p,S,E,r]);const W=ne=>{_(ne);const ge=new Date;let ye=jp(),re=cb();ne==="This Month"?(ye=as(ge),re=jr(ge)):ne==="This Year"?(ye=Ng(ge),re=Dw(ge)):ne==="Last 7 Days"?ye=ji(ge,6):ne==="Last 30 Days"&&(ye=ji(ge,29)),re>ge&&(re=ge),g({startDate:ye,endDate:re,key:"selection"})},B=ne=>{g(ne.selection),_("Custom"),j(!1)},q=C.useMemo(()=>{const ne=p.endDate,ge=new Date;return Ce(ne,"yyyy-MM-dd")===Ce(ge,"yyyy-MM-dd")?"Today":`on ${Ce(ne,"MMM d")}`},[p]),Q=C.useMemo(()=>{if(!p.startDate||!p.endDate)return[];const ne=[],ge=Ur({start:p.startDate,end:p.endDate});return(S==="all"?r:r.filter(re=>re.id===S)).forEach(re=>{ge.forEach(ae=>{const ve=Ce(ae,"yyyy-MM-dd"),pe=o.filter(J=>J.userId===re.id&&Ce(new Date(J.timestamp),"yyyy-MM-dd")===ve);let Ne="Absent",Me="",Oe="",Je="";const dt=Ce(ae,"EEEE"),at=dt==="Sunday";if(s.some(J=>{if(J.day.toLowerCase()!==dt.toLowerCase())return!1;const K=ae.getDate(),oe=Math.ceil(K/7),we=re.role==="field_staff"?"field":"office",Se=J.type||"office";return J.n===oe&&Se===we})?Ne="Holiday":at&&(Ne="Weekend"),pe.length>0){const J=[...pe].sort((we,Se)=>new Date(we.timestamp).getTime()-new Date(Se.timestamp).getTime()),K=J.find(we=>we.type==="check-in"),oe=J.find(we=>we.type==="check-out");if(K&&(Ne="Present",Me=Ce(new Date(K.timestamp),"HH:mm")),oe&&(Oe=Ce(new Date(oe.timestamp),"HH:mm")),K&&oe){const we=new Date(K.timestamp),Se=new Date(oe.timestamp),_e=so(Se,we),Pe=Math.floor(_e/60),Ue=_e%60;Je=`${Pe}h ${Ue}m`}}ne.push({userName:re.name,date:ve,status:Ne,checkIn:Me,checkOut:Oe,duration:Je})})}),ne},[r,o,p,S,s]),le=C.useMemo(()=>{if(!p.startDate||!p.endDate)return[];const ne=re=>parseFloat(re.toFixed(6)),ge=S==="all"?r:r.filter(re=>re.id===S),ye=new Set(ge.map(re=>re.id));return o.filter(re=>ye.has(re.userId)).map(re=>{const ae=r.find(Ne=>Ne.id===re.userId),ve=re.latitude&&re.longitude?`${ne(re.latitude)},${ne(re.longitude)}`:"",pe=H[ve];return{userName:(ae==null?void 0:ae.name)||"Unknown",date:Ce(new Date(re.timestamp),"yyyy-MM-dd"),time:Ce(new Date(re.timestamp),"HH:mm:ss"),type:re.type,locationName:re.locationName||pe||(re.latitude?`${re.latitude.toFixed(4)}, ${re.longitude.toFixed(4)}`:"N/A"),latitude:re.latitude,longitude:re.longitude}}).sort((re,ae)=>re.date!==ae.date?re.date.localeCompare(ae.date):re.time.localeCompare(ae.time))},[r,o,p,S,H]),X=C.useMemo(()=>{if(!p.startDate||!p.endDate)return[];const ne=Ur({start:p.startDate,end:p.endDate});return(S==="all"?r:r.filter(ye=>ye.id===S)).map(ye=>{const re=[];let ae=0,ve=0,pe=0,Ne=0,Me=0,Oe=0,Je=0;ne.forEach(at=>{const _t=Ce(at,"yyyy-MM-dd"),K=o.filter(Pe=>Pe.userId===ye.id&&Ce(new Date(Pe.timestamp),"yyyy-MM-dd")===_t).some(Pe=>Pe.type==="check-in"),oe=Ce(at,"EEEE"),we=oe==="Sunday",Se=s.some(Pe=>{if(Pe.day.toLowerCase()!==oe.toLowerCase())return!1;const Ue=at.getDate(),ht=Math.ceil(Ue/7),Zt=ye.role==="field_staff"?"field":"office",an=Pe.type||"office";return Pe.n===ht&&an===Zt});let _e="";K?Se?(_e="HP",Je++):we?(_e="WOP",Oe++):(_e="P",ae++):Se?(_e="H",Me++):we?(_e="WO",Ne++):(_e="A",ve++),re.push(_e)});const dt=ae+Ne+Me+Oe+Je+pe*.5;return{userName:ye.name,statuses:re,presentDays:ae,absentDays:ve,halfDays:pe,weekOffs:Ne,holidays:Me,weekendPresents:Oe,holidayPresents:Je,totalPayableDays:dt}})},[r,o,p,S,s]),Z=C.useMemo(()=>E==="basic"?a.jsx(Pre,{data:Q,dateRange:p}):E==="log"?a.jsx(Ere,{data:le,dateRange:p}):E==="monthly"?a.jsx(Mre,{data:X,dateRange:p}):null,[E,Q,le,X,p]),se=()=>{O(!0);try{let ne="data:text/csv;charset=utf-8,",ge=`Attendance_Report_${Ce(new Date,"yyyy-MM-dd")}.csv`;if(E==="basic")ne+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,Q.forEach(ae=>{ne+=`"${ae.userName}","${ae.date}","${ae.status}","${ae.checkIn}","${ae.checkOut}","${ae.duration}"
`});else if(E==="log")ne+=`User,Date,Time,Event,Location,Latitude,Longitude
`,le.forEach(ae=>{ne+=`"${ae.userName}","${ae.date}","${ae.time}","${ae.type}","${ae.locationName||""}","${ae.latitude||""}","${ae.longitude||""}"
`});else if(E==="monthly"){const ve=Ur({start:p.startDate,end:p.endDate}).map(pe=>Ce(pe,"dd MMM")).join(",");ne+=`Employee Name,${ve},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,X.forEach(pe=>{const Ne=pe.statuses.join(",");ne+=`"${pe.userName}",${Ne},"${pe.presentDays}","${pe.absentDays}","${pe.halfDays}","${pe.weekOffs}","${pe.holidays}","${pe.weekendPresents}","${pe.holidayPresents}","${pe.totalPayableDays}"
`})}const ye=encodeURI(ne),re=document.createElement("a");re.setAttribute("href",ye),re.setAttribute("download",ge),document.body.appendChild(re),re.click(),document.body.removeChild(re),z({message:"CSV downloaded successfully.",type:"success"})}catch(ne){console.error("CSV generation failed:",ne),z({message:"Failed to generate CSV.",type:"error"})}finally{O(!1)}};return h&&!c?a.jsx("div",{className:"flex justify-center items-center h-96",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),a.jsxs("div",{className:"bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex flex-wrap items-end gap-4",children:[a.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(ne=>a.jsx(Y,{type:"button",size:"sm",onClick:()=>W(ne),className:v===ne?"text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:v===ne?{backgroundColor:"#006B3F",borderColor:"#005632"}:{},children:ne},ne)),a.jsxs("div",{className:"relative",ref:k,children:[a.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:()=>j(!N),className:"hover:bg-gray-100",children:[a.jsx(wl,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:v==="Custom"?`${Ce(p.startDate,"dd MMM, yyyy")} - ${Ce(p.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),N&&a.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[a.jsxs("div",{className:"flex items-center gap-2 p-3",children:[a.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:Ce(p.startDate,"yyyy-MM-dd"),max:Ce(new Date,"yyyy-MM-dd"),onChange:ne=>{const ge=new Date(ne.target.value);let ye=p.endDate;ge>ye&&(ye=ge),g({startDate:ge,endDate:ye,key:"selection"}),_("Custom")}}),a.jsx("span",{className:"text-sm",children:"to"}),a.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:Ce(p.endDate,"yyyy-MM-dd"),max:Ce(new Date,"yyyy-MM-dd"),onChange:ne=>{const ge=new Date(ne.target.value);let ye=p.startDate;ge<ye&&(ye=ge),g({startDate:ye,endDate:ge,key:"selection"}),_("Custom")}})]}),a.jsx(Ih.DateRangePicker,{onChange:B,months:n?1:2,ranges:b,direction:"horizontal",maxDate:new Date})]})]})]}),a.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),a.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none",value:E,onChange:ne=>M(ne.target.value),children:[a.jsx("option",{value:"basic",children:"Basic Report"}),a.jsx("option",{value:"log",children:"Attendance Log"}),a.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),a.jsxs("select",{className:"border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 focus:ring-green-500 outline-none max-w-[200px]",value:S,onChange:ne=>P(ne.target.value),children:[a.jsx("option",{value:"all",children:"All Employees"}),r.map(ne=>a.jsx("option",{value:ne.id,children:ne.name},ne.id))]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6",children:[a.jsx(wi,{title:"Total Employees",value:(c==null?void 0:c.totalEmployees)||0,icon:Ei}),a.jsx(wi,{title:`Present ${q}`,value:(c==null?void 0:c.presentToday)||0,icon:nd}),a.jsx(wi,{title:`Absent ${q}`,value:(c==null?void 0:c.absentToday)||0,icon:t_}),a.jsx(wi,{title:`On Leave ${q}`,value:(c==null?void 0:c.onLeaveToday)||0,icon:Ww})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsx(pT,{title:"Attendance Trend",icon:JY,children:c?a.jsx(kre,{data:c.attendanceTrend}):a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),a.jsx(pT,{title:"Productivity Trend (Avg. Hours)",icon:IZ,children:c?a.jsx(Tre,{data:c.productivityTrend}):a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),a.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:a.jsx("div",{ref:R,className:"w-full bg-white",children:Z})}),a.jsxs("div",{className:"bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),V&&a.jsxs(Y,{type:"button",onClick:se,disabled:I,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[I?a.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(LD,{className:"mr-2 h-4 w-4"}),I?"Generating...":"Download CSV"]})]}),a.jsx("div",{className:"border p-4 rounded bg-gray-50",children:Z})]}),D&&a.jsx(gt,{message:D.message,type:D.type,onDismiss:()=>z(null)})]})},Are=()=>{const{user:n}=tt(),[e,t]=C.useState([]),[s,r]=C.useState(!0),[i,o]=C.useState(!1),[l,c]=C.useState(null);C.useEffect(()=>{(async()=>{if(n)try{const p=await te.getUserLocations(n.id);t(p)}catch(p){console.error(p),c({message:"Failed to load locations.",type:"error"})}finally{r(!1)}})()},[n]);const d=async()=>{if(n){o(!0);try{const f=await Mg().catch(()=>null);let p,g;if(f&&f.coords&&(p=f.coords.latitude,g=f.coords.longitude),p===void 0||g===void 0){const N=await new Promise(j=>{navigator.geolocation.getCurrentPosition(k=>j(k),()=>j(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});N&&N.coords&&(p=N.coords.latitude,g=N.coords.longitude)}if(p===void 0||g===void 0)throw new Error("Unable to retrieve current location.");let b=null;try{b=await lh(p,g)}catch(N){console.warn("Reverse geocode failed for new user location:",N)}const _=await te.createLocation({name:b,latitude:p,longitude:g,radius:100,address:b,createdBy:n.id});await te.assignLocationToUser(n.id,_.id),t(N=>[...N,_]),c({message:"Location added successfully.",type:"success"})}catch(f){console.error(f),c({message:"Failed to add location.",type:"error"})}finally{o(!1)}}},h=async f=>{if(n)try{await te.unassignLocationFromUser(n.id,f),t(p=>p.filter(g=>g.id!==f)),c({message:"Location removed.",type:"success"})}catch(p){console.error(p),c({message:"Failed to remove location.",type:"error"})}};return a.jsxs("div",{className:"p-4 md:p-6 w-full",children:[l&&a.jsx(gt,{message:l.message,type:l.type,onDismiss:()=>c(null)}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[a.jsx(io,{className:"h-6 w-6 mr-2"})," My Locations"]}),a.jsx("p",{className:"text-muted mb-6",children:"These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. Use the button below to add your current location if it isnt listed."}),a.jsx("div",{className:"mb-6",children:a.jsxs(Y,{onClick:d,isLoading:i,disabled:i||!n,children:[a.jsx(HD,{className:"h-4 w-4 mr-2"})," Add Current Location"]})})]}),a.jsx("div",{className:"mt-6",children:s?a.jsx("p",{children:"Loading locations..."}):e.length===0?a.jsx("p",{className:"text-muted text-center md:text-left",children:"You have no locations assigned. Use the button above to add one."}):a.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[a.jsx("div",{className:"md:hidden space-y-4",children:e.map(f=>{var p,g;return a.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"font-bold text-primary-text",children:f.name||f.address||"Unnamed Location"}),a.jsx("p",{className:"text-sm text-muted",children:f.address})]}),a.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Remove Location",onClick:()=>h(f.id),children:a.jsx(kt,{className:"h-5 w-5"})})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Radius"}),a.jsxs("p",{children:[f.radius,"m"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Coordinates"}),a.jsxs("p",{children:[(p=f.latitude)==null?void 0:p.toFixed(4),", ",(g=f.longitude)==null?void 0:g.toFixed(4)]})]})]})]},f.id)})}),a.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:a.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[a.jsx("thead",{className:"bg-page text-primary-text",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(f=>{var p,g;return a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("td",{className:"p-3",children:f.name||"-"}),a.jsx("td",{className:"p-3",children:f.radius}),a.jsxs("td",{className:"p-3",children:[(p=f.latitude)==null?void 0:p.toFixed(4),", ",(g=f.longitude)==null?void 0:g.toFixed(4)]}),a.jsx("td",{className:"p-3",children:f.address||"-"}),a.jsx("td",{className:"p-3",children:a.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Remove Location",onClick:()=>h(f.id),children:a.jsx(kt,{className:"h-4 w-4"})})})]},f.id)})})]})})]})})]})},Ire=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:s,addHoliday:r,removeHoliday:i,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=ir(),[d,h]=C.useState(n),[f,p]=C.useState(!1),[g,b]=C.useState(!1),[v,_]=C.useState("office"),[N,j]=C.useState(""),[k,S]=C.useState(""),[P,E]=C.useState(3),[M,I]=C.useState("Saturday"),[O,D]=C.useState(null);C.useEffect(()=>{h(n)},[n]),C.useEffect(()=>{p(JSON.stringify(d)!==JSON.stringify(n))},[d,n]);const z=d[v],H=v==="office"?e:t,F=async U=>{if(U.preventDefault(),N&&k){if(H.some(W=>W.date===k)){D({message:"A holiday for this date already exists.",type:"error"});return}try{await r(v,{name:N,date:k}),j(""),S(""),D({message:"Holiday added successfully.",type:"success"})}catch{D({message:"Failed to add holiday.",type:"error"})}}else D({message:"Please provide both a name and a date.",type:"error"})},R=(U,W)=>{h(B=>({...B,[v]:{...B[v],[U]:W}}))},V=async()=>{b(!0);try{await te.saveAttendanceSettings(d),c(d),D({message:"Attendance rules saved successfully!",type:"success"})}catch{D({message:"Failed to save attendance rules.",type:"error"})}finally{b(!1)}};return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[O&&a.jsx(gt,{message:O.message,type:O.type,onDismiss:()=>D(null)}),a.jsx(ur,{title:"Attendance & Leave Rules",children:a.jsxs(Y,{onClick:V,isLoading:g,disabled:!f,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),a.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),a.jsx("div",{className:"mb-6 border-b border-border",children:a.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[a.jsx("button",{onClick:()=>_("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${v==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),a.jsx("button",{onClick:()=>_("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${v==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),v==="office"&&a.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),v==="field"&&a.jsx("p",{className:"text-sm text-muted -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("section",{children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(Ww,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(he,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:z.minimumHoursFullDay,onChange:U=>R("minimumHoursFullDay",parseFloat(U.target.value)||0)}),a.jsx(he,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:z.minimumHoursHalfDay,onChange:U=>R("minimumHoursHalfDay",parseFloat(U.target.value)||0)})]})]}),a.jsxs("section",{className:"pt-6 border-t border-border",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(uh,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsx(he,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:z.annualEarnedLeaves,onChange:U=>R("annualEarnedLeaves",parseInt(U.target.value,10)||0)}),a.jsx(he,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:z.annualSickLeaves,onChange:U=>R("annualSickLeaves",parseInt(U.target.value,10)||0)}),a.jsx(he,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:z.monthlyFloatingLeaves,onChange:U=>R("monthlyFloatingLeaves",parseInt(U.target.value,10)||0)}),a.jsx(he,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:z.annualCompOffLeaves,onChange:U=>R("annualCompOffLeaves",parseInt(U.target.value,10)||0)}),a.jsx(he,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:z.sickLeaveCertificateThreshold,onChange:U=>R("sickLeaveCertificateThreshold",parseInt(U.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),a.jsxs("section",{className:"pt-6 border-t border-border",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(dh,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),a.jsx(zt,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:z.enableAttendanceNotifications,onChange:U=>R("enableAttendanceNotifications",U.target.checked)})]}),a.jsxs("section",{className:"pt-6 border-t border-border",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(wl,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),a.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[a.jsxs(Te,{label:"Occurrence",value:P,onChange:U=>E(parseInt(U.target.value)),children:[a.jsx("option",{value:1,children:"1st"}),a.jsx("option",{value:2,children:"2nd"}),a.jsx("option",{value:3,children:"3rd"}),a.jsx("option",{value:4,children:"4th"}),a.jsx("option",{value:5,children:"5th"})]}),a.jsxs(Te,{label:"Day",value:M,onChange:U=>I(U.target.value),children:[a.jsx("option",{value:"Monday",children:"Monday"}),a.jsx("option",{value:"Tuesday",children:"Tuesday"}),a.jsx("option",{value:"Wednesday",children:"Wednesday"}),a.jsx("option",{value:"Thursday",children:"Thursday"}),a.jsx("option",{value:"Friday",children:"Friday"}),a.jsx("option",{value:"Saturday",children:"Saturday"}),a.jsx("option",{value:"Sunday",children:"Sunday"})]}),a.jsxs(Y,{type:"button",onClick:async()=>{try{await o({day:M,n:P,type:v}),D({message:"Recurring holiday added successfully.",type:"success"})}catch{D({message:"Failed to add recurring holiday.",type:"error"})}},className:"w-full sm:w-auto",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),a.jsxs("div",{className:"mt-4 space-y-2",children:[s.filter(U=>(U.type||"office")===v).map((U,W)=>a.jsxs("div",{className:"flex justify-between items-center p-3 border border-border rounded-lg",children:[a.jsxs("div",{children:[a.jsxs("p",{className:"font-medium",children:[U.n===1?"1st":U.n===2?"2nd":U.n===3?"3rd":U.n+"th"," ",U.day]}),a.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),a.jsx(Y,{variant:"icon",size:"sm",onClick:async()=>{if(U.id)try{await l(U.id),D({message:"Recurring holiday removed successfully.",type:"success"})}catch{D({message:"Failed to remove recurring holiday.",type:"error"})}},children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]},U.id||W)),s.filter(U=>(U.type||"office")===v).length===0&&a.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),a.jsxs("section",{className:"pt-6 border-t border-border",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(wl,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),a.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),a.jsxs("form",{onSubmit:F,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[a.jsx(he,{label:"Holiday Name",id:"holidayName",value:N,onChange:U=>j(U.target.value)}),a.jsx($t,{label:"Date",id:"holidayDate",value:k,onChange:S}),a.jsxs(Y,{type:"submit",className:"w-full sm:w-auto",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),a.jsx("div",{className:"mt-4 space-y-2",children:H.length>0?H.map(U=>a.jsxs("div",{className:"flex justify-between items-center p-3 border border-border rounded-lg",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-medium",children:U.name}),a.jsx("p",{className:"text-sm text-muted",children:new Date(U.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>i(v,U.id),"aria-label":`Remove ${U.name}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]},U.id)):a.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",v," staff."]})})]})]})]})},Ore=()=>{const{user:n}=tt(),{officeHolidays:e,fieldHolidays:t,attendance:s,recurringHolidays:r}=ir(),[i,o]=C.useState(new Date),[l,c]=C.useState([]),[d,h]=C.useState(!1),f=C.useMemo(()=>(n==null?void 0:n.role)==="field_officer"?t:e,[n,t,e]),p=C.useMemo(()=>{const k=(n==null?void 0:n.role)==="field_officer"?"field":"office";return r.filter(S=>(S.type||"office")===k)},[n,r]);C.useEffect(()=>{console.log("Active Recurring Rules:",p)},[p]);const g=C.useMemo(()=>{var O,D;const k=[],S=as(i),P=jr(i),E=Ur({start:S,end:P}),M=((n==null?void 0:n.role)==="field_officer"?(O=s==null?void 0:s.field)==null?void 0:O.monthlyFloatingLeaves:(D=s==null?void 0:s.office)==null?void 0:D.monthlyFloatingLeaves)??0;let I=0;return p.forEach(z=>{if(I>=M)return;let H=0;for(const F of E)if(Ce(F,"EEEE").toLowerCase()===z.day.toLowerCase()&&(H++,H===z.n)){k.push(F),I++;break}}),k},[i,p,s,n]);C.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",g)},[g]),C.useEffect(()=>{const k=async()=>{if(n){h(!0);try{const E=as(i).toISOString(),M=jr(i).toISOString(),I=await te.getAttendanceEvents(n.id,E,M);c(I)}catch(E){console.error("Failed to fetch attendance events",E)}finally{h(!1)}}},S=async()=>{try{console.log("Fetching attendance settings...");const E=await te.getAttendanceSettings();console.log("Fetched settings:",E),ir.getState().updateAttendanceSettings(E)}catch(E){console.error("Failed to fetch attendance settings",E)}},P=async()=>{try{console.log("Fetching recurring holidays...");const E=await te.getRecurringHolidays();console.log("Fetched recurring holidays:",E),ir.setState({recurringHolidays:E})}catch(E){console.error("Failed to fetch recurring holidays",E)}};k(),S(),P()},[n,i]);const b=C.useMemo(()=>Ur({start:as(i),end:jr(i)}),[i]),v=k=>{const S=l.some(I=>Hr(new Date(I.timestamp),k)&&(I.type.toLowerCase().includes("check")||I.type.toLowerCase().includes("in"))),P=g.some(I=>Hr(I,k)),E=f.some(I=>Hr(new Date(I.date),k));return(P||E)&&S?"holiday-present":P?"floating-holiday":E?"holiday":S?"present":B2(to(new Date),to(k))?"absent":"neutral"},_=k=>{switch(k){case"present":return"bg-emerald-100 text-emerald-800 border-emerald-300";case"absent":return"bg-pink-100 text-pink-800 border-pink-300";case"holiday":return"bg-red-200 text-red-900 border-red-400";case"floating-holiday":return"bg-amber-100 text-amber-800 border-amber-300";case"holiday-present":return"bg-violet-100 text-violet-800 border-violet-300";default:return"bg-gray-50 text-gray-400 border-gray-100"}},N=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],j=El(as(i));return a.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border border-border bg-white p-3 rounded-xl shadow-sm w-full max-w-[320px]",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>o(kh(i,1)),children:a.jsx(Ph,{className:"h-3 w-3"})}),a.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:Ce(i,"MMMM yyyy")}),a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>o(mo(i,1)),children:a.jsx(_l,{className:"h-3 w-3"})})]})]}),d?a.jsx("div",{className:"flex justify-center py-5",children:a.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted"})}):a.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[N.map(k=>a.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:k},k)),Array.from({length:j}).map((k,S)=>a.jsx("div",{className:"aspect-square"},`empty-${S}`)),b.map(k=>{const S=v(k),P=_(S);return a.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${P} transition-colors`,children:a.jsx("span",{className:"text-xs font-semibold",children:Ce(k,"d")})},k.toISOString())})]}),a.jsxs("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:[a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-emerald-100 border border-emerald-300 rounded-sm"})," Present"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-pink-100 border border-pink-300 rounded-sm"})," Absent"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-red-200 border border-red-400 rounded-sm"})," Holiday"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-amber-100 border border-amber-300 rounded-sm"})," Floating Holiday"]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-violet-100 border border-violet-300 rounded-sm"})," Holiday Present"]})]})]})},Rre=({logs:n,isLoading:e=!1})=>{const[t,s]=C.useState(new Date),r=C.useMemo(()=>Ur({start:as(t),end:jr(t)}),[t]),i=d=>n.some(f=>{const p=new Date(f.dateEarned.replace(/-/g,"/"));return Hr(p,d)})?"earned":"neutral",o=d=>{switch(d){case"earned":return"bg-blue-100 text-blue-800 border-blue-300";default:return"bg-gray-50 text-gray-400 border-gray-100"}},l=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],c=El(as(t));return a.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border border-border bg-white p-3 rounded-xl shadow-sm w-full max-w-[320px]",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>s(kh(t,1)),children:a.jsx(Ph,{className:"h-3 w-3"})}),a.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:Ce(t,"MMMM yyyy")}),a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>s(mo(t,1)),children:a.jsx(_l,{className:"h-3 w-3"})})]})]}),e?a.jsx("div",{className:"flex justify-center py-5",children:a.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted"})}):a.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[l.map(d=>a.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:d},d)),Array.from({length:c}).map((d,h)=>a.jsx("div",{className:"aspect-square"},`empty-${h}`)),r.map(d=>{const h=i(d),f=o(h);return a.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${f} transition-colors`,children:a.jsx("span",{className:"text-xs font-semibold",children:Ce(d,"d")})},d.toISOString())})]}),a.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-100 border border-blue-300 rounded-sm"})," Comp Off Earned"]})})]})},Lre=()=>{const{user:n}=tt(),[e,t]=C.useState(new Date),[s,r]=C.useState([]),[i,o]=C.useState(!1);C.useEffect(()=>{(async()=>{if(n){o(!0);try{const p=as(e).toISOString(),g=jr(e).toISOString(),b=await te.getAttendanceEvents(n.id,p,g);r(b)}catch(p){console.error("Failed to fetch attendance events",p)}finally{o(!1)}}})()},[n,e]);const l=C.useMemo(()=>Ur({start:as(e),end:jr(e)}),[e]),c=f=>{const p=s.filter(j=>Hr(new Date(j.timestamp),f));if(p.length===0)return 0;const g=[...p].sort((j,k)=>new Date(j.timestamp).getTime()-new Date(k.timestamp).getTime());let b=0,v=null;g.forEach(j=>{const k=new Date(j.timestamp);j.type==="check-in"?v=k:j.type==="check-out"&&v&&(b+=so(k,v),v=null)});const _=b/60,N=Math.max(0,_-8);return parseFloat(N.toFixed(1))},d=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],h=El(as(e));return a.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border border-border bg-white p-3 rounded-xl shadow-sm w-full max-w-[320px]",children:[a.jsxs("div",{className:"flex items-center justify-between mb-3",children:[a.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(kh(e,1)),children:a.jsx(Ph,{className:"h-3 w-3"})}),a.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:Ce(e,"MMMM yyyy")}),a.jsx(Y,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>t(mo(e,1)),children:a.jsx(_l,{className:"h-3 w-3"})})]})]}),i?a.jsx("div",{className:"flex justify-center py-5",children:a.jsx(Qe,{className:"h-5 w-5 animate-spin text-muted"})}):a.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[d.map(f=>a.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:f},f)),Array.from({length:h}).map((f,p)=>a.jsx("div",{className:"aspect-square"},`empty-${p}`)),l.map(f=>{const p=c(f),g=p>0;return a.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${g?"bg-blue-100 text-blue-800 border-blue-300":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[a.jsx("span",{className:"text-xs font-semibold",children:Ce(f,"d")}),g&&a.jsxs("span",{className:"text-[8px] font-bold",children:["+",p,"h"]})]},f.toISOString())})]}),a.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("div",{className:"w-2 h-2 bg-blue-100 border border-blue-300 rounded-sm"})," Overtime (>8h)"]})})]})},gT=({title:n,value:e,icon:t})=>a.jsxs("div",{className:"bg-card p-4 rounded-xl flex items-center gap-4 border border-border",children:[a.jsx("div",{className:"bg-accent-light p-3 rounded-full",children:a.jsx(t,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("p",{className:"text-sm text-muted",children:n}),a.jsx("p",{className:"text-2xl font-bold text-primary-text",children:e})]})]}),Fre=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return a.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},$re=n=>Ke({leaveType:ie().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:ie().required("Start date is required"),endDate:ie().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:ie().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:ie().oneOf(["full","half"]).optional(),doctorCertificate:ot().when(["leaveType","startDate","endDate"],{is:(e,t,s)=>e!=="Sick"||!t||!s?!1:rr(new Date(s.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),zre=({isOpen:n,onClose:e,onSuccess:t,user:s,isMobile:r,setToast:i})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=ir(),l=C.useMemo(()=>$re(o),[o]),{register:c,control:d,handleSubmit:h,watch:f,formState:{errors:p},reset:g}=xt({resolver:Lt(l),defaultValues:{leaveType:"Earned",startDate:Ce(new Date,"yyyy-MM-dd"),endDate:Ce(new Date,"yyyy-MM-dd"),dayOption:"full"}}),b=f("startDate"),v=f("endDate"),_=f("leaveType"),j=C.useMemo(()=>!b||!v?!1:Hr(new Date(b.replace(/-/g,"/")),new Date(v.replace(/-/g,"/"))),[b,v])&&_==="Earned",k=C.useMemo(()=>_!=="Sick"||!b||!v?!1:rr(new Date(v.replace(/-/g,"/")),new Date(b.replace(/-/g,"/")))+1>o,[_,b,v,o]),S=async P=>{try{await te.submitLeaveRequest({...P,userId:s.id,userName:s.name}),t()}catch{i({message:"Failed to submit leave request.",type:"error"})}};return n?a.jsx("div",{className:`fixed inset-0 z-40 bg-card ${r?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:a.jsxs("div",{className:`w-full ${r?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[a.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${r?"fo-mobile-header":"border-b"}`,children:[a.jsx(Y,{variant:"icon",onClick:e,"aria-label":"Go back",children:a.jsx(Er,{className:"h-6 w-6"})}),a.jsx("h1",{className:"text-lg font-semibold",children:r?"New Leave Request":"Submit a New Leave Request"})]}),a.jsxs("form",{id:"leave-form",onSubmit:h(S),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[a.jsx(de,{name:"leaveType",control:d,render:({field:P})=>{var E;return a.jsxs(Te,{label:"Leave Type",...P,error:(E=p.leaveType)==null?void 0:E.message,className:r?"pro-select pro-select-arrow":"",children:[a.jsx("option",{children:"Earned"}),a.jsx("option",{children:"Sick"}),a.jsx("option",{children:"Floating"}),a.jsx("option",{children:"Comp Off"})]})}}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(de,{name:"startDate",control:d,render:({field:P})=>{var E;return a.jsx($t,{label:"Start Date",id:"startDate",value:P.value,onChange:P.onChange,error:(E=p.startDate)==null?void 0:E.message})}}),a.jsx(de,{name:"endDate",control:d,render:({field:P})=>{var E;return a.jsx($t,{label:"End Date",id:"endDate",value:P.value,onChange:P.onChange,error:(E=p.endDate)==null?void 0:E.message})}})]}),j&&a.jsx(de,{name:"dayOption",control:d,render:({field:P})=>a.jsxs(Te,{label:"Day Option",...P,className:r?"pro-select pro-select-arrow":"",children:[a.jsx("option",{value:"full",children:"Full Day"}),a.jsx("option",{value:"half",children:"Half Day"})]})}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),a.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${p.reason?"form-input--error":""}`}),p.reason&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.reason.message})]}),k&&a.jsx(de,{name:"doctorCertificate",control:d,render:({field:P,fieldState:E})=>{var M;return a.jsx(qe,{label:"Doctor's Certificate (Required)",file:P.value,onFileChange:P.onChange,error:(M=E.error)==null?void 0:M.message,allowCapture:!0})}})]}),a.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${r?"":"border-t"}`,children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(Y,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Ure=()=>{const{user:n}=tt(),[e,t]=C.useState(null),[s,r]=C.useState([]),[i,o]=C.useState([]),[l,c]=C.useState(!0),[d,h]=C.useState(!1),[f,p]=C.useState("all"),[g,b]=C.useState(null),v=Nt("(max-width: 767px)"),[_,N]=C.useState(!1),[j,k]=C.useState(0),S=C.useCallback(async()=>{if(n){c(!0),h(!1);try{const[O,D,z]=await Promise.all([te.getLeaveBalancesForUser(n.id),te.getLeaveRequests({userId:n.id,status:f==="all"?void 0:f}),te.getCompOffLogs(n.id).catch(H=>{if(H&&H.message&&(H.message.includes("comp_off_logs")||H.message.includes('relation "public.comp_off_logs" does not exist')))return h(!0),[];throw H})]);if(t(O),r(D),o(z),n.role==="field_officer"){const H=new Date,F=as(H).toISOString(),R=jr(H).toISOString(),V=await te.getAttendanceEvents(n.id,F,R),U={};V.forEach(B=>{const q=Ce(new Date(B.timestamp),"yyyy-MM-dd");U[q]||(U[q]=[]),U[q].push(B)});let W=0;Object.values(U).forEach(B=>{const q=[...B].sort((Z,se)=>new Date(Z.timestamp).getTime()-new Date(se.timestamp).getTime());let Q=0,le=null;q.forEach(Z=>{const se=new Date(Z.timestamp);Z.type==="check-in"?le=se:Z.type==="check-out"&&le&&(Q+=so(se,le),le=null)});const X=Q/60;X>8&&(W+=X-8)}),k(parseFloat(W.toFixed(1)))}}catch(O){let D="Failed to load leave data.";O&&typeof O.message=="string"&&O.message.includes('relation "leave_requests" does not exist')&&(D='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",O),d||b({message:D,type:"error"})}finally{c(!1)}}},[n,f]);C.useEffect(()=>{S()},[S]);const P=()=>{b({message:"Leave request submitted successfully!",type:"success"}),N(!1),S()},E=O=>O.replace(/_/g," ").replace(/\b\w/g,D=>D.toUpperCase()),M=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],I=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:ID},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:Gw},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:TZ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:nZ}]:[];return a.jsxs("div",{className:"p-4 space-y-6",children:[g&&a.jsx(gt,{message:g.message,type:g.type,onDismiss:()=>b(null)}),n&&a.jsx(zre,{isOpen:_,onClose:()=>N(!1),onSuccess:P,user:n,isMobile:v,setToast:b}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!v&&a.jsxs(Y,{onClick:()=>N(!0),children:[a.jsx(ct,{className:"mr-2 h-4"})," New Request"]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[I.map(O=>a.jsx(gT,{...O},O.title)),(n==null?void 0:n.role)==="field_officer"&&a.jsx(gT,{title:"Overtime Hours",value:`${j} hrs`,icon:Ww})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[a.jsx(Ore,{}),a.jsx(Rre,{logs:i,isLoading:l}),(n==null?void 0:n.role)==="field_officer"&&a.jsx(Lre,{})]}),v&&a.jsx("div",{className:"my-4",children:a.jsxs(Y,{onClick:()=>N(!0),size:"lg",className:"w-full justify-center",children:[a.jsx(ct,{className:"mr-2 h-5"})," New Request"]})}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:a.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:M.map(O=>a.jsx("button",{onClick:()=>p(O),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${f===O?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:E(O)},O))})})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):s.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No requests found."})}):s.map(O=>a.jsxs("tr",{children:[a.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium",children:[O.leaveType," ",O.dayOption&&`(${O.dayOption})`]}),a.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[Ce(new Date(O.startDate.replace(/-/g,"/")),"dd MMM")," - ",Ce(new Date(O.endDate.replace(/-/g,"/")),"dd MMM")]}),a.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:O.reason}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:a.jsx(Fre,{status:O.status})})]},O.id))})]})})]}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?a.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[a.jsx(Jr,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),a.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),a.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):i.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No comp-off history found."})}):i.map(O=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:Ce(new Date(O.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),a.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:O.reason}),a.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:O.grantedByName||"-"}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${O.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:O.status})})]},O.id))})]})})]})]})},Vre=Ke({userId:ie().required("Please select an employee."),dateEarned:ie().required("Please select the date the comp-off was earned."),reason:ie().required("A reason is required (e.g., Worked on Sunday, Holiday duty).").min(5,"Reason is too short.")}).defined(),Bre=({isOpen:n,onClose:e,onSuccess:t})=>{var b;const{user:s}=tt(),[r,i]=C.useState([]),[o,l]=C.useState(!1),{register:c,handleSubmit:d,control:h,formState:{errors:f},reset:p}=xt({resolver:Lt(Vre),defaultValues:{dateEarned:Ce(new Date,"yyyy-MM-dd")}});C.useEffect(()=>{n?te.getUsers().then(i):p({userId:"",dateEarned:Ce(new Date,"yyyy-MM-dd"),reason:""})},[n,p]);const g=async v=>{if(s){l(!0);try{const _=r.find(N=>N.id===v.userId);await te.addCompOffLog({...v,userName:(_==null?void 0:_.name)||"",status:"earned",grantedById:s.id,grantedByName:s.name}),t()}catch(_){console.error("Failed to grant comp-off",_)}finally{l(!1)}}};return a.jsx(yn,{isOpen:n,onClose:e,onConfirm:d(g),title:"Grant Compensatory Off",confirmButtonText:"Grant",confirmButtonVariant:"primary",isConfirming:o,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx(de,{name:"userId",control:h,render:({field:v})=>{var _;return a.jsxs(Te,{label:"Select Employee",...v,error:(_=f.userId)==null?void 0:_.message,children:[a.jsx("option",{value:"",children:"-- Select an Employee --"}),r.map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})}}),a.jsx(de,{name:"dateEarned",control:h,render:({field:v})=>{var _;return a.jsx($t,{label:"Date Worked / Earned",id:"dateEarned",value:v.value,onChange:v.onChange,error:(_=f.dateEarned)==null?void 0:_.message,maxDate:new Date})}}),a.jsx(he,{label:"Reason for Comp-Off",id:"reason",...c("reason"),error:(b=f.reason)==null?void 0:b.message,placeholder:"e.g., Worked on Sunday"})]})})},qre=({isOpen:n,onClose:e,onConfirm:t,isConfirming:s})=>{const[r,i]=C.useState(""),[o,l]=C.useState(""),c=()=>{if(!r.trim()){l("A reason for rejection is required.");return}t(r)},d=()=>{i(""),l(""),e()};return n?a.jsx(yn,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:s,children:a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),a.jsxs("div",{children:[a.jsx("textarea",{value:r,onChange:h=>{i(h.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},Hre=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return a.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},Wre=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return a.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Gre=()=>{const{user:n}=tt(),[e,t]=C.useState([]),[s,r]=C.useState([]),[i,o]=C.useState(!0),[l,c]=C.useState("pending_manager_approval"),[d,h]=C.useState(null),[f,p]=C.useState(null),g=Nt("(max-width: 767px)"),[b,v]=C.useState(!1),[_,N]=C.useState(!0),[j,k]=C.useState(!1),[S,P]=C.useState(null);C.useEffect(()=>{(async()=>{try{await te.checkCompOffTableExists(),N(!0)}catch{N(!1)}})()},[]);const E=C.useCallback(async()=>{if(n){o(!0);try{const F=["admin","hr","operation_manager","site_manager"].includes(n.role),[R,V]=await Promise.all([te.getLeaveRequests({forApproverId:n.id,status:l!=="all"&&l!=="claims"?l:void 0}),F?te.getExtraWorkLogs():Promise.resolve([])]);t(R),r(V)}catch{h({message:"Failed to load approval data.",type:"error"})}finally{o(!1)}}},[n,l]);C.useEffect(()=>{E()},[E]);const M=async(F,R)=>{if(n){p(F);try{switch(R){case"approve":await te.approveLeaveRequest(F,n.id);break;case"reject":await te.rejectLeaveRequest(F,n.id);break;case"confirm":await te.confirmLeaveByHR(F,n.id);break}h({message:"Request actioned successfully.",type:"success"}),E()}catch{h({message:"Failed to update request.",type:"error"})}finally{p(null)}}},I=async F=>{if(n){p(F);try{await te.approveExtraWorkClaim(F,n.id),h({message:"Claim approved successfully.",type:"success"}),E()}catch{h({message:"Failed to approve claim.",type:"error"})}finally{p(null)}}},O=async F=>{if(!(!n||!S)){p(S.id);try{await te.rejectExtraWorkClaim(S.id,n.id,F),h({message:"Claim rejected successfully.",type:"success"}),E()}catch{h({message:"Failed to reject claim.",type:"error"})}finally{p(null),k(!1),P(null)}}},D=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],z=({request:F})=>{if(!n||F.status==="approved"||F.status==="rejected")return null;if(F.currentApproverId===n.id){if(F.status==="pending_manager_approval")return a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>M(F.id,"approve"),disabled:f===F.id,title:"Approve","aria-label":"Approve request",children:a.jsx(ol,{className:"h-4 w-4 text-green-600"})}),a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>M(F.id,"reject"),disabled:f===F.id,title:"Reject","aria-label":"Reject request",children:a.jsx(Us,{className:"h-4 w-4 text-red-600"})})]});if(F.status==="pending_hr_confirmation"&&(n.role==="hr"||n.role==="admin"))return a.jsxs("div",{className:"flex gap-2",children:[a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>M(F.id,"confirm"),disabled:f===F.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:a.jsx(ol,{className:"h-4 w-4 text-blue-600"})}),a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>M(F.id,"reject"),disabled:f===F.id,title:"Reject","aria-label":"Reject request",children:a.jsx(Us,{className:"h-4 w-4 text-red-600"})})]})}return null},H=F=>F.replace(/_/g," ").replace(/\b\w/g,R=>R.toUpperCase());return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[d&&a.jsx(gt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),a.jsx(Bre,{isOpen:b,onClose:()=>v(!1),onSuccess:()=>{h({message:"Compensatory off granted successfully.",type:"success"}),v(!1)}}),a.jsx(qre,{isOpen:j,onClose:()=>{k(!1),P(null)},onConfirm:O,isConfirming:!!f}),a.jsxs("div",{className:"flex justify-between items-center mb-6",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!g&&a.jsxs(Y,{onClick:()=>v(!0),disabled:!_,title:_?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),g&&a.jsx("div",{className:"mb-6",children:a.jsxs(Y,{onClick:()=>v(!0),disabled:!_,title:_?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),a.jsx("div",{className:"mb-6",children:a.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:a.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:D.map(F=>a.jsx("button",{onClick:()=>c(F),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${l===F?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:H(F)},F))})})}),l==="claims"?a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:i?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-10",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin mx-auto"})})}):s.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):s.map(F=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:F.userName}),a.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[Ce(new Date(F.workDate),"dd MMM, yyyy")," (",F.workType,")"]}),a.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[F.claimType,F.claimType==="OT"?` (${F.hoursWorked} hrs)`:""]}),a.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:F.reason}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:a.jsx(Wre,{status:F.status})}),a.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:a.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>I(F.id),disabled:f===F.id,title:"Approve Claim",children:a.jsx(ol,{className:"h-4 w-4 text-green-600"})}),a.jsx(Y,{size:"sm",variant:"icon",onClick:()=>{P(F),k(!0)},disabled:f===F.id,title:"Reject Claim",children:a.jsx(Us,{className:"h-4 w-4 text-red-600"})})]})})]},F.id))})]})}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:i?g?a.jsx("tr",{children:a.jsx("td",{colSpan:6,children:a.jsx(Pi,{rows:3,cols:6,isMobile:!0})})}):a.jsx(Pi,{rows:5,cols:6}):e.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):e.map(F=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:F.userName}),a.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[F.leaveType," ",F.dayOption&&`(${F.dayOption})`]}),a.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[Ce(new Date(F.startDate.replace(/-/g,"/")),"dd MMM")," - ",Ce(new Date(F.endDate.replace(/-/g,"/")),"dd MMM")]}),a.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:F.reason}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:a.jsx(Hre,{status:F.status})}),a.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:a.jsx("div",{className:"flex md:justify-start justify-end",children:f===F.id?a.jsx(Qe,{className:"h-4 w-4 animate-spin"}):a.jsx(z,{request:F})})})]},F.id))})]})})]})},Yre=()=>{const[n,e]=C.useState([]),[t,s]=C.useState([]),[r,i]=C.useState("hr"),[o,l]=C.useState(!0),[c,d]=C.useState(!1),[h,f]=C.useState(null),p=C.useCallback(async()=>{l(!0);try{const[v,_,N]=await Promise.all([te.getUsersWithManagers(),te.getApprovalWorkflowSettings(),te.getRoles()]);e(v),i(_.finalConfirmationRole),s(N.filter(j=>["admin","hr","operation_manager"].includes(j.id)))}catch{f({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);C.useEffect(()=>{p()},[p]);const g=(v,_)=>{e(N=>N.map(j=>j.id===v?{...j,reportingManagerId:_||void 0}:j))},b=async()=>{d(!0);try{await Promise.all(n.map(v=>te.updateUserReportingManager(v.id,v.reportingManagerId||null))),await te.updateApprovalWorkflowSettings(r),f({message:"Workflow saved successfully!",type:"success"}),p()}catch{f({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return a.jsxs("div",{className:"p-4 md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[h&&a.jsx(gt,{message:h.message,type:h.type,onDismiss:()=>f(null)}),a.jsx(ur,{title:"Leave Approval Settings",children:a.jsxs(Y,{onClick:b,isLoading:c,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),a.jsxs("section",{className:"mb-8",children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),a.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),a.jsx("div",{className:"max-w-xs",children:a.jsx(Te,{label:"Final Confirmation Role",id:"final-approver",value:r,onChange:v=>i(v.target.value),children:t.map(v=>a.jsx("option",{value:v.id,children:v.displayName},v.id))})})]}),a.jsxs("section",{children:[a.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-2",children:"Reporting Structure"}),a.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),o?a.jsx("div",{className:"flex justify-center items-center py-10",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted"})}):a.jsxs(a.Fragment,{children:[a.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:a.jsxs("table",{className:"min-w-full",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),a.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(v=>{var _;return a.jsxs("tr",{children:[a.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:v.name}),a.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:((_=t.find(N=>N.id===v.role))==null?void 0:_.displayName)||v.role.replace(/_/g," ")}),a.jsx("td",{className:"px-6 py-4",children:a.jsxs(Te,{label:"",id:`manager-for-desktop-${v.id}`,value:v.reportingManagerId||"",onChange:N=>g(v.id,N.target.value),className:"w-full",children:[a.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(N=>N.id!==v.id).map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})})]},v.id)})})]})}),a.jsx("div",{className:"space-y-3 md:hidden",children:n.map(v=>{var _;return a.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[a.jsxs("div",{className:"p-3",children:[a.jsx("p",{className:"font-semibold text-primary-text",children:v.name}),a.jsx("p",{className:"text-sm text-muted capitalize",children:((_=t.find(N=>N.id===v.role))==null?void 0:_.displayName)||v.role.replace(/_/g," ")})]}),a.jsxs("div",{className:"p-3 border-t border-border",children:[a.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),a.jsxs(Te,{id:`manager-for-mobile-${v.id}`,value:v.reportingManagerId||"",onChange:N=>g(v.id,N.target.value),children:[a.jsx("option",{value:"",children:"None"}),n.filter(N=>N.id!==v.id).map(N=>a.jsx("option",{value:N.id,children:N.name},N.id))]})]})]},v.id)})})]})]})]})},B_=ei(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await te.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await te.createTask(e);n(s=>({tasks:[t,...s.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const s=await te.updateTask(e,t);n(r=>({tasks:r.tasks.map(i=>i.id===e?s:i)}))}catch(s){throw console.error("Failed to update task",s),new Error("Failed to update task.")}},deleteTask:async e=>{try{await te.deleteTask(e),n(t=>({tasks:t.tasks.filter(s=>s.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await te.runAutomaticEscalations();if(e.length>0&&n(s=>({tasks:s.tasks.map(r=>e.find(i=>i.id===r.id)||r)})),t.length>0){const s=t.map(r=>te.createNotification(r));await Promise.all(s),Ig.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),Zre=Ke({name:ie().required("Task name is required"),description:ie().required("Description is required"),dueDate:ie().required("A due date is required").nullable(),priority:ie().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:ie().required("An assignee is required"),escalationLevel1UserId:ie().optional(),escalationLevel1DurationDays:ss().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:ie().optional(),escalationLevel2DurationDays:ss().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:ie().email("Must be a valid email address").optional(),escalationEmailDurationDays:ss().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),Kre=({isOpen:n,onClose:e,initialData:t,setToast:s})=>{var M,I,O,D,z,H,F,R,V;const{createTask:r,updateTask:i}=B_(),[o,l]=C.useState(!1),[c,d]=C.useState([]),{permissions:h}=pa(),{fetchNotifications:f}=Ig(),{register:p,handleSubmit:g,formState:{errors:b},reset:v,control:_,watch:N}=xt({resolver:Lt(Zre)}),j=!!t,k=N("escalationLevel1UserId"),S=N("escalationLevel2UserId"),P=N("escalationEmail");C.useEffect(()=>{n&&(te.getUsers().then(d),v(t||{name:"",description:"",dueDate:null,priority:"Medium",assignedToId:""}))},[t,v,n]);const E=async U=>{l(!0);try{const W=c.find(q=>q.id===U.assignedToId),B={...U,assignedToName:W==null?void 0:W.name};if(j?(await i(t.id,B),s({message:"Task updated successfully!",type:"success"})):(await r(B),s({message:"Task created successfully.",type:"success"})),W&&W.id!==(t==null?void 0:t.assignedToId)){const le=(h[W.role]||[]).includes("manage_tasks")?"/tasks":"/onboarding/tasks";await te.createNotification({userId:W.id,type:"task_assigned",message:`You have been assigned a new task: "${U.name}"`,linkTo:le}),f()}e()}catch{s({message:"Failed to save task.",type:"error"})}finally{l(!1)}};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-2xl m-4 animate-fade-in-scale overflow-y-auto max-h-[90vh]",onClick:U=>U.stopPropagation(),children:a.jsxs("form",{onSubmit:g(E),children:[a.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:[j?"Edit":"Add"," Task"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(he,{label:"Task Name",id:"name",registration:p("name"),error:(M=b.name)==null?void 0:M.message}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted",children:"Description"}),a.jsx("textarea",{id:"description",rows:3,...p("description"),className:`mt-1 bg-card border ${b.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),b.description&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:b.description.message})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsx(de,{name:"dueDate",control:_,render:({field:U})=>{var W;return a.jsx($t,{label:"Due Date",id:"dueDate",value:U.value,onChange:U.onChange,error:(W=b.dueDate)==null?void 0:W.message,minDate:new Date})}}),a.jsxs(Te,{label:"Priority",id:"priority",registration:p("priority"),error:(I=b.priority)==null?void 0:I.message,children:[a.jsx("option",{children:"Low"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"High"})]})]}),a.jsxs(Te,{label:"Assign To",id:"assignedToId",registration:p("assignedToId"),error:(O=b.assignedToId)==null?void 0:O.message,children:[a.jsx("option",{value:"",children:"Select User"}),c.map(U=>a.jsxs("option",{value:U.id,children:[U.name," (",U.role.replace(/_/g," "),")"]},U.id))]}),a.jsxs("div",{className:"pt-4 border-t",children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Escalation Matrix (Optional)"}),a.jsx("p",{className:"text-sm text-muted mb-4",children:"Define who gets notified if this task becomes overdue and set the time gaps for each escalation."}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsxs(Te,{label:"Escalation Level 1",id:"escalationLevel1UserId",registration:p("escalationLevel1UserId"),error:(D=b.escalationLevel1UserId)==null?void 0:D.message,children:[a.jsx("option",{value:"",children:"Select User"}),c.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]}),k&&a.jsx(he,{label:"Days until L1 Escalation",id:"escalationLevel1DurationDays",type:"number",registration:p("escalationLevel1DurationDays"),error:(z=b.escalationLevel1DurationDays)==null?void 0:z.message}),a.jsxs(Te,{label:"Escalation Level 2",id:"escalationLevel2UserId",registration:p("escalationLevel2UserId"),error:(H=b.escalationLevel2UserId)==null?void 0:H.message,children:[a.jsx("option",{value:"",children:"Select User"}),c.map(U=>a.jsx("option",{value:U.id,children:U.name},U.id))]}),S&&a.jsx(he,{label:"Days until L2 Escalation",id:"escalationLevel2DurationDays",type:"number",registration:p("escalationLevel2DurationDays"),error:(F=b.escalationLevel2DurationDays)==null?void 0:F.message})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 mt-4",children:[a.jsx(he,{label:"Final Escalation Email",id:"escalationEmail",type:"email",registration:p("escalationEmail"),error:(R=b.escalationEmail)==null?void 0:R.message}),P&&a.jsx(he,{label:"Days until Final Escalation",id:"escalationEmailDurationDays",type:"number",registration:p("escalationEmailDurationDays"),error:(V=b.escalationEmailDurationDays)==null?void 0:V.message})]})]})]}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",isLoading:o,children:j?"Save Changes":"Create Task"})]})]})})}):null},Jre=Ke({completionNotes:ie().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:ot().required("A photo proof of completion is required.").nullable()}).defined(),Qre=({isOpen:n,onClose:e,task:t,setToast:s})=>{const{updateTask:r}=B_(),[i,o]=Fe.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:h}=xt({resolver:Lt(Jre),defaultValues:{completionNotes:"",completionPhoto:null}}),f=async p=>{o(!0);try{await r(t.id,{...p,status:"Done"}),s({message:"Task completed successfully!",type:"success"}),e()}catch{s({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:p=>p.stopPropagation(),children:a.jsxs("form",{onSubmit:l(f),children:[a.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),a.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),a.jsx("textarea",{id:"completionNotes",rows:4,...h.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),a.jsx(de,{name:"completionPhoto",control:h,render:({field:p})=>a.jsx(qe,{label:"Upload Photo Proof",file:p.value,onFileChange:p.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",isLoading:i,children:"Mark as Done"})]})]})})}):null},Xre=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?Ce(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let s=null;const r=t(n.dueDate);switch(n.escalationStatus){case"None":s=n.escalationLevel1DurationDays?is(r,n.escalationLevel1DurationDays):r;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=is(r,n.escalationLevel1DurationDays);s=is(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=is(r,n.escalationLevel1DurationDays),l=is(o,n.escalationLevel2DurationDays);s=is(l,n.escalationEmailDurationDays)}break}s||(s=r);const i=s?s<e:!1;return{date:Ce(s,"dd MMM, yyyy"),isOverdue:i}},eie=()=>{const{user:n}=tt(),{tasks:e,isLoading:t,error:s,fetchTasks:r,deleteTask:i,runAutomaticEscalations:o}=B_(),{theme:l}=Eh(),[c,d]=C.useState(!1),[h,f]=C.useState(!1),[p,g]=C.useState(!1),[b,v]=C.useState(null),[_,N]=C.useState(null),[j,k]=C.useState([]),[S,P]=C.useState("all"),[E,M]=C.useState("all"),[I,O]=C.useState("all"),D=Nt("(max-width: 767px)");C.useEffect(()=>{(async()=>{te.getUsers().then(k),await r(),await o()})()},[r,o]);const z=()=>{v(null),d(!0)},H=X=>{v(X),d(!0)},F=X=>{v(X),f(!0)},R=X=>{v(X),g(!0)},V=async()=>{if(b)try{await i(b.id),N({message:"Task deleted.",type:"success"}),g(!1)}catch{N({message:"Failed to delete task.",type:"error"})}},U=C.useMemo(()=>e.filter(X=>{if(S!=="all"&&X.status!==S||E!=="all"&&X.priority!==E)return!1;if(I==="unassigned"){if(X.assignedToId)return!1}else if(I!=="all"&&X.assignedToId!==I)return!1;return!0}),[e,S,E,I]),W=()=>{P("all"),M("all"),O("all")},B=S!=="all"||E!=="all"||I!=="all",q=X=>{const Z=l==="dark",se={High:Z?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:Z?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:Z?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return a.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${se[X]}`,children:X})},Q=X=>{const Z=l==="dark",se={"To Do":Z?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":Z?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:Z?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return a.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${se[X]}`,children:X})},le=X=>{if(X==="None")return null;const Z=l==="dark",se={None:"","Level 1":Z?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":Z?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":Z?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return a.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${se[X]}`,children:X})};return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[_&&a.jsx(gt,{message:_.message,type:_.type,onDismiss:()=>N(null)}),c&&a.jsx(Kre,{isOpen:c,onClose:()=>d(!1),initialData:b,setToast:N}),h&&b&&a.jsx(Qre,{isOpen:h,onClose:()=>f(!1),task:b,setToast:N}),a.jsxs(yn,{isOpen:p,onClose:()=>g(!1),onConfirm:V,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',b==null?void 0:b.name,'"?']}),a.jsx(ur,{title:"Task Management"}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[a.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsxs(Te,{label:"Filter by Status",id:"status-filter",value:S,onChange:X=>P(X.target.value),children:[a.jsx("option",{value:"all",children:"All Statuses"}),a.jsx("option",{value:"To Do",children:"To Do"}),a.jsx("option",{value:"In Progress",children:"In Progress"}),a.jsx("option",{value:"Done",children:"Done"})]}),a.jsxs(Te,{label:"Filter by Priority",id:"priority-filter",value:E,onChange:X=>M(X.target.value),children:[a.jsx("option",{value:"all",children:"All Priorities"}),a.jsx("option",{value:"Low",children:"Low"}),a.jsx("option",{value:"Medium",children:"Medium"}),a.jsx("option",{value:"High",children:"High"})]}),a.jsxs(Te,{label:"Filter by Assignee",id:"assignee-filter",value:I,onChange:X=>O(X.target.value),children:[a.jsx("option",{value:"all",children:"All Users"}),a.jsx("option",{value:"unassigned",children:"Unassigned"}),j.map(X=>a.jsx("option",{value:X.id,children:X.name},X.id))]})]}),a.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[B&&a.jsxs(Y,{variant:"secondary",onClick:W,children:[a.jsx(Us,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),a.jsxs(Y,{onClick:z,children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Task"]})]})]}),s&&a.jsx("p",{className:"text-red-500 mb-4",children:s}),a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Task Name"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Priority"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Next Due Date"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Assigned To"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Escalation"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:t?D?a.jsx("tr",{children:a.jsx("td",{colSpan:7,children:a.jsx(Pi,{rows:3,cols:7,isMobile:!0})})}):a.jsx(Pi,{rows:5,cols:7}):U.map(X=>{const{date:Z,isOverdue:se}=Xre(X);return a.jsxs("tr",{className:se?"bg-red-50":"",children:[a.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",children:X.name}),a.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:q(X.priority)}),a.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${se?"font-bold text-red-600":"text-muted"}`,children:Z||"-"}),a.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm text-muted",children:X.assignedToName||"-"}),a.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm text-muted",children:Q(X.status)}),a.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm text-muted",children:le(X.escalationStatus)}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:a.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>H(X),title:"Edit Task",children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>R(X),title:"Delete Task",children:a.jsx(kt,{className:"h-4 w-4 text-red-600"})}),X.assignedToId===(n==null?void 0:n.id)&&X.status!=="Done"&&a.jsxs(Y,{variant:"outline",size:"sm",onClick:()=>F(X),children:[a.jsx(Kr,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},X.id)})})]}),!t&&U.length===0&&a.jsxs("div",{className:"text-center py-10 text-muted",children:[a.jsx("p",{children:"No tasks found matching your criteria."}),B&&a.jsx(Y,{variant:"secondary",size:"sm",className:"mt-2",onClick:W,children:"Clear filters"})]})]})]})},tie=Ke({id:ie().required(),name:ie().required("Client name is required"),organizationId:ie().optional(),location:ie().optional(),registeredAddress:ie().optional(),registrationType:ie().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:ie().optional(),gstNumber:ie().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:ie().transform(n=>(n==null?void 0:n.toUpperCase())||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:ie().email("Invalid email format").optional(),eShramNumber:ie().optional(),shopAndEstablishmentCode:ie().optional(),epfoCode:ie().optional(),esicCode:ie().optional(),psaraLicenseNumber:ie().optional(),psaraValidTill:ie().optional().nullable(),insuranceIds:xs().of(ie().required()).optional(),policyIds:xs().of(ie().required()).optional()}).defined(),nie=({isOpen:n,onClose:e,onSave:t,initialData:s,companyName:r})=>{var P,E,M,I,O,D,z,H,F,R,V,U,W;const[i,o]=C.useState("General"),[l,c]=C.useState([]),[d,h]=C.useState([]),[f,p]=C.useState(!0),{register:g,handleSubmit:b,formState:{errors:v},reset:_,control:N}=xt({resolver:Lt(tie)}),j=!!s;C.useEffect(()=>{n&&(p(!0),Promise.all([te.getPolicies(),te.getInsurances()]).then(([B,q])=>{c(B),h(q),p(!1)}),_(s||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[s,_,n]);const k=B=>{t(B)};if(!n)return null;const S=({tabName:B})=>a.jsx("button",{type:"button",onClick:()=>o(B),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${i===B?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:B});return a.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:B=>B.stopPropagation(),children:a.jsxs("form",{onSubmit:b(k),children:[a.jsxs("div",{className:"mb-4",children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:j?"Edit Client":"Add New Client"}),a.jsxs("p",{className:"text-sm text-muted",children:["for ",r]})]}),a.jsx("div",{className:"border-b border-border mb-6",children:a.jsxs("nav",{className:"-mb-px flex space-x-4",children:[a.jsx(S,{tabName:"General"}),a.jsx(S,{tabName:"Registration"}),a.jsx(S,{tabName:"Compliance"}),a.jsx(S,{tabName:"Policies & Insurance"})]})}),a.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[i==="General"&&a.jsxs("div",{className:"space-y-4",children:[a.jsx(he,{label:"Client Name (as per document)",id:"name",registration:g("name"),error:(P=v.name)==null?void 0:P.message}),a.jsx(he,{label:"Location / City",id:"location",registration:g("location"),error:(E=v.location)==null?void 0:E.message}),a.jsx(he,{label:"Registered Address",id:"registeredAddress",registration:g("registeredAddress"),error:(M=v.registeredAddress)==null?void 0:M.message})]}),i==="Registration"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[a.jsxs(Te,{label:"Registration Type",id:"registrationType",registration:g("registrationType"),error:(I=v.registrationType)==null?void 0:I.message,children:[a.jsx("option",{value:"",children:"Select Type"}),a.jsx("option",{value:"CIN",children:"CIN"}),a.jsx("option",{value:"ROC",children:"ROC"}),a.jsx("option",{value:"ROF",children:"ROF"}),a.jsx("option",{value:"Society",children:"Society"}),a.jsx("option",{value:"Trust",children:"Trust"})]}),a.jsx(he,{label:"Registration Number",id:"registrationNumber",registration:g("registrationNumber"),error:(O=v.registrationNumber)==null?void 0:O.message}),a.jsx(he,{label:"GST Number",id:"gstNumber",registration:g("gstNumber"),error:(D=v.gstNumber)==null?void 0:D.message}),a.jsx(he,{label:"PAN Number",id:"panNumber",registration:g("panNumber"),error:(z=v.panNumber)==null?void 0:z.message}),a.jsx(he,{label:"Email Address",id:"email",type:"email",registration:g("email"),error:(H=v.email)==null?void 0:H.message})]}),i==="Compliance"&&a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[a.jsx(he,{label:"E-Shram Number",id:"eShramNumber",registration:g("eShramNumber"),error:(F=v.eShramNumber)==null?void 0:F.message}),a.jsx(he,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:g("shopAndEstablishmentCode"),error:(R=v.shopAndEstablishmentCode)==null?void 0:R.message}),a.jsx(he,{label:"EPFO Code",id:"epfoCode",registration:g("epfoCode"),error:(V=v.epfoCode)==null?void 0:V.message}),a.jsx(he,{label:"ESIC Code",id:"esicCode",registration:g("esicCode"),error:(U=v.esicCode)==null?void 0:U.message}),a.jsx(he,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:g("psaraLicenseNumber"),error:(W=v.psaraLicenseNumber)==null?void 0:W.message}),a.jsx(de,{name:"psaraValidTill",control:N,render:({field:B})=>{var q;return a.jsx($t,{label:"PSARA Valid Till",id:"psaraValidTill",value:B.value,onChange:B.onChange,error:(q=v.psaraValidTill)==null?void 0:q.message})}})]}),i==="Policies & Insurance"&&(f?a.jsx(Qe,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsx(de,{name:"policyIds",control:N,render:({field:B})=>a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(q=>{var Q;return a.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:(Q=B.value)==null?void 0:Q.includes(q.id),onChange:le=>{const X=le.target.checked?[...B.value||[],q.id]:(B.value||[]).filter(Z=>Z!==q.id);B.onChange(X)}}),a.jsx("span",{className:"ml-3 text-sm",children:q.name})]},q.id)})})]})}),a.jsx(de,{name:"insuranceIds",control:N,render:({field:B})=>a.jsxs("div",{children:[a.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),a.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(q=>{var Q;return a.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:(Q=B.value)==null?void 0:Q.includes(q.id),onChange:le=>{const X=le.target.checked?[...B.value||[],q.id]:(B.value||[]).filter(Z=>Z!==q.id);B.onChange(X)}}),a.jsxs("span",{className:"ml-3 text-sm",children:[q.type," - ",q.provider]})]},q.id)})})]})})]}))]}),a.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",children:j?"Save Changes":"Add Client"})]})]})})})},rm=({number:n,title:e,children:t})=>a.jsxs("div",{children:[a.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),a.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),sie=({isOpen:n,onClose:e})=>n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[a.jsx(Bs,{className:"h-6 w-6 text-accent"}),a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),a.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[a.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx(Jr,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),a.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),a.jsxs(rm,{number:1,title:"Get the Template",children:[a.jsx("p",{children:"You have two options for getting a file to work with:"}),a.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[a.jsxs("li",{children:[a.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[a.jsx(Bs,{className:"h-4 w-4"})," Download Template:"]}),a.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),a.jsxs("li",{children:[a.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[a.jsx(LD,{className:"h-4 w-4"})," Export Data:"]}),a.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),a.jsx(rm,{number:2,title:"Edit Your Data",children:a.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[a.jsxs("li",{children:[a.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[a.jsx(Jn,{className:"h-4 w-4"})," To Update Existing Data:"]}),a.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),a.jsxs("li",{children:[a.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[a.jsx(ct,{className:"h-4 w-4"})," To Add New Data:"]}),a.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),a.jsxs("li",{children:[a.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),a.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),a.jsx(rm,{number:3,title:"Save and Import",children:a.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[a.jsxs("li",{children:[a.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),a.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),a.jsxs("li",{children:[a.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[a.jsx(mZ,{className:"h-4 w-4"})," Import:"]}),a.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),a.jsx(rm,{number:4,title:"Review Feedback",children:a.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[a.jsxs("li",{children:[a.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[a.jsx(Kr,{className:"h-4 w-4"})," Success:"]}),a.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),a.jsxs("li",{children:[a.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[a.jsx(Jr,{className:"h-4 w-4"})," Error:"]}),a.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),a.jsx("div",{className:"p-4 border-t flex justify-end",children:a.jsx(Y,{onClick:e,children:"Close"})})]})}):null,So=({title:n})=>a.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),a.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),yT=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],rie=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(s=>e.map(r=>{const i=String(s[r]??"");return i.includes(",")||i.includes('"')||i.includes(`
`)?`"${i.replace(/"/g,'""')}"`:i}).join(","))].join(`
`)},iie=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(r=>r.trim()),s=[];for(let r=1;r<e.length;r++){const i={},o=e[r].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),i[l]=d}),s.push(i)}return s},aie=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(!1),[o,l]=C.useState({}),[c,d]=C.useState(null),h=C.useRef(null),{register:f,control:p,handleSubmit:g,watch:b,setValue:v}=xt({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:_,append:N,remove:j,replace:k}=vs({control:p,name:"resources"});C.useEffect(()=>{te.getOrganizations().then(e).finally(()=>s(!1))},[]);const S=async V=>{if(!V){k([]);return}i(!0);try{const U=await te.getManpowerDetails(V),W=U.filter(B=>B.count>0).map(B=>({id:`res_${B.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:V,designation:B.designation,quantity:B.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[V]){const B=U.map(q=>q.designation);l(q=>({...q,[V]:B}))}k(W)}catch(U){console.error("Failed to load manpower",U),d({message:"Failed to load manpower details.",type:"error"})}finally{i(!1)}},P=async(V,U)=>{if(v(`resources.${U}.designation`,""),V&&!o[V])try{const B=(await te.getManpowerDetails(V)).map(q=>q.designation);l(q=>({...q,[V]:B}))}catch(W){console.error(`Failed to load designations for site ${V}`,W)}},E=b("resources"),M=b("serviceChargePercentage"),I=()=>{N({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:O,serviceCharge:D,grandTotal:z}=Fe.useMemo(()=>{const U=(Array.isArray(E)?E:[]).reduce((Q,le)=>{const X=Number(le.quantity)||0,Z=Number(le.billingRate)||0;return Q+X*Z},0),W=Number(M)||0,B=U*(W/100),q=U+B;return{subTotal:U,serviceCharge:B,grandTotal:q}},[E,M]),H=()=>{const V=[Object.fromEntries(yT.map(q=>[q,""]))],U=rie(V),W=new Blob([U],{type:"text/csv;charset=utf-8;"}),B=document.createElement("a");B.href=URL.createObjectURL(W),B.setAttribute("download","costing_resource_template.csv"),document.body.appendChild(B),B.click(),document.body.removeChild(B)},F=V=>{var B;const U=(B=V.target.files)==null?void 0:B[0];if(!U)return;const W=new FileReader;W.onload=async q=>{var Q,le;try{const X=(Q=q.target)==null?void 0:Q.result;if(!X)throw new Error("File is empty.");const Z=iie(X);if(Z.length===0)throw new Error("No data rows found in CSV.");const se=Object.keys(Z[0]);if(!yT.every(ae=>se.includes(ae)))throw new Error("CSV file is missing required headers.");const ne=new Map(n.map(ae=>[ae.shortName.toLowerCase(),ae.id])),ge=new Set;for(const ae of Z){const ve=(le=ae["Site Name"])==null?void 0:le.trim().toLowerCase();if(ve){const pe=ne.get(ve);typeof pe=="string"&&ge.add(pe)}}const ye=[...ge].filter(ae=>!o[ae]);if(ye.length>0){const ae=ye.map(pe=>te.getManpowerDetails(pe).then(Ne=>({siteId:pe,designations:Ne.map(Me=>Me.designation)}))),ve=await Promise.all(ae);l(pe=>{const Ne={...pe};return ve.forEach(Me=>{Ne[Me.siteId]=Me.designations}),Ne})}const re=Z.map(ae=>{var Ne;const ve=(Ne=ae["Site Name"])==null?void 0:Ne.trim().toLowerCase(),pe=ve?ne.get(ve):void 0;return pe?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:pe,designation:ae.Designation||"",quantity:parseFloat(ae.Quantity)||0,billingRate:parseFloat(ae["Billing Rate"])||0,billingModel:ae["Billing Model"]||"Per Month",holidayBillingPolicy:ae["Holiday Billing Policy"]||"",holidayPaymentPolicy:ae["Holiday Payment Policy"]||"",uniformDeduction:ae["Uniform Deduction"]||"Yes"}:null}).filter(ae=>ae!==null);k(re),d({message:`Successfully imported ${re.length} resources.`,type:"success"})}catch(X){d({message:X.message||"Failed to import CSV.",type:"error"})}finally{V.target&&(V.target.value="")}},W.readAsText(U)},R=V=>{console.log("Saving Costing & Resource Data:",V),d({message:"Configuration saved successfully (mocked).",type:"success"})};return a.jsxs("form",{onSubmit:g(R),className:"space-y-6",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),a.jsx("input",{type:"file",ref:h,className:"hidden",accept:".csv",onChange:F}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),a.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[a.jsxs(Te,{label:"Load Manpower from Site",id:"site-selector",onChange:V=>S(V.target.value),disabled:t||r,children:[a.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(V=>a.jsx("option",{value:V.id,children:V.shortName},V.id))]}),r&&a.jsx(Qe,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),a.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:H,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[a.jsx(or,{className:"h-5 w-5 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Template"})]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var V;return(V=h.current)==null?void 0:V.click()},className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[a.jsx(ao,{className:"h-5 w-5 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Import"})]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:I,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[a.jsx(ct,{className:"h-5 w-5 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),a.jsxs(Y,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[a.jsx(cs,{className:"h-5 w-5 md:mr-2"}),a.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),a.jsx("div",{className:"space-y-4",children:_.map((V,U)=>{const W=b(`resources.${U}.siteId`);return a.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>j(U),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[a.jsx(de,{control:p,name:`resources.${U}.siteId`,render:({field:B})=>a.jsxs(Te,{label:"Site",id:`res-site-${U}`,...B,onChange:q=>{B.onChange(q),P(q.target.value,U)},children:[a.jsx("option",{value:"",children:"Select Site"}),n.map(q=>a.jsx("option",{value:q.id,children:q.shortName},q.id))]})}),a.jsxs(Te,{label:"Designation",id:`res-desig-${U}`,...f(`resources.${U}.designation`),disabled:!W,children:[a.jsx("option",{value:"",children:"Select Designation"}),(o[W]||[]).map(B=>a.jsx("option",{value:B,children:B},B))]}),a.jsx(he,{label:"Quantity",id:`res-qty-${U}`,type:"number",step:"0.01",...f(`resources.${U}.quantity`)}),a.jsx(he,{label:"Billing Rate",id:`res-rate-${U}`,type:"number",step:"0.01",...f(`resources.${U}.billingRate`)}),a.jsxs(Te,{label:"Billing Model",id:`res-billing-${U}`,...f(`resources.${U}.billingModel`),children:[a.jsx("option",{children:"Per Month"}),a.jsx("option",{children:"Per Day"}),a.jsx("option",{children:"Per Hour"}),a.jsx("option",{children:"Lumpsum"})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[a.jsxs("div",{children:[a.jsx("label",{htmlFor:`res-hol-bill-${U}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),a.jsx("textarea",{id:`res-hol-bill-${U}`,...f(`resources.${U}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),a.jsxs("div",{children:[a.jsx("label",{htmlFor:`res-hol-pay-${U}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),a.jsx("textarea",{id:`res-hol-pay-${U}`,...f(`resources.${U}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),a.jsxs(Te,{label:"Uniform Deduction",id:`res-uniform-${U}`,...f(`resources.${U}.uniformDeduction`),children:[a.jsx("option",{children:"Yes"}),a.jsx("option",{children:"No"})]})]})]},V.id)})}),_.length>0&&a.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:a.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),a.jsx("span",{className:"font-semibold text-primary-text",children:O.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),a.jsxs("div",{className:"flex justify-between items-center text-sm",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),a.jsx("div",{className:"w-20",children:a.jsx(he,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...f("serviceChargePercentage")})}),a.jsx("span",{className:"text-muted font-medium",children:"%"})]}),a.jsx("span",{className:"font-semibold text-primary-text",children:D.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),a.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[a.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),a.jsx("span",{className:"font-bold text-lg",children:z.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),_.length===0&&a.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?a.jsx(Qe,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},JI=["Department","Designation","PermanentId","TemporaryId"],oie=n=>{const e=JI.join(","),t=n.map(s=>[s.department,s.designation,s.permanentId,s.temporaryId].map(r=>{const i=String(r??"");return i.includes(",")?`"${i}"`:i}).join(","));return[e,...t].join(`
`)},lie=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(r=>r.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(r=>t.includes(r)))throw new Error("CSV is missing required headers.");return e.slice(1).map(r=>{const i=r.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=i[c]),l==="Designation"&&(o.designation=i[c]),l==="PermanentId"&&(o.permanentId=i[c]),l==="TemporaryId"&&(o.temporaryId=i[c])}),o})},cie=()=>{const[n,e]=C.useState(!0),[t,s]=C.useState(null),r=C.useRef(null),{register:i,control:o,handleSubmit:l,reset:c,watch:d}=xt({defaultValues:{series:[]}}),{append:h,remove:f,replace:p}=vs({control:o,name:"series"});C.useEffect(()=>{e(!0),te.getBackOfficeIdSeries().then(S=>c({series:S})).catch(()=>s({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const g=d("series"),b=C.useMemo(()=>Array.isArray(g)?g.reduce((S,P,E)=>{const M=P.department||"Uncategorized";return S[M]||(S[M]=[]),S[M].push({...P,originalIndex:E}),S},{}):{},[g]),v=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},_=async S=>{try{await te.updateBackOfficeIdSeries(S.series),s({message:"Configuration saved successfully.",type:"success"})}catch{s({message:"Failed to save configuration.",type:"error"})}},N=()=>{if(!Array.isArray(g)||g.length===0){s({message:"No data to export.",type:"error"});return}const S=oie(g),P=new Blob([S],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},j=()=>{const S=JI.join(","),P=new Blob([S],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","id_series_template.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},k=S=>{var M;const P=(M=S.target.files)==null?void 0:M[0];if(!P)return;const E=new FileReader;E.onload=I=>{var O;try{const D=(O=I.target)==null?void 0:O.result,H=lie(D).map(F=>({id:`imported_${Date.now()}_${Math.random()}`,department:F.department||"",designation:F.designation||"",permanentId:F.permanentId||"",temporaryId:F.temporaryId||""}));p(H),s({message:`Imported ${H.length} records.`,type:"success"})}catch(D){s({message:D.message||"Failed to import CSV.",type:"error"})}finally{S.target&&(S.target.value="")}},E.readAsText(P)};return a.jsxs("form",{onSubmit:l(_),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&a.jsx(gt,{message:t.message,type:t.type,onDismiss:()=>s(null)}),a.jsx("input",{type:"file",ref:r,className:"hidden",accept:".csv",onChange:k}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:j,children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Template"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var S;return(S=r.current)==null?void 0:S.click()},children:[a.jsx(ao,{className:"mr-2 h-4 w-4"})," Import"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:N,children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export"]}),a.jsxs(Y,{type:"submit",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),a.jsx("div",{className:"space-y-6",children:n?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(b).length===0?a.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(b).map(([S,P])=>a.jsxs("div",{className:"border border-border rounded-xl",children:[a.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:a.jsx(he,{"aria-label":`Department for ${S}`,id:`series.${P[0].originalIndex}.department`,...i(`series.${P[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),a.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(P)&&P.map(E=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Designation","aria-label":`Designation for ${S}`,id:`series.${E.originalIndex}.designation`,...i(`series.${E.originalIndex}.designation`)})}),a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${E.designation}`,id:`series.${E.originalIndex}.permanentId`,...i(`series.${E.originalIndex}.permanentId`)})}),a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${E.designation}`,id:`series.${E.originalIndex}.temporaryId`,...i(`series.${E.originalIndex}.temporaryId`)})}),a.jsx("div",{className:"md:col-span-1 text-right",children:a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>f(E.originalIndex),"aria-label":`Remove ${E.designation}`,title:`Remove ${E.designation}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})})]},E.id))})]},S))}),a.jsxs(Y,{type:"button",onClick:v,variant:"outline",className:"mt-6",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Kp=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],die=n=>{const e=Kp.join(","),t=n.map(s=>[s.department,s.designation,s.permanentId,s.temporaryId,s.monthlySalary].map(r=>{const i=String(r??"");return i.includes(",")||i.includes('"')||i.includes(`
`)?`"${i.replace(/"/g,'""')}"`:i}).join(","));return[e,...t].join(`
`)},uie=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(r=>r.trim().replace(/"/g,""));if(!Kp.every(r=>t.includes(r)))throw new Error(`CSV is missing required headers: ${Kp.join(", ")}`);const s=[];for(let r=1;r<e.length;r++){const i={},o=e[r].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let h=(o[d]||"").trim();h.startsWith('"')&&h.endsWith('"')&&(h=h.substring(1,h.length-1).replace(/""/g,'""')),i[c]=h});const l=parseFloat(i.MonthlySalary);s.push({department:i.Department,designation:i.Designation,permanentId:i.PermanentId,temporaryId:i.TemporaryId,monthlySalary:isNaN(l)?null:l})}return s},hie=()=>{const[n,e]=C.useState(!0),[t,s]=C.useState(null),r=C.useRef(null),{register:i,control:o,handleSubmit:l,reset:c,watch:d}=xt({defaultValues:{designations:[]}}),{append:h,remove:f,replace:p}=vs({control:o,name:"designations"});C.useEffect(()=>{e(!0),te.getSiteStaffDesignations().then(S=>c({designations:S})).catch(()=>s({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const g=d("designations"),b=C.useMemo(()=>Array.isArray(g)?g.reduce((S,P,E)=>{const M=P.department||"Uncategorized";return S[M]||(S[M]=[]),S[M].push({...P,originalIndex:E}),S},{}):{},[g]),v=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},_=async S=>{try{await te.updateSiteStaffDesignations(S.designations),s({message:"Configuration saved successfully.",type:"success"})}catch{s({message:"Failed to save configuration.",type:"error"})}},N=()=>{if(!Array.isArray(g)||g.length===0){s({message:"No data to export.",type:"error"});return}const S=die(g),P=new Blob([S],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},j=()=>{const S=Kp.join(","),P=new Blob([S],{type:"text/csv;charset=utf-8;"}),E=document.createElement("a");E.href=URL.createObjectURL(P),E.setAttribute("download","site_staff_template.csv"),document.body.appendChild(E),E.click(),document.body.removeChild(E)},k=S=>{var M;const P=(M=S.target.files)==null?void 0:M[0];if(!P)return;const E=new FileReader;E.onload=I=>{var O;try{const D=(O=I.target)==null?void 0:O.result,H=uie(D).map(F=>({id:`imported_${Date.now()}_${Math.random()}`,department:F.department||"",designation:F.designation||"",permanentId:F.permanentId||"",temporaryId:F.temporaryId||"",monthlySalary:F.monthlySalary||null}));p(H),s({message:`Imported ${H.length} records.`,type:"success"})}catch(D){s({message:D.message||"Failed to import CSV.",type:"error"})}finally{S.target&&(S.target.value="")}},E.readAsText(P)};return a.jsxs("form",{onSubmit:l(_),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&a.jsx(gt,{message:t.message,type:t.type,onDismiss:()=>s(null)}),a.jsx("input",{type:"file",ref:r,className:"hidden",accept:".csv",onChange:k}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:j,children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Template"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var S;return(S=r.current)==null?void 0:S.click()},children:[a.jsx(ao,{className:"mr-2 h-4 w-4"})," Import"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:N,children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export"]}),a.jsxs(Y,{type:"submit",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),a.jsx("div",{className:"space-y-6",children:n?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(b).length===0?a.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(b).map(([S,P])=>a.jsxs("div",{className:"border border-border rounded-xl",children:[a.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:a.jsx(he,{"aria-label":`Department for ${S}`,id:`designations.${P[0].originalIndex}.department`,...i(`designations.${P[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),a.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(P)&&P.map(E=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Designation","aria-label":`Designation for ${S}`,id:`designations.${E.originalIndex}.designation`,...i(`designations.${E.originalIndex}.designation`)})}),a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${E.designation}`,id:`designations.${E.originalIndex}.permanentId`,...i(`designations.${E.originalIndex}.permanentId`)})}),a.jsx("div",{className:"md:col-span-2",children:a.jsx(he,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${E.designation}`,id:`designations.${E.originalIndex}.temporaryId`,...i(`designations.${E.originalIndex}.temporaryId`)})}),a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${E.designation}`,id:`designations.${E.originalIndex}.monthlySalary`,type:"number",...i(`designations.${E.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),a.jsx("div",{className:"md:col-span-1 text-right",children:a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>f(E.originalIndex),"aria-label":`Remove ${E.designation}`,title:`Remove ${E.designation}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})})]},E.id))})]},S))}),a.jsxs(Y,{type:"button",onClick:v,variant:"outline",className:"mt-4",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},fie=({id:n,label:e,checked:t,onChange:s,description:r,disabled:i})=>a.jsxs("div",{className:"flex items-center justify-between",children:[a.jsxs("span",{className:"flex-grow flex flex-col",children:[a.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),r&&a.jsx("span",{className:"text-sm text-muted",children:r})]}),a.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[a.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>s(o.target.checked),disabled:i}),a.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),h0=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],mie={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},pie=n=>{const e=h0.join(","),t=h0.map(s=>{const r=s.charAt(0).toLowerCase()+s.slice(1);let i=n[r];return typeof i=="string"&&(i.includes(",")||i.includes(`
`)||i.includes('"'))?`"${i.replace(/"/g,'""')}"`:i});return[e,t.join(",")].join(`
`)},gie=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(i=>i.trim()),s=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],r={};return t.forEach((i,o)=>{const l=i.charAt(0).toLowerCase()+i.slice(1);let c=(s[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?r[l]=c:typeof mie[l]=="boolean"?r[l]=c.toLowerCase()==="true":r[l]=c}),r},im=({label:n,...e})=>a.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[a.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),yie=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=ir(),[t,s]=C.useState(null),r=C.useRef(null),{register:i,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:h}}=xt({defaultValues:n});C.useEffect(()=>{d(n)},[n,d]);const f=c("requireAlternateInsurance"),p=c("applicability")==="Mandatory",g=N=>{e(N),s({message:"GMC policy settings saved.",type:"success"})},b=()=>{const N=pie(n),j=new Blob([N],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a");k.href=URL.createObjectURL(j),k.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(k),k.click(),document.body.removeChild(k)},v=()=>{const N=h0.join(","),j=new Blob([N],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a");k.href=URL.createObjectURL(j),k.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(k),k.click(),document.body.removeChild(k)},_=N=>{var S;const j=(S=N.target.files)==null?void 0:S[0];if(!j)return;const k=new FileReader;k.onload=P=>{var E;try{const M=(E=P.target)==null?void 0:E.result,I=gie(M);d(I),s({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(M){s({message:M.message||"Failed to import CSV.",type:"error"})}finally{N.target&&(N.target.value="")}},k.readAsText(j)};return a.jsxs("form",{onSubmit:o(g),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&a.jsx(gt,{message:t.message,type:t.type,onDismiss:()=>s(null)}),a.jsx("input",{type:"file",ref:r,className:"hidden",accept:".csv",onChange:_}),a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:v,children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Template"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var N;return(N=r.current)==null?void 0:N.click()},children:[a.jsx(ao,{className:"mr-2 h-4 w-4"})," Import"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:b,children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export"]}),a.jsxs(Y,{type:"submit",disabled:!h,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("div",{children:a.jsx(de,{name:"applicability",control:l,render:({field:N})=>a.jsxs(Te,{label:"Applicability",...N,children:[a.jsx("option",{children:"Mandatory"}),a.jsx("option",{children:"Optional - Opt-in Default"}),a.jsx("option",{children:"Optional - Opt-out Default"})]})})}),a.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),a.jsx("textarea",{...i("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),a.jsx("textarea",{...i("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!p&&a.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),a.jsx("textarea",{...i("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),a.jsx(de,{name:"requireAlternateInsurance",control:l,render:({field:N})=>a.jsx(fie,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:N.value,onChange:N.onChange})}),f&&a.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[a.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),a.jsx(de,{name:"collectProvider",control:l,render:({field:N})=>a.jsx(im,{label:"Provider Name",checked:N.value,onChange:N.onChange})}),a.jsx(de,{name:"collectStartDate",control:l,render:({field:N})=>a.jsx(im,{label:"Policy Start Date",checked:N.value,onChange:N.onChange})}),a.jsx(de,{name:"collectEndDate",control:l,render:({field:N})=>a.jsx(im,{label:"Policy End Date",checked:N.value,onChange:N.onChange})}),a.jsx(de,{name:"collectExtentOfCover",control:l,render:({field:N})=>a.jsx(im,{label:"Extent of Cover (Sum Assured)",checked:N.value,onChange:N.onChange})})]})]})]})]})},QI=[{key:"Phone",label:"Phone",icon:MZ},{key:"Computer",label:"Computer / Laptop",icon:wZ},{key:"Vehicle",label:"Vehicle",icon:rZ},{key:"Sim",label:"SIM Card",icon:dZ},{key:"IdCard",label:"Identity Card",icon:cZ},{key:"Petrocard",label:"Petrocard",icon:RD},{key:"Tools",label:"Tools",icon:vZ},{key:"Other",label:"Other Asset",icon:Kw}],xie=({assetType:n,...e})=>{switch(n){case"Phone":return a.jsx(vie,{...e});case"Computer":return a.jsx(wie,{...e});case"Vehicle":return a.jsx(Nie,{...e});case"Sim":return a.jsx(bie,{...e});case"IdCard":return a.jsx(_ie,{...e});case"Petrocard":return a.jsx(Sie,{...e});case"Tools":return a.jsx(jie,{...e});case"Other":return a.jsx(Cie,{...e});default:return null}},vie=({index:n,control:e})=>a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[a.jsx(de,{name:`assets.${n}.brand`,control:e,render:({field:t})=>a.jsx(he,{label:"Brand",...t})}),a.jsx(de,{name:`assets.${n}.imei`,control:e,render:({field:t})=>a.jsx(he,{label:"IMEI Number",...t})}),a.jsx(de,{name:`assets.${n}.color`,control:e,render:({field:t})=>a.jsx(he,{label:"Colour",...t})}),a.jsx(de,{name:`assets.${n}.condition`,control:e,render:({field:t})=>a.jsxs(Te,{label:"New / Used",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"})]})}),a.jsx(de,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Charger",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Charger"}),a.jsx("option",{children:"Without Charger"})]})}),a.jsx(de,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Display Condition",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Damages"}),a.jsx("option",{children:"Without Damages"})]})}),a.jsx(de,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Body Condition",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Damages"}),a.jsx("option",{children:"Without Damages"})]})}),a.jsx(de,{name:`assets.${n}.picture`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),bie=({index:n,control:e})=>a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:a.jsx(de,{name:`assets.${n}.number`,control:e,render:({field:t})=>a.jsx(he,{label:"SIM Number",...t})})}),wie=({index:n,control:e})=>a.jsxs("div",{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Type",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Laptop"}),a.jsx("option",{children:"Desktop"}),a.jsx("option",{children:"Tab"})]})}),a.jsx(de,{name:`assets.${n}.brand`,control:e,render:({field:t})=>a.jsx(he,{label:"Brand",...t})}),a.jsx(de,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>a.jsx(he,{label:"Serial Number",...t})}),a.jsx(de,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>a.jsx(he,{label:"Windows Key",...t})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.condition`,control:e,render:({field:t})=>a.jsxs(Te,{label:"New / Used",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"})]})}),a.jsx(de,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Charger",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Charger"}),a.jsx("option",{children:"Without Charger"})]})}),a.jsx(de,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Bag",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Bag"}),a.jsx("option",{children:"Without Bag"})]})}),a.jsx(de,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Mouse",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Mouse"}),a.jsx("option",{children:"Without Mouse"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Display Condition",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Damages"}),a.jsx("option",{children:"Without Damages"})]})}),a.jsx(de,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Body Condition",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Damages"}),a.jsx("option",{children:"Without Damages"})]})}),a.jsx(de,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"MS Office",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Office"}),a.jsx("option",{children:"Without Office"})]})}),a.jsx(de,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Antivirus",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"With Antivirus"}),a.jsx("option",{children:"Without Antivirus"})]})})]}),a.jsx(de,{name:`assets.${n}.picture`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),_ie=({index:n,control:e})=>a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:a.jsx(de,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>a.jsx($t,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),Sie=({index:n,control:e})=>a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:a.jsx(de,{name:`assets.${n}.number`,control:e,render:({field:t})=>a.jsx(he,{label:"Petrocard Number",...t})})}),Nie=({index:n,control:e})=>a.jsxs("div",{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Vehicle Type",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Bicycle"}),a.jsx("option",{children:"Two Wheeler"}),a.jsx("option",{children:"Three Wheeler"}),a.jsx("option",{children:"Four Wheeler"})]})}),a.jsx(de,{name:`assets.${n}.brand`,control:e,render:({field:t})=>a.jsx(he,{label:"Brand",...t})}),a.jsx(de,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>a.jsx(he,{label:"Vehicle Number",...t})}),a.jsx(de,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>a.jsx(he,{label:"Chassis Number",...t})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>a.jsx(he,{label:"DL Number of User",...t})}),a.jsx(de,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>a.jsx(he,{label:"Kms at issue",type:"number",...t})}),a.jsx(de,{name:`assets.${n}.condition`,control:e,render:({field:t})=>a.jsxs(Te,{label:"New / Used",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"})]})}),a.jsx(de,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>a.jsxs(Te,{label:"Violations / Fines",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Existing"}),a.jsx("option",{children:"Nil"})]})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>a.jsx($t,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),a.jsx(de,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>a.jsx($t,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(de,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),a.jsx(de,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),a.jsx(de,{name:`assets.${n}.picture`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),jie=({index:n,control:e})=>{const{fields:t,append:s,remove:r}=vs({control:e,name:`assets.${n}.toolList`});return a.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((i,o)=>a.jsxs("div",{className:"flex items-end gap-2",children:[a.jsx("div",{className:"flex-1",children:a.jsx(de,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>a.jsx(he,{label:"Tool Name",...l})})}),a.jsx("div",{className:"flex-1",children:a.jsx(de,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>a.jsx(he,{label:"Description",...l})})}),a.jsx("div",{children:a.jsx(de,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>a.jsx(he,{label:"Quantity",type:"number",...l})})}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>r(o),children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]},i.id)),a.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:()=>s({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[a.jsx(ct,{className:"mr-1 h-4 w-4"})," Add Tool"]}),a.jsx(de,{name:`assets.${n}.picture`,control:e,render:({field:i})=>a.jsx(qe,{label:"Picture of Tools",file:i.value,onFileChange:i.onChange})})]})},Cie=({index:n,control:e})=>a.jsxs("div",{className:"space-y-4 pt-4",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[a.jsx(de,{name:`assets.${n}.name`,control:e,render:({field:t})=>a.jsx(he,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),a.jsx(de,{name:`assets.${n}.brand`,control:e,render:({field:t})=>a.jsx(he,{label:"Brand",...t})}),a.jsx(de,{name:`assets.${n}.model`,control:e,render:({field:t})=>a.jsx(he,{label:"Model No.",...t})}),a.jsx(de,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>a.jsx(he,{label:"Serial Number",...t})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsx(de,{name:`assets.${n}.condition`,control:e,render:({field:t})=>a.jsxs(Te,{label:"New / Used",...t,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"New"}),a.jsx("option",{children:"Used"})]})}),a.jsx(de,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>a.jsx(he,{label:"Condition at time of issue",...t})})]}),a.jsx("div",{children:a.jsx(de,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>a.jsxs(a.Fragment,{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),a.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),a.jsx(de,{name:`assets.${n}.picture`,control:e,render:({field:t})=>a.jsx(qe,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),kie=({item:n,index:e,control:t,errors:s,remove:r})=>{const[i,o]=C.useState(()=>n.id.startsWith("new_")),l=QI.find(f=>f.key===n.type),c=(l==null?void 0:l.icon)||Kw,h=(f=>"brand"in f&&f.brand?`${f.brand} ${f.type}`:"number"in f&&f.number?`${f.type} - ${f.number}`:"name"in f&&f.name?f.name:"vehicleNumber"in f&&f.vehicleNumber?f.vehicleNumber:(l==null?void 0:l.label)||"Asset")(n);return a.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[a.jsxs("div",{className:"flex items-center p-3",children:[a.jsxs("button",{type:"button",onClick:()=>o(!i),className:"flex items-center gap-3 flex-grow text-left",children:[a.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),a.jsx("span",{className:"font-semibold text-primary-text",children:h})]}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>r(e),children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!i),children:a.jsx(Ml,{className:`h-5 w-5 transform transition-transform ${i?"rotate-180":""}`})})]}),i&&a.jsx("div",{className:"p-4 border-t border-border",children:a.jsx(xie,{assetType:n.type,index:e,control:t,errors:s})})]})},Tie=({site:n,initialAssets:e,onSave:t,onBack:s,setToast:r})=>{const[i,o]=C.useState(!1),[l,c]=C.useState(!1),d=C.useRef(null),{control:h,handleSubmit:f,reset:p,formState:{errors:g}}=xt(),{fields:b,append:v,remove:_}=vs({control:h,name:"assets"});C.useEffect(()=>{p({assets:e})},[e,p]),C.useEffect(()=>{const k=S=>{d.current&&!d.current.contains(S.target)&&c(!1)};return document.addEventListener("mousedown",k),()=>document.removeEventListener("mousedown",k)},[]);const N=k=>{const S={id:`new_${k}_${Date.now()}`,type:k};let P;switch(k){case"Phone":P={...S,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":P={...S,type:"Sim",number:""};break;case"Computer":P={...S,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":P={...S,type:"IdCard",issueDate:""};break;case"Petrocard":P={...S,type:"Petrocard",number:""};break;case"Vehicle":P={...S,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":P={...S,type:"Tools",toolList:[]};break;case"Other":P={...S,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}v(P),c(!1)},j=async k=>{o(!0);try{await t(n.id,k.assets)}catch{}finally{o(!1)}};return a.jsxs("form",{onSubmit:f(j),children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs(Y,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Back to List"]}),a.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs("div",{className:"relative",ref:d,children:[a.jsxs(Y,{type:"button",onClick:()=>c(!l),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&a.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:QI.map(k=>a.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>N(k.key),children:[a.jsx(k.icon,{className:"h-4 w-4 text-muted"}),a.jsx("span",{children:k.label})]},k.key))})]}),a.jsxs(Y,{type:"submit",isLoading:i,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),a.jsx("div",{className:"space-y-4",children:b.length>0?b.map((k,S)=>a.jsx(kie,{item:k,index:S,control:h,errors:g,remove:_},k.id)):a.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},Eie=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:s,onViewDetails:r})=>{const i=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),a.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),a.jsx(he,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>s(o.target.value)})]})]}),a.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),a.jsx("td",{className:"px-4 py-3 text-muted",children:i(e[o.id])}),a.jsx("td",{className:"px-4 py-3",children:a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>r(o.id),title:"View Details",children:a.jsx(ca,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&a.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Pie=()=>{const[n,e]=C.useState("list"),[t,s]=C.useState(null),[r,i]=C.useState([]),[o,l]=C.useState({}),[c,d]=C.useState(!0),[h,f]=C.useState(""),[p,g]=C.useState(null);C.useEffect(()=>{d(!0),Promise.all([te.getOrganizations(),te.getAllSiteAssets()]).then(([N,j])=>{i(N.sort((k,S)=>k.shortName.localeCompare(S.shortName))),l(j)}).catch(()=>g({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const b=async(N,j)=>{try{await te.updateSiteAssets(N,j),l(k=>({...k,[N]:j})),g({message:"Assets saved successfully.",type:"success"})}catch(k){throw g({message:"Failed to save assets.",type:"error"}),k}},v=N=>{s(N),e("detail")},_=C.useMemo(()=>h?r.filter(N=>N.shortName.toLowerCase().includes(h.toLowerCase())):r,[r,h]);return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{children:[p&&a.jsx(gt,{message:p.message,type:p.type,onDismiss:()=>g(null)}),n==="detail"&&t?a.jsx(Tie,{site:r.find(N=>N.id===t),initialAssets:o[t]||[],onSave:b,onBack:()=>e("list"),setToast:g}):a.jsx(Eie,{sites:_,allAssets:o,searchTerm:h,setSearchTerm:f,onViewDetails:v})]})},Mie=({control:n,index:e,remove:t,masterTools:s})=>{const[r,i]=C.useState(!0),o=ll({control:n,name:`tools.${e}.department`}),l=ll({control:n,name:`tools.${e}.name`}),c=o?s[o]||[]:[],d=l||"New Tool",h=o||"Select a department";return a.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[a.jsxs("div",{className:"flex items-center p-3",children:[a.jsxs("button",{type:"button",onClick:()=>i(!r),className:"flex items-center gap-3 flex-grow text-left",children:[a.jsx(JD,{className:"h-5 w-5 text-muted flex-shrink-0"}),a.jsxs("div",{children:[a.jsx("span",{className:"font-semibold text-primary-text",children:d}),a.jsx("p",{className:"text-sm text-muted",children:h})]})]}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>i(!r),children:a.jsx(Ml,{className:`h-5 w-5 transform transition-transform ${r?"rotate-180":""}`})})]}),r&&a.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[a.jsx(de,{name:`tools.${e}.department`,control:n,render:({field:f})=>a.jsxs(Te,{label:"Department",...f,children:[a.jsx("option",{value:"",children:"Select Department"}),Object.keys(s).map(p=>a.jsx("option",{value:p,children:p},p))]})}),a.jsx(de,{name:`tools.${e}.name`,control:n,render:({field:f})=>a.jsxs(Te,{label:"Tool Name",...f,disabled:!o,children:[a.jsx("option",{value:"",children:"Select Tool"}),c.map(p=>a.jsx("option",{value:p.name,children:p.name},p.id))]})}),a.jsx(de,{name:`tools.${e}.quantity`,control:n,render:({field:f})=>a.jsx(he,{label:"Quantity",type:"number",...f})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(de,{name:`tools.${e}.picture`,control:n,render:({field:f})=>a.jsx(qe,{label:"Picture of Tool",file:f.value,onFileChange:f.onChange})}),a.jsx(de,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:f})=>a.jsx(qe,{label:"Inward DC Copy",file:f.value,onFileChange:f.onChange})}),a.jsx(de,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:f})=>a.jsx(qe,{label:"Delivery Copy",file:f.value,onFileChange:f.onChange})})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[a.jsx(de,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:f})=>a.jsx(qe,{label:"Invoice",file:f.value,onFileChange:f.onChange})}),a.jsx(de,{name:`tools.${e}.signedReceipt`,control:n,render:({field:f})=>a.jsx(qe,{label:"Signed Receipt",file:f.value,onFileChange:f.onChange})}),a.jsx(de,{name:`tools.${e}.receiverName`,control:n,render:({field:f})=>a.jsx(he,{label:"Receiver's Name",...f})})]})]})]})},Die=({site:n,initialTools:e,masterTools:t,onSave:s,onBack:r})=>{const[i,o]=C.useState(!1),{control:l,handleSubmit:c,reset:d}=xt(),{fields:h,append:f,remove:p}=vs({control:l,name:"tools"});C.useEffect(()=>{d({tools:e})},[e,d]);const g=()=>{f({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},b=async v=>{o(!0);try{await s(n.id,v.tools)}finally{o(!1)}};return a.jsxs("form",{onSubmit:c(b),children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsxs("div",{children:[a.jsxs(Y,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Back to List"]}),a.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Y,{type:"button",onClick:g,children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Tool"]}),a.jsxs(Y,{type:"submit",isLoading:i,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),a.jsx("div",{className:"space-y-4",children:h.length>0?h.map((v,_)=>a.jsx(Mie,{control:l,index:_,remove:p,masterTools:t},v.id)):a.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},Aie=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:s,onViewDetails:r})=>{const i=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,h)=>d+(h.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return a.jsxs("div",{children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),a.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),a.jsx(he,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>s(o.target.value)})]})]}),a.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>a.jsxs("tr",{children:[a.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),a.jsx("td",{className:"px-4 py-3 text-muted",children:i(e[o.id])}),a.jsx("td",{className:"px-4 py-3",children:a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>r(o.id),title:"View Details",children:a.jsx(ca,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&a.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Iie=()=>{const[n,e]=C.useState(null),[t,s]=C.useState([]),[r,i]=C.useState({}),[o,l]=C.useState({}),[c,d]=C.useState(!0),[h,f]=C.useState(""),[p,g]=C.useState(null);C.useEffect(()=>{d(!0),Promise.all([te.getOrganizations(),te.getAllSiteIssuedTools(),te.getToolsList()]).then(([_,N,j])=>{s(_.sort((k,S)=>k.shortName.localeCompare(S.shortName))),i(N),l(j)}).catch(()=>g({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const b=async(_,N)=>{try{await te.updateSiteIssuedTools(_,N),i(j=>({...j,[_]:N})),g({message:"Tools list saved successfully.",type:"success"})}catch(j){throw g({message:"Failed to save tools list.",type:"error"}),j}},v=C.useMemo(()=>h?t.filter(_=>_.shortName.toLowerCase().includes(h.toLowerCase())):t,[t,h]);return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{children:[p&&a.jsx(gt,{message:p.message,type:p.type,onDismiss:()=>g(null)}),n?a.jsx(Die,{site:t.find(_=>_.id===n),initialTools:r[n]||[],masterTools:o,onSave:b,onBack:()=>e(null)}):a.jsx(Aie,{sites:v,allIssuedTools:r,searchTerm:h,setSearchTerm:f,onViewDetails:e})]})},Oie=()=>a.jsx(So,{title:"Attendance Format"}),Rie=()=>a.jsx(So,{title:"Attendance Overview"}),Lie=()=>a.jsx(So,{title:"Daily Attendance Summary"}),Fie=()=>a.jsx(So,{title:"Notification & Mail Configuration"}),$ie=()=>a.jsx(So,{title:"Onboarding Rejection Reasons"}),zie=()=>a.jsx(So,{title:"Salary Breakup"}),Uie=()=>a.jsx(So,{title:"Salary Line Item"}),xT=(n,e)=>{const t=e.join(","),s=n.map(r=>e.map(i=>{const o=r[i]===null||r[i]===void 0?"":String(r[i]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...s].join(`
`)},vT=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(r=>r.trim().replace(/"/g,"")),s=[];for(let r=1;r<e.length;r++){const i={},o=e[r].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),i[l]=d}),s.push(i)}return s},Yx=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],Zx=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],bT=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(t),s.setAttribute("download",e),document.body.appendChild(s),s.click(),document.body.removeChild(s)},Vie=({isOpen:n,onClose:e,onSave:t,title:s,label:r,initialName:i=""})=>{const[o,l]=C.useState(i),[c,d]=C.useState("");C.useEffect(()=>{n&&l(i)},[n,i]);const h=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:f=>f.stopPropagation(),children:[a.jsx("h3",{className:"text-lg font-bold",children:s}),a.jsx("div",{className:"mt-4",children:a.jsx(he,{label:r,id:"name-input",value:o,onChange:f=>{l(f.target.value),d("")},error:c})}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{onClick:h,children:"Save"})]})]})}):null},Kx=[{key:"client_structure",label:"Client Structure",icon:OD},{key:"site_configuration",label:"Site Configuration",icon:Dg},{key:"costing_resource",label:"Costing & Resource",icon:eZ},{key:"backoffice_heads",label:"Back Office & ID Series",icon:Ei},{key:"staff_designation",label:"Staff Designation",icon:KY},{key:"gmc_policy",label:"GMC Policy",icon:Gw},{key:"asset",label:"Asset Management",icon:GY},{key:"tools_list",label:"Tools List",icon:JD},{key:"attendance_format",label:"Attendance Format",icon:sZ},{key:"attendance_overview",label:"Attendance Overview",icon:QY},{key:"notification_template",label:"Notification & Mail",icon:Mh},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:t_},{key:"salary_template",label:"Salary Breakup",icon:da},{key:"salary_line_item",label:"Salary Line Item",icon:da}],Bie=()=>{const[n,e]=C.useState([]),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(!0),[c,d]=C.useState(null),[h,f]=C.useState({}),[p,g]=C.useState("client_structure"),b=C.useRef(null),[v,_]=C.useState(""),[N,j]=C.useState(null),[k,S]=C.useState(!1),P=Nt("(max-width: 767px)"),[E,M]=C.useState({isOpen:!1,initialData:null,companyName:""}),[I,O]=C.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[D,z]=C.useState({isOpen:!1,type:"group",id:"",name:""}),[H,F]=C.useState({isOpen:!1,org:null}),R=C.useMemo(()=>n.flatMap(re=>re.companies.flatMap(ae=>ae.entities.map(ve=>({...ve,companyName:ae.name})))),[n]);C.useEffect(()=>{(async()=>{l(!0);try{const[ae,ve,pe]=await Promise.all([te.getOrganizationStructure(),te.getOrganizations(),te.getSiteConfigurations()]);e(ae),s(ve),i(pe)}catch{d({message:"Failed to load data.",type:"error"})}finally{l(!1)}})()},[]);const V=C.useMemo(()=>{if(!v.trim())return n;const re=v.toLowerCase();return n.map(ae=>{if(ae.name.toLowerCase().includes(re))return ae;const ve=ae.companies.map(pe=>{if(pe.name.toLowerCase().includes(re))return pe;const Ne=pe.entities.filter(Me=>Me.name.toLowerCase().includes(re));return Ne.length>0?{...pe,entities:Ne}:null}).filter(Boolean);return ve.length>0?{...ae,companies:ve}:null}).filter(Boolean)},[n,v]),U=C.useMemo(()=>{if(!v.trim())return t;const re=v.toLowerCase();return t.filter(ae=>ae.shortName.toLowerCase().includes(re))},[t,v]),W=re=>f(ae=>({...ae,[re]:!ae[re]})),B=()=>{d({message:"All changes saved successfully (mocked).",type:"success"})},q=re=>M({isOpen:!0,initialData:null,companyName:re}),Q=(re,ae)=>M({isOpen:!0,initialData:re,companyName:ae}),le=re=>{d({message:re.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),M({isOpen:!1,initialData:null,companyName:""})},X=(re,ae,ve)=>z({isOpen:!0,type:re,id:ae,name:ve}),Z=()=>{const{type:re,id:ae,name:ve}=D;re==="group"?e(pe=>pe.filter(Ne=>Ne.id!==ae)):re==="company"?e(pe=>pe.map(Ne=>({...Ne,companies:Ne.companies.filter(Me=>Me.id!==ae)}))):re==="client"&&e(pe=>pe.map(Ne=>({...Ne,companies:Ne.companies.map(Me=>({...Me,entities:Me.entities.filter(Oe=>Oe.id!==ae)}))}))),d({message:`${re.charAt(0).toUpperCase()+re.slice(1)} '${ve}' deleted.`,type:"success"}),z({isOpen:!1,type:"group",id:"",name:""})},se=re=>{const{mode:ae,type:ve,id:pe,groupId:Ne}=I;if(ae==="add"){if(ve==="group"){const Me={id:`group_${Date.now()}`,name:re,locations:[],companies:[]};e(Oe=>[...Oe,Me]),d({message:`Group '${re}' added.`,type:"success"})}else if(ve==="company"&&Ne){const Me={id:`comp_${Date.now()}`,name:re,entities:[]};e(Oe=>Oe.map(Je=>Je.id===Ne?{...Je,companies:[...Je.companies,Me]}:Je)),d({message:`Company '${re}' added.`,type:"success"})}}else ve==="group"&&pe?(e(Me=>Me.map(Oe=>Oe.id===pe?{...Oe,name:re}:Oe)),d({message:"Group updated.",type:"success"})):ve==="company"&&pe&&Ne&&(e(Me=>Me.map(Oe=>Oe.id===Ne?{...Oe,companies:Oe.companies.map(Je=>Je.id===pe?{...Je,name:re}:Je)}:Oe)),d({message:"Company updated.",type:"success"}));O({isOpen:!1,mode:"add",type:"group",title:"",label:""})},G=()=>{let re,ae,ve;if(p==="client_structure"){ve=Yx;const pe=n.flatMap(Ne=>Ne.companies.flatMap(Me=>Me.entities.map(Oe=>({GroupId:Ne.id,GroupName:Ne.name,CompanyId:Me.id,CompanyName:Me.name,EntityId:Oe.id,EntityName:Oe.name,organizationId:Oe.organizationId||"",Location:Oe.location||"",RegisteredAddress:Oe.registeredAddress||"",RegistrationType:Oe.registrationType||"",RegistrationNumber:Oe.registrationNumber||"",GSTNumber:Oe.gstNumber||"",PANNumber:Oe.panNumber||"",Email:Oe.email||"",EShramNumber:Oe.eShramNumber||"",ShopAndEstablishmentCode:Oe.shopAndEstablishmentCode||"",EPFOCode:Oe.epfoCode||"",ESICCode:Oe.esicCode||"",PSARALicenseNumber:Oe.psaraLicenseNumber||"",PSARAValidTill:Oe.psaraValidTill||""}))));re=xT(pe,ve),ae="client_structure_export.csv"}else if(p==="site_configuration"){ve=Zx;const pe=t.map(Ne=>{const Me=r.find(Oe=>Oe.organizationId===Ne.id);return{organizationId:Ne.id,organizationName:Ne.shortName,...Me||{},agreementDetails:JSON.stringify((Me==null?void 0:Me.agreementDetails)||{}),siteOperations:JSON.stringify((Me==null?void 0:Me.siteOperations)||{})}});re=xT(pe,ve),ae="site_configuration_export.csv"}else{d({message:"Export not implemented for this view.",type:"error"});return}bT(re,ae),d({message:"Data exported successfully.",type:"success"})},ne=()=>{let re,ae;if(p==="client_structure")re=Yx,ae="client_structure_template.csv";else if(p==="site_configuration")re=Zx,ae="site_configuration_template.csv";else{d({message:"Template not available for this view.",type:"error"});return}bT(re.join(","),ae)},ge=re=>{var pe;const ae=(pe=re.target.files)==null?void 0:pe[0];if(!ae)return;const ve=new FileReader;ve.onload=Ne=>{var Me;try{const Oe=(Me=Ne.target)==null?void 0:Me.result;if(!Oe)throw new Error("File is empty.");const Je=Oe.trim().replace(/\r/g,"").split(`
`);if(Je.length<1)throw new Error("CSV file is empty.");const dt=Je[0].split(",").map(at=>at.trim().replace(/"/g,""));if(p==="client_structure"){if(dt.join(",")!==Yx.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const at=vT(Oe);if(at.length===0)throw new Error("No data rows found.");const _t=new Map;for(const K of at){_t.has(K.GroupId)||_t.set(K.GroupId,{group:{id:K.GroupId,name:K.GroupName,locations:[],companies:[]},companiesMap:new Map});const oe=_t.get(K.GroupId);oe.companiesMap.has(K.CompanyId)||oe.companiesMap.set(K.CompanyId,{id:K.CompanyId,name:K.CompanyName,entities:[]});const we=oe.companiesMap.get(K.CompanyId),Se={id:K.EntityId,name:K.EntityName,organizationId:K.organizationId,location:K.Location,registeredAddress:K.RegisteredAddress,registrationType:K.RegistrationType||"",registrationNumber:K.RegistrationNumber,gstNumber:K.GSTNumber,panNumber:K.PANNumber,email:K.Email,eShramNumber:K.EShramNumber,shopAndEstablishmentCode:K.ShopAndEstablishmentCode,epfoCode:K.EPFOCode,esicCode:K.ESICCode,psaraLicenseNumber:K.PSARALicenseNumber,psaraValidTill:K.PSARAValidTill};we.entities.push(Se)}const J=Array.from(_t.values()).map(K=>(K.group.companies=Array.from(K.companiesMap.values()),K.group));e(J),d({message:`Successfully imported ${at.length} client records.`,type:"success"})}else if(p==="site_configuration"){if(dt.join(",")!==Zx.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const at=vT(Oe);if(at.length===0)throw new Error("No data rows found.");const _t=at.map(J=>{const K={};for(const oe of Object.keys(J))if(oe==="agreementDetails"||oe==="siteOperations")try{K[oe]=JSON.parse(J[oe])}catch{console.warn(`Could not parse JSON for ${oe} in row for site ${J.organizationId}`),K[oe]={}}else K[oe]=J[oe];return K});i(J=>{const K=[...J];return _t.forEach(oe=>{const we=K.findIndex(Se=>Se.organizationId===oe.organizationId);we>-1?K[we]=oe:K.push(oe)}),K}),d({message:`Successfully imported ${_t.length} site configurations.`,type:"success"})}else d({message:"Import not implemented for this view.",type:"error"})}catch(Oe){d({message:Oe.message||"Failed to import CSV.",type:"error"})}finally{re.target&&(re.target.value="")}},ve.readAsText(ae)},ye=()=>{switch(p){case"client_structure":return a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[a.jsxs(Y,{onClick:()=>O({isOpen:!0,mode:"add",type:"group",title:"Add New Group",label:"Group Name"}),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(ct,{className:"mr-2 h-4"}),"Add Group"]}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:ne,className:"hover:bg-gray-100",children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Template"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var ae;return(ae=b.current)==null?void 0:ae.click()},className:"hover:bg-gray-100",children:[a.jsx(ao,{className:"mr-2 h-4 w-4"})," Import"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:G,className:"hover:bg-gray-100",children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),a.jsx("div",{className:"space-y-2",children:V.map(ae=>a.jsxs("div",{className:"border-b border-border",children:[a.jsxs("div",{className:"p-3 flex items-center justify-between",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>W(ae.id),children:a.jsx(_l,{className:`h-5 w-5 transition-transform ${h[ae.id]?"rotate-90":""}`})}),a.jsx(bl,{className:"h-5 w-5 text-muted"}),a.jsx("span",{className:"font-semibold",children:ae.name})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Y,{size:"sm",className:"!p-1.5",onClick:()=>O({isOpen:!0,mode:"add",type:"company",groupId:ae.id,title:`Add Company to ${ae.name}`,label:"Company Name"}),title:"Add Company",children:a.jsx(ct,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>O({isOpen:!0,mode:"edit",type:"group",id:ae.id,initialName:ae.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>X("group",ae.id,ae.name),title:"Delete group",children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]})]}),h[ae.id]&&a.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:ae.companies.map(ve=>a.jsxs("div",{className:"border border-border rounded-lg",children:[a.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx("button",{onClick:()=>W(ve.id),children:a.jsx(_l,{className:`h-5 w-5 transition-transform ${h[ve.id]?"rotate-90":""}`})}),a.jsxs("span",{children:[ve.name," (",ve.entities.length," clients)"]})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Y,{variant:"icon",size:"sm",title:`View ${ve.entities.length} clients`,onClick:()=>j({companyName:ve.name,clients:ve.entities}),children:a.jsx(ca,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>q(ve.name),title:"Add client",children:a.jsx(ct,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>O({isOpen:!0,mode:"edit",type:"company",id:ve.id,groupId:ae.id,initialName:ve.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>X("company",ve.id,ve.name),title:"Delete company",children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]})]}),h[ve.id]&&a.jsx("div",{className:"p-2",children:ve.entities.map(pe=>a.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[a.jsx("span",{children:pe.name}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>Q(pe,ve.name),children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>X("client",pe.id,pe.name),children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]})]},pe.id))})]},ve.id))})]},ae.id))})]});case"site_configuration":return a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[a.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{type:"button",variant:"outline",onClick:ne,children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Template"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>{var ae;return(ae=b.current)==null?void 0:ae.click()},children:[a.jsx(ao,{className:"mr-2 h-4 w-4"})," Import"]}),a.jsxs(Y,{type:"button",variant:"outline",onClick:G,children:[a.jsx(or,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),a.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:U.map(ae=>{const ve=r.find(Ne=>Ne.organizationId===ae.id),pe=!!ve&&(!!ve.billingName||!!ve.keyAccountManager);return a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsx(bl,{className:"h-5 w-5 text-muted"}),a.jsx("span",{children:ae.shortName})]})}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:pe?a.jsxs("span",{className:"flex items-center text-green-600",children:[a.jsx(Kr,{className:"h-4 w-4 mr-1"})," Complete"]}):a.jsxs("span",{className:"flex items-center text-yellow-600",children:[a.jsx(lZ,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),a.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:a.jsxs(Y,{size:"sm",variant:"outline",onClick:()=>F({isOpen:!0,org:ae}),children:[a.jsx(ca,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},ae.id)})})]})})]});case"costing_resource":return a.jsx(aie,{});case"backoffice_heads":return a.jsx(cie,{});case"staff_designation":return a.jsx(hie,{});case"gmc_policy":return a.jsx(yie,{});case"asset":return a.jsx(Pie,{});case"tools_list":return a.jsx(Iie,{});case"attendance_format":return a.jsx(Oie,{});case"attendance_overview":return a.jsx(Rie,{});case"daily_attendance":return a.jsx(Lie,{});case"notification_template":return a.jsx(Fie,{});case"onboard_reject_reason":return a.jsx($ie,{});case"salary_template":return a.jsx(zie,{});case"salary_line_item":return a.jsx(Uie,{});default:const re=Kx.find(ae=>ae.key===p);return a.jsx(So,{title:(re==null?void 0:re.label)||"Configuration"})}};return a.jsxs("div",{className:"p-4 space-y-6",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),a.jsx(sie,{isOpen:k,onClose:()=>S(!1)}),E.isOpen&&a.jsx(nie,{...E,onClose:()=>M(re=>({...re,isOpen:!1})),onSave:le}),a.jsx(Vie,{isOpen:I.isOpen,onClose:()=>O({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:se,title:I.title,label:I.label,initialName:I.initialName}),a.jsxs(yn,{isOpen:D.isOpen,onClose:()=>z(re=>({...re,isOpen:!1})),onConfirm:Z,title:"Confirm Deletion",children:["Are you sure you want to delete the ",D.type,' "',D.name,'"? This action cannot be undone.']}),H.isOpen&&H.org&&a.jsx(iI,{isOpen:H.isOpen,onClose:()=>F({isOpen:!1,org:null}),onSave:()=>{},organization:H.org,allClients:R,initialData:r.find(re=>{var ae;return re.organizationId===((ae=H.org)==null?void 0:ae.id)})}),N&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>j(null),children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:re=>re.stopPropagation(),children:[a.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",N.companyName]}),N.clients.length>0?a.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:N.clients.map(re=>a.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:re.name},re.id))}):a.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),a.jsx("div",{className:"mt-6 text-right",children:a.jsx(Y,{onClick:()=>j(null),variant:"secondary",children:"Close"})})]})}),a.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[a.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!P&&a.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[a.jsxs(Y,{variant:"outline",onClick:()=>S(!0),className:"hover:bg-gray-100",children:[a.jsx(pk,{className:"mr-2 h-4 w-4"})," Help"]}),a.jsx("input",{type:"file",ref:b,className:"hidden",accept:".csv",onChange:ge}),a.jsxs(Y,{onClick:B,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),P&&a.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[a.jsxs(Y,{onClick:B,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),a.jsxs(Y,{variant:"outline",onClick:()=>S(!0),className:"w-full justify-center hover:bg-gray-100",children:[a.jsx(pk,{className:"mr-2 h-4 w-4"})," Help"]}),a.jsx("input",{type:"file",ref:b,className:"hidden",accept:".csv",onChange:ge})]}),a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),a.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:v,onChange:re=>_(re.target.value),className:"form-input pl-10 w-full"})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[a.jsx("nav",{className:"md:col-span-1",children:P?a.jsx(Te,{label:"Configuration Section",id:"hr-config-select",value:p,onChange:re=>g(re.target.value),children:Kx.map(re=>a.jsx("option",{value:re.key,children:re.label},re.key))}):a.jsx("div",{className:"space-y-1",children:Kx.map(re=>a.jsxs("button",{onClick:()=>g(re.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${p===re.key?"text-white":"text-muted hover:bg-accent-light hover:text-accent-dark"}`,style:p===re.key?{backgroundColor:"#006B3F"}:{},children:[a.jsx(re.icon,{className:"h-5 w-5"}),a.jsx("span",{children:re.label})]},re.key))})}),a.jsx("main",{className:"md:col-span-3",children:o?a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):ye()})]})]})},qie=({onSave:n,onClose:e,initialData:t})=>{const[s,r]=C.useState((t==null?void 0:t.name)||""),[i,o]=C.useState((t==null?void 0:t.description)||""),l=c=>{c.preventDefault(),n({name:s,description:i})};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:c=>c.stopPropagation(),children:a.jsxs("form",{onSubmit:l,children:[a.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Policy"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("input",{value:s,onChange:c=>r(c.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0}),a.jsx("textarea",{value:i,onChange:c=>o(c.target.value),placeholder:"Description",className:"form-input",rows:3})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(Y,{type:"submit",children:"Save Policy"})]})]})})})},Hie=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(!1),[o,l]=C.useState(null),[c,d]=C.useState(null),h=C.useCallback(async()=>{s(!0);try{const p=await te.getPolicies();e(p)}catch{d({message:"Failed to fetch policies.",type:"error"})}finally{s(!1)}},[]);C.useEffect(()=>{h()},[h]);const f=async p=>{try{o||(await te.createPolicy(p),d({message:"Policy created.",type:"success"})),i(!1),h()}catch{d({message:"Failed to save policy.",type:"error"})}};return a.jsxs("div",{children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),r&&a.jsx(qie,{onSave:f,onClose:()=>i(!1),initialData:o}),a.jsx(ur,{title:"Policy Management",children:a.jsxs(Y,{onClick:()=>{l(null),i(!0)},children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?a.jsx("tr",{children:a.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(p=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:p.name}),a.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:p.description}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:a.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>{l(p),i(!0)},children:a.jsx(Jn,{className:"h-4 w-4"})})})})]},p.id))})]})})]})},Wie=Ke({type:ie().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:ie().required("Provider is required"),policyNumber:ie().required("Policy number is required"),validTill:ie().required("Valid till date is required")}).defined(),Gie=({onSave:n,onClose:e,initialData:t})=>{var d,h,f;const{register:s,handleSubmit:r,control:i,formState:{errors:o},reset:l}=xt({resolver:Lt(Wie)});C.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=p=>{n(p)};return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:p=>p.stopPropagation(),children:a.jsxs("form",{onSubmit:r(c),children:[a.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs(Te,{label:"Insurance Type",id:"type",registration:s("type"),error:(d=o.type)==null?void 0:d.message,children:[a.jsx("option",{children:"GMC"}),a.jsx("option",{children:"GPA"}),a.jsx("option",{children:"WCA"}),a.jsx("option",{children:"Other"})]}),a.jsx(he,{label:"Provider",id:"provider",registration:s("provider"),error:(h=o.provider)==null?void 0:h.message}),a.jsx(he,{label:"Policy Number",id:"policyNumber",registration:s("policyNumber"),error:(f=o.policyNumber)==null?void 0:f.message}),a.jsx(de,{name:"validTill",control:i,render:({field:p})=>{var g;return a.jsx($t,{label:"Valid Till",id:"validTill",value:p.value,onChange:p.onChange,error:(g=o.validTill)==null?void 0:g.message})}})]}),a.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsx(Y,{type:"submit",children:"Save Insurance"})]})]})})})},Yie=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(!1),[o,l]=C.useState(null),[c,d]=C.useState(null),h=C.useCallback(async()=>{s(!0);try{const p=await te.getInsurances();e(p)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{s(!1)}},[]);C.useEffect(()=>{h()},[h]);const f=async p=>{try{o||(await te.createInsurance(p),d({message:"Insurance created.",type:"success"})),i(!1),h()}catch{d({message:"Failed to save insurance.",type:"error"})}};return a.jsxs("div",{children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),r&&a.jsx(Gie,{onSave:f,onClose:()=>i(!1),initialData:o}),a.jsx(ur,{title:"Insurance Management",children:a.jsxs(Y,{onClick:()=>{l(null),i(!0)},children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),a.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),a.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?a.jsx("tr",{children:a.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(p=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:p.type}),a.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:p.provider}),a.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:p.policyNumber}),a.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:p.validTill}),a.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:a.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>{l(p),i(!0)},children:a.jsx(Jn,{className:"h-4 w-4"})})})})]},p.id))})]})})]})},Zie=()=>{const[n,e]=C.useState("policies");return a.jsxs("div",{className:"p-4 space-y-6",children:[a.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:a.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),a.jsx("div",{children:a.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[a.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[a.jsx(Bs,{className:"h-5 w-5"}),a.jsx("span",{children:"Company Policies"})]}),a.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[a.jsx(WD,{className:"h-5 w-5"}),a.jsx("span",{children:"Insurance Plans"})]})]})}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&a.jsx(Hie,{}),n==="insurance"&&a.jsx(Yie,{})]})]})},am={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},Kie=()=>{const n=bo(),[e,t]=C.useState(null),[s,r]=C.useState([]),[i,o]=C.useState("Administrator");C.useEffect(()=>{te.getSiteStaffDesignations().then(j=>{const k=[...new Set(j.map(S=>S.designation))];k.includes("Administrator")||k.unshift("Administrator"),r(k.map((S,P)=>({id:`${P}`,designation:S,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:h},watch:f,reset:p,setValue:g}=xt({defaultValues:n});C.useEffect(()=>{p(n)},[n,p]),C.useEffect(()=>{var k;((k=n.rulesByDesignation)==null?void 0:k[i])||(Object.keys(am.documents).forEach(S=>{g(`rulesByDesignation.${i}.documents.${S}`,!0,{shouldDirty:!0})}),Object.keys(am.verifications).forEach(S=>{g(`rulesByDesignation.${i}.verifications.${S}`,!0,{shouldDirty:!0})}))},[i,n.rulesByDesignation,g]);const b=f("enforceManpowerLimit"),v=f("enableEsiRule"),_=f("enableGmcRule"),N=j=>{n.updateRules(j),t({message:"Enrollment rules saved successfully!",type:"success"}),p(j)};return a.jsxs("form",{onSubmit:c(N),className:"p-4 space-y-8 w-full",children:[e&&a.jsx(gt,{message:e.message,type:e.type,onDismiss:()=>t(null)}),a.jsx(ur,{title:"Enrollment Rules",children:a.jsxs(Y,{type:"submit",disabled:!h,children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(Bs,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),a.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),a.jsx("div",{className:"mb-4",children:a.jsx(Te,{label:"Configure rules for designation",value:i,onChange:j=>o(j.target.value),children:s.map(j=>a.jsx("option",{value:j.designation,children:j.designation},j.id))})}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsxs("section",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),a.jsx("div",{className:"space-y-3",children:Object.keys(am.documents).map(j=>a.jsx(de,{name:`rulesByDesignation.${i}.documents.${j}`,control:d,defaultValue:!0,render:({field:k})=>a.jsx(zt,{id:`${i}-${j}`,label:j.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()),checked:k.value,onChange:k.onChange})},j))})]}),a.jsxs("section",{children:[a.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),a.jsx("div",{className:"space-y-3",children:Object.keys(am.verifications).map(j=>a.jsx(de,{name:`rulesByDesignation.${i}.verifications.${j}`,control:d,defaultValue:!0,render:({field:k})=>a.jsx(zt,{id:`${i}-${j}`,label:j.replace(/([A-Z])/g," $1").replace(/^./,S=>S.toUpperCase()),checked:k.value,onChange:k.onChange})},j))})]})]})]}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(da,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),a.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),a.jsx(de,{name:"enableEsiRule",control:d,render:({field:j})=>a.jsx(zt,{id:"enableEsiRule",label:"Enable Rule",checked:j.value,onChange:j.onChange})})]}),a.jsx("div",{className:`transition-opacity ${v?"opacity-100":"opacity-50 pointer-events-none"}`,children:a.jsxs("div",{className:"max-w-sm",children:[a.jsx(he,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!v}),a.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(da,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),a.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),a.jsx(de,{name:"enableGmcRule",control:d,render:({field:j})=>a.jsx(zt,{id:"enableGmcRule",label:"Enable Rule",checked:j.value,onChange:j.onChange})})]}),a.jsxs("div",{className:`transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:[a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[a.jsx(he,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!_}),a.jsx(de,{name:"defaultPolicySingle",control:d,render:({field:j})=>a.jsxs(Te,{label:"Policy (Single)",...j,disabled:!_,children:[a.jsx("option",{value:"1L",children:"1 Lakh"}),a.jsx("option",{value:"2L",children:"2 Lakh"})]})}),a.jsx(de,{name:"defaultPolicyMarried",control:d,render:({field:j})=>a.jsxs(Te,{label:"Policy (Married)",...j,disabled:!_,children:[a.jsx("option",{value:"1L",children:"1 Lakh"}),a.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),a.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(Ei,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),a.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(de,{name:"enforceManpowerLimit",control:d,render:({field:j})=>a.jsx(zt,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:j.value,onChange:j.onChange})}),a.jsx("div",{className:`max-w-sm transition-opacity ${b?"opacity-100":"opacity-50 pointer-events-none"}`,children:a.jsxs(Te,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!b,children:[a.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),a.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(Jn,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),a.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),a.jsx("div",{className:"space-y-4",children:a.jsx(de,{name:"allowSalaryEdit",control:d,render:({field:j})=>a.jsx(zt,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:j.value??!1,onChange:j.onChange})})})]}),a.jsxs("div",{className:"md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"flex items-start mb-6",children:[a.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:a.jsx(nd,{className:"h-6 w-6 text-accent-dark"})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),a.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),a.jsx("div",{className:"space-y-4",children:a.jsx(de,{name:"enforceFamilyValidation",control:d,render:({field:j})=>a.jsx(zt,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:j.value??!1,onChange:j.onChange})})})]})]})},Jie=()=>{var P,E,M,I,O;const{id:n}=HP(),e=Vt(),[t,s]=C.useState(null),[r,i]=C.useState(!0),[o,l]=C.useState(!1),c=C.useRef(null),{data:d,setFormsGenerated:h}=rn(),f=s_(D=>D.currentLogo),[p,g]=C.useState(!1);C.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){i(!0);const z=await te.getOnboardingDataById(n);s(z||null),i(!1)}else s(d),i(!1)})()},[n,d]);const b=async()=>{const D=c.current;if(D&&t){g(!0);try{const z=D.outerHTML,H={margin:0,filename:`Onboarding_Forms_${t==null?void 0:t.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await te.generatePdf(z,H)}catch(z){console.error("PDF generation failed:",z)}finally{g(!1)}}},v=()=>{h(!0),e(`/onboarding/add/review?id=${n}`)};if(r||p)return a.jsx("div",{className:"text-center p-10",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return a.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const _=t,N=`${_.personal.firstName} ${_.personal.middleName||""} ${_.personal.lastName}`.replace(/\s+/g," ").trim(),j=((P=_.family.find(D=>D.relation==="Father"))==null?void 0:P.name)||"",k=((E=_.family.find(D=>D.relation==="Spouse"))==null?void 0:E.name)||"",S=((M=_.family.find(D=>D.relation==="Mother"))==null?void 0:M.name)||"";return a.jsx("div",{className:"bg-page",children:a.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[a.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[a.jsxs(Y,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Go Back"]}),a.jsxs("div",{className:"text-center",children:[a.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),a.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsxs(Y,{type:"button",onClick:b,variant:"outline",disabled:p,children:[p?a.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(or,{className:"mr-2 h-4 w-4"}),p?"Generating...":"Download"]}),a.jsx(Y,{type:"button",onClick:v,children:"Confirm & Continue"})]})]})}),a.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[a.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:a.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[a.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),a.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:a.jsx("img",{src:f,alt:"Paradigm Logo",className:"w-full"})}),a.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:N})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:_.organization.organizationName})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:_.organization.designation})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:_.personal.employeeId})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:_.uan.pfNumber||_.uan.uanNumber})]}),a.jsxs("div",{className:"flex items-center",children:[a.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",a.jsx("span",{className:"border-b border-black flex-1 ml-2",children:_.esi.esiNumber})]})]})]})}),a.jsx("div",{className:"page-break"}),a.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:a.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[a.jsx("div",{className:"absolute top-4 right-4 w-48",children:a.jsx("img",{src:f,alt:"Paradigm Logo",className:"w-full"})}),a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",a.jsx("span",{className:"font-normal underline",children:_.personal.employeeId})]}),a.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),a.jsxs("div",{className:"space-y-2",children:[a.jsxs("p",{children:["1. Name: ",a.jsx("span",{className:"underline",children:N})]}),a.jsxs("p",{children:["2. Father's Name: ",a.jsx("span",{className:"underline",children:j})]}),a.jsxs("p",{children:["3. Mother's Name: ",a.jsx("span",{className:"underline",children:S})]}),a.jsxs("p",{children:["4. Reference by: ",a.jsx("span",{className:"underline"})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["5. Date of Birth: ",a.jsx("span",{className:"underline",children:_.personal.dob})]}),a.jsxs("p",{children:["6. Age: ",a.jsx("span",{className:"underline",children:_.personal.dob?new Date().getFullYear()-new Date(_.personal.dob).getFullYear():""})]})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["7. Qualification: ",a.jsx("span",{className:"underline",children:((I=_.education[0])==null?void 0:I.degree)||""})]}),a.jsxs("p",{children:["8. Experience: ",a.jsx("span",{className:"underline"})]})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["9. Designation: ",a.jsx("span",{className:"underline",children:_.organization.designation})]}),a.jsxs("p",{children:["10. Net Salary Offered: ",a.jsx("span",{className:"underline",children:(O=_.personal.salary)==null?void 0:O.toLocaleString("en-IN")})]})]}),a.jsxs("p",{children:["11. Present Address: ",a.jsx("span",{className:"underline",children:`${_.address.present.line1}, ${_.address.present.city}, ${_.address.present.state} - ${_.address.present.pincode}`})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["12. Permanent Address: ",a.jsx("span",{className:"underline",children:_.address.sameAsPresent?"Same as Present":`${_.address.permanent.line1}, ${_.address.permanent.city}`})]}),a.jsxs("p",{children:["Ph. No.: ",a.jsx("span",{className:"underline",children:_.personal.mobile})," Alternate Ph. No.: ",a.jsx("span",{className:"underline",children:_.personal.alternateMobile||""})]})]}),a.jsx("p",{children:"13. Left hand thumb impression"}),a.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{})]}),a.jsx("p",{children:"14. Right hand thumb impression"}),a.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{className:"border-r border-black"}),a.jsx("div",{})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["15. Marital Status: ",a.jsx("span",{className:"underline",children:_.personal.maritalStatus})]}),a.jsxs("p",{children:["16. Name of the Spouse: ",a.jsx("span",{className:"underline",children:k})," Contact No.: ",a.jsx("span",{className:"underline"})]})]}),a.jsxs("p",{children:["17. Languages Known: to Speak ",a.jsx("span",{className:"underline"})," to Write ",a.jsx("span",{className:"underline"})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["18. Date of Joining: ",a.jsx("span",{className:"underline",children:_.organization.joiningDate})]}),a.jsx("p",{children:"19. ID Card:"})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["20. ESI Number: ",a.jsx("span",{className:"underline",children:_.esi.esiNumber})]}),a.jsxs("p",{children:["21. PF Number: ",a.jsx("span",{className:"underline",children:_.uan.pfNumber||_.uan.uanNumber})]})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("p",{children:"22. Uniform Details: "}),a.jsx("p",{children:"23. Shoe Details: "})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("p",{children:["24. Name of the Site: ",a.jsx("span",{className:"underline",children:_.organization.organizationName})]}),a.jsx("p",{children:"25. Site / Estate Manager: "})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("p",{children:"26. Record enclosed: "}),a.jsx("p",{children:"28. Reference Name:"})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("p",{children:"27. Hirer: "}),a.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),a.jsxs("p",{children:["29. Emergency Contact Name: ",a.jsx("span",{className:"underline",children:_.personal.emergencyContactName})," Ph.: ",a.jsx("span",{className:"underline",children:_.personal.emergencyContactNumber})," Blood Group: ",a.jsx("span",{className:"underline",children:_.personal.bloodGroup})]})]}),a.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[a.jsx("p",{children:"Employee Signature:"}),a.jsx("p",{children:"Documented by:"})]})]})})]})]})})},Qie=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return a.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},za=({title:n,sizes:e,headers:t,control:s,quantityType:r,quantities:i,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const f=parseInt(String(d)),p=parseInt(String(h));return!isNaN(f)&&!isNaN(p)?f-p:String(d).localeCompare(String(h))});return a.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[a.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>a.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),a.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),a.jsx("tbody",{className:"divide-y",children:c.map(d=>a.jsx(Fe.Fragment,{children:l.map((h,f)=>{const p=e.find(g=>g.size===d&&g.fit===h);return p?a.jsxs("tr",{children:[f===0&&a.jsx("td",{rowSpan:l.filter(g=>e.some(b=>b.size===d&&b.fit===g)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(g=>a.jsx("td",{className:"px-2 py-2",children:p[g.key]},String(g.key))),a.jsx("td",{className:"px-2 py-2",children:o?a.jsx("span",{className:"font-semibold block text-center pr-4",children:(i==null?void 0:i[p.id])||0}):a.jsx(de,{name:`${r}.${p.id}`,control:s,render:({field:g})=>a.jsx(he,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...g,value:g.value||"",onChange:b=>g.onChange(parseInt(b.target.value)||null),className:"!py-1.5"})})})]},p.id):null})},d))})]})})]})},Xie=({onSave:n,onCancel:e,sites:t,masterUniforms:s,initialData:r})=>{const{register:i,control:o,handleSubmit:l,watch:c,reset:d}=xt({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),h=c("gender");C.useEffect(()=>{if(r){const p={},g={};r.items.forEach(b=>{b.category==="Pants"?p[b.sizeId]=b.quantity:g[b.sizeId]=b.quantity}),d({siteId:r.siteId,gender:r.gender,pantsQuantities:p,shirtsQuantities:g})}else d({siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}})},[r,d]);const f=p=>{const g=t.find(N=>N.id===p.siteId);if(!g)return;const b=h==="Gents"?[...s.gents.pants,...s.gents.shirts]:[...s.ladies.pants,...s.ladies.shirts],v=[];for(const[N,j]of Object.entries(p.pantsQuantities))if(j&&j>0){const k=b.find(S=>S.id===N);k&&v.push({sizeId:N,quantity:j,category:"Pants",sizeLabel:k.size,fit:k.fit})}for(const[N,j]of Object.entries(p.shirtsQuantities))if(j&&j>0){const k=b.find(S=>S.id===N);k&&v.push({sizeId:N,quantity:j,category:"Shirts",sizeLabel:k.size,fit:k.fit})}const _={id:(r==null?void 0:r.id)||`new_${Date.now()}`,siteId:p.siteId,siteName:g.shortName,gender:p.gender,requestedDate:(r==null?void 0:r.requestedDate)||new Date().toISOString(),status:(r==null?void 0:r.status)||"Pending",items:v};n(_)};return a.jsxs("form",{onSubmit:l(f),className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card my-6 animate-fade-in-down",children:[a.jsxs("div",{className:"flex justify-between items-center mb-4",children:[a.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:[r?"Edit":"New"," Uniform Request"]}),a.jsx(Y,{type:"button",variant:"icon",onClick:e,"aria-label":"Close form",children:a.jsx(Us,{})})]}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Te,{label:"Select Site",...i("siteId"),required:!0,children:[a.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(p=>a.jsx("option",{value:p.id,children:p.shortName},p.id))]}),a.jsxs(Te,{label:"Select Uniform Type",...i("gender"),children:[a.jsx("option",{children:"Gents"}),a.jsx("option",{children:"Ladies"})]})]}),a.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:h==="Gents"?a.jsxs(a.Fragment,{children:[a.jsx(za,{title:"Gents' Pants",sizes:s.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),a.jsx(za,{title:"Gents' Shirts",sizes:s.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):a.jsxs(a.Fragment,{children:[a.jsx(za,{title:"Ladies' Pants",sizes:s.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),a.jsx(za,{title:"Ladies' Shirts",sizes:s.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsxs(Y,{type:"submit",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})]})},eae=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:s,shirtsQuantities:r}=C.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),i=n.gender==="Gents"?t.gents:t.ladies;return a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[a.jsxs("div",{children:[a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),a.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",Ce(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),a.jsx(Y,{variant:"icon",onClick:e,children:a.jsx(Us,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:a.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?a.jsxs(a.Fragment,{children:[a.jsx(za,{readOnly:!0,title:"Gents' Pants",sizes:i.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:s}),a.jsx(za,{readOnly:!0,title:"Gents' Shirts",sizes:i.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:r})]}):a.jsxs(a.Fragment,{children:[a.jsx(za,{readOnly:!0,title:"Ladies' Pants",sizes:i.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:s}),a.jsx(za,{readOnly:!0,title:"Ladies' Shirts",sizes:i.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:r})]})})}),a.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:a.jsx(Y,{variant:"secondary",onClick:e,children:"Close"})})]})})},tae=()=>{const[n,e]=C.useState("list"),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(null),[c,d]=C.useState(!0),[h,f]=C.useState(null),[p,g]=C.useState(null),[b,v]=C.useState(null),[_,N]=C.useState(null),j=async()=>{d(!0);try{const[M,I,O,D]=await Promise.all([te.getUniformRequests(),te.getOrganizations(),te.getMasterGentsUniforms(),te.getMasterLadiesUniforms()]);s(M),i(I),l({gents:O,ladies:D})}catch{f({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};C.useEffect(()=>{j()},[]);const k=()=>{g(null),e("form")},S=M=>{g(M),e("form")},P=async M=>{try{M.id.startsWith("new_")?(await te.submitUniformRequest(M),f({message:"New request submitted.",type:"success"})):(await te.updateUniformRequest(M),f({message:"Request updated.",type:"success"})),e("list"),j()}catch{f({message:"Failed to save request.",type:"error"})}},E=async()=>{if(b)try{await te.deleteUniformRequest(b.id),f({message:"Request deleted.",type:"success"}),v(null),j()}catch{f({message:"Failed to delete request.",type:"error"})}};return c?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{className:"p-4 space-y-6",children:[h&&a.jsx(gt,{message:h.message,type:h.type,onDismiss:()=>f(null)}),a.jsx(yn,{isOpen:!!b,onClose:()=>v(null),onConfirm:E,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),o&&a.jsx(eae,{request:_,onClose:()=>N(null),masterUniforms:o}),a.jsx("div",{className:"bg-card p-4 rounded-2xl",children:a.jsx(ur,{title:"Uniform Management",children:n==="list"&&a.jsxs(Y,{onClick:k,children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),n==="form"&&o&&a.jsx(Xie,{onSave:P,onCancel:()=>e("list"),sites:r,masterUniforms:o,initialData:p}),n==="list"&&a.jsxs("div",{className:"overflow-x-auto",children:[a.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),a.jsx("tbody",{children:t.map(M=>{var I,O,D;return a.jsxs("tr",{children:[a.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[a.jsx("p",{children:M.siteName}),M.source==="Individual"&&((O=(I=M.employeeDetails)==null?void 0:I[0])==null?void 0:O.employeeName)&&a.jsxs("p",{className:"text-xs text-muted",children:["For: ",M.employeeDetails[0].employeeName]}),M.source==="Enrollment"&&a.jsxs("p",{className:"text-xs text-muted",children:["(",((D=M.employeeDetails)==null?void 0:D.length)||0," employees)"]})]}),a.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:M.gender}),a.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:M.requestedByName||"System"}),a.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:M.source||"Bulk"}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:a.jsx(Qie,{status:M.status})}),a.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>N(M),title:"View Request",children:a.jsx(ca,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>S(M),title:"Edit Request",disabled:M.source==="Enrollment",children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>v(M),title:"Delete Request",disabled:M.source==="Enrollment",children:a.jsx(kt,{className:"h-4 w-4 text-red-600"})})]})})]},M.id)})})]}),t.length===0&&a.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},nae=({item:n})=>{const[e,t]=C.useState(!1);return a.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),a.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),a.jsx("p",{className:"text-xs text-muted mt-1",children:Ce(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),a.jsx("div",{className:"text-right",children:a.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&a.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[a.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[a.jsx("span",{children:"Details"}),a.jsx(Ml,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&a.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((s,r)=>a.jsxs("li",{children:[s.name,": ",(s.cost||0).toFixed(2)]},r))})]})]})},sae=()=>a.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>a.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{className:"space-y-2",children:[a.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),a.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),a.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),a.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),rae=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),{verificationCosts:r,updateVerificationCosts:i}=ir(),[o,l]=C.useState(r),[c,d]=C.useState(!1),[h,f]=C.useState([{startDate:ji(new Date,29),endDate:new Date,key:"selection"}]),[p,g]=C.useState("Last 30 Days"),[b,v]=C.useState(!1),_=C.useRef(null),[N,j]=C.useState(null),k=C.useRef(null),S=Nt("(max-width: 767px)"),P=C.useCallback(async()=>{var le,X;const q=(le=h[0])==null?void 0:le.startDate,Q=(X=h[0])==null?void 0:X.endDate;if(!(!q||!Q)){s(!0);try{const Z=await te.getVerificationCostBreakdown(Ce(q,"yyyy-MM-dd"),Ce(Q,"yyyy-MM-dd"));e(Z)}catch(Z){console.error("Failed to fetch cost breakdown",Z),j({message:"Failed to load verification data.",type:"error"})}finally{s(!1)}}},[h]);C.useEffect(()=>{P()},[P]),C.useEffect(()=>{const q=Q=>{_.current&&!_.current.contains(Q.target)&&v(!1)};return document.addEventListener("mousedown",q),()=>document.removeEventListener("mousedown",q)},[]),C.useEffect(()=>{l(r)},[r]),C.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(r))},[o,r]);const E=(q,Q,le)=>{l(X=>X.map(Z=>Z.id===q?Q==="cost"?{...Z,cost:parseFloat(le)||0}:{...Z,name:le}:Z))},M=()=>{l(q=>[...q,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},I=q=>{l(Q=>Q.filter(le=>le.id!==q))},O=()=>{i(o),j({message:"Costs updated successfully!",type:"success"})},D=C.useMemo(()=>{const q=new Map(r.map(Q=>[Q.name,Q.cost]));return n.map(Q=>{const le=Q.breakdown.map(Z=>({...Z,cost:Number(q.get(Z.name))||0})),X=le.reduce((Z,se)=>Z+(se.cost||0)*se.count,0);return{...Q,breakdown:le,totalCost:X}})},[n,r]),z=C.useMemo(()=>{const q=D.length,Q=D.reduce((X,Z)=>X+Z.totalCost,0),le=q>0?Q/q:0;return{totalEmployees:q,totalCost:Q,averageCost:le}},[D]),H=C.useMemo(()=>{const q={};return D.forEach(Q=>{Q.breakdown.forEach(le=>{q[le.name]||(q[le.name]={count:0,total:0}),q[le.name].count+=le.count,q[le.name].total+=(le.cost||0)*le.count})}),Object.entries(q).map(([Q,le])=>({name:Q,...le}))},[D]),[F,R]=C.useState(!1),V=async q=>{{const Q=k.current;if(!Q){j({message:"Could not find report to export.",type:"error"});return}R(!0);try{const le=Q.outerHTML,X={margin:.5,filename:`Cost_Analysis_Report_${Ce(h[0].startDate,"yyyy-MM-dd")}_to_${Ce(h[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await te.generatePdf(le,X)}catch(le){console.error("PDF generation failed:",le),j({message:"Failed to generate PDF.",type:"error"})}finally{R(!1)}}},U=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],W=q=>{const Q=new Date;let le=new Date;q==="Today"?le=jp():q==="Last 7 Days"?le=ji(Q,6):q==="Last 30 Days"&&(le=ji(Q,29)),g(q),f([{startDate:le,endDate:Q,key:"selection"}]),v(!1)},B=q=>{f([q.selection])};return a.jsxs("div",{className:"p-4 space-y-6",children:[N&&a.jsx(gt,{message:N.message,type:N.type,onDismiss:()=>j(null)}),a.jsx(ur,{title:"Verification Costing",children:a.jsx("div",{className:"w-full sm:w-auto",children:a.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[a.jsxs(Y,{onClick:()=>V(),variant:"outline",size:"sm",disabled:F||t||D.length===0,children:[F?a.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(or,{className:"mr-2 h-4 w-4"}),F?"Generating PDF...":"Download PDF"]}),U.map(q=>a.jsx(Y,{variant:p===q.value?"outline":"secondary",size:"sm",onClick:()=>W(q.value),className:"justify-center",children:q.label},q.value)),a.jsxs("div",{className:"relative",ref:_,children:[a.jsxs(Y,{variant:p==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{v(q=>!q),g("Custom")},className:"w-full justify-center",children:[a.jsx(wl,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Custom Range"})]}),b&&a.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:a.jsx(Ih.DateRangePicker,{onChange:B,ranges:h,maxDate:new Date,direction:"horizontal"})})]})]})})}),a.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:a.jsxs("details",{className:"group",children:[a.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[a.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[a.jsx(Dg,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),a.jsx(Ml,{className:"transition-transform group-open:rotate-180"})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t",children:[a.jsx("div",{className:"space-y-2",children:o.map(q=>a.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[a.jsx("div",{className:"col-span-12 sm:col-span-6",children:a.jsx(he,{"aria-label":"Cost Item Name",value:q.name,onChange:Q=>E(q.id,"name",Q.target.value),className:"!py-2"})}),a.jsx("div",{className:"col-span-8 sm:col-span-4",children:a.jsx(he,{"aria-label":"Cost Value",type:"number",step:"0.01",value:q.cost||0,onChange:Q=>E(q.id,"cost",Q.target.value),className:"!py-2"})}),a.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:a.jsx(Y,{variant:"icon",onClick:()=>I(q.id),"aria-label":`Remove ${q.name}`,children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})})]},q.id))}),a.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[a.jsxs(Y,{type:"button",variant:"outline",size:"sm",onClick:M,children:[a.jsx(ct,{className:"mr-2 h-4"})," Add Cost Item"]}),a.jsxs(Y,{onClick:O,disabled:!c,children:[a.jsx(cs,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[a.jsx(wi,{title:"Total Verification Cost",value:`${z.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:da}),a.jsx(wi,{title:"Total Verified Employees",value:z.totalEmployees,icon:Ei}),a.jsx(wi,{title:"Avg. Cost Per Employee",value:`${z.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:da})]}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?a.jsx("div",{className:"flex justify-center items-center h-24",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted"})}):H.length>0?a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:H.map(q=>a.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[a.jsx("p",{className:"text-sm font-medium text-muted",children:q.name}),a.jsx("p",{className:"text-2xl font-bold text-primary-text",children:q.count}),a.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",q.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},q.name))}):a.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx("div",{className:"flex justify-between items-center",children:a.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),a.jsx("div",{ref:k,className:"mt-4 pt-4 border-t border-border",children:S?t?a.jsx(sae,{}):D.length===0?a.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):a.jsx("div",{className:"space-y-4",children:D.map(q=>a.jsx(nae,{item:q},q.id))}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),a.jsx("tbody",{children:t?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10",children:a.jsx(Qe,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):D.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):D.map(q=>a.jsxs("tr",{children:[a.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[a.jsx("div",{className:"font-medium text-primary-text",children:q.employeeName}),a.jsx("div",{className:"text-sm text-muted",children:q.employeeId})]}),a.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:Ce(new Date(q.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),a.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:a.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[q.breakdown.map((Q,le)=>a.jsxs("li",{children:[Q.name,": ",(Q.cost||0).toFixed(2)]},le)),q.breakdown.length===0&&a.jsx("li",{children:"No verifications performed"})]})}),a.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",q.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},q.id))})]})})})]})]})},iae=({status:n})=>{if(!n)return a.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return a.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},aae=({invoiceData:n,discount:e,setDiscount:t,roundOff:s,setRoundOff:r})=>{var l;const i=c=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(c),o=C.useMemo(()=>{if(!n)return null;const c=n.lineItems.reduce((g,b)=>{const v=b.deployment*b.ratePerMonth;return b.description.toLowerCase().includes("deduction")?g-v:g+v},0),d=c*.1,h=c+d-e,f=h*.09,p=h+f+f+s;return{subTotal:c,serviceCharge:d,grandTotal:h,gst:f,finalTotal:p}},[n,e,s]);return o?a.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsxs("div",{children:[a.jsxs("p",{children:["Name : ",n.siteName]}),a.jsxs("p",{children:["Address : ",n.siteAddress]}),a.jsxs("p",{children:["City : ",(l=n.siteAddress.split(",").pop())==null?void 0:l.trim()]})]}),a.jsxs("div",{className:"border border-black",children:[a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),a.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),a.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),a.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),a.jsxs("div",{className:"grid grid-cols-2",children:[a.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),a.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),a.jsx("div",{className:"my-4 flex justify-center",children:a.jsx(Qr,{className:"h-10"})}),a.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),a.jsxs("table",{className:"w-full border-collapse border border-black",children:[a.jsx("thead",{children:a.jsxs("tr",{className:"font-bold bg-gray-200",children:[a.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),a.jsx("td",{className:"border p-1 border-black",children:"Description"}),a.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),a.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),a.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),a.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),a.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),a.jsxs("tbody",{children:[a.jsx("tr",{children:a.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",Ce(new Date(n.statementMonth),"MM/yyyy")," to ",Ce(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((c,d)=>{const h=c.deployment*c.ratePerMonth,f=c.description.toLowerCase().includes("deduction"),p=c.deployment===0;return a.jsxs("tr",{children:[a.jsx("td",{className:"border p-1 border-black text-center",children:d+1}),a.jsx("td",{className:`border p-1 border-black ${f?"text-red-600":""}`,children:c.description}),a.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":c.deployment}),a.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":c.noOfDays}),a.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":i(c.ratePerDay)}),a.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":i(c.ratePerMonth)}),a.jsx("td",{className:`border p-1 border-black text-right ${f?"text-red-600":""}`,children:i(h)})]},c.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((c,d)=>a.jsx("tr",{children:a.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${d}`))]}),a.jsxs("tfoot",{children:[a.jsxs("tr",{children:[a.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:i(o.subTotal)})]}),a.jsxs("tr",{children:[a.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i(o.serviceCharge)})]}),a.jsxs("tr",{className:"no-print",children:[a.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a.jsx(he,{type:"number",value:e,onChange:c=>t(parseFloat(c.target.value)||0),className:"text-right !p-1"})})]}),a.jsxs("tr",{children:[a.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:i(o.grandTotal)})]}),a.jsxs("tr",{children:[a.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i(o.gst)})]}),a.jsxs("tr",{children:[a.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),a.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i(o.gst)})]}),a.jsxs("tr",{children:[a.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),a.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[a.jsx("span",{className:"print-only",children:i(s)}),a.jsx("span",{className:"no-print",children:a.jsx(he,{type:"number",step:"0.01",value:s,onChange:c=>r(parseFloat(c.target.value)||0),className:"text-right !p-1"})})]})]}),a.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[a.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),a.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:i(o.finalTotal)})]})]})]})]}):null},oae=()=>{var O;const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState(!1),[o,l]=C.useState(Ce(new Date,"yyyy-MM")),[c,d]=C.useState({}),[h,f]=C.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[p,g]=C.useState(0),[b,v]=C.useState(.2),[_,N]=C.useState(null),j=C.useRef(null),[k,S]=C.useState(!1);C.useEffect(()=>{te.getOrganizations().then(D=>e(D.sort((z,H)=>z.shortName.localeCompare(H.shortName)))).catch(()=>N({message:"Failed to load sites.",type:"error"})).finally(()=>s(!1))},[]);const P=C.useCallback(async D=>{i(!0);try{const z=new Date(D+"-02"),H=await te.getInvoiceStatuses(z);d(H)}catch{N({message:"Failed to fetch invoice statuses.",type:"error"})}finally{i(!1)}},[]);C.useEffect(()=>{o&&P(o)},[o,P]);const E=async D=>{f({isOpen:!0,site:D,invoiceData:null,isLoading:!0});try{const z=new Date(o+"-02"),H=await te.getInvoiceSummaryData(D.id,z);f({isOpen:!0,site:D,invoiceData:H,isLoading:!1})}catch{N({message:"Failed to fetch invoice data.",type:"error"}),f({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},M=async()=>{const D=j.current;if(!D||!h.invoiceData){N({message:"Could not find invoice to export.",type:"error"});return}S(!0);try{const z=D.outerHTML,H={margin:.25,filename:`Invoice_${h.invoiceData.siteName.replace(" ","_")}_${h.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await te.generatePdf(z,H)}catch(z){console.error("PDF generation failed:",z),N({message:"Failed to generate PDF.",type:"error"})}finally{S(!1)}},I=()=>{f({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),g(0),v(.2)};return t?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsxs("div",{className:"p-4 md:p-0",children:[_&&a.jsx(gt,{message:_.message,type:_.type,onDismiss:()=>N(null)}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx(ur,{title:"Invoice Summary"}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[a.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),a.jsx("div",{className:"md:w-56",children:a.jsx(he,{label:"",id:"month-select",type:"month",value:o,onChange:D=>l(D.target.value)})})]}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),a.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),a.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(D=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:D.shortName}),a.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:r?a.jsx(Qe,{className:"h-4 w-4 animate-spin"}):a.jsx(iae,{status:c[D.id]})}),a.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:a.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>E(D),disabled:c[D.id]==="Not Generated"||r,title:"View Invoice",children:a.jsx(ca,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>E(D),disabled:c[D.id]==="Not Generated"||r,title:"Download Invoice",children:a.jsx(or,{className:"h-4 w-4"})})]})})]},D.id))})]})})]})]}),h.isOpen&&a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:I,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:D=>D.stopPropagation(),children:[a.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[a.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",(O=h.site)==null?void 0:O.shortName]}),a.jsx(Y,{variant:"icon",onClick:I,children:a.jsx(Us,{className:"h-5 w-5"})})]}),a.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:h.isLoading?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):h.invoiceData?a.jsx("div",{ref:j,children:a.jsx(aae,{invoiceData:h.invoiceData,discount:p,setDiscount:g,roundOff:b,setRoundOff:v})}):a.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),a.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:a.jsxs(Y,{onClick:M,disabled:!h.invoiceData||k,children:[k?a.jsx(Qe,{className:"mr-2 h-4 w-4 animate-spin"}):a.jsx(or,{className:"mr-2 h-4 w-4"}),k?"Generating...":"Download PDF"]})})]})})]})};var f0={exports:{}};/* @preserve
 * Leaflet 1.9.4, a JS library for interactive maps. https://leafletjs.com
 * (c) 2010-2023 Vladimir Agafonkin, (c) 2010-2011 CloudMade
 */(function(n,e){(function(t,s){s(e)})(NT,function(t){var s="1.9.4";function r(u){var m,w,T,A;for(w=1,T=arguments.length;w<T;w++){A=arguments[w];for(m in A)u[m]=A[m]}return u}var i=Object.create||function(){function u(){}return function(m){return u.prototype=m,new u}}();function o(u,m){var w=Array.prototype.slice;if(u.bind)return u.bind.apply(u,w.call(arguments,1));var T=w.call(arguments,2);return function(){return u.apply(m,T.length?T.concat(w.call(arguments)):arguments)}}var l=0;function c(u){return"_leaflet_id"in u||(u._leaflet_id=++l),u._leaflet_id}function d(u,m,w){var T,A,$,ee;return ee=function(){T=!1,A&&($.apply(w,A),A=!1)},$=function(){T?A=arguments:(u.apply(w,arguments),setTimeout(ee,m),T=!0)},$}function h(u,m,w){var T=m[1],A=m[0],$=T-A;return u===T&&w?u:((u-A)%$+$)%$+A}function f(){return!1}function p(u,m){if(m===!1)return u;var w=Math.pow(10,m===void 0?6:m);return Math.round(u*w)/w}function g(u){return u.trim?u.trim():u.replace(/^\s+|\s+$/g,"")}function b(u){return g(u).split(/\s+/)}function v(u,m){Object.prototype.hasOwnProperty.call(u,"options")||(u.options=u.options?i(u.options):{});for(var w in m)u.options[w]=m[w];return u.options}function _(u,m,w){var T=[];for(var A in u)T.push(encodeURIComponent(w?A.toUpperCase():A)+"="+encodeURIComponent(u[A]));return(!m||m.indexOf("?")===-1?"?":"&")+T.join("&")}var N=/\{ *([\w_ -]+) *\}/g;function j(u,m){return u.replace(N,function(w,T){var A=m[T];if(A===void 0)throw new Error("No value provided for variable "+w);return typeof A=="function"&&(A=A(m)),A})}var k=Array.isArray||function(u){return Object.prototype.toString.call(u)==="[object Array]"};function S(u,m){for(var w=0;w<u.length;w++)if(u[w]===m)return w;return-1}var P="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function E(u){return window["webkit"+u]||window["moz"+u]||window["ms"+u]}var M=0;function I(u){var m=+new Date,w=Math.max(0,16-(m-M));return M=m+w,window.setTimeout(u,w)}var O=window.requestAnimationFrame||E("RequestAnimationFrame")||I,D=window.cancelAnimationFrame||E("CancelAnimationFrame")||E("CancelRequestAnimationFrame")||function(u){window.clearTimeout(u)};function z(u,m,w){if(w&&O===I)u.call(m);else return O.call(window,o(u,m))}function H(u){u&&D.call(window,u)}var F={__proto__:null,extend:r,create:i,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:f,formatNum:p,trim:g,splitWords:b,setOptions:v,getParamString:_,template:j,isArray:k,indexOf:S,emptyImageUrl:P,requestFn:O,cancelFn:D,requestAnimFrame:z,cancelAnimFrame:H};function R(){}R.extend=function(u){var m=function(){v(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},w=m.__super__=this.prototype,T=i(w);T.constructor=m,m.prototype=T;for(var A in this)Object.prototype.hasOwnProperty.call(this,A)&&A!=="prototype"&&A!=="__super__"&&(m[A]=this[A]);return u.statics&&r(m,u.statics),u.includes&&(V(u.includes),r.apply(null,[T].concat(u.includes))),r(T,u),delete T.statics,delete T.includes,T.options&&(T.options=w.options?i(w.options):{},r(T.options,u.options)),T._initHooks=[],T.callInitHooks=function(){if(!this._initHooksCalled){w.callInitHooks&&w.callInitHooks.call(this),this._initHooksCalled=!0;for(var $=0,ee=T._initHooks.length;$<ee;$++)T._initHooks[$].call(this)}},m},R.include=function(u){var m=this.prototype.options;return r(this.prototype,u),u.options&&(this.prototype.options=m,this.mergeOptions(u.options)),this},R.mergeOptions=function(u){return r(this.prototype.options,u),this},R.addInitHook=function(u){var m=Array.prototype.slice.call(arguments,1),w=typeof u=="function"?u:function(){this[u].apply(this,m)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(w),this};function V(u){if(!(typeof L>"u"||!L||!L.Mixin)){u=k(u)?u:[u];for(var m=0;m<u.length;m++)u[m]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var U={on:function(u,m,w){if(typeof u=="object")for(var T in u)this._on(T,u[T],m);else{u=b(u);for(var A=0,$=u.length;A<$;A++)this._on(u[A],m,w)}return this},off:function(u,m,w){if(!arguments.length)delete this._events;else if(typeof u=="object")for(var T in u)this._off(T,u[T],m);else{u=b(u);for(var A=arguments.length===1,$=0,ee=u.length;$<ee;$++)A?this._off(u[$]):this._off(u[$],m,w)}return this},_on:function(u,m,w,T){if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}if(this._listens(u,m,w)===!1){w===this&&(w=void 0);var A={fn:m,ctx:w};T&&(A.once=!0),this._events=this._events||{},this._events[u]=this._events[u]||[],this._events[u].push(A)}},_off:function(u,m,w){var T,A,$;if(this._events&&(T=this._events[u],!!T)){if(arguments.length===1){if(this._firingCount)for(A=0,$=T.length;A<$;A++)T[A].fn=f;delete this._events[u];return}if(typeof m!="function"){console.warn("wrong listener type: "+typeof m);return}var ee=this._listens(u,m,w);if(ee!==!1){var ue=T[ee];this._firingCount&&(ue.fn=f,this._events[u]=T=T.slice()),T.splice(ee,1)}}},fire:function(u,m,w){if(!this.listens(u,w))return this;var T=r({},m,{type:u,target:this,sourceTarget:m&&m.sourceTarget||this});if(this._events){var A=this._events[u];if(A){this._firingCount=this._firingCount+1||1;for(var $=0,ee=A.length;$<ee;$++){var ue=A[$],me=ue.fn;ue.once&&this.off(u,me,ue.ctx),me.call(ue.ctx||this,T)}this._firingCount--}}return w&&this._propagateEvent(T),this},listens:function(u,m,w,T){typeof u!="string"&&console.warn('"string" type argument expected');var A=m;typeof m!="function"&&(T=!!m,A=void 0,w=void 0);var $=this._events&&this._events[u];if($&&$.length&&this._listens(u,A,w)!==!1)return!0;if(T){for(var ee in this._eventParents)if(this._eventParents[ee].listens(u,m,w,T))return!0}return!1},_listens:function(u,m,w){if(!this._events)return!1;var T=this._events[u]||[];if(!m)return!!T.length;w===this&&(w=void 0);for(var A=0,$=T.length;A<$;A++)if(T[A].fn===m&&T[A].ctx===w)return A;return!1},once:function(u,m,w){if(typeof u=="object")for(var T in u)this._on(T,u[T],m,!0);else{u=b(u);for(var A=0,$=u.length;A<$;A++)this._on(u[A],m,w,!0)}return this},addEventParent:function(u){return this._eventParents=this._eventParents||{},this._eventParents[c(u)]=u,this},removeEventParent:function(u){return this._eventParents&&delete this._eventParents[c(u)],this},_propagateEvent:function(u){for(var m in this._eventParents)this._eventParents[m].fire(u.type,r({layer:u.target,propagatedFrom:u.target},u),!0)}};U.addEventListener=U.on,U.removeEventListener=U.clearAllEventListeners=U.off,U.addOneTimeEventListener=U.once,U.fireEvent=U.fire,U.hasEventListeners=U.listens;var W=R.extend(U);function B(u,m,w){this.x=w?Math.round(u):u,this.y=w?Math.round(m):m}var q=Math.trunc||function(u){return u>0?Math.floor(u):Math.ceil(u)};B.prototype={clone:function(){return new B(this.x,this.y)},add:function(u){return this.clone()._add(Q(u))},_add:function(u){return this.x+=u.x,this.y+=u.y,this},subtract:function(u){return this.clone()._subtract(Q(u))},_subtract:function(u){return this.x-=u.x,this.y-=u.y,this},divideBy:function(u){return this.clone()._divideBy(u)},_divideBy:function(u){return this.x/=u,this.y/=u,this},multiplyBy:function(u){return this.clone()._multiplyBy(u)},_multiplyBy:function(u){return this.x*=u,this.y*=u,this},scaleBy:function(u){return new B(this.x*u.x,this.y*u.y)},unscaleBy:function(u){return new B(this.x/u.x,this.y/u.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=q(this.x),this.y=q(this.y),this},distanceTo:function(u){u=Q(u);var m=u.x-this.x,w=u.y-this.y;return Math.sqrt(m*m+w*w)},equals:function(u){return u=Q(u),u.x===this.x&&u.y===this.y},contains:function(u){return u=Q(u),Math.abs(u.x)<=Math.abs(this.x)&&Math.abs(u.y)<=Math.abs(this.y)},toString:function(){return"Point("+p(this.x)+", "+p(this.y)+")"}};function Q(u,m,w){return u instanceof B?u:k(u)?new B(u[0],u[1]):u==null?u:typeof u=="object"&&"x"in u&&"y"in u?new B(u.x,u.y):new B(u,m,w)}function le(u,m){if(u)for(var w=m?[u,m]:u,T=0,A=w.length;T<A;T++)this.extend(w[T])}le.prototype={extend:function(u){var m,w;if(!u)return this;if(u instanceof B||typeof u[0]=="number"||"x"in u)m=w=Q(u);else if(u=X(u),m=u.min,w=u.max,!m||!w)return this;return!this.min&&!this.max?(this.min=m.clone(),this.max=w.clone()):(this.min.x=Math.min(m.x,this.min.x),this.max.x=Math.max(w.x,this.max.x),this.min.y=Math.min(m.y,this.min.y),this.max.y=Math.max(w.y,this.max.y)),this},getCenter:function(u){return Q((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,u)},getBottomLeft:function(){return Q(this.min.x,this.max.y)},getTopRight:function(){return Q(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(u){var m,w;return typeof u[0]=="number"||u instanceof B?u=Q(u):u=X(u),u instanceof le?(m=u.min,w=u.max):m=w=u,m.x>=this.min.x&&w.x<=this.max.x&&m.y>=this.min.y&&w.y<=this.max.y},intersects:function(u){u=X(u);var m=this.min,w=this.max,T=u.min,A=u.max,$=A.x>=m.x&&T.x<=w.x,ee=A.y>=m.y&&T.y<=w.y;return $&&ee},overlaps:function(u){u=X(u);var m=this.min,w=this.max,T=u.min,A=u.max,$=A.x>m.x&&T.x<w.x,ee=A.y>m.y&&T.y<w.y;return $&&ee},isValid:function(){return!!(this.min&&this.max)},pad:function(u){var m=this.min,w=this.max,T=Math.abs(m.x-w.x)*u,A=Math.abs(m.y-w.y)*u;return X(Q(m.x-T,m.y-A),Q(w.x+T,w.y+A))},equals:function(u){return u?(u=X(u),this.min.equals(u.getTopLeft())&&this.max.equals(u.getBottomRight())):!1}};function X(u,m){return!u||u instanceof le?u:new le(u,m)}function Z(u,m){if(u)for(var w=m?[u,m]:u,T=0,A=w.length;T<A;T++)this.extend(w[T])}Z.prototype={extend:function(u){var m=this._southWest,w=this._northEast,T,A;if(u instanceof G)T=u,A=u;else if(u instanceof Z){if(T=u._southWest,A=u._northEast,!T||!A)return this}else return u?this.extend(ne(u)||se(u)):this;return!m&&!w?(this._southWest=new G(T.lat,T.lng),this._northEast=new G(A.lat,A.lng)):(m.lat=Math.min(T.lat,m.lat),m.lng=Math.min(T.lng,m.lng),w.lat=Math.max(A.lat,w.lat),w.lng=Math.max(A.lng,w.lng)),this},pad:function(u){var m=this._southWest,w=this._northEast,T=Math.abs(m.lat-w.lat)*u,A=Math.abs(m.lng-w.lng)*u;return new Z(new G(m.lat-T,m.lng-A),new G(w.lat+T,w.lng+A))},getCenter:function(){return new G((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new G(this.getNorth(),this.getWest())},getSouthEast:function(){return new G(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(u){typeof u[0]=="number"||u instanceof G||"lat"in u?u=ne(u):u=se(u);var m=this._southWest,w=this._northEast,T,A;return u instanceof Z?(T=u.getSouthWest(),A=u.getNorthEast()):T=A=u,T.lat>=m.lat&&A.lat<=w.lat&&T.lng>=m.lng&&A.lng<=w.lng},intersects:function(u){u=se(u);var m=this._southWest,w=this._northEast,T=u.getSouthWest(),A=u.getNorthEast(),$=A.lat>=m.lat&&T.lat<=w.lat,ee=A.lng>=m.lng&&T.lng<=w.lng;return $&&ee},overlaps:function(u){u=se(u);var m=this._southWest,w=this._northEast,T=u.getSouthWest(),A=u.getNorthEast(),$=A.lat>m.lat&&T.lat<w.lat,ee=A.lng>m.lng&&T.lng<w.lng;return $&&ee},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(u,m){return u?(u=se(u),this._southWest.equals(u.getSouthWest(),m)&&this._northEast.equals(u.getNorthEast(),m)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function se(u,m){return u instanceof Z?u:new Z(u,m)}function G(u,m,w){if(isNaN(u)||isNaN(m))throw new Error("Invalid LatLng object: ("+u+", "+m+")");this.lat=+u,this.lng=+m,w!==void 0&&(this.alt=+w)}G.prototype={equals:function(u,m){if(!u)return!1;u=ne(u);var w=Math.max(Math.abs(this.lat-u.lat),Math.abs(this.lng-u.lng));return w<=(m===void 0?1e-9:m)},toString:function(u){return"LatLng("+p(this.lat,u)+", "+p(this.lng,u)+")"},distanceTo:function(u){return ye.distance(this,ne(u))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(u){var m=180*u/40075017,w=m/Math.cos(Math.PI/180*this.lat);return se([this.lat-m,this.lng-w],[this.lat+m,this.lng+w])},clone:function(){return new G(this.lat,this.lng,this.alt)}};function ne(u,m,w){return u instanceof G?u:k(u)&&typeof u[0]!="object"?u.length===3?new G(u[0],u[1],u[2]):u.length===2?new G(u[0],u[1]):null:u==null?u:typeof u=="object"&&"lat"in u?new G(u.lat,"lng"in u?u.lng:u.lon,u.alt):m===void 0?null:new G(u,m,w)}var ge={latLngToPoint:function(u,m){var w=this.projection.project(u),T=this.scale(m);return this.transformation._transform(w,T)},pointToLatLng:function(u,m){var w=this.scale(m),T=this.transformation.untransform(u,w);return this.projection.unproject(T)},project:function(u){return this.projection.project(u)},unproject:function(u){return this.projection.unproject(u)},scale:function(u){return 256*Math.pow(2,u)},zoom:function(u){return Math.log(u/256)/Math.LN2},getProjectedBounds:function(u){if(this.infinite)return null;var m=this.projection.bounds,w=this.scale(u),T=this.transformation.transform(m.min,w),A=this.transformation.transform(m.max,w);return new le(T,A)},infinite:!1,wrapLatLng:function(u){var m=this.wrapLng?h(u.lng,this.wrapLng,!0):u.lng,w=this.wrapLat?h(u.lat,this.wrapLat,!0):u.lat,T=u.alt;return new G(w,m,T)},wrapLatLngBounds:function(u){var m=u.getCenter(),w=this.wrapLatLng(m),T=m.lat-w.lat,A=m.lng-w.lng;if(T===0&&A===0)return u;var $=u.getSouthWest(),ee=u.getNorthEast(),ue=new G($.lat-T,$.lng-A),me=new G(ee.lat-T,ee.lng-A);return new Z(ue,me)}},ye=r({},ge,{wrapLng:[-180,180],R:6371e3,distance:function(u,m){var w=Math.PI/180,T=u.lat*w,A=m.lat*w,$=Math.sin((m.lat-u.lat)*w/2),ee=Math.sin((m.lng-u.lng)*w/2),ue=$*$+Math.cos(T)*Math.cos(A)*ee*ee,me=2*Math.atan2(Math.sqrt(ue),Math.sqrt(1-ue));return this.R*me}}),re=6378137,ae={R:re,MAX_LATITUDE:85.0511287798,project:function(u){var m=Math.PI/180,w=this.MAX_LATITUDE,T=Math.max(Math.min(w,u.lat),-w),A=Math.sin(T*m);return new B(this.R*u.lng*m,this.R*Math.log((1+A)/(1-A))/2)},unproject:function(u){var m=180/Math.PI;return new G((2*Math.atan(Math.exp(u.y/this.R))-Math.PI/2)*m,u.x*m/this.R)},bounds:function(){var u=re*Math.PI;return new le([-u,-u],[u,u])}()};function ve(u,m,w,T){if(k(u)){this._a=u[0],this._b=u[1],this._c=u[2],this._d=u[3];return}this._a=u,this._b=m,this._c=w,this._d=T}ve.prototype={transform:function(u,m){return this._transform(u.clone(),m)},_transform:function(u,m){return m=m||1,u.x=m*(this._a*u.x+this._b),u.y=m*(this._c*u.y+this._d),u},untransform:function(u,m){return m=m||1,new B((u.x/m-this._b)/this._a,(u.y/m-this._d)/this._c)}};function pe(u,m,w,T){return new ve(u,m,w,T)}var Ne=r({},ye,{code:"EPSG:3857",projection:ae,transformation:function(){var u=.5/(Math.PI*ae.R);return pe(u,.5,-u,.5)}()}),Me=r({},Ne,{code:"EPSG:900913"});function Oe(u){return document.createElementNS("http://www.w3.org/2000/svg",u)}function Je(u,m){var w="",T,A,$,ee,ue,me;for(T=0,$=u.length;T<$;T++){for(ue=u[T],A=0,ee=ue.length;A<ee;A++)me=ue[A],w+=(A?"L":"M")+me.x+" "+me.y;w+=m?We.svg?"z":"x":""}return w||"M0 0"}var dt=document.documentElement.style,at="ActiveXObject"in window,_t=at&&!document.addEventListener,J="msLaunchUri"in navigator&&!("documentMode"in document),K=ni("webkit"),oe=ni("android"),we=ni("android 2")||ni("android 3"),Se=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),_e=oe&&ni("Google")&&Se<537&&!("AudioNode"in window),Pe=!!window.opera,Ue=!J&&ni("chrome"),ht=ni("gecko")&&!K&&!Pe&&!at,Zt=!Ue&&ni("safari"),an=ni("phantom"),$n="OTransition"in dt,Ws=navigator.platform.indexOf("Win")===0,Cs=at&&"transition"in dt,zn="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!we,Bt="MozPerspective"in dt,Gs=!window.L_DISABLE_3D&&(Cs||zn||Bt)&&!$n&&!an,us=typeof orientation<"u"||ni("mobile"),hs=us&&K,bd=us&&zn,zh=!window.PointerEvent&&window.MSPointerEvent,Xe=!!(window.PointerEvent||zh),ti="ontouchstart"in window||!!window.TouchEvent,No=!window.L_NO_TOUCH&&(ti||Xe),Uh=us&&Pe,q_=us&&ht,eO=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,tO=function(){var u=!1;try{var m=Object.defineProperty({},"passive",{get:function(){u=!0}});window.addEventListener("testPassiveEventSupport",f,m),window.removeEventListener("testPassiveEventSupport",f,m)}catch{}return u}(),nO=function(){return!!document.createElement("canvas").getContext}(),ty=!!(document.createElementNS&&Oe("svg").createSVGRect),sO=!!ty&&function(){var u=document.createElement("div");return u.innerHTML="<svg/>",(u.firstChild&&u.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"}(),rO=!ty&&function(){try{var u=document.createElement("div");u.innerHTML='<v:shape adj="1"/>';var m=u.firstChild;return m.style.behavior="url(#default#VML)",m&&typeof m.adj=="object"}catch{return!1}}(),iO=navigator.platform.indexOf("Mac")===0,aO=navigator.platform.indexOf("Linux")===0;function ni(u){return navigator.userAgent.toLowerCase().indexOf(u)>=0}var We={ie:at,ielt9:_t,edge:J,webkit:K,android:oe,android23:we,androidStock:_e,opera:Pe,chrome:Ue,gecko:ht,safari:Zt,phantom:an,opera12:$n,win:Ws,ie3d:Cs,webkit3d:zn,gecko3d:Bt,any3d:Gs,mobile:us,mobileWebkit:hs,mobileWebkit3d:bd,msPointer:zh,pointer:Xe,touch:No,touchNative:ti,mobileOpera:Uh,mobileGecko:q_,retina:eO,passiveEvents:tO,canvas:nO,svg:ty,vml:rO,inlineSvg:sO,mac:iO,linux:aO},H_=We.msPointer?"MSPointerDown":"pointerdown",W_=We.msPointer?"MSPointerMove":"pointermove",G_=We.msPointer?"MSPointerUp":"pointerup",Y_=We.msPointer?"MSPointerCancel":"pointercancel",ny={touchstart:H_,touchmove:W_,touchend:G_,touchcancel:Y_},Z_={touchstart:hO,touchmove:Vh,touchend:Vh,touchcancel:Vh},Ll={},K_=!1;function oO(u,m,w){return m==="touchstart"&&uO(),Z_[m]?(w=Z_[m].bind(this,w),u.addEventListener(ny[m],w,!1),w):(console.warn("wrong event specified:",m),f)}function lO(u,m,w){if(!ny[m]){console.warn("wrong event specified:",m);return}u.removeEventListener(ny[m],w,!1)}function cO(u){Ll[u.pointerId]=u}function dO(u){Ll[u.pointerId]&&(Ll[u.pointerId]=u)}function J_(u){delete Ll[u.pointerId]}function uO(){K_||(document.addEventListener(H_,cO,!0),document.addEventListener(W_,dO,!0),document.addEventListener(G_,J_,!0),document.addEventListener(Y_,J_,!0),K_=!0)}function Vh(u,m){if(m.pointerType!==(m.MSPOINTER_TYPE_MOUSE||"mouse")){m.touches=[];for(var w in Ll)m.touches.push(Ll[w]);m.changedTouches=[m],u(m)}}function hO(u,m){m.MSPOINTER_TYPE_TOUCH&&m.pointerType===m.MSPOINTER_TYPE_TOUCH&&Hn(m),Vh(u,m)}function fO(u){var m={},w,T;for(T in u)w=u[T],m[T]=w&&w.bind?w.bind(u):w;return u=m,m.type="dblclick",m.detail=2,m.isTrusted=!1,m._simulated=!0,m}var mO=200;function pO(u,m){u.addEventListener("dblclick",m);var w=0,T;function A($){if($.detail!==1){T=$.detail;return}if(!($.pointerType==="mouse"||$.sourceCapabilities&&!$.sourceCapabilities.firesTouchEvents)){var ee=nS($);if(!(ee.some(function(me){return me instanceof HTMLLabelElement&&me.attributes.for})&&!ee.some(function(me){return me instanceof HTMLInputElement||me instanceof HTMLSelectElement}))){var ue=Date.now();ue-w<=mO?(T++,T===2&&m(fO($))):T=1,w=ue}}}return u.addEventListener("click",A),{dblclick:m,simDblclick:A}}function gO(u,m){u.removeEventListener("dblclick",m.dblclick),u.removeEventListener("click",m.simDblclick)}var sy=Hh(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),wd=Hh(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),Q_=wd==="webkitTransition"||wd==="OTransition"?wd+"End":"transitionend";function X_(u){return typeof u=="string"?document.getElementById(u):u}function _d(u,m){var w=u.style[m]||u.currentStyle&&u.currentStyle[m];if((!w||w==="auto")&&document.defaultView){var T=document.defaultView.getComputedStyle(u,null);w=T?T[m]:null}return w==="auto"?null:w}function Tt(u,m,w){var T=document.createElement(u);return T.className=m||"",w&&w.appendChild(T),T}function on(u){var m=u.parentNode;m&&m.removeChild(u)}function Bh(u){for(;u.firstChild;)u.removeChild(u.firstChild)}function Fl(u){var m=u.parentNode;m&&m.lastChild!==u&&m.appendChild(u)}function $l(u){var m=u.parentNode;m&&m.firstChild!==u&&m.insertBefore(u,m.firstChild)}function ry(u,m){if(u.classList!==void 0)return u.classList.contains(m);var w=qh(u);return w.length>0&&new RegExp("(^|\\s)"+m+"(\\s|$)").test(w)}function ft(u,m){if(u.classList!==void 0)for(var w=b(m),T=0,A=w.length;T<A;T++)u.classList.add(w[T]);else if(!ry(u,m)){var $=qh(u);iy(u,($?$+" ":"")+m)}}function vn(u,m){u.classList!==void 0?u.classList.remove(m):iy(u,g((" "+qh(u)+" ").replace(" "+m+" "," ")))}function iy(u,m){u.className.baseVal===void 0?u.className=m:u.className.baseVal=m}function qh(u){return u.correspondingElement&&(u=u.correspondingElement),u.className.baseVal===void 0?u.className:u.className.baseVal}function hr(u,m){"opacity"in u.style?u.style.opacity=m:"filter"in u.style&&yO(u,m)}function yO(u,m){var w=!1,T="DXImageTransform.Microsoft.Alpha";try{w=u.filters.item(T)}catch{if(m===1)return}m=Math.round(m*100),w?(w.Enabled=m!==100,w.Opacity=m):u.style.filter+=" progid:"+T+"(opacity="+m+")"}function Hh(u){for(var m=document.documentElement.style,w=0;w<u.length;w++)if(u[w]in m)return u[w];return!1}function jo(u,m,w){var T=m||new B(0,0);u.style[sy]=(We.ie3d?"translate("+T.x+"px,"+T.y+"px)":"translate3d("+T.x+"px,"+T.y+"px,0)")+(w?" scale("+w+")":"")}function jn(u,m){u._leaflet_pos=m,We.any3d?jo(u,m):(u.style.left=m.x+"px",u.style.top=m.y+"px")}function Co(u){return u._leaflet_pos||new B(0,0)}var Sd,Nd,ay;if("onselectstart"in document)Sd=function(){ut(window,"selectstart",Hn)},Nd=function(){qt(window,"selectstart",Hn)};else{var jd=Hh(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Sd=function(){if(jd){var u=document.documentElement.style;ay=u[jd],u[jd]="none"}},Nd=function(){jd&&(document.documentElement.style[jd]=ay,ay=void 0)}}function oy(){ut(window,"dragstart",Hn)}function ly(){qt(window,"dragstart",Hn)}var Wh,cy;function dy(u){for(;u.tabIndex===-1;)u=u.parentNode;u.style&&(Gh(),Wh=u,cy=u.style.outlineStyle,u.style.outlineStyle="none",ut(window,"keydown",Gh))}function Gh(){Wh&&(Wh.style.outlineStyle=cy,Wh=void 0,cy=void 0,qt(window,"keydown",Gh))}function eS(u){do u=u.parentNode;while((!u.offsetWidth||!u.offsetHeight)&&u!==document.body);return u}function uy(u){var m=u.getBoundingClientRect();return{x:m.width/u.offsetWidth||1,y:m.height/u.offsetHeight||1,boundingClientRect:m}}var xO={__proto__:null,TRANSFORM:sy,TRANSITION:wd,TRANSITION_END:Q_,get:X_,getStyle:_d,create:Tt,remove:on,empty:Bh,toFront:Fl,toBack:$l,hasClass:ry,addClass:ft,removeClass:vn,setClass:iy,getClass:qh,setOpacity:hr,testProp:Hh,setTransform:jo,setPosition:jn,getPosition:Co,get disableTextSelection(){return Sd},get enableTextSelection(){return Nd},disableImageDrag:oy,enableImageDrag:ly,preventOutline:dy,restoreOutline:Gh,getSizedParentNode:eS,getScale:uy};function ut(u,m,w,T){if(m&&typeof m=="object")for(var A in m)fy(u,A,m[A],w);else{m=b(m);for(var $=0,ee=m.length;$<ee;$++)fy(u,m[$],w,T)}return this}var si="_leaflet_events";function qt(u,m,w,T){if(arguments.length===1)tS(u),delete u[si];else if(m&&typeof m=="object")for(var A in m)my(u,A,m[A],w);else if(m=b(m),arguments.length===2)tS(u,function(ue){return S(m,ue)!==-1});else for(var $=0,ee=m.length;$<ee;$++)my(u,m[$],w,T);return this}function tS(u,m){for(var w in u[si]){var T=w.split(/\d/)[0];(!m||m(T))&&my(u,T,null,null,w)}}var hy={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function fy(u,m,w,T){var A=m+c(w)+(T?"_"+c(T):"");if(u[si]&&u[si][A])return this;var $=function(ue){return w.call(T||u,ue||window.event)},ee=$;!We.touchNative&&We.pointer&&m.indexOf("touch")===0?$=oO(u,m,$):We.touch&&m==="dblclick"?$=pO(u,$):"addEventListener"in u?m==="touchstart"||m==="touchmove"||m==="wheel"||m==="mousewheel"?u.addEventListener(hy[m]||m,$,We.passiveEvents?{passive:!1}:!1):m==="mouseenter"||m==="mouseleave"?($=function(ue){ue=ue||window.event,gy(u,ue)&&ee(ue)},u.addEventListener(hy[m],$,!1)):u.addEventListener(m,ee,!1):u.attachEvent("on"+m,$),u[si]=u[si]||{},u[si][A]=$}function my(u,m,w,T,A){A=A||m+c(w)+(T?"_"+c(T):"");var $=u[si]&&u[si][A];if(!$)return this;!We.touchNative&&We.pointer&&m.indexOf("touch")===0?lO(u,m,$):We.touch&&m==="dblclick"?gO(u,$):"removeEventListener"in u?u.removeEventListener(hy[m]||m,$,!1):u.detachEvent("on"+m,$),u[si][A]=null}function ko(u){return u.stopPropagation?u.stopPropagation():u.originalEvent?u.originalEvent._stopped=!0:u.cancelBubble=!0,this}function py(u){return fy(u,"wheel",ko),this}function Cd(u){return ut(u,"mousedown touchstart dblclick contextmenu",ko),u._leaflet_disable_click=!0,this}function Hn(u){return u.preventDefault?u.preventDefault():u.returnValue=!1,this}function To(u){return Hn(u),ko(u),this}function nS(u){if(u.composedPath)return u.composedPath();for(var m=[],w=u.target;w;)m.push(w),w=w.parentNode;return m}function sS(u,m){if(!m)return new B(u.clientX,u.clientY);var w=uy(m),T=w.boundingClientRect;return new B((u.clientX-T.left)/w.x-m.clientLeft,(u.clientY-T.top)/w.y-m.clientTop)}var vO=We.linux&&We.chrome?window.devicePixelRatio:We.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function rS(u){return We.edge?u.wheelDeltaY/2:u.deltaY&&u.deltaMode===0?-u.deltaY/vO:u.deltaY&&u.deltaMode===1?-u.deltaY*20:u.deltaY&&u.deltaMode===2?-u.deltaY*60:u.deltaX||u.deltaZ?0:u.wheelDelta?(u.wheelDeltaY||u.wheelDelta)/2:u.detail&&Math.abs(u.detail)<32765?-u.detail*20:u.detail?u.detail/-32765*60:0}function gy(u,m){var w=m.relatedTarget;if(!w)return!0;try{for(;w&&w!==u;)w=w.parentNode}catch{return!1}return w!==u}var bO={__proto__:null,on:ut,off:qt,stopPropagation:ko,disableScrollPropagation:py,disableClickPropagation:Cd,preventDefault:Hn,stop:To,getPropagationPath:nS,getMousePosition:sS,getWheelDelta:rS,isExternalTarget:gy,addListener:ut,removeListener:qt},iS=W.extend({run:function(u,m,w,T){this.stop(),this._el=u,this._inProgress=!0,this._duration=w||.25,this._easeOutPower=1/Math.max(T||.5,.2),this._startPos=Co(u),this._offset=m.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=z(this._animate,this),this._step()},_step:function(u){var m=+new Date-this._startTime,w=this._duration*1e3;m<w?this._runFrame(this._easeOut(m/w),u):(this._runFrame(1),this._complete())},_runFrame:function(u,m){var w=this._startPos.add(this._offset.multiplyBy(u));m&&w._round(),jn(this._el,w),this.fire("step")},_complete:function(){H(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(u){return 1-Math.pow(1-u,this._easeOutPower)}}),St=W.extend({options:{crs:Ne,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(u,m){m=v(this,m),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(u),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),m.maxBounds&&this.setMaxBounds(m.maxBounds),m.zoom!==void 0&&(this._zoom=this._limitZoom(m.zoom)),m.center&&m.zoom!==void 0&&this.setView(ne(m.center),m.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=wd&&We.any3d&&!We.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),ut(this._proxy,Q_,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(u,m,w){if(m=m===void 0?this._zoom:this._limitZoom(m),u=this._limitCenter(ne(u),m,this.options.maxBounds),w=w||{},this._stop(),this._loaded&&!w.reset&&w!==!0){w.animate!==void 0&&(w.zoom=r({animate:w.animate},w.zoom),w.pan=r({animate:w.animate,duration:w.duration},w.pan));var T=this._zoom!==m?this._tryAnimatedZoom&&this._tryAnimatedZoom(u,m,w.zoom):this._tryAnimatedPan(u,w.pan);if(T)return clearTimeout(this._sizeTimer),this}return this._resetView(u,m,w.pan&&w.pan.noMoveStart),this},setZoom:function(u,m){return this._loaded?this.setView(this.getCenter(),u,{zoom:m}):(this._zoom=u,this)},zoomIn:function(u,m){return u=u||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+u,m)},zoomOut:function(u,m){return u=u||(We.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-u,m)},setZoomAround:function(u,m,w){var T=this.getZoomScale(m),A=this.getSize().divideBy(2),$=u instanceof B?u:this.latLngToContainerPoint(u),ee=$.subtract(A).multiplyBy(1-1/T),ue=this.containerPointToLatLng(A.add(ee));return this.setView(ue,m,{zoom:w})},_getBoundsCenterZoom:function(u,m){m=m||{},u=u.getBounds?u.getBounds():se(u);var w=Q(m.paddingTopLeft||m.padding||[0,0]),T=Q(m.paddingBottomRight||m.padding||[0,0]),A=this.getBoundsZoom(u,!1,w.add(T));if(A=typeof m.maxZoom=="number"?Math.min(m.maxZoom,A):A,A===1/0)return{center:u.getCenter(),zoom:A};var $=T.subtract(w).divideBy(2),ee=this.project(u.getSouthWest(),A),ue=this.project(u.getNorthEast(),A),me=this.unproject(ee.add(ue).divideBy(2).add($),A);return{center:me,zoom:A}},fitBounds:function(u,m){if(u=se(u),!u.isValid())throw new Error("Bounds are not valid.");var w=this._getBoundsCenterZoom(u,m);return this.setView(w.center,w.zoom,m)},fitWorld:function(u){return this.fitBounds([[-90,-180],[90,180]],u)},panTo:function(u,m){return this.setView(u,this._zoom,{pan:m})},panBy:function(u,m){if(u=Q(u).round(),m=m||{},!u.x&&!u.y)return this.fire("moveend");if(m.animate!==!0&&!this.getSize().contains(u))return this._resetView(this.unproject(this.project(this.getCenter()).add(u)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new iS,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),m.noMoveStart||this.fire("movestart"),m.animate!==!1){ft(this._mapPane,"leaflet-pan-anim");var w=this._getMapPanePos().subtract(u).round();this._panAnim.run(this._mapPane,w,m.duration||.25,m.easeLinearity)}else this._rawPanBy(u),this.fire("move").fire("moveend");return this},flyTo:function(u,m,w){if(w=w||{},w.animate===!1||!We.any3d)return this.setView(u,m,w);this._stop();var T=this.project(this.getCenter()),A=this.project(u),$=this.getSize(),ee=this._zoom;u=ne(u),m=m===void 0?ee:m;var ue=Math.max($.x,$.y),me=ue*this.getZoomScale(ee,m),je=A.distanceTo(T)||1,Le=1.42,et=Le*Le;function yt(Cn){var af=Cn?-1:1,lR=Cn?me:ue,cR=me*me-ue*ue+af*et*et*je*je,dR=2*lR*et*je,ky=cR/dR,$S=Math.sqrt(ky*ky+1)-ky,uR=$S<1e-9?-18:Math.log($S);return uR}function fs(Cn){return(Math.exp(Cn)-Math.exp(-Cn))/2}function Un(Cn){return(Math.exp(Cn)+Math.exp(-Cn))/2}function mr(Cn){return fs(Cn)/Un(Cn)}var ks=yt(0);function Hl(Cn){return ue*(Un(ks)/Un(ks+Le*Cn))}function rR(Cn){return ue*(Un(ks)*mr(ks+Le*Cn)-fs(ks))/et}function iR(Cn){return 1-Math.pow(1-Cn,1.5)}var aR=Date.now(),LS=(yt(1)-ks)/Le,oR=w.duration?1e3*w.duration:1e3*LS*.8;function FS(){var Cn=(Date.now()-aR)/oR,af=iR(Cn)*LS;Cn<=1?(this._flyToFrame=z(FS,this),this._move(this.unproject(T.add(A.subtract(T).multiplyBy(rR(af)/je)),ee),this.getScaleZoom(ue/Hl(af),ee),{flyTo:!0})):this._move(u,m)._moveEnd(!0)}return this._moveStart(!0,w.noMoveStart),FS.call(this),this},flyToBounds:function(u,m){var w=this._getBoundsCenterZoom(u,m);return this.flyTo(w.center,w.zoom,m)},setMaxBounds:function(u){return u=se(u),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),u.isValid()?(this.options.maxBounds=u,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(u){var m=this.options.minZoom;return this.options.minZoom=u,this._loaded&&m!==u&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(u):this},setMaxZoom:function(u){var m=this.options.maxZoom;return this.options.maxZoom=u,this._loaded&&m!==u&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(u):this},panInsideBounds:function(u,m){this._enforcingBounds=!0;var w=this.getCenter(),T=this._limitCenter(w,this._zoom,se(u));return w.equals(T)||this.panTo(T,m),this._enforcingBounds=!1,this},panInside:function(u,m){m=m||{};var w=Q(m.paddingTopLeft||m.padding||[0,0]),T=Q(m.paddingBottomRight||m.padding||[0,0]),A=this.project(this.getCenter()),$=this.project(u),ee=this.getPixelBounds(),ue=X([ee.min.add(w),ee.max.subtract(T)]),me=ue.getSize();if(!ue.contains($)){this._enforcingBounds=!0;var je=$.subtract(ue.getCenter()),Le=ue.extend($).getSize().subtract(me);A.x+=je.x<0?-Le.x:Le.x,A.y+=je.y<0?-Le.y:Le.y,this.panTo(this.unproject(A),m),this._enforcingBounds=!1}return this},invalidateSize:function(u){if(!this._loaded)return this;u=r({animate:!1,pan:!0},u===!0?{animate:!0}:u);var m=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var w=this.getSize(),T=m.divideBy(2).round(),A=w.divideBy(2).round(),$=T.subtract(A);return!$.x&&!$.y?this:(u.animate&&u.pan?this.panBy($):(u.pan&&this._rawPanBy($),this.fire("move"),u.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:m,newSize:w}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(u){if(u=this._locateOptions=r({timeout:1e4,watch:!1},u),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var m=o(this._handleGeolocationResponse,this),w=o(this._handleGeolocationError,this);return u.watch?this._locationWatchId=navigator.geolocation.watchPosition(m,w,u):navigator.geolocation.getCurrentPosition(m,w,u),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(u){if(this._container._leaflet_id){var m=u.code,w=u.message||(m===1?"permission denied":m===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:m,message:"Geolocation error: "+w+"."})}},_handleGeolocationResponse:function(u){if(this._container._leaflet_id){var m=u.coords.latitude,w=u.coords.longitude,T=new G(m,w),A=T.toBounds(u.coords.accuracy*2),$=this._locateOptions;if($.setView){var ee=this.getBoundsZoom(A);this.setView(T,$.maxZoom?Math.min(ee,$.maxZoom):ee)}var ue={latlng:T,bounds:A,timestamp:u.timestamp};for(var me in u.coords)typeof u.coords[me]=="number"&&(ue[me]=u.coords[me]);this.fire("locationfound",ue)}},addHandler:function(u,m){if(!m)return this;var w=this[u]=new m(this);return this._handlers.push(w),this.options[u]&&w.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),on(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(H(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var u;for(u in this._layers)this._layers[u].remove();for(u in this._panes)on(this._panes[u]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(u,m){var w="leaflet-pane"+(u?" leaflet-"+u.replace("Pane","")+"-pane":""),T=Tt("div",w,m||this._mapPane);return u&&(this._panes[u]=T),T},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var u=this.getPixelBounds(),m=this.unproject(u.getBottomLeft()),w=this.unproject(u.getTopRight());return new Z(m,w)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(u,m,w){u=se(u),w=Q(w||[0,0]);var T=this.getZoom()||0,A=this.getMinZoom(),$=this.getMaxZoom(),ee=u.getNorthWest(),ue=u.getSouthEast(),me=this.getSize().subtract(w),je=X(this.project(ue,T),this.project(ee,T)).getSize(),Le=We.any3d?this.options.zoomSnap:1,et=me.x/je.x,yt=me.y/je.y,fs=m?Math.max(et,yt):Math.min(et,yt);return T=this.getScaleZoom(fs,T),Le&&(T=Math.round(T/(Le/100))*(Le/100),T=m?Math.ceil(T/Le)*Le:Math.floor(T/Le)*Le),Math.max(A,Math.min($,T))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new B(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(u,m){var w=this._getTopLeftPoint(u,m);return new le(w,w.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(u){return this.options.crs.getProjectedBounds(u===void 0?this.getZoom():u)},getPane:function(u){return typeof u=="string"?this._panes[u]:u},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(u,m){var w=this.options.crs;return m=m===void 0?this._zoom:m,w.scale(u)/w.scale(m)},getScaleZoom:function(u,m){var w=this.options.crs;m=m===void 0?this._zoom:m;var T=w.zoom(u*w.scale(m));return isNaN(T)?1/0:T},project:function(u,m){return m=m===void 0?this._zoom:m,this.options.crs.latLngToPoint(ne(u),m)},unproject:function(u,m){return m=m===void 0?this._zoom:m,this.options.crs.pointToLatLng(Q(u),m)},layerPointToLatLng:function(u){var m=Q(u).add(this.getPixelOrigin());return this.unproject(m)},latLngToLayerPoint:function(u){var m=this.project(ne(u))._round();return m._subtract(this.getPixelOrigin())},wrapLatLng:function(u){return this.options.crs.wrapLatLng(ne(u))},wrapLatLngBounds:function(u){return this.options.crs.wrapLatLngBounds(se(u))},distance:function(u,m){return this.options.crs.distance(ne(u),ne(m))},containerPointToLayerPoint:function(u){return Q(u).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(u){return Q(u).add(this._getMapPanePos())},containerPointToLatLng:function(u){var m=this.containerPointToLayerPoint(Q(u));return this.layerPointToLatLng(m)},latLngToContainerPoint:function(u){return this.layerPointToContainerPoint(this.latLngToLayerPoint(ne(u)))},mouseEventToContainerPoint:function(u){return sS(u,this._container)},mouseEventToLayerPoint:function(u){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(u))},mouseEventToLatLng:function(u){return this.layerPointToLatLng(this.mouseEventToLayerPoint(u))},_initContainer:function(u){var m=this._container=X_(u);if(m){if(m._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");ut(m,"scroll",this._onScroll,this),this._containerId=c(m)},_initLayout:function(){var u=this._container;this._fadeAnimated=this.options.fadeAnimation&&We.any3d,ft(u,"leaflet-container"+(We.touch?" leaflet-touch":"")+(We.retina?" leaflet-retina":"")+(We.ielt9?" leaflet-oldie":"")+(We.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var m=_d(u,"position");m!=="absolute"&&m!=="relative"&&m!=="fixed"&&m!=="sticky"&&(u.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var u=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),jn(this._mapPane,new B(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(ft(u.markerPane,"leaflet-zoom-hide"),ft(u.shadowPane,"leaflet-zoom-hide"))},_resetView:function(u,m,w){jn(this._mapPane,new B(0,0));var T=!this._loaded;this._loaded=!0,m=this._limitZoom(m),this.fire("viewprereset");var A=this._zoom!==m;this._moveStart(A,w)._move(u,m)._moveEnd(A),this.fire("viewreset"),T&&this.fire("load")},_moveStart:function(u,m){return u&&this.fire("zoomstart"),m||this.fire("movestart"),this},_move:function(u,m,w,T){m===void 0&&(m=this._zoom);var A=this._zoom!==m;return this._zoom=m,this._lastCenter=u,this._pixelOrigin=this._getNewPixelOrigin(u),T?w&&w.pinch&&this.fire("zoom",w):((A||w&&w.pinch)&&this.fire("zoom",w),this.fire("move",w)),this},_moveEnd:function(u){return u&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return H(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(u){jn(this._mapPane,this._getMapPanePos().subtract(u))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(u){this._targets={},this._targets[c(this._container)]=this;var m=u?qt:ut;m(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&m(window,"resize",this._onResize,this),We.any3d&&this.options.transform3DLimit&&(u?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){H(this._resizeRequest),this._resizeRequest=z(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var u=this._getMapPanePos();Math.max(Math.abs(u.x),Math.abs(u.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(u,m){for(var w=[],T,A=m==="mouseout"||m==="mouseover",$=u.target||u.srcElement,ee=!1;$;){if(T=this._targets[c($)],T&&(m==="click"||m==="preclick")&&this._draggableMoved(T)){ee=!0;break}if(T&&T.listens(m,!0)&&(A&&!gy($,u)||(w.push(T),A))||$===this._container)break;$=$.parentNode}return!w.length&&!ee&&!A&&this.listens(m,!0)&&(w=[this]),w},_isClickDisabled:function(u){for(;u&&u!==this._container;){if(u._leaflet_disable_click)return!0;u=u.parentNode}},_handleDOMEvent:function(u){var m=u.target||u.srcElement;if(!(!this._loaded||m._leaflet_disable_events||u.type==="click"&&this._isClickDisabled(m))){var w=u.type;w==="mousedown"&&dy(m),this._fireDOMEvent(u,w)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(u,m,w){if(u.type==="click"){var T=r({},u);T.type="preclick",this._fireDOMEvent(T,T.type,w)}var A=this._findEventTargets(u,m);if(w){for(var $=[],ee=0;ee<w.length;ee++)w[ee].listens(m,!0)&&$.push(w[ee]);A=$.concat(A)}if(A.length){m==="contextmenu"&&Hn(u);var ue=A[0],me={originalEvent:u};if(u.type!=="keypress"&&u.type!=="keydown"&&u.type!=="keyup"){var je=ue.getLatLng&&(!ue._radius||ue._radius<=10);me.containerPoint=je?this.latLngToContainerPoint(ue.getLatLng()):this.mouseEventToContainerPoint(u),me.layerPoint=this.containerPointToLayerPoint(me.containerPoint),me.latlng=je?ue.getLatLng():this.layerPointToLatLng(me.layerPoint)}for(ee=0;ee<A.length;ee++)if(A[ee].fire(m,me,!0),me.originalEvent._stopped||A[ee].options.bubblingMouseEvents===!1&&S(this._mouseEvents,m)!==-1)return}},_draggableMoved:function(u){return u=u.dragging&&u.dragging.enabled()?u:this,u.dragging&&u.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var u=0,m=this._handlers.length;u<m;u++)this._handlers[u].disable()},whenReady:function(u,m){return this._loaded?u.call(m||this,{target:this}):this.on("load",u,m),this},_getMapPanePos:function(){return Co(this._mapPane)||new B(0,0)},_moved:function(){var u=this._getMapPanePos();return u&&!u.equals([0,0])},_getTopLeftPoint:function(u,m){var w=u&&m!==void 0?this._getNewPixelOrigin(u,m):this.getPixelOrigin();return w.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(u,m){var w=this.getSize()._divideBy(2);return this.project(u,m)._subtract(w)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(u,m,w){var T=this._getNewPixelOrigin(w,m);return this.project(u,m)._subtract(T)},_latLngBoundsToNewLayerBounds:function(u,m,w){var T=this._getNewPixelOrigin(w,m);return X([this.project(u.getSouthWest(),m)._subtract(T),this.project(u.getNorthWest(),m)._subtract(T),this.project(u.getSouthEast(),m)._subtract(T),this.project(u.getNorthEast(),m)._subtract(T)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(u){return this.latLngToLayerPoint(u).subtract(this._getCenterLayerPoint())},_limitCenter:function(u,m,w){if(!w)return u;var T=this.project(u,m),A=this.getSize().divideBy(2),$=new le(T.subtract(A),T.add(A)),ee=this._getBoundsOffset($,w,m);return Math.abs(ee.x)<=1&&Math.abs(ee.y)<=1?u:this.unproject(T.add(ee),m)},_limitOffset:function(u,m){if(!m)return u;var w=this.getPixelBounds(),T=new le(w.min.add(u),w.max.add(u));return u.add(this._getBoundsOffset(T,m))},_getBoundsOffset:function(u,m,w){var T=X(this.project(m.getNorthEast(),w),this.project(m.getSouthWest(),w)),A=T.min.subtract(u.min),$=T.max.subtract(u.max),ee=this._rebound(A.x,-$.x),ue=this._rebound(A.y,-$.y);return new B(ee,ue)},_rebound:function(u,m){return u+m>0?Math.round(u-m)/2:Math.max(0,Math.ceil(u))-Math.max(0,Math.floor(m))},_limitZoom:function(u){var m=this.getMinZoom(),w=this.getMaxZoom(),T=We.any3d?this.options.zoomSnap:1;return T&&(u=Math.round(u/T)*T),Math.max(m,Math.min(w,u))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){vn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(u,m){var w=this._getCenterOffset(u)._trunc();return(m&&m.animate)!==!0&&!this.getSize().contains(w)?!1:(this.panBy(w,m),!0)},_createAnimProxy:function(){var u=this._proxy=Tt("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(u),this.on("zoomanim",function(m){var w=sy,T=this._proxy.style[w];jo(this._proxy,this.project(m.center,m.zoom),this.getZoomScale(m.zoom,1)),T===this._proxy.style[w]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){on(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var u=this.getCenter(),m=this.getZoom();jo(this._proxy,this.project(u,m),this.getZoomScale(m,1))},_catchTransitionEnd:function(u){this._animatingZoom&&u.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(u,m,w){if(this._animatingZoom)return!0;if(w=w||{},!this._zoomAnimated||w.animate===!1||this._nothingToAnimate()||Math.abs(m-this._zoom)>this.options.zoomAnimationThreshold)return!1;var T=this.getZoomScale(m),A=this._getCenterOffset(u)._divideBy(1-1/T);return w.animate!==!0&&!this.getSize().contains(A)?!1:(z(function(){this._moveStart(!0,w.noMoveStart||!1)._animateZoom(u,m,!0)},this),!0)},_animateZoom:function(u,m,w,T){this._mapPane&&(w&&(this._animatingZoom=!0,this._animateToCenter=u,this._animateToZoom=m,ft(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:u,zoom:m,noUpdate:T}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&vn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function wO(u,m){return new St(u,m)}var Pr=R.extend({options:{position:"topright"},initialize:function(u){v(this,u)},getPosition:function(){return this.options.position},setPosition:function(u){var m=this._map;return m&&m.removeControl(this),this.options.position=u,m&&m.addControl(this),this},getContainer:function(){return this._container},addTo:function(u){this.remove(),this._map=u;var m=this._container=this.onAdd(u),w=this.getPosition(),T=u._controlCorners[w];return ft(m,"leaflet-control"),w.indexOf("bottom")!==-1?T.insertBefore(m,T.firstChild):T.appendChild(m),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(on(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(u){this._map&&u&&u.screenX>0&&u.screenY>0&&this._map.getContainer().focus()}}),kd=function(u){return new Pr(u)};St.include({addControl:function(u){return u.addTo(this),this},removeControl:function(u){return u.remove(),this},_initControlPos:function(){var u=this._controlCorners={},m="leaflet-",w=this._controlContainer=Tt("div",m+"control-container",this._container);function T(A,$){var ee=m+A+" "+m+$;u[A+$]=Tt("div",ee,w)}T("top","left"),T("top","right"),T("bottom","left"),T("bottom","right")},_clearControlPos:function(){for(var u in this._controlCorners)on(this._controlCorners[u]);on(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var aS=Pr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(u,m,w,T){return w<T?-1:T<w?1:0}},initialize:function(u,m,w){v(this,w),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var T in u)this._addLayer(u[T],T);for(T in m)this._addLayer(m[T],T,!0)},onAdd:function(u){this._initLayout(),this._update(),this._map=u,u.on("zoomend",this._checkDisabledLayers,this);for(var m=0;m<this._layers.length;m++)this._layers[m].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(u){return Pr.prototype.addTo.call(this,u),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var u=0;u<this._layers.length;u++)this._layers[u].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(u,m){return this._addLayer(u,m),this._map?this._update():this},addOverlay:function(u,m){return this._addLayer(u,m,!0),this._map?this._update():this},removeLayer:function(u){u.off("add remove",this._onLayerChange,this);var m=this._getLayer(c(u));return m&&this._layers.splice(this._layers.indexOf(m),1),this._map?this._update():this},expand:function(){ft(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var u=this._map.getSize().y-(this._container.offsetTop+50);return u<this._section.clientHeight?(ft(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=u+"px"):vn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return vn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var u="leaflet-control-layers",m=this._container=Tt("div",u),w=this.options.collapsed;m.setAttribute("aria-haspopup",!0),Cd(m),py(m);var T=this._section=Tt("section",u+"-list");w&&(this._map.on("click",this.collapse,this),ut(m,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var A=this._layersLink=Tt("a",u+"-toggle",m);A.href="#",A.title="Layers",A.setAttribute("role","button"),ut(A,{keydown:function($){$.keyCode===13&&this._expandSafely()},click:function($){Hn($),this._expandSafely()}},this),w||this.expand(),this._baseLayersList=Tt("div",u+"-base",T),this._separator=Tt("div",u+"-separator",T),this._overlaysList=Tt("div",u+"-overlays",T),m.appendChild(T)},_getLayer:function(u){for(var m=0;m<this._layers.length;m++)if(this._layers[m]&&c(this._layers[m].layer)===u)return this._layers[m]},_addLayer:function(u,m,w){this._map&&u.on("add remove",this._onLayerChange,this),this._layers.push({layer:u,name:m,overlay:w}),this.options.sortLayers&&this._layers.sort(o(function(T,A){return this.options.sortFunction(T.layer,A.layer,T.name,A.name)},this)),this.options.autoZIndex&&u.setZIndex&&(this._lastZIndex++,u.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Bh(this._baseLayersList),Bh(this._overlaysList),this._layerControlInputs=[];var u,m,w,T,A=0;for(w=0;w<this._layers.length;w++)T=this._layers[w],this._addItem(T),m=m||T.overlay,u=u||!T.overlay,A+=T.overlay?0:1;return this.options.hideSingleBase&&(u=u&&A>1,this._baseLayersList.style.display=u?"":"none"),this._separator.style.display=m&&u?"":"none",this},_onLayerChange:function(u){this._handlingClick||this._update();var m=this._getLayer(c(u.target)),w=m.overlay?u.type==="add"?"overlayadd":"overlayremove":u.type==="add"?"baselayerchange":null;w&&this._map.fire(w,m)},_createRadioElement:function(u,m){var w='<input type="radio" class="leaflet-control-layers-selector" name="'+u+'"'+(m?' checked="checked"':"")+"/>",T=document.createElement("div");return T.innerHTML=w,T.firstChild},_addItem:function(u){var m=document.createElement("label"),w=this._map.hasLayer(u.layer),T;u.overlay?(T=document.createElement("input"),T.type="checkbox",T.className="leaflet-control-layers-selector",T.defaultChecked=w):T=this._createRadioElement("leaflet-base-layers_"+c(this),w),this._layerControlInputs.push(T),T.layerId=c(u.layer),ut(T,"click",this._onInputClick,this);var A=document.createElement("span");A.innerHTML=" "+u.name;var $=document.createElement("span");m.appendChild($),$.appendChild(T),$.appendChild(A);var ee=u.overlay?this._overlaysList:this._baseLayersList;return ee.appendChild(m),this._checkDisabledLayers(),m},_onInputClick:function(){if(!this._preventClick){var u=this._layerControlInputs,m,w,T=[],A=[];this._handlingClick=!0;for(var $=u.length-1;$>=0;$--)m=u[$],w=this._getLayer(m.layerId).layer,m.checked?T.push(w):m.checked||A.push(w);for($=0;$<A.length;$++)this._map.hasLayer(A[$])&&this._map.removeLayer(A[$]);for($=0;$<T.length;$++)this._map.hasLayer(T[$])||this._map.addLayer(T[$]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var u=this._layerControlInputs,m,w,T=this._map.getZoom(),A=u.length-1;A>=0;A--)m=u[A],w=this._getLayer(m.layerId).layer,m.disabled=w.options.minZoom!==void 0&&T<w.options.minZoom||w.options.maxZoom!==void 0&&T>w.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var u=this._section;this._preventClick=!0,ut(u,"click",Hn),this.expand();var m=this;setTimeout(function(){qt(u,"click",Hn),m._preventClick=!1})}}),_O=function(u,m,w){return new aS(u,m,w)},yy=Pr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(u){var m="leaflet-control-zoom",w=Tt("div",m+" leaflet-bar"),T=this.options;return this._zoomInButton=this._createButton(T.zoomInText,T.zoomInTitle,m+"-in",w,this._zoomIn),this._zoomOutButton=this._createButton(T.zoomOutText,T.zoomOutTitle,m+"-out",w,this._zoomOut),this._updateDisabled(),u.on("zoomend zoomlevelschange",this._updateDisabled,this),w},onRemove:function(u){u.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(u){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(u.shiftKey?3:1))},_zoomOut:function(u){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(u.shiftKey?3:1))},_createButton:function(u,m,w,T,A){var $=Tt("a",w,T);return $.innerHTML=u,$.href="#",$.title=m,$.setAttribute("role","button"),$.setAttribute("aria-label",m),Cd($),ut($,"click",To),ut($,"click",A,this),ut($,"click",this._refocusOnMap,this),$},_updateDisabled:function(){var u=this._map,m="leaflet-disabled";vn(this._zoomInButton,m),vn(this._zoomOutButton,m),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||u._zoom===u.getMinZoom())&&(ft(this._zoomOutButton,m),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||u._zoom===u.getMaxZoom())&&(ft(this._zoomInButton,m),this._zoomInButton.setAttribute("aria-disabled","true"))}});St.mergeOptions({zoomControl:!0}),St.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new yy,this.addControl(this.zoomControl))});var SO=function(u){return new yy(u)},oS=Pr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(u){var m="leaflet-control-scale",w=Tt("div",m),T=this.options;return this._addScales(T,m+"-line",w),u.on(T.updateWhenIdle?"moveend":"move",this._update,this),u.whenReady(this._update,this),w},onRemove:function(u){u.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(u,m,w){u.metric&&(this._mScale=Tt("div",m,w)),u.imperial&&(this._iScale=Tt("div",m,w))},_update:function(){var u=this._map,m=u.getSize().y/2,w=u.distance(u.containerPointToLatLng([0,m]),u.containerPointToLatLng([this.options.maxWidth,m]));this._updateScales(w)},_updateScales:function(u){this.options.metric&&u&&this._updateMetric(u),this.options.imperial&&u&&this._updateImperial(u)},_updateMetric:function(u){var m=this._getRoundNum(u),w=m<1e3?m+" m":m/1e3+" km";this._updateScale(this._mScale,w,m/u)},_updateImperial:function(u){var m=u*3.2808399,w,T,A;m>5280?(w=m/5280,T=this._getRoundNum(w),this._updateScale(this._iScale,T+" mi",T/w)):(A=this._getRoundNum(m),this._updateScale(this._iScale,A+" ft",A/m))},_updateScale:function(u,m,w){u.style.width=Math.round(this.options.maxWidth*w)+"px",u.innerHTML=m},_getRoundNum:function(u){var m=Math.pow(10,(Math.floor(u)+"").length-1),w=u/m;return w=w>=10?10:w>=5?5:w>=3?3:w>=2?2:1,m*w}}),NO=function(u){return new oS(u)},jO='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',xy=Pr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(We.inlineSvg?jO+" ":"")+"Leaflet</a>"},initialize:function(u){v(this,u),this._attributions={}},onAdd:function(u){u.attributionControl=this,this._container=Tt("div","leaflet-control-attribution"),Cd(this._container);for(var m in u._layers)u._layers[m].getAttribution&&this.addAttribution(u._layers[m].getAttribution());return this._update(),u.on("layeradd",this._addAttribution,this),this._container},onRemove:function(u){u.off("layeradd",this._addAttribution,this)},_addAttribution:function(u){u.layer.getAttribution&&(this.addAttribution(u.layer.getAttribution()),u.layer.once("remove",function(){this.removeAttribution(u.layer.getAttribution())},this))},setPrefix:function(u){return this.options.prefix=u,this._update(),this},addAttribution:function(u){return u?(this._attributions[u]||(this._attributions[u]=0),this._attributions[u]++,this._update(),this):this},removeAttribution:function(u){return u?(this._attributions[u]&&(this._attributions[u]--,this._update()),this):this},_update:function(){if(this._map){var u=[];for(var m in this._attributions)this._attributions[m]&&u.push(m);var w=[];this.options.prefix&&w.push(this.options.prefix),u.length&&w.push(u.join(", ")),this._container.innerHTML=w.join(' <span aria-hidden="true">|</span> ')}}});St.mergeOptions({attributionControl:!0}),St.addInitHook(function(){this.options.attributionControl&&new xy().addTo(this)});var CO=function(u){return new xy(u)};Pr.Layers=aS,Pr.Zoom=yy,Pr.Scale=oS,Pr.Attribution=xy,kd.layers=_O,kd.zoom=SO,kd.scale=NO,kd.attribution=CO;var ri=R.extend({initialize:function(u){this._map=u},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});ri.addTo=function(u,m){return u.addHandler(m,this),this};var kO={Events:U},lS=We.touch?"touchstart mousedown":"mousedown",xa=W.extend({options:{clickTolerance:3},initialize:function(u,m,w,T){v(this,T),this._element=u,this._dragStartTarget=m||u,this._preventOutline=w},enable:function(){this._enabled||(ut(this._dragStartTarget,lS,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(xa._dragging===this&&this.finishDrag(!0),qt(this._dragStartTarget,lS,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(u){if(this._enabled&&(this._moved=!1,!ry(this._element,"leaflet-zoom-anim"))){if(u.touches&&u.touches.length!==1){xa._dragging===this&&this.finishDrag();return}if(!(xa._dragging||u.shiftKey||u.which!==1&&u.button!==1&&!u.touches)&&(xa._dragging=this,this._preventOutline&&dy(this._element),oy(),Sd(),!this._moving)){this.fire("down");var m=u.touches?u.touches[0]:u,w=eS(this._element);this._startPoint=new B(m.clientX,m.clientY),this._startPos=Co(this._element),this._parentScale=uy(w);var T=u.type==="mousedown";ut(document,T?"mousemove":"touchmove",this._onMove,this),ut(document,T?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(u){if(this._enabled){if(u.touches&&u.touches.length>1){this._moved=!0;return}var m=u.touches&&u.touches.length===1?u.touches[0]:u,w=new B(m.clientX,m.clientY)._subtract(this._startPoint);!w.x&&!w.y||Math.abs(w.x)+Math.abs(w.y)<this.options.clickTolerance||(w.x/=this._parentScale.x,w.y/=this._parentScale.y,Hn(u),this._moved||(this.fire("dragstart"),this._moved=!0,ft(document.body,"leaflet-dragging"),this._lastTarget=u.target||u.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),ft(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(w),this._moving=!0,this._lastEvent=u,this._updatePosition())}},_updatePosition:function(){var u={originalEvent:this._lastEvent};this.fire("predrag",u),jn(this._element,this._newPos),this.fire("drag",u)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(u){vn(document.body,"leaflet-dragging"),this._lastTarget&&(vn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),qt(document,"mousemove touchmove",this._onMove,this),qt(document,"mouseup touchend touchcancel",this._onUp,this),ly(),Nd();var m=this._moved&&this._moving;this._moving=!1,xa._dragging=!1,m&&this.fire("dragend",{noInertia:u,distance:this._newPos.distanceTo(this._startPos)})}});function cS(u,m,w){var T,A=[1,4,2,8],$,ee,ue,me,je,Le,et,yt;for($=0,Le=u.length;$<Le;$++)u[$]._code=Eo(u[$],m);for(ue=0;ue<4;ue++){for(et=A[ue],T=[],$=0,Le=u.length,ee=Le-1;$<Le;ee=$++)me=u[$],je=u[ee],me._code&et?je._code&et||(yt=Yh(je,me,et,m,w),yt._code=Eo(yt,m),T.push(yt)):(je._code&et&&(yt=Yh(je,me,et,m,w),yt._code=Eo(yt,m),T.push(yt)),T.push(me));u=T}return u}function dS(u,m){var w,T,A,$,ee,ue,me,je,Le;if(!u||u.length===0)throw new Error("latlngs not passed");fr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var et=ne([0,0]),yt=se(u),fs=yt.getNorthWest().distanceTo(yt.getSouthWest())*yt.getNorthEast().distanceTo(yt.getNorthWest());fs<1700&&(et=vy(u));var Un=u.length,mr=[];for(w=0;w<Un;w++){var ks=ne(u[w]);mr.push(m.project(ne([ks.lat-et.lat,ks.lng-et.lng])))}for(ue=me=je=0,w=0,T=Un-1;w<Un;T=w++)A=mr[w],$=mr[T],ee=A.y*$.x-$.y*A.x,me+=(A.x+$.x)*ee,je+=(A.y+$.y)*ee,ue+=ee*3;ue===0?Le=mr[0]:Le=[me/ue,je/ue];var Hl=m.unproject(Q(Le));return ne([Hl.lat+et.lat,Hl.lng+et.lng])}function vy(u){for(var m=0,w=0,T=0,A=0;A<u.length;A++){var $=ne(u[A]);m+=$.lat,w+=$.lng,T++}return ne([m/T,w/T])}var TO={__proto__:null,clipPolygon:cS,polygonCenter:dS,centroid:vy};function uS(u,m){if(!m||!u.length)return u.slice();var w=m*m;return u=MO(u,w),u=PO(u,w),u}function hS(u,m,w){return Math.sqrt(Td(u,m,w,!0))}function EO(u,m,w){return Td(u,m,w)}function PO(u,m){var w=u.length,T=typeof Uint8Array<"u"?Uint8Array:Array,A=new T(w);A[0]=A[w-1]=1,by(u,A,m,0,w-1);var $,ee=[];for($=0;$<w;$++)A[$]&&ee.push(u[$]);return ee}function by(u,m,w,T,A){var $=0,ee,ue,me;for(ue=T+1;ue<=A-1;ue++)me=Td(u[ue],u[T],u[A],!0),me>$&&(ee=ue,$=me);$>w&&(m[ee]=1,by(u,m,w,T,ee),by(u,m,w,ee,A))}function MO(u,m){for(var w=[u[0]],T=1,A=0,$=u.length;T<$;T++)DO(u[T],u[A])>m&&(w.push(u[T]),A=T);return A<$-1&&w.push(u[$-1]),w}var fS;function mS(u,m,w,T,A){var $=T?fS:Eo(u,w),ee=Eo(m,w),ue,me,je;for(fS=ee;;){if(!($|ee))return[u,m];if($&ee)return!1;ue=$||ee,me=Yh(u,m,ue,w,A),je=Eo(me,w),ue===$?(u=me,$=je):(m=me,ee=je)}}function Yh(u,m,w,T,A){var $=m.x-u.x,ee=m.y-u.y,ue=T.min,me=T.max,je,Le;return w&8?(je=u.x+$*(me.y-u.y)/ee,Le=me.y):w&4?(je=u.x+$*(ue.y-u.y)/ee,Le=ue.y):w&2?(je=me.x,Le=u.y+ee*(me.x-u.x)/$):w&1&&(je=ue.x,Le=u.y+ee*(ue.x-u.x)/$),new B(je,Le,A)}function Eo(u,m){var w=0;return u.x<m.min.x?w|=1:u.x>m.max.x&&(w|=2),u.y<m.min.y?w|=4:u.y>m.max.y&&(w|=8),w}function DO(u,m){var w=m.x-u.x,T=m.y-u.y;return w*w+T*T}function Td(u,m,w,T){var A=m.x,$=m.y,ee=w.x-A,ue=w.y-$,me=ee*ee+ue*ue,je;return me>0&&(je=((u.x-A)*ee+(u.y-$)*ue)/me,je>1?(A=w.x,$=w.y):je>0&&(A+=ee*je,$+=ue*je)),ee=u.x-A,ue=u.y-$,T?ee*ee+ue*ue:new B(A,$)}function fr(u){return!k(u[0])||typeof u[0][0]!="object"&&typeof u[0][0]<"u"}function pS(u){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),fr(u)}function gS(u,m){var w,T,A,$,ee,ue,me,je;if(!u||u.length===0)throw new Error("latlngs not passed");fr(u)||(console.warn("latlngs are not flat! Only the first ring will be used"),u=u[0]);var Le=ne([0,0]),et=se(u),yt=et.getNorthWest().distanceTo(et.getSouthWest())*et.getNorthEast().distanceTo(et.getNorthWest());yt<1700&&(Le=vy(u));var fs=u.length,Un=[];for(w=0;w<fs;w++){var mr=ne(u[w]);Un.push(m.project(ne([mr.lat-Le.lat,mr.lng-Le.lng])))}for(w=0,T=0;w<fs-1;w++)T+=Un[w].distanceTo(Un[w+1])/2;if(T===0)je=Un[0];else for(w=0,$=0;w<fs-1;w++)if(ee=Un[w],ue=Un[w+1],A=ee.distanceTo(ue),$+=A,$>T){me=($-T)/A,je=[ue.x-me*(ue.x-ee.x),ue.y-me*(ue.y-ee.y)];break}var ks=m.unproject(Q(je));return ne([ks.lat+Le.lat,ks.lng+Le.lng])}var AO={__proto__:null,simplify:uS,pointToSegmentDistance:hS,closestPointOnSegment:EO,clipSegment:mS,_getEdgeIntersection:Yh,_getBitCode:Eo,_sqClosestPointOnSegment:Td,isFlat:fr,_flat:pS,polylineCenter:gS},wy={project:function(u){return new B(u.lng,u.lat)},unproject:function(u){return new G(u.y,u.x)},bounds:new le([-180,-90],[180,90])},_y={R:6378137,R_MINOR:6356752314245179e-9,bounds:new le([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(u){var m=Math.PI/180,w=this.R,T=u.lat*m,A=this.R_MINOR/w,$=Math.sqrt(1-A*A),ee=$*Math.sin(T),ue=Math.tan(Math.PI/4-T/2)/Math.pow((1-ee)/(1+ee),$/2);return T=-w*Math.log(Math.max(ue,1e-10)),new B(u.lng*m*w,T)},unproject:function(u){for(var m=180/Math.PI,w=this.R,T=this.R_MINOR/w,A=Math.sqrt(1-T*T),$=Math.exp(-u.y/w),ee=Math.PI/2-2*Math.atan($),ue=0,me=.1,je;ue<15&&Math.abs(me)>1e-7;ue++)je=A*Math.sin(ee),je=Math.pow((1-je)/(1+je),A/2),me=Math.PI/2-2*Math.atan($*je)-ee,ee+=me;return new G(ee*m,u.x*m/w)}},IO={__proto__:null,LonLat:wy,Mercator:_y,SphericalMercator:ae},OO=r({},ye,{code:"EPSG:3395",projection:_y,transformation:function(){var u=.5/(Math.PI*_y.R);return pe(u,.5,-u,.5)}()}),yS=r({},ye,{code:"EPSG:4326",projection:wy,transformation:pe(1/180,1,-1/180,.5)}),RO=r({},ge,{projection:wy,transformation:pe(1,0,-1,0),scale:function(u){return Math.pow(2,u)},zoom:function(u){return Math.log(u)/Math.LN2},distance:function(u,m){var w=m.lng-u.lng,T=m.lat-u.lat;return Math.sqrt(w*w+T*T)},infinite:!0});ge.Earth=ye,ge.EPSG3395=OO,ge.EPSG3857=Ne,ge.EPSG900913=Me,ge.EPSG4326=yS,ge.Simple=RO;var Mr=W.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(u){return u.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(u){return u&&u.removeLayer(this),this},getPane:function(u){return this._map.getPane(u?this.options[u]||u:this.options.pane)},addInteractiveTarget:function(u){return this._map._targets[c(u)]=this,this},removeInteractiveTarget:function(u){return delete this._map._targets[c(u)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(u){var m=u.target;if(m.hasLayer(this)){if(this._map=m,this._zoomAnimated=m._zoomAnimated,this.getEvents){var w=this.getEvents();m.on(w,this),this.once("remove",function(){m.off(w,this)},this)}this.onAdd(m),this.fire("add"),m.fire("layeradd",{layer:this})}}});St.include({addLayer:function(u){if(!u._layerAdd)throw new Error("The provided object is not a Layer.");var m=c(u);return this._layers[m]?this:(this._layers[m]=u,u._mapToAdd=this,u.beforeAdd&&u.beforeAdd(this),this.whenReady(u._layerAdd,u),this)},removeLayer:function(u){var m=c(u);return this._layers[m]?(this._loaded&&u.onRemove(this),delete this._layers[m],this._loaded&&(this.fire("layerremove",{layer:u}),u.fire("remove")),u._map=u._mapToAdd=null,this):this},hasLayer:function(u){return c(u)in this._layers},eachLayer:function(u,m){for(var w in this._layers)u.call(m,this._layers[w]);return this},_addLayers:function(u){u=u?k(u)?u:[u]:[];for(var m=0,w=u.length;m<w;m++)this.addLayer(u[m])},_addZoomLimit:function(u){(!isNaN(u.options.maxZoom)||!isNaN(u.options.minZoom))&&(this._zoomBoundLayers[c(u)]=u,this._updateZoomLevels())},_removeZoomLimit:function(u){var m=c(u);this._zoomBoundLayers[m]&&(delete this._zoomBoundLayers[m],this._updateZoomLevels())},_updateZoomLevels:function(){var u=1/0,m=-1/0,w=this._getZoomSpan();for(var T in this._zoomBoundLayers){var A=this._zoomBoundLayers[T].options;u=A.minZoom===void 0?u:Math.min(u,A.minZoom),m=A.maxZoom===void 0?m:Math.max(m,A.maxZoom)}this._layersMaxZoom=m===-1/0?void 0:m,this._layersMinZoom=u===1/0?void 0:u,w!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var zl=Mr.extend({initialize:function(u,m){v(this,m),this._layers={};var w,T;if(u)for(w=0,T=u.length;w<T;w++)this.addLayer(u[w])},addLayer:function(u){var m=this.getLayerId(u);return this._layers[m]=u,this._map&&this._map.addLayer(u),this},removeLayer:function(u){var m=u in this._layers?u:this.getLayerId(u);return this._map&&this._layers[m]&&this._map.removeLayer(this._layers[m]),delete this._layers[m],this},hasLayer:function(u){var m=typeof u=="number"?u:this.getLayerId(u);return m in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(u){var m=Array.prototype.slice.call(arguments,1),w,T;for(w in this._layers)T=this._layers[w],T[u]&&T[u].apply(T,m);return this},onAdd:function(u){this.eachLayer(u.addLayer,u)},onRemove:function(u){this.eachLayer(u.removeLayer,u)},eachLayer:function(u,m){for(var w in this._layers)u.call(m,this._layers[w]);return this},getLayer:function(u){return this._layers[u]},getLayers:function(){var u=[];return this.eachLayer(u.push,u),u},setZIndex:function(u){return this.invoke("setZIndex",u)},getLayerId:function(u){return c(u)}}),LO=function(u,m){return new zl(u,m)},Di=zl.extend({addLayer:function(u){return this.hasLayer(u)?this:(u.addEventParent(this),zl.prototype.addLayer.call(this,u),this.fire("layeradd",{layer:u}))},removeLayer:function(u){return this.hasLayer(u)?(u in this._layers&&(u=this._layers[u]),u.removeEventParent(this),zl.prototype.removeLayer.call(this,u),this.fire("layerremove",{layer:u})):this},setStyle:function(u){return this.invoke("setStyle",u)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var u=new Z;for(var m in this._layers){var w=this._layers[m];u.extend(w.getBounds?w.getBounds():w.getLatLng())}return u}}),FO=function(u,m){return new Di(u,m)},Ul=R.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(u){v(this,u)},createIcon:function(u){return this._createIcon("icon",u)},createShadow:function(u){return this._createIcon("shadow",u)},_createIcon:function(u,m){var w=this._getIconUrl(u);if(!w){if(u==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var T=this._createImg(w,m&&m.tagName==="IMG"?m:null);return this._setIconStyles(T,u),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),T},_setIconStyles:function(u,m){var w=this.options,T=w[m+"Size"];typeof T=="number"&&(T=[T,T]);var A=Q(T),$=Q(m==="shadow"&&w.shadowAnchor||w.iconAnchor||A&&A.divideBy(2,!0));u.className="leaflet-marker-"+m+" "+(w.className||""),$&&(u.style.marginLeft=-$.x+"px",u.style.marginTop=-$.y+"px"),A&&(u.style.width=A.x+"px",u.style.height=A.y+"px")},_createImg:function(u,m){return m=m||document.createElement("img"),m.src=u,m},_getIconUrl:function(u){return We.retina&&this.options[u+"RetinaUrl"]||this.options[u+"Url"]}});function $O(u){return new Ul(u)}var Ed=Ul.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(u){return typeof Ed.imagePath!="string"&&(Ed.imagePath=this._detectIconPath()),(this.options.imagePath||Ed.imagePath)+Ul.prototype._getIconUrl.call(this,u)},_stripUrl:function(u){var m=function(w,T,A){var $=T.exec(w);return $&&$[A]};return u=m(u,/^url\((['"])?(.+)\1\)$/,2),u&&m(u,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var u=Tt("div","leaflet-default-icon-path",document.body),m=_d(u,"background-image")||_d(u,"backgroundImage");if(document.body.removeChild(u),m=this._stripUrl(m),m)return m;var w=document.querySelector('link[href$="leaflet.css"]');return w?w.href.substring(0,w.href.length-11-1):""}}),xS=ri.extend({initialize:function(u){this._marker=u},addHooks:function(){var u=this._marker._icon;this._draggable||(this._draggable=new xa(u,u,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),ft(u,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&vn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(u){var m=this._marker,w=m._map,T=this._marker.options.autoPanSpeed,A=this._marker.options.autoPanPadding,$=Co(m._icon),ee=w.getPixelBounds(),ue=w.getPixelOrigin(),me=X(ee.min._subtract(ue).add(A),ee.max._subtract(ue).subtract(A));if(!me.contains($)){var je=Q((Math.max(me.max.x,$.x)-me.max.x)/(ee.max.x-me.max.x)-(Math.min(me.min.x,$.x)-me.min.x)/(ee.min.x-me.min.x),(Math.max(me.max.y,$.y)-me.max.y)/(ee.max.y-me.max.y)-(Math.min(me.min.y,$.y)-me.min.y)/(ee.min.y-me.min.y)).multiplyBy(T);w.panBy(je,{animate:!1}),this._draggable._newPos._add(je),this._draggable._startPos._add(je),jn(m._icon,this._draggable._newPos),this._onDrag(u),this._panRequest=z(this._adjustPan.bind(this,u))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(u){this._marker.options.autoPan&&(H(this._panRequest),this._panRequest=z(this._adjustPan.bind(this,u)))},_onDrag:function(u){var m=this._marker,w=m._shadow,T=Co(m._icon),A=m._map.layerPointToLatLng(T);w&&jn(w,T),m._latlng=A,u.latlng=A,u.oldLatLng=this._oldLatLng,m.fire("move",u).fire("drag",u)},_onDragEnd:function(u){H(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",u)}}),Zh=Mr.extend({options:{icon:new Ed,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(u,m){v(this,m),this._latlng=ne(u)},onAdd:function(u){this._zoomAnimated=this._zoomAnimated&&u.options.markerZoomAnimation,this._zoomAnimated&&u.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(u){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&u.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(u){var m=this._latlng;return this._latlng=ne(u),this.update(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},setZIndexOffset:function(u){return this.options.zIndexOffset=u,this.update()},getIcon:function(){return this.options.icon},setIcon:function(u){return this.options.icon=u,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var u=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(u)}return this},_initIcon:function(){var u=this.options,m="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),w=u.icon.createIcon(this._icon),T=!1;w!==this._icon&&(this._icon&&this._removeIcon(),T=!0,u.title&&(w.title=u.title),w.tagName==="IMG"&&(w.alt=u.alt||"")),ft(w,m),u.keyboard&&(w.tabIndex="0",w.setAttribute("role","button")),this._icon=w,u.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&ut(w,"focus",this._panOnFocus,this);var A=u.icon.createShadow(this._shadow),$=!1;A!==this._shadow&&(this._removeShadow(),$=!0),A&&(ft(A,m),A.alt=""),this._shadow=A,u.opacity<1&&this._updateOpacity(),T&&this.getPane().appendChild(this._icon),this._initInteraction(),A&&$&&this.getPane(u.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&qt(this._icon,"focus",this._panOnFocus,this),on(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&on(this._shadow),this._shadow=null},_setPos:function(u){this._icon&&jn(this._icon,u),this._shadow&&jn(this._shadow,u),this._zIndex=u.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(u){this._icon&&(this._icon.style.zIndex=this._zIndex+u)},_animateZoom:function(u){var m=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center).round();this._setPos(m)},_initInteraction:function(){if(this.options.interactive&&(ft(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),xS)){var u=this.options.draggable;this.dragging&&(u=this.dragging.enabled(),this.dragging.disable()),this.dragging=new xS(this),u&&this.dragging.enable()}},setOpacity:function(u){return this.options.opacity=u,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var u=this.options.opacity;this._icon&&hr(this._icon,u),this._shadow&&hr(this._shadow,u)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var u=this._map;if(u){var m=this.options.icon.options,w=m.iconSize?Q(m.iconSize):Q(0,0),T=m.iconAnchor?Q(m.iconAnchor):Q(0,0);u.panInside(this._latlng,{paddingTopLeft:T,paddingBottomRight:w.subtract(T)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function zO(u,m){return new Zh(u,m)}var va=Mr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(u){this._renderer=u.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(u){return v(this,u),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&u&&Object.prototype.hasOwnProperty.call(u,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),Kh=va.extend({options:{fill:!0,radius:10},initialize:function(u,m){v(this,m),this._latlng=ne(u),this._radius=this.options.radius},setLatLng:function(u){var m=this._latlng;return this._latlng=ne(u),this.redraw(),this.fire("move",{oldLatLng:m,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(u){return this.options.radius=this._radius=u,this.redraw()},getRadius:function(){return this._radius},setStyle:function(u){var m=u&&u.radius||this._radius;return va.prototype.setStyle.call(this,u),this.setRadius(m),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var u=this._radius,m=this._radiusY||u,w=this._clickTolerance(),T=[u+w,m+w];this._pxBounds=new le(this._point.subtract(T),this._point.add(T))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(u){return u.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function UO(u,m){return new Kh(u,m)}var Sy=Kh.extend({initialize:function(u,m,w){if(typeof m=="number"&&(m=r({},w,{radius:m})),v(this,m),this._latlng=ne(u),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(u){return this._mRadius=u,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var u=[this._radius,this._radiusY||this._radius];return new Z(this._map.layerPointToLatLng(this._point.subtract(u)),this._map.layerPointToLatLng(this._point.add(u)))},setStyle:va.prototype.setStyle,_project:function(){var u=this._latlng.lng,m=this._latlng.lat,w=this._map,T=w.options.crs;if(T.distance===ye.distance){var A=Math.PI/180,$=this._mRadius/ye.R/A,ee=w.project([m+$,u]),ue=w.project([m-$,u]),me=ee.add(ue).divideBy(2),je=w.unproject(me).lat,Le=Math.acos((Math.cos($*A)-Math.sin(m*A)*Math.sin(je*A))/(Math.cos(m*A)*Math.cos(je*A)))/A;(isNaN(Le)||Le===0)&&(Le=$/Math.cos(Math.PI/180*m)),this._point=me.subtract(w.getPixelOrigin()),this._radius=isNaN(Le)?0:me.x-w.project([je,u-Le]).x,this._radiusY=me.y-ee.y}else{var et=T.unproject(T.project(this._latlng).subtract([this._mRadius,0]));this._point=w.latLngToLayerPoint(this._latlng),this._radius=this._point.x-w.latLngToLayerPoint(et).x}this._updateBounds()}});function VO(u,m,w){return new Sy(u,m,w)}var Ai=va.extend({options:{smoothFactor:1,noClip:!1},initialize:function(u,m){v(this,m),this._setLatLngs(u)},getLatLngs:function(){return this._latlngs},setLatLngs:function(u){return this._setLatLngs(u),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(u){for(var m=1/0,w=null,T=Td,A,$,ee=0,ue=this._parts.length;ee<ue;ee++)for(var me=this._parts[ee],je=1,Le=me.length;je<Le;je++){A=me[je-1],$=me[je];var et=T(u,A,$,!0);et<m&&(m=et,w=T(u,A,$))}return w&&(w.distance=Math.sqrt(m)),w},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return gS(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(u,m){return m=m||this._defaultShape(),u=ne(u),m.push(u),this._bounds.extend(u),this.redraw()},_setLatLngs:function(u){this._bounds=new Z,this._latlngs=this._convertLatLngs(u)},_defaultShape:function(){return fr(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(u){for(var m=[],w=fr(u),T=0,A=u.length;T<A;T++)w?(m[T]=ne(u[T]),this._bounds.extend(m[T])):m[T]=this._convertLatLngs(u[T]);return m},_project:function(){var u=new le;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,u),this._bounds.isValid()&&u.isValid()&&(this._rawPxBounds=u,this._updateBounds())},_updateBounds:function(){var u=this._clickTolerance(),m=new B(u,u);this._rawPxBounds&&(this._pxBounds=new le([this._rawPxBounds.min.subtract(m),this._rawPxBounds.max.add(m)]))},_projectLatlngs:function(u,m,w){var T=u[0]instanceof G,A=u.length,$,ee;if(T){for(ee=[],$=0;$<A;$++)ee[$]=this._map.latLngToLayerPoint(u[$]),w.extend(ee[$]);m.push(ee)}else for($=0;$<A;$++)this._projectLatlngs(u[$],m,w)},_clipPoints:function(){var u=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}var m=this._parts,w,T,A,$,ee,ue,me;for(w=0,A=0,$=this._rings.length;w<$;w++)for(me=this._rings[w],T=0,ee=me.length;T<ee-1;T++)ue=mS(me[T],me[T+1],u,T,!0),ue&&(m[A]=m[A]||[],m[A].push(ue[0]),(ue[1]!==me[T+1]||T===ee-2)&&(m[A].push(ue[1]),A++))}},_simplifyPoints:function(){for(var u=this._parts,m=this.options.smoothFactor,w=0,T=u.length;w<T;w++)u[w]=uS(u[w],m)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(u,m){var w,T,A,$,ee,ue,me=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for(w=0,$=this._parts.length;w<$;w++)for(ue=this._parts[w],T=0,ee=ue.length,A=ee-1;T<ee;A=T++)if(!(!m&&T===0)&&hS(u,ue[A],ue[T])<=me)return!0;return!1}});function BO(u,m){return new Ai(u,m)}Ai._flat=pS;var Vl=Ai.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return dS(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(u){var m=Ai.prototype._convertLatLngs.call(this,u),w=m.length;return w>=2&&m[0]instanceof G&&m[0].equals(m[w-1])&&m.pop(),m},_setLatLngs:function(u){Ai.prototype._setLatLngs.call(this,u),fr(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return fr(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var u=this._renderer._bounds,m=this.options.weight,w=new B(m,m);if(u=new le(u.min.subtract(w),u.max.add(w)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(u))){if(this.options.noClip){this._parts=this._rings;return}for(var T=0,A=this._rings.length,$;T<A;T++)$=cS(this._rings[T],u,!0),$.length&&this._parts.push($)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(u){var m=!1,w,T,A,$,ee,ue,me,je;if(!this._pxBounds||!this._pxBounds.contains(u))return!1;for($=0,me=this._parts.length;$<me;$++)for(w=this._parts[$],ee=0,je=w.length,ue=je-1;ee<je;ue=ee++)T=w[ee],A=w[ue],T.y>u.y!=A.y>u.y&&u.x<(A.x-T.x)*(u.y-T.y)/(A.y-T.y)+T.x&&(m=!m);return m||Ai.prototype._containsPoint.call(this,u,!0)}});function qO(u,m){return new Vl(u,m)}var Ii=Di.extend({initialize:function(u,m){v(this,m),this._layers={},u&&this.addData(u)},addData:function(u){var m=k(u)?u:u.features,w,T,A;if(m){for(w=0,T=m.length;w<T;w++)A=m[w],(A.geometries||A.geometry||A.features||A.coordinates)&&this.addData(A);return this}var $=this.options;if($.filter&&!$.filter(u))return this;var ee=Jh(u,$);return ee?(ee.feature=ef(u),ee.defaultOptions=ee.options,this.resetStyle(ee),$.onEachFeature&&$.onEachFeature(u,ee),this.addLayer(ee)):this},resetStyle:function(u){return u===void 0?this.eachLayer(this.resetStyle,this):(u.options=r({},u.defaultOptions),this._setLayerStyle(u,this.options.style),this)},setStyle:function(u){return this.eachLayer(function(m){this._setLayerStyle(m,u)},this)},_setLayerStyle:function(u,m){u.setStyle&&(typeof m=="function"&&(m=m(u.feature)),u.setStyle(m))}});function Jh(u,m){var w=u.type==="Feature"?u.geometry:u,T=w?w.coordinates:null,A=[],$=m&&m.pointToLayer,ee=m&&m.coordsToLatLng||Ny,ue,me,je,Le;if(!T&&!w)return null;switch(w.type){case"Point":return ue=ee(T),vS($,u,ue,m);case"MultiPoint":for(je=0,Le=T.length;je<Le;je++)ue=ee(T[je]),A.push(vS($,u,ue,m));return new Di(A);case"LineString":case"MultiLineString":return me=Qh(T,w.type==="LineString"?0:1,ee),new Ai(me,m);case"Polygon":case"MultiPolygon":return me=Qh(T,w.type==="Polygon"?1:2,ee),new Vl(me,m);case"GeometryCollection":for(je=0,Le=w.geometries.length;je<Le;je++){var et=Jh({geometry:w.geometries[je],type:"Feature",properties:u.properties},m);et&&A.push(et)}return new Di(A);case"FeatureCollection":for(je=0,Le=w.features.length;je<Le;je++){var yt=Jh(w.features[je],m);yt&&A.push(yt)}return new Di(A);default:throw new Error("Invalid GeoJSON object.")}}function vS(u,m,w,T){return u?u(m,w):new Zh(w,T&&T.markersInheritOptions&&T)}function Ny(u){return new G(u[1],u[0],u[2])}function Qh(u,m,w){for(var T=[],A=0,$=u.length,ee;A<$;A++)ee=m?Qh(u[A],m-1,w):(w||Ny)(u[A]),T.push(ee);return T}function jy(u,m){return u=ne(u),u.alt!==void 0?[p(u.lng,m),p(u.lat,m),p(u.alt,m)]:[p(u.lng,m),p(u.lat,m)]}function Xh(u,m,w,T){for(var A=[],$=0,ee=u.length;$<ee;$++)A.push(m?Xh(u[$],fr(u[$])?0:m-1,w,T):jy(u[$],T));return!m&&w&&A.length>0&&A.push(A[0].slice()),A}function Bl(u,m){return u.feature?r({},u.feature,{geometry:m}):ef(m)}function ef(u){return u.type==="Feature"||u.type==="FeatureCollection"?u:{type:"Feature",properties:{},geometry:u}}var Cy={toGeoJSON:function(u){return Bl(this,{type:"Point",coordinates:jy(this.getLatLng(),u)})}};Zh.include(Cy),Sy.include(Cy),Kh.include(Cy),Ai.include({toGeoJSON:function(u){var m=!fr(this._latlngs),w=Xh(this._latlngs,m?1:0,!1,u);return Bl(this,{type:(m?"Multi":"")+"LineString",coordinates:w})}}),Vl.include({toGeoJSON:function(u){var m=!fr(this._latlngs),w=m&&!fr(this._latlngs[0]),T=Xh(this._latlngs,w?2:m?1:0,!0,u);return m||(T=[T]),Bl(this,{type:(w?"Multi":"")+"Polygon",coordinates:T})}}),zl.include({toMultiPoint:function(u){var m=[];return this.eachLayer(function(w){m.push(w.toGeoJSON(u).geometry.coordinates)}),Bl(this,{type:"MultiPoint",coordinates:m})},toGeoJSON:function(u){var m=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(m==="MultiPoint")return this.toMultiPoint(u);var w=m==="GeometryCollection",T=[];return this.eachLayer(function(A){if(A.toGeoJSON){var $=A.toGeoJSON(u);if(w)T.push($.geometry);else{var ee=ef($);ee.type==="FeatureCollection"?T.push.apply(T,ee.features):T.push(ee)}}}),w?Bl(this,{geometries:T,type:"GeometryCollection"}):{type:"FeatureCollection",features:T}}});function bS(u,m){return new Ii(u,m)}var HO=bS,tf=Mr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(u,m,w){this._url=u,this._bounds=se(m),v(this,w)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(ft(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){on(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(u){return this.options.opacity=u,this._image&&this._updateOpacity(),this},setStyle:function(u){return u.opacity&&this.setOpacity(u.opacity),this},bringToFront:function(){return this._map&&Fl(this._image),this},bringToBack:function(){return this._map&&$l(this._image),this},setUrl:function(u){return this._url=u,this._image&&(this._image.src=u),this},setBounds:function(u){return this._bounds=se(u),this._map&&this._reset(),this},getEvents:function(){var u={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var u=this._url.tagName==="IMG",m=this._image=u?this._url:Tt("img");if(ft(m,"leaflet-image-layer"),this._zoomAnimated&&ft(m,"leaflet-zoom-animated"),this.options.className&&ft(m,this.options.className),m.onselectstart=f,m.onmousemove=f,m.onload=o(this.fire,this,"load"),m.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(m.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),u){this._url=m.src;return}m.src=this._url,m.alt=this.options.alt},_animateZoom:function(u){var m=this._map.getZoomScale(u.zoom),w=this._map._latLngBoundsToNewLayerBounds(this._bounds,u.zoom,u.center).min;jo(this._image,w,m)},_reset:function(){var u=this._image,m=new le(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),w=m.getSize();jn(u,m.min),u.style.width=w.x+"px",u.style.height=w.y+"px"},_updateOpacity:function(){hr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var u=this.options.errorOverlayUrl;u&&this._url!==u&&(this._url=u,this._image.src=u)},getCenter:function(){return this._bounds.getCenter()}}),WO=function(u,m,w){return new tf(u,m,w)},wS=tf.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var u=this._url.tagName==="VIDEO",m=this._image=u?this._url:Tt("video");if(ft(m,"leaflet-image-layer"),this._zoomAnimated&&ft(m,"leaflet-zoom-animated"),this.options.className&&ft(m,this.options.className),m.onselectstart=f,m.onmousemove=f,m.onloadeddata=o(this.fire,this,"load"),u){for(var w=m.getElementsByTagName("source"),T=[],A=0;A<w.length;A++)T.push(w[A].src);this._url=w.length>0?T:[m.src];return}k(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(m.style,"objectFit")&&(m.style.objectFit="fill"),m.autoplay=!!this.options.autoplay,m.loop=!!this.options.loop,m.muted=!!this.options.muted,m.playsInline=!!this.options.playsInline;for(var $=0;$<this._url.length;$++){var ee=Tt("source");ee.src=this._url[$],m.appendChild(ee)}}});function GO(u,m,w){return new wS(u,m,w)}var _S=tf.extend({_initImage:function(){var u=this._image=this._url;ft(u,"leaflet-image-layer"),this._zoomAnimated&&ft(u,"leaflet-zoom-animated"),this.options.className&&ft(u,this.options.className),u.onselectstart=f,u.onmousemove=f}});function YO(u,m,w){return new _S(u,m,w)}var ii=Mr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(u,m){u&&(u instanceof G||k(u))?(this._latlng=ne(u),v(this,m)):(v(this,u),this._source=m),this.options.content&&(this._content=this.options.content)},openOn:function(u){return u=arguments.length?u:this._source._map,u.hasLayer(this)||u.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(u){return this._map?this.close():(arguments.length?this._source=u:u=this._source,this._prepareOpen(),this.openOn(u._map)),this},onAdd:function(u){this._zoomAnimated=u._zoomAnimated,this._container||this._initLayout(),u._fadeAnimated&&hr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),u._fadeAnimated&&hr(this._container,1),this.bringToFront(),this.options.interactive&&(ft(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(u){u._fadeAnimated?(hr(this._container,0),this._removeTimeout=setTimeout(o(on,void 0,this._container),200)):on(this._container),this.options.interactive&&(vn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(u){return this._latlng=ne(u),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(u){return this._content=u,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var u={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Fl(this._container),this},bringToBack:function(){return this._map&&$l(this._container),this},_prepareOpen:function(u){var m=this._source;if(!m._map)return!1;if(m instanceof Di){m=null;var w=this._source._layers;for(var T in w)if(w[T]._map){m=w[T];break}if(!m)return!1;this._source=m}if(!u)if(m.getCenter)u=m.getCenter();else if(m.getLatLng)u=m.getLatLng();else if(m.getBounds)u=m.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(u),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var u=this._contentNode,m=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof m=="string")u.innerHTML=m;else{for(;u.hasChildNodes();)u.removeChild(u.firstChild);u.appendChild(m)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var u=this._map.latLngToLayerPoint(this._latlng),m=Q(this.options.offset),w=this._getAnchor();this._zoomAnimated?jn(this._container,u.add(w)):m=m.add(u).add(w);var T=this._containerBottom=-m.y,A=this._containerLeft=-Math.round(this._containerWidth/2)+m.x;this._container.style.bottom=T+"px",this._container.style.left=A+"px"}},_getAnchor:function(){return[0,0]}});St.include({_initOverlay:function(u,m,w,T){var A=m;return A instanceof u||(A=new u(T).setContent(m)),w&&A.setLatLng(w),A}}),Mr.include({_initOverlay:function(u,m,w,T){var A=w;return A instanceof u?(v(A,T),A._source=this):(A=m&&!T?m:new u(T,this),A.setContent(w)),A}});var nf=ii.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(u){return u=arguments.length?u:this._source._map,!u.hasLayer(this)&&u._popup&&u._popup.options.autoClose&&u.removeLayer(u._popup),u._popup=this,ii.prototype.openOn.call(this,u)},onAdd:function(u){ii.prototype.onAdd.call(this,u),u.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof va||this._source.on("preclick",ko))},onRemove:function(u){ii.prototype.onRemove.call(this,u),u.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof va||this._source.off("preclick",ko))},getEvents:function(){var u=ii.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(u.preclick=this.close),this.options.keepInView&&(u.moveend=this._adjustPan),u},_initLayout:function(){var u="leaflet-popup",m=this._container=Tt("div",u+" "+(this.options.className||"")+" leaflet-zoom-animated"),w=this._wrapper=Tt("div",u+"-content-wrapper",m);if(this._contentNode=Tt("div",u+"-content",w),Cd(m),py(this._contentNode),ut(m,"contextmenu",ko),this._tipContainer=Tt("div",u+"-tip-container",m),this._tip=Tt("div",u+"-tip",this._tipContainer),this.options.closeButton){var T=this._closeButton=Tt("a",u+"-close-button",m);T.setAttribute("role","button"),T.setAttribute("aria-label","Close popup"),T.href="#close",T.innerHTML='<span aria-hidden="true">&#215;</span>',ut(T,"click",function(A){Hn(A),this.close()},this)}},_updateLayout:function(){var u=this._contentNode,m=u.style;m.width="",m.whiteSpace="nowrap";var w=u.offsetWidth;w=Math.min(w,this.options.maxWidth),w=Math.max(w,this.options.minWidth),m.width=w+1+"px",m.whiteSpace="",m.height="";var T=u.offsetHeight,A=this.options.maxHeight,$="leaflet-popup-scrolled";A&&T>A?(m.height=A+"px",ft(u,$)):vn(u,$),this._containerWidth=this._container.offsetWidth},_animateZoom:function(u){var m=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center),w=this._getAnchor();jn(this._container,m.add(w))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var u=this._map,m=parseInt(_d(this._container,"marginBottom"),10)||0,w=this._container.offsetHeight+m,T=this._containerWidth,A=new B(this._containerLeft,-w-this._containerBottom);A._add(Co(this._container));var $=u.layerPointToContainerPoint(A),ee=Q(this.options.autoPanPadding),ue=Q(this.options.autoPanPaddingTopLeft||ee),me=Q(this.options.autoPanPaddingBottomRight||ee),je=u.getSize(),Le=0,et=0;$.x+T+me.x>je.x&&(Le=$.x+T-je.x+me.x),$.x-Le-ue.x<0&&(Le=$.x-ue.x),$.y+w+me.y>je.y&&(et=$.y+w-je.y+me.y),$.y-et-ue.y<0&&(et=$.y-ue.y),(Le||et)&&(this.options.keepInView&&(this._autopanning=!0),u.fire("autopanstart").panBy([Le,et]))}},_getAnchor:function(){return Q(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),ZO=function(u,m){return new nf(u,m)};St.mergeOptions({closePopupOnClick:!0}),St.include({openPopup:function(u,m,w){return this._initOverlay(nf,u,m,w).openOn(this),this},closePopup:function(u){return u=arguments.length?u:this._popup,u&&u.close(),this}}),Mr.include({bindPopup:function(u,m){return this._popup=this._initOverlay(nf,this._popup,u,m),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(u){return this._popup&&(this instanceof Di||(this._popup._source=this),this._popup._prepareOpen(u||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(u){return this._popup&&this._popup.setContent(u),this},getPopup:function(){return this._popup},_openPopup:function(u){if(!(!this._popup||!this._map)){To(u);var m=u.layer||u.target;if(this._popup._source===m&&!(m instanceof va)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(u.latlng);return}this._popup._source=m,this.openPopup(u.latlng)}},_movePopup:function(u){this._popup.setLatLng(u.latlng)},_onKeyPress:function(u){u.originalEvent.keyCode===13&&this._openPopup(u)}});var sf=ii.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(u){ii.prototype.onAdd.call(this,u),this.setOpacity(this.options.opacity),u.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(u){ii.prototype.onRemove.call(this,u),u.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var u=ii.prototype.getEvents.call(this);return this.options.permanent||(u.preclick=this.close),u},_initLayout:function(){var u="leaflet-tooltip",m=u+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Tt("div",m),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(u){var m,w,T=this._map,A=this._container,$=T.latLngToContainerPoint(T.getCenter()),ee=T.layerPointToContainerPoint(u),ue=this.options.direction,me=A.offsetWidth,je=A.offsetHeight,Le=Q(this.options.offset),et=this._getAnchor();ue==="top"?(m=me/2,w=je):ue==="bottom"?(m=me/2,w=0):ue==="center"?(m=me/2,w=je/2):ue==="right"?(m=0,w=je/2):ue==="left"?(m=me,w=je/2):ee.x<$.x?(ue="right",m=0,w=je/2):(ue="left",m=me+(Le.x+et.x)*2,w=je/2),u=u.subtract(Q(m,w,!0)).add(Le).add(et),vn(A,"leaflet-tooltip-right"),vn(A,"leaflet-tooltip-left"),vn(A,"leaflet-tooltip-top"),vn(A,"leaflet-tooltip-bottom"),ft(A,"leaflet-tooltip-"+ue),jn(A,u)},_updatePosition:function(){var u=this._map.latLngToLayerPoint(this._latlng);this._setPosition(u)},setOpacity:function(u){this.options.opacity=u,this._container&&hr(this._container,u)},_animateZoom:function(u){var m=this._map._latLngToNewLayerPoint(this._latlng,u.zoom,u.center);this._setPosition(m)},_getAnchor:function(){return Q(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),KO=function(u,m){return new sf(u,m)};St.include({openTooltip:function(u,m,w){return this._initOverlay(sf,u,m,w).openOn(this),this},closeTooltip:function(u){return u.close(),this}}),Mr.include({bindTooltip:function(u,m){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(sf,this._tooltip,u,m),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(u){if(!(!u&&this._tooltipHandlersAdded)){var m=u?"off":"on",w={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?w.add=this._openTooltip:(w.mouseover=this._openTooltip,w.mouseout=this.closeTooltip,w.click=this._openTooltip,this._map?this._addFocusListeners():w.add=this._addFocusListeners),this._tooltip.options.sticky&&(w.mousemove=this._moveTooltip),this[m](w),this._tooltipHandlersAdded=!u}},openTooltip:function(u){return this._tooltip&&(this instanceof Di||(this._tooltip._source=this),this._tooltip._prepareOpen(u)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(u){return this._tooltip&&this._tooltip.setContent(u),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(u){var m=typeof u.getElement=="function"&&u.getElement();m&&(ut(m,"focus",function(){this._tooltip._source=u,this.openTooltip()},this),ut(m,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(u){var m=typeof u.getElement=="function"&&u.getElement();m&&m.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(u){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var m=this;this._map.once("moveend",function(){m._openOnceFlag=!1,m._openTooltip(u)});return}this._tooltip._source=u.layer||u.target,this.openTooltip(this._tooltip.options.sticky?u.latlng:void 0)}},_moveTooltip:function(u){var m=u.latlng,w,T;this._tooltip.options.sticky&&u.originalEvent&&(w=this._map.mouseEventToContainerPoint(u.originalEvent),T=this._map.containerPointToLayerPoint(w),m=this._map.layerPointToLatLng(T)),this._tooltip.setLatLng(m)}});var SS=Ul.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(u){var m=u&&u.tagName==="DIV"?u:document.createElement("div"),w=this.options;if(w.html instanceof Element?(Bh(m),m.appendChild(w.html)):m.innerHTML=w.html!==!1?w.html:"",w.bgPos){var T=Q(w.bgPos);m.style.backgroundPosition=-T.x+"px "+-T.y+"px"}return this._setIconStyles(m,"icon"),m},createShadow:function(){return null}});function JO(u){return new SS(u)}Ul.Default=Ed;var Pd=Mr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:We.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(u){v(this,u)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(u){u._addZoomLimit(this)},onRemove:function(u){this._removeAllTiles(),on(this._container),u._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Fl(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&($l(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(u){return this.options.opacity=u,this._updateOpacity(),this},setZIndex:function(u){return this.options.zIndex=u,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var u=this._clampZoom(this._map.getZoom());u!==this._tileZoom&&(this._tileZoom=u,this._updateLevels()),this._update()}return this},getEvents:function(){var u={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),u.move=this._onMove),this._zoomAnimated&&(u.zoomanim=this._animateZoom),u},createTile:function(){return document.createElement("div")},getTileSize:function(){var u=this.options.tileSize;return u instanceof B?u:new B(u,u)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(u){for(var m=this.getPane().children,w=-u(-1/0,1/0),T=0,A=m.length,$;T<A;T++)$=m[T].style.zIndex,m[T]!==this._container&&$&&(w=u(w,+$));isFinite(w)&&(this.options.zIndex=w+u(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!We.ielt9){hr(this._container,this.options.opacity);var u=+new Date,m=!1,w=!1;for(var T in this._tiles){var A=this._tiles[T];if(!(!A.current||!A.loaded)){var $=Math.min(1,(u-A.loaded)/200);hr(A.el,$),$<1?m=!0:(A.active?w=!0:this._onOpaqueTile(A),A.active=!0)}}w&&!this._noPrune&&this._pruneTiles(),m&&(H(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this))}},_onOpaqueTile:f,_initContainer:function(){this._container||(this._container=Tt("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var u=this._tileZoom,m=this.options.maxZoom;if(u!==void 0){for(var w in this._levels)w=Number(w),this._levels[w].el.children.length||w===u?(this._levels[w].el.style.zIndex=m-Math.abs(u-w),this._onUpdateLevel(w)):(on(this._levels[w].el),this._removeTilesAtZoom(w),this._onRemoveLevel(w),delete this._levels[w]);var T=this._levels[u],A=this._map;return T||(T=this._levels[u]={},T.el=Tt("div","leaflet-tile-container leaflet-zoom-animated",this._container),T.el.style.zIndex=m,T.origin=A.project(A.unproject(A.getPixelOrigin()),u).round(),T.zoom=u,this._setZoomTransform(T,A.getCenter(),A.getZoom()),f(T.el.offsetWidth),this._onCreateLevel(T)),this._level=T,T}},_onUpdateLevel:f,_onRemoveLevel:f,_onCreateLevel:f,_pruneTiles:function(){if(this._map){var u,m,w=this._map.getZoom();if(w>this.options.maxZoom||w<this.options.minZoom){this._removeAllTiles();return}for(u in this._tiles)m=this._tiles[u],m.retain=m.current;for(u in this._tiles)if(m=this._tiles[u],m.current&&!m.active){var T=m.coords;this._retainParent(T.x,T.y,T.z,T.z-5)||this._retainChildren(T.x,T.y,T.z,T.z+2)}for(u in this._tiles)this._tiles[u].retain||this._removeTile(u)}},_removeTilesAtZoom:function(u){for(var m in this._tiles)this._tiles[m].coords.z===u&&this._removeTile(m)},_removeAllTiles:function(){for(var u in this._tiles)this._removeTile(u)},_invalidateAll:function(){for(var u in this._levels)on(this._levels[u].el),this._onRemoveLevel(Number(u)),delete this._levels[u];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(u,m,w,T){var A=Math.floor(u/2),$=Math.floor(m/2),ee=w-1,ue=new B(+A,+$);ue.z=+ee;var me=this._tileCoordsToKey(ue),je=this._tiles[me];return je&&je.active?(je.retain=!0,!0):(je&&je.loaded&&(je.retain=!0),ee>T?this._retainParent(A,$,ee,T):!1)},_retainChildren:function(u,m,w,T){for(var A=2*u;A<2*u+2;A++)for(var $=2*m;$<2*m+2;$++){var ee=new B(A,$);ee.z=w+1;var ue=this._tileCoordsToKey(ee),me=this._tiles[ue];if(me&&me.active){me.retain=!0;continue}else me&&me.loaded&&(me.retain=!0);w+1<T&&this._retainChildren(A,$,w+1,T)}},_resetView:function(u){var m=u&&(u.pinch||u.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),m,m)},_animateZoom:function(u){this._setView(u.center,u.zoom,!0,u.noUpdate)},_clampZoom:function(u){var m=this.options;return m.minNativeZoom!==void 0&&u<m.minNativeZoom?m.minNativeZoom:m.maxNativeZoom!==void 0&&m.maxNativeZoom<u?m.maxNativeZoom:u},_setView:function(u,m,w,T){var A=Math.round(m);this.options.maxZoom!==void 0&&A>this.options.maxZoom||this.options.minZoom!==void 0&&A<this.options.minZoom?A=void 0:A=this._clampZoom(A);var $=this.options.updateWhenZooming&&A!==this._tileZoom;(!T||$)&&(this._tileZoom=A,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),A!==void 0&&this._update(u),w||this._pruneTiles(),this._noPrune=!!w),this._setZoomTransforms(u,m)},_setZoomTransforms:function(u,m){for(var w in this._levels)this._setZoomTransform(this._levels[w],u,m)},_setZoomTransform:function(u,m,w){var T=this._map.getZoomScale(w,u.zoom),A=u.origin.multiplyBy(T).subtract(this._map._getNewPixelOrigin(m,w)).round();We.any3d?jo(u.el,A,T):jn(u.el,A)},_resetGrid:function(){var u=this._map,m=u.options.crs,w=this._tileSize=this.getTileSize(),T=this._tileZoom,A=this._map.getPixelWorldBounds(this._tileZoom);A&&(this._globalTileRange=this._pxBoundsToTileRange(A)),this._wrapX=m.wrapLng&&!this.options.noWrap&&[Math.floor(u.project([0,m.wrapLng[0]],T).x/w.x),Math.ceil(u.project([0,m.wrapLng[1]],T).x/w.y)],this._wrapY=m.wrapLat&&!this.options.noWrap&&[Math.floor(u.project([m.wrapLat[0],0],T).y/w.x),Math.ceil(u.project([m.wrapLat[1],0],T).y/w.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(u){var m=this._map,w=m._animatingZoom?Math.max(m._animateToZoom,m.getZoom()):m.getZoom(),T=m.getZoomScale(w,this._tileZoom),A=m.project(u,this._tileZoom).floor(),$=m.getSize().divideBy(T*2);return new le(A.subtract($),A.add($))},_update:function(u){var m=this._map;if(m){var w=this._clampZoom(m.getZoom());if(u===void 0&&(u=m.getCenter()),this._tileZoom!==void 0){var T=this._getTiledPixelBounds(u),A=this._pxBoundsToTileRange(T),$=A.getCenter(),ee=[],ue=this.options.keepBuffer,me=new le(A.getBottomLeft().subtract([ue,-ue]),A.getTopRight().add([ue,-ue]));if(!(isFinite(A.min.x)&&isFinite(A.min.y)&&isFinite(A.max.x)&&isFinite(A.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var je in this._tiles){var Le=this._tiles[je].coords;(Le.z!==this._tileZoom||!me.contains(new B(Le.x,Le.y)))&&(this._tiles[je].current=!1)}if(Math.abs(w-this._tileZoom)>1){this._setView(u,w);return}for(var et=A.min.y;et<=A.max.y;et++)for(var yt=A.min.x;yt<=A.max.x;yt++){var fs=new B(yt,et);if(fs.z=this._tileZoom,!!this._isValidTile(fs)){var Un=this._tiles[this._tileCoordsToKey(fs)];Un?Un.current=!0:ee.push(fs)}}if(ee.sort(function(ks,Hl){return ks.distanceTo($)-Hl.distanceTo($)}),ee.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var mr=document.createDocumentFragment();for(yt=0;yt<ee.length;yt++)this._addTile(ee[yt],mr);this._level.el.appendChild(mr)}}}},_isValidTile:function(u){var m=this._map.options.crs;if(!m.infinite){var w=this._globalTileRange;if(!m.wrapLng&&(u.x<w.min.x||u.x>w.max.x)||!m.wrapLat&&(u.y<w.min.y||u.y>w.max.y))return!1}if(!this.options.bounds)return!0;var T=this._tileCoordsToBounds(u);return se(this.options.bounds).overlaps(T)},_keyToBounds:function(u){return this._tileCoordsToBounds(this._keyToTileCoords(u))},_tileCoordsToNwSe:function(u){var m=this._map,w=this.getTileSize(),T=u.scaleBy(w),A=T.add(w),$=m.unproject(T,u.z),ee=m.unproject(A,u.z);return[$,ee]},_tileCoordsToBounds:function(u){var m=this._tileCoordsToNwSe(u),w=new Z(m[0],m[1]);return this.options.noWrap||(w=this._map.wrapLatLngBounds(w)),w},_tileCoordsToKey:function(u){return u.x+":"+u.y+":"+u.z},_keyToTileCoords:function(u){var m=u.split(":"),w=new B(+m[0],+m[1]);return w.z=+m[2],w},_removeTile:function(u){var m=this._tiles[u];m&&(on(m.el),delete this._tiles[u],this.fire("tileunload",{tile:m.el,coords:this._keyToTileCoords(u)}))},_initTile:function(u){ft(u,"leaflet-tile");var m=this.getTileSize();u.style.width=m.x+"px",u.style.height=m.y+"px",u.onselectstart=f,u.onmousemove=f,We.ielt9&&this.options.opacity<1&&hr(u,this.options.opacity)},_addTile:function(u,m){var w=this._getTilePos(u),T=this._tileCoordsToKey(u),A=this.createTile(this._wrapCoords(u),o(this._tileReady,this,u));this._initTile(A),this.createTile.length<2&&z(o(this._tileReady,this,u,null,A)),jn(A,w),this._tiles[T]={el:A,coords:u,current:!0},m.appendChild(A),this.fire("tileloadstart",{tile:A,coords:u})},_tileReady:function(u,m,w){m&&this.fire("tileerror",{error:m,tile:w,coords:u});var T=this._tileCoordsToKey(u);w=this._tiles[T],w&&(w.loaded=+new Date,this._map._fadeAnimated?(hr(w.el,0),H(this._fadeFrame),this._fadeFrame=z(this._updateOpacity,this)):(w.active=!0,this._pruneTiles()),m||(ft(w.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:w.el,coords:u})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),We.ielt9||!this._map._fadeAnimated?z(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(u){return u.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(u){var m=new B(this._wrapX?h(u.x,this._wrapX):u.x,this._wrapY?h(u.y,this._wrapY):u.y);return m.z=u.z,m},_pxBoundsToTileRange:function(u){var m=this.getTileSize();return new le(u.min.unscaleBy(m).floor(),u.max.unscaleBy(m).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var u in this._tiles)if(!this._tiles[u].loaded)return!1;return!0}});function QO(u){return new Pd(u)}var ql=Pd.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(u,m){this._url=u,m=v(this,m),m.detectRetina&&We.retina&&m.maxZoom>0?(m.tileSize=Math.floor(m.tileSize/2),m.zoomReverse?(m.zoomOffset--,m.minZoom=Math.min(m.maxZoom,m.minZoom+1)):(m.zoomOffset++,m.maxZoom=Math.max(m.minZoom,m.maxZoom-1)),m.minZoom=Math.max(0,m.minZoom)):m.zoomReverse?m.minZoom=Math.min(m.maxZoom,m.minZoom):m.maxZoom=Math.max(m.minZoom,m.maxZoom),typeof m.subdomains=="string"&&(m.subdomains=m.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(u,m){return this._url===u&&m===void 0&&(m=!0),this._url=u,m||this.redraw(),this},createTile:function(u,m){var w=document.createElement("img");return ut(w,"load",o(this._tileOnLoad,this,m,w)),ut(w,"error",o(this._tileOnError,this,m,w)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(w.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(w.referrerPolicy=this.options.referrerPolicy),w.alt="",w.src=this.getTileUrl(u),w},getTileUrl:function(u){var m={r:We.retina?"@2x":"",s:this._getSubdomain(u),x:u.x,y:u.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var w=this._globalTileRange.max.y-u.y;this.options.tms&&(m.y=w),m["-y"]=w}return j(this._url,r(m,this.options))},_tileOnLoad:function(u,m){We.ielt9?setTimeout(o(u,this,null,m),0):u(null,m)},_tileOnError:function(u,m,w){var T=this.options.errorTileUrl;T&&m.getAttribute("src")!==T&&(m.src=T),u(w,m)},_onTileRemove:function(u){u.tile.onload=null},_getZoomForUrl:function(){var u=this._tileZoom,m=this.options.maxZoom,w=this.options.zoomReverse,T=this.options.zoomOffset;return w&&(u=m-u),u+T},_getSubdomain:function(u){var m=Math.abs(u.x+u.y)%this.options.subdomains.length;return this.options.subdomains[m]},_abortLoading:function(){var u,m;for(u in this._tiles)if(this._tiles[u].coords.z!==this._tileZoom&&(m=this._tiles[u].el,m.onload=f,m.onerror=f,!m.complete)){m.src=P;var w=this._tiles[u].coords;on(m),delete this._tiles[u],this.fire("tileabort",{tile:m,coords:w})}},_removeTile:function(u){var m=this._tiles[u];if(m)return m.el.setAttribute("src",P),Pd.prototype._removeTile.call(this,u)},_tileReady:function(u,m,w){if(!(!this._map||w&&w.getAttribute("src")===P))return Pd.prototype._tileReady.call(this,u,m,w)}});function NS(u,m){return new ql(u,m)}var jS=ql.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(u,m){this._url=u;var w=r({},this.defaultWmsParams);for(var T in m)T in this.options||(w[T]=m[T]);m=v(this,m);var A=m.detectRetina&&We.retina?2:1,$=this.getTileSize();w.width=$.x*A,w.height=$.y*A,this.wmsParams=w},onAdd:function(u){this._crs=this.options.crs||u.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var m=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[m]=this._crs.code,ql.prototype.onAdd.call(this,u)},getTileUrl:function(u){var m=this._tileCoordsToNwSe(u),w=this._crs,T=X(w.project(m[0]),w.project(m[1])),A=T.min,$=T.max,ee=(this._wmsVersion>=1.3&&this._crs===yS?[A.y,A.x,$.y,$.x]:[A.x,A.y,$.x,$.y]).join(","),ue=ql.prototype.getTileUrl.call(this,u);return ue+_(this.wmsParams,ue,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+ee},setParams:function(u,m){return r(this.wmsParams,u),m||this.redraw(),this}});function XO(u,m){return new jS(u,m)}ql.WMS=jS,NS.wms=XO;var Oi=Mr.extend({options:{padding:.1},initialize:function(u){v(this,u),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),ft(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var u={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(u.zoomanim=this._onAnimZoom),u},_onAnimZoom:function(u){this._updateTransform(u.center,u.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(u,m){var w=this._map.getZoomScale(m,this._zoom),T=this._map.getSize().multiplyBy(.5+this.options.padding),A=this._map.project(this._center,m),$=T.multiplyBy(-w).add(A).subtract(this._map._getNewPixelOrigin(u,m));We.any3d?jo(this._container,$,w):jn(this._container,$)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var u in this._layers)this._layers[u]._reset()},_onZoomEnd:function(){for(var u in this._layers)this._layers[u]._project()},_updatePaths:function(){for(var u in this._layers)this._layers[u]._update()},_update:function(){var u=this.options.padding,m=this._map.getSize(),w=this._map.containerPointToLayerPoint(m.multiplyBy(-u)).round();this._bounds=new le(w,w.add(m.multiplyBy(1+u*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),CS=Oi.extend({options:{tolerance:0},getEvents:function(){var u=Oi.prototype.getEvents.call(this);return u.viewprereset=this._onViewPreReset,u},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Oi.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var u=this._container=document.createElement("canvas");ut(u,"mousemove",this._onMouseMove,this),ut(u,"click dblclick mousedown mouseup contextmenu",this._onClick,this),ut(u,"mouseout",this._handleMouseOut,this),u._leaflet_disable_events=!0,this._ctx=u.getContext("2d")},_destroyContainer:function(){H(this._redrawRequest),delete this._ctx,on(this._container),qt(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var u;this._redrawBounds=null;for(var m in this._layers)u=this._layers[m],u._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Oi.prototype._update.call(this);var u=this._bounds,m=this._container,w=u.getSize(),T=We.retina?2:1;jn(m,u.min),m.width=T*w.x,m.height=T*w.y,m.style.width=w.x+"px",m.style.height=w.y+"px",We.retina&&this._ctx.scale(2,2),this._ctx.translate(-u.min.x,-u.min.y),this.fire("update")}},_reset:function(){Oi.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(u){this._updateDashArray(u),this._layers[c(u)]=u;var m=u._order={layer:u,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=m),this._drawLast=m,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(u){this._requestRedraw(u)},_removePath:function(u){var m=u._order,w=m.next,T=m.prev;w?w.prev=T:this._drawLast=T,T?T.next=w:this._drawFirst=w,delete u._order,delete this._layers[c(u)],this._requestRedraw(u)},_updatePath:function(u){this._extendRedrawBounds(u),u._project(),u._update(),this._requestRedraw(u)},_updateStyle:function(u){this._updateDashArray(u),this._requestRedraw(u)},_updateDashArray:function(u){if(typeof u.options.dashArray=="string"){var m=u.options.dashArray.split(/[, ]+/),w=[],T,A;for(A=0;A<m.length;A++){if(T=Number(m[A]),isNaN(T))return;w.push(T)}u.options._dashArray=w}else u.options._dashArray=u.options.dashArray},_requestRedraw:function(u){this._map&&(this._extendRedrawBounds(u),this._redrawRequest=this._redrawRequest||z(this._redraw,this))},_extendRedrawBounds:function(u){if(u._pxBounds){var m=(u.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new le,this._redrawBounds.extend(u._pxBounds.min.subtract([m,m])),this._redrawBounds.extend(u._pxBounds.max.add([m,m]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var u=this._redrawBounds;if(u){var m=u.getSize();this._ctx.clearRect(u.min.x,u.min.y,m.x,m.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var u,m=this._redrawBounds;if(this._ctx.save(),m){var w=m.getSize();this._ctx.beginPath(),this._ctx.rect(m.min.x,m.min.y,w.x,w.y),this._ctx.clip()}this._drawing=!0;for(var T=this._drawFirst;T;T=T.next)u=T.layer,(!m||u._pxBounds&&u._pxBounds.intersects(m))&&u._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(u,m){if(this._drawing){var w,T,A,$,ee=u._parts,ue=ee.length,me=this._ctx;if(ue){for(me.beginPath(),w=0;w<ue;w++){for(T=0,A=ee[w].length;T<A;T++)$=ee[w][T],me[T?"lineTo":"moveTo"]($.x,$.y);m&&me.closePath()}this._fillStroke(me,u)}}},_updateCircle:function(u){if(!(!this._drawing||u._empty())){var m=u._point,w=this._ctx,T=Math.max(Math.round(u._radius),1),A=(Math.max(Math.round(u._radiusY),1)||T)/T;A!==1&&(w.save(),w.scale(1,A)),w.beginPath(),w.arc(m.x,m.y/A,T,0,Math.PI*2,!1),A!==1&&w.restore(),this._fillStroke(w,u)}},_fillStroke:function(u,m){var w=m.options;w.fill&&(u.globalAlpha=w.fillOpacity,u.fillStyle=w.fillColor||w.color,u.fill(w.fillRule||"evenodd")),w.stroke&&w.weight!==0&&(u.setLineDash&&u.setLineDash(m.options&&m.options._dashArray||[]),u.globalAlpha=w.opacity,u.lineWidth=w.weight,u.strokeStyle=w.color,u.lineCap=w.lineCap,u.lineJoin=w.lineJoin,u.stroke())},_onClick:function(u){for(var m=this._map.mouseEventToLayerPoint(u),w,T,A=this._drawFirst;A;A=A.next)w=A.layer,w.options.interactive&&w._containsPoint(m)&&(!(u.type==="click"||u.type==="preclick")||!this._map._draggableMoved(w))&&(T=w);this._fireEvent(T?[T]:!1,u)},_onMouseMove:function(u){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var m=this._map.mouseEventToLayerPoint(u);this._handleMouseHover(u,m)}},_handleMouseOut:function(u){var m=this._hoveredLayer;m&&(vn(this._container,"leaflet-interactive"),this._fireEvent([m],u,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(u,m){if(!this._mouseHoverThrottled){for(var w,T,A=this._drawFirst;A;A=A.next)w=A.layer,w.options.interactive&&w._containsPoint(m)&&(T=w);T!==this._hoveredLayer&&(this._handleMouseOut(u),T&&(ft(this._container,"leaflet-interactive"),this._fireEvent([T],u,"mouseover"),this._hoveredLayer=T)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,u),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(u,m,w){this._map._fireDOMEvent(m,w||m.type,u)},_bringToFront:function(u){var m=u._order;if(m){var w=m.next,T=m.prev;if(w)w.prev=T;else return;T?T.next=w:w&&(this._drawFirst=w),m.prev=this._drawLast,this._drawLast.next=m,m.next=null,this._drawLast=m,this._requestRedraw(u)}},_bringToBack:function(u){var m=u._order;if(m){var w=m.next,T=m.prev;if(T)T.next=w;else return;w?w.prev=T:T&&(this._drawLast=T),m.prev=null,m.next=this._drawFirst,this._drawFirst.prev=m,this._drawFirst=m,this._requestRedraw(u)}}});function kS(u){return We.canvas?new CS(u):null}var Md=function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(u){return document.createElement("<lvml:"+u+' class="lvml">')}}catch{}return function(u){return document.createElement("<"+u+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}}(),eR={_initContainer:function(){this._container=Tt("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Oi.prototype._update.call(this),this.fire("update"))},_initPath:function(u){var m=u._container=Md("shape");ft(m,"leaflet-vml-shape "+(this.options.className||"")),m.coordsize="1 1",u._path=Md("path"),m.appendChild(u._path),this._updateStyle(u),this._layers[c(u)]=u},_addPath:function(u){var m=u._container;this._container.appendChild(m),u.options.interactive&&u.addInteractiveTarget(m)},_removePath:function(u){var m=u._container;on(m),u.removeInteractiveTarget(m),delete this._layers[c(u)]},_updateStyle:function(u){var m=u._stroke,w=u._fill,T=u.options,A=u._container;A.stroked=!!T.stroke,A.filled=!!T.fill,T.stroke?(m||(m=u._stroke=Md("stroke")),A.appendChild(m),m.weight=T.weight+"px",m.color=T.color,m.opacity=T.opacity,T.dashArray?m.dashStyle=k(T.dashArray)?T.dashArray.join(" "):T.dashArray.replace(/( *, *)/g," "):m.dashStyle="",m.endcap=T.lineCap.replace("butt","flat"),m.joinstyle=T.lineJoin):m&&(A.removeChild(m),u._stroke=null),T.fill?(w||(w=u._fill=Md("fill")),A.appendChild(w),w.color=T.fillColor||T.color,w.opacity=T.fillOpacity):w&&(A.removeChild(w),u._fill=null)},_updateCircle:function(u){var m=u._point.round(),w=Math.round(u._radius),T=Math.round(u._radiusY||w);this._setPath(u,u._empty()?"M0 0":"AL "+m.x+","+m.y+" "+w+","+T+" 0,"+65535*360)},_setPath:function(u,m){u._path.v=m},_bringToFront:function(u){Fl(u._container)},_bringToBack:function(u){$l(u._container)}},rf=We.vml?Md:Oe,Dd=Oi.extend({_initContainer:function(){this._container=rf("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=rf("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){on(this._container),qt(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Oi.prototype._update.call(this);var u=this._bounds,m=u.getSize(),w=this._container;(!this._svgSize||!this._svgSize.equals(m))&&(this._svgSize=m,w.setAttribute("width",m.x),w.setAttribute("height",m.y)),jn(w,u.min),w.setAttribute("viewBox",[u.min.x,u.min.y,m.x,m.y].join(" ")),this.fire("update")}},_initPath:function(u){var m=u._path=rf("path");u.options.className&&ft(m,u.options.className),u.options.interactive&&ft(m,"leaflet-interactive"),this._updateStyle(u),this._layers[c(u)]=u},_addPath:function(u){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(u._path),u.addInteractiveTarget(u._path)},_removePath:function(u){on(u._path),u.removeInteractiveTarget(u._path),delete this._layers[c(u)]},_updatePath:function(u){u._project(),u._update()},_updateStyle:function(u){var m=u._path,w=u.options;m&&(w.stroke?(m.setAttribute("stroke",w.color),m.setAttribute("stroke-opacity",w.opacity),m.setAttribute("stroke-width",w.weight),m.setAttribute("stroke-linecap",w.lineCap),m.setAttribute("stroke-linejoin",w.lineJoin),w.dashArray?m.setAttribute("stroke-dasharray",w.dashArray):m.removeAttribute("stroke-dasharray"),w.dashOffset?m.setAttribute("stroke-dashoffset",w.dashOffset):m.removeAttribute("stroke-dashoffset")):m.setAttribute("stroke","none"),w.fill?(m.setAttribute("fill",w.fillColor||w.color),m.setAttribute("fill-opacity",w.fillOpacity),m.setAttribute("fill-rule",w.fillRule||"evenodd")):m.setAttribute("fill","none"))},_updatePoly:function(u,m){this._setPath(u,Je(u._parts,m))},_updateCircle:function(u){var m=u._point,w=Math.max(Math.round(u._radius),1),T=Math.max(Math.round(u._radiusY),1)||w,A="a"+w+","+T+" 0 1,0 ",$=u._empty()?"M0 0":"M"+(m.x-w)+","+m.y+A+w*2+",0 "+A+-w*2+",0 ";this._setPath(u,$)},_setPath:function(u,m){u._path.setAttribute("d",m)},_bringToFront:function(u){Fl(u._path)},_bringToBack:function(u){$l(u._path)}});We.vml&&Dd.include(eR);function TS(u){return We.svg||We.vml?new Dd(u):null}St.include({getRenderer:function(u){var m=u.options.renderer||this._getPaneRenderer(u.options.pane)||this.options.renderer||this._renderer;return m||(m=this._renderer=this._createRenderer()),this.hasLayer(m)||this.addLayer(m),m},_getPaneRenderer:function(u){if(u==="overlayPane"||u===void 0)return!1;var m=this._paneRenderers[u];return m===void 0&&(m=this._createRenderer({pane:u}),this._paneRenderers[u]=m),m},_createRenderer:function(u){return this.options.preferCanvas&&kS(u)||TS(u)}});var ES=Vl.extend({initialize:function(u,m){Vl.prototype.initialize.call(this,this._boundsToLatLngs(u),m)},setBounds:function(u){return this.setLatLngs(this._boundsToLatLngs(u))},_boundsToLatLngs:function(u){return u=se(u),[u.getSouthWest(),u.getNorthWest(),u.getNorthEast(),u.getSouthEast()]}});function tR(u,m){return new ES(u,m)}Dd.create=rf,Dd.pointsToPath=Je,Ii.geometryToLayer=Jh,Ii.coordsToLatLng=Ny,Ii.coordsToLatLngs=Qh,Ii.latLngToCoords=jy,Ii.latLngsToCoords=Xh,Ii.getFeature=Bl,Ii.asFeature=ef,St.mergeOptions({boxZoom:!0});var PS=ri.extend({initialize:function(u){this._map=u,this._container=u._container,this._pane=u._panes.overlayPane,this._resetStateTimeout=0,u.on("unload",this._destroy,this)},addHooks:function(){ut(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){qt(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){on(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(u){if(!u.shiftKey||u.which!==1&&u.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Sd(),oy(),this._startPoint=this._map.mouseEventToContainerPoint(u),ut(document,{contextmenu:To,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(u){this._moved||(this._moved=!0,this._box=Tt("div","leaflet-zoom-box",this._container),ft(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(u);var m=new le(this._point,this._startPoint),w=m.getSize();jn(this._box,m.min),this._box.style.width=w.x+"px",this._box.style.height=w.y+"px"},_finish:function(){this._moved&&(on(this._box),vn(this._container,"leaflet-crosshair")),Nd(),ly(),qt(document,{contextmenu:To,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(u){if(!(u.which!==1&&u.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var m=new Z(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(m).fire("boxzoomend",{boxZoomBounds:m})}},_onKeyDown:function(u){u.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});St.addInitHook("addHandler","boxZoom",PS),St.mergeOptions({doubleClickZoom:!0});var MS=ri.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(u){var m=this._map,w=m.getZoom(),T=m.options.zoomDelta,A=u.originalEvent.shiftKey?w-T:w+T;m.options.doubleClickZoom==="center"?m.setZoom(A):m.setZoomAround(u.containerPoint,A)}});St.addInitHook("addHandler","doubleClickZoom",MS),St.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var DS=ri.extend({addHooks:function(){if(!this._draggable){var u=this._map;this._draggable=new xa(u._mapPane,u._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),u.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),u.on("zoomend",this._onZoomEnd,this),u.whenReady(this._onZoomEnd,this))}ft(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){vn(this._map._container,"leaflet-grab"),vn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var u=this._map;if(u._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var m=se(this._map.options.maxBounds);this._offsetLimit=X(this._map.latLngToContainerPoint(m.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(m.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;u.fire("movestart").fire("dragstart"),u.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(u){if(this._map.options.inertia){var m=this._lastTime=+new Date,w=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(w),this._times.push(m),this._prunePositions(m)}this._map.fire("move",u).fire("drag",u)},_prunePositions:function(u){for(;this._positions.length>1&&u-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var u=this._map.getSize().divideBy(2),m=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=m.subtract(u).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(u,m){return u-(u-m)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var u=this._draggable._newPos.subtract(this._draggable._startPos),m=this._offsetLimit;u.x<m.min.x&&(u.x=this._viscousLimit(u.x,m.min.x)),u.y<m.min.y&&(u.y=this._viscousLimit(u.y,m.min.y)),u.x>m.max.x&&(u.x=this._viscousLimit(u.x,m.max.x)),u.y>m.max.y&&(u.y=this._viscousLimit(u.y,m.max.y)),this._draggable._newPos=this._draggable._startPos.add(u)}},_onPreDragWrap:function(){var u=this._worldWidth,m=Math.round(u/2),w=this._initialWorldOffset,T=this._draggable._newPos.x,A=(T-m+w)%u+m-w,$=(T+m+w)%u-m-w,ee=Math.abs(A+w)<Math.abs($+w)?A:$;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=ee},_onDragEnd:function(u){var m=this._map,w=m.options,T=!w.inertia||u.noInertia||this._times.length<2;if(m.fire("dragend",u),T)m.fire("moveend");else{this._prunePositions(+new Date);var A=this._lastPos.subtract(this._positions[0]),$=(this._lastTime-this._times[0])/1e3,ee=w.easeLinearity,ue=A.multiplyBy(ee/$),me=ue.distanceTo([0,0]),je=Math.min(w.inertiaMaxSpeed,me),Le=ue.multiplyBy(je/me),et=je/(w.inertiaDeceleration*ee),yt=Le.multiplyBy(-et/2).round();!yt.x&&!yt.y?m.fire("moveend"):(yt=m._limitOffset(yt,m.options.maxBounds),z(function(){m.panBy(yt,{duration:et,easeLinearity:ee,noMoveStart:!0,animate:!0})}))}}});St.addInitHook("addHandler","dragging",DS),St.mergeOptions({keyboard:!0,keyboardPanDelta:80});var AS=ri.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(u){this._map=u,this._setPanDelta(u.options.keyboardPanDelta),this._setZoomDelta(u.options.zoomDelta)},addHooks:function(){var u=this._map._container;u.tabIndex<=0&&(u.tabIndex="0"),ut(u,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),qt(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var u=document.body,m=document.documentElement,w=u.scrollTop||m.scrollTop,T=u.scrollLeft||m.scrollLeft;this._map._container.focus(),window.scrollTo(T,w)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(u){var m=this._panKeys={},w=this.keyCodes,T,A;for(T=0,A=w.left.length;T<A;T++)m[w.left[T]]=[-1*u,0];for(T=0,A=w.right.length;T<A;T++)m[w.right[T]]=[u,0];for(T=0,A=w.down.length;T<A;T++)m[w.down[T]]=[0,u];for(T=0,A=w.up.length;T<A;T++)m[w.up[T]]=[0,-1*u]},_setZoomDelta:function(u){var m=this._zoomKeys={},w=this.keyCodes,T,A;for(T=0,A=w.zoomIn.length;T<A;T++)m[w.zoomIn[T]]=u;for(T=0,A=w.zoomOut.length;T<A;T++)m[w.zoomOut[T]]=-u},_addHooks:function(){ut(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){qt(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(u){if(!(u.altKey||u.ctrlKey||u.metaKey)){var m=u.keyCode,w=this._map,T;if(m in this._panKeys){if(!w._panAnim||!w._panAnim._inProgress)if(T=this._panKeys[m],u.shiftKey&&(T=Q(T).multiplyBy(3)),w.options.maxBounds&&(T=w._limitOffset(Q(T),w.options.maxBounds)),w.options.worldCopyJump){var A=w.wrapLatLng(w.unproject(w.project(w.getCenter()).add(T)));w.panTo(A)}else w.panBy(T)}else if(m in this._zoomKeys)w.setZoom(w.getZoom()+(u.shiftKey?3:1)*this._zoomKeys[m]);else if(m===27&&w._popup&&w._popup.options.closeOnEscapeKey)w.closePopup();else return;To(u)}}});St.addInitHook("addHandler","keyboard",AS),St.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var IS=ri.extend({addHooks:function(){ut(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){qt(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(u){var m=rS(u),w=this._map.options.wheelDebounceTime;this._delta+=m,this._lastMousePos=this._map.mouseEventToContainerPoint(u),this._startTime||(this._startTime=+new Date);var T=Math.max(w-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),T),To(u)},_performZoom:function(){var u=this._map,m=u.getZoom(),w=this._map.options.zoomSnap||0;u._stop();var T=this._delta/(this._map.options.wheelPxPerZoomLevel*4),A=4*Math.log(2/(1+Math.exp(-Math.abs(T))))/Math.LN2,$=w?Math.ceil(A/w)*w:A,ee=u._limitZoom(m+(this._delta>0?$:-$))-m;this._delta=0,this._startTime=null,ee&&(u.options.scrollWheelZoom==="center"?u.setZoom(m+ee):u.setZoomAround(this._lastMousePos,m+ee))}});St.addInitHook("addHandler","scrollWheelZoom",IS);var nR=600;St.mergeOptions({tapHold:We.touchNative&&We.safari&&We.mobile,tapTolerance:15});var OS=ri.extend({addHooks:function(){ut(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){qt(this._map._container,"touchstart",this._onDown,this)},_onDown:function(u){if(clearTimeout(this._holdTimeout),u.touches.length===1){var m=u.touches[0];this._startPos=this._newPos=new B(m.clientX,m.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(ut(document,"touchend",Hn),ut(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",m))},this),nR),ut(document,"touchend touchcancel contextmenu",this._cancel,this),ut(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function u(){qt(document,"touchend",Hn),qt(document,"touchend touchcancel",u)},_cancel:function(){clearTimeout(this._holdTimeout),qt(document,"touchend touchcancel contextmenu",this._cancel,this),qt(document,"touchmove",this._onMove,this)},_onMove:function(u){var m=u.touches[0];this._newPos=new B(m.clientX,m.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(u,m){var w=new MouseEvent(u,{bubbles:!0,cancelable:!0,view:window,screenX:m.screenX,screenY:m.screenY,clientX:m.clientX,clientY:m.clientY});w._simulated=!0,m.target.dispatchEvent(w)}});St.addInitHook("addHandler","tapHold",OS),St.mergeOptions({touchZoom:We.touch,bounceAtZoomLimits:!0});var RS=ri.extend({addHooks:function(){ft(this._map._container,"leaflet-touch-zoom"),ut(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){vn(this._map._container,"leaflet-touch-zoom"),qt(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(u){var m=this._map;if(!(!u.touches||u.touches.length!==2||m._animatingZoom||this._zooming)){var w=m.mouseEventToContainerPoint(u.touches[0]),T=m.mouseEventToContainerPoint(u.touches[1]);this._centerPoint=m.getSize()._divideBy(2),this._startLatLng=m.containerPointToLatLng(this._centerPoint),m.options.touchZoom!=="center"&&(this._pinchStartLatLng=m.containerPointToLatLng(w.add(T)._divideBy(2))),this._startDist=w.distanceTo(T),this._startZoom=m.getZoom(),this._moved=!1,this._zooming=!0,m._stop(),ut(document,"touchmove",this._onTouchMove,this),ut(document,"touchend touchcancel",this._onTouchEnd,this),Hn(u)}},_onTouchMove:function(u){if(!(!u.touches||u.touches.length!==2||!this._zooming)){var m=this._map,w=m.mouseEventToContainerPoint(u.touches[0]),T=m.mouseEventToContainerPoint(u.touches[1]),A=w.distanceTo(T)/this._startDist;if(this._zoom=m.getScaleZoom(A,this._startZoom),!m.options.bounceAtZoomLimits&&(this._zoom<m.getMinZoom()&&A<1||this._zoom>m.getMaxZoom()&&A>1)&&(this._zoom=m._limitZoom(this._zoom)),m.options.touchZoom==="center"){if(this._center=this._startLatLng,A===1)return}else{var $=w._add(T)._divideBy(2)._subtract(this._centerPoint);if(A===1&&$.x===0&&$.y===0)return;this._center=m.unproject(m.project(this._pinchStartLatLng,this._zoom).subtract($),this._zoom)}this._moved||(m._moveStart(!0,!1),this._moved=!0),H(this._animRequest);var ee=o(m._move,m,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=z(ee,this,!0),Hn(u)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,H(this._animRequest),qt(document,"touchmove",this._onTouchMove,this),qt(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});St.addInitHook("addHandler","touchZoom",RS),St.BoxZoom=PS,St.DoubleClickZoom=MS,St.Drag=DS,St.Keyboard=AS,St.ScrollWheelZoom=IS,St.TapHold=OS,St.TouchZoom=RS,t.Bounds=le,t.Browser=We,t.CRS=ge,t.Canvas=CS,t.Circle=Sy,t.CircleMarker=Kh,t.Class=R,t.Control=Pr,t.DivIcon=SS,t.DivOverlay=ii,t.DomEvent=bO,t.DomUtil=xO,t.Draggable=xa,t.Evented=W,t.FeatureGroup=Di,t.GeoJSON=Ii,t.GridLayer=Pd,t.Handler=ri,t.Icon=Ul,t.ImageOverlay=tf,t.LatLng=G,t.LatLngBounds=Z,t.Layer=Mr,t.LayerGroup=zl,t.LineUtil=AO,t.Map=St,t.Marker=Zh,t.Mixin=kO,t.Path=va,t.Point=B,t.PolyUtil=TO,t.Polygon=Vl,t.Polyline=Ai,t.Popup=nf,t.PosAnimation=iS,t.Projection=IO,t.Rectangle=ES,t.Renderer=Oi,t.SVG=Dd,t.SVGOverlay=_S,t.TileLayer=ql,t.Tooltip=sf,t.Transformation=ve,t.Util=F,t.VideoOverlay=wS,t.bind=o,t.bounds=X,t.canvas=kS,t.circle=VO,t.circleMarker=UO,t.control=kd,t.divIcon=JO,t.extend=r,t.featureGroup=FO,t.geoJSON=bS,t.geoJson=HO,t.gridLayer=QO,t.icon=$O,t.imageOverlay=WO,t.latLng=ne,t.latLngBounds=se,t.layerGroup=LO,t.map=wO,t.marker=zO,t.point=Q,t.polygon=qO,t.polyline=BO,t.popup=ZO,t.rectangle=tR,t.setOptions=v,t.stamp=c,t.svg=TS,t.svgOverlay=YO,t.tileLayer=NS,t.tooltip=KO,t.transformation=pe,t.version=s,t.videoOverlay=GO;var sR=window.L;t.noConflict=function(){return window.L=sR,this},window.L=t})})(f0,f0.exports);var lae=f0.exports;const zo=Jp(lae),cae=({events:n,users:e})=>{const t=C.useRef(null),s=C.useRef(null),r=C.useRef(zo.layerGroup()),i=C.useRef(null),{theme:o}=Eh();return C.useEffect(()=>{s.current&&!t.current&&(t.current=zo.map(s.current,{zoomControl:!1}).setView([12.9716,77.5946],12),r.current.addTo(t.current),zo.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>{var l;return(l=t.current)==null?void 0:l.invalidateSize()},100)},[]),C.useEffect(()=>{if(!t.current)return;const l=o==="dark",h=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",f=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';i.current?(i.current.setUrl(h),t.current.attributionControl.setPrefix(f)):i.current=zo.tileLayer(h,{attribution:f}).addTo(t.current)},[o]),C.useEffect(()=>{r.current.clearLayers();const l=new Map;n.forEach(h=>{if(h.latitude&&h.longitude){const f=l.get(h.userId);(!f||new Date(h.timestamp)>new Date(f.timestamp))&&l.set(h.userId,h)}});const c=new Map(e.map(h=>[h.id,h])),d=[];if(l.forEach(h=>{const f=c.get(h.userId);if(f&&h.latitude&&h.longitude){const p=zo.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${f.photoUrl||`https://i.pravatar.cc/150?u=${f.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),g=zo.marker([h.latitude,h.longitude],{icon:p});g.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${f.name}</p>
                        <p class="popup-time">Last seen: ${Ce(new Date(h.timestamp),"hh:mm a")}</p>
                    </div>
                `),r.current.addLayer(g),d.push(g)}}),d.length>0&&t.current){const h=zo.featureGroup(d);t.current.fitBounds(h.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),a.jsx("div",{ref:s,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},dae=({event:n})=>a.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[a.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[a.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),a.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),a.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-muted font-medium",children:"Event"}),a.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),a.jsx("span",{className:"text-primary-text",children:Ce(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),a.jsxs("div",{className:"flex justify-between items-center",children:[a.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?a.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[a.jsx(io,{className:"h-4 w-4 mr-1"})," View on Map"]}):a.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),uae=()=>{const[n,e]=C.useState("list"),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(!0),[c,d]=C.useState(Ce(new Date,"yyyy-MM-dd")),[h,f]=C.useState(Ce(new Date,"yyyy-MM-dd")),[p,g]=C.useState("all"),b=Nt("(max-width: 767px)"),v=C.useMemo(()=>r.filter(S=>S.role==="field_officer"),[r]),_=C.useCallback(async()=>{l(!0);try{const S=new Date(c);S.setHours(0,0,0,0);const P=new Date(h);P.setHours(23,59,59,999);const[E,M]=await Promise.all([te.getAllAttendanceEvents(S.toISOString(),P.toISOString()),te.getUsers()]);s(E),i(M)}catch(S){console.error("Failed to fetch tracking data",S)}finally{l(!1)}},[c,h]);C.useEffect(()=>{_()},[_]);const N=C.useMemo(()=>{let S=t;p!=="all"&&(S=S.filter(E=>E.userId===p));const P=new Map(r.map(E=>[E.id,E]));return S.map(E=>{var M;return{...E,userName:((M=P.get(E.userId))==null?void 0:M.name)||"Unknown User"}}).sort((E,M)=>new Date(M.timestamp).getTime()-new Date(E.timestamp).getTime())},[t,r,p]),j=C.useMemo(()=>{const S=new Set(N.map(P=>P.userId));return r.filter(P=>S.has(P.id))},[N,r]),k=()=>o?a.jsx("div",{className:"flex justify-center items-center h-96",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?a.jsx(cae,{events:N,users:j}):n==="route"?p==="all"?a.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):a.jsx(RouteView,{events:N,selectedUser:p}):b?a.jsx("div",{className:"space-y-3",children:N.length===0?a.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):N.map(S=>a.jsx(dae,{event:S},S.id))}):a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),a.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),a.jsx("tbody",{children:N.length===0?a.jsx("tr",{children:a.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):N.map(S=>a.jsxs("tr",{children:[a.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:S.userName}),a.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:S.type.replace("-"," ")}),a.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:Ce(new Date(S.timestamp),"dd MMM, yyyy - hh:mm a")}),a.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:S.latitude&&S.longitude?a.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${S.latitude},${S.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[a.jsx(io,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},S.id))})]})});return a.jsxs("div",{className:"p-4 md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsxs("div",{className:"mb-6",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[a.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),a.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[a.jsx("div",{className:"w-full sm:w-40",children:a.jsx($t,{label:"",id:"start-date",value:c,onChange:d})}),a.jsx("div",{className:"w-full sm:w-40",children:a.jsx($t,{label:"",id:"end-date",value:h,onChange:f})}),a.jsx("div",{className:"w-full sm:w-48",children:a.jsxs(Te,{label:"",id:"user-select",value:p,onChange:S=>g(S.target.value),children:[a.jsx("option",{value:"all",children:"All Users"}),v.map(S=>a.jsx("option",{value:S.id,children:S.name},S.id))]})})]})]}),a.jsx("div",{className:"mt-4",children:a.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[a.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[a.jsx(_Z,{className:"h-4 w-4"}),"List View"]}),a.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[a.jsx(qD,{className:"h-4 w-4"}),"Map View"]}),a.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[a.jsx(EZ,{className:"h-4 w-4"}),"Route View"]})]})})]}),a.jsx("div",{className:"mt-6",children:k()})]})},hae=()=>{const{user:n}=tt(),[e,t]=C.useState([]),[s,r]=C.useState([]),[i,o]=C.useState(""),[l,c]=C.useState("100"),[d,h]=C.useState(""),[f,p]=C.useState(""),[g,b]=C.useState(""),[v,_]=C.useState(""),[N,j]=C.useState([]),[k,S]=C.useState(!0),[P,E]=C.useState(null),[M,I]=C.useState(null);C.useEffect(()=>{(async()=>{try{const[B,q]=await Promise.all([te.getLocations(),te.getUsers()]);t(B),r(q)}catch(B){console.error(B),E({message:"Failed to load locations or users.",type:"error"})}finally{S(!1)}})()},[]);const O=Fe.useMemo(()=>{const W=new Map;return s.forEach(B=>W.set(B.id,B.name)),W},[s]),D=async()=>{try{const W=await te.getLocations();t(W)}catch(W){console.error(W),E({message:"Failed to refresh locations.",type:"error"})}},z=async()=>{try{const W=await Mg(),{latitude:B,longitude:q}=W.coords;h(B.toString()),p(q.toString());try{const Q=await lh(B,q);g||b(Q),i||o(Q)}catch(Q){console.warn("Reverse geocode failed",Q)}}catch(W){console.error(W),E({message:"Unable to retrieve current location.",type:"error"})}},H=async()=>{const W=parseFloat(l),B=parseFloat(d),q=parseFloat(f);if(isNaN(W)||W<10||W>1e3){E({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN(B)||isNaN(q)){E({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const Q=g||await lh(B,q);M?(await te.updateLocation(M,{name:i||Q,latitude:B,longitude:q,radius:W,address:Q}),E({message:"Location updated successfully.",type:"success"}),I(null)):(await te.createLocation({name:i||Q,latitude:B,longitude:q,radius:W,address:Q,createdBy:(n==null?void 0:n.id)||null}),E({message:"Location created successfully.",type:"success"})),o(""),c("100"),h(""),p(""),b(""),await D()}catch(Q){console.error(Q),E({message:M?"Failed to update location.":"Failed to create location.",type:"error"})}},F=async()=>{if(!v||N.length===0){E({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(N.map(W=>te.assignLocationToUser(v,W))),E({message:"Location(s) assigned to user.",type:"success"}),_(""),j([])}catch(W){console.error(W),E({message:"Failed to assign location(s).",type:"error"})}},R=W=>{I(W.id),o(W.name||""),c(W.radius.toString()),h(W.latitude.toString()),p(W.longitude.toString()),b(W.address||"")},V=()=>{I(null),o(""),c("100"),h(""),p(""),b("")},U=async W=>{if(window.confirm("Are you sure you want to delete this location?"))try{await te.deleteLocation(W),E({message:"Location deleted.",type:"success"}),await D()}catch(B){console.error(B),E({message:"Failed to delete location.",type:"error"})}};return a.jsxs("div",{className:"p-4 md:p-6 w-full",children:[P&&a.jsx(gt,{message:P.message,type:P.type,onDismiss:()=>E(null)}),a.jsxs("div",{className:"md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a.jsx(ur,{title:"Location Management"}),a.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),a.jsxs("div",{className:"mt-6 space-y-6",children:[a.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(io,{className:"h-5 w-5 mr-2 text-muted"})," ",M?"Edit Location":"Add New Location"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[a.jsx(he,{label:"Name (optional)",id:"locName",value:i,onChange:W=>o(W.target.value),placeholder:"e.g. Office HQ"}),a.jsx(he,{label:"Radius (meters)",id:"locRadius",type:"number",value:l,onChange:W=>c(W.target.value),min:"10",max:"1000"}),a.jsx(he,{label:"Latitude",id:"locLat",type:"number",value:d,onChange:W=>h(W.target.value),placeholder:"12.9716"}),a.jsx(he,{label:"Longitude",id:"locLng",type:"number",value:f,onChange:W=>p(W.target.value),placeholder:"77.5946"}),a.jsx(he,{label:"Address (optional)",id:"locAddr",value:g,onChange:W=>b(W.target.value),placeholder:"Street, City, State"})]}),a.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[a.jsxs(Y,{variant:"secondary",onClick:z,children:[a.jsx(HD,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),M?a.jsxs(a.Fragment,{children:[a.jsxs(Y,{onClick:H,children:[a.jsx(cs,{className:"h-4 w-4 mr-2"})," Save Changes"]}),a.jsx(Y,{variant:"secondary",onClick:V,children:"Cancel"})]}):a.jsxs(Y,{onClick:H,children:[a.jsx(ct,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),a.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[a.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(Ei,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[a.jsxs(Te,{label:"Select User",id:"assignUser",value:v,onChange:W=>_(W.target.value),children:[a.jsx("option",{value:"",children:"-- Select User --"}),s.map(W=>a.jsx("option",{value:W.id,children:W.name},W.id))]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),a.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:e.length===0?a.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):e.map(W=>a.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[a.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:N.includes(W.id),onChange:B=>{j(q=>B.target.checked?[...q,W.id]:q.filter(Q=>Q!==W.id))}}),a.jsx("span",{children:W.name||W.address||`${W.latitude.toFixed(4)}, ${W.longitude.toFixed(4)}`})]},W.id))})]})]}),a.jsx("div",{className:"flex justify-end mt-4",children:a.jsxs(Y,{onClick:F,className:"w-full md:w-auto",children:[a.jsx(cs,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),a.jsxs("section",{children:[a.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[a.jsx(io,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),k?a.jsx("p",{children:"Loading..."}):e.length===0?a.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):a.jsxs("div",{className:"space-y-4 md:space-y-0",children:[a.jsx("div",{className:"md:hidden space-y-4",children:e.map(W=>a.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"font-bold text-primary-text",children:W.name||"Unnamed Location"}),a.jsx("p",{className:"text-sm text-muted",children:W.address})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:"Edit",onClick:()=>R(W),children:a.jsx(Jn,{className:"h-5 w-5"})}),a.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete",onClick:()=>U(W.id),children:a.jsx(kt,{className:"h-5 w-5"})})]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Radius"}),a.jsxs("p",{children:[W.radius,"m"]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Coordinates"}),a.jsxs("p",{children:[W.latitude.toFixed(4),", ",W.longitude.toFixed(4)]})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Created By"}),a.jsx("p",{children:W.createdByName||O.get(W.createdBy||"")||"-"})]}),a.jsxs("div",{children:[a.jsx("p",{className:"text-muted",children:"Created At"}),a.jsx("p",{children:W.createdAt?new Date(W.createdAt).toLocaleDateString():"-"})]})]})]},W.id))}),a.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:a.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[a.jsx("thead",{className:"bg-page text-primary-text",children:a.jsxs("tr",{children:[a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),a.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),a.jsx("tbody",{children:e.map(W=>a.jsxs("tr",{className:"border-b border-border",children:[a.jsx("td",{className:"p-3",children:W.name||"-"}),a.jsx("td",{className:"p-3",children:W.radius}),a.jsxs("td",{className:"p-3",children:[W.latitude.toFixed(4),", ",W.longitude.toFixed(4)]}),a.jsx("td",{className:"p-3",children:W.address||"-"}),a.jsx("td",{className:"p-3",children:W.createdByName||O.get(W.createdBy||"")||"-"}),a.jsx("td",{className:"p-3",children:W.createdAt?new Date(W.createdAt).toLocaleString():"-"}),a.jsxs("td",{className:"p-3 whitespace-nowrap",children:[a.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800 mr-3",title:"Edit",onClick:()=>R(W),children:a.jsx(Jn,{className:"h-4 w-4"})}),a.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete",onClick:()=>U(W.id),children:a.jsx(kt,{className:"h-4 w-4"})})]})]},W.id))})]})})]})]})]})]})},fae=({isOpen:n,onClose:e,onOverride:t,employeeName:s,bankName:r,reason:i})=>n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:a.jsx(Jr,{className:"h-6 w-6 text-red-600"})}),a.jsxs("div",{className:"ml-4 flex-1",children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),a.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[a.jsxs("p",{children:[a.jsx("strong",{children:"Name on ID:"}),' "',s,'"']}),a.jsxs("p",{children:[a.jsx("strong",{children:"Name on Bank Proof:"}),' "',r,'"']}),i&&a.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[a.jsx("strong",{children:"AI Analysis:"})," ",a.jsx("em",{children:i})]}),a.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),a.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[a.jsx(Y,{onClick:t,variant:"danger",children:"Override & Proceed"}),a.jsx(Y,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,mae={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},pae=n=>{const e=Ke({id:ie().required(),relation:ie().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:ie().when("relation",{is:"Child",then:s=>s.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:s=>s.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?ot().nonNullable("Aadhaar proof is required for each family member."):ot().optional().nullable()}),t=Ke({id:ie().required(),document:n.documents.educationCertificate?ot().nonNullable("Education certificate is required."):ot().optional().nullable()});return Ke({photo:ot().optional().nullable(),aadhaarLinkedMobile:ie().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:ie().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:ie().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:ot().nonNullable("Aadhaar (Front) is required."),idProofBack:ot().nonNullable("Aadhaar (Back) is required."),bankProof:ot().nonNullable("Bank proof document is required."),uanProof:ot().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?ot().nonNullable("Salary slip is required."):ot().optional().nullable(),family:xs().of(e).optional(),education:xs().of(t).optional()}).defined()},Uo=n=>new Promise((e,t)=>{const s=new FileReader;s.readAsDataURL(n),s.onload=()=>e({base64:s.result.split(",")[1],type:n.type}),s.onerror=r=>t(r)}),su=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",gae=()=>{const n=Vt(),e=rn(),{user:t}=tt(),{rulesByDesignation:s}=bo(),[r,i]=C.useState(!1),[o,l]=C.useState(null),[c,d]=C.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[h,f]=C.useState(window.innerWidth<768),p=e.data.organization.designation,g=C.useMemo(()=>p&&s[p]?s[p]:mae,[p,s]),b=C.useMemo(()=>pae(g),[g]);C.useEffect(()=>{const R=()=>f(window.innerWidth<768);return window.addEventListener("resize",R),()=>window.removeEventListener("resize",R)},[]),t==null||t.role;const{control:v,handleSubmit:_,formState:{errors:N},getValues:j,watch:k}=xt({resolver:Lt(b),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:S,append:P,remove:E}=vs({control:v,name:"family"}),{fields:M,append:I,remove:O}=vs({control:v,name:"education"});k("idProofType");const D=k("family"),z=async(R,V=!1)=>{i(!0),e.setRequiresManualVerification(V);try{const U={type:De.OBJECT,properties:{name:{type:De.STRING,description:"The person's full name as written on the card."},dob:{type:De.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:De.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:De.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:De.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:De.STRING,description:"The Voter ID number, also known as EPIC number."}}},W={type:De.OBJECT,properties:{address:{type:De.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:De.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:De.STRING},state:{type:De.STRING},pincode:{type:De.STRING}}}}},B={type:De.OBJECT,properties:{accountHolderName:{type:De.STRING,description:"The account holder's full name."},accountNumber:{type:De.STRING,description:"The full bank account number."},ifscCode:{type:De.STRING,description:"The bank's IFSC code."},bankName:{type:De.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:De.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},q={type:De.OBJECT,properties:{uanNumber:{type:De.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:De.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:De.STRING,description:"The 10 or 17-digit ESI number."}}},Q={type:De.OBJECT,properties:{uanNumber:{type:De.STRING}}},le={type:De.OBJECT,properties:{name:{type:De.STRING},dob:{type:De.STRING}}},X={type:De.OBJECT,properties:{degree:{type:De.STRING},institution:{type:De.STRING},endYear:{type:De.STRING}}},Z=[R.idProofFront?Uo(R.idProofFront.file):Promise.resolve(null),(R.idProofType==="Aadhaar"||R.idProofType==="Voter ID")&&R.idProofBack?Uo(R.idProofBack.file):Promise.resolve(null),R.bankProof?Uo(R.bankProof.file):Promise.resolve(null),R.salarySlip?Uo(R.salarySlip.file):Promise.resolve(null),R.uanProof?Uo(R.uanProof.file):Promise.resolve(null),...R.family.map(Xe=>Xe.idProof?Uo(Xe.idProof.file):Promise.resolve(null)),...R.education.map(Xe=>Xe.document?Uo(Xe.document.file):Promise.resolve(null))],[se,G,ne,ge,ye,...re]=await Promise.all(Z),ae=re.slice(0,R.family.length),ve=re.slice(R.family.length),pe=se?te.extractDataFromImage(se.base64,se.type,U,R.idProofType):Promise.resolve({}),Ne=G&&R.idProofType==="Aadhaar"?te.extractDataFromImage(G.base64,G.type,W,"Aadhaar"):Promise.resolve({}),Me=ne?te.extractDataFromImage(ne.base64,ne.type,B,"Bank"):Promise.resolve({}),Oe=ge?te.extractDataFromImage(ge.base64,ge.type,q,"Salary"):Promise.resolve(null),Je=ye?te.extractDataFromImage(ye.base64,ye.type,Q,"UAN"):Promise.resolve(null),dt=ae.map(Xe=>Xe?te.extractDataFromImage(Xe.base64,Xe.type,le,"Aadhaar"):Promise.resolve({})),at=ve.map(Xe=>Xe?te.extractDataFromImage(Xe.base64,Xe.type,X):Promise.resolve({})),[_t,J,K,oe,we,...Se]=await Promise.all([pe,Ne,Me,Oe,Je,...dt,...at]),_e=Se.slice(0,ae.length),Pe=Se.slice(ae.length),Ue={..._t,...J},ht=Ue.name||"",Zt=K.accountHolderName||"";if(!V&&ht&&Zt){const{isMatch:Xe,reason:ti}=await te.crossVerifyNames(ht,Zt);if(!Xe){d({isOpen:!0,employeeName:ht,bankName:Zt,reason:ti}),i(!1);return}}const an={idProofType:R.idProofType,idProofFront:R.idProofFront,idProofBack:R.idProofBack,photo:R.photo,mobile:R.aadhaarLinkedMobile,alternateMobile:R.alternateMobile},$n={};if(Ue.name){const Xe=Ue.name.split(" ");an.firstName=su(Xe.shift()||""),an.lastName=su(Xe.pop()||""),an.middleName=su(Xe.join(" ")),an.preferredName=an.firstName,$n.name=!0}if(Ue.dob)try{an.dob=Ce(new Date(Ue.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),$n.dob=!0}catch{}if(Ue.gender){const Xe=Ue.gender.toLowerCase().trim();Xe.includes("male")||Xe.includes("purush")||Xe==="m"?an.gender="Male":Xe.includes("female")||Xe.includes("mahila")||Xe==="f"?an.gender="Female":Xe.includes("transgender")&&(an.gender="Other")}(Ue.aadhaarNumber||Ue.panNumber||Ue.voterIdNumber)&&(an.idProofNumber=(Ue.aadhaarNumber||Ue.panNumber||Ue.voterIdNumber).replace(/\s/g,""),$n.idProofNumber=!0);const Ws={bankProof:R.bankProof},Cs={};if(K.accountHolderName&&(Ws.accountHolderName=su(K.accountHolderName),Cs.accountHolderName=!0),K.accountNumber){const Xe=K.accountNumber.replace(/\D/g,"");Ws.accountNumber=Xe,Ws.confirmAccountNumber=Xe,Cs.accountNumber=!0}K.ifscCode&&(Ws.ifscCode=K.ifscCode.toUpperCase().replace(/\s/g,""),Cs.ifscCode=!0),K.bankName&&(Ws.bankName=K.bankName),K.branchName&&(Ws.branchName=K.branchName);const zn={salarySlip:R.salarySlip,document:R.uanProof},Bt={},Gs={},us={},hs=(we==null?void 0:we.uanNumber)||(oe==null?void 0:oe.uanNumber);if(hs){const Xe=hs.replace(/\D/g,"");Xe.length===12&&(zn.uanNumber=Xe,zn.hasPreviousPf=!0,Gs.uanNumber=!0)}if(oe!=null&&oe.pfNumber&&(zn.pfNumber=oe.pfNumber,zn.hasPreviousPf=!0),oe!=null&&oe.esiNumber){const Xe=oe.esiNumber.replace(/\D/g,"");(Xe.length===10||Xe.length===17)&&(Bt.esiNumber=Xe,Bt.hasEsi=!0,us.esiNumber=!0)}const bd=_e.map((Xe,ti)=>{const No=R.family[ti];let Uh="";if(Xe.dob)try{Uh=Ce(new Date(Xe.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${ti}`,relation:No.relation,name:su(Xe.name)||"",dob:Uh,gender:"",occupation:"",dependent:!1,idProof:No.idProof,phone:No.phone}}),zh=Pe.map((Xe,ti)=>{const No=R.education[ti];return{id:`edu_preupload_${Date.now()}_${ti}`,degree:Xe.degree||"",institution:Xe.institution||"",startYear:"",endYear:Xe.endYear||"",document:No.document}});Ue.address&&e.updateAddress({present:{...Ue.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...Ue.address,country:"India"},sameAsPresent:!0}),e.updateBank(Ws),e.setBankVerifiedStatus(Cs),e.updateUan(zn),e.setUanVerifiedStatus(Gs),e.updateEsi(Bt),e.setEsiVerifiedStatus(us),e.updateFamily(bd),e.updateEducation(zh),e.updatePersonal(an),e.setPersonalVerifiedStatus($n),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(U){const W=U instanceof Error?U.message:"An unexpected error occurred.";console.error("Document processing failed:",U),l({message:`Document processing failed: ${W}`,type:"error"}),i(!1)}},H=R=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),z(R,!1)},F=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),z(j(),!0)};return a.jsxs("div",{className:"relative",children:[r&&a.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[a.jsx(Qe,{className:"h-12 w-12 animate-spin text-accent"}),a.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),a.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),a.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${r?"blur-sm pointer-events-none":""}`,children:[a.jsx(fae,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:F}),a.jsxs("form",{onSubmit:_(H),children:[a.jsx(Fn,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),a.jsxs("div",{className:"space-y-8 mt-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[a.jsx(de,{name:"photo",control:v,render:({field:R})=>a.jsx(qe,{label:"Profile Photo",file:R.value,onFileChange:R.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(de,{name:"aadhaarLinkedMobile",control:v,render:({field:R,fieldState:V})=>{var U;return a.jsx(he,{label:"Aadhaar Linked Mobile Number",type:"tel",...R,error:(U=V.error)==null?void 0:U.message})}}),a.jsx(de,{name:"alternateMobile",control:v,render:({field:R,fieldState:V})=>{var U;return a.jsx(he,{label:"Alternative Mobile Number (Optional)",type:"tel",...R,error:(U=V.error)==null?void 0:U.message})}})]})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[a.jsx(de,{name:"idProofFront",control:v,render:({field:R})=>{var V,U;return a.jsx(qe,{label:"Aadhaar (Front Side)",file:R.value,onFileChange:R.onChange,error:(V=N.idProofFront)==null?void 0:V.message,allowCapture:!0,verificationStatus:(U=e.data.personal.verifiedStatus)==null?void 0:U.idProofNumber})}}),a.jsx(de,{name:"idProofBack",control:v,render:({field:R})=>{var V,U;return a.jsx(qe,{label:"Aadhaar (Back Side)",file:R.value,onFileChange:R.onChange,error:(V=N.idProofBack)==null?void 0:V.message,allowCapture:!0,verificationStatus:(U=e.data.personal.verifiedStatus)==null?void 0:U.idProofNumber})}})]}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[a.jsx(de,{name:"bankProof",control:v,render:({field:R})=>{var V,U;return a.jsx(qe,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:R.value,onFileChange:R.onChange,error:(V=N.bankProof)==null?void 0:V.message,allowCapture:!0,verificationStatus:(U=e.data.bank.verifiedStatus)==null?void 0:U.accountNumber})}}),a.jsx(de,{name:"uanProof",control:v,render:({field:R})=>{var V,U;return a.jsx(qe,{label:"UAN Proof Document",file:R.value,onFileChange:R.onChange,error:(V=N.uanProof)==null?void 0:V.message,allowCapture:!0,verificationStatus:(U=e.data.uan.verifiedStatus)==null?void 0:U.uanNumber})}})]}),g.documents.salarySlip&&a.jsx(de,{name:"salarySlip",control:v,render:({field:R})=>{var V;return a.jsx(qe,{label:"Latest Salary Slip",file:R.value,onFileChange:R.onChange,error:(V=N.salarySlip)==null?void 0:V.message,allowCapture:!0})}}),g.documents.educationCertificate&&a.jsxs("div",{className:"pt-6 border-t",children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),a.jsxs("div",{className:"space-y-4",children:[M.map((R,V)=>a.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[a.jsx(de,{name:`education.${V}.document`,control:v,render:({field:U,fieldState:W})=>{var B;return a.jsx(qe,{label:"Certificate",file:U.value,onFileChange:U.onChange,error:(B=W.error)==null?void 0:B.message,allowCapture:!0})}}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>O(V),className:"!absolute top-2 right-2",children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]},R.id)),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>I({id:`edu_upload_${Date.now()}`,document:null}),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),g.documents.familyAadhaar&&a.jsxs("div",{className:"pt-6 border-t",children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),a.jsxs("div",{className:"space-y-4",children:[S.map((R,V)=>{var B;const W=((B=D==null?void 0:D[V])==null?void 0:B.relation)==="Child";return a.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[a.jsx(de,{name:`family.${V}.relation`,control:v,render:({field:q,fieldState:Q})=>{var le;return a.jsxs(Te,{label:"Relation",error:(le=Q.error)==null?void 0:le.message,...q,children:[" ",a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Spouse"}),a.jsx("option",{children:"Child"}),a.jsx("option",{children:"Father"}),a.jsx("option",{children:"Mother"})," "]})}}),a.jsx(de,{name:`family.${V}.phone`,control:v,render:({field:q,fieldState:Q})=>{var le;return a.jsx(he,{label:`Phone Number${W?" (Optional)":""}`,type:"tel",...q,error:(le=Q.error)==null?void 0:le.message})}}),a.jsx("div",{className:"md:col-start-1 md:col-span-3",children:a.jsx(de,{name:`family.${V}.idProof`,control:v,render:({field:q,fieldState:Q})=>{var le;return a.jsx(qe,{label:"Aadhaar Card",file:q.value,onFileChange:q.onChange,error:(le=Q.error)==null?void 0:le.message,allowCapture:!0})}})}),a.jsx(Y,{type:"button",variant:"icon",size:"sm",onClick:()=>E(V),className:"!absolute top-2 right-2",children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]},R.id)}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>P({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[a.jsxs(Y,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[a.jsx(Er,{className:"mr-2 h-4 w-4"})," Back"]}),a.jsx(Y,{type:"submit",isLoading:r,children:"Process"})]})]})]})]})},yae=({count:n=3})=>a.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>a.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[a.jsx(Yn,{className:"w-12 h-12 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsx(Yn,{className:"h-4 w-1/2"}),a.jsx(Yn,{className:"h-5 w-20 rounded-full"})]}),a.jsx(Yn,{className:"h-3 w-1/3"}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[a.jsx(Yn,{className:"h-3 w-20"}),a.jsx(Yn,{className:"h-3 w-20"}),a.jsx(Yn,{className:"h-3 w-20"}),a.jsx(Yn,{className:"h-3 w-20"})]})]})]},t))}),om=({label:n,checked:e})=>a.jsxs("div",{className:"flex items-center gap-1.5",children:[e?a.jsx(e_,{className:"h-4 w-4 text-emerald-400"}):a.jsx(YD,{className:"h-4 w-4 text-gray-500"}),a.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),xae=({submission:n})=>{var s;const{esiCtcThreshold:e}=bo(),t=C.useMemo(()=>{const{personal:r,uan:i,esi:o,gmc:l}=n,c=r.salary!=null&&r.salary<=e;let d=!1;return c?d=!o.hasEsi||o.hasEsi&&!!o.esiNumber:l.isOptedIn===!0?d=!0:l.isOptedIn===!1&&(d=!!l.gmcPolicyCopy&&!!l.declarationAccepted),{aadhaar:!!r.idProofFront,uan:!i.hasPreviousPf||i.hasPreviousPf&&!!i.uanNumber,pf:!i.hasPreviousPf||i.hasPreviousPf&&!!i.uanNumber,esiGmc:d}},[n,e]);return a.jsx(Yr,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-xl",children:a.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent hover:border-emerald-500 transition-colors duration-200",children:[a.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:a.jsx(ea,{photoUrl:(s=n.personal.photo)==null?void 0:s.preview,seed:n.id})}),a.jsxs("div",{className:"flex-grow",children:[a.jsxs("div",{className:"flex justify-between items-start gap-2",children:[a.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),a.jsx("div",{className:"flex-shrink-0",children:a.jsx(p_,{status:n.status})})]}),a.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),a.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[a.jsx(om,{label:"Aadhaar",checked:t.aadhaar}),a.jsx(om,{label:"UAN",checked:t.uan}),a.jsx(om,{label:"PF",checked:t.pf}),a.jsx(om,{label:"ESI / GMC",checked:t.esiGmc})]})]})]})})},vae=()=>{const[n,e]=C.useState([]),[t,s]=C.useState(!0),[r,i]=C.useState("in-progress"),[o,l]=C.useState(""),[c,d]=C.useState(null),h=Vt(),f=C.useRef(null);C.useEffect(()=>{(async()=>{s(!0);try{const N=await te.getVerificationSubmissions();e(N)}catch{d({message:"Failed to load submissions.",type:"error"})}finally{s(!1)}})()},[]);const p=C.useMemo(()=>{const _={"in-progress":["pending","draft","rejected"],existing:["verified"]};return n.filter(N=>_[r].includes(N.status)).filter(N=>{var j;return`${N.personal.firstName} ${N.personal.lastName}`.toLowerCase().includes(o.toLowerCase())||((j=N.personal.mobile)==null?void 0:j.toLowerCase().includes(o.toLowerCase()))})},[n,r,o]),g=()=>{h("/onboarding/select-organization")},b=()=>{var _;(_=f.current)==null||_.focus()},v=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return a.jsxs("div",{className:"h-full flex flex-col bg-[#0f1f0f] text-white",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),a.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#0f1f0f]/80 backdrop-blur-sm border-b border-[#374151]",children:[a.jsx("button",{onClick:()=>h("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:a.jsx(Er,{className:"h-6 w-6"})}),a.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx("button",{onClick:b,"aria-label":"Search employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:a.jsx(ua,{className:"h-6 w-6"})}),a.jsx("button",{onClick:g,"aria-label":"Add new employee",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:a.jsx(sd,{className:"h-6 w-6"})}),a.jsx("button",{onClick:()=>h("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full hover:bg-white/10 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400",children:a.jsx(Us,{className:"h-6 w-6"})})]})]}),a.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:a.jsx("div",{className:"flex",children:v.map(_=>a.jsx("button",{onClick:()=>i(_.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#0f1f0f] focus-visible:ring-emerald-400 rounded-sm ${r===_.key?"border-b-2 border-emerald-400 text-emerald-400":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:_.label},_.key))})}),a.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),a.jsx("input",{ref:f,type:"text",placeholder:"Search by name or number...",value:o,onChange:_=>l(_.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),t?a.jsx("div",{className:"pt-4",children:a.jsx(yae,{count:3})}):p.length>0?a.jsx("div",{className:"space-y-2.5",children:p.map(_=>a.jsx(xae,{submission:_},_.id))}):a.jsx("div",{className:"text-center pt-16 text-gray-500",children:a.jsxs("p",{children:["No ",r.replace("-"," ")," submissions found."]})})]})]})},bae=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return a.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},wae=()=>{const{user:n}=tt(),[e,t]=C.useState("tasks"),[s,r]=C.useState([]),[i,o]=C.useState([]),[l,c]=C.useState(!0);C.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[f,p]=await Promise.all([te.getTasks(),te.getNotifications(n.id)]),g=f.filter(b=>b.assignedToId===n.id);r(g),o(p)}catch(f){console.error("Failed to load data for tasks page",f)}finally{c(!1)}})()},[n]);const d=h=>{const f=["HR","Admin","Ops Manager","Site Manager"];return f[h.charCodeAt(h.length-1)%f.length]};return a.jsxs("div",{children:[a.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#0f1f0f]/80 backdrop-blur-sm z-10 border-b border-[#374151]",children:a.jsx("h1",{children:"Tasks"})}),a.jsx("div",{className:"flex-shrink-0 p-4",children:a.jsxs("div",{className:"fo-tabs-container",children:[a.jsx("button",{onClick:()=>t("tasks"),className:`fo-tab-button ${e==="tasks"?"active":""}`,children:"Tasks"}),a.jsx("button",{onClick:()=>t("notifications"),className:`fo-tab-button ${e==="notifications"?"active":""}`,children:"Notifications"})]})}),a.jsx("main",{className:"p-4",children:l?a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-muted"})}):e==="tasks"?s.length>0?a.jsx("div",{className:"space-y-4",children:s.map(h=>a.jsxs("div",{className:"fo-task-card",children:[a.jsxs("div",{className:"fo-task-header",children:[a.jsx("p",{className:"fo-task-title",children:h.name}),a.jsx(bae,{status:h.status})]}),a.jsx("p",{className:"text-sm text-gray-400 mb-2",children:h.description}),a.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[a.jsxs("span",{children:["Due: ",h.dueDate?Ce(new Date(h.dueDate),"dd MMM, yyyy"):"N/A"]}),a.jsxs("span",{children:["Assigned by: ",d(h.id)]})]})]},h.id))}):a.jsxs("div",{className:"text-center text-muted pt-16",children:[a.jsx(VD,{className:"h-12 w-12 mx-auto mb-4"}),a.jsx("p",{children:"You have no assigned tasks."})]}):i.length>0?a.jsx("div",{className:"divide-y divide-border",children:i.map(h=>a.jsxs("div",{className:"fo-notification-item",children:[a.jsx(dh,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("p",{className:"text-sm text-gray-300",children:h.message}),a.jsx("p",{className:"text-xs text-muted mt-1",children:Zc(new Date(h.createdAt),{addSuffix:!0})})]})]},h.id))}):a.jsxs("div",{className:"text-center text-muted pt-16",children:[a.jsx(dh,{className:"h-12 w-12 mx-auto mb-4"}),a.jsx("p",{children:"You have no notifications."})]})})]})},_ae=({status:n})=>{const e={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return a.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},lm=({title:n,sizes:e,headers:t,control:s,quantityType:r})=>{const i=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),h=parseInt(String(c));return!isNaN(d)&&!isNaN(h)?d-h:String(l).localeCompare(String(c))});return a.jsxs("div",{className:"border border-border rounded-lg",children:[a.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),a.jsx("div",{className:"overflow-x-auto",children:a.jsxs("table",{className:"min-w-full text-sm",children:[a.jsx("thead",{className:"bg-page",children:a.jsxs("tr",{children:[a.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>a.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),a.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),a.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>a.jsx(Fe.Fragment,{children:i.map((c,d)=>{const h=e.find(f=>f.size===l&&f.fit===c);return h?a.jsxs("tr",{children:[d===0&&a.jsx("td",{rowSpan:i.filter(f=>e.some(p=>p.size===l&&p.fit===f)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(f=>a.jsx("td",{className:"px-3 py-2",children:h[f.key]},String(f.key))),a.jsx("td",{className:"px-3 py-2",children:a.jsx(de,{name:`${r}.${h.id}`,control:s,render:({field:f})=>a.jsx(he,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...f,value:f.value||"",onChange:p=>f.onChange(parseInt(p.target.value)||null),className:"!py-1.5"})})})]},h.id):null})},l))})]})})]})},Sae=({onSave:n,onCancel:e,sites:t,masterUniforms:s,initialData:r})=>{const{register:i,control:o,handleSubmit:l,watch:c,reset:d}=xt({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:h}=rn(),{user:f}=tt(),p=c("gender"),g=c("siteId");C.useEffect(()=>{if(r){const v={},_={};r.items.forEach(N=>{N.category==="Pants"?v[N.sizeId]=N.quantity:_[N.sizeId]=N.quantity}),d({siteId:r.siteId,gender:r.gender,pantsQuantities:v,shirtsQuantities:_})}else{const v=h.organization.organizationId||"",N=h.personal.gender==="Female"?"Ladies":"Gents";d({siteId:v,gender:N,pantsQuantities:{},shirtsQuantities:{}})}},[r,d,h]);const b=v=>{const _=t.find(S=>S.id===v.siteId);if(!_||!f)return;const N=p==="Gents"?[...s.gents.pants,...s.gents.shirts]:[...s.ladies.pants,...s.ladies.shirts],j=[];for(const[S,P]of Object.entries(v.pantsQuantities))if(P&&P>0){const E=N.find(M=>M.id===S);E&&j.push({sizeId:S,quantity:P,category:"Pants",sizeLabel:E.size,fit:E.fit})}for(const[S,P]of Object.entries(v.shirtsQuantities))if(P&&P>0){const E=N.find(M=>M.id===S);E&&j.push({sizeId:S,quantity:P,category:"Shirts",sizeLabel:E.size,fit:E.fit})}const k={id:(r==null?void 0:r.id)||`new_${Date.now()}`,siteId:v.siteId,siteName:_.shortName,gender:v.gender,requestedDate:(r==null?void 0:r.requestedDate)||new Date().toISOString(),status:(r==null?void 0:r.status)||"Pending",items:j,source:"Individual",requestedById:f.id,requestedByName:f.name,employeeDetails:[{employeeName:`${h.personal.firstName} ${h.personal.lastName}`,employeeId:h.personal.employeeId,items:j.map(S=>({itemName:S.category,sizeLabel:S.sizeLabel,fit:S.fit,quantity:S.quantity}))}]};n(k)};return a.jsx("form",{onSubmit:l(b),children:a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[a.jsxs(Te,{label:"Select Site",value:g,...i("siteId"),required:!0,disabled:!0,children:[a.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(v=>a.jsx("option",{value:v.id,children:v.shortName},v.id))]}),a.jsxs(Te,{label:"Select Uniform Type",value:p,...i("gender"),disabled:!0,children:[a.jsx("option",{children:"Gents"}),a.jsx("option",{children:"Ladies"})]})]}),a.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:p==="Gents"?a.jsxs(a.Fragment,{children:[a.jsx(lm,{title:"Gents' Pants",sizes:s.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),a.jsx(lm,{title:"Gents' Shirts",sizes:s.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):a.jsxs(a.Fragment,{children:[a.jsx(lm,{title:"Ladies' Pants",sizes:s.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),a.jsx(lm,{title:"Ladies' Shirts",sizes:s.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),a.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[a.jsx(Y,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),a.jsxs(Y,{type:"submit",children:[a.jsx(cs,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},Nae=()=>{const[n,e]=C.useState("list"),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(null),[c,d]=C.useState(!0),[h,f]=C.useState(null),[p,g]=C.useState(null),[b,v]=C.useState(null),_=Vt(),[N]=JP(),{updateUniforms:j}=rn(),k=N.get("from")==="onboarding",S=async()=>{d(!0);try{const[D,z,H,F]=await Promise.all([te.getUniformRequests(),te.getOrganizations(),te.getMasterGentsUniforms(),te.getMasterLadiesUniforms()]);s(D.sort((R,V)=>new Date(V.requestedDate).getTime()-new Date(R.requestedDate).getTime())),i(z),l({gents:H,ladies:F})}catch{f({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};C.useEffect(()=>{S()},[]),C.useEffect(()=>{k&&(e("form"),g(null))},[k]);const P=()=>{g(null),e("form")},E=D=>{g(D),e("form")},M=async D=>{if(k&&o){const z=D.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],H=D.items.map(F=>{const R=z.find(W=>W.id===F.sizeId),V=F.category==="Pants"?`${D.gender}' Pants`:`${D.gender}' Shirts`;return{itemId:`generic_${D.gender.toLowerCase()}_${F.category==="Pants"?"pants":"shirts"}`,itemName:V,sizeId:F.sizeId,sizeLabel:(R==null?void 0:R.size)||"",fit:(R==null?void 0:R.fit)||"",quantity:F.quantity}});j(H),await te.submitUniformRequest(D),_(-1);return}try{D.id.startsWith("new_")?(await te.submitUniformRequest(D),f({message:"New request submitted.",type:"success"})):(await te.updateUniformRequest(D),f({message:"Request updated.",type:"success"})),e("list"),S()}catch{f({message:"Failed to save request.",type:"error"})}},I=async()=>{if(b)try{await te.deleteUniformRequest(b.id),f({message:"Request deleted.",type:"success"}),v(null),S()}catch{f({message:"Failed to delete request.",type:"error"})}},O=D=>D.reduce((z,H)=>z+H.quantity,0);if(c||!o)return a.jsx("div",{className:"flex justify-center items-center h-full",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const D=()=>{k?_(-1):e("list")};return a.jsxs("div",{className:"h-full flex flex-col",children:[a.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[a.jsx("button",{onClick:D,"aria-label":"Go back",children:a.jsx(Er,{className:"h-6 w-6"})}),a.jsxs("h1",{children:[p?"Edit":"New"," Request"]})]}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:a.jsx(Sae,{onSave:M,onCancel:D,sites:r,masterUniforms:o,initialData:p})})]})}return a.jsxs("div",{className:"h-full flex flex-col",children:[h&&a.jsx(gt,{message:h.message,type:h.type,onDismiss:()=>f(null)}),a.jsx(yn,{isOpen:!!b,onClose:()=>v(null),onConfirm:I,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),a.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[a.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),a.jsx("button",{onClick:P,"aria-label":"New Uniform Request",children:a.jsx(sd,{className:"h-6 w-6"})})]}),a.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(D=>a.jsxs("div",{className:"bg-[#243524] p-3 rounded-xl border border-[#374151]",children:[a.jsxs("div",{className:"flex justify-between items-start",children:[a.jsxs("div",{children:[a.jsx("p",{className:"font-semibold text-white",children:D.siteName}),a.jsx("p",{className:"text-xs text-gray-400",children:Ce(new Date(D.requestedDate),"dd MMM, yyyy")})]}),a.jsx(_ae,{status:D.status})]}),a.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[a.jsxs("div",{className:"text-sm text-gray-300",children:[a.jsxs("p",{children:[D.gender," Uniforms"]}),a.jsxs("p",{className:"font-semibold",children:[O(D.items)," Items"]})]}),D.status==="Pending"&&a.jsxs("div",{className:"flex items-center gap-2",children:[a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>E(D),children:a.jsx(Jn,{className:"h-4 w-4 text-gray-400"})}),a.jsx(Y,{variant:"icon",size:"sm",onClick:()=>v(D),children:a.jsx(kt,{className:"h-4 w-4 text-red-500"})})]})]})]},D.id)):a.jsxs("div",{className:"text-center text-muted pt-16",children:[a.jsx(Ag,{className:"h-12 w-12 mx-auto mb-4"}),a.jsx("p",{children:"No uniform requests found."}),a.jsxs(Y,{onClick:P,className:"mt-4",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},jae=Ke({title:ie().required("Title is required"),description:ie().required("Description is required"),category:ie().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:ie().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:ie().optional().nullable(),attachment:ot().optional().nullable()}).defined(),Cae=({isOpen:n,onClose:e,onSuccess:t})=>{var j,k;const{user:s}=tt(),[r,i]=C.useState(!1),[o,l]=C.useState([]),c=Nt("(max-width: 767px)"),{register:d,handleSubmit:h,control:f,formState:{errors:p},reset:g}=xt({resolver:Lt(jae),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),b=ll({control:f,name:"category"});C.useEffect(()=>{n&&te.getUsers().then(l)},[n]);const v=C.useMemo(()=>{if(!o)return[];switch(b){case"Software Developer":return o.filter(P=>P.role==="developer");case"Admin":return o.filter(P=>P.role==="admin");case"HR Query":return o.filter(P=>P.role==="hr");case"Operational":return o.filter(P=>["operation_manager","site_manager"].includes(P.role));default:const S=["admin","hr","developer","operation_manager","site_manager"];return o.filter(P=>S.includes(P.role))}},[o,b]),_=async S=>{if(s){i(!0);try{const P=o.find(M=>M.id===S.assignedToId),E=await te.createSupportTicket({...S,attachment:S.attachment,status:"Open",raisedById:s.id,raisedByName:s.name,assignedToId:S.assignedToId||null,assignedToName:(P==null?void 0:P.name)||null,resolvedAt:null,closedAt:null,rating:null,feedback:null});t(E),g()}catch(P){console.error(P)}finally{i(!1)}}};if(!n)return null;const N="new-ticket-form";return c?a.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col bg-[#0f1f0f] text-white animate-fade-in-scale",children:[a.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 border-b border-[#374151]",children:[a.jsx(Y,{variant:"icon",onClick:e,"aria-label":"Close form",children:a.jsx(Er,{className:"h-6 w-6"})}),a.jsx("h3",{className:"text-lg font-semibold",children:"Create New Post"})]}),a.jsxs("form",{id:N,onSubmit:h(_),className:"flex-1 overflow-y-auto p-4 space-y-4",children:[a.jsx(he,{placeholder:"Title / Subject",...d("title"),error:(j=p.title)==null?void 0:j.message,className:"form-input"}),a.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${p.description?"form-input--error":""}`}),a.jsx(de,{name:"category",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{...S,error:(P=p.category)==null?void 0:P.message,className:"pro-select pro-select-arrow",children:[a.jsx("option",{children:"Software Developer"}),a.jsx("option",{children:"Admin"}),a.jsx("option",{children:"Operational"}),a.jsx("option",{children:"HR Query"}),a.jsx("option",{children:"Other"})]})}}),a.jsx(de,{name:"priority",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{...S,error:(P=p.priority)==null?void 0:P.message,className:"pro-select pro-select-arrow",children:[a.jsx("option",{children:"Low"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Urgent"})]})}}),a.jsx(de,{name:"assignedToId",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{...S,value:S.value??"",error:(P=p.assignedToId)==null?void 0:P.message,className:"pro-select pro-select-arrow",children:[a.jsx("option",{value:"",children:"Unassigned"}),v.map(E=>a.jsxs("option",{value:E.id,children:[E.name," (",E.role.replace(/_/g," "),")"]},E.id))]})}}),a.jsx(de,{name:"attachment",control:f,render:({field:S,fieldState:P})=>{var E;return a.jsx(qe,{label:"Attach Screenshot or Document (Image only)",file:S.value,onFileChange:S.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:(E=P.error)==null?void 0:E.message})}})]}),a.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-end gap-3 border-t border-[#374151]",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",form:N,isLoading:r,children:"Create Post"})]})]}):a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-lg m-4 animate-fade-in-scale flex flex-col max-h-[85vh]",onClick:S=>S.stopPropagation(),children:[a.jsx("div",{className:"p-6 border-b flex-shrink-0",children:a.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Create New Post"})}),a.jsx("form",{id:N,onSubmit:h(_),className:"flex-grow overflow-y-auto",children:a.jsxs("div",{className:"p-6 space-y-4",children:[a.jsx(he,{label:"Title / Subject",...d("title"),error:(k=p.title)==null?void 0:k.message}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted",children:"Description"}),a.jsx("textarea",{...d("description"),rows:5,className:`mt-1 form-input ${p.description?"form-input--error":""}`}),p.description&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:p.description.message})]}),a.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.jsx(de,{name:"category",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{label:"Category",...S,error:(P=p.category)==null?void 0:P.message,children:[a.jsx("option",{children:"Software Developer"}),a.jsx("option",{children:"Admin"}),a.jsx("option",{children:"Operational"}),a.jsx("option",{children:"HR Query"}),a.jsx("option",{children:"Other"})]})}}),a.jsx(de,{name:"priority",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{label:"Priority",...S,error:(P=p.priority)==null?void 0:P.message,children:[a.jsx("option",{children:"Low"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Urgent"})]})}})]}),a.jsx(de,{name:"assignedToId",control:f,render:({field:S})=>{var P;return a.jsxs(Te,{label:"Assigned To (Optional)",...S,value:S.value??"",error:(P=p.assignedToId)==null?void 0:P.message,children:[a.jsx("option",{value:"",children:"Unassigned"}),v.map(E=>a.jsxs("option",{value:E.id,children:[E.name," (",E.role.replace(/_/g," "),")"]},E.id))]})}}),a.jsx(de,{name:"attachment",control:f,render:({field:S,fieldState:P})=>{var E;return a.jsx(qe,{label:"Attach Screenshot or Document (Image only)",file:S.value,onFileChange:S.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:(E=P.error)==null?void 0:E.message})}})]})}),a.jsxs("div",{className:"p-6 mt-auto border-t flex-shrink-0 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),a.jsx(Y,{type:"submit",form:N,isLoading:r,children:"Create Post"})]})]})})},kae=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return a.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},Tae=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return a.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},Eae=({ticket:n,onClick:e})=>a.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[a.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),a.jsx("div",{className:"flex-shrink-0 mt-1",children:a.jsx(kae,{priority:n.priority})})]}),a.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),a.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[a.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[a.jsxs("div",{className:"flex items-center gap-1.5",children:[a.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),a.jsx("span",{children:n.raisedByName})]}),a.jsx("span",{children:Zc(new Date(n.raisedAt),{addSuffix:!0})})]}),a.jsx("div",{className:"flex justify-between items-center",children:a.jsx(Tae,{status:n.status})})]})]}),wT=({user:n,onAction:e})=>a.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ea,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),a.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),a.jsxs("div",{className:"flex-grow min-w-0",children:[a.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),a.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,t=>t.toUpperCase())})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Call",onClick:()=>e(n.phone),children:a.jsx(Jw,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Message",onClick:()=>e(n.phone),children:a.jsx(Zw,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},title:"Video",onClick:()=>e(n.phone),children:a.jsx(KD,{className:"h-4 w-4"})})]})]}),Pae=()=>{const{user:n}=tt(),e=Vt(),[t,s]=C.useState([]),[r,i]=C.useState([]),[o,l]=C.useState(!0),[c,d]=C.useState(null),[h,f]=C.useState(!1),[p,g]=C.useState(!1),b=Nt("(max-width: 1023px)"),[v,_]=C.useState({status:"all",priority:"all",searchTerm:""});C.useEffect(()=>{(async()=>{if(n){l(!0);try{const[M,I]=await Promise.all([te.getSupportTickets(),te.getNearbyUsers()]);s(M),i(I.filter(O=>O.id!==n.id))}catch{d({message:"Failed to load support data.",type:"error"})}finally{l(!1)}}})()},[n]);const N=C.useMemo(()=>t.filter(E=>{const M=v.status==="all"||E.status===v.status,I=v.priority==="all"||E.priority===v.priority,O=v.searchTerm===""||E.title.toLowerCase().includes(v.searchTerm.toLowerCase())||E.ticketNumber.toLowerCase().includes(v.searchTerm.toLowerCase())||E.description.toLowerCase().includes(v.searchTerm.toLowerCase());return M&&I&&O}),[t,v]),j=C.useMemo(()=>{const E=t.filter(M=>M.status==="Resolved"&&M.raisedById===(n==null?void 0:n.id));return{open:t.filter(M=>M.status==="Open").length,inProgress:t.filter(M=>M.status==="In Progress").length,pendingYourAction:E.length}},[t,n]),k=E=>{s(M=>[E,...M]),f(!1),d({message:"New ticket created successfully!",type:"success"}),e(`/support/ticket/${E.id}`)},S=E=>{if(!E){d({message:"User does not have a phone number.",type:"error"});return}let M=E.replace(/\D/g,"");if(M.length>10&&(M=M.slice(-10)),M.length!==10){d({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${M}`,"_blank")},P=({title:E,value:M,icon:I,colorClass:O})=>a.jsxs("div",{className:"relative overflow-hidden bg-card p-5 rounded-2xl border border-border shadow-sm",children:[a.jsx("div",{className:`absolute top-0 right-0 p-3 opacity-10 ${O}`,children:I}),a.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:E}),a.jsx("p",{className:`text-3xl font-bold ${O.replace("bg-","text-").split(" ")[0]}`,children:M})]});return a.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[c&&a.jsx(gt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),h&&a.jsx(Cae,{isOpen:h,onClose:()=>f(!1),onSuccess:k}),a.jsx(yn,{isOpen:p,onClose:()=>g(!1),title:"Nearby Available Support",onConfirm:()=>g(!1),confirmButtonText:"Close",children:a.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:r.length>0?r.map(E=>a.jsx(wT,{user:E,onAction:S},E.id)):a.jsxs("div",{className:"text-center py-8 text-muted",children:[a.jsx(Ei,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),a.jsx("p",{children:"No support staff found nearby."})]})})}),a.jsxs("div",{className:"relative overflow-hidden rounded-3xl bg-gradient-to-r from-emerald-900 to-teal-900 p-6 lg:p-10 shadow-xl",children:[a.jsx("div",{className:"absolute top-0 right-0 w-64 h-64 bg-white opacity-5 rounded-full blur-3xl -mr-16 -mt-16"}),a.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[a.jsx("div",{className:"p-2 bg-white/10 rounded-lg backdrop-blur-sm",children:a.jsx(uh,{className:"h-6 w-6 text-emerald-400"})}),a.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-white",children:"Support & Audit"})]}),a.jsx("p",{className:"text-emerald-100/80 max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),a.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[b&&a.jsxs(Y,{onClick:()=>g(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-white/10 border-white/20 text-white hover:bg-white/20 backdrop-blur-sm text-sm py-2 px-3",children:[a.jsx(nd,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),a.jsxs(Y,{onClick:()=>f(!0),className:"flex-1 lg:flex-none bg-emerald-500 hover:bg-emerald-400 text-white border-none shadow-lg shadow-emerald-900/20 text-sm py-2 px-4",children:[a.jsx(ct,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})]}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[a.jsx(P,{title:"Open Tickets",value:j.open,icon:a.jsx(uh,{className:"h-16 w-16"}),colorClass:"text-rose-500"}),a.jsx(P,{title:"In Progress",value:j.inProgress,icon:a.jsx(Qe,{className:"h-16 w-16"}),colorClass:"text-blue-500"}),a.jsx(P,{title:"Pending Your Action",value:j.pendingYourAction,icon:a.jsx(nd,{className:"h-16 w-16"}),colorClass:"text-amber-500"})]}),a.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[a.jsx("div",{className:"lg:col-span-2 space-y-6",children:a.jsxs("div",{className:"bg-card p-5 rounded-2xl border border-border shadow-sm",children:[a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[a.jsxs("div",{className:"relative flex-grow",children:[a.jsx(ua,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted"}),a.jsx(he,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-background",value:v.searchTerm,onChange:E=>_(M=>({...M,searchTerm:E.target.value}))})]}),a.jsxs("div",{className:"flex gap-2",children:[a.jsx("div",{className:"w-32 sm:w-40",children:a.jsxs(Te,{value:v.status,onChange:E=>_(M=>({...M,status:E.target.value})),className:"bg-background",children:[a.jsx("option",{value:"all",children:"All Status"}),a.jsx("option",{children:"Open"}),a.jsx("option",{children:"In Progress"}),a.jsx("option",{value:"Pending Requester",children:"Pending"}),a.jsx("option",{children:"Resolved"}),a.jsx("option",{children:"Closed"})]})}),a.jsx("div",{className:"w-32 sm:w-40",children:a.jsxs(Te,{value:v.priority,onChange:E=>_(M=>({...M,priority:E.target.value})),className:"bg-background",children:[a.jsx("option",{value:"all",children:"All Priority"}),a.jsx("option",{children:"Low"}),a.jsx("option",{children:"Medium"}),a.jsx("option",{children:"High"}),a.jsx("option",{children:"Urgent"})]})})]})]}),o?a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})}):a.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:N.length>0?N.map(E=>a.jsx(Eae,{ticket:E,onClick:()=>e(`/support/ticket/${E.id}`)},E.id)):a.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[a.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:a.jsx(ua,{className:"h-8 w-8 opacity-50"})}),a.jsx("p",{children:"No tickets match your filters."})]})})]})}),a.jsx("aside",{className:"hidden lg:block space-y-6",children:a.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[a.jsxs("div",{className:"flex items-center justify-between mb-6",children:[a.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[a.jsx(Ei,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),a.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[r.filter(E=>E.isAvailable).length," Online"]})]}),a.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:r.length>0?r.map(E=>a.jsx(wT,{user:E,onAction:S},E.id)):a.jsx("div",{className:"text-center py-8 text-muted",children:a.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},Mae=({post:n,ticket:e,setTicket:t})=>{const{user:s}=tt(),[r,i]=C.useState(!1),[o,l]=C.useState(""),[c,d]=C.useState(!1),h=s?n.likes.includes(s.id):!1,f=async()=>{if(!s)return;const g=[...n.likes],b=h?n.likes.filter(v=>v!==s.id):[...n.likes,s.id];t(v=>v?{...v,posts:v.posts.map(_=>_.id===n.id?{..._,likes:b}:_)}:null);try{await te.togglePostLike(n.id,s.id)}catch{t(_=>_?{..._,posts:_.posts.map(N=>N.id===n.id?{...N,likes:g}:N)}:null)}},p=async()=>{if(!(!o.trim()||!s)){d(!0);try{const g=await te.addPostComment(n.id,{postId:n.id,authorId:s.id,authorName:s.name,content:o});t(b=>b?{...b,posts:b.posts.map(v=>v.id===n.id?{...v,comments:[...v.comments,g]}:v)}:null),l("")}catch{}finally{d(!1)}}};return a.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:a.jsxs("div",{className:"flex items-start gap-3",children:[a.jsx(ea,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"w-full",children:[a.jsxs("div",{className:"flex items-baseline gap-2",children:[a.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),a.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),a.jsxs("span",{className:"text-xs text-muted",children:[" ",Zc(new Date(n.createdAt),{addSuffix:!0})]})]}),a.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),a.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[a.jsxs("button",{onClick:f,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${h?"text-accent font-semibold":""}`,children:[a.jsx(AZ,{className:`h-4 w-4 ${h?"fill-current":""}`}),a.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),a.jsxs("button",{onClick:()=>i(!r),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[a.jsx(Zw,{className:"h-4 w-4"}),a.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),r&&a.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(g=>a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(ea,{seed:g.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[a.jsxs("div",{className:"flex items-baseline gap-2",children:[a.jsx("span",{className:"font-semibold text-sm text-primary-text",children:g.authorName}),a.jsx("span",{className:"text-xs text-muted",children:Zc(new Date(g.createdAt),{addSuffix:!0})})]}),a.jsx("p",{className:"text-sm text-muted",children:g.content})]})]},g.id)),a.jsxs("div",{className:"flex items-start gap-2",children:[a.jsx(ea,{className:"w-8 h-8 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("textarea",{value:o,onChange:g=>l(g.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),a.jsx("div",{className:"text-right mt-1",children:a.jsx(Y,{size:"sm",onClick:p,isLoading:c,children:"Post"})})]})]})]})]})]})})},Dae=Ke({rating:ss().min(1,"Please select a rating.").required(),feedback:ie().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),Aae=({value:n,onChange:e})=>{const[t,s]=C.useState(0);return a.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>s(0),children:[1,2,3,4,5].map(r=>a.jsx("button",{type:"button",onMouseEnter:()=>s(r),onClick:()=>e(r),className:"focus:outline-none",children:a.jsx(ZD,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=r?"text-yellow-400 fill-current":"text-gray-400"}`})},r))})},Iae=({isOpen:n,onClose:e,onSubmit:t})=>{const[s,r]=C.useState(!1),{register:i,handleSubmit:o,control:l,formState:{errors:c}}=xt({resolver:Lt(Dae),defaultValues:{rating:0,feedback:""}}),d=h=>{r(!0),t(h.rating,h.feedback),r(!1)};return n?a.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:a.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:a.jsxs("form",{onSubmit:o(d),children:[a.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),a.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx(de,{name:"rating",control:l,render:({field:h})=>a.jsx(Aae,{value:h.value,onChange:h.onChange})}),c.rating&&a.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),a.jsxs("div",{children:[a.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),a.jsx("textarea",{...i("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),a.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[a.jsx(Y,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),a.jsx(Y,{type:"submit",isLoading:s,children:"Confirm & Close"})]})]})})}):null},Oae=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return a.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},Rae=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return a.jsx("span",{className:`status-chip ${e[n]}`,children:n})},Lae=()=>{const{id:n}=HP(),e=Vt(),{user:t}=tt(),[s,r]=C.useState(null),[i,o]=C.useState([]),[l,c]=C.useState(!0),[d,h]=C.useState(null),[f,p]=C.useState(""),[g,b]=C.useState(!1),[v,_]=C.useState(!1);Nt("(max-width: 1023px)"),C.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[I,O]=await Promise.all([te.getSupportTicketById(n),te.getNearbyUsers()]);I?r(I):(h({message:"Ticket not found.",type:"error"}),e("/support")),o(O)}catch{h({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const N=async()=>{if(!(!f.trim()||!s||!t)){b(!0);try{const M=await te.addTicketPost(s.id,{ticketId:s.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:f});r(I=>I?{...I,posts:[...I.posts,M]}:null),p("")}catch{h({message:"Failed to add post.",type:"error"})}finally{b(!1)}}},j=async M=>{if(s)try{const I=await te.updateSupportTicket(s.id,M);r(I),M.status&&h({message:`Ticket status updated to ${M.status}`,type:"success"})}catch{h({message:"Failed to update ticket.",type:"error"})}},k=async(M,I)=>{await j({status:"Closed",rating:M,feedback:I,closedAt:new Date().toISOString()}),_(!1)},S=M=>{if(!M){h({message:"User does not have a phone number.",type:"error"});return}let I=M.replace(/\D/g,"");if(I.length>10&&(I=I.slice(-10)),I.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${I}`,"_blank")};if(l)return a.jsx("div",{className:"flex justify-center items-center h-screen",children:a.jsx(Qe,{className:"h-12 w-12 animate-spin text-accent"})});if(!s)return null;const P=(t==null?void 0:t.id)===s.raisedById,E=()=>s.status==="Closed"?null:a.jsxs("div",{className:"flex flex-wrap gap-2",children:[s.status==="Open"&&a.jsx(Y,{onClick:()=>j({status:"In Progress",assignedToId:t==null?void 0:t.id,assignedToName:t==null?void 0:t.name}),children:"Assign to Me"}),s.status==="In Progress"&&(t==null?void 0:t.id)===s.assignedToId&&a.jsx(Y,{onClick:()=>j({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),s.status==="Resolved"&&P&&a.jsx(Y,{onClick:()=>_(!0),children:"Close Ticket"})]});return a.jsxs("div",{className:"p-4",children:[d&&a.jsx(gt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),v&&a.jsx(Iae,{isOpen:v,onClose:()=>_(!1),onSubmit:k}),a.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[a.jsx(Y,{variant:"icon",onClick:()=>e("/support"),children:a.jsx(Er,{})}),a.jsxs("div",{children:[a.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:s.title}),a.jsxs("p",{className:"text-xs text-muted",children:["#",s.ticketNumber]})]})]}),a.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[a.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[a.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[a.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[a.jsxs("div",{className:"flex items-center gap-4",children:[a.jsx(Rae,{status:s.status}),a.jsx(Oae,{priority:s.priority})]}),a.jsxs("div",{className:"text-sm text-muted text-right",children:[a.jsxs("p",{children:["Raised by: ",a.jsx("span",{className:"font-semibold text-primary-text",children:s.raisedByName})]}),a.jsx("p",{children:Ce(new Date(s.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),a.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:s.description}),s.attachmentUrl&&a.jsxs("div",{className:"mt-4",children:[a.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),a.jsx("a",{href:s.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:a.jsx("img",{src:s.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),a.jsx("div",{className:"space-y-4",children:s.posts.map(M=>a.jsx(Mae,{post:M,ticket:s,setTicket:r},M.id))}),s.status!=="Closed"&&a.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[a.jsx(ea,{className:"w-10 h-10 rounded-full flex-shrink-0"}),a.jsxs("div",{className:"w-full",children:[a.jsx("textarea",{value:f,onChange:M=>p(M.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),a.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[a.jsx(Y,{variant:"icon",size:"sm",title:"Attach file",children:a.jsx(kZ,{className:"h-5 w-5"})}),a.jsxs(Y,{onClick:N,isLoading:g,children:[a.jsx(Qw,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),a.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[a.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[a.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),a.jsxs("div",{className:"space-y-2 text-sm",children:[a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",a.jsx("span",{className:"font-semibold",children:s.assignedToName||"Unassigned"})]}),a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted",children:"Category:"})," ",a.jsx("span",{children:s.category})]}),s.resolvedAt&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted",children:"Resolved:"})," ",a.jsx("span",{children:Ce(new Date(s.resolvedAt),"dd MMM, yy")})]}),s.closedAt&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted",children:"Closed:"})," ",a.jsx("span",{children:Ce(new Date(s.closedAt),"dd MMM, yy")})]}),s.rating&&a.jsxs("div",{className:"flex justify-between",children:[a.jsx("span",{className:"text-muted",children:"Rating:"})," ",a.jsxs("span",{className:"flex items-center gap-1",children:[s.rating," ",a.jsx(ZD,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),a.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:E()})]}),a.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[a.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[a.jsx(Ei,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),a.jsx("div",{className:"space-y-3",children:i.map(M=>a.jsxs("div",{className:"flex items-center gap-3",children:[a.jsxs("div",{className:"relative",children:[a.jsx(ea,{photoUrl:M.photoUrl,seed:M.id,className:"w-10 h-10 rounded-full"}),a.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),a.jsxs("div",{className:"flex-grow",children:[a.jsx("p",{className:"text-sm font-semibold",children:M.name}),a.jsx("p",{className:"text-xs text-muted",children:M.role.replace(/_/g," ").replace(/\b\w/g,I=>I.toUpperCase())})]}),a.jsxs("div",{className:"flex items-center gap-1",children:[a.jsx(Y,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>S(M.phone),children:a.jsx(Jw,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>S(M.phone),children:a.jsx(Zw,{className:"h-4 w-4"})}),a.jsx(Y,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>S(M.phone),children:a.jsx(KD,{className:"h-4 w-4"})})]})]},M.id))})]})]})]})]})},Pn=({label:n,isVerified:e,hasValue:t,error:s,registration:r,onManualInput:i,...o})=>{const{theme:l}=Eh(),c=l==="dark",h=r?{...r,onChange:async f=>{i&&i(),r!=null&&r.onChange&&await r.onChange(f)}}:void 0;return a.jsxs("div",{children:[a.jsxs("div",{className:"flex items-center mb-1",children:[a.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?a.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:a.jsx(Kr,{className:"h-4 w-4"})}):a.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:a.jsx(Jr,{className:"h-4 w-4"})}))]}),a.jsx(he,{id:o.id,error:s,registration:h,label:"",...o})]})},Fae=Ke({employeeId:ie().required(),firstName:ie().required("First name is required"),middleName:ie().optional(),lastName:ie().required("Last name is required"),preferredName:ie().optional(),dob:ie().required("Date of birth is required"),gender:ie().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:ie().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:ie().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:ie().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:ie().optional().nullable(),email:ie().email("Must be a valid email").required("Email is required"),idProofType:ie().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:ie().optional(),photo:ot().optional().nullable(),idProofFront:ot().optional().nullable(),idProofBack:ot().optional().nullable(),emergencyContactName:ie().required("Emergency contact name is required"),emergencyContactNumber:ie().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:ie().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:ss().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:Ke().optional()}).defined(),$ae=()=>{var g,b,v,_,N,j,k,S,P,E,M,I,O,D;const{onValidated:n}=dr(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:s,setPersonalVerifiedStatus:r}=rn(),{register:i,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:h}=xt({resolver:Lt(Fae),defaultValues:e.personal}),f=h();C.useEffect(()=>{d(e.personal)},[e.personal,d]),C.useEffect(()=>{let z;const H=h(F=>{clearTimeout(z),z=window.setTimeout(()=>{t(F)},500)});return()=>{H.unsubscribe(),clearTimeout(z)}},[h,t]);const p=async z=>{t(z),s(),await n()};return a.jsxs("form",{onSubmit:o(p),id:"personal-form",children:[a.jsx("div",{className:"text-left",children:a.jsx(Fn,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[a.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:a.jsx(de,{name:"photo",control:c,render:({field:z})=>a.jsx(e0,{file:z.value,onFileChange:H=>z.onChange(H)})})}),a.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[a.jsx("div",{className:"md:col-span-3",children:a.jsx(he,{label:"Employee ID",id:"employeeId",registration:i("employeeId"),error:(g=l.employeeId)==null?void 0:g.message,readOnly:!0,className:"bg-gray-100"})}),a.jsx(Pn,{label:"First Name",id:"firstName",registration:i("firstName"),error:(b=l.firstName)==null?void 0:b.message,isVerified:((v=e.personal.verifiedStatus)==null?void 0:v.name)===!0,hasValue:!!f.firstName,onManualInput:()=>r({name:!1})}),a.jsx(he,{label:"Middle Name (Optional)",id:"middleName",registration:i("middleName")}),a.jsx(Pn,{label:"Last Name",id:"lastName",registration:i("lastName"),error:(_=l.lastName)==null?void 0:_.message,isVerified:((N=e.personal.verifiedStatus)==null?void 0:N.name)===!0,hasValue:!!f.lastName,onManualInput:()=>r({name:!1})}),a.jsx(he,{label:"Preferred Name (Optional)",id:"preferredName",registration:i("preferredName")}),a.jsx(de,{name:"dob",control:c,render:({field:z})=>{var H;return a.jsx($t,{label:"Date of Birth",id:"dob",error:(H=l.dob)==null?void 0:H.message,value:z.value,onChange:F=>{z.onChange(F),r({dob:!1})},maxDate:new Date})}}),a.jsxs(Te,{label:"Gender",id:"gender",registration:i("gender"),error:(j=l.gender)==null?void 0:j.message,children:[a.jsx("option",{value:"",children:"Select Gender"}),a.jsx("option",{children:"Male"}),a.jsx("option",{children:"Female"}),a.jsx("option",{children:"Other"})]}),a.jsxs(Te,{label:"Marital Status",id:"maritalStatus",registration:i("maritalStatus"),error:(k=l.maritalStatus)==null?void 0:k.message,children:[a.jsx("option",{value:"",children:"Select Status"}),a.jsx("option",{children:"Single"}),a.jsx("option",{children:"Married"}),a.jsx("option",{children:"Divorced"}),a.jsx("option",{children:"Widowed"})]}),a.jsxs(Te,{label:"Blood Group",id:"bloodGroup",registration:i("bloodGroup"),error:(S=l.bloodGroup)==null?void 0:S.message,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"A+"}),a.jsx("option",{children:"A-"}),a.jsx("option",{children:"B+"}),a.jsx("option",{children:"B-"}),a.jsx("option",{children:"AB+"}),a.jsx("option",{children:"AB-"}),a.jsx("option",{children:"O+"}),a.jsx("option",{children:"O-"})]}),a.jsx(he,{label:"Mobile Number",id:"mobile",type:"tel",registration:i("mobile"),error:(P=l.mobile)==null?void 0:P.message}),a.jsx(he,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:i("alternateMobile")}),a.jsx(he,{label:"Email Address",id:"email",type:"email",registration:i("email"),error:(E=l.email)==null?void 0:E.message}),a.jsx(he,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:i("salary"),error:(M=l.salary)==null?void 0:M.message}),a.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[a.jsx(he,{label:"Contact Name",id:"emergencyContactName",registration:i("emergencyContactName"),error:(I=l.emergencyContactName)==null?void 0:I.message}),a.jsx(he,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:i("emergencyContactNumber"),error:(O=l.emergencyContactNumber)==null?void 0:O.message}),a.jsxs(Te,{label:"Relationship",id:"relationship",registration:i("relationship"),error:(D=l.relationship)==null?void 0:D.message,children:[a.jsx("option",{value:"",children:"Select Relationship"}),a.jsx("option",{children:"Spouse"}),a.jsx("option",{children:"Child"}),a.jsx("option",{children:"Father"}),a.jsx("option",{children:"Mother"}),a.jsx("option",{children:"Sibling"}),a.jsx("option",{children:"Other"})]})]})]})]})]})]})},_T=Ke({line1:ie().required("Address line 1 is required"),line2:ie().optional(),city:ie().required("City is required"),state:ie().required("State is required"),country:ie().required("Country is required"),pincode:ie().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:Ke().optional()}).defined(),zae=Ke({present:_T.required(),permanent:_T.required(),sameAsPresent:ns().required()}).defined(),Uae=()=>{var I,O,D,z,H,F,R,V,U,W,B,q,Q,le,X,Z,se,G,ne,ge,ye,re,ae,ve,pe,Ne,Me,Oe,Je,dt;const{onValidated:n}=dr(),{data:e,updateAddress:t,setAddressVerifiedStatus:s}=rn(),{address:r}=ir(),[i,o]=C.useState(!1),[l,c]=C.useState(""),{register:d,handleSubmit:h,formState:{errors:f},control:p,setValue:g,trigger:b,getValues:v,reset:_,watch:N}=xt({resolver:Lt(zae),defaultValues:e.address}),j=ll({control:p,name:"sameAsPresent"}),k=ll({control:p,name:"present"}),S=ll({control:p,name:"permanent"});C.useEffect(()=>{_(e.address)},[e.address,_]),C.useEffect(()=>{let at;const _t=N(J=>{clearTimeout(at),at=window.setTimeout(()=>{t(J)},500)});return()=>{_t.unsubscribe(),clearTimeout(at)}},[N,t]),C.useEffect(()=>{j&&(g("permanent",k),b("permanent"))},[j,k,g,b]);const P=(at,_t)=>{s(at,{[_t]:!1})},E=async at=>{const _t=at.target.value;if(P("present","pincode"),r.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(_t)){o(!0),c("");try{const J=await te.getPincodeDetails(_t);g("present.city",J.city,{shouldValidate:!0}),g("present.state",J.state,{shouldValidate:!0}),s("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},M=async at=>{t(at),await n()};return a.jsxs("form",{onSubmit:h(M),id:"address-form",children:[a.jsx(Fn,{title:"Address Details",subtitle:"Your communication and permanent address."}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx("div",{className:"sm:col-span-2",children:a.jsx(Pn,{label:"Address Line 1",id:"present.line1",isVerified:!!((I=e.address.present.verifiedStatus)!=null&&I.line1),hasValue:!!(k!=null&&k.line1),onManualInput:()=>P("present","line1"),error:(D=(O=f.present)==null?void 0:O.line1)==null?void 0:D.message,registration:d("present.line1")})}),a.jsx("div",{className:"sm:col-span-2",children:a.jsx(he,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),a.jsx(Pn,{label:"Country",id:"present.country",isVerified:!!((z=e.address.present.verifiedStatus)!=null&&z.country),hasValue:!!(k!=null&&k.country),onManualInput:()=>P("present","country"),error:(F=(H=f.present)==null?void 0:H.country)==null?void 0:F.message,registration:d("present.country")}),a.jsxs("div",{className:"relative",children:[a.jsx(Pn,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!((R=e.address.present.verifiedStatus)!=null&&R.pincode),hasValue:!!(k!=null&&k.pincode),error:((U=(V=f.present)==null?void 0:V.pincode)==null?void 0:U.message)||l,registration:d("present.pincode"),onBlur:E}),i&&a.jsx(Qe,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),a.jsx(Pn,{label:"City",id:"present.city",isVerified:!!((W=e.address.present.verifiedStatus)!=null&&W.city),hasValue:!!(k!=null&&k.city),onManualInput:()=>P("present","city"),error:(q=(B=f.present)==null?void 0:B.city)==null?void 0:q.message,registration:d("present.city")}),a.jsx(Pn,{label:"State",id:"present.state",isVerified:!!((Q=e.address.present.verifiedStatus)!=null&&Q.state),hasValue:!!(k!=null&&k.state),onManualInput:()=>P("present","state"),error:(X=(le=f.present)==null?void 0:le.state)==null?void 0:X.message,registration:d("present.state")})]})]}),a.jsxs("div",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),a.jsxs("div",{className:"flex items-center mb-4",children:[a.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),a.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!j&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[a.jsx("div",{className:"sm:col-span-2",children:a.jsx(Pn,{label:"Address Line 1",id:"permanent.line1",isVerified:!!((Z=e.address.permanent.verifiedStatus)!=null&&Z.line1),hasValue:!!(S!=null&&S.line1),onManualInput:()=>P("permanent","line1"),error:(G=(se=f.permanent)==null?void 0:se.line1)==null?void 0:G.message,registration:d("permanent.line1")})}),a.jsx("div",{className:"sm:col-span-2",children:a.jsx(he,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),a.jsx(Pn,{label:"Country",id:"permanent.country",isVerified:!!((ne=e.address.permanent.verifiedStatus)!=null&&ne.country),hasValue:!!(S!=null&&S.country),onManualInput:()=>P("permanent","country"),error:(ye=(ge=f.permanent)==null?void 0:ge.country)==null?void 0:ye.message,registration:d("permanent.country")}),a.jsx(Pn,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!((re=e.address.permanent.verifiedStatus)!=null&&re.pincode),hasValue:!!(S!=null&&S.pincode),onManualInput:()=>P("permanent","pincode"),error:(ve=(ae=f.permanent)==null?void 0:ae.pincode)==null?void 0:ve.message,registration:d("permanent.pincode")}),a.jsx(Pn,{label:"City",id:"permanent.city",isVerified:!!((pe=e.address.permanent.verifiedStatus)!=null&&pe.city),hasValue:!!(S!=null&&S.city),onManualInput:()=>P("permanent","city"),error:(Me=(Ne=f.permanent)==null?void 0:Ne.city)==null?void 0:Me.message,registration:d("permanent.city")}),a.jsx(Pn,{label:"State",id:"permanent.state",isVerified:!!((Oe=e.address.permanent.verifiedStatus)!=null&&Oe.state),hasValue:!!(S!=null&&S.state),onManualInput:()=>P("permanent","state"),error:(dt=(Je=f.permanent)==null?void 0:Je.state)==null?void 0:dt.message,registration:d("permanent.state")})]})]})]})]})},Vae=Ke({designation:ie().required("Designation is required"),department:ie().required("Department is required"),reportingManager:ie().optional(),organizationId:ie().required("Organization is required"),organizationName:ie().required(),joiningDate:ie().required("Joining date is required"),workType:ie().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:ie().optional(),defaultSalary:ss().nullable().optional()}).defined(),Bae=()=>{var j,k,S,P,E;const{onValidated:n}=dr(),{user:e}=tt(),{data:t,updateOrganization:s}=rn(),[r,i]=C.useState([]),o=Nt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,watch:f,setValue:p,reset:g}=xt({resolver:Lt(Vae),defaultValues:t.organization}),b=f("organizationId"),v=f("designation"),_=!!t.organization.organizationId;C.useEffect(()=>{te.getOrganizations().then(i)},[]),C.useEffect(()=>{g(t.organization)},[t.organization,g]),C.useEffect(()=>{let M;const I=f(O=>{clearTimeout(M),M=window.setTimeout(()=>{s(O)},500)});return()=>{I.unsubscribe(),clearTimeout(M)}},[f,s]),C.useEffect(()=>{const M=r.find(I=>I.id===b);M&&p("organizationName",M.shortName)},[b,r,p]),C.useEffect(()=>{v&&te.suggestDepartmentForDesignation(v).then(M=>{M&&p("department",M,{shouldValidate:!0})})},[v,p]);const N=async M=>{s(M),await n()};return o?a.jsx("form",{onSubmit:c(N),id:"organization-form",children:a.jsxs("div",{className:"space-y-6",children:[a.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),a.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:_,children:[a.jsx("option",{value:"",children:"Select Organization"}),r.map(M=>a.jsx("option",{value:M.id,children:M.shortName},M.id))]}),d.organizationId&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),a.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),a.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),a.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),a.jsx(de,{name:"joiningDate",control:h,render:({field:M})=>a.jsx("input",{type:"date",...M,className:"form-input"})}),d.joiningDate&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),a.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[a.jsx("option",{value:"",children:"Select Work Type"}),a.jsx("option",{children:"Full-time"}),a.jsx("option",{children:"Part-time"}),a.jsx("option",{children:"Contract"})]}),d.workType&&a.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):a.jsxs("form",{onSubmit:c(N),id:"organization-form",children:[a.jsx(Fn,{title:"Organization Details",subtitle:"Your employment details within the organization."}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsxs(Te,{label:"Organization / Client",id:"organizationId",error:(j=d.organizationId)==null?void 0:j.message,registration:l("organizationId"),disabled:_,children:[a.jsx("option",{value:"",children:"Select Organization"}),r.map(M=>a.jsx("option",{value:M.id,children:M.shortName},M.id))]}),a.jsx(he,{label:"Designation",id:"designation",error:(k=d.designation)==null?void 0:k.message,registration:l("designation")}),a.jsx(he,{label:"Department",id:"department",error:(S=d.department)==null?void 0:S.message,registration:l("department")}),a.jsx(he,{label:"Reporting Manager",id:"reportingManager",error:(P=d.reportingManager)==null?void 0:P.message,registration:l("reportingManager")}),a.jsx(de,{name:"joiningDate",control:h,render:({field:M})=>{var I;return a.jsx($t,{label:"Joining Date",id:"joiningDate",error:(I=d.joiningDate)==null?void 0:I.message,value:M.value,onChange:M.onChange})}}),a.jsxs(Te,{label:"Work Type",id:"workType",error:(E=d.workType)==null?void 0:E.message,registration:l("workType"),children:[a.jsx("option",{value:"",children:"Select Work Type"}),a.jsx("option",{children:"Full-time"}),a.jsx("option",{children:"Part-time"}),a.jsx("option",{children:"Contract"})]})]})]})},qae=()=>{const{onValidated:n,setToast:e}=dr(),{data:t,updateFamily:s}=rn(),{rulesByDesignation:r}=bo(),i=Nt("(max-width: 767px)"),o=t.organization.designation,l=C.useMemo(()=>{const H=o&&r[o];return H?H.documents.familyAadhaar:!1},[o,r]),c=Ke({id:ie().required(),relation:ie().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:ie().required("Name is required"),dob:ie().required("Date of birth is required"),gender:ie().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:ie().optional(),dependent:ns().required(),phone:ie().when("relation",{is:"Child",then:H=>H.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:H=>H.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:ot().nullable().when([],{is:()=>l,then:H=>H.test("is-required","Aadhaar proof is required for this designation.",F=>F!=null).nullable(),otherwise:H=>H.optional().nullable()})}),d=Ke({family:xs().of(c).required()}),{control:h,handleSubmit:f,formState:{errors:p},watch:g,setValue:b}=xt({resolver:Lt(d),defaultValues:{family:t.family}}),{fields:v,append:_,remove:N}=vs({control:h,name:"family"}),[j,k]=C.useState(!1),[S,P]=C.useState(null);C.useEffect(()=>{let H;const F=g(R=>{clearTimeout(H),H=window.setTimeout(()=>{s(R.family)},500)});return()=>{F.unsubscribe(),clearTimeout(H)}},[g,s]);const E=H=>F=>{let R=!1;if(F.name){const V=F.name.toLowerCase().replace(/\b(\w)/g,U=>U.toUpperCase());b(`family.${H}.name`,V,{shouldValidate:!0}),R=!0}if(F.dob)try{const V=F.dob.replace(/[/.]/g,"-"),U=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let W=null;for(const B of U){const q=Rw(V,B,new Date);if(!isNaN(q.getTime())){W=q;break}}if(W){const B=Ce(W,"yyyy-MM-dd");b(`family.${H}.dob`,B,{shouldValidate:!0}),R=!0}}catch{console.error("Could not parse date from OCR:",F.dob)}if(F.gender){const V=F.gender.toLowerCase().trim();V.includes("male")||V.includes("purush")||V==="m"?(b(`family.${H}.gender`,"Male",{shouldValidate:!0}),R=!0):(V.includes("female")||V.includes("mahila")||V==="f")&&(b(`family.${H}.gender`,"Female",{shouldValidate:!0}),R=!0)}R&&e({message:"Family member details auto-filled.",type:"success"})},M={type:De.OBJECT,properties:{name:{type:De.STRING},dob:{type:De.STRING},gender:{type:De.STRING}}},I=()=>{_({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},O=H=>{P(H),k(!0)},D=()=>{S!==null&&(N(S),k(!1),P(null))},z=async H=>{s(H.family),await n()};return i?a.jsxs("form",{onSubmit:f(z),id:"family-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),a.jsx("div",{className:"space-y-4",children:v.map((H,F)=>a.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[a.jsx("button",{type:"button",onClick:()=>O(F),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:a.jsx(kt,{className:"h-5 w-5"})}),a.jsx(de,{name:`family.${F}.relation`,control:h,render:({field:R})=>a.jsxs("select",{...R,className:"pro-select pro-select-arrow",children:[a.jsx("option",{value:"",children:"Select Relation"}),a.jsx("option",{children:"Spouse"}),a.jsx("option",{children:"Child"}),a.jsx("option",{children:"Father"}),a.jsx("option",{children:"Mother"})]})}),a.jsx(de,{name:`family.${F}.name`,control:h,render:({field:R})=>a.jsx("input",{placeholder:"Full Name",...R,className:"form-input"})}),a.jsx(de,{name:`family.${F}.dob`,control:h,render:({field:R})=>a.jsx("input",{type:"date",placeholder:"Date of Birth",...R,className:"form-input"})}),a.jsx(de,{name:`family.${F}.phone`,control:h,render:({field:R})=>a.jsx("input",{placeholder:"Phone Number",type:"tel",...R,className:"form-input"})})]},H.id))}),a.jsxs(Y,{type:"button",onClick:I,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):a.jsxs("form",{onSubmit:f(z),id:"family-form",children:[a.jsx(yn,{isOpen:j,onClose:()=>k(!1),onConfirm:D,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),a.jsx(Fn,{title:"Family Details",subtitle:"List your immediate family members."}),a.jsx("div",{className:"space-y-6",children:v.map((H,F)=>a.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[a.jsx("button",{type:"button",onClick:()=>O(F),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${H.name}`,children:a.jsx(kt,{className:"h-4 w-4"})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[a.jsx(de,{name:`family.${F}.relation`,control:h,render:({field:R})=>{var V,U,W;return a.jsxs(Te,{label:"Relation",id:R.name,error:(W=(U=(V=p.family)==null?void 0:V[F])==null?void 0:U.relation)==null?void 0:W.message,...R,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Spouse"}),a.jsx("option",{children:"Child"}),a.jsx("option",{children:"Father"}),a.jsx("option",{children:"Mother"})]})}}),a.jsx(de,{name:`family.${F}.name`,control:h,render:({field:R})=>{var V,U,W;return a.jsx(he,{label:"Full Name",id:R.name,error:(W=(U=(V=p.family)==null?void 0:V[F])==null?void 0:U.name)==null?void 0:W.message,...R})}}),a.jsx(de,{name:`family.${F}.dob`,control:h,render:({field:R})=>{var V,U,W;return a.jsx($t,{label:"Date of Birth",id:R.name,value:R.value,onChange:R.onChange,error:(W=(U=(V=p.family)==null?void 0:V[F])==null?void 0:U.dob)==null?void 0:W.message,maxDate:new Date})}}),a.jsx(de,{name:`family.${F}.gender`,control:h,render:({field:R})=>{var V,U,W;return a.jsxs(Te,{label:"Gender",id:R.name,error:(W=(U=(V=p.family)==null?void 0:V[F])==null?void 0:U.gender)==null?void 0:W.message,...R,children:[a.jsx("option",{value:"",children:"Select"}),a.jsx("option",{children:"Male"}),a.jsx("option",{children:"Female"}),a.jsx("option",{children:"Other"})]})}}),a.jsx(de,{name:`family.${F}.phone`,control:h,render:({field:R})=>{var V,U,W;return a.jsx(he,{label:"Phone Number",id:R.name,type:"tel",error:(W=(U=(V=p.family)==null?void 0:V[F])==null?void 0:U.phone)==null?void 0:W.message,...R,value:R.value??""})}}),a.jsx(de,{name:`family.${F}.occupation`,control:h,render:({field:R})=>a.jsx(he,{label:"Occupation (Optional)",id:R.name,...R,value:R.value??""})}),a.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:a.jsx(de,{name:`family.${F}.dependent`,control:h,render:({field:R})=>a.jsx(zt,{id:R.name,label:"Is a dependent?",checked:R.value,onChange:R.onChange})})}),a.jsx("div",{className:"col-span-full",children:a.jsx(de,{name:`family.${F}.idProof`,control:h,render:({field:R,fieldState:V})=>{var U;return a.jsx(qe,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:R.value,onFileChange:R.onChange,onOcrComplete:E(F),ocrSchema:M,setToast:e,error:(U=V.error)==null?void 0:U.message,docType:"Aadhaar"})}})})]})]},H.id))}),a.jsxs(Y,{type:"button",onClick:I,variant:"outline",className:"mt-6",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},Hae=()=>{const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),{data:s,updateEducation:r,updateEducationRecord:i}=rn(),o=Nt("(max-width: 767px)"),l=C.useMemo(()=>/manager|admin|head/i.test(s.organization.designation),[s.organization.designation]),c=C.useMemo(()=>Ke({id:ie().required(),degree:ie().required("Degree is required"),institution:ie().required("Institution is required"),startYear:ie().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:ie().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(F){const{startYear:R}=this.parent;return!R||!F||parseInt(F)>=parseInt(R)}),percentage:ss().nullable().min(0).max(100).optional(),grade:ie().optional(),document:ot().nullable().when([],{is:()=>l,then:F=>F.required("Certificate is mandatory for this role.").nullable(),otherwise:F=>F.optional().nullable()})}).defined(),[l]),d=Ke({education:xs().of(c).required()}),{control:h,handleSubmit:f,formState:{errors:p},setValue:g,reset:b,watch:v}=xt({resolver:Lt(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:_,append:N,remove:j}=vs({control:h,name:"education"}),[k,S]=C.useState(!1),[P,E]=C.useState(null);C.useEffect(()=>{b({education:s.education})},[s.education,b]),C.useEffect(()=>{let F;const R=v(V=>{clearTimeout(F),F=window.setTimeout(()=>{r(V.education)},500)});return()=>{R.unsubscribe(),clearTimeout(F)}},[v,r]);const M=()=>{N({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},I=F=>{E(F),S(!0)},O=()=>{P!==null&&(j(P),S(!1),E(null))},D=async F=>{r(F.education),await n()},z=F=>R=>{const V=_[F].id,U={};if(R.degree&&(g(`education.${F}.degree`,R.degree,{shouldValidate:!0}),U.degree=R.degree),R.institution&&(g(`education.${F}.institution`,R.institution,{shouldValidate:!0}),U.institution=R.institution),R.endYear){const W=R.endYear.toString();g(`education.${F}.endYear`,W,{shouldValidate:!0}),U.endYear=W}Object.keys(U).length>0&&(i(V,U),e({message:"Education details auto-filled.",type:"success"}))},H={type:De.OBJECT,properties:{degree:{type:De.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:De.STRING,description:"The name of the university, college, or institution."},endYear:{type:De.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?a.jsxs("form",{onSubmit:f(D),id:"education-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),a.jsx("div",{className:"space-y-4",children:_.map((F,R)=>a.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[a.jsx("button",{type:"button",onClick:()=>I(R),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:a.jsx(kt,{className:"h-5 w-5"})}),a.jsx(de,{name:`education.${R}.degree`,control:h,render:({field:V})=>a.jsx("input",{placeholder:"Degree / Certificate",...V,className:"form-input"})}),a.jsx(de,{name:`education.${R}.institution`,control:h,render:({field:V})=>a.jsx("input",{placeholder:"Institution / University",...V,className:"form-input"})}),a.jsx(de,{name:`education.${R}.endYear`,control:h,render:({field:V})=>a.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...V,className:"form-input"})}),a.jsx(de,{name:`education.${R}.document`,control:h,render:({field:V,fieldState:U})=>{var W;return a.jsx(qe,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:V.value,onFileChange:V.onChange,error:(W=U.error)==null?void 0:W.message,allowCapture:!0})}})]},F.id))}),a.jsxs(Y,{type:"button",onClick:M,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):a.jsxs("form",{onSubmit:f(D),id:"education-form",children:[a.jsx(yn,{isOpen:k,onClose:()=>S(!1),onConfirm:O,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),a.jsx(Fn,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),a.jsx("div",{className:"space-y-6",children:_.map((F,R)=>a.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[a.jsx("button",{type:"button",onClick:()=>I(R),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${F.degree}`,children:a.jsx(kt,{className:"h-4 w-4"})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsx(de,{name:`education.${R}.degree`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"Degree / Certificate",id:V.name,error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.degree)==null?void 0:B.message,...V})}}),a.jsx(de,{name:`education.${R}.institution`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"Institution / University",id:V.name,error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.institution)==null?void 0:B.message,...V})}}),a.jsx(de,{name:`education.${R}.startYear`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"Start Year",id:V.name,type:"text",maxLength:4,error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.startYear)==null?void 0:B.message,...V})}}),a.jsx(de,{name:`education.${R}.endYear`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"End Year",id:V.name,type:"text",maxLength:4,error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.endYear)==null?void 0:B.message,...V})}}),a.jsx(de,{name:`education.${R}.percentage`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"Percentage (Optional)",id:V.name,type:"number",error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.percentage)==null?void 0:B.message,...V,value:V.value??""})}}),a.jsx(de,{name:`education.${R}.grade`,control:h,render:({field:V})=>{var U,W,B;return a.jsx(he,{label:"Grade (Optional)",id:V.name,type:"text",error:(B=(W=(U=p.education)==null?void 0:U[R])==null?void 0:W.grade)==null?void 0:B.message,...V,value:V.value??""})}}),a.jsx("div",{className:"sm:col-span-2",children:a.jsx(de,{name:`education.${R}.document`,control:h,render:({field:V,fieldState:U})=>{var W;return a.jsx(qe,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:V.value,onFileChange:V.onChange,onOcrComplete:z(R),ocrSchema:H,setToast:e,error:(W=U.error)==null?void 0:W.message})}})})]})]},F.id))}),a.jsxs(Y,{type:"button",onClick:M,variant:"outline",className:"mt-6",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},m0=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Wae=ie().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(m0),Gae=Ke({accountHolderName:Wae.required("Account holder name is required"),accountNumber:ie().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:ie().oneOf([f_("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:ie().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:ie().required("Bank name is required"),branchName:ie().required("Branch name is required"),bankProof:ot().optional().nullable(),verifiedStatus:Ke().optional()}).defined(),Yae=()=>{var S,P,E,M,I,O,D,z,H,F;const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),{data:s,updateBank:r,setBankVerifiedStatus:i}=rn(),o=Nt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,setValue:f,watch:p,reset:g}=xt({resolver:Lt(Gae),defaultValues:s.bank});C.useEffect(()=>{g(s.bank)},[s.bank,g]),C.useEffect(()=>{let R;const V=p(U=>{clearTimeout(R),R=window.setTimeout(()=>{r(U)},500)});return()=>{V.unsubscribe(),clearTimeout(R)}},[p,r]);const b=p(),v=async R=>{r(R),await n()},_=R=>{const V=R.target.value;f("accountHolderName",m0(V),{shouldValidate:!0})},N=R=>{const V={};R.forEach(U=>{V[U]=!1}),i(V)},j=R=>{const V={},U={};if(R.accountHolderName){const W=m0(R.accountHolderName);f("accountHolderName",W,{shouldValidate:!0}),V.accountHolderName=W,U.accountHolderName=!0}if(R.accountNumber){const W=R.accountNumber.replace(/\D/g,"");f("accountNumber",W,{shouldValidate:!0}),f("confirmAccountNumber",W,{shouldValidate:!0}),V.accountNumber=W,V.confirmAccountNumber=W,U.accountNumber=!0}if(R.ifscCode){const W=R.ifscCode.toUpperCase().replace(/\s/g,"");f("ifscCode",W,{shouldValidate:!0}),V.ifscCode=W,U.ifscCode=!0}R.bankName&&(f("bankName",R.bankName,{shouldValidate:!0}),V.bankName=R.bankName),R.branchName&&(f("branchName",R.branchName,{shouldValidate:!0}),V.branchName=R.branchName),Object.keys(V).length>0&&r(V),i(U),e({message:"Bank details extracted. Please review.",type:"success"})},k={type:De.OBJECT,properties:{accountHolderName:{type:De.STRING,description:"The account holder's full name."},accountNumber:{type:De.STRING,description:"The full bank account number."},ifscCode:{type:De.STRING,description:"The bank's IFSC code."},bankName:{type:De.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:De.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?a.jsxs("form",{onSubmit:c(v),id:"bank-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:_,className:"form-input"}),a.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),a.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),a.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),a.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),a.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),a.jsx(de,{name:"bankProof",control:h,render:({field:R})=>a.jsx(qe,{label:"Upload Bank Proof (Optional)",file:R.value,onFileChange:R.onChange,allowCapture:!0})})]})]}):a.jsxs("form",{onSubmit:c(v),id:"bank-form",children:[a.jsx(Fn,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),a.jsxs("div",{className:"space-y-6",children:[a.jsx(de,{name:"bankProof",control:h,render:({field:R})=>a.jsx(qe,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:R.value,onFileChange:R.onChange,onOcrComplete:j,ocrSchema:k,setToast:e})}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[a.jsx(Pn,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!b.accountHolderName,isVerified:((S=s.bank.verifiedStatus)==null?void 0:S.accountHolderName)===!0,onManualInput:()=>N(["accountHolderName"]),error:(P=d.accountHolderName)==null?void 0:P.message,registration:l("accountHolderName"),onBlur:_}),a.jsx(Pn,{label:"Bank Name",id:"bankName",hasValue:!!b.bankName,isVerified:!1,error:(E=d.bankName)==null?void 0:E.message,registration:l("bankName")}),a.jsx(Pn,{label:"Account Number",id:"accountNumber",hasValue:!!b.accountNumber,isVerified:((M=s.bank.verifiedStatus)==null?void 0:M.accountNumber)===!0,onManualInput:()=>N(["accountNumber"]),error:(I=d.accountNumber)==null?void 0:I.message,registration:l("accountNumber")}),a.jsx(Pn,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!b.confirmAccountNumber,isVerified:((O=s.bank.verifiedStatus)==null?void 0:O.accountNumber)===!0,onManualInput:()=>N(["accountNumber"]),error:(D=d.confirmAccountNumber)==null?void 0:D.message,registration:l("confirmAccountNumber")}),a.jsx(Pn,{label:"IFSC Code",id:"ifscCode",hasValue:!!b.ifscCode,isVerified:((z=s.bank.verifiedStatus)==null?void 0:z.ifscCode)===!0,onManualInput:()=>N(["ifscCode"]),error:(H=d.ifscCode)==null?void 0:H.message,registration:l("ifscCode")}),a.jsx(Pn,{label:"Branch Name",id:"branchName",hasValue:!!b.branchName,isVerified:!1,error:(F=d.branchName)==null?void 0:F.message,registration:l("branchName")})]})]})]})},Zae=Ke({hasPreviousPf:ns().required(),uanNumber:ie().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:ie().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:ot().optional().nullable(),salarySlip:ot().optional().nullable(),verifiedStatus:Ke().optional()}).defined(),Kae=()=>{var S,P,E;const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),{data:s,updateUan:r,setUanVerifiedStatus:i}=rn(),o=Nt("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:h},setValue:f,watch:p,reset:g}=xt({resolver:Lt(Zae),defaultValues:s.uan});C.useEffect(()=>{g(s.uan)},[s.uan,g]),C.useEffect(()=>{let M;const I=p(O=>{clearTimeout(M),M=window.setTimeout(()=>{r(O)},500)});return()=>{I.unsubscribe(),clearTimeout(M)}},[p,r]);const b=p("hasPreviousPf"),v=p(),_=async M=>{r(M),await n()},N=()=>{i({uanNumber:!1})},j=M=>{if(M.uanNumber){const I=M.uanNumber.replace(/\D/g,"");if(I.length===12){const O={uanNumber:I,hasPreviousPf:!0};f("uanNumber",I,{shouldValidate:!0}),f("hasPreviousPf",!0,{shouldValidate:!0}),r(O),i({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},k={type:De.OBJECT,properties:{uanNumber:{type:De.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?a.jsxs("form",{onSubmit:d(_),id:"uan-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[a.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),a.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),b&&a.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[a.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),a.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),a.jsx(de,{name:"document",control:c,render:({field:M})=>a.jsx(qe,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):a.jsxs("form",{onSubmit:d(_),id:"uan-form",children:[a.jsx(Fn,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),a.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),s.uan.salarySlip&&a.jsxs("div",{className:"pt-4 border-t",children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),a.jsx(qe,{label:"",file:s.uan.salarySlip,onFileChange:()=>{}})]}),b&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx(Pn,{label:"UAN Number",id:"uanNumber",hasValue:!!v.uanNumber,isVerified:((S=s.uan.verifiedStatus)==null?void 0:S.uanNumber)===!0,onManualInput:N,registration:l("uanNumber"),error:(P=h.uanNumber)==null?void 0:P.message}),a.jsx(he,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:(E=h.pfNumber)==null?void 0:E.message})]}),a.jsx(de,{name:"document",control:c,render:({field:M})=>a.jsx(qe,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:j,ocrSchema:k,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},Jae=Ke({hasEsi:ns().required(),esiNumber:ie().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:ie().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:ie().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:ot().optional().nullable(),verifiedStatus:Ke().optional()}),Qae=()=>{var M,I,O;const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),{data:s,updateEsi:r,setEsiVerifiedStatus:i}=rn(),{esiCtcThreshold:o,enableEsiRule:l}=bo(),c=Nt("(max-width: 767px)"),{register:d,control:h,handleSubmit:f,formState:{errors:p},reset:g,setValue:b,watch:v}=xt({resolver:Lt(Jae),defaultValues:s.esi}),_=v("hasEsi"),N=v(),j=s.personal.salary!=null&&s.personal.salary<=o;C.useEffect(()=>{g(s.esi)},[s.esi,g]),C.useEffect(()=>{let D;const z=v(H=>{clearTimeout(D),D=window.setTimeout(()=>{r(H)},500)});return()=>{z.unsubscribe(),clearTimeout(D)}},[v,r]),C.useEffect(()=>{j||s.esi.hasEsi&&r({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[j,s.esi.hasEsi,r]);const k=async D=>{r(D),await n()},S=()=>{i({esiNumber:!1})},P=D=>{if(D.esiNumber){const z=D.esiNumber.replace(/\D/g,"");if(z.length===10||z.length===17){const H={esiNumber:z,hasEsi:!0};b("esiNumber",z,{shouldValidate:!0}),b("hasEsi",!0,{shouldValidate:!0}),r(H),i({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},E={type:De.OBJECT,properties:{esiNumber:{type:De.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!j){const D=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return a.jsx("form",{onSubmit:async z=>{z.preventDefault(),await n()},id:"esi-form",children:a.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[a.jsx(km,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),a.jsx("p",{className:"text-sm text-blue-300",children:D})]})})}return a.jsxs("form",{onSubmit:f(k),id:"esi-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),a.jsxs("div",{className:"space-y-4",children:[a.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[a.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),a.jsx("span",{children:"Are you covered under ESI?"})]}),_&&a.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[a.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),a.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),a.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),a.jsx(de,{name:"document",control:h,render:({field:D})=>a.jsx(qe,{label:"Upload ESI Card",file:D.value,onFileChange:D.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?j?a.jsxs("form",{onSubmit:f(k),id:"esi-form",children:[a.jsx(Fn,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{className:"flex items-center",children:[a.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),a.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),_&&a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[a.jsxs("div",{className:"space-y-6",children:[a.jsx(Pn,{label:"ESI Number",id:"esiNumber",hasValue:!!N.esiNumber,isVerified:((M=s.esi.verifiedStatus)==null?void 0:M.esiNumber)===!0,onManualInput:S,registration:d("esiNumber"),error:(I=p.esiNumber)==null?void 0:I.message}),a.jsx(de,{name:"esiRegistrationDate",control:h,render:({field:D})=>{var z;return a.jsx($t,{label:"ESI Registration Date",id:"esiRegistrationDate",error:(z=p.esiRegistrationDate)==null?void 0:z.message,value:D.value,onChange:D.onChange,maxDate:new Date})}}),a.jsx(he,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:(O=p.esicBranch)==null?void 0:O.message})]}),a.jsx(de,{name:"document",control:h,render:({field:D})=>a.jsx(qe,{label:"Upload ESI Card",file:D.value,onFileChange:D.onChange,onOcrComplete:P,ocrSchema:E,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):a.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"esi-form",children:[a.jsx(Fn,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),a.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[a.jsx(km,{className:"h-5 w-5 text-blue-500 mr-3"}),a.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):a.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"esi-form",children:[a.jsx(Fn,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),a.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[a.jsx(km,{className:"h-5 w-5 text-blue-500 mr-3"}),a.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},Xae=Ke({isOptedIn:ns().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:ie().optional(),selectedChildIds:xs().of(ie().required()).optional(),gmcPolicyCopy:ot().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:ns().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:ie().optional().nullable(),nomineeName:ie().optional().nullable(),nomineeRelation:ie().optional().nullable(),wantsToAddDependents:ns().optional().nullable(),optOutReason:ie().optional().nullable(),alternateInsuranceProvider:ie().optional().nullable(),alternateInsuranceStartDate:ie().optional().nullable(),alternateInsuranceEndDate:ie().optional().nullable(),alternateInsuranceCoverage:ie().optional().nullable()}).defined(),eoe=()=>{const{onValidated:n}=dr(),{user:e}=tt(),{data:t,updateGmc:s}=rn(),r=Nt("(max-width: 767px)"),{control:i,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:h,getValues:f}=xt({resolver:Lt(Xae),defaultValues:t.gmc}),p=c("isOptedIn"),g=c("selectedSpouseId"),b=c("selectedChildIds")||[],v=C.useMemo(()=>t.family.find(S=>S.relation==="Spouse"),[t.family]),_=C.useMemo(()=>t.family.filter(S=>S.relation==="Child"),[t.family]),N=C.useMemo(()=>{const S=[];return v&&S.push(v),S.push(..._),S},[v,_]);C.useEffect(()=>{if(t.gmc.isOptedIn===!0){const S=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),P=v||_.length>0;S&&P&&(h("selectedSpouseId",(v==null?void 0:v.id)||"",{shouldDirty:!0}),h("selectedChildIds",_.map(E=>E.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,v,_,h,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),C.useEffect(()=>{d(t.gmc)},[t.gmc,d]),C.useEffect(()=>{let S;const P=c(E=>{clearTimeout(S),S=window.setTimeout(()=>{s(E)},500)});return()=>{P.unsubscribe(),clearTimeout(S)}},[c,s]);const j=async S=>{const P={...S};S.isOptedIn?(P.gmcPolicyCopy=null,P.declarationAccepted=!1):(P.selectedSpouseId="",P.selectedChildIds=[]),s(P),await n()},k=(S,P)=>{if(S.relation==="Spouse")h("selectedSpouseId",P?S.id:"",{shouldDirty:!0});else{const E=f("selectedChildIds")||[],M=P?[...E,S.id]:E.filter(I=>I!==S.id);h("selectedChildIds",M,{shouldDirty:!0})}};return r?a.jsxs("form",{onSubmit:o(j),id:"gmc-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),a.jsxs("div",{className:"space-y-4",children:[a.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),a.jsx(de,{name:"isOptedIn",control:i,render:({field:S})=>a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${S.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[a.jsx("input",{type:"radio",name:S.name,onBlur:S.onBlur,ref:S.ref,onChange:()=>S.onChange(!0),checked:S.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),a.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${S.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[a.jsx("input",{type:"radio",name:S.name,onBlur:S.onBlur,ref:S.ref,onChange:()=>S.onChange(!1),checked:S.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),p===!0&&a.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[a.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),N.map(S=>{const P=S.relation==="Spouse"?g===S.id:b.includes(S.id);return a.jsx(zt,{id:`dep-mob-${S.id}`,label:`${S.name} (${S.relation})`,checked:P,onChange:E=>k(S,E)},S.id)})]}),p===!1&&a.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[a.jsx(de,{name:"gmcPolicyCopy",control:i,render:({field:S,fieldState:P})=>{var E;return a.jsx(qe,{label:"Upload GMC Policy Copy",file:S.value,onFileChange:S.onChange,error:(E=P.error)==null?void 0:E.message,allowCapture:!0})}}),a.jsx(de,{name:"declarationAccepted",control:i,render:({field:S,fieldState:P})=>a.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[a.jsx("input",{type:"checkbox",checked:S.value??!1,onChange:S.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),a.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):a.jsxs("form",{onSubmit:o(j),id:"gmc-form",children:[a.jsx(Fn,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("div",{children:[a.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),a.jsx(de,{name:"isOptedIn",control:i,render:({field:S})=>a.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[a.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${S.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[a.jsx("input",{type:"radio",name:S.name,onBlur:S.onBlur,ref:S.ref,onChange:()=>S.onChange(!0),checked:S.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),a.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${S.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[a.jsx("input",{type:"radio",name:S.name,onBlur:S.onBlur,ref:S.ref,onChange:()=>S.onChange(!1),checked:S.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),a.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&a.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),p===!0&&a.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[a.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),a.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),a.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:N.length>0?N.map(S=>{const P=S.relation==="Spouse"?g===S.id:b.includes(S.id);return a.jsx(zt,{id:`dep-${S.id}`,label:`${S.name} (${S.relation})`,checked:P,onChange:E=>k(S,E)},S.id)}):a.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),p===!1&&a.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[a.jsx(de,{name:"gmcPolicyCopy",control:i,render:({field:S,fieldState:P})=>{var E;return a.jsx(qe,{label:"Upload GMC Policy Copy",file:S.value,onFileChange:S.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:(E=P.error)==null?void 0:E.message})}}),a.jsx(de,{name:"declarationAccepted",control:i,render:({field:S,fieldState:P})=>a.jsxs("div",{className:"space-y-1",children:[a.jsx(zt,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:S.value??!1,onChange:S.onChange}),P.error&&a.jsx("p",{className:"text-xs text-red-600",children:P.error.message})]})})]})]})]})},toe=()=>{const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),s=Vt(),{data:r,updateUniforms:i}=rn(),o=Nt("(max-width: 767px)"),[l,c]=C.useState(!0),[d,h]=C.useState(null),{gender:f}=r.personal,{organizationId:p,department:g,designation:b}=r.organization,{control:v,handleSubmit:_,reset:N,watch:j}=xt(),{fields:k,replace:S}=vs({control:v,name:"uniforms"});C.useEffect(()=>{(async()=>{c(!0);try{const[O,D,z]=await Promise.all([te.getAllSiteUniformDetails(),te.getMasterGentsUniforms(),te.getMasterLadiesUniforms()]);h({details:O,gents:D,ladies:z})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const P=C.useMemo(()=>{if(!d||!p||!g||!b)return[];const I=d.details[p];if(!I)return[];const O=I.departments.find(z=>z.department===g);if(!O)return[];const D=O.designations.find(z=>z.designation===b);return(D==null?void 0:D.items)||[]},[d,p,g,b]);C.useEffect(()=>{const I=P.map(O=>{const D=r.uniforms.find(H=>H.itemId===O.id),z=O.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:O.id,itemName:O.name,category:z,sizeId:(D==null?void 0:D.sizeId)||"",quantity:(D==null?void 0:D.quantity)||1}});S(I)},[P,r.uniforms,S]),C.useEffect(()=>{let I;const O=j(D=>{clearTimeout(I),I=window.setTimeout(()=>{const z=D,H=f==="Female"?[...(d==null?void 0:d.ladies.pants)||[],...(d==null?void 0:d.ladies.shirts)||[]]:[...(d==null?void 0:d.gents.pants)||[],...(d==null?void 0:d.gents.shirts)||[]],F=(z.uniforms||[]).filter(R=>R.sizeId&&R.quantity>0).map(R=>{const V=H.find(U=>U.id===R.sizeId);return{itemId:R.itemId,itemName:R.itemName,sizeId:R.sizeId,sizeLabel:(V==null?void 0:V.size)||"",fit:(V==null?void 0:V.fit)||"",quantity:R.quantity}});i(F)},500)});return()=>{O.unsubscribe(),clearTimeout(I)}},[j,i,f,d]);const E=async I=>{const O=f==="Female"?[...(d==null?void 0:d.ladies.pants)||[],...(d==null?void 0:d.ladies.shirts)||[]]:[...(d==null?void 0:d.gents.pants)||[],...(d==null?void 0:d.gents.shirts)||[]],D=I.uniforms.filter(z=>z.sizeId&&z.quantity>0).map(z=>{const H=O.find(F=>F.id===z.sizeId);return{itemId:z.itemId,itemName:z.itemName,sizeId:z.sizeId,sizeLabel:(H==null?void 0:H.size)||"",fit:(H==null?void 0:H.fit)||"",quantity:z.quantity}});i(D),await n()};if(l)return a.jsx("div",{className:"flex justify-center items-center h-64",children:a.jsx(Qe,{className:"h-8 w-8 animate-spin text-accent"})});if(P.length===0&&r.uniforms.length>0)return a.jsxs("form",{onSubmit:async I=>{I.preventDefault(),await n()},id:"uniform-form",children:[!o&&a.jsx(Fn,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),a.jsxs("div",{className:"space-y-4",children:[r.uniforms.map(I=>a.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:a.jsxs("div",{children:[a.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:I.itemName}),a.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",I.sizeLabel,", Fit: ",I.fit,", Quantity: ",I.quantity]})]})},I.itemId+I.sizeId)),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>s("/onboarding/uniforms?from=onboarding"),children:[a.jsx(Jn,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!f||P.length===0){const I=f?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",O=f&&P.length===0;return a.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"uniform-form",children:[!o&&a.jsx(Fn,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),a.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[a.jsx(Ag,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),a.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:I}),O&&a.jsxs("div",{className:"mt-6",children:[a.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),a.jsxs(Y,{type:"button",onClick:()=>s("/onboarding/uniforms?from=onboarding"),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const M=f==="Female"?d==null?void 0:d.ladies:d==null?void 0:d.gents;return o?a.jsxs("form",{onSubmit:_(E),id:"uniform-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),a.jsx("div",{className:"space-y-4",children:k.map((I,O)=>{const D=I.category==="Pants"?M==null?void 0:M.pants:M==null?void 0:M.shirts;return a.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[a.jsx("h4",{className:"font-semibold text-primary-text",children:I.itemName}),a.jsx(de,{name:`uniforms.${O}.sizeId`,control:v,render:({field:z})=>a.jsxs("select",{...z,className:"pro-select pro-select-arrow",children:[a.jsx("option",{value:"",children:"-- Select Size --"}),D==null?void 0:D.map(H=>a.jsxs("option",{value:H.id,children:["Size: ",H.size," - ",H.fit]},H.id))]})}),a.jsx(de,{name:`uniforms.${O}.quantity`,control:v,render:({field:z})=>a.jsx("input",{type:"number",min:"1",...z,className:"form-input"})})]},I.id)})})]}):a.jsxs("form",{onSubmit:_(E),id:"uniform-form",children:[a.jsx(Fn,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),a.jsx("div",{className:"space-y-6",children:k.map((I,O)=>{const D=I.category==="Pants"?M==null?void 0:M.pants:M==null?void 0:M.shirts;return a.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[a.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:I.itemName}),a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[a.jsx(de,{name:`uniforms.${O}.sizeId`,control:v,rules:{required:"Please select a size"},render:({field:z,fieldState:H})=>{var F;return a.jsxs(Te,{label:"Size & Fit",error:(F=H.error)==null?void 0:F.message,...z,children:[a.jsx("option",{value:"",children:"-- Select Size --"}),D==null?void 0:D.map(R=>a.jsxs("option",{value:R.id,children:["Size: ",R.size," - ",R.fit]},R.id))]})}}),a.jsx(de,{name:`uniforms.${O}.quantity`,control:v,rules:{required:!0,min:1},render:({field:z})=>a.jsx(he,{label:"Quantity",type:"number",min:"1",...z})})]})]},I.id)})})]})},ru=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",noe=()=>{const{onValidated:n,setToast:e}=dr(),{user:t}=tt(),s=Vt(),{data:r,updatePersonal:i,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:h,updateEsi:f,updateGmc:p}=rn(),g=Nt("(max-width: 767px)"),b=D=>{const z={};if(D.name){const H=D.name.split(" ");z.firstName=ru(H.shift()||""),z.lastName=ru(H.pop()||""),z.middleName=ru(H.join(" "))}if(D.dob)try{const H=new Date(D.dob);isNaN(H.getTime())||(z.dob=Ce(H,"yyyy-MM-dd"))}catch{}D.aadhaarNumber&&(z.idProofNumber=D.aadhaarNumber.replace(/\s/g,""),z.idProofType="Aadhaar"),i(z)},v=D=>{const z={};if(D.accountHolderName&&(z.accountHolderName=ru(D.accountHolderName)),D.accountNumber){const H=D.accountNumber.replace(/\D/g,"");z.accountNumber=H,z.confirmAccountNumber=H}D.ifscCode&&(z.ifscCode=D.ifscCode.toUpperCase().replace(/\s/g,"")),o(z)},_=D=>{const z={};D.uanNumber&&(z.uanNumber=D.uanNumber.replace(/\D/g,""),z.hasPreviousPf=!0),h(z)},N=D=>{const z={};D.esiNumber&&(z.esiNumber=D.esiNumber.replace(/\D/g,""),z.hasEsi=!0),f(z)},j=D=>z=>{const H={};if(z.name&&(H.name=ru(z.name)),z.dob)try{const F=new Date(z.dob);isNaN(F.getTime())||(H.dob=Ce(F,"yyyy-MM-dd"))}catch{}c(D,H)},k=D=>z=>{const H={};z.degree&&(H.degree=z.degree),z.institution&&(H.institution=z.institution),z.endYear&&(H.endYear=z.endYear.toString()),d(D,H)},S={type:De.OBJECT,properties:{name:{type:De.STRING},dob:{type:De.STRING},aadhaarNumber:{type:De.STRING}}},P={type:De.OBJECT,properties:{accountHolderName:{type:De.STRING},accountNumber:{type:De.STRING},ifscCode:{type:De.STRING}}},E={type:De.OBJECT,properties:{uanNumber:{type:De.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:De.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:De.STRING,description:"The 10 or 17-digit ESI number."}}},M={type:De.OBJECT,properties:{uanNumber:{type:De.STRING}}},I={type:De.OBJECT,properties:{esiNumber:{type:De.STRING}}},O={type:De.OBJECT,properties:{degree:{type:De.STRING},institution:{type:De.STRING},endYear:{type:De.STRING}}};return g?a.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"documents-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),a.jsxs("div",{className:"space-y-4",children:[a.jsx(qe,{label:"ID Proof (Front Side)",file:r.personal.idProofFront,onFileChange:D=>i({idProofFront:D}),onOcrComplete:b,ocrSchema:S,setToast:e,allowCapture:!0,docType:r.personal.idProofType||"Aadhaar"}),a.jsx(qe,{label:"ID Proof (Back Side)",file:r.personal.idProofBack,onFileChange:D=>i({idProofBack:D}),onOcrComplete:b,ocrSchema:S,setToast:e,allowCapture:!0,docType:r.personal.idProofType||"Aadhaar"}),a.jsx(qe,{label:"Profile Photo",file:r.personal.photo,onFileChange:D=>i({photo:D}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),a.jsx(qe,{label:"Bank Proof",file:r.bank.bankProof,onFileChange:D=>o({bankProof:D}),onOcrComplete:v,ocrSchema:P,setToast:e,allowCapture:!0,docType:"Bank"}),a.jsx(qe,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:r.uan.salarySlip,onFileChange:D=>h({salarySlip:D}),onOcrComplete:D=>{_(D),N(D)},ocrSchema:E,setToast:e,allowCapture:!0,docType:"Salary"}),r.uan.hasPreviousPf&&a.jsx(qe,{label:"UAN Document",file:r.uan.document,onFileChange:D=>h({document:D}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:"UAN"}),r.esi.hasEsi&&a.jsx(qe,{label:"ESI Document",file:r.esi.document,onFileChange:D=>f({document:D}),onOcrComplete:N,ocrSchema:I,setToast:e,allowCapture:!0}),r.gmc.isOptedIn===!1&&a.jsx(qe,{label:"GMC Policy Copy",file:r.gmc.gmcPolicyCopy,onFileChange:D=>p({gmcPolicyCopy:D}),allowCapture:!0}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[a.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),a.jsxs("div",{className:"space-y-4",children:[r.education.map(D=>a.jsx(qe,{label:`Certificate for ${D.degree||"Qualification"}`,file:D.document,onFileChange:z=>d(D.id,{document:z}),onOcrComplete:k(D.id),ocrSchema:O,setToast:e,allowCapture:!0},D.id)),a.jsxs(Y,{type:"button",onClick:()=>s("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),a.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[a.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),a.jsxs("div",{className:"space-y-4",children:[r.family.map(D=>a.jsx(qe,{label:`ID Proof for ${D.name||"Family Member"}`,file:D.idProof,onFileChange:z=>c(D.id,{idProof:z}),onOcrComplete:j(D.id),ocrSchema:S,setToast:e,allowCapture:!0,docType:"Aadhaar"},D.id)),r.family.length===0&&a.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),a.jsxs(Y,{type:"button",onClick:()=>s("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[a.jsx(ct,{className:"mr-2 h-4 w-4"}),a.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):a.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"documents-form",children:[a.jsx(Fn,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),a.jsxs("div",{className:"space-y-6",children:[a.jsx("section",{children:a.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[a.jsx(qe,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:r.personal.idProofFront,onFileChange:D=>i({idProofFront:D}),onOcrComplete:b,ocrSchema:S,setToast:e,docType:r.personal.idProofType||"Aadhaar"}),a.jsx(qe,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:r.personal.idProofBack,onFileChange:D=>i({idProofBack:D}),onOcrComplete:b,ocrSchema:S,setToast:e,docType:r.personal.idProofType||"Aadhaar"}),a.jsx(qe,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:r.bank.bankProof,onFileChange:D=>o({bankProof:D}),onOcrComplete:v,ocrSchema:P,setToast:e,docType:"Bank"}),a.jsx(qe,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:r.uan.salarySlip,onFileChange:D=>h({salarySlip:D}),onOcrComplete:D=>{_(D),N(D)},ocrSchema:E,setToast:e,docType:"Salary"})]})}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),a.jsxs("div",{className:"space-y-4",children:[r.education.map(D=>a.jsx(qe,{label:`Certificate for ${D.degree||"New Qualification"}`,file:D.document,onFileChange:z=>d(D.id,{document:z}),onOcrComplete:k(D.id),ocrSchema:O,setToast:e},D.id)),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>l(),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),a.jsxs("div",{className:"space-y-4",children:[r.family.map(D=>a.jsx(qe,{label:`ID Proof for ${D.name||`(${D.relation})`}`,file:D.idProof,onFileChange:z=>c(D.id,{idProof:z}),onOcrComplete:j(D.id),ocrSchema:S,setToast:e,docType:"Aadhaar"},D.id)),r.family.length===0&&a.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),a.jsxs(Y,{type:"button",variant:"outline",onClick:()=>s("/onboarding/add/family"),children:[a.jsx(ct,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},soe=Ke({signatureImage:ot().required("A signature image is mandatory.").nullable(),fingerprints:Ke().shape({leftThumb:ot().optional().nullable(),leftIndex:ot().optional().nullable(),leftMiddle:ot().optional().nullable(),leftRing:ot().optional().nullable(),leftLittle:ot().optional().nullable(),rightThumb:ot().optional().nullable(),rightIndex:ot().optional().nullable(),rightMiddle:ot().optional().nullable(),rightRing:ot().optional().nullable(),rightLittle:ot().optional().nullable()})}).defined(),roe=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],ioe=()=>{const{onValidated:n}=dr(),{data:e,updateBiometrics:t}=rn(),{user:s}=tt(),r=Nt("(max-width: 767px)"),{control:i,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=xt({resolver:Lt(soe),defaultValues:e.biometrics});C.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),C.useEffect(()=>{const g=d(b=>{t(b)});return()=>g.unsubscribe()},[d,t]);const h=async(g,b)=>{try{const v=await te.verifyFingerprintImage(g,b);return v.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:v.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(v){return{success:!1,reason:v.message||"AI verification failed."}}},f=async g=>{t(g),await n()},p=g=>roe.filter(b=>b.hand===g).map(b=>a.jsx(de,{name:`fingerprints.${b.key}`,control:i,render:({field:v})=>a.jsx(qe,{label:`${g} ${b.name}`,file:v.value,onFileChange:v.onChange,onVerification:h,allowCapture:!0})},b.key));return a.jsxs("form",{onSubmit:o(f),id:"biometrics-form",children:[!r&&a.jsx(Fn,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("div",{children:[a.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${r?"form-header-title":"text-primary-text"}`,children:["Signature ",a.jsx("span",{className:"text-red-500",children:"*"})]}),a.jsx("div",{className:"w-full",children:a.jsx(de,{name:"signatureImage",control:i,render:({field:g,fieldState:b})=>{var v;return a.jsx(qe,{label:"Upload or capture a signature",file:g.value,onFileChange:g.onChange,allowCapture:!0,error:(v=b.error)==null?void 0:v.message})}})})]}),a.jsx("div",{className:r?"":"my-8 border-t border-border"}),a.jsxs("div",{children:[a.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${r?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),a.jsx("p",{className:`text-center mb-6 ${r?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),a.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[p("Left"),p("Right")]})]})]})]})},Sa=({label:n,value:e})=>a.jsxs("div",{children:[a.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),a.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Na=({label:n,value:e,status:t,isVerifying:s})=>a.jsxs("div",{children:[a.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,s&&a.jsx(Qe,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!s&&t===!0&&a.jsx("span",{title:"Verified from document",className:"ml-2",children:a.jsx(Kr,{className:"h-4 w-4 text-green-500"})}),!s&&t===!1&&a.jsx("span",{title:"Verification Failed",className:"ml-2",children:a.jsx(qw,{className:"h-4 w-4 text-red-500"})})]}),a.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),xr=({label:n,value:e})=>a.jsxs("div",{className:"flex justify-between items-start py-2",children:[a.jsx("span",{className:"text-sm text-gray-400",children:n}),a.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),aoe=()=>{var P,E,M,I,O,D,z,H;const{onSubmit:n,isSubmitting:e}=dr(),{user:t}=tt(),{data:s,logVerificationUsage:r,setPersonalVerifiedStatus:i,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=rn(),{perfiosApi:c}=ir(),d=Vt(),[h,f]=C.useState(window.innerWidth<768);C.useEffect(()=>{const F=()=>f(window.innerWidth<768);return window.addEventListener("resize",F),()=>window.removeEventListener("resize",F)},[]);const p=(t==null?void 0:t.role)==="field_officer"&&h,[g,b]=C.useState("idle"),[v,_]=C.useState(""),N=C.useMemo(()=>Object.entries(s.biometrics.fingerprints).filter(([,F])=>F!==null).map(([F])=>F.replace(/([A-Z])/g," $1").replace(/^./,R=>R.toUpperCase())),[s.biometrics.fingerprints]),j=async()=>{b("verifying"),_("");let F=!0;const R=[];try{r("Bank AC Verification Advanced");const V=await te.verifyBankAccountWithPerfios({name:s.bank.accountHolderName,dob:s.personal.dob,aadhaar:s.personal.idProofNumber||null,pan:null,bank:{accountNumber:s.bank.accountNumber,ifsc:s.bank.ifscCode},uan:s.uan.uanNumber||null,esi:s.esi.esiNumber||null});if(R.push(`Bank: ${V.message}`),o({accountNumber:V.verifiedFields.accountNumber,accountHolderName:V.verifiedFields.accountHolderName}),V.success||(F=!1),s.personal.idProofType==="Aadhaar"&&s.personal.idProofNumber){r("Aadhaar Verification");const U=await te.verifyAadhaar(s.personal.idProofNumber);R.push(`Aadhaar: ${U.message}`),i({idProofNumber:U.success}),U.success||(F=!1)}if(s.uan.hasPreviousPf&&s.uan.uanNumber){r("EPF UAN Lookup");const U=await te.lookupUan(s.uan.uanNumber);R.push(`UAN: ${U.message}`),l({uanNumber:U.verifiedFields.uan}),U.success||(F=!1)}await te.updateOnboarding(rn.getState().data),_(R.join(`
`)),b(F?"success":"failed")}catch(V){b("failed"),_(V.message||"An unexpected error occurred during verification.")}},k=()=>{d(`/onboarding/pdf/${s.id||"draft"}`)},S=(g==="success"||!c.enabled)&&s.formsGenerated;return p?a.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"review-form",children:[a.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),a.jsxs("div",{className:"space-y-6",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),a.jsxs("div",{className:"divide-y divide-border",children:[a.jsx(xr,{label:"Full Name",value:`${s.personal.firstName} ${s.personal.lastName}`}),a.jsx(xr,{label:"Email",value:s.personal.email}),a.jsx(xr,{label:"Mobile",value:s.personal.mobile}),a.jsx(xr,{label:"Date of Birth",value:s.personal.dob})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),a.jsxs("div",{className:"divide-y divide-border",children:[a.jsx(xr,{label:"Site",value:s.organization.organizationName}),a.jsx(xr,{label:"Designation",value:s.organization.designation}),a.jsx(xr,{label:"Department",value:s.organization.department})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),a.jsxs("div",{className:"divide-y divide-border",children:[a.jsx(xr,{label:"Account Holder",value:s.bank.accountHolderName}),a.jsx(xr,{label:"Account Number",value:"*".repeat(Math.max(0,s.bank.accountNumber.length-4))+s.bank.accountNumber.slice(-4)}),a.jsx(xr,{label:"IFSC Code",value:s.bank.ifscCode})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),a.jsxs("div",{className:"divide-y divide-border",children:[a.jsx(xr,{label:"Uniform Required",value:s.uniforms.length>0?"Yes":"No"}),s.uniforms.map(F=>a.jsx(xr,{label:F.itemName,value:`${F.quantity} x Size ${F.sizeLabel} (${F.fit})`},F.itemId))]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),s.biometrics.signatureImage&&a.jsxs("div",{className:"mb-4",children:[a.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),a.jsx("img",{src:s.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),N.length>0&&a.jsxs("div",{children:[a.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),a.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:N.map(F=>a.jsx("li",{children:F},F))})]})]})]})]}):a.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"review-form",children:[a.jsx(Fn,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),a.jsxs("div",{className:"space-y-8",children:[a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),a.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[a.jsx(Na,{label:"Full Name",value:`${s.personal.firstName} ${s.personal.lastName}`,status:(P=s.personal.verifiedStatus)==null?void 0:P.name,isVerifying:!1}),a.jsx(Sa,{label:"Email",value:s.personal.email}),a.jsx(Sa,{label:"Mobile",value:s.personal.mobile}),a.jsx(Na,{label:"Date of Birth",value:s.personal.dob,status:(E=s.personal.verifiedStatus)==null?void 0:E.dob,isVerifying:!1}),a.jsx(Sa,{label:"Gender",value:s.personal.gender}),a.jsx(Na,{label:"Aadhaar Number",value:s.personal.idProofNumber,status:(M=s.personal.verifiedStatus)==null?void 0:M.idProofNumber,isVerifying:g==="verifying"})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),a.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[a.jsx(Sa,{label:"Site / Client",value:s.organization.organizationName}),a.jsx(Sa,{label:"Designation",value:s.organization.designation}),a.jsx(Sa,{label:"Department",value:s.organization.department}),a.jsx(Sa,{label:"Joining Date",value:s.organization.joiningDate})]})]}),a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),a.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[a.jsx(Na,{label:"Account Holder",value:s.bank.accountHolderName,status:(I=s.bank.verifiedStatus)==null?void 0:I.accountHolderName,isVerifying:g==="verifying"}),a.jsx(Na,{label:"Account Number",value:"*".repeat(Math.max(0,s.bank.accountNumber.length-4))+s.bank.accountNumber.slice(-4),status:(O=s.bank.verifiedStatus)==null?void 0:O.accountNumber,isVerifying:g==="verifying"}),a.jsx(Na,{label:"IFSC Code",value:s.bank.ifscCode,status:(D=s.bank.verifiedStatus)==null?void 0:D.ifscCode,isVerifying:g==="verifying"}),a.jsx(Sa,{label:"Bank Name",value:s.bank.bankName}),s.uan.hasPreviousPf&&a.jsx(Na,{label:"UAN",value:s.uan.uanNumber,status:(z=s.uan.verifiedStatus)==null?void 0:z.uanNumber,isVerifying:g==="verifying"}),s.esi.hasEsi&&a.jsx(Na,{label:"ESI Number",value:s.esi.esiNumber,status:(H=s.esi.verifiedStatus)==null?void 0:H.esiNumber,isVerifying:g==="verifying"})]})]}),s.uniforms.length>0&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),a.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:s.uniforms.map(F=>a.jsxs("div",{className:"bg-page p-3 rounded-md",children:[a.jsx("p",{className:"font-semibold text-sm",children:F.itemName}),a.jsxs("p",{className:"text-xs text-muted",children:["Size: ",F.sizeLabel," (",F.fit,")"]}),a.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",F.quantity]})]},F.itemId))})]}),s.biometrics.signatureImage&&a.jsxs("section",{children:[a.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),a.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:a.jsx("img",{src:s.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),N.length>0&&a.jsxs("div",{children:[a.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),a.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:N.map(F=>a.jsx("li",{children:F},F))})]})]})]})]}),c.enabled&&a.jsxs("div",{className:"mt-8 pt-6 border-t",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),a.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),a.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),g==="failed"&&a.jsx("p",{className:"text-sm text-red-600 mt-2",children:v}),g==="success"&&a.jsx("p",{className:"text-sm text-green-600 mt-2",children:v})]}),a.jsxs(Y,{onClick:j,isLoading:g==="verifying",disabled:g==="success",children:[g==="idle"&&a.jsxs(a.Fragment,{children:[a.jsx(Dh,{className:"mr-2 h-4 w-4"})," Verify Details"]}),g==="verifying"&&"Verifying...",g==="failed"&&"Retry Verification",g==="success"&&a.jsxs(a.Fragment,{children:[a.jsx(Kr,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),a.jsxs("div",{className:"mt-8 pt-6 border-t",children:[a.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),a.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[a.jsxs("div",{className:"flex-1",children:[a.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),a.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),s.formsGenerated?a.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[a.jsx(Kr,{className:"h-5 w-5"}),a.jsx("span",{children:"Forms Generated & Confirmed"})]}):a.jsxs(Y,{onClick:k,children:[a.jsx(Bs,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),a.jsx("div",{className:"mt-8 pt-6 border-t",children:a.jsxs("div",{className:"flex items-start",children:[a.jsx("div",{className:"flex items-center h-5",children:a.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!S})}),a.jsxs("div",{className:"ml-3 text-sm",children:[a.jsx("label",{htmlFor:"confirmation",className:`font-medium ${S?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),a.jsx("p",{className:`${S?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},nn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:s}=tt(),{permissions:r}=pa();return s?t?(r[t.role]||[]).includes(n)?e?a.jsx(a.Fragment,{children:e}):a.jsx(th,{}):a.jsx(Ki,{to:"/forbidden",replace:!0}):a.jsx(Ki,{to:"/auth/login",replace:!0}):null},ooe=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:s=!1})=>{const[r,i]=C.useState(!1),[o,l]=C.useState(t),c=C.useRef(null),d=C.useRef(null),h=C.useRef(null),f=["mousemove","keydown","mousedown","scroll","touchstart"],p=C.useCallback(()=>{s||(i(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current),c.current=window.setTimeout(()=>{i(!0)},e))},[e,t,s]);return C.useEffect(()=>{if(!s)return r&&(d.current=window.setTimeout(n,t),h.current=window.setInterval(()=>{l(g=>Math.max(0,g-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[r,n,t,s]),C.useEffect(()=>{if(s)return;const g=()=>p();return f.forEach(b=>{window.addEventListener(b,g)}),p(),()=>{f.forEach(b=>{window.removeEventListener(b,g)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[p,s]),{isIdle:r,countdown:o,reset:p}},loe=5*60*1e3,coe=60*1e3,doe=()=>{const{logout:n}=tt(),e=Vt(),t=()=>{n(),e("/auth/login",{replace:!0})},s=Nt("(max-width: 768px)"),{isIdle:r,countdown:i,reset:o}=ooe({onIdle:t,idleTimeout:loe,promptTimeout:coe,disabled:s});return r?a.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:a.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[a.jsx(Xw,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),a.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),a.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),a.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(i/1e3)}),a.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),a.jsx("div",{className:"flex justify-center gap-4",children:a.jsx(Y,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},uoe=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=Eh(),s=Nt("(max-width: 767px)");return C.useEffect(()=>{const r=document.body;let i="light";e?i=s?"dark":"light":i=n,t(i),i==="dark"?r.classList.add("pro-dark-theme"):r.classList.remove("pro-dark-theme")},[n,e,s,t]),null},Fm="app:lastPath",hoe=["/auth","/splash","/pending-approval","/forbidden"],p0=n=>!hoe.some(e=>n.startsWith(e)),foe=()=>{const{user:n,isInitialized:e}=tt(),t=Ns();return e?n?n.role==="unverified"?a.jsx(Ki,{to:"/pending-approval",replace:!0}):a.jsx(HZ,{}):(p0(t.pathname+t.search)&&localStorage.setItem(Fm,t.pathname+t.search),a.jsx(Ki,{to:"/auth/login",replace:!0})):null},moe=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:s,resetAttendance:r,setLoading:i}=tt(),{init:o}=bo(),{initRoles:l}=pa(),{initSettings:c}=ir(),d=Vt(),h=Ns();return C.useEffect(()=>{n&&p0(h.pathname+h.search)&&localStorage.setItem(Fm,h.pathname+h.search)},[n,h.pathname,h.search]),C.useEffect(()=>{let f=!0;const p=setTimeout(()=>{f&&(console.warn("App initialization is taking too long. Proceeding without a session."),i(!1),s(!0))},3e4);(async()=>{i(!0);try{let{data:{session:v},error:_}=await fe.auth.getSession();if(_&&console.error("Error fetching initial session:",_.message),!v){const N=localStorage.getItem("supabase.auth.rememberMe");if(N){console.log("Attempting to restore session from long-term token...");try{const{data:j,error:k}=await fe.auth.setSession({refresh_token:N});k?(console.error("Failed to restore session from long-term token:",k.message),localStorage.removeItem("supabase.auth.rememberMe")):v=j.session}catch(j){console.error("Exception while restoring session from long-term token:",j)}}}if(v)try{const N=await mi.getAppUserProfile(v.user);f&&t(N)}catch(N){console.error("Failed to fetch user profile during initialization:",N),f&&(t(null),r())}else f&&(t(null),r())}catch(v){console.error("Error during app initialization:",v),f&&(t(null),r())}finally{clearTimeout(p),f&&(i(!1),s(!0))}})();const{data:{subscription:b}}=fe.auth.onAuthStateChange((v,_)=>{if(v==="PASSWORD_RECOVERY"){d("/auth/update-password",{replace:!0});return}_!=null&&_.user?setTimeout(async()=>{try{const N=await mi.getAppUserProfile(_.user);if(f&&(t(N),N))try{const j=`greetingSent_${N.id}`;localStorage.getItem(j)||(await te.createNotification({userId:N.id,message:`Good morning, ${N.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(j,"1"))}catch(j){console.error("Failed to send login greeting notification",j)}}catch(N){console.error("Failed to fetch user profile after auth change:",N),f&&(t(null),r(),rn.getState().reset())}},0):f&&(t(null),r(),rn.getState().reset())});return()=>{f=!1,b==null||b.unsubscribe(),clearTimeout(p)}},[t,s,r,i]),C.useEffect(()=>{n&&e&&((async()=>{try{const{settings:p,roles:g,holidays:b}=await te.getInitialAppData(),v=await te.getRecurringHolidays();p.enrollmentRules&&o(p.enrollmentRules),g&&l(g),p.attendanceSettings&&b&&c({holidays:b,attendanceSettings:p.attendanceSettings,recurringHolidays:v||[]})}catch(p){console.error("Failed to load initial application data:",p)}})(),tt.getState().checkAttendanceStatus())},[n,e,o,l,c]),C.useEffect(()=>{if(e&&n&&(h.pathname.startsWith("/auth")||h.pathname==="/"||h.pathname==="/splash")){const f=localStorage.getItem(Fm);f&&p0(f)?(localStorage.removeItem(Fm),d(f,{replace:!0})):d("/profile",{replace:!0})}},[e,n,h.pathname,d]),e?a.jsxs(a.Fragment,{children:[a.jsx(uoe,{}),n&&a.jsx(doe,{}),a.jsxs(EF,{children:[a.jsxs(Ae,{path:"/auth",element:a.jsx(GZ,{}),children:[a.jsx(Ae,{index:!0,element:a.jsx(Ki,{to:"login",replace:!0})}),a.jsx(Ae,{path:"login",element:a.jsx(gJ,{})}),a.jsx(Ae,{path:"signup",element:a.jsx(xJ,{})}),a.jsx(Ae,{path:"forgot-password",element:a.jsx(bJ,{})}),a.jsx(Ae,{path:"update-password",element:a.jsx(SJ,{})})]}),a.jsx(Ae,{path:"/pending-approval",element:n&&n.role==="unverified"?a.jsx(NJ,{}):a.jsx(Ki,{to:"/auth/login",replace:!0})}),a.jsx(Ae,{path:"/forbidden",element:a.jsx(jJ,{})}),a.jsxs(Ae,{path:"/",element:a.jsx(KZ,{children:a.jsx(foe,{})}),children:[a.jsx(Ae,{index:!0,element:a.jsx(Ki,{to:"/profile",replace:!0})}),a.jsx(Ae,{path:"profile",element:a.jsx(GX,{})}),a.jsxs(Ae,{element:a.jsx(nn,{requiredPermission:"create_enrollment"}),children:[a.jsx(Ae,{path:"onboarding",element:a.jsx(CJ,{})}),a.jsx(Ae,{path:"onboarding/select-organization",element:a.jsx(kJ,{})}),a.jsx(Ae,{path:"onboarding/pre-upload",element:a.jsx(gae,{})}),a.jsx(Ae,{path:"onboarding/submissions",element:a.jsx(vae,{})}),a.jsx(Ae,{path:"onboarding/tasks",element:a.jsx(wae,{})}),a.jsx(Ae,{path:"onboarding/uniforms",element:a.jsx(Nae,{})}),a.jsxs(Ae,{path:"onboarding/add",element:a.jsx(TJ,{}),children:[a.jsx(Ae,{path:"personal",element:a.jsx($ae,{})}),a.jsx(Ae,{path:"address",element:a.jsx(Uae,{})}),a.jsx(Ae,{path:"organization",element:a.jsx(Bae,{})}),a.jsx(Ae,{path:"family",element:a.jsx(qae,{})}),a.jsx(Ae,{path:"education",element:a.jsx(Hae,{})}),a.jsx(Ae,{path:"bank",element:a.jsx(Yae,{})}),a.jsx(Ae,{path:"uan",element:a.jsx(Kae,{})}),a.jsx(Ae,{path:"esi",element:a.jsx(Qae,{})}),a.jsx(Ae,{path:"gmc",element:a.jsx(eoe,{})}),a.jsx(Ae,{path:"uniform",element:a.jsx(toe,{})}),a.jsx(Ae,{path:"documents",element:a.jsx(noe,{})}),a.jsx(Ae,{path:"biometrics",element:a.jsx(ioe,{})}),a.jsx(Ae,{path:"review",element:a.jsx(aoe,{})})]}),a.jsx(Ae,{path:"onboarding/pdf/:id",element:a.jsx(Jie,{})})]}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_all_submissions"}),children:a.jsx(Ae,{path:"verification/dashboard",element:a.jsx(DJ,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_users"}),children:a.jsx(Ae,{path:"admin/users",element:a.jsx(LJ,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_sites"}),children:a.jsx(Ae,{path:"admin/sites",element:a.jsx(AX,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_roles_and_permissions"}),children:a.jsx(Ae,{path:"admin/roles",element:a.jsx(OX,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_modules"}),children:a.jsx(Ae,{path:"admin/modules",element:a.jsx($X,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_approval_workflow"}),children:a.jsx(Ae,{path:"admin/approval-workflow",element:a.jsx(Yre,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_developer_settings"}),children:a.jsx(Ae,{path:"developer/api",element:a.jsx(UX,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_operations_dashboard"}),children:a.jsx(Ae,{path:"operations/dashboard",element:a.jsx(BX,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_site_dashboard"}),children:a.jsx(Ae,{path:"site/dashboard",element:a.jsx(HX,{})})}),a.jsxs(Ae,{element:a.jsx(nn,{requiredPermission:"view_own_attendance"}),children:[a.jsx(Ae,{path:"attendance/dashboard",element:a.jsx(Dre,{})}),a.jsx(Ae,{path:"attendance/locations",element:a.jsx(Are,{})})]}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"apply_for_leave"}),children:a.jsx(Ae,{path:"leaves/dashboard",element:a.jsx(Ure,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_attendance_rules"}),children:a.jsx(Ae,{path:"hr/attendance-settings",element:a.jsx(Ire,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_leave_requests"}),children:a.jsx(Ae,{path:"hr/leave-management",element:a.jsx(Gre,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_entity_management"}),children:a.jsx(Ae,{path:"hr/entities",element:a.jsx(Bie,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_policies"}),children:a.jsx(Ae,{path:"hr/policies-and-insurance",element:a.jsx(Zie,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_enrollment_rules"}),children:a.jsx(Ae,{path:"hr/enrollment-rules",element:a.jsx(Kie,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_field_officer_tracking"}),children:a.jsx(Ae,{path:"hr/field-officer-tracking",element:a.jsx(uae,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_attendance_rules"}),children:a.jsx(Ae,{path:"hr/locations",element:a.jsx(hae,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_uniforms"}),children:a.jsx(Ae,{path:"uniforms",element:a.jsx(tae,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_verification_costing"}),children:a.jsx(Ae,{path:"billing/cost-analysis",element:a.jsx(rae,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"view_invoice_summary"}),children:a.jsx(Ae,{path:"billing/summary",element:a.jsx(oae,{})})}),a.jsx(Ae,{element:a.jsx(nn,{requiredPermission:"manage_tasks"}),children:a.jsx(Ae,{path:"tasks",element:a.jsx(eie,{})})}),a.jsxs(Ae,{element:a.jsx(nn,{requiredPermission:"access_support_desk"}),children:[a.jsx(Ae,{path:"support",element:a.jsx(Pae,{})}),a.jsx(Ae,{path:"support/ticket/:id",element:a.jsx(Lae,{})})]})]}),a.jsx(Ae,{path:"*",element:a.jsx(Ki,{to:"/",replace:!0})})]})]}):a.jsx(QZ,{})},XI=document.getElementById("root");if(!XI)throw new Error("Could not find root element to mount to");const poe=Jx.createRoot(XI);poe.render(a.jsx(Fe.StrictMode,{children:a.jsx(FF,{children:a.jsx(moe,{})})}));export{Aj as _,Jp as a,NT as c,g0 as g};
