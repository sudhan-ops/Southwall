function QL(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const a=Object.getOwnPropertyDescriptor(r,s);a&&Object.defineProperty(n,s,a.get?a:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const a of s)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const a={};return s.integrity&&(a.integrity=s.integrity),s.referrerPolicy&&(a.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?a.credentials="include":s.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(s){if(s.ep)return;s.ep=!0;const a=t(s);fetch(s.href,a)}})();var wfe=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function bu(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}function XL(n){if(Object.prototype.hasOwnProperty.call(n,"__esModule"))return n;var e=n.default;if(typeof e=="function"){var t=function r(){var s=!1;try{s=this instanceof r}catch{}return s?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var $v={exports:{}},yh={},Hv={exports:{}},Qt={};var tk;function Aq(){if(tk)return Qt;tk=1;var n=Symbol.for("react.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),o=Symbol.for("react.context"),l=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),h=Symbol.for("react.lazy"),p=Symbol.iterator;function x(H){return H===null||typeof H!="object"?null:(H=p&&H[p]||H["@@iterator"],typeof H=="function"?H:null)}var y={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function j(H,se,ie){this.props=H,this.context=se,this.refs=w,this.updater=ie||y}j.prototype.isReactComponent={},j.prototype.setState=function(H,se){if(typeof H!="object"&&typeof H!="function"&&H!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,H,se,"setState")},j.prototype.forceUpdate=function(H){this.updater.enqueueForceUpdate(this,H,"forceUpdate")};function C(){}C.prototype=j.prototype;function P(H,se,ie){this.props=H,this.context=se,this.refs=w,this.updater=ie||y}var O=P.prototype=new C;O.constructor=P,_(O,j.prototype),O.isPureReactComponent=!0;var M=Array.isArray,D=Object.prototype.hasOwnProperty,I={current:null},F={key:!0,ref:!0,__self:!0,__source:!0};function q(H,se,ie){var ce,oe={},de=null,te=null;if(se!=null)for(ce in se.ref!==void 0&&(te=se.ref),se.key!==void 0&&(de=""+se.key),se)D.call(se,ce)&&!F.hasOwnProperty(ce)&&(oe[ce]=se[ce]);var ye=arguments.length-2;if(ye===1)oe.children=ie;else if(1<ye){for(var Ce=Array(ye),Re=0;Re<ye;Re++)Ce[Re]=arguments[Re+2];oe.children=Ce}if(H&&H.defaultProps)for(ce in ye=H.defaultProps,ye)oe[ce]===void 0&&(oe[ce]=ye[ce]);return{$$typeof:n,type:H,key:de,ref:te,props:oe,_owner:I.current}}function B(H,se){return{$$typeof:n,type:H.type,key:se,ref:H.ref,props:H.props,_owner:H._owner}}function U(H){return typeof H=="object"&&H!==null&&H.$$typeof===n}function W(H){var se={"=":"=0",":":"=2"};return"$"+H.replace(/[=:]/g,function(ie){return se[ie]})}var G=/\/+/g;function Z(H,se){return typeof H=="object"&&H!==null&&H.key!=null?W(""+H.key):se.toString(36)}function Y(H,se,ie,ce,oe){var de=typeof H;(de==="undefined"||de==="boolean")&&(H=null);var te=!1;if(H===null)te=!0;else switch(de){case"string":case"number":te=!0;break;case"object":switch(H.$$typeof){case n:case e:te=!0}}if(te)return te=H,oe=oe(te),H=ce===""?"."+Z(te,0):ce,M(oe)?(ie="",H!=null&&(ie=H.replace(G,"$&/")+"/"),Y(oe,se,ie,"",function(Re){return Re})):oe!=null&&(U(oe)&&(oe=B(oe,ie+(!oe.key||te&&te.key===oe.key?"":(""+oe.key).replace(G,"$&/")+"/")+H)),se.push(oe)),1;if(te=0,ce=ce===""?".":ce+":",M(H))for(var ye=0;ye<H.length;ye++){de=H[ye];var Ce=ce+Z(de,ye);te+=Y(de,se,ie,Ce,oe)}else if(Ce=x(H),typeof Ce=="function")for(H=Ce.call(H),ye=0;!(de=H.next()).done;)de=de.value,Ce=ce+Z(de,ye++),te+=Y(de,se,ie,Ce,oe);else if(de==="object")throw se=String(H),Error("Objects are not valid as a React child (found: "+(se==="[object Object]"?"object with keys {"+Object.keys(H).join(", ")+"}":se)+"). If you meant to render a collection of children, use an array instead.");return te}function ae(H,se,ie){if(H==null)return H;var ce=[],oe=0;return Y(H,ce,"","",function(de){return se.call(ie,de,oe++)}),ce}function ee(H){if(H._status===-1){var se=H._result;se=se(),se.then(function(ie){(H._status===0||H._status===-1)&&(H._status=1,H._result=ie)},function(ie){(H._status===0||H._status===-1)&&(H._status=2,H._result=ie)}),H._status===-1&&(H._status=0,H._result=se)}if(H._status===1)return H._result.default;throw H._result}var me={current:null},$={transition:null},K={ReactCurrentDispatcher:me,ReactCurrentBatchConfig:$,ReactCurrentOwner:I};function re(){throw Error("act(...) is not supported in production builds of React.")}return Qt.Children={map:ae,forEach:function(H,se,ie){ae(H,function(){se.apply(this,arguments)},ie)},count:function(H){var se=0;return ae(H,function(){se++}),se},toArray:function(H){return ae(H,function(se){return se})||[]},only:function(H){if(!U(H))throw Error("React.Children.only expected to receive a single React element child.");return H}},Qt.Component=j,Qt.Fragment=t,Qt.Profiler=s,Qt.PureComponent=P,Qt.StrictMode=r,Qt.Suspense=c,Qt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=K,Qt.act=re,Qt.cloneElement=function(H,se,ie){if(H==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+H+".");var ce=_({},H.props),oe=H.key,de=H.ref,te=H._owner;if(se!=null){if(se.ref!==void 0&&(de=se.ref,te=I.current),se.key!==void 0&&(oe=""+se.key),H.type&&H.type.defaultProps)var ye=H.type.defaultProps;for(Ce in se)D.call(se,Ce)&&!F.hasOwnProperty(Ce)&&(ce[Ce]=se[Ce]===void 0&&ye!==void 0?ye[Ce]:se[Ce])}var Ce=arguments.length-2;if(Ce===1)ce.children=ie;else if(1<Ce){ye=Array(Ce);for(var Re=0;Re<Ce;Re++)ye[Re]=arguments[Re+2];ce.children=ye}return{$$typeof:n,type:H.type,key:oe,ref:de,props:ce,_owner:te}},Qt.createContext=function(H){return H={$$typeof:o,_currentValue:H,_currentValue2:H,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},H.Provider={$$typeof:a,_context:H},H.Consumer=H},Qt.createElement=q,Qt.createFactory=function(H){var se=q.bind(null,H);return se.type=H,se},Qt.createRef=function(){return{current:null}},Qt.forwardRef=function(H){return{$$typeof:l,render:H}},Qt.isValidElement=U,Qt.lazy=function(H){return{$$typeof:h,_payload:{_status:-1,_result:H},_init:ee}},Qt.memo=function(H,se){return{$$typeof:d,type:H,compare:se===void 0?null:se}},Qt.startTransition=function(H){var se=$.transition;$.transition={};try{H()}finally{$.transition=se}},Qt.unstable_act=re,Qt.useCallback=function(H,se){return me.current.useCallback(H,se)},Qt.useContext=function(H){return me.current.useContext(H)},Qt.useDebugValue=function(){},Qt.useDeferredValue=function(H){return me.current.useDeferredValue(H)},Qt.useEffect=function(H,se){return me.current.useEffect(H,se)},Qt.useId=function(){return me.current.useId()},Qt.useImperativeHandle=function(H,se,ie){return me.current.useImperativeHandle(H,se,ie)},Qt.useInsertionEffect=function(H,se){return me.current.useInsertionEffect(H,se)},Qt.useLayoutEffect=function(H,se){return me.current.useLayoutEffect(H,se)},Qt.useMemo=function(H,se){return me.current.useMemo(H,se)},Qt.useReducer=function(H,se,ie){return me.current.useReducer(H,se,ie)},Qt.useRef=function(H){return me.current.useRef(H)},Qt.useState=function(H){return me.current.useState(H)},Qt.useSyncExternalStore=function(H,se,ie){return me.current.useSyncExternalStore(H,se,ie)},Qt.useTransition=function(){return me.current.useTransition()},Qt.version="18.3.1",Qt}var nk;function Ks(){return nk||(nk=1,Hv.exports=Aq()),Hv.exports}var rk;function Rq(){if(rk)return yh;rk=1;var n=Ks(),e=Symbol.for("react.element"),t=Symbol.for("react.fragment"),r=Object.prototype.hasOwnProperty,s=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,a={key:!0,ref:!0,__self:!0,__source:!0};function o(l,c,d){var h,p={},x=null,y=null;d!==void 0&&(x=""+d),c.key!==void 0&&(x=""+c.key),c.ref!==void 0&&(y=c.ref);for(h in c)r.call(c,h)&&!a.hasOwnProperty(h)&&(p[h]=c[h]);if(l&&l.defaultProps)for(h in c=l.defaultProps,c)p[h]===void 0&&(p[h]=c[h]);return{$$typeof:e,type:l,key:x,ref:y,props:p,_owner:s.current}}return yh.Fragment=t,yh.jsx=o,yh.jsxs=o,yh}var sk;function e4(){return sk||(sk=1,$v.exports=Rq()),$v.exports}var i=e4(),E=Ks();const ot=bu(E),Lq=QL({__proto__:null,default:ot},[E]);var Ep={},Yv={exports:{}},Us={},Gv={exports:{}},Zv={};var ik;function Fq(){return ik||(ik=1,(function(n){function e($,K){var re=$.length;$.push(K);e:for(;0<re;){var H=re-1>>>1,se=$[H];if(0<s(se,K))$[H]=K,$[re]=se,re=H;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var K=$[0],re=$.pop();if(re!==K){$[0]=re;e:for(var H=0,se=$.length,ie=se>>>1;H<ie;){var ce=2*(H+1)-1,oe=$[ce],de=ce+1,te=$[de];if(0>s(oe,re))de<se&&0>s(te,oe)?($[H]=te,$[de]=re,H=de):($[H]=oe,$[ce]=re,H=ce);else if(de<se&&0>s(te,re))$[H]=te,$[de]=re,H=de;else break e}}return K}function s($,K){var re=$.sortIndex-K.sortIndex;return re!==0?re:$.id-K.id}if(typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var o=Date,l=o.now();n.unstable_now=function(){return o.now()-l}}var c=[],d=[],h=1,p=null,x=3,y=!1,_=!1,w=!1,j=typeof setTimeout=="function"?setTimeout:null,C=typeof clearTimeout=="function"?clearTimeout:null,P=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function O($){for(var K=t(d);K!==null;){if(K.callback===null)r(d);else if(K.startTime<=$)r(d),K.sortIndex=K.expirationTime,e(c,K);else break;K=t(d)}}function M($){if(w=!1,O($),!_)if(t(c)!==null)_=!0,ee(D);else{var K=t(d);K!==null&&me(M,K.startTime-$)}}function D($,K){_=!1,w&&(w=!1,C(q),q=-1),y=!0;var re=x;try{for(O(K),p=t(c);p!==null&&(!(p.expirationTime>K)||$&&!W());){var H=p.callback;if(typeof H=="function"){p.callback=null,x=p.priorityLevel;var se=H(p.expirationTime<=K);K=n.unstable_now(),typeof se=="function"?p.callback=se:p===t(c)&&r(c),O(K)}else r(c);p=t(c)}if(p!==null)var ie=!0;else{var ce=t(d);ce!==null&&me(M,ce.startTime-K),ie=!1}return ie}finally{p=null,x=re,y=!1}}var I=!1,F=null,q=-1,B=5,U=-1;function W(){return!(n.unstable_now()-U<B)}function G(){if(F!==null){var $=n.unstable_now();U=$;var K=!0;try{K=F(!0,$)}finally{K?Z():(I=!1,F=null)}}else I=!1}var Z;if(typeof P=="function")Z=function(){P(G)};else if(typeof MessageChannel<"u"){var Y=new MessageChannel,ae=Y.port2;Y.port1.onmessage=G,Z=function(){ae.postMessage(null)}}else Z=function(){j(G,0)};function ee($){F=$,I||(I=!0,Z())}function me($,K){q=j(function(){$(n.unstable_now())},K)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_continueExecution=function(){_||y||(_=!0,ee(D))},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):B=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return x},n.unstable_getFirstCallbackNode=function(){return t(c)},n.unstable_next=function($){switch(x){case 1:case 2:case 3:var K=3;break;default:K=x}var re=x;x=K;try{return $()}finally{x=re}},n.unstable_pauseExecution=function(){},n.unstable_requestPaint=function(){},n.unstable_runWithPriority=function($,K){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var re=x;x=$;try{return K()}finally{x=re}},n.unstable_scheduleCallback=function($,K,re){var H=n.unstable_now();switch(typeof re=="object"&&re!==null?(re=re.delay,re=typeof re=="number"&&0<re?H+re:H):re=H,$){case 1:var se=-1;break;case 2:se=250;break;case 5:se=1073741823;break;case 4:se=1e4;break;default:se=5e3}return se=re+se,$={id:h++,callback:K,priorityLevel:$,startTime:re,expirationTime:se,sortIndex:-1},re>H?($.sortIndex=re,e(d,$),t(c)===null&&$===t(d)&&(w?(C(q),q=-1):w=!0,me(M,re-H))):($.sortIndex=se,e(c,$),_||y||(_=!0,ee(D))),$},n.unstable_shouldYield=W,n.unstable_wrapCallback=function($){var K=x;return function(){var re=x;x=K;try{return $.apply(this,arguments)}finally{x=re}}}})(Zv)),Zv}var ak;function qq(){return ak||(ak=1,Gv.exports=Fq()),Gv.exports}var ok;function zq(){if(ok)return Us;ok=1;var n=Ks(),e=qq();function t(u){for(var m="https://reactjs.org/docs/error-decoder.html?invariant="+u,b=1;b<arguments.length;b++)m+="&args[]="+encodeURIComponent(arguments[b]);return"Minified React error #"+u+"; visit "+m+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var r=new Set,s={};function a(u,m){o(u,m),o(u+"Capture",m)}function o(u,m){for(s[u]=m,u=0;u<m.length;u++)r.add(m[u])}var l=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),c=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,h={},p={};function x(u){return c.call(p,u)?!0:c.call(h,u)?!1:d.test(u)?p[u]=!0:(h[u]=!0,!1)}function y(u,m,b,k){if(b!==null&&b.type===0)return!1;switch(typeof m){case"function":case"symbol":return!0;case"boolean":return k?!1:b!==null?!b.acceptsBooleans:(u=u.toLowerCase().slice(0,5),u!=="data-"&&u!=="aria-");default:return!1}}function _(u,m,b,k){if(m===null||typeof m>"u"||y(u,m,b,k))return!0;if(k)return!1;if(b!==null)switch(b.type){case 3:return!m;case 4:return m===!1;case 5:return isNaN(m);case 6:return isNaN(m)||1>m}return!1}function w(u,m,b,k,R,z,J){this.acceptsBooleans=m===2||m===3||m===4,this.attributeName=k,this.attributeNamespace=R,this.mustUseProperty=b,this.propertyName=u,this.type=m,this.sanitizeURL=z,this.removeEmptyString=J}var j={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(u){j[u]=new w(u,0,!1,u,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(u){var m=u[0];j[m]=new w(m,1,!1,u[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(u){j[u]=new w(u,2,!1,u.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(u){j[u]=new w(u,2,!1,u,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(u){j[u]=new w(u,3,!1,u.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(u){j[u]=new w(u,3,!0,u,null,!1,!1)}),["capture","download"].forEach(function(u){j[u]=new w(u,4,!1,u,null,!1,!1)}),["cols","rows","size","span"].forEach(function(u){j[u]=new w(u,6,!1,u,null,!1,!1)}),["rowSpan","start"].forEach(function(u){j[u]=new w(u,5,!1,u.toLowerCase(),null,!1,!1)});var C=/[\-:]([a-z])/g;function P(u){return u[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(u){var m=u.replace(C,P);j[m]=new w(m,1,!1,u,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(u){var m=u.replace(C,P);j[m]=new w(m,1,!1,u,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(u){var m=u.replace(C,P);j[m]=new w(m,1,!1,u,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!1,!1)}),j.xlinkHref=new w("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(u){j[u]=new w(u,1,!1,u.toLowerCase(),null,!0,!0)});function O(u,m,b,k){var R=j.hasOwnProperty(m)?j[m]:null;(R!==null?R.type!==0:k||!(2<m.length)||m[0]!=="o"&&m[0]!=="O"||m[1]!=="n"&&m[1]!=="N")&&(_(m,b,R,k)&&(b=null),k||R===null?x(m)&&(b===null?u.removeAttribute(m):u.setAttribute(m,""+b)):R.mustUseProperty?u[R.propertyName]=b===null?R.type===3?!1:"":b:(m=R.attributeName,k=R.attributeNamespace,b===null?u.removeAttribute(m):(R=R.type,b=R===3||R===4&&b===!0?"":""+b,k?u.setAttributeNS(k,m,b):u.setAttribute(m,b))))}var M=n.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,D=Symbol.for("react.element"),I=Symbol.for("react.portal"),F=Symbol.for("react.fragment"),q=Symbol.for("react.strict_mode"),B=Symbol.for("react.profiler"),U=Symbol.for("react.provider"),W=Symbol.for("react.context"),G=Symbol.for("react.forward_ref"),Z=Symbol.for("react.suspense"),Y=Symbol.for("react.suspense_list"),ae=Symbol.for("react.memo"),ee=Symbol.for("react.lazy"),me=Symbol.for("react.offscreen"),$=Symbol.iterator;function K(u){return u===null||typeof u!="object"?null:(u=$&&u[$]||u["@@iterator"],typeof u=="function"?u:null)}var re=Object.assign,H;function se(u){if(H===void 0)try{throw Error()}catch(b){var m=b.stack.trim().match(/\n( *(at )?)/);H=m&&m[1]||""}return`
`+H+u}var ie=!1;function ce(u,m){if(!u||ie)return"";ie=!0;var b=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(m)if(m=function(){throw Error()},Object.defineProperty(m.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(m,[])}catch(De){var k=De}Reflect.construct(u,[],m)}else{try{m.call()}catch(De){k=De}u.call(m.prototype)}else{try{throw Error()}catch(De){k=De}u()}}catch(De){if(De&&k&&typeof De.stack=="string"){for(var R=De.stack.split(`
`),z=k.stack.split(`
`),J=R.length-1,fe=z.length-1;1<=J&&0<=fe&&R[J]!==z[fe];)fe--;for(;1<=J&&0<=fe;J--,fe--)if(R[J]!==z[fe]){if(J!==1||fe!==1)do if(J--,fe--,0>fe||R[J]!==z[fe]){var ge=`
`+R[J].replace(" at new "," at ");return u.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",u.displayName)),ge}while(1<=J&&0<=fe);break}}}finally{ie=!1,Error.prepareStackTrace=b}return(u=u?u.displayName||u.name:"")?se(u):""}function oe(u){switch(u.tag){case 5:return se(u.type);case 16:return se("Lazy");case 13:return se("Suspense");case 19:return se("SuspenseList");case 0:case 2:case 15:return u=ce(u.type,!1),u;case 11:return u=ce(u.type.render,!1),u;case 1:return u=ce(u.type,!0),u;default:return""}}function de(u){if(u==null)return null;if(typeof u=="function")return u.displayName||u.name||null;if(typeof u=="string")return u;switch(u){case F:return"Fragment";case I:return"Portal";case B:return"Profiler";case q:return"StrictMode";case Z:return"Suspense";case Y:return"SuspenseList"}if(typeof u=="object")switch(u.$$typeof){case W:return(u.displayName||"Context")+".Consumer";case U:return(u._context.displayName||"Context")+".Provider";case G:var m=u.render;return u=u.displayName,u||(u=m.displayName||m.name||"",u=u!==""?"ForwardRef("+u+")":"ForwardRef"),u;case ae:return m=u.displayName||null,m!==null?m:de(u.type)||"Memo";case ee:m=u._payload,u=u._init;try{return de(u(m))}catch{}}return null}function te(u){var m=u.type;switch(u.tag){case 24:return"Cache";case 9:return(m.displayName||"Context")+".Consumer";case 10:return(m._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return u=m.render,u=u.displayName||u.name||"",m.displayName||(u!==""?"ForwardRef("+u+")":"ForwardRef");case 7:return"Fragment";case 5:return m;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return de(m);case 8:return m===q?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof m=="function")return m.displayName||m.name||null;if(typeof m=="string")return m}return null}function ye(u){switch(typeof u){case"boolean":case"number":case"string":case"undefined":return u;case"object":return u;default:return""}}function Ce(u){var m=u.type;return(u=u.nodeName)&&u.toLowerCase()==="input"&&(m==="checkbox"||m==="radio")}function Re(u){var m=Ce(u)?"checked":"value",b=Object.getOwnPropertyDescriptor(u.constructor.prototype,m),k=""+u[m];if(!u.hasOwnProperty(m)&&typeof b<"u"&&typeof b.get=="function"&&typeof b.set=="function"){var R=b.get,z=b.set;return Object.defineProperty(u,m,{configurable:!0,get:function(){return R.call(this)},set:function(J){k=""+J,z.call(this,J)}}),Object.defineProperty(u,m,{enumerable:b.enumerable}),{getValue:function(){return k},setValue:function(J){k=""+J},stopTracking:function(){u._valueTracker=null,delete u[m]}}}}function Te(u){u._valueTracker||(u._valueTracker=Re(u))}function je(u){if(!u)return!1;var m=u._valueTracker;if(!m)return!0;var b=m.getValue(),k="";return u&&(k=Ce(u)?u.checked?"true":"false":u.value),u=k,u!==b?(m.setValue(u),!0):!1}function ke(u){if(u=u||(typeof document<"u"?document:void 0),typeof u>"u")return null;try{return u.activeElement||u.body}catch{return u.body}}function Ue(u,m){var b=m.checked;return re({},m,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:b??u._wrapperState.initialChecked})}function Ye(u,m){var b=m.defaultValue==null?"":m.defaultValue,k=m.checked!=null?m.checked:m.defaultChecked;b=ye(m.value!=null?m.value:b),u._wrapperState={initialChecked:k,initialValue:b,controlled:m.type==="checkbox"||m.type==="radio"?m.checked!=null:m.value!=null}}function ve(u,m){m=m.checked,m!=null&&O(u,"checked",m,!1)}function Oe(u,m){ve(u,m);var b=ye(m.value),k=m.type;if(b!=null)k==="number"?(b===0&&u.value===""||u.value!=b)&&(u.value=""+b):u.value!==""+b&&(u.value=""+b);else if(k==="submit"||k==="reset"){u.removeAttribute("value");return}m.hasOwnProperty("value")?qe(u,m.type,b):m.hasOwnProperty("defaultValue")&&qe(u,m.type,ye(m.defaultValue)),m.checked==null&&m.defaultChecked!=null&&(u.defaultChecked=!!m.defaultChecked)}function Ve(u,m,b){if(m.hasOwnProperty("value")||m.hasOwnProperty("defaultValue")){var k=m.type;if(!(k!=="submit"&&k!=="reset"||m.value!==void 0&&m.value!==null))return;m=""+u._wrapperState.initialValue,b||m===u.value||(u.value=m),u.defaultValue=m}b=u.name,b!==""&&(u.name=""),u.defaultChecked=!!u._wrapperState.initialChecked,b!==""&&(u.name=b)}function qe(u,m,b){(m!=="number"||ke(u.ownerDocument)!==u)&&(b==null?u.defaultValue=""+u._wrapperState.initialValue:u.defaultValue!==""+b&&(u.defaultValue=""+b))}var X=Array.isArray;function le(u,m,b,k){if(u=u.options,m){m={};for(var R=0;R<b.length;R++)m["$"+b[R]]=!0;for(b=0;b<u.length;b++)R=m.hasOwnProperty("$"+u[b].value),u[b].selected!==R&&(u[b].selected=R),R&&k&&(u[b].defaultSelected=!0)}else{for(b=""+ye(b),m=null,R=0;R<u.length;R++){if(u[R].value===b){u[R].selected=!0,k&&(u[R].defaultSelected=!0);return}m!==null||u[R].disabled||(m=u[R])}m!==null&&(m.selected=!0)}}function he(u,m){if(m.dangerouslySetInnerHTML!=null)throw Error(t(91));return re({},m,{value:void 0,defaultValue:void 0,children:""+u._wrapperState.initialValue})}function Le(u,m){var b=m.value;if(b==null){if(b=m.children,m=m.defaultValue,b!=null){if(m!=null)throw Error(t(92));if(X(b)){if(1<b.length)throw Error(t(93));b=b[0]}m=b}m==null&&(m=""),b=m}u._wrapperState={initialValue:ye(b)}}function Ie(u,m){var b=ye(m.value),k=ye(m.defaultValue);b!=null&&(b=""+b,b!==u.value&&(u.value=b),m.defaultValue==null&&u.defaultValue!==b&&(u.defaultValue=b)),k!=null&&(u.defaultValue=""+k)}function ze(u){var m=u.textContent;m===u._wrapperState.initialValue&&m!==""&&m!==null&&(u.value=m)}function et(u){switch(u){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function tt(u,m){return u==null||u==="http://www.w3.org/1999/xhtml"?et(m):u==="http://www.w3.org/2000/svg"&&m==="foreignObject"?"http://www.w3.org/1999/xhtml":u}var ct,ht=(function(u){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(m,b,k,R){MSApp.execUnsafeLocalFunction(function(){return u(m,b,k,R)})}:u})(function(u,m){if(u.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in u)u.innerHTML=m;else{for(ct=ct||document.createElement("div"),ct.innerHTML="<svg>"+m.valueOf().toString()+"</svg>",m=ct.firstChild;u.firstChild;)u.removeChild(u.firstChild);for(;m.firstChild;)u.appendChild(m.firstChild)}});function Et(u,m){if(m){var b=u.firstChild;if(b&&b===u.lastChild&&b.nodeType===3){b.nodeValue=m;return}}u.textContent=m}var Mt={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];Object.keys(Mt).forEach(function(u){en.forEach(function(m){m=m+u.charAt(0).toUpperCase()+u.substring(1),Mt[m]=Mt[u]})});function Jt(u,m,b){return m==null||typeof m=="boolean"||m===""?"":b||typeof m!="number"||m===0||Mt.hasOwnProperty(u)&&Mt[u]?(""+m).trim():m+"px"}function Zt(u,m){u=u.style;for(var b in m)if(m.hasOwnProperty(b)){var k=b.indexOf("--")===0,R=Jt(b,m[b],k);b==="float"&&(b="cssFloat"),k?u.setProperty(b,R):u[b]=R}}var on=re({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function zt(u,m){if(m){if(on[u]&&(m.children!=null||m.dangerouslySetInnerHTML!=null))throw Error(t(137,u));if(m.dangerouslySetInnerHTML!=null){if(m.children!=null)throw Error(t(60));if(typeof m.dangerouslySetInnerHTML!="object"||!("__html"in m.dangerouslySetInnerHTML))throw Error(t(61))}if(m.style!=null&&typeof m.style!="object")throw Error(t(62))}}function Sn(u,m){if(u.indexOf("-")===-1)return typeof m.is=="string";switch(u){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var qn=null;function bn(u){return u=u.target||u.srcElement||window,u.correspondingUseElement&&(u=u.correspondingUseElement),u.nodeType===3?u.parentNode:u}var nr=null,st=null,Cn=null;function Rr(u){if(u=nl(u)){if(typeof nr!="function")throw Error(t(280));var m=u.stateNode;m&&(m=Eu(m),nr(u.stateNode,u.type,m))}}function Jr(u){st?Cn?Cn.push(u):Cn=[u]:st=u}function kn(){if(st){var u=st,m=Cn;if(Cn=st=null,Rr(u),m)for(u=0;u<m.length;u++)Rr(m[u])}}function Ps(u,m){return u(m)}function Qs(){}var Lr=!1;function _i(u,m,b){if(Lr)return u(m,b);Lr=!0;try{return Ps(u,m,b)}finally{Lr=!1,(st!==null||Cn!==null)&&(Qs(),kn())}}function ra(u,m){var b=u.stateNode;if(b===null)return null;var k=Eu(b);if(k===null)return null;b=k[m];e:switch(m){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(k=!k.disabled)||(u=u.type,k=!(u==="button"||u==="input"||u==="select"||u==="textarea")),u=!k;break e;default:u=!1}if(u)return null;if(b&&typeof b!="function")throw Error(t(231,m,typeof b));return b}var Mo=!1;if(l)try{var sa={};Object.defineProperty(sa,"passive",{get:function(){Mo=!0}}),window.addEventListener("test",sa,sa),window.removeEventListener("test",sa,sa)}catch{Mo=!1}function fd(u,m,b,k,R,z,J,fe,ge){var De=Array.prototype.slice.call(arguments,3);try{m.apply(b,De)}catch(Ge){this.onError(Ge)}}var ur=!1,dt=null,ia=!1,qa=null,Il={onError:function(u){ur=!0,dt=u}};function Al(u,m,b,k,R,z,J,fe,ge){ur=!1,dt=null,fd.apply(Il,arguments)}function Eo(u,m,b,k,R,z,J,fe,ge){if(Al.apply(this,arguments),ur){if(ur){var De=dt;ur=!1,dt=null}else throw Error(t(198));ia||(ia=!0,qa=De)}}function Ms(u){var m=u,b=u;if(u.alternate)for(;m.return;)m=m.return;else{u=m;do m=u,(m.flags&4098)!==0&&(b=m.return),u=m.return;while(u)}return m.tag===3?b:null}function Xs(u){if(u.tag===13){var m=u.memoizedState;if(m===null&&(u=u.alternate,u!==null&&(m=u.memoizedState)),m!==null)return m.dehydrated}return null}function Do(u){if(Ms(u)!==u)throw Error(t(188))}function hd(u){var m=u.alternate;if(!m){if(m=Ms(u),m===null)throw Error(t(188));return m!==u?null:u}for(var b=u,k=m;;){var R=b.return;if(R===null)break;var z=R.alternate;if(z===null){if(k=R.return,k!==null){b=k;continue}break}if(R.child===z.child){for(z=R.child;z;){if(z===b)return Do(R),u;if(z===k)return Do(R),m;z=z.sibling}throw Error(t(188))}if(b.return!==k.return)b=R,k=z;else{for(var J=!1,fe=R.child;fe;){if(fe===b){J=!0,b=R,k=z;break}if(fe===k){J=!0,k=R,b=z;break}fe=fe.sibling}if(!J){for(fe=z.child;fe;){if(fe===b){J=!0,b=z,k=R;break}if(fe===k){J=!0,k=z,b=R;break}fe=fe.sibling}if(!J)throw Error(t(189))}}if(b.alternate!==k)throw Error(t(190))}if(b.tag!==3)throw Error(t(188));return b.stateNode.current===b?u:m}function Rl(u){return u=hd(u),u!==null?Ll(u):null}function Ll(u){if(u.tag===5||u.tag===6)return u;for(u=u.child;u!==null;){var m=Ll(u);if(m!==null)return m;u=u.sibling}return null}var Fl=e.unstable_scheduleCallback,Oo=e.unstable_cancelCallback,md=e.unstable_shouldYield,za=e.unstable_requestPaint,Pn=e.unstable_now,pd=e.unstable_getCurrentPriorityLevel,Io=e.unstable_ImmediatePriority,ql=e.unstable_UserBlockingPriority,Ua=e.unstable_NormalPriority,Ao=e.unstable_LowPriority,ji=e.unstable_IdlePriority,aa=null,Fr=null;function oa(u){if(Fr&&typeof Fr.onCommitFiberRoot=="function")try{Fr.onCommitFiberRoot(aa,u,void 0,(u.current.flags&128)===128)}catch{}}var Ot=Math.clz32?Math.clz32:Ni,wn=Math.log,Ba=Math.LN2;function Ni(u){return u>>>=0,u===0?32:31-(wn(u)/Ba|0)|0}var hs=64,Si=4194304;function Dt(u){switch(u&-u){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return u&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return u&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return u}}function xn(u,m){var b=u.pendingLanes;if(b===0)return 0;var k=0,R=u.suspendedLanes,z=u.pingedLanes,J=b&268435455;if(J!==0){var fe=J&~R;fe!==0?k=Dt(fe):(z&=J,z!==0&&(k=Dt(z)))}else J=b&~R,J!==0?k=Dt(J):z!==0&&(k=Dt(z));if(k===0)return 0;if(m!==0&&m!==k&&(m&R)===0&&(R=k&-k,z=m&-m,R>=z||R===16&&(z&4194240)!==0))return m;if((k&4)!==0&&(k|=b&16),m=u.entangledLanes,m!==0)for(u=u.entanglements,m&=k;0<m;)b=31-Ot(m),R=1<<b,k|=u[b],m&=~R;return k}function Ro(u,m){switch(u){case 1:case 2:case 4:return m+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return m+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Va(u,m){for(var b=u.suspendedLanes,k=u.pingedLanes,R=u.expirationTimes,z=u.pendingLanes;0<z;){var J=31-Ot(z),fe=1<<J,ge=R[J];ge===-1?((fe&b)===0||(fe&k)!==0)&&(R[J]=Ro(fe,m)):ge<=m&&(u.expiredLanes|=fe),z&=~fe}}function fr(u){return u=u.pendingLanes&-1073741825,u!==0?u:u&1073741824?1073741824:0}function zl(){var u=hs;return hs<<=1,(hs&4194240)===0&&(hs=64),u}function Ci(u){for(var m=[],b=0;31>b;b++)m.push(u);return m}function qr(u,m,b){u.pendingLanes|=m,m!==536870912&&(u.suspendedLanes=0,u.pingedLanes=0),u=u.eventTimes,m=31-Ot(m),u[m]=b}function An(u,m){var b=u.pendingLanes&~m;u.pendingLanes=m,u.suspendedLanes=0,u.pingedLanes=0,u.expiredLanes&=m,u.mutableReadLanes&=m,u.entangledLanes&=m,m=u.entanglements;var k=u.eventTimes;for(u=u.expirationTimes;0<b;){var R=31-Ot(b),z=1<<R;m[R]=0,k[R]=-1,u[R]=-1,b&=~z}}function ms(u,m){var b=u.entangledLanes|=m;for(u=u.entanglements;b;){var k=31-Ot(b),R=1<<k;R&m|u[k]&m&&(u[k]|=m),b&=~R}}var Kt=0;function Ti(u){return u&=-u,1<u?4<u?(u&268435455)!==0?16:536870912:4:1}var Wa,ei,$a,Ha,la,ca=!1,ki=[],zr=null,ps=null,Qr=null,da=new Map,Ct=new Map,Gn=[],cn="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lo(u,m){switch(u){case"focusin":case"focusout":zr=null;break;case"dragenter":case"dragleave":ps=null;break;case"mouseover":case"mouseout":Qr=null;break;case"pointerover":case"pointerout":da.delete(m.pointerId);break;case"gotpointercapture":case"lostpointercapture":Ct.delete(m.pointerId)}}function ti(u,m,b,k,R,z){return u===null||u.nativeEvent!==z?(u={blockedOn:m,domEventName:b,eventSystemFlags:k,nativeEvent:z,targetContainers:[R]},m!==null&&(m=nl(m),m!==null&&ei(m)),u):(u.eventSystemFlags|=k,m=u.targetContainers,R!==null&&m.indexOf(R)===-1&&m.push(R),u)}function Fo(u,m,b,k,R){switch(m){case"focusin":return zr=ti(zr,u,m,b,k,R),!0;case"dragenter":return ps=ti(ps,u,m,b,k,R),!0;case"mouseover":return Qr=ti(Qr,u,m,b,k,R),!0;case"pointerover":var z=R.pointerId;return da.set(z,ti(da.get(z)||null,u,m,b,k,R)),!0;case"gotpointercapture":return z=R.pointerId,Ct.set(z,ti(Ct.get(z)||null,u,m,b,k,R)),!0}return!1}function Ya(u){var m=tl(u.target);if(m!==null){var b=Ms(m);if(b!==null){if(m=b.tag,m===13){if(m=Xs(b),m!==null){u.blockedOn=m,la(u.priority,function(){$a(b)});return}}else if(m===3&&b.stateNode.current.memoizedState.isDehydrated){u.blockedOn=b.tag===3?b.stateNode.containerInfo:null;return}}}u.blockedOn=null}function Xr(u){if(u.blockedOn!==null)return!1;for(var m=u.targetContainers;0<m.length;){var b=Ka(u.domEventName,u.eventSystemFlags,m[0],u.nativeEvent);if(b===null){b=u.nativeEvent;var k=new b.constructor(b.type,b);qn=k,b.target.dispatchEvent(k),qn=null}else return m=nl(b),m!==null&&ei(m),u.blockedOn=b,!1;m.shift()}return!0}function Ga(u,m,b){Xr(u)&&b.delete(m)}function ua(){ca=!1,zr!==null&&Xr(zr)&&(zr=null),ps!==null&&Xr(ps)&&(ps=null),Qr!==null&&Xr(Qr)&&(Qr=null),da.forEach(Ga),Ct.forEach(Ga)}function Mn(u,m){u.blockedOn===m&&(u.blockedOn=null,ca||(ca=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ua)))}function Ur(u){function m(R){return Mn(R,u)}if(0<ki.length){Mn(ki[0],u);for(var b=1;b<ki.length;b++){var k=ki[b];k.blockedOn===u&&(k.blockedOn=null)}}for(zr!==null&&Mn(zr,u),ps!==null&&Mn(ps,u),Qr!==null&&Mn(Qr,u),da.forEach(m),Ct.forEach(m),b=0;b<Gn.length;b++)k=Gn[b],k.blockedOn===u&&(k.blockedOn=null);for(;0<Gn.length&&(b=Gn[0],b.blockedOn===null);)Ya(b),b.blockedOn===null&&Gn.shift()}var ni=M.ReactCurrentBatchConfig,fa=!0;function gd(u,m,b,k){var R=Kt,z=ni.transition;ni.transition=null;try{Kt=1,ha(u,m,b,k)}finally{Kt=R,ni.transition=z}}function Ul(u,m,b,k){var R=Kt,z=ni.transition;ni.transition=null;try{Kt=4,ha(u,m,b,k)}finally{Kt=R,ni.transition=z}}function ha(u,m,b,k){if(fa){var R=Ka(u,m,b,k);if(R===null)f(u,m,k,Za,b),Lo(u,k);else if(Fo(R,u,m,b,k))k.stopPropagation();else if(Lo(u,k),m&4&&-1<cn.indexOf(u)){for(;R!==null;){var z=nl(R);if(z!==null&&Wa(z),z=Ka(u,m,b,k),z===null&&f(u,m,k,Za,b),z===R)break;R=z}R!==null&&k.stopPropagation()}else f(u,m,k,null,b)}}var Za=null;function Ka(u,m,b,k){if(Za=null,u=bn(k),u=tl(u),u!==null)if(m=Ms(u),m===null)u=null;else if(b=m.tag,b===13){if(u=Xs(m),u!==null)return u;u=null}else if(b===3){if(m.stateNode.current.memoizedState.isDehydrated)return m.tag===3?m.stateNode.containerInfo:null;u=null}else m!==u&&(u=null);return Za=u,null}function Ht(u){switch(u){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(pd()){case Io:return 1;case ql:return 4;case Ua:case Ao:return 16;case ji:return 536870912;default:return 16}default:return 16}}var Es=null,wr=null,Ds=null;function qo(){if(Ds)return Ds;var u,m=wr,b=m.length,k,R="value"in Es?Es.value:Es.textContent,z=R.length;for(u=0;u<b&&m[u]===R[u];u++);var J=b-u;for(k=1;k<=J&&m[b-k]===R[z-k];k++);return Ds=R.slice(u,1<k?1-k:void 0)}function Ja(u){var m=u.keyCode;return"charCode"in u?(u=u.charCode,u===0&&m===13&&(u=13)):u=m,u===10&&(u=13),32<=u||u===13?u:0}function Pi(){return!0}function Bl(){return!1}function hr(u){function m(b,k,R,z,J){this._reactName=b,this._targetInst=R,this.type=k,this.nativeEvent=z,this.target=J,this.currentTarget=null;for(var fe in u)u.hasOwnProperty(fe)&&(b=u[fe],this[fe]=b?b(z):z[fe]);return this.isDefaultPrevented=(z.defaultPrevented!=null?z.defaultPrevented:z.returnValue===!1)?Pi:Bl,this.isPropagationStopped=Bl,this}return re(m.prototype,{preventDefault:function(){this.defaultPrevented=!0;var b=this.nativeEvent;b&&(b.preventDefault?b.preventDefault():typeof b.returnValue!="unknown"&&(b.returnValue=!1),this.isDefaultPrevented=Pi)},stopPropagation:function(){var b=this.nativeEvent;b&&(b.stopPropagation?b.stopPropagation():typeof b.cancelBubble!="unknown"&&(b.cancelBubble=!0),this.isPropagationStopped=Pi)},persist:function(){},isPersistent:Pi}),m}var Mi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(u){return u.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zo=hr(Mi),ri=re({},Mi,{view:0,detail:0}),xd=hr(ri),Mr,Uo,Ei,Br=re({},ri,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ii,button:0,buttons:0,relatedTarget:function(u){return u.relatedTarget===void 0?u.fromElement===u.srcElement?u.toElement:u.fromElement:u.relatedTarget},movementX:function(u){return"movementX"in u?u.movementX:(u!==Ei&&(Ei&&u.type==="mousemove"?(Mr=u.screenX-Ei.screenX,Uo=u.screenY-Ei.screenY):Uo=Mr=0,Ei=u),Mr)},movementY:function(u){return"movementY"in u?u.movementY:Uo}}),Bo=hr(Br),Vl=re({},Br,{dataTransfer:0}),Vo=hr(Vl),yd=re({},ri,{relatedTarget:0}),Qa=hr(yd),Wl=re({},Mi,{animationName:0,elapsedTime:0,pseudoElement:0}),vd=hr(Wl),bd=re({},Mi,{clipboardData:function(u){return"clipboardData"in u?u.clipboardData:window.clipboardData}}),Wo=hr(bd),wd=re({},Mi,{data:0}),$o=hr(wd),$l={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Xa={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},si={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _d(u){var m=this.nativeEvent;return m.getModifierState?m.getModifierState(u):(u=si[u])?!!m[u]:!1}function ii(){return _d}var Er=re({},ri,{key:function(u){if(u.key){var m=$l[u.key]||u.key;if(m!=="Unidentified")return m}return u.type==="keypress"?(u=Ja(u),u===13?"Enter":String.fromCharCode(u)):u.type==="keydown"||u.type==="keyup"?Xa[u.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ii,charCode:function(u){return u.type==="keypress"?Ja(u):0},keyCode:function(u){return u.type==="keydown"||u.type==="keyup"?u.keyCode:0},which:function(u){return u.type==="keypress"?Ja(u):u.type==="keydown"||u.type==="keyup"?u.keyCode:0}}),Hl=hr(Er),Yl=re({},Br,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Gl=hr(Yl),Ho=re({},ri,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ii}),Yo=hr(Ho),jd=re({},Mi,{propertyName:0,elapsedTime:0,pseudoElement:0}),Nd=hr(jd),Zl=re({},Br,{deltaX:function(u){return"deltaX"in u?u.deltaX:"wheelDeltaX"in u?-u.wheelDeltaX:0},deltaY:function(u){return"deltaY"in u?u.deltaY:"wheelDeltaY"in u?-u.wheelDeltaY:"wheelDelta"in u?-u.wheelDelta:0},deltaZ:0,deltaMode:0}),Sd=hr(Zl),Vr=[9,13,27,32],Os=l&&"CompositionEvent"in window,ma=null;l&&"documentMode"in document&&(ma=document.documentMode);var gs=l&&"TextEvent"in window&&!ma,Kl=l&&(!Os||ma&&8<ma&&11>=ma),ai=" ",Jl=!1;function Di(u,m){switch(u){case"keyup":return Vr.indexOf(m.keyCode)!==-1;case"keydown":return m.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Go(u){return u=u.detail,typeof u=="object"&&"data"in u?u.data:null}var xs=!1;function Cd(u,m){switch(u){case"compositionend":return Go(m);case"keypress":return m.which!==32?null:(Jl=!0,ai);case"textInput":return u=m.data,u===ai&&Jl?null:u;default:return null}}function Is(u,m){if(xs)return u==="compositionend"||!Os&&Di(u,m)?(u=qo(),Ds=wr=Es=null,xs=!1,u):null;switch(u){case"paste":return null;case"keypress":if(!(m.ctrlKey||m.altKey||m.metaKey)||m.ctrlKey&&m.altKey){if(m.char&&1<m.char.length)return m.char;if(m.which)return String.fromCharCode(m.which)}return null;case"compositionend":return Kl&&m.locale!=="ko"?null:m.data;default:return null}}var eo={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ql(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m==="input"?!!eo[u.type]:m==="textarea"}function to(u,m,b,k){Jr(k),m=T(m,"onChange"),0<m.length&&(b=new zo("onChange","change",null,b,k),u.push({event:b,listeners:m}))}var pa=null,_r=null;function Td(u){th(u,0)}function ys(u){var m=rl(u);if(je(m))return u}function kd(u,m){if(u==="change")return m}var es=!1;if(l){var Oi;if(l){var no="oninput"in document;if(!no){var ro=document.createElement("div");ro.setAttribute("oninput","return;"),no=typeof ro.oninput=="function"}Oi=no}else Oi=!1;es=Oi&&(!document.documentMode||9<document.documentMode)}function ga(){pa&&(pa.detachEvent("onpropertychange",so),_r=pa=null)}function so(u){if(u.propertyName==="value"&&ys(_r)){var m=[];to(m,_r,u,bn(u)),_i(Td,m)}}function io(u,m,b){u==="focusin"?(ga(),pa=m,_r=b,pa.attachEvent("onpropertychange",so)):u==="focusout"&&ga()}function Ii(u){if(u==="selectionchange"||u==="keyup"||u==="keydown")return ys(_r)}function ao(u,m){if(u==="click")return ys(m)}function Zo(u,m){if(u==="input"||u==="change")return ys(m)}function Xl(u,m){return u===m&&(u!==0||1/u===1/m)||u!==u&&m!==m}var Wr=typeof Object.is=="function"?Object.is:Xl;function As(u,m){if(Wr(u,m))return!0;if(typeof u!="object"||u===null||typeof m!="object"||m===null)return!1;var b=Object.keys(u),k=Object.keys(m);if(b.length!==k.length)return!1;for(k=0;k<b.length;k++){var R=b[k];if(!c.call(m,R)||!Wr(u[R],m[R]))return!1}return!0}function ec(u){for(;u&&u.firstChild;)u=u.firstChild;return u}function Ko(u,m){var b=ec(u);u=0;for(var k;b;){if(b.nodeType===3){if(k=u+b.textContent.length,u<=m&&k>=m)return{node:b,offset:m-u};u=k}e:{for(;b;){if(b.nextSibling){b=b.nextSibling;break e}b=b.parentNode}b=void 0}b=ec(b)}}function tc(u,m){return u&&m?u===m?!0:u&&u.nodeType===3?!1:m&&m.nodeType===3?tc(u,m.parentNode):"contains"in u?u.contains(m):u.compareDocumentPosition?!!(u.compareDocumentPosition(m)&16):!1:!1}function Jo(){for(var u=window,m=ke();m instanceof u.HTMLIFrameElement;){try{var b=typeof m.contentWindow.location.href=="string"}catch{b=!1}if(b)u=m.contentWindow;else break;m=ke(u.document)}return m}function Qo(u){var m=u&&u.nodeName&&u.nodeName.toLowerCase();return m&&(m==="input"&&(u.type==="text"||u.type==="search"||u.type==="tel"||u.type==="url"||u.type==="password")||m==="textarea"||u.contentEditable==="true")}function g(u){var m=Jo(),b=u.focusedElem,k=u.selectionRange;if(m!==b&&b&&b.ownerDocument&&tc(b.ownerDocument.documentElement,b)){if(k!==null&&Qo(b)){if(m=k.start,u=k.end,u===void 0&&(u=m),"selectionStart"in b)b.selectionStart=m,b.selectionEnd=Math.min(u,b.value.length);else if(u=(m=b.ownerDocument||document)&&m.defaultView||window,u.getSelection){u=u.getSelection();var R=b.textContent.length,z=Math.min(k.start,R);k=k.end===void 0?z:Math.min(k.end,R),!u.extend&&z>k&&(R=k,k=z,z=R),R=Ko(b,z);var J=Ko(b,k);R&&J&&(u.rangeCount!==1||u.anchorNode!==R.node||u.anchorOffset!==R.offset||u.focusNode!==J.node||u.focusOffset!==J.offset)&&(m=m.createRange(),m.setStart(R.node,R.offset),u.removeAllRanges(),z>k?(u.addRange(m),u.extend(J.node,J.offset)):(m.setEnd(J.node,J.offset),u.addRange(m)))}}for(m=[],u=b;u=u.parentNode;)u.nodeType===1&&m.push({element:u,left:u.scrollLeft,top:u.scrollTop});for(typeof b.focus=="function"&&b.focus(),b=0;b<m.length;b++)u=m[b],u.element.scrollLeft=u.left,u.element.scrollTop=u.top}}var ku=l&&"documentMode"in document&&11>=document.documentMode,nc=null,rc=null,Pd=null,Pu=!1;function zm(u,m,b){var k=b.window===b?b.document:b.nodeType===9?b:b.ownerDocument;Pu||nc==null||nc!==ke(k)||(k=nc,"selectionStart"in k&&Qo(k)?k={start:k.selectionStart,end:k.selectionEnd}:(k=(k.ownerDocument&&k.ownerDocument.defaultView||window).getSelection(),k={anchorNode:k.anchorNode,anchorOffset:k.anchorOffset,focusNode:k.focusNode,focusOffset:k.focusOffset}),Pd&&As(Pd,k)||(Pd=k,k=T(rc,"onSelect"),0<k.length&&(m=new zo("onSelect","select",null,m,b),u.push({event:m,listeners:k}),m.target=nc)))}function oo(u,m){var b={};return b[u.toLowerCase()]=m.toLowerCase(),b["Webkit"+u]="webkit"+m,b["Moz"+u]="moz"+m,b}var sc={animationend:oo("Animation","AnimationEnd"),animationiteration:oo("Animation","AnimationIteration"),animationstart:oo("Animation","AnimationStart"),transitionend:oo("Transition","TransitionEnd")},lo={},Jf={};l&&(Jf=document.createElement("div").style,"AnimationEvent"in window||(delete sc.animationend.animation,delete sc.animationiteration.animation,delete sc.animationstart.animation),"TransitionEvent"in window||delete sc.transitionend.transition);function Md(u){if(lo[u])return lo[u];if(!sc[u])return u;var m=sc[u],b;for(b in m)if(m.hasOwnProperty(b)&&b in Jf)return lo[u]=m[b];return u}var Um=Md("animationend"),Ai=Md("animationiteration"),Qf=Md("animationstart"),Xf=Md("transitionend"),ic=new Map,Bm="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function oi(u,m){ic.set(u,m),a(m,[u])}for(var Xo=0;Xo<Bm.length;Xo++){var Mu=Bm[Xo],Vm=Mu.toLowerCase(),qy=Mu[0].toUpperCase()+Mu.slice(1);oi(Vm,"on"+qy)}oi(Um,"onAnimationEnd"),oi(Ai,"onAnimationIteration"),oi(Qf,"onAnimationStart"),oi("dblclick","onDoubleClick"),oi("focusin","onFocus"),oi("focusout","onBlur"),oi(Xf,"onTransitionEnd"),o("onMouseEnter",["mouseout","mouseover"]),o("onMouseLeave",["mouseout","mouseover"]),o("onPointerEnter",["pointerout","pointerover"]),o("onPointerLeave",["pointerout","pointerover"]),a("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),a("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),a("onBeforeInput",["compositionend","keypress","textInput","paste"]),a("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),a("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ac="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Wm=new Set("cancel close invalid load scroll toggle".split(" ").concat(ac));function eh(u,m,b){var k=u.type||"unknown-event";u.currentTarget=b,Eo(k,m,void 0,u),u.currentTarget=null}function th(u,m){m=(m&4)!==0;for(var b=0;b<u.length;b++){var k=u[b],R=k.event;k=k.listeners;e:{var z=void 0;if(m)for(var J=k.length-1;0<=J;J--){var fe=k[J],ge=fe.instance,De=fe.currentTarget;if(fe=fe.listener,ge!==z&&R.isPropagationStopped())break e;eh(R,fe,De),z=ge}else for(J=0;J<k.length;J++){if(fe=k[J],ge=fe.instance,De=fe.currentTarget,fe=fe.listener,ge!==z&&R.isPropagationStopped())break e;eh(R,fe,De),z=ge}}}if(ia)throw u=qa,ia=!1,qa=null,u}function Tn(u,m){var b=m[dc];b===void 0&&(b=m[dc]=new Set);var k=u+"__bubble";b.has(k)||($m(m,u,2,!1),b.add(k))}function nh(u,m,b){var k=0;m&&(k|=4),$m(b,u,k,m)}var Ed="_reactListening"+Math.random().toString(36).slice(2);function oc(u){if(!u[Ed]){u[Ed]=!0,r.forEach(function(b){b!=="selectionchange"&&(Wm.has(b)||nh(b,!1,u),nh(b,!0,u))});var m=u.nodeType===9?u:u.ownerDocument;m===null||m[Ed]||(m[Ed]=!0,nh("selectionchange",!1,m))}}function $m(u,m,b,k){switch(Ht(m)){case 1:var R=gd;break;case 4:R=Ul;break;default:R=ha}b=R.bind(null,m,b,u),R=void 0,!Mo||m!=="touchstart"&&m!=="touchmove"&&m!=="wheel"||(R=!0),k?R!==void 0?u.addEventListener(m,b,{capture:!0,passive:R}):u.addEventListener(m,b,!0):R!==void 0?u.addEventListener(m,b,{passive:R}):u.addEventListener(m,b,!1)}function f(u,m,b,k,R){var z=k;if((m&1)===0&&(m&2)===0&&k!==null)e:for(;;){if(k===null)return;var J=k.tag;if(J===3||J===4){var fe=k.stateNode.containerInfo;if(fe===R||fe.nodeType===8&&fe.parentNode===R)break;if(J===4)for(J=k.return;J!==null;){var ge=J.tag;if((ge===3||ge===4)&&(ge=J.stateNode.containerInfo,ge===R||ge.nodeType===8&&ge.parentNode===R))return;J=J.return}for(;fe!==null;){if(J=tl(fe),J===null)return;if(ge=J.tag,ge===5||ge===6){k=z=J;continue e}fe=fe.parentNode}}k=k.return}_i(function(){var De=z,Ge=bn(b),Ke=[];e:{var He=ic.get(u);if(He!==void 0){var at=zo,ut=u;switch(u){case"keypress":if(Ja(b)===0)break e;case"keydown":case"keyup":at=Hl;break;case"focusin":ut="focus",at=Qa;break;case"focusout":ut="blur",at=Qa;break;case"beforeblur":case"afterblur":at=Qa;break;case"click":if(b.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":at=Bo;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":at=Vo;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":at=Yo;break;case Um:case Ai:case Qf:at=vd;break;case Xf:at=Nd;break;case"scroll":at=xd;break;case"wheel":at=Sd;break;case"copy":case"cut":case"paste":at=Wo;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":at=Gl}var mt=(m&4)!==0,ir=!mt&&u==="scroll",Se=mt?He!==null?He+"Capture":null:He;mt=[];for(var be=De,Pe;be!==null;){Pe=be;var Je=Pe.stateNode;if(Pe.tag===5&&Je!==null&&(Pe=Je,Se!==null&&(Je=ra(be,Se),Je!=null&&mt.push(v(be,Je,Pe)))),ir)break;be=be.return}0<mt.length&&(He=new at(He,ut,null,b,Ge),Ke.push({event:He,listeners:mt}))}}if((m&7)===0){e:{if(He=u==="mouseover"||u==="pointerover",at=u==="mouseout"||u==="pointerout",He&&b!==qn&&(ut=b.relatedTarget||b.fromElement)&&(tl(ut)||ut[yn]))break e;if((at||He)&&(He=Ge.window===Ge?Ge:(He=Ge.ownerDocument)?He.defaultView||He.parentWindow:window,at?(ut=b.relatedTarget||b.toElement,at=De,ut=ut?tl(ut):null,ut!==null&&(ir=Ms(ut),ut!==ir||ut.tag!==5&&ut.tag!==6)&&(ut=null)):(at=null,ut=De),at!==ut)){if(mt=Bo,Je="onMouseLeave",Se="onMouseEnter",be="mouse",(u==="pointerout"||u==="pointerover")&&(mt=Gl,Je="onPointerLeave",Se="onPointerEnter",be="pointer"),ir=at==null?He:rl(at),Pe=ut==null?He:rl(ut),He=new mt(Je,be+"leave",at,b,Ge),He.target=ir,He.relatedTarget=Pe,Je=null,tl(Ge)===De&&(mt=new mt(Se,be+"enter",ut,b,Ge),mt.target=Pe,mt.relatedTarget=ir,Je=mt),ir=Je,at&&ut)t:{for(mt=at,Se=ut,be=0,Pe=mt;Pe;Pe=A(Pe))be++;for(Pe=0,Je=Se;Je;Je=A(Je))Pe++;for(;0<be-Pe;)mt=A(mt),be--;for(;0<Pe-be;)Se=A(Se),Pe--;for(;be--;){if(mt===Se||Se!==null&&mt===Se.alternate)break t;mt=A(mt),Se=A(Se)}mt=null}else mt=null;at!==null&&V(Ke,He,at,mt,!1),ut!==null&&ir!==null&&V(Ke,ir,ut,mt,!0)}}e:{if(He=De?rl(De):window,at=He.nodeName&&He.nodeName.toLowerCase(),at==="select"||at==="input"&&He.type==="file")var gt=kd;else if(Ql(He))if(es)gt=Zo;else{gt=Ii;var Tt=io}else(at=He.nodeName)&&at.toLowerCase()==="input"&&(He.type==="checkbox"||He.type==="radio")&&(gt=ao);if(gt&&(gt=gt(u,De))){to(Ke,gt,b,Ge);break e}Tt&&Tt(u,He,De),u==="focusout"&&(Tt=He._wrapperState)&&Tt.controlled&&He.type==="number"&&qe(He,"number",He.value)}switch(Tt=De?rl(De):window,u){case"focusin":(Ql(Tt)||Tt.contentEditable==="true")&&(nc=Tt,rc=De,Pd=null);break;case"focusout":Pd=rc=nc=null;break;case"mousedown":Pu=!0;break;case"contextmenu":case"mouseup":case"dragend":Pu=!1,zm(Ke,b,Ge);break;case"selectionchange":if(ku)break;case"keydown":case"keyup":zm(Ke,b,Ge)}var kt;if(Os)e:{switch(u){case"compositionstart":var Lt="onCompositionStart";break e;case"compositionend":Lt="onCompositionEnd";break e;case"compositionupdate":Lt="onCompositionUpdate";break e}Lt=void 0}else xs?Di(u,b)&&(Lt="onCompositionEnd"):u==="keydown"&&b.keyCode===229&&(Lt="onCompositionStart");Lt&&(Kl&&b.locale!=="ko"&&(xs||Lt!=="onCompositionStart"?Lt==="onCompositionEnd"&&xs&&(kt=qo()):(Es=Ge,wr="value"in Es?Es.value:Es.textContent,xs=!0)),Tt=T(De,Lt),0<Tt.length&&(Lt=new $o(Lt,u,null,b,Ge),Ke.push({event:Lt,listeners:Tt}),kt?Lt.data=kt:(kt=Go(b),kt!==null&&(Lt.data=kt)))),(kt=gs?Cd(u,b):Is(u,b))&&(De=T(De,"onBeforeInput"),0<De.length&&(Ge=new $o("onBeforeInput","beforeinput",null,b,Ge),Ke.push({event:Ge,listeners:De}),Ge.data=kt))}th(Ke,m)})}function v(u,m,b){return{instance:u,listener:m,currentTarget:b}}function T(u,m){for(var b=m+"Capture",k=[];u!==null;){var R=u,z=R.stateNode;R.tag===5&&z!==null&&(R=z,z=ra(u,b),z!=null&&k.unshift(v(u,z,R)),z=ra(u,m),z!=null&&k.push(v(u,z,R))),u=u.return}return k}function A(u){if(u===null)return null;do u=u.return;while(u&&u.tag!==5);return u||null}function V(u,m,b,k,R){for(var z=m._reactName,J=[];b!==null&&b!==k;){var fe=b,ge=fe.alternate,De=fe.stateNode;if(ge!==null&&ge===k)break;fe.tag===5&&De!==null&&(fe=De,R?(ge=ra(b,z),ge!=null&&J.unshift(v(b,ge,fe))):R||(ge=ra(b,z),ge!=null&&J.push(v(b,ge,fe)))),b=b.return}J.length!==0&&u.push({event:m,listeners:J})}var Q=/\r\n?/g,pe=/\u0000|\uFFFD/g;function Ne(u){return(typeof u=="string"?u:""+u).replace(Q,`
`).replace(pe,"")}function Ee(u,m,b){if(m=Ne(m),Ne(u)!==m&&b)throw Error(t(425))}function Be(){}var rt=null,Nt=null;function $t(u,m){return u==="textarea"||u==="noscript"||typeof m.children=="string"||typeof m.children=="number"||typeof m.dangerouslySetInnerHTML=="object"&&m.dangerouslySetInnerHTML!==null&&m.dangerouslySetInnerHTML.__html!=null}var jr=typeof setTimeout=="function"?setTimeout:void 0,mr=typeof clearTimeout=="function"?clearTimeout:void 0,vs=typeof Promise=="function"?Promise:void 0,ts=typeof queueMicrotask=="function"?queueMicrotask:typeof vs<"u"?function(u){return vs.resolve(null).then(u).catch(lc)}:jr;function lc(u){setTimeout(function(){throw u})}function rh(u,m){var b=m,k=0;do{var R=b.nextSibling;if(u.removeChild(b),R&&R.nodeType===8)if(b=R.data,b==="/$"){if(k===0){u.removeChild(R),Ur(m);return}k--}else b!=="$"&&b!=="$?"&&b!=="$!"||k++;b=R}while(b);Ur(m)}function co(u){for(;u!=null;u=u.nextSibling){var m=u.nodeType;if(m===1||m===3)break;if(m===8){if(m=u.data,m==="$"||m==="$!"||m==="$?")break;if(m==="/$")return null}}return u}function Hm(u){u=u.previousSibling;for(var m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="$"||b==="$!"||b==="$?"){if(m===0)return u;m--}else b==="/$"&&m++}u=u.previousSibling}return null}var el=Math.random().toString(36).slice(2),Ri="__reactFiber$"+el,cc="__reactProps$"+el,yn="__reactContainer$"+el,dc="__reactEvents$"+el,zy="__reactListeners$"+el,Uy="__reactHandles$"+el;function tl(u){var m=u[Ri];if(m)return m;for(var b=u.parentNode;b;){if(m=b[yn]||b[Ri]){if(b=m.alternate,m.child!==null||b!==null&&b.child!==null)for(u=Hm(u);u!==null;){if(b=u[Ri])return b;u=Hm(u)}return m}u=b,b=u.parentNode}return null}function nl(u){return u=u[Ri]||u[yn],!u||u.tag!==5&&u.tag!==6&&u.tag!==13&&u.tag!==3?null:u}function rl(u){if(u.tag===5||u.tag===6)return u.stateNode;throw Error(t(33))}function Eu(u){return u[cc]||null}var By=[],Du=-1;function uc(u){return{current:u}}function zn(u){0>Du||(u.current=By[Du],By[Du]=null,Du--)}function Rn(u,m){Du++,By[Du]=u.current,u.current=m}var fc={},ns=uc(fc),Rs=uc(!1),Dd=fc;function Ou(u,m){var b=u.type.contextTypes;if(!b)return fc;var k=u.stateNode;if(k&&k.__reactInternalMemoizedUnmaskedChildContext===m)return k.__reactInternalMemoizedMaskedChildContext;var R={},z;for(z in b)R[z]=m[z];return k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=m,u.__reactInternalMemoizedMaskedChildContext=R),R}function Ls(u){return u=u.childContextTypes,u!=null}function Ym(){zn(Rs),zn(ns)}function jC(u,m,b){if(ns.current!==fc)throw Error(t(168));Rn(ns,m),Rn(Rs,b)}function NC(u,m,b){var k=u.stateNode;if(m=m.childContextTypes,typeof k.getChildContext!="function")return b;k=k.getChildContext();for(var R in k)if(!(R in m))throw Error(t(108,te(u)||"Unknown",R));return re({},b,k)}function Gm(u){return u=(u=u.stateNode)&&u.__reactInternalMemoizedMergedChildContext||fc,Dd=ns.current,Rn(ns,u),Rn(Rs,Rs.current),!0}function SC(u,m,b){var k=u.stateNode;if(!k)throw Error(t(169));b?(u=NC(u,m,Dd),k.__reactInternalMemoizedMergedChildContext=u,zn(Rs),zn(ns),Rn(ns,u)):zn(Rs),Rn(Rs,b)}var sl=null,Zm=!1,Vy=!1;function CC(u){sl===null?sl=[u]:sl.push(u)}function eq(u){Zm=!0,CC(u)}function hc(){if(!Vy&&sl!==null){Vy=!0;var u=0,m=Kt;try{var b=sl;for(Kt=1;u<b.length;u++){var k=b[u];do k=k(!0);while(k!==null)}sl=null,Zm=!1}catch(R){throw sl!==null&&(sl=sl.slice(u+1)),Fl(Io,hc),R}finally{Kt=m,Vy=!1}}return null}var Iu=[],Au=0,Km=null,Jm=0,Li=[],Fi=0,Od=null,il=1,al="";function Id(u,m){Iu[Au++]=Jm,Iu[Au++]=Km,Km=u,Jm=m}function TC(u,m,b){Li[Fi++]=il,Li[Fi++]=al,Li[Fi++]=Od,Od=u;var k=il;u=al;var R=32-Ot(k)-1;k&=~(1<<R),b+=1;var z=32-Ot(m)+R;if(30<z){var J=R-R%5;z=(k&(1<<J)-1).toString(32),k>>=J,R-=J,il=1<<32-Ot(m)+R|b<<R|k,al=z+u}else il=1<<z|b<<R|k,al=u}function Wy(u){u.return!==null&&(Id(u,1),TC(u,1,0))}function $y(u){for(;u===Km;)Km=Iu[--Au],Iu[Au]=null,Jm=Iu[--Au],Iu[Au]=null;for(;u===Od;)Od=Li[--Fi],Li[Fi]=null,al=Li[--Fi],Li[Fi]=null,il=Li[--Fi],Li[Fi]=null}var li=null,ci=null,$n=!1,xa=null;function kC(u,m){var b=Bi(5,null,null,0);b.elementType="DELETED",b.stateNode=m,b.return=u,m=u.deletions,m===null?(u.deletions=[b],u.flags|=16):m.push(b)}function PC(u,m){switch(u.tag){case 5:var b=u.type;return m=m.nodeType!==1||b.toLowerCase()!==m.nodeName.toLowerCase()?null:m,m!==null?(u.stateNode=m,li=u,ci=co(m.firstChild),!0):!1;case 6:return m=u.pendingProps===""||m.nodeType!==3?null:m,m!==null?(u.stateNode=m,li=u,ci=null,!0):!1;case 13:return m=m.nodeType!==8?null:m,m!==null?(b=Od!==null?{id:il,overflow:al}:null,u.memoizedState={dehydrated:m,treeContext:b,retryLane:1073741824},b=Bi(18,null,null,0),b.stateNode=m,b.return=u,u.child=b,li=u,ci=null,!0):!1;default:return!1}}function Hy(u){return(u.mode&1)!==0&&(u.flags&128)===0}function Yy(u){if($n){var m=ci;if(m){var b=m;if(!PC(u,m)){if(Hy(u))throw Error(t(418));m=co(b.nextSibling);var k=li;m&&PC(u,m)?kC(k,b):(u.flags=u.flags&-4097|2,$n=!1,li=u)}}else{if(Hy(u))throw Error(t(418));u.flags=u.flags&-4097|2,$n=!1,li=u}}}function MC(u){for(u=u.return;u!==null&&u.tag!==5&&u.tag!==3&&u.tag!==13;)u=u.return;li=u}function Qm(u){if(u!==li)return!1;if(!$n)return MC(u),$n=!0,!1;var m;if((m=u.tag!==3)&&!(m=u.tag!==5)&&(m=u.type,m=m!=="head"&&m!=="body"&&!$t(u.type,u.memoizedProps)),m&&(m=ci)){if(Hy(u))throw EC(),Error(t(418));for(;m;)kC(u,m),m=co(m.nextSibling)}if(MC(u),u.tag===13){if(u=u.memoizedState,u=u!==null?u.dehydrated:null,!u)throw Error(t(317));e:{for(u=u.nextSibling,m=0;u;){if(u.nodeType===8){var b=u.data;if(b==="/$"){if(m===0){ci=co(u.nextSibling);break e}m--}else b!=="$"&&b!=="$!"&&b!=="$?"||m++}u=u.nextSibling}ci=null}}else ci=li?co(u.stateNode.nextSibling):null;return!0}function EC(){for(var u=ci;u;)u=co(u.nextSibling)}function Ru(){ci=li=null,$n=!1}function Gy(u){xa===null?xa=[u]:xa.push(u)}var tq=M.ReactCurrentBatchConfig;function sh(u,m,b){if(u=b.ref,u!==null&&typeof u!="function"&&typeof u!="object"){if(b._owner){if(b=b._owner,b){if(b.tag!==1)throw Error(t(309));var k=b.stateNode}if(!k)throw Error(t(147,u));var R=k,z=""+u;return m!==null&&m.ref!==null&&typeof m.ref=="function"&&m.ref._stringRef===z?m.ref:(m=function(J){var fe=R.refs;J===null?delete fe[z]:fe[z]=J},m._stringRef=z,m)}if(typeof u!="string")throw Error(t(284));if(!b._owner)throw Error(t(290,u))}return u}function Xm(u,m){throw u=Object.prototype.toString.call(m),Error(t(31,u==="[object Object]"?"object with keys {"+Object.keys(m).join(", ")+"}":u))}function DC(u){var m=u._init;return m(u._payload)}function OC(u){function m(Se,be){if(u){var Pe=Se.deletions;Pe===null?(Se.deletions=[be],Se.flags|=16):Pe.push(be)}}function b(Se,be){if(!u)return null;for(;be!==null;)m(Se,be),be=be.sibling;return null}function k(Se,be){for(Se=new Map;be!==null;)be.key!==null?Se.set(be.key,be):Se.set(be.index,be),be=be.sibling;return Se}function R(Se,be){return Se=wc(Se,be),Se.index=0,Se.sibling=null,Se}function z(Se,be,Pe){return Se.index=Pe,u?(Pe=Se.alternate,Pe!==null?(Pe=Pe.index,Pe<be?(Se.flags|=2,be):Pe):(Se.flags|=2,be)):(Se.flags|=1048576,be)}function J(Se){return u&&Se.alternate===null&&(Se.flags|=2),Se}function fe(Se,be,Pe,Je){return be===null||be.tag!==6?(be=qv(Pe,Se.mode,Je),be.return=Se,be):(be=R(be,Pe),be.return=Se,be)}function ge(Se,be,Pe,Je){var gt=Pe.type;return gt===F?Ge(Se,be,Pe.props.children,Je,Pe.key):be!==null&&(be.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===ee&&DC(gt)===be.type)?(Je=R(be,Pe.props),Je.ref=sh(Se,be,Pe),Je.return=Se,Je):(Je=jp(Pe.type,Pe.key,Pe.props,null,Se.mode,Je),Je.ref=sh(Se,be,Pe),Je.return=Se,Je)}function De(Se,be,Pe,Je){return be===null||be.tag!==4||be.stateNode.containerInfo!==Pe.containerInfo||be.stateNode.implementation!==Pe.implementation?(be=zv(Pe,Se.mode,Je),be.return=Se,be):(be=R(be,Pe.children||[]),be.return=Se,be)}function Ge(Se,be,Pe,Je,gt){return be===null||be.tag!==7?(be=Bd(Pe,Se.mode,Je,gt),be.return=Se,be):(be=R(be,Pe),be.return=Se,be)}function Ke(Se,be,Pe){if(typeof be=="string"&&be!==""||typeof be=="number")return be=qv(""+be,Se.mode,Pe),be.return=Se,be;if(typeof be=="object"&&be!==null){switch(be.$$typeof){case D:return Pe=jp(be.type,be.key,be.props,null,Se.mode,Pe),Pe.ref=sh(Se,null,be),Pe.return=Se,Pe;case I:return be=zv(be,Se.mode,Pe),be.return=Se,be;case ee:var Je=be._init;return Ke(Se,Je(be._payload),Pe)}if(X(be)||K(be))return be=Bd(be,Se.mode,Pe,null),be.return=Se,be;Xm(Se,be)}return null}function He(Se,be,Pe,Je){var gt=be!==null?be.key:null;if(typeof Pe=="string"&&Pe!==""||typeof Pe=="number")return gt!==null?null:fe(Se,be,""+Pe,Je);if(typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case D:return Pe.key===gt?ge(Se,be,Pe,Je):null;case I:return Pe.key===gt?De(Se,be,Pe,Je):null;case ee:return gt=Pe._init,He(Se,be,gt(Pe._payload),Je)}if(X(Pe)||K(Pe))return gt!==null?null:Ge(Se,be,Pe,Je,null);Xm(Se,Pe)}return null}function at(Se,be,Pe,Je,gt){if(typeof Je=="string"&&Je!==""||typeof Je=="number")return Se=Se.get(Pe)||null,fe(be,Se,""+Je,gt);if(typeof Je=="object"&&Je!==null){switch(Je.$$typeof){case D:return Se=Se.get(Je.key===null?Pe:Je.key)||null,ge(be,Se,Je,gt);case I:return Se=Se.get(Je.key===null?Pe:Je.key)||null,De(be,Se,Je,gt);case ee:var Tt=Je._init;return at(Se,be,Pe,Tt(Je._payload),gt)}if(X(Je)||K(Je))return Se=Se.get(Pe)||null,Ge(be,Se,Je,gt,null);Xm(be,Je)}return null}function ut(Se,be,Pe,Je){for(var gt=null,Tt=null,kt=be,Lt=be=0,Ir=null;kt!==null&&Lt<Pe.length;Lt++){kt.index>Lt?(Ir=kt,kt=null):Ir=kt.sibling;var dn=He(Se,kt,Pe[Lt],Je);if(dn===null){kt===null&&(kt=Ir);break}u&&kt&&dn.alternate===null&&m(Se,kt),be=z(dn,be,Lt),Tt===null?gt=dn:Tt.sibling=dn,Tt=dn,kt=Ir}if(Lt===Pe.length)return b(Se,kt),$n&&Id(Se,Lt),gt;if(kt===null){for(;Lt<Pe.length;Lt++)kt=Ke(Se,Pe[Lt],Je),kt!==null&&(be=z(kt,be,Lt),Tt===null?gt=kt:Tt.sibling=kt,Tt=kt);return $n&&Id(Se,Lt),gt}for(kt=k(Se,kt);Lt<Pe.length;Lt++)Ir=at(kt,Se,Lt,Pe[Lt],Je),Ir!==null&&(u&&Ir.alternate!==null&&kt.delete(Ir.key===null?Lt:Ir.key),be=z(Ir,be,Lt),Tt===null?gt=Ir:Tt.sibling=Ir,Tt=Ir);return u&&kt.forEach(function(_c){return m(Se,_c)}),$n&&Id(Se,Lt),gt}function mt(Se,be,Pe,Je){var gt=K(Pe);if(typeof gt!="function")throw Error(t(150));if(Pe=gt.call(Pe),Pe==null)throw Error(t(151));for(var Tt=gt=null,kt=be,Lt=be=0,Ir=null,dn=Pe.next();kt!==null&&!dn.done;Lt++,dn=Pe.next()){kt.index>Lt?(Ir=kt,kt=null):Ir=kt.sibling;var _c=He(Se,kt,dn.value,Je);if(_c===null){kt===null&&(kt=Ir);break}u&&kt&&_c.alternate===null&&m(Se,kt),be=z(_c,be,Lt),Tt===null?gt=_c:Tt.sibling=_c,Tt=_c,kt=Ir}if(dn.done)return b(Se,kt),$n&&Id(Se,Lt),gt;if(kt===null){for(;!dn.done;Lt++,dn=Pe.next())dn=Ke(Se,dn.value,Je),dn!==null&&(be=z(dn,be,Lt),Tt===null?gt=dn:Tt.sibling=dn,Tt=dn);return $n&&Id(Se,Lt),gt}for(kt=k(Se,kt);!dn.done;Lt++,dn=Pe.next())dn=at(kt,Se,Lt,dn.value,Je),dn!==null&&(u&&dn.alternate!==null&&kt.delete(dn.key===null?Lt:dn.key),be=z(dn,be,Lt),Tt===null?gt=dn:Tt.sibling=dn,Tt=dn);return u&&kt.forEach(function(Iq){return m(Se,Iq)}),$n&&Id(Se,Lt),gt}function ir(Se,be,Pe,Je){if(typeof Pe=="object"&&Pe!==null&&Pe.type===F&&Pe.key===null&&(Pe=Pe.props.children),typeof Pe=="object"&&Pe!==null){switch(Pe.$$typeof){case D:e:{for(var gt=Pe.key,Tt=be;Tt!==null;){if(Tt.key===gt){if(gt=Pe.type,gt===F){if(Tt.tag===7){b(Se,Tt.sibling),be=R(Tt,Pe.props.children),be.return=Se,Se=be;break e}}else if(Tt.elementType===gt||typeof gt=="object"&&gt!==null&&gt.$$typeof===ee&&DC(gt)===Tt.type){b(Se,Tt.sibling),be=R(Tt,Pe.props),be.ref=sh(Se,Tt,Pe),be.return=Se,Se=be;break e}b(Se,Tt);break}else m(Se,Tt);Tt=Tt.sibling}Pe.type===F?(be=Bd(Pe.props.children,Se.mode,Je,Pe.key),be.return=Se,Se=be):(Je=jp(Pe.type,Pe.key,Pe.props,null,Se.mode,Je),Je.ref=sh(Se,be,Pe),Je.return=Se,Se=Je)}return J(Se);case I:e:{for(Tt=Pe.key;be!==null;){if(be.key===Tt)if(be.tag===4&&be.stateNode.containerInfo===Pe.containerInfo&&be.stateNode.implementation===Pe.implementation){b(Se,be.sibling),be=R(be,Pe.children||[]),be.return=Se,Se=be;break e}else{b(Se,be);break}else m(Se,be);be=be.sibling}be=zv(Pe,Se.mode,Je),be.return=Se,Se=be}return J(Se);case ee:return Tt=Pe._init,ir(Se,be,Tt(Pe._payload),Je)}if(X(Pe))return ut(Se,be,Pe,Je);if(K(Pe))return mt(Se,be,Pe,Je);Xm(Se,Pe)}return typeof Pe=="string"&&Pe!==""||typeof Pe=="number"?(Pe=""+Pe,be!==null&&be.tag===6?(b(Se,be.sibling),be=R(be,Pe),be.return=Se,Se=be):(b(Se,be),be=qv(Pe,Se.mode,Je),be.return=Se,Se=be),J(Se)):b(Se,be)}return ir}var Lu=OC(!0),IC=OC(!1),ep=uc(null),tp=null,Fu=null,Zy=null;function Ky(){Zy=Fu=tp=null}function Jy(u){var m=ep.current;zn(ep),u._currentValue=m}function Qy(u,m,b){for(;u!==null;){var k=u.alternate;if((u.childLanes&m)!==m?(u.childLanes|=m,k!==null&&(k.childLanes|=m)):k!==null&&(k.childLanes&m)!==m&&(k.childLanes|=m),u===b)break;u=u.return}}function qu(u,m){tp=u,Zy=Fu=null,u=u.dependencies,u!==null&&u.firstContext!==null&&((u.lanes&m)!==0&&(Fs=!0),u.firstContext=null)}function qi(u){var m=u._currentValue;if(Zy!==u)if(u={context:u,memoizedValue:m,next:null},Fu===null){if(tp===null)throw Error(t(308));Fu=u,tp.dependencies={lanes:0,firstContext:u}}else Fu=Fu.next=u;return m}var Ad=null;function Xy(u){Ad===null?Ad=[u]:Ad.push(u)}function AC(u,m,b,k){var R=m.interleaved;return R===null?(b.next=b,Xy(m)):(b.next=R.next,R.next=b),m.interleaved=b,ol(u,k)}function ol(u,m){u.lanes|=m;var b=u.alternate;for(b!==null&&(b.lanes|=m),b=u,u=u.return;u!==null;)u.childLanes|=m,b=u.alternate,b!==null&&(b.childLanes|=m),b=u,u=u.return;return b.tag===3?b.stateNode:null}var mc=!1;function ev(u){u.updateQueue={baseState:u.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function RC(u,m){u=u.updateQueue,m.updateQueue===u&&(m.updateQueue={baseState:u.baseState,firstBaseUpdate:u.firstBaseUpdate,lastBaseUpdate:u.lastBaseUpdate,shared:u.shared,effects:u.effects})}function ll(u,m){return{eventTime:u,lane:m,tag:0,payload:null,callback:null,next:null}}function pc(u,m,b){var k=u.updateQueue;if(k===null)return null;if(k=k.shared,(ln&2)!==0){var R=k.pending;return R===null?m.next=m:(m.next=R.next,R.next=m),k.pending=m,ol(u,b)}return R=k.interleaved,R===null?(m.next=m,Xy(k)):(m.next=R.next,R.next=m),k.interleaved=m,ol(u,b)}function np(u,m,b){if(m=m.updateQueue,m!==null&&(m=m.shared,(b&4194240)!==0)){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,ms(u,b)}}function LC(u,m){var b=u.updateQueue,k=u.alternate;if(k!==null&&(k=k.updateQueue,b===k)){var R=null,z=null;if(b=b.firstBaseUpdate,b!==null){do{var J={eventTime:b.eventTime,lane:b.lane,tag:b.tag,payload:b.payload,callback:b.callback,next:null};z===null?R=z=J:z=z.next=J,b=b.next}while(b!==null);z===null?R=z=m:z=z.next=m}else R=z=m;b={baseState:k.baseState,firstBaseUpdate:R,lastBaseUpdate:z,shared:k.shared,effects:k.effects},u.updateQueue=b;return}u=b.lastBaseUpdate,u===null?b.firstBaseUpdate=m:u.next=m,b.lastBaseUpdate=m}function rp(u,m,b,k){var R=u.updateQueue;mc=!1;var z=R.firstBaseUpdate,J=R.lastBaseUpdate,fe=R.shared.pending;if(fe!==null){R.shared.pending=null;var ge=fe,De=ge.next;ge.next=null,J===null?z=De:J.next=De,J=ge;var Ge=u.alternate;Ge!==null&&(Ge=Ge.updateQueue,fe=Ge.lastBaseUpdate,fe!==J&&(fe===null?Ge.firstBaseUpdate=De:fe.next=De,Ge.lastBaseUpdate=ge))}if(z!==null){var Ke=R.baseState;J=0,Ge=De=ge=null,fe=z;do{var He=fe.lane,at=fe.eventTime;if((k&He)===He){Ge!==null&&(Ge=Ge.next={eventTime:at,lane:0,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null});e:{var ut=u,mt=fe;switch(He=m,at=b,mt.tag){case 1:if(ut=mt.payload,typeof ut=="function"){Ke=ut.call(at,Ke,He);break e}Ke=ut;break e;case 3:ut.flags=ut.flags&-65537|128;case 0:if(ut=mt.payload,He=typeof ut=="function"?ut.call(at,Ke,He):ut,He==null)break e;Ke=re({},Ke,He);break e;case 2:mc=!0}}fe.callback!==null&&fe.lane!==0&&(u.flags|=64,He=R.effects,He===null?R.effects=[fe]:He.push(fe))}else at={eventTime:at,lane:He,tag:fe.tag,payload:fe.payload,callback:fe.callback,next:null},Ge===null?(De=Ge=at,ge=Ke):Ge=Ge.next=at,J|=He;if(fe=fe.next,fe===null){if(fe=R.shared.pending,fe===null)break;He=fe,fe=He.next,He.next=null,R.lastBaseUpdate=He,R.shared.pending=null}}while(!0);if(Ge===null&&(ge=Ke),R.baseState=ge,R.firstBaseUpdate=De,R.lastBaseUpdate=Ge,m=R.shared.interleaved,m!==null){R=m;do J|=R.lane,R=R.next;while(R!==m)}else z===null&&(R.shared.lanes=0);Fd|=J,u.lanes=J,u.memoizedState=Ke}}function FC(u,m,b){if(u=m.effects,m.effects=null,u!==null)for(m=0;m<u.length;m++){var k=u[m],R=k.callback;if(R!==null){if(k.callback=null,k=b,typeof R!="function")throw Error(t(191,R));R.call(k)}}}var ih={},uo=uc(ih),ah=uc(ih),oh=uc(ih);function Rd(u){if(u===ih)throw Error(t(174));return u}function tv(u,m){switch(Rn(oh,m),Rn(ah,u),Rn(uo,ih),u=m.nodeType,u){case 9:case 11:m=(m=m.documentElement)?m.namespaceURI:tt(null,"");break;default:u=u===8?m.parentNode:m,m=u.namespaceURI||null,u=u.tagName,m=tt(m,u)}zn(uo),Rn(uo,m)}function zu(){zn(uo),zn(ah),zn(oh)}function qC(u){Rd(oh.current);var m=Rd(uo.current),b=tt(m,u.type);m!==b&&(Rn(ah,u),Rn(uo,b))}function nv(u){ah.current===u&&(zn(uo),zn(ah))}var Zn=uc(0);function sp(u){for(var m=u;m!==null;){if(m.tag===13){var b=m.memoizedState;if(b!==null&&(b=b.dehydrated,b===null||b.data==="$?"||b.data==="$!"))return m}else if(m.tag===19&&m.memoizedProps.revealOrder!==void 0){if((m.flags&128)!==0)return m}else if(m.child!==null){m.child.return=m,m=m.child;continue}if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return null;m=m.return}m.sibling.return=m.return,m=m.sibling}return null}var rv=[];function sv(){for(var u=0;u<rv.length;u++)rv[u]._workInProgressVersionPrimary=null;rv.length=0}var ip=M.ReactCurrentDispatcher,iv=M.ReactCurrentBatchConfig,Ld=0,Kn=null,Nr=null,Dr=null,ap=!1,lh=!1,ch=0,nq=0;function rs(){throw Error(t(321))}function av(u,m){if(m===null)return!1;for(var b=0;b<m.length&&b<u.length;b++)if(!Wr(u[b],m[b]))return!1;return!0}function ov(u,m,b,k,R,z){if(Ld=z,Kn=m,m.memoizedState=null,m.updateQueue=null,m.lanes=0,ip.current=u===null||u.memoizedState===null?aq:oq,u=b(k,R),lh){z=0;do{if(lh=!1,ch=0,25<=z)throw Error(t(301));z+=1,Dr=Nr=null,m.updateQueue=null,ip.current=lq,u=b(k,R)}while(lh)}if(ip.current=cp,m=Nr!==null&&Nr.next!==null,Ld=0,Dr=Nr=Kn=null,ap=!1,m)throw Error(t(300));return u}function lv(){var u=ch!==0;return ch=0,u}function fo(){var u={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Dr===null?Kn.memoizedState=Dr=u:Dr=Dr.next=u,Dr}function zi(){if(Nr===null){var u=Kn.alternate;u=u!==null?u.memoizedState:null}else u=Nr.next;var m=Dr===null?Kn.memoizedState:Dr.next;if(m!==null)Dr=m,Nr=u;else{if(u===null)throw Error(t(310));Nr=u,u={memoizedState:Nr.memoizedState,baseState:Nr.baseState,baseQueue:Nr.baseQueue,queue:Nr.queue,next:null},Dr===null?Kn.memoizedState=Dr=u:Dr=Dr.next=u}return Dr}function dh(u,m){return typeof m=="function"?m(u):m}function cv(u){var m=zi(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=Nr,R=k.baseQueue,z=b.pending;if(z!==null){if(R!==null){var J=R.next;R.next=z.next,z.next=J}k.baseQueue=R=z,b.pending=null}if(R!==null){z=R.next,k=k.baseState;var fe=J=null,ge=null,De=z;do{var Ge=De.lane;if((Ld&Ge)===Ge)ge!==null&&(ge=ge.next={lane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),k=De.hasEagerState?De.eagerState:u(k,De.action);else{var Ke={lane:Ge,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null};ge===null?(fe=ge=Ke,J=k):ge=ge.next=Ke,Kn.lanes|=Ge,Fd|=Ge}De=De.next}while(De!==null&&De!==z);ge===null?J=k:ge.next=fe,Wr(k,m.memoizedState)||(Fs=!0),m.memoizedState=k,m.baseState=J,m.baseQueue=ge,b.lastRenderedState=k}if(u=b.interleaved,u!==null){R=u;do z=R.lane,Kn.lanes|=z,Fd|=z,R=R.next;while(R!==u)}else R===null&&(b.lanes=0);return[m.memoizedState,b.dispatch]}function dv(u){var m=zi(),b=m.queue;if(b===null)throw Error(t(311));b.lastRenderedReducer=u;var k=b.dispatch,R=b.pending,z=m.memoizedState;if(R!==null){b.pending=null;var J=R=R.next;do z=u(z,J.action),J=J.next;while(J!==R);Wr(z,m.memoizedState)||(Fs=!0),m.memoizedState=z,m.baseQueue===null&&(m.baseState=z),b.lastRenderedState=z}return[z,k]}function zC(){}function UC(u,m){var b=Kn,k=zi(),R=m(),z=!Wr(k.memoizedState,R);if(z&&(k.memoizedState=R,Fs=!0),k=k.queue,uv(WC.bind(null,b,k,u),[u]),k.getSnapshot!==m||z||Dr!==null&&Dr.memoizedState.tag&1){if(b.flags|=2048,uh(9,VC.bind(null,b,k,R,m),void 0,null),Or===null)throw Error(t(349));(Ld&30)!==0||BC(b,m,R)}return R}function BC(u,m,b){u.flags|=16384,u={getSnapshot:m,value:b},m=Kn.updateQueue,m===null?(m={lastEffect:null,stores:null},Kn.updateQueue=m,m.stores=[u]):(b=m.stores,b===null?m.stores=[u]:b.push(u))}function VC(u,m,b,k){m.value=b,m.getSnapshot=k,$C(m)&&HC(u)}function WC(u,m,b){return b(function(){$C(m)&&HC(u)})}function $C(u){var m=u.getSnapshot;u=u.value;try{var b=m();return!Wr(u,b)}catch{return!0}}function HC(u){var m=ol(u,1);m!==null&&wa(m,u,1,-1)}function YC(u){var m=fo();return typeof u=="function"&&(u=u()),m.memoizedState=m.baseState=u,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:dh,lastRenderedState:u},m.queue=u,u=u.dispatch=iq.bind(null,Kn,u),[m.memoizedState,u]}function uh(u,m,b,k){return u={tag:u,create:m,destroy:b,deps:k,next:null},m=Kn.updateQueue,m===null?(m={lastEffect:null,stores:null},Kn.updateQueue=m,m.lastEffect=u.next=u):(b=m.lastEffect,b===null?m.lastEffect=u.next=u:(k=b.next,b.next=u,u.next=k,m.lastEffect=u)),u}function GC(){return zi().memoizedState}function op(u,m,b,k){var R=fo();Kn.flags|=u,R.memoizedState=uh(1|m,b,void 0,k===void 0?null:k)}function lp(u,m,b,k){var R=zi();k=k===void 0?null:k;var z=void 0;if(Nr!==null){var J=Nr.memoizedState;if(z=J.destroy,k!==null&&av(k,J.deps)){R.memoizedState=uh(m,b,z,k);return}}Kn.flags|=u,R.memoizedState=uh(1|m,b,z,k)}function ZC(u,m){return op(8390656,8,u,m)}function uv(u,m){return lp(2048,8,u,m)}function KC(u,m){return lp(4,2,u,m)}function JC(u,m){return lp(4,4,u,m)}function QC(u,m){if(typeof m=="function")return u=u(),m(u),function(){m(null)};if(m!=null)return u=u(),m.current=u,function(){m.current=null}}function XC(u,m,b){return b=b!=null?b.concat([u]):null,lp(4,4,QC.bind(null,m,u),b)}function fv(){}function eT(u,m){var b=zi();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&av(m,k[1])?k[0]:(b.memoizedState=[u,m],u)}function tT(u,m){var b=zi();m=m===void 0?null:m;var k=b.memoizedState;return k!==null&&m!==null&&av(m,k[1])?k[0]:(u=u(),b.memoizedState=[u,m],u)}function nT(u,m,b){return(Ld&21)===0?(u.baseState&&(u.baseState=!1,Fs=!0),u.memoizedState=b):(Wr(b,m)||(b=zl(),Kn.lanes|=b,Fd|=b,u.baseState=!0),m)}function rq(u,m){var b=Kt;Kt=b!==0&&4>b?b:4,u(!0);var k=iv.transition;iv.transition={};try{u(!1),m()}finally{Kt=b,iv.transition=k}}function rT(){return zi().memoizedState}function sq(u,m,b){var k=vc(u);if(b={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null},sT(u))iT(m,b);else if(b=AC(u,m,b,k),b!==null){var R=ws();wa(b,u,k,R),aT(b,m,k)}}function iq(u,m,b){var k=vc(u),R={lane:k,action:b,hasEagerState:!1,eagerState:null,next:null};if(sT(u))iT(m,R);else{var z=u.alternate;if(u.lanes===0&&(z===null||z.lanes===0)&&(z=m.lastRenderedReducer,z!==null))try{var J=m.lastRenderedState,fe=z(J,b);if(R.hasEagerState=!0,R.eagerState=fe,Wr(fe,J)){var ge=m.interleaved;ge===null?(R.next=R,Xy(m)):(R.next=ge.next,ge.next=R),m.interleaved=R;return}}catch{}finally{}b=AC(u,m,R,k),b!==null&&(R=ws(),wa(b,u,k,R),aT(b,m,k))}}function sT(u){var m=u.alternate;return u===Kn||m!==null&&m===Kn}function iT(u,m){lh=ap=!0;var b=u.pending;b===null?m.next=m:(m.next=b.next,b.next=m),u.pending=m}function aT(u,m,b){if((b&4194240)!==0){var k=m.lanes;k&=u.pendingLanes,b|=k,m.lanes=b,ms(u,b)}}var cp={readContext:qi,useCallback:rs,useContext:rs,useEffect:rs,useImperativeHandle:rs,useInsertionEffect:rs,useLayoutEffect:rs,useMemo:rs,useReducer:rs,useRef:rs,useState:rs,useDebugValue:rs,useDeferredValue:rs,useTransition:rs,useMutableSource:rs,useSyncExternalStore:rs,useId:rs,unstable_isNewReconciler:!1},aq={readContext:qi,useCallback:function(u,m){return fo().memoizedState=[u,m===void 0?null:m],u},useContext:qi,useEffect:ZC,useImperativeHandle:function(u,m,b){return b=b!=null?b.concat([u]):null,op(4194308,4,QC.bind(null,m,u),b)},useLayoutEffect:function(u,m){return op(4194308,4,u,m)},useInsertionEffect:function(u,m){return op(4,2,u,m)},useMemo:function(u,m){var b=fo();return m=m===void 0?null:m,u=u(),b.memoizedState=[u,m],u},useReducer:function(u,m,b){var k=fo();return m=b!==void 0?b(m):m,k.memoizedState=k.baseState=m,u={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:u,lastRenderedState:m},k.queue=u,u=u.dispatch=sq.bind(null,Kn,u),[k.memoizedState,u]},useRef:function(u){var m=fo();return u={current:u},m.memoizedState=u},useState:YC,useDebugValue:fv,useDeferredValue:function(u){return fo().memoizedState=u},useTransition:function(){var u=YC(!1),m=u[0];return u=rq.bind(null,u[1]),fo().memoizedState=u,[m,u]},useMutableSource:function(){},useSyncExternalStore:function(u,m,b){var k=Kn,R=fo();if($n){if(b===void 0)throw Error(t(407));b=b()}else{if(b=m(),Or===null)throw Error(t(349));(Ld&30)!==0||BC(k,m,b)}R.memoizedState=b;var z={value:b,getSnapshot:m};return R.queue=z,ZC(WC.bind(null,k,z,u),[u]),k.flags|=2048,uh(9,VC.bind(null,k,z,b,m),void 0,null),b},useId:function(){var u=fo(),m=Or.identifierPrefix;if($n){var b=al,k=il;b=(k&~(1<<32-Ot(k)-1)).toString(32)+b,m=":"+m+"R"+b,b=ch++,0<b&&(m+="H"+b.toString(32)),m+=":"}else b=nq++,m=":"+m+"r"+b.toString(32)+":";return u.memoizedState=m},unstable_isNewReconciler:!1},oq={readContext:qi,useCallback:eT,useContext:qi,useEffect:uv,useImperativeHandle:XC,useInsertionEffect:KC,useLayoutEffect:JC,useMemo:tT,useReducer:cv,useRef:GC,useState:function(){return cv(dh)},useDebugValue:fv,useDeferredValue:function(u){var m=zi();return nT(m,Nr.memoizedState,u)},useTransition:function(){var u=cv(dh)[0],m=zi().memoizedState;return[u,m]},useMutableSource:zC,useSyncExternalStore:UC,useId:rT,unstable_isNewReconciler:!1},lq={readContext:qi,useCallback:eT,useContext:qi,useEffect:uv,useImperativeHandle:XC,useInsertionEffect:KC,useLayoutEffect:JC,useMemo:tT,useReducer:dv,useRef:GC,useState:function(){return dv(dh)},useDebugValue:fv,useDeferredValue:function(u){var m=zi();return Nr===null?m.memoizedState=u:nT(m,Nr.memoizedState,u)},useTransition:function(){var u=dv(dh)[0],m=zi().memoizedState;return[u,m]},useMutableSource:zC,useSyncExternalStore:UC,useId:rT,unstable_isNewReconciler:!1};function ya(u,m){if(u&&u.defaultProps){m=re({},m),u=u.defaultProps;for(var b in u)m[b]===void 0&&(m[b]=u[b]);return m}return m}function hv(u,m,b,k){m=u.memoizedState,b=b(k,m),b=b==null?m:re({},m,b),u.memoizedState=b,u.lanes===0&&(u.updateQueue.baseState=b)}var dp={isMounted:function(u){return(u=u._reactInternals)?Ms(u)===u:!1},enqueueSetState:function(u,m,b){u=u._reactInternals;var k=ws(),R=vc(u),z=ll(k,R);z.payload=m,b!=null&&(z.callback=b),m=pc(u,z,R),m!==null&&(wa(m,u,R,k),np(m,u,R))},enqueueReplaceState:function(u,m,b){u=u._reactInternals;var k=ws(),R=vc(u),z=ll(k,R);z.tag=1,z.payload=m,b!=null&&(z.callback=b),m=pc(u,z,R),m!==null&&(wa(m,u,R,k),np(m,u,R))},enqueueForceUpdate:function(u,m){u=u._reactInternals;var b=ws(),k=vc(u),R=ll(b,k);R.tag=2,m!=null&&(R.callback=m),m=pc(u,R,k),m!==null&&(wa(m,u,k,b),np(m,u,k))}};function oT(u,m,b,k,R,z,J){return u=u.stateNode,typeof u.shouldComponentUpdate=="function"?u.shouldComponentUpdate(k,z,J):m.prototype&&m.prototype.isPureReactComponent?!As(b,k)||!As(R,z):!0}function lT(u,m,b){var k=!1,R=fc,z=m.contextType;return typeof z=="object"&&z!==null?z=qi(z):(R=Ls(m)?Dd:ns.current,k=m.contextTypes,z=(k=k!=null)?Ou(u,R):fc),m=new m(b,z),u.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=dp,u.stateNode=m,m._reactInternals=u,k&&(u=u.stateNode,u.__reactInternalMemoizedUnmaskedChildContext=R,u.__reactInternalMemoizedMaskedChildContext=z),m}function cT(u,m,b,k){u=m.state,typeof m.componentWillReceiveProps=="function"&&m.componentWillReceiveProps(b,k),typeof m.UNSAFE_componentWillReceiveProps=="function"&&m.UNSAFE_componentWillReceiveProps(b,k),m.state!==u&&dp.enqueueReplaceState(m,m.state,null)}function mv(u,m,b,k){var R=u.stateNode;R.props=b,R.state=u.memoizedState,R.refs={},ev(u);var z=m.contextType;typeof z=="object"&&z!==null?R.context=qi(z):(z=Ls(m)?Dd:ns.current,R.context=Ou(u,z)),R.state=u.memoizedState,z=m.getDerivedStateFromProps,typeof z=="function"&&(hv(u,m,z,b),R.state=u.memoizedState),typeof m.getDerivedStateFromProps=="function"||typeof R.getSnapshotBeforeUpdate=="function"||typeof R.UNSAFE_componentWillMount!="function"&&typeof R.componentWillMount!="function"||(m=R.state,typeof R.componentWillMount=="function"&&R.componentWillMount(),typeof R.UNSAFE_componentWillMount=="function"&&R.UNSAFE_componentWillMount(),m!==R.state&&dp.enqueueReplaceState(R,R.state,null),rp(u,b,R,k),R.state=u.memoizedState),typeof R.componentDidMount=="function"&&(u.flags|=4194308)}function Uu(u,m){try{var b="",k=m;do b+=oe(k),k=k.return;while(k);var R=b}catch(z){R=`
Error generating stack: `+z.message+`
`+z.stack}return{value:u,source:m,stack:R,digest:null}}function pv(u,m,b){return{value:u,source:null,stack:b??null,digest:m??null}}function gv(u,m){try{console.error(m.value)}catch(b){setTimeout(function(){throw b})}}var cq=typeof WeakMap=="function"?WeakMap:Map;function dT(u,m,b){b=ll(-1,b),b.tag=3,b.payload={element:null};var k=m.value;return b.callback=function(){xp||(xp=!0,Ev=k),gv(u,m)},b}function uT(u,m,b){b=ll(-1,b),b.tag=3;var k=u.type.getDerivedStateFromError;if(typeof k=="function"){var R=m.value;b.payload=function(){return k(R)},b.callback=function(){gv(u,m)}}var z=u.stateNode;return z!==null&&typeof z.componentDidCatch=="function"&&(b.callback=function(){gv(u,m),typeof k!="function"&&(xc===null?xc=new Set([this]):xc.add(this));var J=m.stack;this.componentDidCatch(m.value,{componentStack:J!==null?J:""})}),b}function fT(u,m,b){var k=u.pingCache;if(k===null){k=u.pingCache=new cq;var R=new Set;k.set(m,R)}else R=k.get(m),R===void 0&&(R=new Set,k.set(m,R));R.has(b)||(R.add(b),u=jq.bind(null,u,m,b),m.then(u,u))}function hT(u){do{var m;if((m=u.tag===13)&&(m=u.memoizedState,m=m!==null?m.dehydrated!==null:!0),m)return u;u=u.return}while(u!==null);return null}function mT(u,m,b,k,R){return(u.mode&1)===0?(u===m?u.flags|=65536:(u.flags|=128,b.flags|=131072,b.flags&=-52805,b.tag===1&&(b.alternate===null?b.tag=17:(m=ll(-1,1),m.tag=2,pc(b,m,1))),b.lanes|=1),u):(u.flags|=65536,u.lanes=R,u)}var dq=M.ReactCurrentOwner,Fs=!1;function bs(u,m,b,k){m.child=u===null?IC(m,null,b,k):Lu(m,u.child,b,k)}function pT(u,m,b,k,R){b=b.render;var z=m.ref;return qu(m,R),k=ov(u,m,b,k,z,R),b=lv(),u!==null&&!Fs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,cl(u,m,R)):($n&&b&&Wy(m),m.flags|=1,bs(u,m,k,R),m.child)}function gT(u,m,b,k,R){if(u===null){var z=b.type;return typeof z=="function"&&!Fv(z)&&z.defaultProps===void 0&&b.compare===null&&b.defaultProps===void 0?(m.tag=15,m.type=z,xT(u,m,z,k,R)):(u=jp(b.type,null,k,m,m.mode,R),u.ref=m.ref,u.return=m,m.child=u)}if(z=u.child,(u.lanes&R)===0){var J=z.memoizedProps;if(b=b.compare,b=b!==null?b:As,b(J,k)&&u.ref===m.ref)return cl(u,m,R)}return m.flags|=1,u=wc(z,k),u.ref=m.ref,u.return=m,m.child=u}function xT(u,m,b,k,R){if(u!==null){var z=u.memoizedProps;if(As(z,k)&&u.ref===m.ref)if(Fs=!1,m.pendingProps=k=z,(u.lanes&R)!==0)(u.flags&131072)!==0&&(Fs=!0);else return m.lanes=u.lanes,cl(u,m,R)}return xv(u,m,b,k,R)}function yT(u,m,b){var k=m.pendingProps,R=k.children,z=u!==null?u.memoizedState:null;if(k.mode==="hidden")if((m.mode&1)===0)m.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rn(Vu,di),di|=b;else{if((b&1073741824)===0)return u=z!==null?z.baseLanes|b:b,m.lanes=m.childLanes=1073741824,m.memoizedState={baseLanes:u,cachePool:null,transitions:null},m.updateQueue=null,Rn(Vu,di),di|=u,null;m.memoizedState={baseLanes:0,cachePool:null,transitions:null},k=z!==null?z.baseLanes:b,Rn(Vu,di),di|=k}else z!==null?(k=z.baseLanes|b,m.memoizedState=null):k=b,Rn(Vu,di),di|=k;return bs(u,m,R,b),m.child}function vT(u,m){var b=m.ref;(u===null&&b!==null||u!==null&&u.ref!==b)&&(m.flags|=512,m.flags|=2097152)}function xv(u,m,b,k,R){var z=Ls(b)?Dd:ns.current;return z=Ou(m,z),qu(m,R),b=ov(u,m,b,k,z,R),k=lv(),u!==null&&!Fs?(m.updateQueue=u.updateQueue,m.flags&=-2053,u.lanes&=~R,cl(u,m,R)):($n&&k&&Wy(m),m.flags|=1,bs(u,m,b,R),m.child)}function bT(u,m,b,k,R){if(Ls(b)){var z=!0;Gm(m)}else z=!1;if(qu(m,R),m.stateNode===null)fp(u,m),lT(m,b,k),mv(m,b,k,R),k=!0;else if(u===null){var J=m.stateNode,fe=m.memoizedProps;J.props=fe;var ge=J.context,De=b.contextType;typeof De=="object"&&De!==null?De=qi(De):(De=Ls(b)?Dd:ns.current,De=Ou(m,De));var Ge=b.getDerivedStateFromProps,Ke=typeof Ge=="function"||typeof J.getSnapshotBeforeUpdate=="function";Ke||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(fe!==k||ge!==De)&&cT(m,J,k,De),mc=!1;var He=m.memoizedState;J.state=He,rp(m,k,J,R),ge=m.memoizedState,fe!==k||He!==ge||Rs.current||mc?(typeof Ge=="function"&&(hv(m,b,Ge,k),ge=m.memoizedState),(fe=mc||oT(m,b,fe,k,He,ge,De))?(Ke||typeof J.UNSAFE_componentWillMount!="function"&&typeof J.componentWillMount!="function"||(typeof J.componentWillMount=="function"&&J.componentWillMount(),typeof J.UNSAFE_componentWillMount=="function"&&J.UNSAFE_componentWillMount()),typeof J.componentDidMount=="function"&&(m.flags|=4194308)):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),m.memoizedProps=k,m.memoizedState=ge),J.props=k,J.state=ge,J.context=De,k=fe):(typeof J.componentDidMount=="function"&&(m.flags|=4194308),k=!1)}else{J=m.stateNode,RC(u,m),fe=m.memoizedProps,De=m.type===m.elementType?fe:ya(m.type,fe),J.props=De,Ke=m.pendingProps,He=J.context,ge=b.contextType,typeof ge=="object"&&ge!==null?ge=qi(ge):(ge=Ls(b)?Dd:ns.current,ge=Ou(m,ge));var at=b.getDerivedStateFromProps;(Ge=typeof at=="function"||typeof J.getSnapshotBeforeUpdate=="function")||typeof J.UNSAFE_componentWillReceiveProps!="function"&&typeof J.componentWillReceiveProps!="function"||(fe!==Ke||He!==ge)&&cT(m,J,k,ge),mc=!1,He=m.memoizedState,J.state=He,rp(m,k,J,R);var ut=m.memoizedState;fe!==Ke||He!==ut||Rs.current||mc?(typeof at=="function"&&(hv(m,b,at,k),ut=m.memoizedState),(De=mc||oT(m,b,De,k,He,ut,ge)||!1)?(Ge||typeof J.UNSAFE_componentWillUpdate!="function"&&typeof J.componentWillUpdate!="function"||(typeof J.componentWillUpdate=="function"&&J.componentWillUpdate(k,ut,ge),typeof J.UNSAFE_componentWillUpdate=="function"&&J.UNSAFE_componentWillUpdate(k,ut,ge)),typeof J.componentDidUpdate=="function"&&(m.flags|=4),typeof J.getSnapshotBeforeUpdate=="function"&&(m.flags|=1024)):(typeof J.componentDidUpdate!="function"||fe===u.memoizedProps&&He===u.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&He===u.memoizedState||(m.flags|=1024),m.memoizedProps=k,m.memoizedState=ut),J.props=k,J.state=ut,J.context=ge,k=De):(typeof J.componentDidUpdate!="function"||fe===u.memoizedProps&&He===u.memoizedState||(m.flags|=4),typeof J.getSnapshotBeforeUpdate!="function"||fe===u.memoizedProps&&He===u.memoizedState||(m.flags|=1024),k=!1)}return yv(u,m,b,k,z,R)}function yv(u,m,b,k,R,z){vT(u,m);var J=(m.flags&128)!==0;if(!k&&!J)return R&&SC(m,b,!1),cl(u,m,z);k=m.stateNode,dq.current=m;var fe=J&&typeof b.getDerivedStateFromError!="function"?null:k.render();return m.flags|=1,u!==null&&J?(m.child=Lu(m,u.child,null,z),m.child=Lu(m,null,fe,z)):bs(u,m,fe,z),m.memoizedState=k.state,R&&SC(m,b,!0),m.child}function wT(u){var m=u.stateNode;m.pendingContext?jC(u,m.pendingContext,m.pendingContext!==m.context):m.context&&jC(u,m.context,!1),tv(u,m.containerInfo)}function _T(u,m,b,k,R){return Ru(),Gy(R),m.flags|=256,bs(u,m,b,k),m.child}var vv={dehydrated:null,treeContext:null,retryLane:0};function bv(u){return{baseLanes:u,cachePool:null,transitions:null}}function jT(u,m,b){var k=m.pendingProps,R=Zn.current,z=!1,J=(m.flags&128)!==0,fe;if((fe=J)||(fe=u!==null&&u.memoizedState===null?!1:(R&2)!==0),fe?(z=!0,m.flags&=-129):(u===null||u.memoizedState!==null)&&(R|=1),Rn(Zn,R&1),u===null)return Yy(m),u=m.memoizedState,u!==null&&(u=u.dehydrated,u!==null)?((m.mode&1)===0?m.lanes=1:u.data==="$!"?m.lanes=8:m.lanes=1073741824,null):(J=k.children,u=k.fallback,z?(k=m.mode,z=m.child,J={mode:"hidden",children:J},(k&1)===0&&z!==null?(z.childLanes=0,z.pendingProps=J):z=Np(J,k,0,null),u=Bd(u,k,b,null),z.return=m,u.return=m,z.sibling=u,m.child=z,m.child.memoizedState=bv(b),m.memoizedState=vv,u):wv(m,J));if(R=u.memoizedState,R!==null&&(fe=R.dehydrated,fe!==null))return uq(u,m,J,k,fe,R,b);if(z){z=k.fallback,J=m.mode,R=u.child,fe=R.sibling;var ge={mode:"hidden",children:k.children};return(J&1)===0&&m.child!==R?(k=m.child,k.childLanes=0,k.pendingProps=ge,m.deletions=null):(k=wc(R,ge),k.subtreeFlags=R.subtreeFlags&14680064),fe!==null?z=wc(fe,z):(z=Bd(z,J,b,null),z.flags|=2),z.return=m,k.return=m,k.sibling=z,m.child=k,k=z,z=m.child,J=u.child.memoizedState,J=J===null?bv(b):{baseLanes:J.baseLanes|b,cachePool:null,transitions:J.transitions},z.memoizedState=J,z.childLanes=u.childLanes&~b,m.memoizedState=vv,k}return z=u.child,u=z.sibling,k=wc(z,{mode:"visible",children:k.children}),(m.mode&1)===0&&(k.lanes=b),k.return=m,k.sibling=null,u!==null&&(b=m.deletions,b===null?(m.deletions=[u],m.flags|=16):b.push(u)),m.child=k,m.memoizedState=null,k}function wv(u,m){return m=Np({mode:"visible",children:m},u.mode,0,null),m.return=u,u.child=m}function up(u,m,b,k){return k!==null&&Gy(k),Lu(m,u.child,null,b),u=wv(m,m.pendingProps.children),u.flags|=2,m.memoizedState=null,u}function uq(u,m,b,k,R,z,J){if(b)return m.flags&256?(m.flags&=-257,k=pv(Error(t(422))),up(u,m,J,k)):m.memoizedState!==null?(m.child=u.child,m.flags|=128,null):(z=k.fallback,R=m.mode,k=Np({mode:"visible",children:k.children},R,0,null),z=Bd(z,R,J,null),z.flags|=2,k.return=m,z.return=m,k.sibling=z,m.child=k,(m.mode&1)!==0&&Lu(m,u.child,null,J),m.child.memoizedState=bv(J),m.memoizedState=vv,z);if((m.mode&1)===0)return up(u,m,J,null);if(R.data==="$!"){if(k=R.nextSibling&&R.nextSibling.dataset,k)var fe=k.dgst;return k=fe,z=Error(t(419)),k=pv(z,k,void 0),up(u,m,J,k)}if(fe=(J&u.childLanes)!==0,Fs||fe){if(k=Or,k!==null){switch(J&-J){case 4:R=2;break;case 16:R=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:R=32;break;case 536870912:R=268435456;break;default:R=0}R=(R&(k.suspendedLanes|J))!==0?0:R,R!==0&&R!==z.retryLane&&(z.retryLane=R,ol(u,R),wa(k,u,R,-1))}return Lv(),k=pv(Error(t(421))),up(u,m,J,k)}return R.data==="$?"?(m.flags|=128,m.child=u.child,m=Nq.bind(null,u),R._reactRetry=m,null):(u=z.treeContext,ci=co(R.nextSibling),li=m,$n=!0,xa=null,u!==null&&(Li[Fi++]=il,Li[Fi++]=al,Li[Fi++]=Od,il=u.id,al=u.overflow,Od=m),m=wv(m,k.children),m.flags|=4096,m)}function NT(u,m,b){u.lanes|=m;var k=u.alternate;k!==null&&(k.lanes|=m),Qy(u.return,m,b)}function _v(u,m,b,k,R){var z=u.memoizedState;z===null?u.memoizedState={isBackwards:m,rendering:null,renderingStartTime:0,last:k,tail:b,tailMode:R}:(z.isBackwards=m,z.rendering=null,z.renderingStartTime=0,z.last=k,z.tail=b,z.tailMode=R)}function ST(u,m,b){var k=m.pendingProps,R=k.revealOrder,z=k.tail;if(bs(u,m,k.children,b),k=Zn.current,(k&2)!==0)k=k&1|2,m.flags|=128;else{if(u!==null&&(u.flags&128)!==0)e:for(u=m.child;u!==null;){if(u.tag===13)u.memoizedState!==null&&NT(u,b,m);else if(u.tag===19)NT(u,b,m);else if(u.child!==null){u.child.return=u,u=u.child;continue}if(u===m)break e;for(;u.sibling===null;){if(u.return===null||u.return===m)break e;u=u.return}u.sibling.return=u.return,u=u.sibling}k&=1}if(Rn(Zn,k),(m.mode&1)===0)m.memoizedState=null;else switch(R){case"forwards":for(b=m.child,R=null;b!==null;)u=b.alternate,u!==null&&sp(u)===null&&(R=b),b=b.sibling;b=R,b===null?(R=m.child,m.child=null):(R=b.sibling,b.sibling=null),_v(m,!1,R,b,z);break;case"backwards":for(b=null,R=m.child,m.child=null;R!==null;){if(u=R.alternate,u!==null&&sp(u)===null){m.child=R;break}u=R.sibling,R.sibling=b,b=R,R=u}_v(m,!0,b,null,z);break;case"together":_v(m,!1,null,null,void 0);break;default:m.memoizedState=null}return m.child}function fp(u,m){(m.mode&1)===0&&u!==null&&(u.alternate=null,m.alternate=null,m.flags|=2)}function cl(u,m,b){if(u!==null&&(m.dependencies=u.dependencies),Fd|=m.lanes,(b&m.childLanes)===0)return null;if(u!==null&&m.child!==u.child)throw Error(t(153));if(m.child!==null){for(u=m.child,b=wc(u,u.pendingProps),m.child=b,b.return=m;u.sibling!==null;)u=u.sibling,b=b.sibling=wc(u,u.pendingProps),b.return=m;b.sibling=null}return m.child}function fq(u,m,b){switch(m.tag){case 3:wT(m),Ru();break;case 5:qC(m);break;case 1:Ls(m.type)&&Gm(m);break;case 4:tv(m,m.stateNode.containerInfo);break;case 10:var k=m.type._context,R=m.memoizedProps.value;Rn(ep,k._currentValue),k._currentValue=R;break;case 13:if(k=m.memoizedState,k!==null)return k.dehydrated!==null?(Rn(Zn,Zn.current&1),m.flags|=128,null):(b&m.child.childLanes)!==0?jT(u,m,b):(Rn(Zn,Zn.current&1),u=cl(u,m,b),u!==null?u.sibling:null);Rn(Zn,Zn.current&1);break;case 19:if(k=(b&m.childLanes)!==0,(u.flags&128)!==0){if(k)return ST(u,m,b);m.flags|=128}if(R=m.memoizedState,R!==null&&(R.rendering=null,R.tail=null,R.lastEffect=null),Rn(Zn,Zn.current),k)break;return null;case 22:case 23:return m.lanes=0,yT(u,m,b)}return cl(u,m,b)}var CT,jv,TT,kT;CT=function(u,m){for(var b=m.child;b!==null;){if(b.tag===5||b.tag===6)u.appendChild(b.stateNode);else if(b.tag!==4&&b.child!==null){b.child.return=b,b=b.child;continue}if(b===m)break;for(;b.sibling===null;){if(b.return===null||b.return===m)return;b=b.return}b.sibling.return=b.return,b=b.sibling}},jv=function(){},TT=function(u,m,b,k){var R=u.memoizedProps;if(R!==k){u=m.stateNode,Rd(uo.current);var z=null;switch(b){case"input":R=Ue(u,R),k=Ue(u,k),z=[];break;case"select":R=re({},R,{value:void 0}),k=re({},k,{value:void 0}),z=[];break;case"textarea":R=he(u,R),k=he(u,k),z=[];break;default:typeof R.onClick!="function"&&typeof k.onClick=="function"&&(u.onclick=Be)}zt(b,k);var J;b=null;for(De in R)if(!k.hasOwnProperty(De)&&R.hasOwnProperty(De)&&R[De]!=null)if(De==="style"){var fe=R[De];for(J in fe)fe.hasOwnProperty(J)&&(b||(b={}),b[J]="")}else De!=="dangerouslySetInnerHTML"&&De!=="children"&&De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&De!=="autoFocus"&&(s.hasOwnProperty(De)?z||(z=[]):(z=z||[]).push(De,null));for(De in k){var ge=k[De];if(fe=R?.[De],k.hasOwnProperty(De)&&ge!==fe&&(ge!=null||fe!=null))if(De==="style")if(fe){for(J in fe)!fe.hasOwnProperty(J)||ge&&ge.hasOwnProperty(J)||(b||(b={}),b[J]="");for(J in ge)ge.hasOwnProperty(J)&&fe[J]!==ge[J]&&(b||(b={}),b[J]=ge[J])}else b||(z||(z=[]),z.push(De,b)),b=ge;else De==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,fe=fe?fe.__html:void 0,ge!=null&&fe!==ge&&(z=z||[]).push(De,ge)):De==="children"?typeof ge!="string"&&typeof ge!="number"||(z=z||[]).push(De,""+ge):De!=="suppressContentEditableWarning"&&De!=="suppressHydrationWarning"&&(s.hasOwnProperty(De)?(ge!=null&&De==="onScroll"&&Tn("scroll",u),z||fe===ge||(z=[])):(z=z||[]).push(De,ge))}b&&(z=z||[]).push("style",b);var De=z;(m.updateQueue=De)&&(m.flags|=4)}},kT=function(u,m,b,k){b!==k&&(m.flags|=4)};function fh(u,m){if(!$n)switch(u.tailMode){case"hidden":m=u.tail;for(var b=null;m!==null;)m.alternate!==null&&(b=m),m=m.sibling;b===null?u.tail=null:b.sibling=null;break;case"collapsed":b=u.tail;for(var k=null;b!==null;)b.alternate!==null&&(k=b),b=b.sibling;k===null?m||u.tail===null?u.tail=null:u.tail.sibling=null:k.sibling=null}}function ss(u){var m=u.alternate!==null&&u.alternate.child===u.child,b=0,k=0;if(m)for(var R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags&14680064,k|=R.flags&14680064,R.return=u,R=R.sibling;else for(R=u.child;R!==null;)b|=R.lanes|R.childLanes,k|=R.subtreeFlags,k|=R.flags,R.return=u,R=R.sibling;return u.subtreeFlags|=k,u.childLanes=b,m}function hq(u,m,b){var k=m.pendingProps;switch($y(m),m.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return ss(m),null;case 1:return Ls(m.type)&&Ym(),ss(m),null;case 3:return k=m.stateNode,zu(),zn(Rs),zn(ns),sv(),k.pendingContext&&(k.context=k.pendingContext,k.pendingContext=null),(u===null||u.child===null)&&(Qm(m)?m.flags|=4:u===null||u.memoizedState.isDehydrated&&(m.flags&256)===0||(m.flags|=1024,xa!==null&&(Iv(xa),xa=null))),jv(u,m),ss(m),null;case 5:nv(m);var R=Rd(oh.current);if(b=m.type,u!==null&&m.stateNode!=null)TT(u,m,b,k,R),u.ref!==m.ref&&(m.flags|=512,m.flags|=2097152);else{if(!k){if(m.stateNode===null)throw Error(t(166));return ss(m),null}if(u=Rd(uo.current),Qm(m)){k=m.stateNode,b=m.type;var z=m.memoizedProps;switch(k[Ri]=m,k[cc]=z,u=(m.mode&1)!==0,b){case"dialog":Tn("cancel",k),Tn("close",k);break;case"iframe":case"object":case"embed":Tn("load",k);break;case"video":case"audio":for(R=0;R<ac.length;R++)Tn(ac[R],k);break;case"source":Tn("error",k);break;case"img":case"image":case"link":Tn("error",k),Tn("load",k);break;case"details":Tn("toggle",k);break;case"input":Ye(k,z),Tn("invalid",k);break;case"select":k._wrapperState={wasMultiple:!!z.multiple},Tn("invalid",k);break;case"textarea":Le(k,z),Tn("invalid",k)}zt(b,z),R=null;for(var J in z)if(z.hasOwnProperty(J)){var fe=z[J];J==="children"?typeof fe=="string"?k.textContent!==fe&&(z.suppressHydrationWarning!==!0&&Ee(k.textContent,fe,u),R=["children",fe]):typeof fe=="number"&&k.textContent!==""+fe&&(z.suppressHydrationWarning!==!0&&Ee(k.textContent,fe,u),R=["children",""+fe]):s.hasOwnProperty(J)&&fe!=null&&J==="onScroll"&&Tn("scroll",k)}switch(b){case"input":Te(k),Ve(k,z,!0);break;case"textarea":Te(k),ze(k);break;case"select":case"option":break;default:typeof z.onClick=="function"&&(k.onclick=Be)}k=R,m.updateQueue=k,k!==null&&(m.flags|=4)}else{J=R.nodeType===9?R:R.ownerDocument,u==="http://www.w3.org/1999/xhtml"&&(u=et(b)),u==="http://www.w3.org/1999/xhtml"?b==="script"?(u=J.createElement("div"),u.innerHTML="<script><\/script>",u=u.removeChild(u.firstChild)):typeof k.is=="string"?u=J.createElement(b,{is:k.is}):(u=J.createElement(b),b==="select"&&(J=u,k.multiple?J.multiple=!0:k.size&&(J.size=k.size))):u=J.createElementNS(u,b),u[Ri]=m,u[cc]=k,CT(u,m,!1,!1),m.stateNode=u;e:{switch(J=Sn(b,k),b){case"dialog":Tn("cancel",u),Tn("close",u),R=k;break;case"iframe":case"object":case"embed":Tn("load",u),R=k;break;case"video":case"audio":for(R=0;R<ac.length;R++)Tn(ac[R],u);R=k;break;case"source":Tn("error",u),R=k;break;case"img":case"image":case"link":Tn("error",u),Tn("load",u),R=k;break;case"details":Tn("toggle",u),R=k;break;case"input":Ye(u,k),R=Ue(u,k),Tn("invalid",u);break;case"option":R=k;break;case"select":u._wrapperState={wasMultiple:!!k.multiple},R=re({},k,{value:void 0}),Tn("invalid",u);break;case"textarea":Le(u,k),R=he(u,k),Tn("invalid",u);break;default:R=k}zt(b,R),fe=R;for(z in fe)if(fe.hasOwnProperty(z)){var ge=fe[z];z==="style"?Zt(u,ge):z==="dangerouslySetInnerHTML"?(ge=ge?ge.__html:void 0,ge!=null&&ht(u,ge)):z==="children"?typeof ge=="string"?(b!=="textarea"||ge!=="")&&Et(u,ge):typeof ge=="number"&&Et(u,""+ge):z!=="suppressContentEditableWarning"&&z!=="suppressHydrationWarning"&&z!=="autoFocus"&&(s.hasOwnProperty(z)?ge!=null&&z==="onScroll"&&Tn("scroll",u):ge!=null&&O(u,z,ge,J))}switch(b){case"input":Te(u),Ve(u,k,!1);break;case"textarea":Te(u),ze(u);break;case"option":k.value!=null&&u.setAttribute("value",""+ye(k.value));break;case"select":u.multiple=!!k.multiple,z=k.value,z!=null?le(u,!!k.multiple,z,!1):k.defaultValue!=null&&le(u,!!k.multiple,k.defaultValue,!0);break;default:typeof R.onClick=="function"&&(u.onclick=Be)}switch(b){case"button":case"input":case"select":case"textarea":k=!!k.autoFocus;break e;case"img":k=!0;break e;default:k=!1}}k&&(m.flags|=4)}m.ref!==null&&(m.flags|=512,m.flags|=2097152)}return ss(m),null;case 6:if(u&&m.stateNode!=null)kT(u,m,u.memoizedProps,k);else{if(typeof k!="string"&&m.stateNode===null)throw Error(t(166));if(b=Rd(oh.current),Rd(uo.current),Qm(m)){if(k=m.stateNode,b=m.memoizedProps,k[Ri]=m,(z=k.nodeValue!==b)&&(u=li,u!==null))switch(u.tag){case 3:Ee(k.nodeValue,b,(u.mode&1)!==0);break;case 5:u.memoizedProps.suppressHydrationWarning!==!0&&Ee(k.nodeValue,b,(u.mode&1)!==0)}z&&(m.flags|=4)}else k=(b.nodeType===9?b:b.ownerDocument).createTextNode(k),k[Ri]=m,m.stateNode=k}return ss(m),null;case 13:if(zn(Zn),k=m.memoizedState,u===null||u.memoizedState!==null&&u.memoizedState.dehydrated!==null){if($n&&ci!==null&&(m.mode&1)!==0&&(m.flags&128)===0)EC(),Ru(),m.flags|=98560,z=!1;else if(z=Qm(m),k!==null&&k.dehydrated!==null){if(u===null){if(!z)throw Error(t(318));if(z=m.memoizedState,z=z!==null?z.dehydrated:null,!z)throw Error(t(317));z[Ri]=m}else Ru(),(m.flags&128)===0&&(m.memoizedState=null),m.flags|=4;ss(m),z=!1}else xa!==null&&(Iv(xa),xa=null),z=!0;if(!z)return m.flags&65536?m:null}return(m.flags&128)!==0?(m.lanes=b,m):(k=k!==null,k!==(u!==null&&u.memoizedState!==null)&&k&&(m.child.flags|=8192,(m.mode&1)!==0&&(u===null||(Zn.current&1)!==0?Sr===0&&(Sr=3):Lv())),m.updateQueue!==null&&(m.flags|=4),ss(m),null);case 4:return zu(),jv(u,m),u===null&&oc(m.stateNode.containerInfo),ss(m),null;case 10:return Jy(m.type._context),ss(m),null;case 17:return Ls(m.type)&&Ym(),ss(m),null;case 19:if(zn(Zn),z=m.memoizedState,z===null)return ss(m),null;if(k=(m.flags&128)!==0,J=z.rendering,J===null)if(k)fh(z,!1);else{if(Sr!==0||u!==null&&(u.flags&128)!==0)for(u=m.child;u!==null;){if(J=sp(u),J!==null){for(m.flags|=128,fh(z,!1),k=J.updateQueue,k!==null&&(m.updateQueue=k,m.flags|=4),m.subtreeFlags=0,k=b,b=m.child;b!==null;)z=b,u=k,z.flags&=14680066,J=z.alternate,J===null?(z.childLanes=0,z.lanes=u,z.child=null,z.subtreeFlags=0,z.memoizedProps=null,z.memoizedState=null,z.updateQueue=null,z.dependencies=null,z.stateNode=null):(z.childLanes=J.childLanes,z.lanes=J.lanes,z.child=J.child,z.subtreeFlags=0,z.deletions=null,z.memoizedProps=J.memoizedProps,z.memoizedState=J.memoizedState,z.updateQueue=J.updateQueue,z.type=J.type,u=J.dependencies,z.dependencies=u===null?null:{lanes:u.lanes,firstContext:u.firstContext}),b=b.sibling;return Rn(Zn,Zn.current&1|2),m.child}u=u.sibling}z.tail!==null&&Pn()>Wu&&(m.flags|=128,k=!0,fh(z,!1),m.lanes=4194304)}else{if(!k)if(u=sp(J),u!==null){if(m.flags|=128,k=!0,b=u.updateQueue,b!==null&&(m.updateQueue=b,m.flags|=4),fh(z,!0),z.tail===null&&z.tailMode==="hidden"&&!J.alternate&&!$n)return ss(m),null}else 2*Pn()-z.renderingStartTime>Wu&&b!==1073741824&&(m.flags|=128,k=!0,fh(z,!1),m.lanes=4194304);z.isBackwards?(J.sibling=m.child,m.child=J):(b=z.last,b!==null?b.sibling=J:m.child=J,z.last=J)}return z.tail!==null?(m=z.tail,z.rendering=m,z.tail=m.sibling,z.renderingStartTime=Pn(),m.sibling=null,b=Zn.current,Rn(Zn,k?b&1|2:b&1),m):(ss(m),null);case 22:case 23:return Rv(),k=m.memoizedState!==null,u!==null&&u.memoizedState!==null!==k&&(m.flags|=8192),k&&(m.mode&1)!==0?(di&1073741824)!==0&&(ss(m),m.subtreeFlags&6&&(m.flags|=8192)):ss(m),null;case 24:return null;case 25:return null}throw Error(t(156,m.tag))}function mq(u,m){switch($y(m),m.tag){case 1:return Ls(m.type)&&Ym(),u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 3:return zu(),zn(Rs),zn(ns),sv(),u=m.flags,(u&65536)!==0&&(u&128)===0?(m.flags=u&-65537|128,m):null;case 5:return nv(m),null;case 13:if(zn(Zn),u=m.memoizedState,u!==null&&u.dehydrated!==null){if(m.alternate===null)throw Error(t(340));Ru()}return u=m.flags,u&65536?(m.flags=u&-65537|128,m):null;case 19:return zn(Zn),null;case 4:return zu(),null;case 10:return Jy(m.type._context),null;case 22:case 23:return Rv(),null;case 24:return null;default:return null}}var hp=!1,is=!1,pq=typeof WeakSet=="function"?WeakSet:Set,lt=null;function Bu(u,m){var b=u.ref;if(b!==null)if(typeof b=="function")try{b(null)}catch(k){rr(u,m,k)}else b.current=null}function Nv(u,m,b){try{b()}catch(k){rr(u,m,k)}}var PT=!1;function gq(u,m){if(rt=fa,u=Jo(),Qo(u)){if("selectionStart"in u)var b={start:u.selectionStart,end:u.selectionEnd};else e:{b=(b=u.ownerDocument)&&b.defaultView||window;var k=b.getSelection&&b.getSelection();if(k&&k.rangeCount!==0){b=k.anchorNode;var R=k.anchorOffset,z=k.focusNode;k=k.focusOffset;try{b.nodeType,z.nodeType}catch{b=null;break e}var J=0,fe=-1,ge=-1,De=0,Ge=0,Ke=u,He=null;t:for(;;){for(var at;Ke!==b||R!==0&&Ke.nodeType!==3||(fe=J+R),Ke!==z||k!==0&&Ke.nodeType!==3||(ge=J+k),Ke.nodeType===3&&(J+=Ke.nodeValue.length),(at=Ke.firstChild)!==null;)He=Ke,Ke=at;for(;;){if(Ke===u)break t;if(He===b&&++De===R&&(fe=J),He===z&&++Ge===k&&(ge=J),(at=Ke.nextSibling)!==null)break;Ke=He,He=Ke.parentNode}Ke=at}b=fe===-1||ge===-1?null:{start:fe,end:ge}}else b=null}b=b||{start:0,end:0}}else b=null;for(Nt={focusedElem:u,selectionRange:b},fa=!1,lt=m;lt!==null;)if(m=lt,u=m.child,(m.subtreeFlags&1028)!==0&&u!==null)u.return=m,lt=u;else for(;lt!==null;){m=lt;try{var ut=m.alternate;if((m.flags&1024)!==0)switch(m.tag){case 0:case 11:case 15:break;case 1:if(ut!==null){var mt=ut.memoizedProps,ir=ut.memoizedState,Se=m.stateNode,be=Se.getSnapshotBeforeUpdate(m.elementType===m.type?mt:ya(m.type,mt),ir);Se.__reactInternalSnapshotBeforeUpdate=be}break;case 3:var Pe=m.stateNode.containerInfo;Pe.nodeType===1?Pe.textContent="":Pe.nodeType===9&&Pe.documentElement&&Pe.removeChild(Pe.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(t(163))}}catch(Je){rr(m,m.return,Je)}if(u=m.sibling,u!==null){u.return=m.return,lt=u;break}lt=m.return}return ut=PT,PT=!1,ut}function hh(u,m,b){var k=m.updateQueue;if(k=k!==null?k.lastEffect:null,k!==null){var R=k=k.next;do{if((R.tag&u)===u){var z=R.destroy;R.destroy=void 0,z!==void 0&&Nv(m,b,z)}R=R.next}while(R!==k)}}function mp(u,m){if(m=m.updateQueue,m=m!==null?m.lastEffect:null,m!==null){var b=m=m.next;do{if((b.tag&u)===u){var k=b.create;b.destroy=k()}b=b.next}while(b!==m)}}function Sv(u){var m=u.ref;if(m!==null){var b=u.stateNode;switch(u.tag){case 5:u=b;break;default:u=b}typeof m=="function"?m(u):m.current=u}}function MT(u){var m=u.alternate;m!==null&&(u.alternate=null,MT(m)),u.child=null,u.deletions=null,u.sibling=null,u.tag===5&&(m=u.stateNode,m!==null&&(delete m[Ri],delete m[cc],delete m[dc],delete m[zy],delete m[Uy])),u.stateNode=null,u.return=null,u.dependencies=null,u.memoizedProps=null,u.memoizedState=null,u.pendingProps=null,u.stateNode=null,u.updateQueue=null}function ET(u){return u.tag===5||u.tag===3||u.tag===4}function DT(u){e:for(;;){for(;u.sibling===null;){if(u.return===null||ET(u.return))return null;u=u.return}for(u.sibling.return=u.return,u=u.sibling;u.tag!==5&&u.tag!==6&&u.tag!==18;){if(u.flags&2||u.child===null||u.tag===4)continue e;u.child.return=u,u=u.child}if(!(u.flags&2))return u.stateNode}}function Cv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.nodeType===8?b.parentNode.insertBefore(u,m):b.insertBefore(u,m):(b.nodeType===8?(m=b.parentNode,m.insertBefore(u,b)):(m=b,m.appendChild(u)),b=b._reactRootContainer,b!=null||m.onclick!==null||(m.onclick=Be));else if(k!==4&&(u=u.child,u!==null))for(Cv(u,m,b),u=u.sibling;u!==null;)Cv(u,m,b),u=u.sibling}function Tv(u,m,b){var k=u.tag;if(k===5||k===6)u=u.stateNode,m?b.insertBefore(u,m):b.appendChild(u);else if(k!==4&&(u=u.child,u!==null))for(Tv(u,m,b),u=u.sibling;u!==null;)Tv(u,m,b),u=u.sibling}var $r=null,va=!1;function gc(u,m,b){for(b=b.child;b!==null;)OT(u,m,b),b=b.sibling}function OT(u,m,b){if(Fr&&typeof Fr.onCommitFiberUnmount=="function")try{Fr.onCommitFiberUnmount(aa,b)}catch{}switch(b.tag){case 5:is||Bu(b,m);case 6:var k=$r,R=va;$r=null,gc(u,m,b),$r=k,va=R,$r!==null&&(va?(u=$r,b=b.stateNode,u.nodeType===8?u.parentNode.removeChild(b):u.removeChild(b)):$r.removeChild(b.stateNode));break;case 18:$r!==null&&(va?(u=$r,b=b.stateNode,u.nodeType===8?rh(u.parentNode,b):u.nodeType===1&&rh(u,b),Ur(u)):rh($r,b.stateNode));break;case 4:k=$r,R=va,$r=b.stateNode.containerInfo,va=!0,gc(u,m,b),$r=k,va=R;break;case 0:case 11:case 14:case 15:if(!is&&(k=b.updateQueue,k!==null&&(k=k.lastEffect,k!==null))){R=k=k.next;do{var z=R,J=z.destroy;z=z.tag,J!==void 0&&((z&2)!==0||(z&4)!==0)&&Nv(b,m,J),R=R.next}while(R!==k)}gc(u,m,b);break;case 1:if(!is&&(Bu(b,m),k=b.stateNode,typeof k.componentWillUnmount=="function"))try{k.props=b.memoizedProps,k.state=b.memoizedState,k.componentWillUnmount()}catch(fe){rr(b,m,fe)}gc(u,m,b);break;case 21:gc(u,m,b);break;case 22:b.mode&1?(is=(k=is)||b.memoizedState!==null,gc(u,m,b),is=k):gc(u,m,b);break;default:gc(u,m,b)}}function IT(u){var m=u.updateQueue;if(m!==null){u.updateQueue=null;var b=u.stateNode;b===null&&(b=u.stateNode=new pq),m.forEach(function(k){var R=Sq.bind(null,u,k);b.has(k)||(b.add(k),k.then(R,R))})}}function ba(u,m){var b=m.deletions;if(b!==null)for(var k=0;k<b.length;k++){var R=b[k];try{var z=u,J=m,fe=J;e:for(;fe!==null;){switch(fe.tag){case 5:$r=fe.stateNode,va=!1;break e;case 3:$r=fe.stateNode.containerInfo,va=!0;break e;case 4:$r=fe.stateNode.containerInfo,va=!0;break e}fe=fe.return}if($r===null)throw Error(t(160));OT(z,J,R),$r=null,va=!1;var ge=R.alternate;ge!==null&&(ge.return=null),R.return=null}catch(De){rr(R,m,De)}}if(m.subtreeFlags&12854)for(m=m.child;m!==null;)AT(m,u),m=m.sibling}function AT(u,m){var b=u.alternate,k=u.flags;switch(u.tag){case 0:case 11:case 14:case 15:if(ba(m,u),ho(u),k&4){try{hh(3,u,u.return),mp(3,u)}catch(mt){rr(u,u.return,mt)}try{hh(5,u,u.return)}catch(mt){rr(u,u.return,mt)}}break;case 1:ba(m,u),ho(u),k&512&&b!==null&&Bu(b,b.return);break;case 5:if(ba(m,u),ho(u),k&512&&b!==null&&Bu(b,b.return),u.flags&32){var R=u.stateNode;try{Et(R,"")}catch(mt){rr(u,u.return,mt)}}if(k&4&&(R=u.stateNode,R!=null)){var z=u.memoizedProps,J=b!==null?b.memoizedProps:z,fe=u.type,ge=u.updateQueue;if(u.updateQueue=null,ge!==null)try{fe==="input"&&z.type==="radio"&&z.name!=null&&ve(R,z),Sn(fe,J);var De=Sn(fe,z);for(J=0;J<ge.length;J+=2){var Ge=ge[J],Ke=ge[J+1];Ge==="style"?Zt(R,Ke):Ge==="dangerouslySetInnerHTML"?ht(R,Ke):Ge==="children"?Et(R,Ke):O(R,Ge,Ke,De)}switch(fe){case"input":Oe(R,z);break;case"textarea":Ie(R,z);break;case"select":var He=R._wrapperState.wasMultiple;R._wrapperState.wasMultiple=!!z.multiple;var at=z.value;at!=null?le(R,!!z.multiple,at,!1):He!==!!z.multiple&&(z.defaultValue!=null?le(R,!!z.multiple,z.defaultValue,!0):le(R,!!z.multiple,z.multiple?[]:"",!1))}R[cc]=z}catch(mt){rr(u,u.return,mt)}}break;case 6:if(ba(m,u),ho(u),k&4){if(u.stateNode===null)throw Error(t(162));R=u.stateNode,z=u.memoizedProps;try{R.nodeValue=z}catch(mt){rr(u,u.return,mt)}}break;case 3:if(ba(m,u),ho(u),k&4&&b!==null&&b.memoizedState.isDehydrated)try{Ur(m.containerInfo)}catch(mt){rr(u,u.return,mt)}break;case 4:ba(m,u),ho(u);break;case 13:ba(m,u),ho(u),R=u.child,R.flags&8192&&(z=R.memoizedState!==null,R.stateNode.isHidden=z,!z||R.alternate!==null&&R.alternate.memoizedState!==null||(Mv=Pn())),k&4&&IT(u);break;case 22:if(Ge=b!==null&&b.memoizedState!==null,u.mode&1?(is=(De=is)||Ge,ba(m,u),is=De):ba(m,u),ho(u),k&8192){if(De=u.memoizedState!==null,(u.stateNode.isHidden=De)&&!Ge&&(u.mode&1)!==0)for(lt=u,Ge=u.child;Ge!==null;){for(Ke=lt=Ge;lt!==null;){switch(He=lt,at=He.child,He.tag){case 0:case 11:case 14:case 15:hh(4,He,He.return);break;case 1:Bu(He,He.return);var ut=He.stateNode;if(typeof ut.componentWillUnmount=="function"){k=He,b=He.return;try{m=k,ut.props=m.memoizedProps,ut.state=m.memoizedState,ut.componentWillUnmount()}catch(mt){rr(k,b,mt)}}break;case 5:Bu(He,He.return);break;case 22:if(He.memoizedState!==null){FT(Ke);continue}}at!==null?(at.return=He,lt=at):FT(Ke)}Ge=Ge.sibling}e:for(Ge=null,Ke=u;;){if(Ke.tag===5){if(Ge===null){Ge=Ke;try{R=Ke.stateNode,De?(z=R.style,typeof z.setProperty=="function"?z.setProperty("display","none","important"):z.display="none"):(fe=Ke.stateNode,ge=Ke.memoizedProps.style,J=ge!=null&&ge.hasOwnProperty("display")?ge.display:null,fe.style.display=Jt("display",J))}catch(mt){rr(u,u.return,mt)}}}else if(Ke.tag===6){if(Ge===null)try{Ke.stateNode.nodeValue=De?"":Ke.memoizedProps}catch(mt){rr(u,u.return,mt)}}else if((Ke.tag!==22&&Ke.tag!==23||Ke.memoizedState===null||Ke===u)&&Ke.child!==null){Ke.child.return=Ke,Ke=Ke.child;continue}if(Ke===u)break e;for(;Ke.sibling===null;){if(Ke.return===null||Ke.return===u)break e;Ge===Ke&&(Ge=null),Ke=Ke.return}Ge===Ke&&(Ge=null),Ke.sibling.return=Ke.return,Ke=Ke.sibling}}break;case 19:ba(m,u),ho(u),k&4&&IT(u);break;case 21:break;default:ba(m,u),ho(u)}}function ho(u){var m=u.flags;if(m&2){try{e:{for(var b=u.return;b!==null;){if(ET(b)){var k=b;break e}b=b.return}throw Error(t(160))}switch(k.tag){case 5:var R=k.stateNode;k.flags&32&&(Et(R,""),k.flags&=-33);var z=DT(u);Tv(u,z,R);break;case 3:case 4:var J=k.stateNode.containerInfo,fe=DT(u);Cv(u,fe,J);break;default:throw Error(t(161))}}catch(ge){rr(u,u.return,ge)}u.flags&=-3}m&4096&&(u.flags&=-4097)}function xq(u,m,b){lt=u,RT(u)}function RT(u,m,b){for(var k=(u.mode&1)!==0;lt!==null;){var R=lt,z=R.child;if(R.tag===22&&k){var J=R.memoizedState!==null||hp;if(!J){var fe=R.alternate,ge=fe!==null&&fe.memoizedState!==null||is;fe=hp;var De=is;if(hp=J,(is=ge)&&!De)for(lt=R;lt!==null;)J=lt,ge=J.child,J.tag===22&&J.memoizedState!==null?qT(R):ge!==null?(ge.return=J,lt=ge):qT(R);for(;z!==null;)lt=z,RT(z),z=z.sibling;lt=R,hp=fe,is=De}LT(u)}else(R.subtreeFlags&8772)!==0&&z!==null?(z.return=R,lt=z):LT(u)}}function LT(u){for(;lt!==null;){var m=lt;if((m.flags&8772)!==0){var b=m.alternate;try{if((m.flags&8772)!==0)switch(m.tag){case 0:case 11:case 15:is||mp(5,m);break;case 1:var k=m.stateNode;if(m.flags&4&&!is)if(b===null)k.componentDidMount();else{var R=m.elementType===m.type?b.memoizedProps:ya(m.type,b.memoizedProps);k.componentDidUpdate(R,b.memoizedState,k.__reactInternalSnapshotBeforeUpdate)}var z=m.updateQueue;z!==null&&FC(m,z,k);break;case 3:var J=m.updateQueue;if(J!==null){if(b=null,m.child!==null)switch(m.child.tag){case 5:b=m.child.stateNode;break;case 1:b=m.child.stateNode}FC(m,J,b)}break;case 5:var fe=m.stateNode;if(b===null&&m.flags&4){b=fe;var ge=m.memoizedProps;switch(m.type){case"button":case"input":case"select":case"textarea":ge.autoFocus&&b.focus();break;case"img":ge.src&&(b.src=ge.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(m.memoizedState===null){var De=m.alternate;if(De!==null){var Ge=De.memoizedState;if(Ge!==null){var Ke=Ge.dehydrated;Ke!==null&&Ur(Ke)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(t(163))}is||m.flags&512&&Sv(m)}catch(He){rr(m,m.return,He)}}if(m===u){lt=null;break}if(b=m.sibling,b!==null){b.return=m.return,lt=b;break}lt=m.return}}function FT(u){for(;lt!==null;){var m=lt;if(m===u){lt=null;break}var b=m.sibling;if(b!==null){b.return=m.return,lt=b;break}lt=m.return}}function qT(u){for(;lt!==null;){var m=lt;try{switch(m.tag){case 0:case 11:case 15:var b=m.return;try{mp(4,m)}catch(ge){rr(m,b,ge)}break;case 1:var k=m.stateNode;if(typeof k.componentDidMount=="function"){var R=m.return;try{k.componentDidMount()}catch(ge){rr(m,R,ge)}}var z=m.return;try{Sv(m)}catch(ge){rr(m,z,ge)}break;case 5:var J=m.return;try{Sv(m)}catch(ge){rr(m,J,ge)}}}catch(ge){rr(m,m.return,ge)}if(m===u){lt=null;break}var fe=m.sibling;if(fe!==null){fe.return=m.return,lt=fe;break}lt=m.return}}var yq=Math.ceil,pp=M.ReactCurrentDispatcher,kv=M.ReactCurrentOwner,Ui=M.ReactCurrentBatchConfig,ln=0,Or=null,pr=null,Hr=0,di=0,Vu=uc(0),Sr=0,mh=null,Fd=0,gp=0,Pv=0,ph=null,qs=null,Mv=0,Wu=1/0,dl=null,xp=!1,Ev=null,xc=null,yp=!1,yc=null,vp=0,gh=0,Dv=null,bp=-1,wp=0;function ws(){return(ln&6)!==0?Pn():bp!==-1?bp:bp=Pn()}function vc(u){return(u.mode&1)===0?1:(ln&2)!==0&&Hr!==0?Hr&-Hr:tq.transition!==null?(wp===0&&(wp=zl()),wp):(u=Kt,u!==0||(u=window.event,u=u===void 0?16:Ht(u.type)),u)}function wa(u,m,b,k){if(50<gh)throw gh=0,Dv=null,Error(t(185));qr(u,b,k),((ln&2)===0||u!==Or)&&(u===Or&&((ln&2)===0&&(gp|=b),Sr===4&&bc(u,Hr)),zs(u,k),b===1&&ln===0&&(m.mode&1)===0&&(Wu=Pn()+500,Zm&&hc()))}function zs(u,m){var b=u.callbackNode;Va(u,m);var k=xn(u,u===Or?Hr:0);if(k===0)b!==null&&Oo(b),u.callbackNode=null,u.callbackPriority=0;else if(m=k&-k,u.callbackPriority!==m){if(b!=null&&Oo(b),m===1)u.tag===0?eq(UT.bind(null,u)):CC(UT.bind(null,u)),ts(function(){(ln&6)===0&&hc()}),b=null;else{switch(Ti(k)){case 1:b=Io;break;case 4:b=ql;break;case 16:b=Ua;break;case 536870912:b=ji;break;default:b=Ua}b=ZT(b,zT.bind(null,u))}u.callbackPriority=m,u.callbackNode=b}}function zT(u,m){if(bp=-1,wp=0,(ln&6)!==0)throw Error(t(327));var b=u.callbackNode;if($u()&&u.callbackNode!==b)return null;var k=xn(u,u===Or?Hr:0);if(k===0)return null;if((k&30)!==0||(k&u.expiredLanes)!==0||m)m=_p(u,k);else{m=k;var R=ln;ln|=2;var z=VT();(Or!==u||Hr!==m)&&(dl=null,Wu=Pn()+500,zd(u,m));do try{wq();break}catch(fe){BT(u,fe)}while(!0);Ky(),pp.current=z,ln=R,pr!==null?m=0:(Or=null,Hr=0,m=Sr)}if(m!==0){if(m===2&&(R=fr(u),R!==0&&(k=R,m=Ov(u,R))),m===1)throw b=mh,zd(u,0),bc(u,k),zs(u,Pn()),b;if(m===6)bc(u,k);else{if(R=u.current.alternate,(k&30)===0&&!vq(R)&&(m=_p(u,k),m===2&&(z=fr(u),z!==0&&(k=z,m=Ov(u,z))),m===1))throw b=mh,zd(u,0),bc(u,k),zs(u,Pn()),b;switch(u.finishedWork=R,u.finishedLanes=k,m){case 0:case 1:throw Error(t(345));case 2:Ud(u,qs,dl);break;case 3:if(bc(u,k),(k&130023424)===k&&(m=Mv+500-Pn(),10<m)){if(xn(u,0)!==0)break;if(R=u.suspendedLanes,(R&k)!==k){ws(),u.pingedLanes|=u.suspendedLanes&R;break}u.timeoutHandle=jr(Ud.bind(null,u,qs,dl),m);break}Ud(u,qs,dl);break;case 4:if(bc(u,k),(k&4194240)===k)break;for(m=u.eventTimes,R=-1;0<k;){var J=31-Ot(k);z=1<<J,J=m[J],J>R&&(R=J),k&=~z}if(k=R,k=Pn()-k,k=(120>k?120:480>k?480:1080>k?1080:1920>k?1920:3e3>k?3e3:4320>k?4320:1960*yq(k/1960))-k,10<k){u.timeoutHandle=jr(Ud.bind(null,u,qs,dl),k);break}Ud(u,qs,dl);break;case 5:Ud(u,qs,dl);break;default:throw Error(t(329))}}}return zs(u,Pn()),u.callbackNode===b?zT.bind(null,u):null}function Ov(u,m){var b=ph;return u.current.memoizedState.isDehydrated&&(zd(u,m).flags|=256),u=_p(u,m),u!==2&&(m=qs,qs=b,m!==null&&Iv(m)),u}function Iv(u){qs===null?qs=u:qs.push.apply(qs,u)}function vq(u){for(var m=u;;){if(m.flags&16384){var b=m.updateQueue;if(b!==null&&(b=b.stores,b!==null))for(var k=0;k<b.length;k++){var R=b[k],z=R.getSnapshot;R=R.value;try{if(!Wr(z(),R))return!1}catch{return!1}}}if(b=m.child,m.subtreeFlags&16384&&b!==null)b.return=m,m=b;else{if(m===u)break;for(;m.sibling===null;){if(m.return===null||m.return===u)return!0;m=m.return}m.sibling.return=m.return,m=m.sibling}}return!0}function bc(u,m){for(m&=~Pv,m&=~gp,u.suspendedLanes|=m,u.pingedLanes&=~m,u=u.expirationTimes;0<m;){var b=31-Ot(m),k=1<<b;u[b]=-1,m&=~k}}function UT(u){if((ln&6)!==0)throw Error(t(327));$u();var m=xn(u,0);if((m&1)===0)return zs(u,Pn()),null;var b=_p(u,m);if(u.tag!==0&&b===2){var k=fr(u);k!==0&&(m=k,b=Ov(u,k))}if(b===1)throw b=mh,zd(u,0),bc(u,m),zs(u,Pn()),b;if(b===6)throw Error(t(345));return u.finishedWork=u.current.alternate,u.finishedLanes=m,Ud(u,qs,dl),zs(u,Pn()),null}function Av(u,m){var b=ln;ln|=1;try{return u(m)}finally{ln=b,ln===0&&(Wu=Pn()+500,Zm&&hc())}}function qd(u){yc!==null&&yc.tag===0&&(ln&6)===0&&$u();var m=ln;ln|=1;var b=Ui.transition,k=Kt;try{if(Ui.transition=null,Kt=1,u)return u()}finally{Kt=k,Ui.transition=b,ln=m,(ln&6)===0&&hc()}}function Rv(){di=Vu.current,zn(Vu)}function zd(u,m){u.finishedWork=null,u.finishedLanes=0;var b=u.timeoutHandle;if(b!==-1&&(u.timeoutHandle=-1,mr(b)),pr!==null)for(b=pr.return;b!==null;){var k=b;switch($y(k),k.tag){case 1:k=k.type.childContextTypes,k!=null&&Ym();break;case 3:zu(),zn(Rs),zn(ns),sv();break;case 5:nv(k);break;case 4:zu();break;case 13:zn(Zn);break;case 19:zn(Zn);break;case 10:Jy(k.type._context);break;case 22:case 23:Rv()}b=b.return}if(Or=u,pr=u=wc(u.current,null),Hr=di=m,Sr=0,mh=null,Pv=gp=Fd=0,qs=ph=null,Ad!==null){for(m=0;m<Ad.length;m++)if(b=Ad[m],k=b.interleaved,k!==null){b.interleaved=null;var R=k.next,z=b.pending;if(z!==null){var J=z.next;z.next=R,k.next=J}b.pending=k}Ad=null}return u}function BT(u,m){do{var b=pr;try{if(Ky(),ip.current=cp,ap){for(var k=Kn.memoizedState;k!==null;){var R=k.queue;R!==null&&(R.pending=null),k=k.next}ap=!1}if(Ld=0,Dr=Nr=Kn=null,lh=!1,ch=0,kv.current=null,b===null||b.return===null){Sr=1,mh=m,pr=null;break}e:{var z=u,J=b.return,fe=b,ge=m;if(m=Hr,fe.flags|=32768,ge!==null&&typeof ge=="object"&&typeof ge.then=="function"){var De=ge,Ge=fe,Ke=Ge.tag;if((Ge.mode&1)===0&&(Ke===0||Ke===11||Ke===15)){var He=Ge.alternate;He?(Ge.updateQueue=He.updateQueue,Ge.memoizedState=He.memoizedState,Ge.lanes=He.lanes):(Ge.updateQueue=null,Ge.memoizedState=null)}var at=hT(J);if(at!==null){at.flags&=-257,mT(at,J,fe,z,m),at.mode&1&&fT(z,De,m),m=at,ge=De;var ut=m.updateQueue;if(ut===null){var mt=new Set;mt.add(ge),m.updateQueue=mt}else ut.add(ge);break e}else{if((m&1)===0){fT(z,De,m),Lv();break e}ge=Error(t(426))}}else if($n&&fe.mode&1){var ir=hT(J);if(ir!==null){(ir.flags&65536)===0&&(ir.flags|=256),mT(ir,J,fe,z,m),Gy(Uu(ge,fe));break e}}z=ge=Uu(ge,fe),Sr!==4&&(Sr=2),ph===null?ph=[z]:ph.push(z),z=J;do{switch(z.tag){case 3:z.flags|=65536,m&=-m,z.lanes|=m;var Se=dT(z,ge,m);LC(z,Se);break e;case 1:fe=ge;var be=z.type,Pe=z.stateNode;if((z.flags&128)===0&&(typeof be.getDerivedStateFromError=="function"||Pe!==null&&typeof Pe.componentDidCatch=="function"&&(xc===null||!xc.has(Pe)))){z.flags|=65536,m&=-m,z.lanes|=m;var Je=uT(z,fe,m);LC(z,Je);break e}}z=z.return}while(z!==null)}$T(b)}catch(gt){m=gt,pr===b&&b!==null&&(pr=b=b.return);continue}break}while(!0)}function VT(){var u=pp.current;return pp.current=cp,u===null?cp:u}function Lv(){(Sr===0||Sr===3||Sr===2)&&(Sr=4),Or===null||(Fd&268435455)===0&&(gp&268435455)===0||bc(Or,Hr)}function _p(u,m){var b=ln;ln|=2;var k=VT();(Or!==u||Hr!==m)&&(dl=null,zd(u,m));do try{bq();break}catch(R){BT(u,R)}while(!0);if(Ky(),ln=b,pp.current=k,pr!==null)throw Error(t(261));return Or=null,Hr=0,Sr}function bq(){for(;pr!==null;)WT(pr)}function wq(){for(;pr!==null&&!md();)WT(pr)}function WT(u){var m=GT(u.alternate,u,di);u.memoizedProps=u.pendingProps,m===null?$T(u):pr=m,kv.current=null}function $T(u){var m=u;do{var b=m.alternate;if(u=m.return,(m.flags&32768)===0){if(b=hq(b,m,di),b!==null){pr=b;return}}else{if(b=mq(b,m),b!==null){b.flags&=32767,pr=b;return}if(u!==null)u.flags|=32768,u.subtreeFlags=0,u.deletions=null;else{Sr=6,pr=null;return}}if(m=m.sibling,m!==null){pr=m;return}pr=m=u}while(m!==null);Sr===0&&(Sr=5)}function Ud(u,m,b){var k=Kt,R=Ui.transition;try{Ui.transition=null,Kt=1,_q(u,m,b,k)}finally{Ui.transition=R,Kt=k}return null}function _q(u,m,b,k){do $u();while(yc!==null);if((ln&6)!==0)throw Error(t(327));b=u.finishedWork;var R=u.finishedLanes;if(b===null)return null;if(u.finishedWork=null,u.finishedLanes=0,b===u.current)throw Error(t(177));u.callbackNode=null,u.callbackPriority=0;var z=b.lanes|b.childLanes;if(An(u,z),u===Or&&(pr=Or=null,Hr=0),(b.subtreeFlags&2064)===0&&(b.flags&2064)===0||yp||(yp=!0,ZT(Ua,function(){return $u(),null})),z=(b.flags&15990)!==0,(b.subtreeFlags&15990)!==0||z){z=Ui.transition,Ui.transition=null;var J=Kt;Kt=1;var fe=ln;ln|=4,kv.current=null,gq(u,b),AT(b,u),g(Nt),fa=!!rt,Nt=rt=null,u.current=b,xq(b),za(),ln=fe,Kt=J,Ui.transition=z}else u.current=b;if(yp&&(yp=!1,yc=u,vp=R),z=u.pendingLanes,z===0&&(xc=null),oa(b.stateNode),zs(u,Pn()),m!==null)for(k=u.onRecoverableError,b=0;b<m.length;b++)R=m[b],k(R.value,{componentStack:R.stack,digest:R.digest});if(xp)throw xp=!1,u=Ev,Ev=null,u;return(vp&1)!==0&&u.tag!==0&&$u(),z=u.pendingLanes,(z&1)!==0?u===Dv?gh++:(gh=0,Dv=u):gh=0,hc(),null}function $u(){if(yc!==null){var u=Ti(vp),m=Ui.transition,b=Kt;try{if(Ui.transition=null,Kt=16>u?16:u,yc===null)var k=!1;else{if(u=yc,yc=null,vp=0,(ln&6)!==0)throw Error(t(331));var R=ln;for(ln|=4,lt=u.current;lt!==null;){var z=lt,J=z.child;if((lt.flags&16)!==0){var fe=z.deletions;if(fe!==null){for(var ge=0;ge<fe.length;ge++){var De=fe[ge];for(lt=De;lt!==null;){var Ge=lt;switch(Ge.tag){case 0:case 11:case 15:hh(8,Ge,z)}var Ke=Ge.child;if(Ke!==null)Ke.return=Ge,lt=Ke;else for(;lt!==null;){Ge=lt;var He=Ge.sibling,at=Ge.return;if(MT(Ge),Ge===De){lt=null;break}if(He!==null){He.return=at,lt=He;break}lt=at}}}var ut=z.alternate;if(ut!==null){var mt=ut.child;if(mt!==null){ut.child=null;do{var ir=mt.sibling;mt.sibling=null,mt=ir}while(mt!==null)}}lt=z}}if((z.subtreeFlags&2064)!==0&&J!==null)J.return=z,lt=J;else e:for(;lt!==null;){if(z=lt,(z.flags&2048)!==0)switch(z.tag){case 0:case 11:case 15:hh(9,z,z.return)}var Se=z.sibling;if(Se!==null){Se.return=z.return,lt=Se;break e}lt=z.return}}var be=u.current;for(lt=be;lt!==null;){J=lt;var Pe=J.child;if((J.subtreeFlags&2064)!==0&&Pe!==null)Pe.return=J,lt=Pe;else e:for(J=be;lt!==null;){if(fe=lt,(fe.flags&2048)!==0)try{switch(fe.tag){case 0:case 11:case 15:mp(9,fe)}}catch(gt){rr(fe,fe.return,gt)}if(fe===J){lt=null;break e}var Je=fe.sibling;if(Je!==null){Je.return=fe.return,lt=Je;break e}lt=fe.return}}if(ln=R,hc(),Fr&&typeof Fr.onPostCommitFiberRoot=="function")try{Fr.onPostCommitFiberRoot(aa,u)}catch{}k=!0}return k}finally{Kt=b,Ui.transition=m}}return!1}function HT(u,m,b){m=Uu(b,m),m=dT(u,m,1),u=pc(u,m,1),m=ws(),u!==null&&(qr(u,1,m),zs(u,m))}function rr(u,m,b){if(u.tag===3)HT(u,u,b);else for(;m!==null;){if(m.tag===3){HT(m,u,b);break}else if(m.tag===1){var k=m.stateNode;if(typeof m.type.getDerivedStateFromError=="function"||typeof k.componentDidCatch=="function"&&(xc===null||!xc.has(k))){u=Uu(b,u),u=uT(m,u,1),m=pc(m,u,1),u=ws(),m!==null&&(qr(m,1,u),zs(m,u));break}}m=m.return}}function jq(u,m,b){var k=u.pingCache;k!==null&&k.delete(m),m=ws(),u.pingedLanes|=u.suspendedLanes&b,Or===u&&(Hr&b)===b&&(Sr===4||Sr===3&&(Hr&130023424)===Hr&&500>Pn()-Mv?zd(u,0):Pv|=b),zs(u,m)}function YT(u,m){m===0&&((u.mode&1)===0?m=1:(m=Si,Si<<=1,(Si&130023424)===0&&(Si=4194304)));var b=ws();u=ol(u,m),u!==null&&(qr(u,m,b),zs(u,b))}function Nq(u){var m=u.memoizedState,b=0;m!==null&&(b=m.retryLane),YT(u,b)}function Sq(u,m){var b=0;switch(u.tag){case 13:var k=u.stateNode,R=u.memoizedState;R!==null&&(b=R.retryLane);break;case 19:k=u.stateNode;break;default:throw Error(t(314))}k!==null&&k.delete(m),YT(u,b)}var GT;GT=function(u,m,b){if(u!==null)if(u.memoizedProps!==m.pendingProps||Rs.current)Fs=!0;else{if((u.lanes&b)===0&&(m.flags&128)===0)return Fs=!1,fq(u,m,b);Fs=(u.flags&131072)!==0}else Fs=!1,$n&&(m.flags&1048576)!==0&&TC(m,Jm,m.index);switch(m.lanes=0,m.tag){case 2:var k=m.type;fp(u,m),u=m.pendingProps;var R=Ou(m,ns.current);qu(m,b),R=ov(null,m,k,u,R,b);var z=lv();return m.flags|=1,typeof R=="object"&&R!==null&&typeof R.render=="function"&&R.$$typeof===void 0?(m.tag=1,m.memoizedState=null,m.updateQueue=null,Ls(k)?(z=!0,Gm(m)):z=!1,m.memoizedState=R.state!==null&&R.state!==void 0?R.state:null,ev(m),R.updater=dp,m.stateNode=R,R._reactInternals=m,mv(m,k,u,b),m=yv(null,m,k,!0,z,b)):(m.tag=0,$n&&z&&Wy(m),bs(null,m,R,b),m=m.child),m;case 16:k=m.elementType;e:{switch(fp(u,m),u=m.pendingProps,R=k._init,k=R(k._payload),m.type=k,R=m.tag=Tq(k),u=ya(k,u),R){case 0:m=xv(null,m,k,u,b);break e;case 1:m=bT(null,m,k,u,b);break e;case 11:m=pT(null,m,k,u,b);break e;case 14:m=gT(null,m,k,ya(k.type,u),b);break e}throw Error(t(306,k,""))}return m;case 0:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),xv(u,m,k,R,b);case 1:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),bT(u,m,k,R,b);case 3:e:{if(wT(m),u===null)throw Error(t(387));k=m.pendingProps,z=m.memoizedState,R=z.element,RC(u,m),rp(m,k,null,b);var J=m.memoizedState;if(k=J.element,z.isDehydrated)if(z={element:k,isDehydrated:!1,cache:J.cache,pendingSuspenseBoundaries:J.pendingSuspenseBoundaries,transitions:J.transitions},m.updateQueue.baseState=z,m.memoizedState=z,m.flags&256){R=Uu(Error(t(423)),m),m=_T(u,m,k,b,R);break e}else if(k!==R){R=Uu(Error(t(424)),m),m=_T(u,m,k,b,R);break e}else for(ci=co(m.stateNode.containerInfo.firstChild),li=m,$n=!0,xa=null,b=IC(m,null,k,b),m.child=b;b;)b.flags=b.flags&-3|4096,b=b.sibling;else{if(Ru(),k===R){m=cl(u,m,b);break e}bs(u,m,k,b)}m=m.child}return m;case 5:return qC(m),u===null&&Yy(m),k=m.type,R=m.pendingProps,z=u!==null?u.memoizedProps:null,J=R.children,$t(k,R)?J=null:z!==null&&$t(k,z)&&(m.flags|=32),vT(u,m),bs(u,m,J,b),m.child;case 6:return u===null&&Yy(m),null;case 13:return jT(u,m,b);case 4:return tv(m,m.stateNode.containerInfo),k=m.pendingProps,u===null?m.child=Lu(m,null,k,b):bs(u,m,k,b),m.child;case 11:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),pT(u,m,k,R,b);case 7:return bs(u,m,m.pendingProps,b),m.child;case 8:return bs(u,m,m.pendingProps.children,b),m.child;case 12:return bs(u,m,m.pendingProps.children,b),m.child;case 10:e:{if(k=m.type._context,R=m.pendingProps,z=m.memoizedProps,J=R.value,Rn(ep,k._currentValue),k._currentValue=J,z!==null)if(Wr(z.value,J)){if(z.children===R.children&&!Rs.current){m=cl(u,m,b);break e}}else for(z=m.child,z!==null&&(z.return=m);z!==null;){var fe=z.dependencies;if(fe!==null){J=z.child;for(var ge=fe.firstContext;ge!==null;){if(ge.context===k){if(z.tag===1){ge=ll(-1,b&-b),ge.tag=2;var De=z.updateQueue;if(De!==null){De=De.shared;var Ge=De.pending;Ge===null?ge.next=ge:(ge.next=Ge.next,Ge.next=ge),De.pending=ge}}z.lanes|=b,ge=z.alternate,ge!==null&&(ge.lanes|=b),Qy(z.return,b,m),fe.lanes|=b;break}ge=ge.next}}else if(z.tag===10)J=z.type===m.type?null:z.child;else if(z.tag===18){if(J=z.return,J===null)throw Error(t(341));J.lanes|=b,fe=J.alternate,fe!==null&&(fe.lanes|=b),Qy(J,b,m),J=z.sibling}else J=z.child;if(J!==null)J.return=z;else for(J=z;J!==null;){if(J===m){J=null;break}if(z=J.sibling,z!==null){z.return=J.return,J=z;break}J=J.return}z=J}bs(u,m,R.children,b),m=m.child}return m;case 9:return R=m.type,k=m.pendingProps.children,qu(m,b),R=qi(R),k=k(R),m.flags|=1,bs(u,m,k,b),m.child;case 14:return k=m.type,R=ya(k,m.pendingProps),R=ya(k.type,R),gT(u,m,k,R,b);case 15:return xT(u,m,m.type,m.pendingProps,b);case 17:return k=m.type,R=m.pendingProps,R=m.elementType===k?R:ya(k,R),fp(u,m),m.tag=1,Ls(k)?(u=!0,Gm(m)):u=!1,qu(m,b),lT(m,k,R),mv(m,k,R,b),yv(null,m,k,!0,u,b);case 19:return ST(u,m,b);case 22:return yT(u,m,b)}throw Error(t(156,m.tag))};function ZT(u,m){return Fl(u,m)}function Cq(u,m,b,k){this.tag=u,this.key=b,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=m,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=k,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bi(u,m,b,k){return new Cq(u,m,b,k)}function Fv(u){return u=u.prototype,!(!u||!u.isReactComponent)}function Tq(u){if(typeof u=="function")return Fv(u)?1:0;if(u!=null){if(u=u.$$typeof,u===G)return 11;if(u===ae)return 14}return 2}function wc(u,m){var b=u.alternate;return b===null?(b=Bi(u.tag,m,u.key,u.mode),b.elementType=u.elementType,b.type=u.type,b.stateNode=u.stateNode,b.alternate=u,u.alternate=b):(b.pendingProps=m,b.type=u.type,b.flags=0,b.subtreeFlags=0,b.deletions=null),b.flags=u.flags&14680064,b.childLanes=u.childLanes,b.lanes=u.lanes,b.child=u.child,b.memoizedProps=u.memoizedProps,b.memoizedState=u.memoizedState,b.updateQueue=u.updateQueue,m=u.dependencies,b.dependencies=m===null?null:{lanes:m.lanes,firstContext:m.firstContext},b.sibling=u.sibling,b.index=u.index,b.ref=u.ref,b}function jp(u,m,b,k,R,z){var J=2;if(k=u,typeof u=="function")Fv(u)&&(J=1);else if(typeof u=="string")J=5;else e:switch(u){case F:return Bd(b.children,R,z,m);case q:J=8,R|=8;break;case B:return u=Bi(12,b,m,R|2),u.elementType=B,u.lanes=z,u;case Z:return u=Bi(13,b,m,R),u.elementType=Z,u.lanes=z,u;case Y:return u=Bi(19,b,m,R),u.elementType=Y,u.lanes=z,u;case me:return Np(b,R,z,m);default:if(typeof u=="object"&&u!==null)switch(u.$$typeof){case U:J=10;break e;case W:J=9;break e;case G:J=11;break e;case ae:J=14;break e;case ee:J=16,k=null;break e}throw Error(t(130,u==null?u:typeof u,""))}return m=Bi(J,b,m,R),m.elementType=u,m.type=k,m.lanes=z,m}function Bd(u,m,b,k){return u=Bi(7,u,k,m),u.lanes=b,u}function Np(u,m,b,k){return u=Bi(22,u,k,m),u.elementType=me,u.lanes=b,u.stateNode={isHidden:!1},u}function qv(u,m,b){return u=Bi(6,u,null,m),u.lanes=b,u}function zv(u,m,b){return m=Bi(4,u.children!==null?u.children:[],u.key,m),m.lanes=b,m.stateNode={containerInfo:u.containerInfo,pendingChildren:null,implementation:u.implementation},m}function kq(u,m,b,k,R){this.tag=m,this.containerInfo=u,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Ci(0),this.expirationTimes=Ci(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ci(0),this.identifierPrefix=k,this.onRecoverableError=R,this.mutableSourceEagerHydrationData=null}function Uv(u,m,b,k,R,z,J,fe,ge){return u=new kq(u,m,b,fe,ge),m===1?(m=1,z===!0&&(m|=8)):m=0,z=Bi(3,null,null,m),u.current=z,z.stateNode=u,z.memoizedState={element:k,isDehydrated:b,cache:null,transitions:null,pendingSuspenseBoundaries:null},ev(z),u}function Pq(u,m,b){var k=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:I,key:k==null?null:""+k,children:u,containerInfo:m,implementation:b}}function KT(u){if(!u)return fc;u=u._reactInternals;e:{if(Ms(u)!==u||u.tag!==1)throw Error(t(170));var m=u;do{switch(m.tag){case 3:m=m.stateNode.context;break e;case 1:if(Ls(m.type)){m=m.stateNode.__reactInternalMemoizedMergedChildContext;break e}}m=m.return}while(m!==null);throw Error(t(171))}if(u.tag===1){var b=u.type;if(Ls(b))return NC(u,b,m)}return m}function JT(u,m,b,k,R,z,J,fe,ge){return u=Uv(b,k,!0,u,R,z,J,fe,ge),u.context=KT(null),b=u.current,k=ws(),R=vc(b),z=ll(k,R),z.callback=m??null,pc(b,z,R),u.current.lanes=R,qr(u,R,k),zs(u,k),u}function Sp(u,m,b,k){var R=m.current,z=ws(),J=vc(R);return b=KT(b),m.context===null?m.context=b:m.pendingContext=b,m=ll(z,J),m.payload={element:u},k=k===void 0?null:k,k!==null&&(m.callback=k),u=pc(R,m,J),u!==null&&(wa(u,R,J,z),np(u,R,J)),J}function Cp(u){if(u=u.current,!u.child)return null;switch(u.child.tag){case 5:return u.child.stateNode;default:return u.child.stateNode}}function QT(u,m){if(u=u.memoizedState,u!==null&&u.dehydrated!==null){var b=u.retryLane;u.retryLane=b!==0&&b<m?b:m}}function Bv(u,m){QT(u,m),(u=u.alternate)&&QT(u,m)}function Mq(){return null}var XT=typeof reportError=="function"?reportError:function(u){console.error(u)};function Vv(u){this._internalRoot=u}Tp.prototype.render=Vv.prototype.render=function(u){var m=this._internalRoot;if(m===null)throw Error(t(409));Sp(u,m,null,null)},Tp.prototype.unmount=Vv.prototype.unmount=function(){var u=this._internalRoot;if(u!==null){this._internalRoot=null;var m=u.containerInfo;qd(function(){Sp(null,u,null,null)}),m[yn]=null}};function Tp(u){this._internalRoot=u}Tp.prototype.unstable_scheduleHydration=function(u){if(u){var m=Ha();u={blockedOn:null,target:u,priority:m};for(var b=0;b<Gn.length&&m!==0&&m<Gn[b].priority;b++);Gn.splice(b,0,u),b===0&&Ya(u)}};function Wv(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11)}function kp(u){return!(!u||u.nodeType!==1&&u.nodeType!==9&&u.nodeType!==11&&(u.nodeType!==8||u.nodeValue!==" react-mount-point-unstable "))}function ek(){}function Eq(u,m,b,k,R){if(R){if(typeof k=="function"){var z=k;k=function(){var De=Cp(J);z.call(De)}}var J=JT(m,k,u,0,null,!1,!1,"",ek);return u._reactRootContainer=J,u[yn]=J.current,oc(u.nodeType===8?u.parentNode:u),qd(),J}for(;R=u.lastChild;)u.removeChild(R);if(typeof k=="function"){var fe=k;k=function(){var De=Cp(ge);fe.call(De)}}var ge=Uv(u,0,!1,null,null,!1,!1,"",ek);return u._reactRootContainer=ge,u[yn]=ge.current,oc(u.nodeType===8?u.parentNode:u),qd(function(){Sp(m,ge,b,k)}),ge}function Pp(u,m,b,k,R){var z=b._reactRootContainer;if(z){var J=z;if(typeof R=="function"){var fe=R;R=function(){var ge=Cp(J);fe.call(ge)}}Sp(m,J,u,R)}else J=Eq(b,m,u,R,k);return Cp(J)}Wa=function(u){switch(u.tag){case 3:var m=u.stateNode;if(m.current.memoizedState.isDehydrated){var b=Dt(m.pendingLanes);b!==0&&(ms(m,b|1),zs(m,Pn()),(ln&6)===0&&(Wu=Pn()+500,hc()))}break;case 13:qd(function(){var k=ol(u,1);if(k!==null){var R=ws();wa(k,u,1,R)}}),Bv(u,1)}},ei=function(u){if(u.tag===13){var m=ol(u,134217728);if(m!==null){var b=ws();wa(m,u,134217728,b)}Bv(u,134217728)}},$a=function(u){if(u.tag===13){var m=vc(u),b=ol(u,m);if(b!==null){var k=ws();wa(b,u,m,k)}Bv(u,m)}},Ha=function(){return Kt},la=function(u,m){var b=Kt;try{return Kt=u,m()}finally{Kt=b}},nr=function(u,m,b){switch(m){case"input":if(Oe(u,b),m=b.name,b.type==="radio"&&m!=null){for(b=u;b.parentNode;)b=b.parentNode;for(b=b.querySelectorAll("input[name="+JSON.stringify(""+m)+'][type="radio"]'),m=0;m<b.length;m++){var k=b[m];if(k!==u&&k.form===u.form){var R=Eu(k);if(!R)throw Error(t(90));je(k),Oe(k,R)}}}break;case"textarea":Ie(u,b);break;case"select":m=b.value,m!=null&&le(u,!!b.multiple,m,!1)}},Ps=Av,Qs=qd;var Dq={usingClientEntryPoint:!1,Events:[nl,rl,Eu,Jr,kn,Av]},xh={findFiberByHostInstance:tl,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},Oq={bundleType:xh.bundleType,version:xh.version,rendererPackageName:xh.rendererPackageName,rendererConfig:xh.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:M.ReactCurrentDispatcher,findHostInstanceByFiber:function(u){return u=Rl(u),u===null?null:u.stateNode},findFiberByHostInstance:xh.findFiberByHostInstance||Mq,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Mp=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Mp.isDisabled&&Mp.supportsFiber)try{aa=Mp.inject(Oq),Fr=Mp}catch{}}return Us.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=Dq,Us.createPortal=function(u,m){var b=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Wv(m))throw Error(t(200));return Pq(u,m,null,b)},Us.createRoot=function(u,m){if(!Wv(u))throw Error(t(299));var b=!1,k="",R=XT;return m!=null&&(m.unstable_strictMode===!0&&(b=!0),m.identifierPrefix!==void 0&&(k=m.identifierPrefix),m.onRecoverableError!==void 0&&(R=m.onRecoverableError)),m=Uv(u,1,!1,null,null,b,!1,k,R),u[yn]=m.current,oc(u.nodeType===8?u.parentNode:u),new Vv(m)},Us.findDOMNode=function(u){if(u==null)return null;if(u.nodeType===1)return u;var m=u._reactInternals;if(m===void 0)throw typeof u.render=="function"?Error(t(188)):(u=Object.keys(u).join(","),Error(t(268,u)));return u=Rl(m),u=u===null?null:u.stateNode,u},Us.flushSync=function(u){return qd(u)},Us.hydrate=function(u,m,b){if(!kp(m))throw Error(t(200));return Pp(null,u,m,!0,b)},Us.hydrateRoot=function(u,m,b){if(!Wv(u))throw Error(t(405));var k=b!=null&&b.hydratedSources||null,R=!1,z="",J=XT;if(b!=null&&(b.unstable_strictMode===!0&&(R=!0),b.identifierPrefix!==void 0&&(z=b.identifierPrefix),b.onRecoverableError!==void 0&&(J=b.onRecoverableError)),m=JT(m,null,u,1,b??null,R,!1,z,J),u[yn]=m.current,oc(u),k)for(u=0;u<k.length;u++)b=k[u],R=b._getVersion,R=R(b._source),m.mutableSourceEagerHydrationData==null?m.mutableSourceEagerHydrationData=[b,R]:m.mutableSourceEagerHydrationData.push(b,R);return new Tp(m)},Us.render=function(u,m,b){if(!kp(m))throw Error(t(200));return Pp(null,u,m,!1,b)},Us.unmountComponentAtNode=function(u){if(!kp(u))throw Error(t(40));return u._reactRootContainer?(qd(function(){Pp(null,null,u,!1,function(){u._reactRootContainer=null,u[yn]=null})}),!0):!1},Us.unstable_batchedUpdates=Av,Us.unstable_renderSubtreeIntoContainer=function(u,m,b,k){if(!kp(b))throw Error(t(200));if(u==null||u._reactInternals===void 0)throw Error(t(38));return Pp(u,m,b,!1,k)},Us.version="18.3.1-next-f1338f8080-20240426",Us}var lk;function t4(){if(lk)return Yv.exports;lk=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),Yv.exports=zq(),Yv.exports}var ck;function Uq(){if(ck)return Ep;ck=1;var n=t4();return Ep.createRoot=n.createRoot,Ep.hydrateRoot=n.hydrateRoot,Ep}var Bq=Uq();const Vq=bu(Bq);var n4=t4();function am(){return am=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},am.apply(this,arguments)}var Ac;(function(n){n.Pop="POP",n.Push="PUSH",n.Replace="REPLACE"})(Ac||(Ac={}));const dk="popstate";function Wq(n){n===void 0&&(n={});function e(s,a){let{pathname:o="/",search:l="",hash:c=""}=wu(s.location.hash.substr(1));return!o.startsWith("/")&&!o.startsWith(".")&&(o="/"+o),UN("",{pathname:o,search:l,hash:c},a.state&&a.state.usr||null,a.state&&a.state.key||"default")}function t(s,a){let o=s.document.querySelector("base"),l="";if(o&&o.getAttribute("href")){let c=s.location.href,d=c.indexOf("#");l=d===-1?c:c.slice(0,d)}return l+"#"+(typeof a=="string"?a:gx(a))}function r(s,a){Zx(s.pathname.charAt(0)==="/","relative pathnames are not supported in hash history.push("+JSON.stringify(a)+")")}return Hq(e,t,r,n)}function tr(n,e){if(n===!1||n===null||typeof n>"u")throw new Error(e)}function Zx(n,e){if(!n){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function $q(){return Math.random().toString(36).substr(2,8)}function uk(n,e){return{usr:n.state,key:n.key,idx:e}}function UN(n,e,t,r){return t===void 0&&(t=null),am({pathname:typeof n=="string"?n:n.pathname,search:"",hash:""},typeof e=="string"?wu(e):e,{state:t,key:e&&e.key||r||$q()})}function gx(n){let{pathname:e="/",search:t="",hash:r=""}=n;return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),r&&r!=="#"&&(e+=r.charAt(0)==="#"?r:"#"+r),e}function wu(n){let e={};if(n){let t=n.indexOf("#");t>=0&&(e.hash=n.substr(t),n=n.substr(0,t));let r=n.indexOf("?");r>=0&&(e.search=n.substr(r),n=n.substr(0,r)),n&&(e.pathname=n)}return e}function Hq(n,e,t,r){r===void 0&&(r={});let{window:s=document.defaultView,v5Compat:a=!1}=r,o=s.history,l=Ac.Pop,c=null,d=h();d==null&&(d=0,o.replaceState(am({},o.state,{idx:d}),""));function h(){return(o.state||{idx:null}).idx}function p(){l=Ac.Pop;let j=h(),C=j==null?null:j-d;d=j,c&&c({action:l,location:w.location,delta:C})}function x(j,C){l=Ac.Push;let P=UN(w.location,j,C);t&&t(P,j),d=h()+1;let O=uk(P,d),M=w.createHref(P);try{o.pushState(O,"",M)}catch(D){if(D instanceof DOMException&&D.name==="DataCloneError")throw D;s.location.assign(M)}a&&c&&c({action:l,location:w.location,delta:1})}function y(j,C){l=Ac.Replace;let P=UN(w.location,j,C);t&&t(P,j),d=h();let O=uk(P,d),M=w.createHref(P);o.replaceState(O,"",M),a&&c&&c({action:l,location:w.location,delta:0})}function _(j){let C=s.location.origin!=="null"?s.location.origin:s.location.href,P=typeof j=="string"?j:gx(j);return P=P.replace(/ $/,"%20"),tr(C,"No window.location.(origin|href) available to create URL for href: "+P),new URL(P,C)}let w={get action(){return l},get location(){return n(s,o)},listen(j){if(c)throw new Error("A history only accepts one active listener");return s.addEventListener(dk,p),c=j,()=>{s.removeEventListener(dk,p),c=null}},createHref(j){return e(s,j)},createURL:_,encodeLocation(j){let C=_(j);return{pathname:C.pathname,search:C.search,hash:C.hash}},push:x,replace:y,go(j){return o.go(j)}};return w}var fk;(function(n){n.data="data",n.deferred="deferred",n.redirect="redirect",n.error="error"})(fk||(fk={}));function Yq(n,e,t){return t===void 0&&(t="/"),Gq(n,e,t)}function Gq(n,e,t,r){let s=typeof e=="string"?wu(e):e,a=wf(s.pathname||"/",t);if(a==null)return null;let o=r4(n);Zq(o);let l=null;for(let c=0;l==null&&c<o.length;++c){let d=az(a);l=sz(o[c],d)}return l}function r4(n,e,t,r){e===void 0&&(e=[]),t===void 0&&(t=[]),r===void 0&&(r="");let s=(a,o,l)=>{let c={relativePath:l===void 0?a.path||"":l,caseSensitive:a.caseSensitive===!0,childrenIndex:o,route:a};c.relativePath.startsWith("/")&&(tr(c.relativePath.startsWith(r),'Absolute route path "'+c.relativePath+'" nested under path '+('"'+r+'" is not valid. An absolute child route path ')+"must start with the combined path of all its parent routes."),c.relativePath=c.relativePath.slice(r.length));let d=zc([r,c.relativePath]),h=t.concat(c);a.children&&a.children.length>0&&(tr(a.index!==!0,"Index routes must not have child routes. Please remove "+('all child routes from route path "'+d+'".')),r4(a.children,e,h,d)),!(a.path==null&&!a.index)&&e.push({path:d,score:nz(d,a.index),routesMeta:h})};return n.forEach((a,o)=>{var l;if(a.path===""||!((l=a.path)!=null&&l.includes("?")))s(a,o);else for(let c of s4(a.path))s(a,o,c)}),e}function s4(n){let e=n.split("/");if(e.length===0)return[];let[t,...r]=e,s=t.endsWith("?"),a=t.replace(/\?$/,"");if(r.length===0)return s?[a,""]:[a];let o=s4(r.join("/")),l=[];return l.push(...o.map(c=>c===""?a:[a,c].join("/"))),s&&l.push(...o),l.map(c=>n.startsWith("/")&&c===""?"/":c)}function Zq(n){n.sort((e,t)=>e.score!==t.score?t.score-e.score:rz(e.routesMeta.map(r=>r.childrenIndex),t.routesMeta.map(r=>r.childrenIndex)))}const Kq=/^:[\w-]+$/,Jq=3,Qq=2,Xq=1,ez=10,tz=-2,hk=n=>n==="*";function nz(n,e){let t=n.split("/"),r=t.length;return t.some(hk)&&(r+=tz),e&&(r+=Qq),t.filter(s=>!hk(s)).reduce((s,a)=>s+(Kq.test(a)?Jq:a===""?Xq:ez),r)}function rz(n,e){return n.length===e.length&&n.slice(0,-1).every((r,s)=>r===e[s])?n[n.length-1]-e[e.length-1]:0}function sz(n,e,t){let{routesMeta:r}=n,s={},a="/",o=[];for(let l=0;l<r.length;++l){let c=r[l],d=l===r.length-1,h=a==="/"?e:e.slice(a.length)||"/",p=BN({path:c.relativePath,caseSensitive:c.caseSensitive,end:d},h),x=c.route;if(!p)return null;Object.assign(s,p.params),o.push({params:s,pathname:zc([a,p.pathname]),pathnameBase:uz(zc([a,p.pathnameBase])),route:x}),p.pathnameBase!=="/"&&(a=zc([a,p.pathnameBase]))}return o}function BN(n,e){typeof n=="string"&&(n={path:n,caseSensitive:!1,end:!0});let[t,r]=iz(n.path,n.caseSensitive,n.end),s=e.match(t);if(!s)return null;let a=s[0],o=a.replace(/(.)\/+$/,"$1"),l=s.slice(1);return{params:r.reduce((d,h,p)=>{let{paramName:x,isOptional:y}=h;if(x==="*"){let w=l[p]||"";o=a.slice(0,a.length-w.length).replace(/(.)\/+$/,"$1")}const _=l[p];return y&&!_?d[x]=void 0:d[x]=(_||"").replace(/%2F/g,"/"),d},{}),pathname:a,pathnameBase:o,pattern:n}}function iz(n,e,t){e===void 0&&(e=!1),t===void 0&&(t=!0),Zx(n==="*"||!n.endsWith("*")||n.endsWith("/*"),'Route path "'+n+'" will be treated as if it were '+('"'+n.replace(/\*$/,"/*")+'" because the `*` character must ')+"always follow a `/` in the pattern. To get rid of this warning, "+('please change the route path to "'+n.replace(/\*$/,"/*")+'".'));let r=[],s="^"+n.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(o,l,c)=>(r.push({paramName:l,isOptional:c!=null}),c?"/?([^\\/]+)?":"/([^\\/]+)"));return n.endsWith("*")?(r.push({paramName:"*"}),s+=n==="*"||n==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):t?s+="\\/*$":n!==""&&n!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function az(n){try{return n.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Zx(!1,'The URL path "'+n+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent '+("encoding ("+e+").")),n}}function wf(n,e){if(e==="/")return n;if(!n.toLowerCase().startsWith(e.toLowerCase()))return null;let t=e.endsWith("/")?e.length-1:e.length,r=n.charAt(t);return r&&r!=="/"?null:n.slice(t)||"/"}const oz=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,lz=n=>oz.test(n);function cz(n,e){e===void 0&&(e="/");let{pathname:t,search:r="",hash:s=""}=typeof n=="string"?wu(n):n,a;if(t)if(lz(t))a=t;else{if(t.includes("//")){let o=t;t=t.replace(/\/\/+/g,"/"),Zx(!1,"Pathnames cannot have embedded double slashes - normalizing "+(o+" -> "+t))}t.startsWith("/")?a=mk(t.substring(1),"/"):a=mk(t,e)}else a=e;return{pathname:a,search:fz(r),hash:hz(s)}}function mk(n,e){let t=e.replace(/\/+$/,"").split("/");return n.split("/").forEach(s=>{s===".."?t.length>1&&t.pop():s!=="."&&t.push(s)}),t.length>1?t.join("/"):"/"}function Kv(n,e,t,r){return"Cannot include a '"+n+"' character in a manually specified "+("`to."+e+"` field ["+JSON.stringify(r)+"].  Please separate it out to the ")+("`to."+t+"` field. Alternatively you may provide the full path as ")+'a string in <Link to="..."> and the router will parse it for you.'}function dz(n){return n.filter((e,t)=>t===0||e.route.path&&e.route.path.length>0)}function r1(n,e){let t=dz(n);return e?t.map((r,s)=>s===t.length-1?r.pathname:r.pathnameBase):t.map(r=>r.pathnameBase)}function s1(n,e,t,r){r===void 0&&(r=!1);let s;typeof n=="string"?s=wu(n):(s=am({},n),tr(!s.pathname||!s.pathname.includes("?"),Kv("?","pathname","search",s)),tr(!s.pathname||!s.pathname.includes("#"),Kv("#","pathname","hash",s)),tr(!s.search||!s.search.includes("#"),Kv("#","search","hash",s)));let a=n===""||s.pathname==="",o=a?"/":s.pathname,l;if(o==null)l=t;else{let p=e.length-1;if(!r&&o.startsWith("..")){let x=o.split("/");for(;x[0]==="..";)x.shift(),p-=1;s.pathname=x.join("/")}l=p>=0?e[p]:"/"}let c=cz(s,l),d=o&&o!=="/"&&o.endsWith("/"),h=(a||o===".")&&t.endsWith("/");return!c.pathname.endsWith("/")&&(d||h)&&(c.pathname+="/"),c}const zc=n=>n.join("/").replace(/\/\/+/g,"/"),uz=n=>n.replace(/\/+$/,"").replace(/^\/*/,"/"),fz=n=>!n||n==="?"?"":n.startsWith("?")?n:"?"+n,hz=n=>!n||n==="#"?"":n.startsWith("#")?n:"#"+n;function mz(n){return n!=null&&typeof n.status=="number"&&typeof n.statusText=="string"&&typeof n.internal=="boolean"&&"data"in n}const i4=["post","put","patch","delete"];new Set(i4);const pz=["get",...i4];new Set(pz);function om(){return om=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},om.apply(this,arguments)}const Kx=E.createContext(null),a4=E.createContext(null),Ml=E.createContext(null),Jx=E.createContext(null),ko=E.createContext({outlet:null,matches:[],isDataRoute:!1}),o4=E.createContext(null);function gz(n,e){let{relative:t}=e===void 0?{}:e;Uf()||tr(!1);let{basename:r,navigator:s}=E.useContext(Ml),{hash:a,pathname:o,search:l}=Qx(n,{relative:t}),c=o;return r!=="/"&&(c=o==="/"?r:zc([r,o])),s.createHref({pathname:c,search:l,hash:a})}function Uf(){return E.useContext(Jx)!=null}function Zr(){return Uf()||tr(!1),E.useContext(Jx).location}function l4(n){E.useContext(Ml).static||E.useLayoutEffect(n)}function St(){let{isDataRoute:n}=E.useContext(ko);return n?Mz():xz()}function xz(){Uf()||tr(!1);let n=E.useContext(Kx),{basename:e,future:t,navigator:r}=E.useContext(Ml),{matches:s}=E.useContext(ko),{pathname:a}=Zr(),o=JSON.stringify(r1(s,t.v7_relativeSplatPath)),l=E.useRef(!1);return l4(()=>{l.current=!0}),E.useCallback(function(d,h){if(h===void 0&&(h={}),!l.current)return;if(typeof d=="number"){r.go(d);return}let p=s1(d,JSON.parse(o),a,h.relative==="path");n==null&&e!=="/"&&(p.pathname=p.pathname==="/"?e:zc([e,p.pathname])),(h.replace?r.replace:r.push)(p,h.state,h)},[e,r,o,a,n])}const c4=E.createContext(null);function wi(){return E.useContext(c4)}function yz(n){let e=E.useContext(ko).outlet;return e&&E.createElement(c4.Provider,{value:n},e)}function Bf(){let{matches:n}=E.useContext(ko),e=n[n.length-1];return e?e.params:{}}function Qx(n,e){let{relative:t}=e===void 0?{}:e,{future:r}=E.useContext(Ml),{matches:s}=E.useContext(ko),{pathname:a}=Zr(),o=JSON.stringify(r1(s,r.v7_relativeSplatPath));return E.useMemo(()=>s1(n,JSON.parse(o),a,t==="path"),[n,o,a,t])}function vz(n,e){return bz(n,e)}function bz(n,e,t,r){Uf()||tr(!1);let{navigator:s}=E.useContext(Ml),{matches:a}=E.useContext(ko),o=a[a.length-1],l=o?o.params:{};o&&o.pathname;let c=o?o.pathnameBase:"/";o&&o.route;let d=Zr(),h;if(e){var p;let j=typeof e=="string"?wu(e):e;c==="/"||(p=j.pathname)!=null&&p.startsWith(c)||tr(!1),h=j}else h=d;let x=h.pathname||"/",y=x;if(c!=="/"){let j=c.replace(/^\//,"").split("/");y="/"+x.replace(/^\//,"").split("/").slice(j.length).join("/")}let _=Yq(n,{pathname:y}),w=Sz(_&&_.map(j=>Object.assign({},j,{params:Object.assign({},l,j.params),pathname:zc([c,s.encodeLocation?s.encodeLocation(j.pathname).pathname:j.pathname]),pathnameBase:j.pathnameBase==="/"?c:zc([c,s.encodeLocation?s.encodeLocation(j.pathnameBase).pathname:j.pathnameBase])})),a,t,r);return e&&w?E.createElement(Jx.Provider,{value:{location:om({pathname:"/",search:"",hash:"",state:null,key:"default"},h),navigationType:Ac.Pop}},w):w}function wz(){let n=Pz(),e=mz(n)?n.status+" "+n.statusText:n instanceof Error?n.message:JSON.stringify(n),t=n instanceof Error?n.stack:null,s={padding:"0.5rem",backgroundColor:"rgba(200,200,200, 0.5)"};return E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},e),t?E.createElement("pre",{style:s},t):null,null)}const _z=E.createElement(wz,null);class jz extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(ko.Provider,{value:this.props.routeContext},E.createElement(o4.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function Nz(n){let{routeContext:e,match:t,children:r}=n,s=E.useContext(Kx);return s&&s.static&&s.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(s.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(ko.Provider,{value:e},r)}function Sz(n,e,t,r){var s;if(e===void 0&&(e=[]),t===void 0&&(t=null),r===void 0&&(r=null),n==null){var a;if(!t)return null;if(t.errors)n=t.matches;else if((a=r)!=null&&a.v7_partialHydration&&e.length===0&&!t.initialized&&t.matches.length>0)n=t.matches;else return null}let o=n,l=(s=t)==null?void 0:s.errors;if(l!=null){let h=o.findIndex(p=>p.route.id&&l?.[p.route.id]!==void 0);h>=0||tr(!1),o=o.slice(0,Math.min(o.length,h+1))}let c=!1,d=-1;if(t&&r&&r.v7_partialHydration)for(let h=0;h<o.length;h++){let p=o[h];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(d=h),p.route.id){let{loaderData:x,errors:y}=t,_=p.route.loader&&x[p.route.id]===void 0&&(!y||y[p.route.id]===void 0);if(p.route.lazy||_){c=!0,d>=0?o=o.slice(0,d+1):o=[o[0]];break}}}return o.reduceRight((h,p,x)=>{let y,_=!1,w=null,j=null;t&&(y=l&&p.route.id?l[p.route.id]:void 0,w=p.route.errorElement||_z,c&&(d<0&&x===0?(Ez("route-fallback"),_=!0,j=null):d===x&&(_=!0,j=p.route.hydrateFallbackElement||null)));let C=e.concat(o.slice(0,x+1)),P=()=>{let O;return y?O=w:_?O=j:p.route.Component?O=E.createElement(p.route.Component,null):p.route.element?O=p.route.element:O=h,E.createElement(Nz,{match:p,routeContext:{outlet:h,matches:C,isDataRoute:t!=null},children:O})};return t&&(p.route.ErrorBoundary||p.route.errorElement||x===0)?E.createElement(jz,{location:t.location,revalidation:t.revalidation,component:w,error:y,children:P(),routeContext:{outlet:null,matches:C,isDataRoute:!0}}):P()},null)}var d4=(function(n){return n.UseBlocker="useBlocker",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n})(d4||{}),u4=(function(n){return n.UseBlocker="useBlocker",n.UseLoaderData="useLoaderData",n.UseActionData="useActionData",n.UseRouteError="useRouteError",n.UseNavigation="useNavigation",n.UseRouteLoaderData="useRouteLoaderData",n.UseMatches="useMatches",n.UseRevalidator="useRevalidator",n.UseNavigateStable="useNavigate",n.UseRouteId="useRouteId",n})(u4||{});function Cz(n){let e=E.useContext(Kx);return e||tr(!1),e}function Tz(n){let e=E.useContext(a4);return e||tr(!1),e}function kz(n){let e=E.useContext(ko);return e||tr(!1),e}function f4(n){let e=kz(),t=e.matches[e.matches.length-1];return t.route.id||tr(!1),t.route.id}function Pz(){var n;let e=E.useContext(o4),t=Tz(),r=f4();return e!==void 0?e:(n=t.errors)==null?void 0:n[r]}function Mz(){let{router:n}=Cz(d4.UseNavigateStable),e=f4(u4.UseNavigateStable),t=E.useRef(!1);return l4(()=>{t.current=!0}),E.useCallback(function(s,a){a===void 0&&(a={}),t.current&&(typeof s=="number"?n.navigate(s):n.navigate(s,om({fromRouteId:e},a)))},[n,e])}const pk={};function Ez(n,e,t){pk[n]||(pk[n]=!0)}function Dz(n,e){n?.v7_startTransition,n?.v7_relativeSplatPath}function bl(n){let{to:e,replace:t,state:r,relative:s}=n;Uf()||tr(!1);let{future:a,static:o}=E.useContext(Ml),{matches:l}=E.useContext(ko),{pathname:c}=Zr(),d=St(),h=s1(e,r1(l,a.v7_relativeSplatPath),c,s==="path"),p=JSON.stringify(h);return E.useEffect(()=>d(JSON.parse(p),{replace:t,state:r,relative:s}),[d,p,s,t,r]),null}function _f(n){return yz(n.context)}function $e(n){tr(!1)}function Oz(n){let{basename:e="/",children:t=null,location:r,navigationType:s=Ac.Pop,navigator:a,static:o=!1,future:l}=n;Uf()&&tr(!1);let c=e.replace(/^\/*/,"/"),d=E.useMemo(()=>({basename:c,navigator:a,static:o,future:om({v7_relativeSplatPath:!1},l)}),[c,l,a,o]);typeof r=="string"&&(r=wu(r));let{pathname:h="/",search:p="",hash:x="",state:y=null,key:_="default"}=r,w=E.useMemo(()=>{let j=wf(h,c);return j==null?null:{location:{pathname:j,search:p,hash:x,state:y,key:_},navigationType:s}},[c,h,p,x,y,_,s]);return w==null?null:E.createElement(Ml.Provider,{value:d},E.createElement(Jx.Provider,{children:t,value:w}))}function Iz(n){let{children:e,location:t}=n;return vz(VN(e),t)}new Promise(()=>{});function VN(n,e){e===void 0&&(e=[]);let t=[];return E.Children.forEach(n,(r,s)=>{if(!E.isValidElement(r))return;let a=[...e,s];if(r.type===E.Fragment){t.push.apply(t,VN(r.props.children,a));return}r.type!==$e&&tr(!1),!r.props.index||!r.props.children||tr(!1);let o={id:r.props.id||a.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(o.children=VN(r.props.children,a)),t.push(o)}),t}function xx(){return xx=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(n[r]=t[r])}return n},xx.apply(this,arguments)}function h4(n,e){if(n==null)return{};var t={},r=Object.keys(n),s,a;for(a=0;a<r.length;a++)s=r[a],!(e.indexOf(s)>=0)&&(t[s]=n[s]);return t}function Az(n){return!!(n.metaKey||n.altKey||n.ctrlKey||n.shiftKey)}function Rz(n,e){return n.button===0&&(!e||e==="_self")&&!Az(n)}function WN(n){return n===void 0&&(n=""),new URLSearchParams(typeof n=="string"||Array.isArray(n)||n instanceof URLSearchParams?n:Object.keys(n).reduce((e,t)=>{let r=n[t];return e.concat(Array.isArray(r)?r.map(s=>[t,s]):[[t,r]])},[]))}function Lz(n,e){let t=WN(n);return e&&e.forEach((r,s)=>{t.has(s)||e.getAll(s).forEach(a=>{t.append(s,a)})}),t}const Fz=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"],qz=["aria-current","caseSensitive","className","end","style","to","viewTransition","children"],zz="6";try{window.__reactRouterVersion=zz}catch{}const Uz=E.createContext({isTransitioning:!1}),Bz="startTransition",gk=Lq[Bz];function Vz(n){let{basename:e,children:t,future:r,window:s}=n,a=E.useRef();a.current==null&&(a.current=Wq({window:s,v5Compat:!0}));let o=a.current,[l,c]=E.useState({action:o.action,location:o.location}),{v7_startTransition:d}=r||{},h=E.useCallback(p=>{d&&gk?gk(()=>c(p)):c(p)},[c,d]);return E.useLayoutEffect(()=>o.listen(h),[o,h]),E.useEffect(()=>Dz(r),[r]),E.createElement(Oz,{basename:e,children:t,location:l.location,navigationType:l.action,navigator:o,future:r})}const Wz=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u",$z=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Oa=E.forwardRef(function(e,t){let{onClick:r,relative:s,reloadDocument:a,replace:o,state:l,target:c,to:d,preventScrollReset:h,viewTransition:p}=e,x=h4(e,Fz),{basename:y}=E.useContext(Ml),_,w=!1;if(typeof d=="string"&&$z.test(d)&&(_=d,Wz))try{let O=new URL(window.location.href),M=d.startsWith("//")?new URL(O.protocol+d):new URL(d),D=wf(M.pathname,y);M.origin===O.origin&&D!=null?d=D+M.search+M.hash:w=!0}catch{}let j=gz(d,{relative:s}),C=Yz(d,{replace:o,state:l,target:c,preventScrollReset:h,relative:s,viewTransition:p});function P(O){r&&r(O),O.defaultPrevented||C(O)}return E.createElement("a",xx({},x,{href:_||j,onClick:w||a?r:P,ref:t,target:c}))}),m4=E.forwardRef(function(e,t){let{"aria-current":r="page",caseSensitive:s=!1,className:a="",end:o=!1,style:l,to:c,viewTransition:d,children:h}=e,p=h4(e,qz),x=Qx(c,{relative:p.relative}),y=Zr(),_=E.useContext(a4),{navigator:w,basename:j}=E.useContext(Ml),C=_!=null&&Gz(x)&&d===!0,P=w.encodeLocation?w.encodeLocation(x).pathname:x.pathname,O=y.pathname,M=_&&_.navigation&&_.navigation.location?_.navigation.location.pathname:null;s||(O=O.toLowerCase(),M=M?M.toLowerCase():null,P=P.toLowerCase()),M&&j&&(M=wf(M,j)||M);const D=P!=="/"&&P.endsWith("/")?P.length-1:P.length;let I=O===P||!o&&O.startsWith(P)&&O.charAt(D)==="/",F=M!=null&&(M===P||!o&&M.startsWith(P)&&M.charAt(P.length)==="/"),q={isActive:I,isPending:F,isTransitioning:C},B=I?r:void 0,U;typeof a=="function"?U=a(q):U=[a,I?"active":null,F?"pending":null,C?"transitioning":null].filter(Boolean).join(" ");let W=typeof l=="function"?l(q):l;return E.createElement(Oa,xx({},p,{"aria-current":B,className:U,ref:t,style:W,to:c,viewTransition:d}),typeof h=="function"?h(q):h)});var $N;(function(n){n.UseScrollRestoration="useScrollRestoration",n.UseSubmit="useSubmit",n.UseSubmitFetcher="useSubmitFetcher",n.UseFetcher="useFetcher",n.useViewTransitionState="useViewTransitionState"})($N||($N={}));var xk;(function(n){n.UseFetcher="useFetcher",n.UseFetchers="useFetchers",n.UseScrollRestoration="useScrollRestoration"})(xk||(xk={}));function Hz(n){let e=E.useContext(Kx);return e||tr(!1),e}function Yz(n,e){let{target:t,replace:r,state:s,preventScrollReset:a,relative:o,viewTransition:l}=e===void 0?{}:e,c=St(),d=Zr(),h=Qx(n,{relative:o});return E.useCallback(p=>{if(Rz(p,t)){p.preventDefault();let x=r!==void 0?r:gx(d)===gx(h);c(n,{replace:x,state:s,preventScrollReset:a,relative:o,viewTransition:l})}},[d,c,h,r,s,t,n,a,o,l])}function p4(n){let e=E.useRef(WN(n)),t=E.useRef(!1),r=Zr(),s=E.useMemo(()=>Lz(r.search,t.current?null:e.current),[r.search]),a=St(),o=E.useCallback((l,c)=>{const d=WN(typeof l=="function"?l(s):l);t.current=!0,a("?"+d,c)},[a,s]);return[s,o]}function Gz(n,e){e===void 0&&(e={});let t=E.useContext(Uz);t==null&&tr(!1);let{basename:r}=Hz($N.useViewTransitionState),s=Qx(n,{relative:e.relative});if(!t.isTransitioning)return!1;let a=wf(t.currentLocation.pathname,r)||t.currentLocation.pathname,o=wf(t.nextLocation.pathname,r)||t.nextLocation.pathname;return BN(s.pathname,o)!=null||BN(s.pathname,a)!=null}const Zz={},yk=n=>{let e;const t=new Set,r=(h,p)=>{const x=typeof h=="function"?h(e):h;if(!Object.is(x,e)){const y=e;e=p??(typeof x!="object"||x===null)?x:Object.assign({},e,x),t.forEach(_=>_(e,y))}},s=()=>e,c={setState:r,getState:s,getInitialState:()=>d,subscribe:h=>(t.add(h),()=>t.delete(h)),destroy:()=>{(Zz?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),t.clear()}},d=e=n(r,s,c);return c},Kz=n=>n?yk(n):yk;var Jv={exports:{}},Qv={},Xv={exports:{}},eb={};var vk;function Jz(){if(vk)return eb;vk=1;var n=Ks();function e(p,x){return p===x&&(p!==0||1/p===1/x)||p!==p&&x!==x}var t=typeof Object.is=="function"?Object.is:e,r=n.useState,s=n.useEffect,a=n.useLayoutEffect,o=n.useDebugValue;function l(p,x){var y=x(),_=r({inst:{value:y,getSnapshot:x}}),w=_[0].inst,j=_[1];return a(function(){w.value=y,w.getSnapshot=x,c(w)&&j({inst:w})},[p,y,x]),s(function(){return c(w)&&j({inst:w}),p(function(){c(w)&&j({inst:w})})},[p]),o(y),y}function c(p){var x=p.getSnapshot;p=p.value;try{var y=x();return!t(p,y)}catch{return!0}}function d(p,x){return x()}var h=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?d:l;return eb.useSyncExternalStore=n.useSyncExternalStore!==void 0?n.useSyncExternalStore:h,eb}var bk;function Qz(){return bk||(bk=1,Xv.exports=Jz()),Xv.exports}var wk;function Xz(){if(wk)return Qv;wk=1;var n=Ks(),e=Qz();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var r=typeof Object.is=="function"?Object.is:t,s=e.useSyncExternalStore,a=n.useRef,o=n.useEffect,l=n.useMemo,c=n.useDebugValue;return Qv.useSyncExternalStoreWithSelector=function(d,h,p,x,y){var _=a(null);if(_.current===null){var w={hasValue:!1,value:null};_.current=w}else w=_.current;_=l(function(){function C(I){if(!P){if(P=!0,O=I,I=x(I),y!==void 0&&w.hasValue){var F=w.value;if(y(F,I))return M=F}return M=I}if(F=M,r(O,I))return F;var q=x(I);return y!==void 0&&y(F,q)?(O=I,F):(O=I,M=q)}var P=!1,O,M,D=p===void 0?null:p;return[function(){return C(h())},D===null?void 0:function(){return C(D())}]},[h,p,x,y]);var j=s(d,_[0],_[1]);return o(function(){w.hasValue=!0,w.value=j},[j]),c(j),j},Qv}var _k;function eU(){return _k||(_k=1,Jv.exports=Xz()),Jv.exports}var tU=eU();const nU=bu(tU),g4={},{useDebugValue:rU}=ot,{useSyncExternalStoreWithSelector:sU}=nU;let jk=!1;const iU=n=>n;function aU(n,e=iU,t){(g4?"production":void 0)!=="production"&&t&&!jk&&(console.warn("[DEPRECATED] Use `createWithEqualityFn` instead of `create` or use `useStoreWithEqualityFn` instead of `useStore`. They can be imported from 'zustand/traditional'. https://github.com/pmndrs/zustand/discussions/1937"),jk=!0);const r=sU(n.subscribe,n.getState,n.getServerState||n.getInitialState,e,t);return rU(r),r}const Nk=n=>{(g4?"production":void 0)!=="production"&&typeof n!="function"&&console.warn("[DEPRECATED] Passing a vanilla store will be unsupported in a future version. Instead use `import { useStore } from 'zustand'`.");const e=typeof n=="function"?Kz(n):n,t=(r,s)=>aU(e,r,s);return Object.assign(t,e),t},Xi=n=>n?Nk(n):Nk;var HN=function(n,e){return HN=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,r){t.__proto__=r}||function(t,r){for(var s in r)Object.prototype.hasOwnProperty.call(r,s)&&(t[s]=r[s])},HN(n,e)};function i1(n,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");HN(n,e);function t(){this.constructor=n}n.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var gr=function(){return gr=Object.assign||function(e){for(var t,r=1,s=arguments.length;r<s;r++){t=arguments[r];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a])}return e},gr.apply(this,arguments)};function Vf(n,e){var t={};for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&e.indexOf(r)<0&&(t[r]=n[r]);if(n!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(n);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(n,r[s])&&(t[r[s]]=n[r[s]]);return t}function x4(n,e,t,r){var s=arguments.length,a=s<3?e:r===null?r=Object.getOwnPropertyDescriptor(e,t):r,o;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")a=Reflect.decorate(n,e,t,r);else for(var l=n.length-1;l>=0;l--)(o=n[l])&&(a=(s<3?o(a):s>3?o(e,t,a):o(e,t))||a);return s>3&&a&&Object.defineProperty(e,t,a),a}function y4(n,e){return function(t,r){e(t,r,n)}}function v4(n,e,t,r,s,a){function o(C){if(C!==void 0&&typeof C!="function")throw new TypeError("Function expected");return C}for(var l=r.kind,c=l==="getter"?"get":l==="setter"?"set":"value",d=!e&&n?r.static?n:n.prototype:null,h=e||(d?Object.getOwnPropertyDescriptor(d,r.name):{}),p,x=!1,y=t.length-1;y>=0;y--){var _={};for(var w in r)_[w]=w==="access"?{}:r[w];for(var w in r.access)_.access[w]=r.access[w];_.addInitializer=function(C){if(x)throw new TypeError("Cannot add initializers after decoration has completed");a.push(o(C||null))};var j=(0,t[y])(l==="accessor"?{get:h.get,set:h.set}:h[c],_);if(l==="accessor"){if(j===void 0)continue;if(j===null||typeof j!="object")throw new TypeError("Object expected");(p=o(j.get))&&(h.get=p),(p=o(j.set))&&(h.set=p),(p=o(j.init))&&s.unshift(p)}else(p=o(j))&&(l==="field"?s.unshift(p):h[c]=p)}d&&Object.defineProperty(d,r.name,h),x=!0}function b4(n,e,t){for(var r=arguments.length>2,s=0;s<e.length;s++)t=r?e[s].call(n,t):e[s].call(n);return r?t:void 0}function w4(n){return typeof n=="symbol"?n:"".concat(n)}function _4(n,e,t){return typeof e=="symbol"&&(e=e.description?"[".concat(e.description,"]"):""),Object.defineProperty(n,"name",{configurable:!0,value:t?"".concat(t," ",e):e})}function j4(n,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(n,e)}function bt(n,e,t,r){function s(a){return a instanceof t?a:new t(function(o){o(a)})}return new(t||(t=Promise))(function(a,o){function l(h){try{d(r.next(h))}catch(p){o(p)}}function c(h){try{d(r.throw(h))}catch(p){o(p)}}function d(h){h.done?a(h.value):s(h.value).then(l,c)}d((r=r.apply(n,e||[])).next())})}function N4(n,e){var t={label:0,sent:function(){if(a[0]&1)throw a[1];return a[1]},trys:[],ops:[]},r,s,a,o=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return o.next=l(0),o.throw=l(1),o.return=l(2),typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(d){return function(h){return c([d,h])}}function c(d){if(r)throw new TypeError("Generator is already executing.");for(;o&&(o=0,d[0]&&(t=0)),t;)try{if(r=1,s&&(a=d[0]&2?s.return:d[0]?s.throw||((a=s.return)&&a.call(s),0):s.next)&&!(a=a.call(s,d[1])).done)return a;switch(s=0,a&&(d=[d[0]&2,a.value]),d[0]){case 0:case 1:a=d;break;case 4:return t.label++,{value:d[1],done:!1};case 5:t.label++,s=d[1],d=[0];continue;case 7:d=t.ops.pop(),t.trys.pop();continue;default:if(a=t.trys,!(a=a.length>0&&a[a.length-1])&&(d[0]===6||d[0]===2)){t=0;continue}if(d[0]===3&&(!a||d[1]>a[0]&&d[1]<a[3])){t.label=d[1];break}if(d[0]===6&&t.label<a[1]){t.label=a[1],a=d;break}if(a&&t.label<a[2]){t.label=a[2],t.ops.push(d);break}a[2]&&t.ops.pop(),t.trys.pop();continue}d=e.call(n,t)}catch(h){d=[6,h],s=0}finally{r=a=0}if(d[0]&5)throw d[1];return{value:d[0]?d[1]:void 0,done:!0}}}var Xx=Object.create?(function(n,e,t,r){r===void 0&&(r=t);var s=Object.getOwnPropertyDescriptor(e,t);(!s||("get"in s?!e.__esModule:s.writable||s.configurable))&&(s={enumerable:!0,get:function(){return e[t]}}),Object.defineProperty(n,r,s)}):(function(n,e,t,r){r===void 0&&(r=t),n[r]=e[t]});function S4(n,e){for(var t in n)t!=="default"&&!Object.prototype.hasOwnProperty.call(e,t)&&Xx(e,n,t)}function yx(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function a1(n,e){var t=typeof Symbol=="function"&&n[Symbol.iterator];if(!t)return n;var r=t.call(n),s,a=[],o;try{for(;(e===void 0||e-- >0)&&!(s=r.next()).done;)a.push(s.value)}catch(l){o={error:l}}finally{try{s&&!s.done&&(t=r.return)&&t.call(r)}finally{if(o)throw o.error}}return a}function C4(){for(var n=[],e=0;e<arguments.length;e++)n=n.concat(a1(arguments[e]));return n}function T4(){for(var n=0,e=0,t=arguments.length;e<t;e++)n+=arguments[e].length;for(var r=Array(n),s=0,e=0;e<t;e++)for(var a=arguments[e],o=0,l=a.length;o<l;o++,s++)r[s]=a[o];return r}function k4(n,e,t){if(t||arguments.length===2)for(var r=0,s=e.length,a;r<s;r++)(a||!(r in e))&&(a||(a=Array.prototype.slice.call(e,0,r)),a[r]=e[r]);return n.concat(a||Array.prototype.slice.call(e))}function jf(n){return this instanceof jf?(this.v=n,this):new jf(n)}function P4(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(y){return function(_){return Promise.resolve(_).then(y,p)}}function l(y,_){r[y]&&(s[y]=function(w){return new Promise(function(j,C){a.push([y,w,j,C])>1||c(y,w)})},_&&(s[y]=_(s[y])))}function c(y,_){try{d(r[y](_))}catch(w){x(a[0][3],w)}}function d(y){y.value instanceof jf?Promise.resolve(y.value.v).then(h,p):x(a[0][2],y)}function h(y){c("next",y)}function p(y){c("throw",y)}function x(y,_){y(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function M4(n){var e,t;return e={},r("next"),r("throw",function(s){throw s}),r("return"),e[Symbol.iterator]=function(){return this},e;function r(s,a){e[s]=n[s]?function(o){return(t=!t)?{value:jf(n[s](o)),done:!1}:a?a(o):o}:a}}function E4(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yx=="function"?yx(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function D4(n,e){return Object.defineProperty?Object.defineProperty(n,"raw",{value:e}):n.raw=e,n}var oU=Object.create?(function(n,e){Object.defineProperty(n,"default",{enumerable:!0,value:e})}):function(n,e){n.default=e},YN=function(n){return YN=Object.getOwnPropertyNames||function(e){var t=[];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[t.length]=r);return t},YN(n)};function O4(n){if(n&&n.__esModule)return n;var e={};if(n!=null)for(var t=YN(n),r=0;r<t.length;r++)t[r]!=="default"&&Xx(e,n,t[r]);return oU(e,n),e}function I4(n){return n&&n.__esModule?n:{default:n}}function A4(n,e,t,r){if(t==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?n!==e||!r:!e.has(n))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t==="m"?r:t==="a"?r.call(n):r?r.value:e.get(n)}function R4(n,e,t,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?n!==e||!s:!e.has(n))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(n,t):s?s.value=t:e.set(n,t),t}function L4(n,e){if(e===null||typeof e!="object"&&typeof e!="function")throw new TypeError("Cannot use 'in' operator on non-object");return typeof n=="function"?e===n:n.has(e)}function F4(n,e,t){if(e!=null){if(typeof e!="object"&&typeof e!="function")throw new TypeError("Object expected.");var r,s;if(t){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=e[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=e[Symbol.dispose],t&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(a){return Promise.reject(a)}}),n.stack.push({value:e,dispose:r,async:t})}else t&&n.stack.push({async:!0});return e}var lU=typeof SuppressedError=="function"?SuppressedError:function(n,e,t){var r=new Error(t);return r.name="SuppressedError",r.error=n,r.suppressed=e,r};function q4(n){function e(a){n.error=n.hasError?new lU(a,n.error,"An error was suppressed during disposal."):a,n.hasError=!0}var t,r=0;function s(){for(;t=n.stack.pop();)try{if(!t.async&&r===1)return r=0,n.stack.push(t),Promise.resolve().then(s);if(t.dispose){var a=t.dispose.call(t.value);if(t.async)return r|=2,Promise.resolve(a).then(s,function(o){return e(o),s()})}else r|=1}catch(o){e(o)}if(r===1)return n.hasError?Promise.reject(n.error):Promise.resolve();if(n.hasError)throw n.error}return s()}function z4(n,e){return typeof n=="string"&&/^\.\.?\//.test(n)?n.replace(/\.(tsx)$|((?:\.d)?)((?:\.[^./]+?)?)\.([cm]?)ts$/i,function(t,r,s,a,o){return r?e?".jsx":".js":s&&(!a||!o)?t:s+a+"."+o.toLowerCase()+"js"}):n}const cU={__extends:i1,__assign:gr,__rest:Vf,__decorate:x4,__param:y4,__esDecorate:v4,__runInitializers:b4,__propKey:w4,__setFunctionName:_4,__metadata:j4,__awaiter:bt,__generator:N4,__createBinding:Xx,__exportStar:S4,__values:yx,__read:a1,__spread:C4,__spreadArrays:T4,__spreadArray:k4,__await:jf,__asyncGenerator:P4,__asyncDelegator:M4,__asyncValues:E4,__makeTemplateObject:D4,__importStar:O4,__importDefault:I4,__classPrivateFieldGet:A4,__classPrivateFieldSet:R4,__classPrivateFieldIn:L4,__addDisposableResource:F4,__disposeResources:q4,__rewriteRelativeImportExtension:z4},dU=Object.freeze(Object.defineProperty({__proto__:null,__addDisposableResource:F4,get __assign(){return gr},__asyncDelegator:M4,__asyncGenerator:P4,__asyncValues:E4,__await:jf,__awaiter:bt,__classPrivateFieldGet:A4,__classPrivateFieldIn:L4,__classPrivateFieldSet:R4,__createBinding:Xx,__decorate:x4,__disposeResources:q4,__esDecorate:v4,__exportStar:S4,__extends:i1,__generator:N4,__importDefault:I4,__importStar:O4,__makeTemplateObject:D4,__metadata:j4,__param:y4,__propKey:w4,__read:a1,__rest:Vf,__rewriteRelativeImportExtension:z4,__runInitializers:b4,__setFunctionName:_4,__spread:C4,__spreadArray:k4,__spreadArrays:T4,__values:yx,default:cU},Symbol.toStringTag,{value:"Module"})),uU=n=>n?(...e)=>n(...e):(...e)=>fetch(...e);class o1 extends Error{constructor(e,t="FunctionsError",r){super(e),this.name=t,this.context=r}}class fU extends o1{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class Sk extends o1{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class Ck extends o1{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var GN;(function(n){n.Any="any",n.ApNortheast1="ap-northeast-1",n.ApNortheast2="ap-northeast-2",n.ApSouth1="ap-south-1",n.ApSoutheast1="ap-southeast-1",n.ApSoutheast2="ap-southeast-2",n.CaCentral1="ca-central-1",n.EuCentral1="eu-central-1",n.EuWest1="eu-west-1",n.EuWest2="eu-west-2",n.EuWest3="eu-west-3",n.SaEast1="sa-east-1",n.UsEast1="us-east-1",n.UsWest1="us-west-1",n.UsWest2="us-west-2"})(GN||(GN={}));class hU{constructor(e,{headers:t={},customFetch:r,region:s=GN.Any}={}){this.url=e,this.headers=t,this.region=s,this.fetch=uU(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e){return bt(this,arguments,void 0,function*(t,r={}){var s;let a,o;try{const{headers:l,method:c,body:d,signal:h,timeout:p}=r;let x={},{region:y}=r;y||(y=this.region);const _=new URL(`${this.url}/${t}`);y&&y!=="any"&&(x["x-region"]=y,_.searchParams.set("forceFunctionRegion",y));let w;d&&(l&&!Object.prototype.hasOwnProperty.call(l,"Content-Type")||!l)?typeof Blob<"u"&&d instanceof Blob||d instanceof ArrayBuffer?(x["Content-Type"]="application/octet-stream",w=d):typeof d=="string"?(x["Content-Type"]="text/plain",w=d):typeof FormData<"u"&&d instanceof FormData?w=d:(x["Content-Type"]="application/json",w=JSON.stringify(d)):w=d;let j=h;p&&(o=new AbortController,a=setTimeout(()=>o.abort(),p),h?(j=o.signal,h.addEventListener("abort",()=>o.abort())):j=o.signal);const C=yield this.fetch(_.toString(),{method:c||"POST",headers:Object.assign(Object.assign(Object.assign({},x),this.headers),l),body:w,signal:j}).catch(D=>{throw new fU(D)}),P=C.headers.get("x-relay-error");if(P&&P==="true")throw new Sk(C);if(!C.ok)throw new Ck(C);let O=((s=C.headers.get("Content-Type"))!==null&&s!==void 0?s:"text/plain").split(";")[0].trim(),M;return O==="application/json"?M=yield C.json():O==="application/octet-stream"||O==="application/pdf"?M=yield C.blob():O==="text/event-stream"?M=C:O==="multipart/form-data"?M=yield C.formData():M=yield C.text(),{data:M,error:null,response:C}}catch(l){return{data:null,error:l,response:l instanceof Ck||l instanceof Sk?l.context:void 0}}finally{a&&clearTimeout(a)}})}}var as={};const Wf=XL(dU);var Dp={},Op={},Ip={},Ap={},Rp={},Lp={},Tk;function U4(){if(Tk)return Lp;Tk=1,Object.defineProperty(Lp,"__esModule",{value:!0});class n extends Error{constructor(t){super(t.message),this.name="PostgrestError",this.details=t.details,this.hint=t.hint,this.code=t.code}}return Lp.default=n,Lp}var kk;function B4(){if(kk)return Rp;kk=1,Object.defineProperty(Rp,"__esModule",{value:!0});const e=Wf.__importDefault(U4());class t{constructor(s){var a,o;this.shouldThrowOnError=!1,this.method=s.method,this.url=s.url,this.headers=new Headers(s.headers),this.schema=s.schema,this.body=s.body,this.shouldThrowOnError=(a=s.shouldThrowOnError)!==null&&a!==void 0?a:!1,this.signal=s.signal,this.isMaybeSingle=(o=s.isMaybeSingle)!==null&&o!==void 0?o:!1,s.fetch?this.fetch=s.fetch:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(s,a){return this.headers=new Headers(this.headers),this.headers.set(s,a),this}then(s,a){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const o=this.fetch;let l=o(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async c=>{var d,h,p,x;let y=null,_=null,w=null,j=c.status,C=c.statusText;if(c.ok){if(this.method!=="HEAD"){const D=await c.text();D===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((d=this.headers.get("Accept"))===null||d===void 0)&&d.includes("application/vnd.pgrst.plan+text"))?_=D:_=JSON.parse(D))}const O=(h=this.headers.get("Prefer"))===null||h===void 0?void 0:h.match(/count=(exact|planned|estimated)/),M=(p=c.headers.get("content-range"))===null||p===void 0?void 0:p.split("/");O&&M&&M.length>1&&(w=parseInt(M[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(_)&&(_.length>1?(y={code:"PGRST116",details:`Results contain ${_.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},_=null,w=null,j=406,C="Not Acceptable"):_.length===1?_=_[0]:_=null)}else{const O=await c.text();try{y=JSON.parse(O),Array.isArray(y)&&c.status===404&&(_=[],y=null,j=200,C="OK")}catch{c.status===404&&O===""?(j=204,C="No Content"):y={message:O}}if(y&&this.isMaybeSingle&&(!((x=y?.details)===null||x===void 0)&&x.includes("0 rows"))&&(y=null,j=200,C="OK"),y&&this.shouldThrowOnError)throw new e.default(y)}return{error:y,data:_,count:w,status:j,statusText:C}});return this.shouldThrowOnError||(l=l.catch(c=>{var d,h,p;return{error:{message:`${(d=c?.name)!==null&&d!==void 0?d:"FetchError"}: ${c?.message}`,details:`${(h=c?.stack)!==null&&h!==void 0?h:""}`,hint:"",code:`${(p=c?.code)!==null&&p!==void 0?p:""}`},data:null,count:null,status:0,statusText:""}})),l.then(s,a)}returns(){return this}overrideTypes(){return this}}return Rp.default=t,Rp}var Pk;function V4(){if(Pk)return Ap;Pk=1,Object.defineProperty(Ap,"__esModule",{value:!0});const e=Wf.__importDefault(B4());class t extends e.default{select(s){let a=!1;const o=(s??"*").split("").map(l=>/\s/.test(l)&&!a?"":(l==='"'&&(a=!a),l)).join("");return this.url.searchParams.set("select",o),this.headers.append("Prefer","return=representation"),this}order(s,{ascending:a=!0,nullsFirst:o,foreignTable:l,referencedTable:c=l}={}){const d=c?`${c}.order`:"order",h=this.url.searchParams.get(d);return this.url.searchParams.set(d,`${h?`${h},`:""}${s}.${a?"asc":"desc"}${o===void 0?"":o?".nullsfirst":".nullslast"}`),this}limit(s,{foreignTable:a,referencedTable:o=a}={}){const l=typeof o>"u"?"limit":`${o}.limit`;return this.url.searchParams.set(l,`${s}`),this}range(s,a,{foreignTable:o,referencedTable:l=o}={}){const c=typeof l>"u"?"offset":`${l}.offset`,d=typeof l>"u"?"limit":`${l}.limit`;return this.url.searchParams.set(c,`${s}`),this.url.searchParams.set(d,`${a-s+1}`),this}abortSignal(s){return this.signal=s,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:s=!1,verbose:a=!1,settings:o=!1,buffers:l=!1,wal:c=!1,format:d="text"}={}){var h;const p=[s?"analyze":null,a?"verbose":null,o?"settings":null,l?"buffers":null,c?"wal":null].filter(Boolean).join("|"),x=(h=this.headers.get("Accept"))!==null&&h!==void 0?h:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${d}; for="${x}"; options=${p};`),d==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(s){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${s}`),this}}return Ap.default=t,Ap}var Mk;function l1(){if(Mk)return Ip;Mk=1,Object.defineProperty(Ip,"__esModule",{value:!0});const e=Wf.__importDefault(V4()),t=new RegExp("[,()]");class r extends e.default{eq(a,o){return this.url.searchParams.append(a,`eq.${o}`),this}neq(a,o){return this.url.searchParams.append(a,`neq.${o}`),this}gt(a,o){return this.url.searchParams.append(a,`gt.${o}`),this}gte(a,o){return this.url.searchParams.append(a,`gte.${o}`),this}lt(a,o){return this.url.searchParams.append(a,`lt.${o}`),this}lte(a,o){return this.url.searchParams.append(a,`lte.${o}`),this}like(a,o){return this.url.searchParams.append(a,`like.${o}`),this}likeAllOf(a,o){return this.url.searchParams.append(a,`like(all).{${o.join(",")}}`),this}likeAnyOf(a,o){return this.url.searchParams.append(a,`like(any).{${o.join(",")}}`),this}ilike(a,o){return this.url.searchParams.append(a,`ilike.${o}`),this}ilikeAllOf(a,o){return this.url.searchParams.append(a,`ilike(all).{${o.join(",")}}`),this}ilikeAnyOf(a,o){return this.url.searchParams.append(a,`ilike(any).{${o.join(",")}}`),this}is(a,o){return this.url.searchParams.append(a,`is.${o}`),this}in(a,o){const l=Array.from(new Set(o)).map(c=>typeof c=="string"&&t.test(c)?`"${c}"`:`${c}`).join(",");return this.url.searchParams.append(a,`in.(${l})`),this}contains(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cs.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cs.{${o.join(",")}}`):this.url.searchParams.append(a,`cs.${JSON.stringify(o)}`),this}containedBy(a,o){return typeof o=="string"?this.url.searchParams.append(a,`cd.${o}`):Array.isArray(o)?this.url.searchParams.append(a,`cd.{${o.join(",")}}`):this.url.searchParams.append(a,`cd.${JSON.stringify(o)}`),this}rangeGt(a,o){return this.url.searchParams.append(a,`sr.${o}`),this}rangeGte(a,o){return this.url.searchParams.append(a,`nxl.${o}`),this}rangeLt(a,o){return this.url.searchParams.append(a,`sl.${o}`),this}rangeLte(a,o){return this.url.searchParams.append(a,`nxr.${o}`),this}rangeAdjacent(a,o){return this.url.searchParams.append(a,`adj.${o}`),this}overlaps(a,o){return typeof o=="string"?this.url.searchParams.append(a,`ov.${o}`):this.url.searchParams.append(a,`ov.{${o.join(",")}}`),this}textSearch(a,o,{config:l,type:c}={}){let d="";c==="plain"?d="pl":c==="phrase"?d="ph":c==="websearch"&&(d="w");const h=l===void 0?"":`(${l})`;return this.url.searchParams.append(a,`${d}fts${h}.${o}`),this}match(a){return Object.entries(a).forEach(([o,l])=>{this.url.searchParams.append(o,`eq.${l}`)}),this}not(a,o,l){return this.url.searchParams.append(a,`not.${o}.${l}`),this}or(a,{foreignTable:o,referencedTable:l=o}={}){const c=l?`${l}.or`:"or";return this.url.searchParams.append(c,`(${a})`),this}filter(a,o,l){return this.url.searchParams.append(a,`${o}.${l}`),this}}return Ip.default=r,Ip}var Ek;function W4(){if(Ek)return Op;Ek=1,Object.defineProperty(Op,"__esModule",{value:!0});const e=Wf.__importDefault(l1());class t{constructor(s,{headers:a={},schema:o,fetch:l}){this.url=s,this.headers=new Headers(a),this.schema=o,this.fetch=l}select(s,a){const{head:o=!1,count:l}=a??{},c=o?"HEAD":"GET";let d=!1;const h=(s??"*").split("").map(p=>/\s/.test(p)&&!d?"":(p==='"'&&(d=!d),p)).join("");return this.url.searchParams.set("select",h),l&&this.headers.append("Prefer",`count=${l}`),new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(s,{count:a,defaultToNull:o=!0}={}){var l;const c="POST";if(a&&this.headers.append("Prefer",`count=${a}`),o||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const d=s.reduce((h,p)=>h.concat(Object.keys(p)),[]);if(d.length>0){const h=[...new Set(d)].map(p=>`"${p}"`);this.url.searchParams.set("columns",h.join(","))}}return new e.default({method:c,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}upsert(s,{onConflict:a,ignoreDuplicates:o=!1,count:l,defaultToNull:c=!0}={}){var d;const h="POST";if(this.headers.append("Prefer",`resolution=${o?"ignore":"merge"}-duplicates`),a!==void 0&&this.url.searchParams.set("on_conflict",a),l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(s)){const p=s.reduce((x,y)=>x.concat(Object.keys(y)),[]);if(p.length>0){const x=[...new Set(p)].map(y=>`"${y}"`);this.url.searchParams.set("columns",x.join(","))}}return new e.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(d=this.fetch)!==null&&d!==void 0?d:fetch})}update(s,{count:a}={}){var o;const l="PATCH";return a&&this.headers.append("Prefer",`count=${a}`),new e.default({method:l,url:this.url,headers:this.headers,schema:this.schema,body:s,fetch:(o=this.fetch)!==null&&o!==void 0?o:fetch})}delete({count:s}={}){var a;const o="DELETE";return s&&this.headers.append("Prefer",`count=${s}`),new e.default({method:o,url:this.url,headers:this.headers,schema:this.schema,fetch:(a=this.fetch)!==null&&a!==void 0?a:fetch})}}return Op.default=t,Op}var Dk;function mU(){if(Dk)return Dp;Dk=1,Object.defineProperty(Dp,"__esModule",{value:!0});const n=Wf,e=n.__importDefault(W4()),t=n.__importDefault(l1());class r{constructor(a,{headers:o={},schema:l,fetch:c}={}){this.url=a,this.headers=new Headers(o),this.schemaName=l,this.fetch=c}from(a){const o=new URL(`${this.url}/${a}`);return new e.default(o,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(a){return new r(this.url,{headers:this.headers,schema:a,fetch:this.fetch})}rpc(a,o={},{head:l=!1,get:c=!1,count:d}={}){var h;let p;const x=new URL(`${this.url}/rpc/${a}`);let y;l||c?(p=l?"HEAD":"GET",Object.entries(o).filter(([w,j])=>j!==void 0).map(([w,j])=>[w,Array.isArray(j)?`{${j.join(",")}}`:`${j}`]).forEach(([w,j])=>{x.searchParams.append(w,j)})):(p="POST",y=o);const _=new Headers(this.headers);return d&&_.set("Prefer",`count=${d}`),new t.default({method:p,url:x,headers:_,schema:this.schemaName,body:y,fetch:(h=this.fetch)!==null&&h!==void 0?h:fetch})}}return Dp.default=r,Dp}var Ok;function pU(){if(Ok)return as;Ok=1,Object.defineProperty(as,"__esModule",{value:!0}),as.PostgrestError=as.PostgrestBuilder=as.PostgrestTransformBuilder=as.PostgrestFilterBuilder=as.PostgrestQueryBuilder=as.PostgrestClient=void 0;const n=Wf,e=n.__importDefault(mU());as.PostgrestClient=e.default;const t=n.__importDefault(W4());as.PostgrestQueryBuilder=t.default;const r=n.__importDefault(l1());as.PostgrestFilterBuilder=r.default;const s=n.__importDefault(V4());as.PostgrestTransformBuilder=s.default;const a=n.__importDefault(B4());as.PostgrestBuilder=a.default;const o=n.__importDefault(U4());return as.PostgrestError=o.default,as.default={PostgrestClient:e.default,PostgrestQueryBuilder:t.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:s.default,PostgrestBuilder:a.default,PostgrestError:o.default},as}var $4=pU();const H4=bu($4),gU=QL({__proto__:null,default:H4},[$4]),{PostgrestClient:xU,PostgrestQueryBuilder:_fe,PostgrestFilterBuilder:jfe,PostgrestTransformBuilder:Nfe,PostgrestBuilder:Sfe,PostgrestError:Cfe}=H4||gU;class yU{static detectEnvironment(){var e;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((e=navigator.userAgent)===null||e===void 0)&&e.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"){const t=process.versions;if(t&&t.node){const r=t.node,s=parseInt(r.replace(/^v/,"").split(".")[0]);return s>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${s} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${s} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const e=this.detectEnvironment();if(e.constructor)return e.constructor;let t=e.error||"WebSocket not supported in this environment.";throw e.workaround&&(t+=`

Suggested solution: ${e.workaround}`),new Error(t)}static createWebSocket(e,t){const r=this.getWebSocketConstructor();return new r(e,t)}static isWebSocketSupported(){try{const e=this.detectEnvironment();return e.type==="native"||e.type==="ws"}catch{return!1}}}const vU="2.81.1",bU=`realtime-js/${vU}`,Y4="1.0.0",wU="2.0.0",Ik=Y4,ZN=1e4,_U=1e3,jU=100;var ru;(function(n){n[n.connecting=0]="connecting",n[n.open=1]="open",n[n.closing=2]="closing",n[n.closed=3]="closed"})(ru||(ru={}));var Cr;(function(n){n.closed="closed",n.errored="errored",n.joined="joined",n.joining="joining",n.leaving="leaving"})(Cr||(Cr={}));var Hi;(function(n){n.close="phx_close",n.error="phx_error",n.join="phx_join",n.reply="phx_reply",n.leave="phx_leave",n.access_token="access_token"})(Hi||(Hi={}));var KN;(function(n){n.websocket="websocket"})(KN||(KN={}));var su;(function(n){n.Connecting="connecting",n.Open="open",n.Closing="closing",n.Closed="closed"})(su||(su={}));class NU{constructor(){this.HEADER_LENGTH=1,this.META_LENGTH=4,this.USER_BROADCAST_PUSH_META_LENGTH=5,this.KINDS={push:0,reply:1,broadcast:2,userBroadcastPush:3,userBroadcast:4},this.BINARY_ENCODING=0,this.JSON_ENCODING=1,this.BROADCAST="broadcast"}encode(e,t){if(this._isArrayBuffer(e.payload))return t(this._binaryEncodePush(e));if(e.event===this.BROADCAST&&!(e.payload instanceof ArrayBuffer)&&typeof e.payload.event=="string")return t(this._binaryEncodeUserBroadcastPush(e));let r=[e.join_ref,e.ref,e.topic,e.event,e.payload];return t(JSON.stringify(r))}_binaryEncodePush(e){const{join_ref:t,ref:r,event:s,topic:a,payload:o}=e,l=this.META_LENGTH+t.length+r.length+a.length+s.length,c=new ArrayBuffer(this.HEADER_LENGTH+l);let d=new DataView(c),h=0;d.setUint8(h++,this.KINDS.push),d.setUint8(h++,t.length),d.setUint8(h++,r.length),d.setUint8(h++,a.length),d.setUint8(h++,s.length),Array.from(t,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(r,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(a,x=>d.setUint8(h++,x.charCodeAt(0))),Array.from(s,x=>d.setUint8(h++,x.charCodeAt(0)));var p=new Uint8Array(c.byteLength+o.byteLength);return p.set(new Uint8Array(c),0),p.set(new Uint8Array(o),c.byteLength),p.buffer}_binaryEncodeUserBroadcastPush(e){var t;return this._isArrayBuffer((t=e.payload)===null||t===void 0?void 0:t.payload)?this._encodeBinaryUserBroadcastPush(e):this._encodeJsonUserBroadcastPush(e)}_encodeBinaryUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:new ArrayBuffer(0),d=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,h=new ArrayBuffer(this.HEADER_LENGTH+d);let p=new DataView(h),x=0;p.setUint8(x++,this.KINDS.userBroadcastPush),p.setUint8(x++,s.length),p.setUint8(x++,a.length),p.setUint8(x++,o.length),p.setUint8(x++,l.length),p.setUint8(x++,this.BINARY_ENCODING),Array.from(s,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(a,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(o,_=>p.setUint8(x++,_.charCodeAt(0))),Array.from(l,_=>p.setUint8(x++,_.charCodeAt(0)));var y=new Uint8Array(h.byteLength+c.byteLength);return y.set(new Uint8Array(h),0),y.set(new Uint8Array(c),h.byteLength),y.buffer}_encodeJsonUserBroadcastPush(e){var t,r;const{join_ref:s,ref:a,topic:o}=e,l=e.payload.event,c=(r=(t=e.payload)===null||t===void 0?void 0:t.payload)!==null&&r!==void 0?r:{},h=new TextEncoder().encode(JSON.stringify(c)).buffer,p=this.USER_BROADCAST_PUSH_META_LENGTH+s.length+a.length+o.length+l.length,x=new ArrayBuffer(this.HEADER_LENGTH+p);let y=new DataView(x),_=0;y.setUint8(_++,this.KINDS.userBroadcastPush),y.setUint8(_++,s.length),y.setUint8(_++,a.length),y.setUint8(_++,o.length),y.setUint8(_++,l.length),y.setUint8(_++,this.JSON_ENCODING),Array.from(s,j=>y.setUint8(_++,j.charCodeAt(0))),Array.from(a,j=>y.setUint8(_++,j.charCodeAt(0))),Array.from(o,j=>y.setUint8(_++,j.charCodeAt(0))),Array.from(l,j=>y.setUint8(_++,j.charCodeAt(0)));var w=new Uint8Array(x.byteLength+h.byteLength);return w.set(new Uint8Array(x),0),w.set(new Uint8Array(h),x.byteLength),w.buffer}decode(e,t){if(this._isArrayBuffer(e)){let r=this._binaryDecode(e);return t(r)}if(typeof e=="string"){const r=JSON.parse(e),[s,a,o,l,c]=r;return t({join_ref:s,ref:a,topic:o,event:l,payload:c})}return t({})}_binaryDecode(e){const t=new DataView(e),r=t.getUint8(0),s=new TextDecoder;switch(r){case this.KINDS.push:return this._decodePush(e,t,s);case this.KINDS.reply:return this._decodeReply(e,t,s);case this.KINDS.broadcast:return this._decodeBroadcast(e,t,s);case this.KINDS.userBroadcast:return this._decodeUserBroadcast(e,t,s)}}_decodePush(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3);let l=this.HEADER_LENGTH+this.META_LENGTH-1;const c=r.decode(e.slice(l,l+s));l=l+s;const d=r.decode(e.slice(l,l+a));l=l+a;const h=r.decode(e.slice(l,l+o));l=l+o;const p=JSON.parse(r.decode(e.slice(l,e.byteLength)));return{join_ref:c,ref:null,topic:d,event:h,payload:p}}_decodeReply(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+this.META_LENGTH;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=r.decode(e.slice(c,c+l));c=c+l;const y=JSON.parse(r.decode(e.slice(c,e.byteLength))),_={status:x,response:y};return{join_ref:d,ref:h,topic:p,event:Hi.reply,payload:_}}_decodeBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2);let o=this.HEADER_LENGTH+2;const l=r.decode(e.slice(o,o+s));o=o+s;const c=r.decode(e.slice(o,o+a));o=o+a;const d=JSON.parse(r.decode(e.slice(o,e.byteLength)));return{join_ref:null,ref:null,topic:l,event:c,payload:d}}_decodeUserBroadcast(e,t,r){const s=t.getUint8(1),a=t.getUint8(2),o=t.getUint8(3),l=t.getUint8(4);let c=this.HEADER_LENGTH+4;const d=r.decode(e.slice(c,c+s));c=c+s;const h=r.decode(e.slice(c,c+a));c=c+a;const p=r.decode(e.slice(c,c+o));c=c+o;const x=e.slice(c,e.byteLength),y=l===this.JSON_ENCODING?JSON.parse(r.decode(x)):x,_={type:this.BROADCAST,event:h,payload:y};return o>0&&(_.meta=JSON.parse(p)),{join_ref:null,ref:null,topic:d,event:this.BROADCAST,payload:_}}_isArrayBuffer(e){var t;return e instanceof ArrayBuffer||((t=e?.constructor)===null||t===void 0?void 0:t.name)==="ArrayBuffer"}}class G4{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Ln;(function(n){n.abstime="abstime",n.bool="bool",n.date="date",n.daterange="daterange",n.float4="float4",n.float8="float8",n.int2="int2",n.int4="int4",n.int4range="int4range",n.int8="int8",n.int8range="int8range",n.json="json",n.jsonb="jsonb",n.money="money",n.numeric="numeric",n.oid="oid",n.reltime="reltime",n.text="text",n.time="time",n.timestamp="timestamp",n.timestamptz="timestamptz",n.timetz="timetz",n.tsrange="tsrange",n.tstzrange="tstzrange"})(Ln||(Ln={}));const Ak=(n,e,t={})=>{var r;const s=(r=t.skipTypes)!==null&&r!==void 0?r:[];return e?Object.keys(e).reduce((a,o)=>(a[o]=SU(o,n,e,s),a),{}):{}},SU=(n,e,t,r)=>{const s=e.find(l=>l.name===n),a=s?.type,o=t[n];return a&&!r.includes(a)?Z4(a,o):JN(o)},Z4=(n,e)=>{if(n.charAt(0)==="_"){const t=n.slice(1,n.length);return PU(e,t)}switch(n){case Ln.bool:return CU(e);case Ln.float4:case Ln.float8:case Ln.int2:case Ln.int4:case Ln.int8:case Ln.numeric:case Ln.oid:return TU(e);case Ln.json:case Ln.jsonb:return kU(e);case Ln.timestamp:return MU(e);case Ln.abstime:case Ln.date:case Ln.daterange:case Ln.int4range:case Ln.int8range:case Ln.money:case Ln.reltime:case Ln.text:case Ln.time:case Ln.timestamptz:case Ln.timetz:case Ln.tsrange:case Ln.tstzrange:return JN(e);default:return JN(e)}},JN=n=>n,CU=n=>{switch(n){case"t":return!0;case"f":return!1;default:return n}},TU=n=>{if(typeof n=="string"){const e=parseFloat(n);if(!Number.isNaN(e))return e}return n},kU=n=>{if(typeof n=="string")try{return JSON.parse(n)}catch(e){return console.log(`JSON parse error: ${e}`),n}return n},PU=(n,e)=>{if(typeof n!="string")return n;const t=n.length-1,r=n[t];if(n[0]==="{"&&r==="}"){let a;const o=n.slice(1,t);try{a=JSON.parse("["+o+"]")}catch{a=o?o.split(","):[]}return a.map(l=>Z4(e,l))}return n},MU=n=>typeof n=="string"?n.replace(" ","T"):n,K4=n=>{const e=new URL(n);return e.protocol=e.protocol.replace(/^ws/i,"http"),e.pathname=e.pathname.replace(/\/+$/,"").replace(/\/socket\/websocket$/i,"").replace(/\/socket$/i,"").replace(/\/websocket$/i,""),e.pathname===""||e.pathname==="/"?e.pathname="/api/broadcast":e.pathname=e.pathname+"/api/broadcast",e.href};class tb{constructor(e,t,r={},s=ZN){this.channel=e,this.event=t,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var r;return this._hasReceived(e)&&t((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=t=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=t,this._matchReceive(t)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(t))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Rk;(function(n){n.SYNC="sync",n.JOIN="join",n.LEAVE="leave"})(Rk||(Rk={}));class Jh{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=t?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Jh.syncState(this.state,s,a,o),this.pendingDiffs.forEach(c=>{this.state=Jh.syncDiff(this.state,c,a,o)}),this.pendingDiffs=[],l()}),this.channel._on(r.diff,{},s=>{const{onJoin:a,onLeave:o,onSync:l}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=Jh.syncDiff(this.state,s,a,o),l())}),this.onJoin((s,a,o)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:a,newPresences:o})}),this.onLeave((s,a,o)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:a,leftPresences:o})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,t,r,s){const a=this.cloneDeep(e),o=this.transformState(t),l={},c={};return this.map(a,(d,h)=>{o[d]||(c[d]=h)}),this.map(o,(d,h)=>{const p=a[d];if(p){const x=h.map(j=>j.presence_ref),y=p.map(j=>j.presence_ref),_=h.filter(j=>y.indexOf(j.presence_ref)<0),w=p.filter(j=>x.indexOf(j.presence_ref)<0);_.length>0&&(l[d]=_),w.length>0&&(c[d]=w)}else l[d]=h}),this.syncDiff(a,{joins:l,leaves:c},r,s)}static syncDiff(e,t,r,s){const{joins:a,leaves:o}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(a,(l,c)=>{var d;const h=(d=e[l])!==null&&d!==void 0?d:[];if(e[l]=this.cloneDeep(c),h.length>0){const p=e[l].map(y=>y.presence_ref),x=h.filter(y=>p.indexOf(y.presence_ref)<0);e[l].unshift(...x)}r(l,h,c)}),this.map(o,(l,c)=>{let d=e[l];if(!d)return;const h=c.map(p=>p.presence_ref);d=d.filter(p=>h.indexOf(p.presence_ref)<0),e[l]=d,s(l,d,c),d.length===0&&delete e[l]}),e}static map(e,t){return Object.getOwnPropertyNames(e).map(r=>t(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((t,r)=>{const s=e[r];return"metas"in s?t[r]=s.metas.map(a=>(a.presence_ref=a.phx_ref,delete a.phx_ref,delete a.phx_ref_prev,a)):t[r]=s,t},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Lk;(function(n){n.ALL="*",n.INSERT="INSERT",n.UPDATE="UPDATE",n.DELETE="DELETE"})(Lk||(Lk={}));var Qh;(function(n){n.BROADCAST="broadcast",n.PRESENCE="presence",n.POSTGRES_CHANGES="postgres_changes",n.SYSTEM="system"})(Qh||(Qh={}));var xl;(function(n){n.SUBSCRIBED="SUBSCRIBED",n.TIMED_OUT="TIMED_OUT",n.CLOSED="CLOSED",n.CHANNEL_ERROR="CHANNEL_ERROR"})(xl||(xl={}));class c1{constructor(e,t={config:{}},r){var s,a;if(this.topic=e,this.params=t,this.socket=r,this.bindings={},this.state=Cr.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new tb(this,Hi.join,this.params,this.timeout),this.rejoinTimer=new G4(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=Cr.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=Cr.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=Cr.errored,this.rejoinTimer.scheduleTimeout())}),this._on(Hi.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Jh(this),this.broadcastEndpointURL=K4(this.socket.endPoint),this.private=this.params.config.private||!1,!this.private&&(!((a=(s=this.params.config)===null||s===void 0?void 0:s.broadcast)===null||a===void 0)&&a.replay))throw`tried to use replay on public channel '${this.topic}'. It must be a private channel.`}subscribe(e,t=this.timeout){var r,s,a;if(this.socket.isConnected()||this.socket.connect(),this.state==Cr.closed){const{config:{broadcast:o,presence:l,private:c}}=this.params,d=(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(y=>y.filter))!==null&&s!==void 0?s:[],h=!!this.bindings[Qh.PRESENCE]&&this.bindings[Qh.PRESENCE].length>0||((a=this.params.config.presence)===null||a===void 0?void 0:a.enabled)===!0,p={},x={broadcast:o,presence:Object.assign(Object.assign({},l),{enabled:h}),postgres_changes:d,private:c};this.socket.accessTokenValue&&(p.access_token=this.socket.accessTokenValue),this._onError(y=>e?.(xl.CHANNEL_ERROR,y)),this._onClose(()=>e?.(xl.CLOSED)),this.updateJoinPayload(Object.assign({config:x},p)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",async({postgres_changes:y})=>{var _;if(this.socket.setAuth(),y===void 0){e?.(xl.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,j=(_=w?.length)!==null&&_!==void 0?_:0,C=[];for(let P=0;P<j;P++){const O=w[P],{filter:{event:M,schema:D,table:I,filter:F}}=O,q=y&&y[P];if(q&&q.event===M&&q.schema===D&&q.table===I&&q.filter===F)C.push(Object.assign(Object.assign({},O),{id:q.id}));else{this.unsubscribe(),this.state=Cr.errored,e?.(xl.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=C,e&&e(xl.SUBSCRIBED);return}}).receive("error",y=>{this.state=Cr.errored,e?.(xl.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(y).join(", ")||"error")))}).receive("timeout",()=>{e?.(xl.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,r){return this.state===Cr.joined&&e===Qh.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(e,t,r)}async httpSend(e,t,r={}){var s;const a=this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"";if(t==null)return Promise.reject("Payload is required for httpSend()");const o={method:"POST",headers:{Authorization:a,apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:e,payload:t,private:this.private}]})},l=await this._fetchWithTimeout(this.broadcastEndpointURL,o,(s=r.timeout)!==null&&s!==void 0?s:this.timeout);if(l.status===202)return{success:!0};let c=l.statusText;try{const d=await l.json();c=d.error||d.message||c}catch{}return Promise.reject(new Error(c))}async send(e,t={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){console.warn("Realtime send() is automatically falling back to REST API. This behavior will be deprecated in the future. Please use httpSend() explicitly for REST delivery.");const{event:a,payload:o}=e,c={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:a,payload:o,private:this.private}]})};try{const d=await this._fetchWithTimeout(this.broadcastEndpointURL,c,(r=t.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=d.body)===null||s===void 0?void 0:s.cancel()),d.ok?"ok":"error"}catch(d){return d.name==="AbortError"?"timed out":"error"}}else return new Promise(a=>{var o,l,c;const d=this._push(e.type,e,t.timeout||this.timeout);e.type==="broadcast"&&!(!((c=(l=(o=this.params)===null||o===void 0?void 0:o.config)===null||l===void 0?void 0:l.broadcast)===null||c===void 0)&&c.ack)&&a("ok"),d.receive("ok",()=>a("ok")),d.receive("error",()=>a("error")),d.receive("timeout",()=>a("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=Cr.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Hi.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(s=>{r=new tb(this,Hi.leave,{},e),r.receive("ok",()=>{t(),s("ok")}).receive("timeout",()=>{t(),s("timed out")}).receive("error",()=>{s("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r?.destroy()})}teardown(){this.pushBuffer.forEach(e=>e.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=Cr.closed,this.bindings={}}async _fetchWithTimeout(e,t,r){const s=new AbortController,a=setTimeout(()=>s.abort(),r),o=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:s.signal}));return clearTimeout(a),o}_push(e,t,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new tb(this,e,t,r);return this._canPush()?s.send():this._addToPushBuffer(s),s}_addToPushBuffer(e){if(e.startTimeout(),this.pushBuffer.push(e),this.pushBuffer.length>jU){const t=this.pushBuffer.shift();t&&(t.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${t.event}`,t.payload))}}_onMessage(e,t,r){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,r){var s,a;const o=e.toLocaleLowerCase(),{close:l,error:c,leave:d,join:h}=Hi;if(r&&[l,c,d,h].indexOf(o)>=0&&r!==this._joinRef())return;let x=this._onMessage(o,t,r);if(t&&!x)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(o)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(y=>{var _,w,j;return((_=y.filter)===null||_===void 0?void 0:_.event)==="*"||((j=(w=y.filter)===null||w===void 0?void 0:w.event)===null||j===void 0?void 0:j.toLocaleLowerCase())===o}).map(y=>y.callback(x,r)):(a=this.bindings[o])===null||a===void 0||a.filter(y=>{var _,w,j,C,P,O;if(["broadcast","presence","postgres_changes"].includes(o))if("id"in y){const M=y.id,D=(_=y.filter)===null||_===void 0?void 0:_.event;return M&&((w=t.ids)===null||w===void 0?void 0:w.includes(M))&&(D==="*"||D?.toLocaleLowerCase()===((j=t.data)===null||j===void 0?void 0:j.type.toLocaleLowerCase()))}else{const M=(P=(C=y?.filter)===null||C===void 0?void 0:C.event)===null||P===void 0?void 0:P.toLocaleLowerCase();return M==="*"||M===((O=t?.event)===null||O===void 0?void 0:O.toLocaleLowerCase())}else return y.type.toLocaleLowerCase()===o}).map(y=>{if(typeof x=="object"&&"ids"in x){const _=x.data,{schema:w,table:j,commit_timestamp:C,type:P,errors:O}=_;x=Object.assign(Object.assign({},{schema:w,table:j,commit_timestamp:C,eventType:P,new:{},old:{},errors:O}),this._getPayloadRecords(_))}y.callback(x,r)})}_isClosed(){return this.state===Cr.closed}_isJoined(){return this.state===Cr.joined}_isJoining(){return this.state===Cr.joining}_isLeaving(){return this.state===Cr.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,r){const s=e.toLocaleLowerCase(),a={type:s,filter:t,callback:r};return this.bindings[s]?this.bindings[s].push(a):this.bindings[s]=[a],this}_off(e,t){const r=e.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(s=>{var a;return!(((a=s.type)===null||a===void 0?void 0:a.toLocaleLowerCase())===r&&c1.isEqual(s.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const r in e)if(e[r]!==t[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Hi.close,{},e)}_onError(e){this._on(Hi.error,{},t=>e(t))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=Cr.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(t.new=Ak(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(t.old=Ak(e.columns,e.old_record)),t}}const nb=()=>{},Fp={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},EU=[1e3,2e3,5e3,1e4],DU=1e4,OU=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class IU{constructor(e,t){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=ZN,this.transport=null,this.heartbeatIntervalMs=Fp.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=nb,this.ref=0,this.reconnectTimer=null,this.vsn=Ik,this.logger=nb,this.conn=null,this.sendBuffer=[],this.serializer=new NU,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=s=>s?(...a)=>s(...a):(...a)=>fetch(...a),!(!((r=t?.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=t.params.apikey,this.endPoint=`${e}/${KN.websocket}`,this.httpEndpoint=K4(e),this._initializeOptions(t),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(t?.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this.accessToken&&!this._authPromise&&this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=yU.createWebSocket(this.endpointURL())}catch(e){this._setConnectionState("disconnected");const t=e.message;throw t.includes("Node.js")?new Error(`${t}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${t}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:this.vsn}))}disconnect(e,t){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},typeof this.conn.close=="function"&&(e?this.conn.close(e,t??""):this.conn.close()),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map(t=>t.unsubscribe()));return this.channels=[],this.disconnect(),e}log(e,t,r){this.logger(e,t,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ru.connecting:return su.Connecting;case ru.open:return su.Open;case ru.closing:return su.Closing;default:return su.Closed}}isConnected(){return this.connectionState()===su.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(e,t={config:{}}){const r=`realtime:${e}`,s=this.getChannels().find(a=>a.topic===r);if(s)return s;{const a=new c1(`realtime:${e}`,t,this);return this.channels.push(a),a}}push(e){const{topic:t,event:r,payload:s,ref:a}=e,o=()=>{this.encode(e,l=>{var c;(c=this.conn)===null||c===void 0||c.send(l)})};this.log("push",`${t} ${r} (${a})`,s),this.isConnected()?o():this.sendBuffer.push(o)}async setAuth(e=null){this._authPromise=this._performAuth(e);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var e;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(t){this.log("error","error in heartbeat callback",t)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(t){this.log("error","error in heartbeat callback",t)}this._wasManualDisconnect=!1,(e=this.conn)===null||e===void 0||e.close(_U,"heartbeat timeout"),setTimeout(()=>{var t;this.isConnected()||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout()},Fp.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(t){this.log("error","error in heartbeat callback",t)}this._setAuthSafely("heartbeat")}onHeartbeat(e){this.heartbeatCallback=e}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter(t=>t.topic!==e.topic)}_onConnMessage(e){this.decode(e.data,t=>{if(t.topic==="phoenix"&&t.event==="phx_reply")try{this.heartbeatCallback(t.payload.status==="ok"?"ok":"error")}catch(d){this.log("error","error in heartbeat callback",d)}t.ref&&t.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:s,payload:a,ref:o}=t,l=o?`(${o})`:"",c=a.status||"";this.log("receive",`${c} ${r} ${s} ${l}`.trim(),a),this.channels.filter(d=>d._isMember(r)).forEach(d=>d._trigger(s,a,o)),this._triggerStateCallbacks("message",t)})}_clearTimer(e){var t;e==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):e==="reconnect"&&((t=this.reconnectTimer)===null||t===void 0||t.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_teardownConnection(){if(this.conn){if(this.conn.readyState===ru.open||this.conn.readyState===ru.connecting)try{this.conn.close()}catch(e){this.log("error","Error closing connection",e)}this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null}this._clearAllTimers(),this.channels.forEach(e=>e.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),(this._authPromise||(this.accessToken&&!this.accessTokenValue?this.setAuth():Promise.resolve())).then(()=>{this.flushSendBuffer()}).catch(t=>{this.log("error","error waiting for auth on connect",t),this.flushSendBuffer()}),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=t=>{this.log("worker","worker error",t.message),this.workerRef.terminate()},this.workerRef.onmessage=t=>{t.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(e){var t;this._setConnectionState("disconnected"),this.log("transport","close",e),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(t=this.reconnectTimer)===null||t===void 0||t.scheduleTimeout(),this._triggerStateCallbacks("close",e)}_onConnError(e){this._setConnectionState("disconnected"),this.log("transport",`${e}`),this._triggerChanError(),this._triggerStateCallbacks("error",e)}_triggerChanError(){this.channels.forEach(e=>e._trigger(Hi.error))}_appendParams(e,t){if(Object.keys(t).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(t);return`${e}${r}${s}`}_workerObjectUrl(e){let t;if(e)t=e;else{const r=new Blob([OU],{type:"application/javascript"});t=URL.createObjectURL(r)}return t}_setConnectionState(e,t=!1){this._connectionState=e,e==="connecting"?this._wasManualDisconnect=!1:e==="disconnecting"&&(this._wasManualDisconnect=t)}async _performAuth(e=null){let t;e?t=e:this.accessToken?t=await this.accessToken():t=this.accessTokenValue,this.accessTokenValue!=t&&(this.accessTokenValue=t,this.channels.forEach(r=>{const s={access_token:t,version:bU};t&&r.updateJoinPayload(s),r.joinedOnce&&r._isJoined()&&r._push(Hi.access_token,{access_token:t})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(e="general"){this.setAuth().catch(t=>{this.log("error",`error setting auth in ${e}`,t)})}_triggerStateCallbacks(e,t){try{this.stateChangeCallbacks[e].forEach(r=>{try{r(t)}catch(s){this.log("error",`error in ${e} callback`,s)}})}catch(r){this.log("error",`error triggering ${e} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new G4(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},Fp.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(e){var t,r,s,a,o,l,c,d,h,p,x,y;switch(this.transport=(t=e?.transport)!==null&&t!==void 0?t:null,this.timeout=(r=e?.timeout)!==null&&r!==void 0?r:ZN,this.heartbeatIntervalMs=(s=e?.heartbeatIntervalMs)!==null&&s!==void 0?s:Fp.HEARTBEAT_INTERVAL,this.worker=(a=e?.worker)!==null&&a!==void 0?a:!1,this.accessToken=(o=e?.accessToken)!==null&&o!==void 0?o:null,this.heartbeatCallback=(l=e?.heartbeatCallback)!==null&&l!==void 0?l:nb,this.vsn=(c=e?.vsn)!==null&&c!==void 0?c:Ik,e?.params&&(this.params=e.params),e?.logger&&(this.logger=e.logger),(e?.logLevel||e?.log_level)&&(this.logLevel=e.logLevel||e.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(d=e?.reconnectAfterMs)!==null&&d!==void 0?d:(_=>EU[_-1]||DU),this.vsn){case Y4:this.encode=(h=e?.encode)!==null&&h!==void 0?h:((_,w)=>w(JSON.stringify(_))),this.decode=(p=e?.decode)!==null&&p!==void 0?p:((_,w)=>w(JSON.parse(_)));break;case wU:this.encode=(x=e?.encode)!==null&&x!==void 0?x:this.serializer.encode.bind(this.serializer),this.decode=(y=e?.decode)!==null&&y!==void 0?y:this.serializer.decode.bind(this.serializer);break;default:throw new Error(`Unsupported serializer version: ${this.vsn}`)}if(this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=e?.workerUrl}}}class d1 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function Qn(n){return typeof n=="object"&&n!==null&&"__isStorageError"in n}class AU extends d1{constructor(e,t,r){super(e),this.name="StorageApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class QN extends d1{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}const u1=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),RU=()=>Response,XN=n=>{if(Array.isArray(n))return n.map(t=>XN(t));if(typeof n=="function"||n!==Object(n))return n;const e={};return Object.entries(n).forEach(([t,r])=>{const s=t.replace(/([-_][a-z])/gi,a=>a.toUpperCase().replace(/[-_]/g,""));e[s]=XN(r)}),e},LU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},rb=n=>{var e;return n.msg||n.message||n.error_description||(typeof n.error=="string"?n.error:(e=n.error)===null||e===void 0?void 0:e.message)||JSON.stringify(n)},FU=(n,e,t)=>bt(void 0,void 0,void 0,function*(){const r=yield RU();n instanceof r&&!t?.noResolveJson?n.json().then(s=>{const a=n.status||500,o=s?.statusCode||a+"";e(new AU(rb(s),a,o))}).catch(s=>{e(new QN(rb(s),s))}):e(new QN(rb(n),n))}),qU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"||!r?s:(LU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,e?.duplex&&(s.duplex=e.duplex),Object.assign(Object.assign({},s),t))};function Mm(n,e,t,r,s,a){return bt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,qU(e,r,s,a)).then(c=>{if(!c.ok)throw c;return r?.noResolveJson?c:c.json()}).then(c=>o(c)).catch(c=>FU(c,l,r))})})}function lm(n,e,t,r){return bt(this,void 0,void 0,function*(){return Mm(n,"GET",e,t,r)})}function Sa(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Mm(n,"POST",e,r,s,t)})}function eS(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Mm(n,"PUT",e,r,s,t)})}function zU(n,e,t,r){return bt(this,void 0,void 0,function*(){return Mm(n,"HEAD",e,Object.assign(Object.assign({},t),{noResolveJson:!0}),r)})}function f1(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return Mm(n,"DELETE",e,r,s,t)})}class UU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t}then(e,t){return this.execute().then(e,t)}execute(){return bt(this,void 0,void 0,function*(){try{return{data:(yield this.downloadFn()).body,error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qn(e))return{data:null,error:e};throw e}})}}var J4;class BU{constructor(e,t){this.downloadFn=e,this.shouldThrowOnError=t,this[J4]="BlobDownloadBuilder",this.promise=null}asStream(){return new UU(this.downloadFn,this.shouldThrowOnError)}then(e,t){return this.getPromise().then(e,t)}catch(e){return this.getPromise().catch(e)}finally(e){return this.getPromise().finally(e)}getPromise(){return this.promise||(this.promise=this.execute()),this.promise}execute(){return bt(this,void 0,void 0,function*(){try{return{data:yield(yield this.downloadFn()).blob(),error:null}}catch(e){if(this.shouldThrowOnError)throw e;if(Qn(e))return{data:null,error:e};throw e}})}}J4=Symbol.toStringTag;const VU={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Fk={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class WU{constructor(e,t={},r,s){this.shouldThrowOnError=!1,this.url=e,this.headers=t,this.bucketId=r,this.fetch=u1(s)}throwOnError(){return this.shouldThrowOnError=!0,this}uploadOrUpdate(e,t,r,s){return bt(this,void 0,void 0,function*(){try{let a;const o=Object.assign(Object.assign({},Fk),s);let l=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(o.upsert)});const c=o.metadata;typeof Blob<"u"&&r instanceof Blob?(a=new FormData,a.append("cacheControl",o.cacheControl),c&&a.append("metadata",this.encodeMetadata(c)),a.append("",r)):typeof FormData<"u"&&r instanceof FormData?(a=r,a.has("cacheControl")||a.append("cacheControl",o.cacheControl),c&&!a.has("metadata")&&a.append("metadata",this.encodeMetadata(c))):(a=r,l["cache-control"]=`max-age=${o.cacheControl}`,l["content-type"]=o.contentType,c&&(l["x-metadata"]=this.toBase64(this.encodeMetadata(c))),(typeof ReadableStream<"u"&&a instanceof ReadableStream||a&&typeof a=="object"&&"pipe"in a&&typeof a.pipe=="function")&&!o.duplex&&(o.duplex="half")),s?.headers&&(l=Object.assign(Object.assign({},l),s.headers));const d=this._removeEmptyFolders(t),h=this._getFinalPath(d),p=yield(e=="PUT"?eS:Sa)(this.fetch,`${this.url}/object/${h}`,a,Object.assign({headers:l},o?.duplex?{duplex:o.duplex}:{}));return{data:{path:d,id:p.Id,fullPath:p.Key},error:null}}catch(a){if(this.shouldThrowOnError)throw a;if(Qn(a))return{data:null,error:a};throw a}})}upload(e,t,r){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,t,r)})}uploadToSignedUrl(e,t,r,s){return bt(this,void 0,void 0,function*(){const a=this._removeEmptyFolders(e),o=this._getFinalPath(a),l=new URL(this.url+`/object/upload/sign/${o}`);l.searchParams.set("token",t);try{let c;const d=Object.assign({upsert:Fk.upsert},s),h=Object.assign(Object.assign({},this.headers),{"x-upsert":String(d.upsert)});typeof Blob<"u"&&r instanceof Blob?(c=new FormData,c.append("cacheControl",d.cacheControl),c.append("",r)):typeof FormData<"u"&&r instanceof FormData?(c=r,c.append("cacheControl",d.cacheControl)):(c=r,h["cache-control"]=`max-age=${d.cacheControl}`,h["content-type"]=d.contentType);const p=yield eS(this.fetch,l.toString(),c,{headers:h});return{data:{path:a,fullPath:p.Key},error:null}}catch(c){if(this.shouldThrowOnError)throw c;if(Qn(c))return{data:null,error:c};throw c}})}createSignedUploadUrl(e,t){return bt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);t?.upsert&&(s["x-upsert"]="true");const a=yield Sa(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),o=new URL(this.url+a.url),l=o.searchParams.get("token");if(!l)throw new d1("No token returned by API");return{data:{signedUrl:o.toString(),path:e,token:l},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}update(e,t,r){return bt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,t,r)})}move(e,t,r){return bt(this,void 0,void 0,function*(){try{return{data:yield Sa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}copy(e,t,r){return bt(this,void 0,void 0,function*(){try{return{data:{path:(yield Sa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}createSignedUrl(e,t,r){return bt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),a=yield Sa(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:t},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const o=r?.download?`&download=${r.download===!0?"":r.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${o}`)},{data:a,error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}createSignedUrls(e,t,r){return bt(this,void 0,void 0,function*(){try{const s=yield Sa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(o=>Object.assign(Object.assign({},o),{signedUrl:o.signedURL?encodeURI(`${this.url}${o.signedURL}${a}`):null})),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}download(e,t){const s=typeof t?.transform<"u"?"render/image/authenticated":"object",a=this.transformOptsToQueryString(t?.transform||{}),o=a?`?${a}`:"",l=this._getFinalPath(e),c=()=>lm(this.fetch,`${this.url}/${s}/${l}${o}`,{headers:this.headers,noResolveJson:!0});return new BU(c,this.shouldThrowOnError)}info(e){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{const r=yield lm(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:XN(r),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}exists(e){return bt(this,void 0,void 0,function*(){const t=this._getFinalPath(e);try{return yield zU(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r)&&r instanceof QN){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,t){const r=this._getFinalPath(e),s=[],a=t?.download?`download=${t.download===!0?"":t.download}`:"";a!==""&&s.push(a);const l=typeof t?.transform<"u"?"render/image":"object",c=this.transformOptsToQueryString(t?.transform||{});c!==""&&s.push(c);let d=s.join("&");return d!==""&&(d=`?${d}`),{data:{publicUrl:encodeURI(`${this.url}/${l}/public/${r}${d}`)}}}remove(e){return bt(this,void 0,void 0,function*(){try{return{data:yield f1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}list(e,t,r){return bt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},VU),t),{prefix:e||""});return{data:yield Sa(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}listV2(e,t){return bt(this,void 0,void 0,function*(){try{const r=Object.assign({},e);return{data:yield Sa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},t),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e.replace(/^\/+/,"")}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const Q4="2.81.1",X4={"X-Client-Info":`storage-js/${Q4}`};class $U{constructor(e,t={},r,s){this.shouldThrowOnError=!1;const a=new URL(e);s?.useNewHostname&&/supabase\.(co|in|red)$/.test(a.hostname)&&!a.hostname.includes("storage.supabase.")&&(a.hostname=a.hostname.replace("supabase.","storage.supabase.")),this.url=a.href.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},X4),t),this.fetch=u1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}listBuckets(e){return bt(this,void 0,void 0,function*(){try{const t=this.listBucketOptionsToQueryString(e);return{data:yield lm(this.fetch,`${this.url}/bucket${t}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}getBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield lm(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}createBucket(e){return bt(this,arguments,void 0,function*(t,r={public:!1}){try{return{data:yield Sa(this.fetch,`${this.url}/bucket`,{id:t,name:t,type:r.type,public:r.public,file_size_limit:r.fileSizeLimit,allowed_mime_types:r.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(this.shouldThrowOnError)throw s;if(Qn(s))return{data:null,error:s};throw s}})}updateBucket(e,t){return bt(this,void 0,void 0,function*(){try{return{data:yield eS(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(Qn(r))return{data:null,error:r};throw r}})}emptyBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield Sa(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield f1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}listBucketOptionsToQueryString(e){const t={};return e&&("limit"in e&&(t.limit=String(e.limit)),"offset"in e&&(t.offset=String(e.offset)),e.search&&(t.search=e.search),e.sortColumn&&(t.sortColumn=e.sortColumn),e.sortOrder&&(t.sortOrder=e.sortOrder)),Object.keys(t).length>0?"?"+new URLSearchParams(t).toString():""}}class HU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},X4),t),this.fetch=u1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield Sa(this.fetch,`${this.url}/bucket`,{name:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}listBuckets(e){return bt(this,void 0,void 0,function*(){try{const t=new URLSearchParams;e?.limit!==void 0&&t.set("limit",e.limit.toString()),e?.offset!==void 0&&t.set("offset",e.offset.toString()),e?.sortColumn&&t.set("sortColumn",e.sortColumn),e?.sortOrder&&t.set("sortOrder",e.sortOrder),e?.search&&t.set("search",e.search);const r=t.toString(),s=r?`${this.url}/bucket?${r}`:`${this.url}/bucket`;return{data:yield lm(this.fetch,s,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield f1(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(Qn(t))return{data:null,error:t};throw t}})}}const h1={"X-Client-Info":`storage-js/${Q4}`,"Content-Type":"application/json"};class eF extends Error{constructor(e){super(e),this.__isStorageVectorsError=!0,this.name="StorageVectorsError"}}function mi(n){return typeof n=="object"&&n!==null&&"__isStorageVectorsError"in n}class sb extends eF{constructor(e,t,r){super(e),this.name="StorageVectorsApiError",this.status=t,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class YU extends eF{constructor(e,t){super(e),this.name="StorageVectorsUnknownError",this.originalError=t}}var qk;(function(n){n.InternalError="InternalError",n.S3VectorConflictException="S3VectorConflictException",n.S3VectorNotFoundException="S3VectorNotFoundException",n.S3VectorBucketNotEmpty="S3VectorBucketNotEmpty",n.S3VectorMaxBucketsExceeded="S3VectorMaxBucketsExceeded",n.S3VectorMaxIndexesExceeded="S3VectorMaxIndexesExceeded"})(qk||(qk={}));const m1=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),GU=n=>{if(typeof n!="object"||n===null)return!1;const e=Object.getPrototypeOf(n);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in n)&&!(Symbol.iterator in n)},zk=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),ZU=(n,e,t)=>bt(void 0,void 0,void 0,function*(){if(n&&typeof n=="object"&&"status"in n&&"ok"in n&&typeof n.status=="number"&&!t?.noResolveJson){const s=n.status||500,a=n;if(typeof a.json=="function")a.json().then(o=>{const l=o?.statusCode||o?.code||s+"";e(new sb(zk(o),s,l))}).catch(()=>{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new sb(l,s,o))});else{const o=s+"",l=a.statusText||`HTTP ${s} error`;e(new sb(l,s,o))}}else e(new YU(zk(n),n))}),KU=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return r?(GU(r)?(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),s.body=JSON.stringify(r)):s.body=r,Object.assign(Object.assign({},s),t)):s};function JU(n,e,t,r,s,a){return bt(this,void 0,void 0,function*(){return new Promise((o,l)=>{n(t,KU(e,r,s,a)).then(c=>{if(!c.ok)throw c;if(r?.noResolveJson)return c;const d=c.headers.get("content-type");return!d||!d.includes("application/json")?{}:c.json()}).then(c=>o(c)).catch(c=>ZU(c,l,r))})})}function pi(n,e,t,r,s){return bt(this,void 0,void 0,function*(){return JU(n,"POST",e,r,s,t)})}class QU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},h1),t),this.fetch=m1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createIndex(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield pi(this.fetch,`${this.url}/CreateIndex`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}getIndex(e,t){return bt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/GetIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}),error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mi(r))return{data:null,error:r};throw r}})}listIndexes(e){return bt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/ListIndexes`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}deleteIndex(e,t){return bt(this,void 0,void 0,function*(){try{return{data:(yield pi(this.fetch,`${this.url}/DeleteIndex`,{vectorBucketName:e,indexName:t},{headers:this.headers}))||{},error:null}}catch(r){if(this.shouldThrowOnError)throw r;if(mi(r))return{data:null,error:r};throw r}})}}class XU{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},h1),t),this.fetch=m1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}putVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.vectors.length<1||e.vectors.length>500)throw new Error("Vector batch size must be between 1 and 500 items");return{data:(yield pi(this.fetch,`${this.url}/PutVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}getVectors(e){return bt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/GetVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}listVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.segmentCount!==void 0){if(e.segmentCount<1||e.segmentCount>16)throw new Error("segmentCount must be between 1 and 16");if(e.segmentIndex!==void 0&&(e.segmentIndex<0||e.segmentIndex>=e.segmentCount))throw new Error(`segmentIndex must be between 0 and ${e.segmentCount-1}`)}return{data:yield pi(this.fetch,`${this.url}/ListVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}queryVectors(e){return bt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/QueryVectors`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}deleteVectors(e){return bt(this,void 0,void 0,function*(){try{if(e.keys.length<1||e.keys.length>500)throw new Error("Keys batch size must be between 1 and 500 items");return{data:(yield pi(this.fetch,`${this.url}/DeleteVectors`,e,{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}}class eB{constructor(e,t={},r){this.shouldThrowOnError=!1,this.url=e.replace(/\/$/,""),this.headers=Object.assign(Object.assign({},h1),t),this.fetch=m1(r)}throwOnError(){return this.shouldThrowOnError=!0,this}createBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield pi(this.fetch,`${this.url}/CreateVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}getBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:yield pi(this.fetch,`${this.url}/GetVectorBucket`,{vectorBucketName:e},{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}listBuckets(){return bt(this,arguments,void 0,function*(e={}){try{return{data:yield pi(this.fetch,`${this.url}/ListVectorBuckets`,e,{headers:this.headers}),error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}deleteBucket(e){return bt(this,void 0,void 0,function*(){try{return{data:(yield pi(this.fetch,`${this.url}/DeleteVectorBucket`,{vectorBucketName:e},{headers:this.headers}))||{},error:null}}catch(t){if(this.shouldThrowOnError)throw t;if(mi(t))return{data:null,error:t};throw t}})}}class tB extends eB{constructor(e,t={}){super(e,t.headers||{},t.fetch)}from(e){return new nB(this.url,this.headers,e,this.fetch)}}class nB extends QU{constructor(e,t,r,s){super(e,t,s),this.vectorBucketName=r}createIndex(e){const t=Object.create(null,{createIndex:{get:()=>super.createIndex}});return bt(this,void 0,void 0,function*(){return t.createIndex.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName}))})}listIndexes(){const e=Object.create(null,{listIndexes:{get:()=>super.listIndexes}});return bt(this,arguments,void 0,function*(t={}){return e.listIndexes.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName}))})}getIndex(e){const t=Object.create(null,{getIndex:{get:()=>super.getIndex}});return bt(this,void 0,void 0,function*(){return t.getIndex.call(this,this.vectorBucketName,e)})}deleteIndex(e){const t=Object.create(null,{deleteIndex:{get:()=>super.deleteIndex}});return bt(this,void 0,void 0,function*(){return t.deleteIndex.call(this,this.vectorBucketName,e)})}index(e){return new rB(this.url,this.headers,this.vectorBucketName,e,this.fetch)}}class rB extends XU{constructor(e,t,r,s,a){super(e,t,a),this.vectorBucketName=r,this.indexName=s}putVectors(e){const t=Object.create(null,{putVectors:{get:()=>super.putVectors}});return bt(this,void 0,void 0,function*(){return t.putVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}getVectors(e){const t=Object.create(null,{getVectors:{get:()=>super.getVectors}});return bt(this,void 0,void 0,function*(){return t.getVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}listVectors(){const e=Object.create(null,{listVectors:{get:()=>super.listVectors}});return bt(this,arguments,void 0,function*(t={}){return e.listVectors.call(this,Object.assign(Object.assign({},t),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}queryVectors(e){const t=Object.create(null,{queryVectors:{get:()=>super.queryVectors}});return bt(this,void 0,void 0,function*(){return t.queryVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}deleteVectors(e){const t=Object.create(null,{deleteVectors:{get:()=>super.deleteVectors}});return bt(this,void 0,void 0,function*(){return t.deleteVectors.call(this,Object.assign(Object.assign({},e),{vectorBucketName:this.vectorBucketName,indexName:this.indexName}))})}}class sB extends $U{constructor(e,t={},r,s){super(e,t,r,s)}from(e){return new WU(this.url,this.headers,e,this.fetch)}get vectors(){return new tB(this.url+"/vector",{headers:this.headers,fetch:this.fetch})}get analytics(){return new HU(this.url+"/iceberg",this.headers,this.fetch)}}const iB="2.81.1";let Vh="";typeof Deno<"u"?Vh="deno":typeof document<"u"?Vh="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Vh="react-native":Vh="node";const aB={"X-Client-Info":`supabase-js-${Vh}/${iB}`},oB={headers:aB},lB={schema:"public"},cB={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},dB={},uB=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),fB=()=>Headers,hB=(n,e,t)=>{const r=uB(t),s=fB();return async(a,o)=>{var l;const c=(l=await e())!==null&&l!==void 0?l:n;let d=new s(o?.headers);return d.has("apikey")||d.set("apikey",n),d.has("Authorization")||d.set("Authorization",`Bearer ${c}`),r(a,Object.assign(Object.assign({},o),{headers:d}))}};function mB(n){return n.endsWith("/")?n:n+"/"}function pB(n,e){var t,r;const{db:s,auth:a,realtime:o,global:l}=n,{db:c,auth:d,realtime:h,global:p}=e,x={db:Object.assign(Object.assign({},c),s),auth:Object.assign(Object.assign({},d),a),realtime:Object.assign(Object.assign({},h),o),storage:{},global:Object.assign(Object.assign(Object.assign({},p),l),{headers:Object.assign(Object.assign({},(t=p?.headers)!==null&&t!==void 0?t:{}),(r=l?.headers)!==null&&r!==void 0?r:{})}),accessToken:async()=>""};return n.accessToken?x.accessToken=n.accessToken:delete x.accessToken,x}function gB(n){const e=n?.trim();if(!e)throw new Error("supabaseUrl is required.");if(!e.match(/^https?:\/\//i))throw new Error("Invalid supabaseUrl: Must be a valid HTTP or HTTPS URL.");try{return new URL(mB(e))}catch{throw Error("Invalid supabaseUrl: Provided URL is malformed.")}}const tF="2.81.1",sf=30*1e3,tS=3,ib=tS*sf,xB="http://localhost:9999",yB="supabase.auth.token",vB={"X-Client-Info":`gotrue-js/${tF}`},nS="X-Supabase-Api-Version",nF={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},bB=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,wB=600*1e3;class cm extends Error{constructor(e,t,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=r}}function wt(n){return typeof n=="object"&&n!==null&&"__isAuthError"in n}class _B extends cm{constructor(e,t,r){super(e,t,r),this.name="AuthApiError",this.status=t,this.code=r}}function jB(n){return wt(n)&&n.name==="AuthApiError"}class iu extends cm{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class Zc extends cm{constructor(e,t,r,s){super(e,r,s),this.name=t,this.status=r}}class ja extends Zc{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function NB(n){return wt(n)&&n.name==="AuthSessionMissingError"}class Hu extends Zc{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class qp extends Zc{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class zp extends Zc{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function SB(n){return wt(n)&&n.name==="AuthImplicitGrantRedirectError"}class Uk extends Zc{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class rS extends Zc{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function ab(n){return wt(n)&&n.name==="AuthRetryableFetchError"}class Bk extends Zc{constructor(e,t,r){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=r}}class sS extends Zc{constructor(e){super(e,"AuthInvalidJwtError",400,"invalid_jwt")}}const vx="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Vk=` 	
\r=`.split(""),CB=(()=>{const n=new Array(128);for(let e=0;e<n.length;e+=1)n[e]=-1;for(let e=0;e<Vk.length;e+=1)n[Vk[e].charCodeAt(0)]=-2;for(let e=0;e<vx.length;e+=1)n[vx[e].charCodeAt(0)]=e;return n})();function Wk(n,e,t){if(n!==null)for(e.queue=e.queue<<8|n,e.queuedBits+=8;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(vx[r]),e.queuedBits-=6}else if(e.queuedBits>0)for(e.queue=e.queue<<6-e.queuedBits,e.queuedBits=6;e.queuedBits>=6;){const r=e.queue>>e.queuedBits-6&63;t(vx[r]),e.queuedBits-=6}}function rF(n,e,t){const r=CB[n];if(r>-1)for(e.queue=e.queue<<6|r,e.queuedBits+=6;e.queuedBits>=8;)t(e.queue>>e.queuedBits-8&255),e.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(n)}"`)}}function $k(n){const e=[],t=o=>{e.push(String.fromCodePoint(o))},r={utf8seq:0,codepoint:0},s={queue:0,queuedBits:0},a=o=>{PB(o,r,t)};for(let o=0;o<n.length;o+=1)rF(n.charCodeAt(o),s,a);return e.join("")}function TB(n,e){if(n<=127){e(n);return}else if(n<=2047){e(192|n>>6),e(128|n&63);return}else if(n<=65535){e(224|n>>12),e(128|n>>6&63),e(128|n&63);return}else if(n<=1114111){e(240|n>>18),e(128|n>>12&63),e(128|n>>6&63),e(128|n&63);return}throw new Error(`Unrecognized Unicode codepoint: ${n.toString(16)}`)}function kB(n,e){for(let t=0;t<n.length;t+=1){let r=n.charCodeAt(t);if(r>55295&&r<=56319){const s=(r-55296)*1024&65535;r=(n.charCodeAt(t+1)-56320&65535|s)+65536,t+=1}TB(r,e)}}function PB(n,e,t){if(e.utf8seq===0){if(n<=127){t(n);return}for(let r=1;r<6;r+=1)if((n>>7-r&1)===0){e.utf8seq=r;break}if(e.utf8seq===2)e.codepoint=n&31;else if(e.utf8seq===3)e.codepoint=n&15;else if(e.utf8seq===4)e.codepoint=n&7;else throw new Error("Invalid UTF-8 sequence");e.utf8seq-=1}else if(e.utf8seq>0){if(n<=127)throw new Error("Invalid UTF-8 sequence");e.codepoint=e.codepoint<<6|n&63,e.utf8seq-=1,e.utf8seq===0&&t(e.codepoint)}}function hf(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};for(let s=0;s<n.length;s+=1)rF(n.charCodeAt(s),t,r);return new Uint8Array(e)}function MB(n){const e=[];return kB(n,t=>e.push(t)),new Uint8Array(e)}function au(n){const e=[],t={queue:0,queuedBits:0},r=s=>{e.push(s)};return n.forEach(s=>Wk(s,t,r)),Wk(null,t,r),e.join("")}function EB(n){return Math.round(Date.now()/1e3)+n}function DB(){return Symbol("auth-callback")}const Yr=()=>typeof window<"u"&&typeof document<"u",Vd={tested:!1,writable:!1},sF=()=>{if(!Yr())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Vd.tested)return Vd.writable;const n=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(n,n),globalThis.localStorage.removeItem(n),Vd.tested=!0,Vd.writable=!0}catch{Vd.tested=!0,Vd.writable=!1}return Vd.writable};function OB(n){const e={},t=new URL(n);if(t.hash&&t.hash[0]==="#")try{new URLSearchParams(t.hash.substring(1)).forEach((s,a)=>{e[a]=s})}catch{}return t.searchParams.forEach((r,s)=>{e[s]=r}),e}const iF=n=>n?(...e)=>n(...e):(...e)=>fetch(...e),IB=n=>typeof n=="object"&&n!==null&&"status"in n&&"ok"in n&&"json"in n&&typeof n.json=="function",af=async(n,e,t)=>{await n.setItem(e,JSON.stringify(t))},Wd=async(n,e)=>{const t=await n.getItem(e);if(!t)return null;try{return JSON.parse(t)}catch{return t}},jc=async(n,e)=>{await n.removeItem(e)};class ey{constructor(){this.promise=new ey.promiseConstructor((e,t)=>{this.resolve=e,this.reject=t})}}ey.promiseConstructor=Promise;function ob(n){const e=n.split(".");if(e.length!==3)throw new sS("Invalid JWT structure");for(let r=0;r<e.length;r++)if(!bB.test(e[r]))throw new sS("JWT not in base64url format");return{header:JSON.parse($k(e[0])),payload:JSON.parse($k(e[1])),signature:hf(e[2]),raw:{header:e[0],payload:e[1]}}}async function AB(n){return await new Promise(e=>{setTimeout(()=>e(null),n)})}function RB(n,e){return new Promise((r,s)=>{(async()=>{for(let a=0;a<1/0;a++)try{const o=await n(a);if(!e(a,null,o)){r(o);return}}catch(o){if(!e(a,o)){s(o);return}}})()})}function LB(n){return("0"+n.toString(16)).substr(-2)}function FB(){const e=new Uint32Array(56);if(typeof crypto>"u"){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=t.length;let s="";for(let a=0;a<56;a++)s+=t.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,LB).join("")}async function qB(n){const t=new TextEncoder().encode(n),r=await crypto.subtle.digest("SHA-256",t),s=new Uint8Array(r);return Array.from(s).map(a=>String.fromCharCode(a)).join("")}async function zB(n){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),n;const t=await qB(n);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Yu(n,e,t=!1){const r=FB();let s=r;t&&(s+="/PASSWORD_RECOVERY"),await af(n,`${e}-code-verifier`,s);const a=await zB(r);return[a,r===a?"plain":"s256"]}const UB=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function BB(n){const e=n.headers.get(nS);if(!e||!e.match(UB))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}function VB(n){if(!n)throw new Error("Missing exp claim");const e=Math.floor(Date.now()/1e3);if(n<=e)throw new Error("JWT has expired")}function WB(n){switch(n){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const $B=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function Gu(n){if(!$B.test(n))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function lb(){const n={};return new Proxy(n,{get:(e,t)=>{if(t==="__isUserNotAvailableProxy")return!0;if(typeof t=="symbol"){const r=t.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${t}" property of the session object is not supported. Please use getUser() instead.`)},set:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(e,t)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${t}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function HB(n,e){return new Proxy(n,{get:(t,r,s)=>{if(r==="__isInsecureUserWarningProxy")return!0;if(typeof r=="symbol"){const a=r.toString();if(a==="Symbol(Symbol.toPrimitive)"||a==="Symbol(Symbol.toStringTag)"||a==="Symbol(util.inspect.custom)"||a==="Symbol(nodejs.util.inspect.custom)")return Reflect.get(t,r,s)}return!e.value&&typeof r=="string"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),e.value=!0),Reflect.get(t,r,s)}})}function Hk(n){return JSON.parse(JSON.stringify(n))}const Xd=n=>n.msg||n.message||n.error_description||n.error||JSON.stringify(n),YB=[502,503,504];async function Yk(n){var e;if(!IB(n))throw new rS(Xd(n),0);if(YB.includes(n.status))throw new rS(Xd(n),n.status);let t;try{t=await n.json()}catch(a){throw new iu(Xd(a),a)}let r;const s=BB(n);if(s&&s.getTime()>=nF["2024-01-01"].timestamp&&typeof t=="object"&&t&&typeof t.code=="string"?r=t.code:typeof t=="object"&&t&&typeof t.error_code=="string"&&(r=t.error_code),r){if(r==="weak_password")throw new Bk(Xd(t),n.status,((e=t.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ja}else if(typeof t=="object"&&t&&typeof t.weak_password=="object"&&t.weak_password&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.reasons.reduce((a,o)=>a&&typeof o=="string",!0))throw new Bk(Xd(t),n.status,t.weak_password.reasons);throw new _B(Xd(t),n.status||500,r)}const GB=(n,e,t,r)=>{const s={method:n,headers:e?.headers||{}};return n==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),t))};async function At(n,e,t,r){var s;const a=Object.assign({},r?.headers);a[nS]||(a[nS]=nF["2024-01-01"].name),r?.jwt&&(a.Authorization=`Bearer ${r.jwt}`);const o=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(o.redirect_to=r.redirectTo);const l=Object.keys(o).length?"?"+new URLSearchParams(o).toString():"",c=await ZB(n,e,t+l,{headers:a,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(c):{data:Object.assign({},c),error:null}}async function ZB(n,e,t,r,s,a){const o=GB(e,r,s,a);let l;try{l=await n(t,Object.assign({},o))}catch(c){throw console.error(c),new rS(Xd(c),0)}if(l.ok||await Yk(l),r?.noResolveJson)return l;try{return await l.json()}catch(c){await Yk(c)}}function Na(n){var e;let t=null;QB(n)&&(t=Object.assign({},n),n.expires_at||(t.expires_at=EB(n.expires_in)));const r=(e=n.user)!==null&&e!==void 0?e:n;return{data:{session:t,user:r},error:null}}function Gk(n){const e=Na(n);return!e.error&&n.weak_password&&typeof n.weak_password=="object"&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.message&&typeof n.weak_password.message=="string"&&n.weak_password.reasons.reduce((t,r)=>t&&typeof r=="string",!0)&&(e.data.weak_password=n.weak_password),e}function Ic(n){var e;return{data:{user:(e=n.user)!==null&&e!==void 0?e:n},error:null}}function KB(n){return{data:n,error:null}}function JB(n){const{action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a}=n,o=Vf(n,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),l={action_link:e,email_otp:t,hashed_token:r,redirect_to:s,verification_type:a},c=Object.assign({},o);return{data:{properties:l,user:c},error:null}}function Zk(n){return n}function QB(n){return n.access_token&&n.refresh_token&&n.expires_in}const cb=["global","local","others"];class XB{constructor({url:e="",headers:t={},fetch:r}){this.url=e,this.headers=t,this.fetch=iF(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)},this.oauth={listClients:this._listOAuthClients.bind(this),createClient:this._createOAuthClient.bind(this),getClient:this._getOAuthClient.bind(this),updateClient:this._updateOAuthClient.bind(this),deleteClient:this._deleteOAuthClient.bind(this),regenerateClientSecret:this._regenerateOAuthClientSecret.bind(this)}}async signOut(e,t=cb[0]){if(cb.indexOf(t)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${cb.join(", ")}`);try{return await At(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(wt(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,t={}){try{return await At(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:Ic})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:t}=e,r=Vf(e,["options"]),s=Object.assign(Object.assign({},r),t);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await At(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:JB,redirectTo:t?.redirectTo})}catch(t){if(wt(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await At(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:Ic})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await At(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{users:[]},error:d};throw d}}async getUserById(e){Gu(e);try{return await At(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:Ic})}catch(t){if(wt(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){Gu(e);try{return await At(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:Ic})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,t=!1){Gu(e);try{return await At(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:Ic})}catch(r){if(wt(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){Gu(e.userId);try{const{data:t,error:r}=await At(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:t,error:r}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _deleteFactor(e){Gu(e.userId),Gu(e.id);try{return{data:await At(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _listOAuthClients(e){var t,r,s,a,o,l,c;try{const d={nextPage:null,lastPage:0,total:0},h=await At(this.fetch,"GET",`${this.url}/admin/oauth/clients`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(t=e?.page)===null||t===void 0?void 0:t.toString())!==null&&r!==void 0?r:"",per_page:(a=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&a!==void 0?a:""},xform:Zk});if(h.error)throw h.error;const p=await h.json(),x=(o=h.headers.get("x-total-count"))!==null&&o!==void 0?o:0,y=(c=(l=h.headers.get("link"))===null||l===void 0?void 0:l.split(","))!==null&&c!==void 0?c:[];return y.length>0&&(y.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),j=JSON.parse(_.split(";")[1].split("=")[1]);d[`${j}Page`]=w}),d.total=parseInt(x)),{data:Object.assign(Object.assign({},p),d),error:null}}catch(d){if(wt(d))return{data:{clients:[]},error:d};throw d}}async _createOAuthClient(e){try{return await At(this.fetch,"POST",`${this.url}/admin/oauth/clients`,{body:e,headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _getOAuthClient(e){try{return await At(this.fetch,"GET",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _updateOAuthClient(e,t){try{return await At(this.fetch,"PUT",`${this.url}/admin/oauth/clients/${e}`,{body:t,headers:this.headers,xform:r=>({data:r,error:null})})}catch(r){if(wt(r))return{data:null,error:r};throw r}}async _deleteOAuthClient(e){try{return await At(this.fetch,"DELETE",`${this.url}/admin/oauth/clients/${e}`,{headers:this.headers,noResolveJson:!0}),{data:null,error:null}}catch(t){if(wt(t))return{data:null,error:t};throw t}}async _regenerateOAuthClientSecret(e){try{return await At(this.fetch,"POST",`${this.url}/admin/oauth/clients/${e}/regenerate_secret`,{headers:this.headers,xform:t=>({data:t,error:null})})}catch(t){if(wt(t))return{data:null,error:t};throw t}}}function Kk(n={}){return{getItem:e=>n[e]||null,setItem:(e,t)=>{n[e]=t},removeItem:e=>{delete n[e]}}}const Zu={debug:!!(globalThis&&sF()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class aF extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class eV extends aF{}async function tV(n,e,t){Zu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",n,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Zu.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",n)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(n,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Zu.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",n,s.name);try{return await t()}finally{Zu.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",n,s.name)}}else{if(e===0)throw Zu.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",n),new eV(`Acquiring an exclusive Navigator LockManager lock "${n}" immediately failed`);if(Zu.debug)try{const a=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(a,null,"  "))}catch(a){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",a)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await t()}}))}function nV(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}function oF(n){if(!/^0x[a-fA-F0-9]{40}$/.test(n))throw new Error(`@supabase/auth-js: Address "${n}" is invalid.`);return n.toLowerCase()}function rV(n){return parseInt(n,16)}function sV(n){const e=new TextEncoder().encode(n);return"0x"+Array.from(e,r=>r.toString(16).padStart(2,"0")).join("")}function iV(n){var e;const{chainId:t,domain:r,expirationTime:s,issuedAt:a=new Date,nonce:o,notBefore:l,requestId:c,resources:d,scheme:h,uri:p,version:x}=n;{if(!Number.isInteger(t))throw new Error(`@supabase/auth-js: Invalid SIWE message field "chainId". Chain ID must be a EIP-155 chain ID. Provided value: ${t}`);if(!r)throw new Error('@supabase/auth-js: Invalid SIWE message field "domain". Domain must be provided.');if(o&&o.length<8)throw new Error(`@supabase/auth-js: Invalid SIWE message field "nonce". Nonce must be at least 8 characters. Provided value: ${o}`);if(!p)throw new Error('@supabase/auth-js: Invalid SIWE message field "uri". URI must be provided.');if(x!=="1")throw new Error(`@supabase/auth-js: Invalid SIWE message field "version". Version must be '1'. Provided value: ${x}`);if(!((e=n.statement)===null||e===void 0)&&e.includes(`
`))throw new Error(`@supabase/auth-js: Invalid SIWE message field "statement". Statement must not include '\\n'. Provided value: ${n.statement}`)}const y=oF(n.address),_=h?`${h}://${r}`:r,w=n.statement?`${n.statement}
`:"",j=`${_} wants you to sign in with your Ethereum account:
${y}

${w}`;let C=`URI: ${p}
Version: ${x}
Chain ID: ${t}${o?`
Nonce: ${o}`:""}
Issued At: ${a.toISOString()}`;if(s&&(C+=`
Expiration Time: ${s.toISOString()}`),l&&(C+=`
Not Before: ${l.toISOString()}`),c&&(C+=`
Request ID: ${c}`),d){let P=`
Resources:`;for(const O of d){if(!O||typeof O!="string")throw new Error(`@supabase/auth-js: Invalid SIWE message field "resources". Every resource must be a valid string. Provided value: ${O}`);P+=`
- ${O}`}C+=P}return`${j}
${C}`}class xr extends Error{constructor({message:e,code:t,cause:r,name:s}){var a;super(e,{cause:r}),this.__isWebAuthnError=!0,this.name=(a=s??(r instanceof Error?r.name:void 0))!==null&&a!==void 0?a:"Unknown Error",this.code=t}}class bx extends xr{constructor(e,t){super({code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:t,message:e}),this.name="WebAuthnUnknownError",this.originalError=t}}function aV({error:n,options:e}){var t,r,s;const{publicKey:a}=e;if(!a)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new xr({message:"Registration ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else if(n.name==="ConstraintError"){if(((t=a.authenticatorSelection)===null||t===void 0?void 0:t.requireResidentKey)===!0)return new xr({message:"Discoverable credentials were required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_DISCOVERABLE_CREDENTIAL_SUPPORT",cause:n});if(e.mediation==="conditional"&&((r=a.authenticatorSelection)===null||r===void 0?void 0:r.userVerification)==="required")return new xr({message:"User verification was required during automatic registration but it could not be performed",code:"ERROR_AUTO_REGISTER_USER_VERIFICATION_FAILURE",cause:n});if(((s=a.authenticatorSelection)===null||s===void 0?void 0:s.userVerification)==="required")return new xr({message:"User verification was required but no available authenticator supported it",code:"ERROR_AUTHENTICATOR_MISSING_USER_VERIFICATION_SUPPORT",cause:n})}else{if(n.name==="InvalidStateError")return new xr({message:"The authenticator was previously registered",code:"ERROR_AUTHENTICATOR_PREVIOUSLY_REGISTERED",cause:n});if(n.name==="NotAllowedError")return new xr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="NotSupportedError")return a.pubKeyCredParams.filter(l=>l.type==="public-key").length===0?new xr({message:'No entry in pubKeyCredParams was of type "public-key"',code:"ERROR_MALFORMED_PUBKEYCREDPARAMS",cause:n}):new xr({message:"No available authenticator supported any of the specified pubKeyCredParams algorithms",code:"ERROR_AUTHENTICATOR_NO_SUPPORTED_PUBKEYCREDPARAMS_ALG",cause:n});if(n.name==="SecurityError"){const o=window.location.hostname;if(lF(o)){if(a.rp.id!==o)return new xr({message:`The RP ID "${a.rp.id}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new xr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="TypeError"){if(a.user.id.byteLength<1||a.user.id.byteLength>64)return new xr({message:"User ID was not between 1 and 64 characters",code:"ERROR_INVALID_USER_ID_LENGTH",cause:n})}else if(n.name==="UnknownError")return new xr({message:"The authenticator was unable to process the specified options, or could not create a new credential",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new xr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}function oV({error:n,options:e}){const{publicKey:t}=e;if(!t)throw Error("options was missing required publicKey property");if(n.name==="AbortError"){if(e.signal instanceof AbortSignal)return new xr({message:"Authentication ceremony was sent an abort signal",code:"ERROR_CEREMONY_ABORTED",cause:n})}else{if(n.name==="NotAllowedError")return new xr({message:n.message,code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n});if(n.name==="SecurityError"){const r=window.location.hostname;if(lF(r)){if(t.rpId!==r)return new xr({message:`The RP ID "${t.rpId}" is invalid for this domain`,code:"ERROR_INVALID_RP_ID",cause:n})}else return new xr({message:`${window.location.hostname} is an invalid domain`,code:"ERROR_INVALID_DOMAIN",cause:n})}else if(n.name==="UnknownError")return new xr({message:"The authenticator was unable to process the specified options, or could not create a new assertion signature",code:"ERROR_AUTHENTICATOR_GENERAL_ERROR",cause:n})}return new xr({message:"a Non-Webauthn related error has occurred",code:"ERROR_PASSTHROUGH_SEE_CAUSE_PROPERTY",cause:n})}class lV{createNewAbortSignal(){if(this.controller){const t=new Error("Cancelling existing WebAuthn API call for new one");t.name="AbortError",this.controller.abort(t)}const e=new AbortController;return this.controller=e,e.signal}cancelCeremony(){if(this.controller){const e=new Error("Manually cancelling existing WebAuthn API call");e.name="AbortError",this.controller.abort(e),this.controller=void 0}}}const cV=new lV;function dV(n){if(!n)throw new Error("Credential creation options are required");if(typeof PublicKeyCredential<"u"&&"parseCreationOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseCreationOptionsFromJSON=="function")return PublicKeyCredential.parseCreationOptionsFromJSON(n);const{challenge:e,user:t,excludeCredentials:r}=n,s=Vf(n,["challenge","user","excludeCredentials"]),a=hf(e).buffer,o=Object.assign(Object.assign({},t),{id:hf(t.id).buffer}),l=Object.assign(Object.assign({},s),{challenge:a,user:o});if(r&&r.length>0){l.excludeCredentials=new Array(r.length);for(let c=0;c<r.length;c++){const d=r[c];l.excludeCredentials[c]=Object.assign(Object.assign({},d),{id:hf(d.id).buffer,type:d.type||"public-key",transports:d.transports})}}return l}function uV(n){if(!n)throw new Error("Credential request options are required");if(typeof PublicKeyCredential<"u"&&"parseRequestOptionsFromJSON"in PublicKeyCredential&&typeof PublicKeyCredential.parseRequestOptionsFromJSON=="function")return PublicKeyCredential.parseRequestOptionsFromJSON(n);const{challenge:e,allowCredentials:t}=n,r=Vf(n,["challenge","allowCredentials"]),s=hf(e).buffer,a=Object.assign(Object.assign({},r),{challenge:s});if(t&&t.length>0){a.allowCredentials=new Array(t.length);for(let o=0;o<t.length;o++){const l=t[o];a.allowCredentials[o]=Object.assign(Object.assign({},l),{id:hf(l.id).buffer,type:l.type||"public-key",transports:l.transports})}}return a}function fV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n;return{id:n.id,rawId:n.id,response:{attestationObject:au(new Uint8Array(n.response.attestationObject)),clientDataJSON:au(new Uint8Array(n.response.clientDataJSON))},type:"public-key",clientExtensionResults:n.getClientExtensionResults(),authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function hV(n){var e;if("toJSON"in n&&typeof n.toJSON=="function")return n.toJSON();const t=n,r=n.getClientExtensionResults(),s=n.response;return{id:n.id,rawId:n.id,response:{authenticatorData:au(new Uint8Array(s.authenticatorData)),clientDataJSON:au(new Uint8Array(s.clientDataJSON)),signature:au(new Uint8Array(s.signature)),userHandle:s.userHandle?au(new Uint8Array(s.userHandle)):void 0},type:"public-key",clientExtensionResults:r,authenticatorAttachment:(e=t.authenticatorAttachment)!==null&&e!==void 0?e:void 0}}function lF(n){return n==="localhost"||/^([a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,}$/i.test(n)}function Jk(){var n,e;return!!(Yr()&&"PublicKeyCredential"in window&&window.PublicKeyCredential&&"credentials"in navigator&&typeof((n=navigator?.credentials)===null||n===void 0?void 0:n.create)=="function"&&typeof((e=navigator?.credentials)===null||e===void 0?void 0:e.get)=="function")}async function mV(n){try{const e=await navigator.credentials.create(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new bx("Browser returned unexpected credential type",e)}:{data:null,error:new bx("Empty credential response",e)}}catch(e){return{data:null,error:aV({error:e,options:n})}}}async function pV(n){try{const e=await navigator.credentials.get(n);return e?e instanceof PublicKeyCredential?{data:e,error:null}:{data:null,error:new bx("Browser returned unexpected credential type",e)}:{data:null,error:new bx("Empty credential response",e)}}catch(e){return{data:null,error:oV({error:e,options:n})}}}const gV={hints:["security-key"],authenticatorSelection:{authenticatorAttachment:"cross-platform",requireResidentKey:!1,userVerification:"preferred",residentKey:"discouraged"},attestation:"direct"},xV={userVerification:"preferred",hints:["security-key"],attestation:"direct"};function wx(...n){const e=s=>s!==null&&typeof s=="object"&&!Array.isArray(s),t=s=>s instanceof ArrayBuffer||ArrayBuffer.isView(s),r={};for(const s of n)if(s)for(const a in s){const o=s[a];if(o!==void 0)if(Array.isArray(o))r[a]=o;else if(t(o))r[a]=o;else if(e(o)){const l=r[a];e(l)?r[a]=wx(l,o):r[a]=wx(o)}else r[a]=o}return r}function yV(n,e){return wx(gV,n,e||{})}function vV(n,e){return wx(xV,n,e||{})}class bV{constructor(e){this.client=e,this.enroll=this._enroll.bind(this),this.challenge=this._challenge.bind(this),this.verify=this._verify.bind(this),this.authenticate=this._authenticate.bind(this),this.register=this._register.bind(this)}async _enroll(e){return this.client.mfa.enroll(Object.assign(Object.assign({},e),{factorType:"webauthn"}))}async _challenge({factorId:e,webauthn:t,friendlyName:r,signal:s},a){try{const{data:o,error:l}=await this.client.mfa.challenge({factorId:e,webauthn:t});if(!o)return{data:null,error:l};const c=s??cV.createNewAbortSignal();if(o.webauthn.type==="create"){const{user:d}=o.webauthn.credential_options.publicKey;d.name||(d.name=`${d.id}:${r}`),d.displayName||(d.displayName=d.name)}switch(o.webauthn.type){case"create":{const d=yV(o.webauthn.credential_options.publicKey,a?.create),{data:h,error:p}=await mV({publicKey:d,signal:c});return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}case"request":{const d=vV(o.webauthn.credential_options.publicKey,a?.request),{data:h,error:p}=await pV(Object.assign(Object.assign({},o.webauthn.credential_options),{publicKey:d,signal:c}));return h?{data:{factorId:e,challengeId:o.id,webauthn:{type:o.webauthn.type,credential_response:h}},error:null}:{data:null,error:p}}}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new iu("Unexpected error in challenge",o)}}}async _verify({challengeId:e,factorId:t,webauthn:r}){return this.client.mfa.verify({factorId:t,challengeId:e,webauthn:r})}async _authenticate({factorId:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new cm("rpId is required for WebAuthn authentication")};try{if(!Jk())return{data:null,error:new iu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this.challenge({factorId:e,webauthn:{rpId:t,rpOrigins:r},signal:s},{request:a});if(!o)return{data:null,error:l};const{webauthn:c}=o;return this._verify({factorId:e,challengeId:o.challengeId,webauthn:{type:c.type,rpId:t,rpOrigins:r,credential_response:c.credential_response}})}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new iu("Unexpected error in authenticate",o)}}}async _register({friendlyName:e,webauthn:{rpId:t=typeof window<"u"?window.location.hostname:void 0,rpOrigins:r=typeof window<"u"?[window.location.origin]:void 0,signal:s}={}},a){if(!t)return{data:null,error:new cm("rpId is required for WebAuthn registration")};try{if(!Jk())return{data:null,error:new iu("Browser does not support WebAuthn",null)};const{data:o,error:l}=await this._enroll({friendlyName:e});if(!o)return await this.client.mfa.listFactors().then(h=>{var p;return(p=h.data)===null||p===void 0?void 0:p.all.find(x=>x.factor_type==="webauthn"&&x.friendly_name===e&&x.status!=="unverified")}).then(h=>h?this.client.mfa.unenroll({factorId:h?.id}):void 0),{data:null,error:l};const{data:c,error:d}=await this._challenge({factorId:o.id,friendlyName:o.friendly_name,webauthn:{rpId:t,rpOrigins:r},signal:s},{create:a});return c?this._verify({factorId:o.id,challengeId:c.challengeId,webauthn:{rpId:t,rpOrigins:r,type:c.webauthn.type,credential_response:c.webauthn.credential_response}}):{data:null,error:d}}catch(o){return wt(o)?{data:null,error:o}:{data:null,error:new iu("Unexpected error in register",o)}}}}nV();const wV={url:xB,storageKey:yB,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:vB,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1,throwOnError:!1};async function Qk(n,e,t){return await t()}const Ku={};class dm{get jwks(){var e,t;return(t=(e=Ku[this.storageKey])===null||e===void 0?void 0:e.jwks)!==null&&t!==void 0?t:{keys:[]}}set jwks(e){Ku[this.storageKey]=Object.assign(Object.assign({},Ku[this.storageKey]),{jwks:e})}get jwks_cached_at(){var e,t;return(t=(e=Ku[this.storageKey])===null||e===void 0?void 0:e.cachedAt)!==null&&t!==void 0?t:Number.MIN_SAFE_INTEGER}set jwks_cached_at(e){Ku[this.storageKey]=Object.assign(Object.assign({},Ku[this.storageKey]),{cachedAt:e})}constructor(e){var t,r,s;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log;const a=Object.assign(Object.assign({},wV),e);if(this.storageKey=a.storageKey,this.instanceID=(t=dm.nextInstanceID[this.storageKey])!==null&&t!==void 0?t:0,dm.nextInstanceID[this.storageKey]=this.instanceID+1,this.logDebugMessages=!!a.debug,typeof a.debug=="function"&&(this.logger=a.debug),this.instanceID>0&&Yr()){const o=`${this._logPrefix()} Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.`;console.warn(o),this.logDebugMessages&&console.trace(o)}if(this.persistSession=a.persistSession,this.autoRefreshToken=a.autoRefreshToken,this.admin=new XB({url:a.url,headers:a.headers,fetch:a.fetch}),this.url=a.url,this.headers=a.headers,this.fetch=iF(a.fetch),this.lock=a.lock||Qk,this.detectSessionInUrl=a.detectSessionInUrl,this.flowType=a.flowType,this.hasCustomAuthorizationHeader=a.hasCustomAuthorizationHeader,this.throwOnError=a.throwOnError,a.lock?this.lock=a.lock:Yr()&&(!((r=globalThis?.navigator)===null||r===void 0)&&r.locks)?this.lock=tV:this.lock=Qk,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this),webauthn:new bV(this)},this.oauth={getAuthorizationDetails:this._getAuthorizationDetails.bind(this),approveAuthorization:this._approveAuthorization.bind(this),denyAuthorization:this._denyAuthorization.bind(this)},this.persistSession?(a.storage?this.storage=a.storage:sF()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=Kk(this.memoryStorage)),a.userStorage&&(this.userStorage=a.userStorage)):(this.memoryStorage={},this.storage=Kk(this.memoryStorage)),Yr()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(o){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",o)}(s=this.broadcastChannel)===null||s===void 0||s.addEventListener("message",async o=>{this._debug("received broadcast notification from other tab or client",o),await this._notifyAllSubscribers(o.data.event,o.data.session,!1)})}this.initialize()}isThrowOnErrorEnabled(){return this.throwOnError}_returnResult(e){if(this.throwOnError&&e&&e.error)throw e.error;return e}_logPrefix(){return`GoTrueClient@${this.storageKey}:${this.instanceID} (${tF}) ${new Date().toISOString()}`}_debug(...e){return this.logDebugMessages&&this.logger(this._logPrefix(),...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{let t={},r="none";if(Yr()&&(t=OB(window.location.href),this._isImplicitGrantCallback(t)?r="implicit":await this._isPKCECallback(t)&&(r="pkce")),Yr()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:a}=await this._getSessionFromURL(t,r);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),SB(a)){const c=(e=a.details)===null||e===void 0?void 0:e.code;if(c==="identity_already_exists"||c==="identity_not_found"||c==="single_identity_not_deletable")return{error:a}}return await this._removeSession(),{error:a}}const{session:o,redirectType:l}=s;return this._debug("#_initialize()","detected session in URL",o,"redirect type",l),await this._saveSession(o),setTimeout(async()=>{l==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",o):await this._notifyAllSubscribers("SIGNED_IN",o)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return wt(t)?this._returnResult({error:t}):this._returnResult({error:new iu("Unexpected error during initialization",t)})}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,r,s;try{const a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(t=e?.options)===null||t===void 0?void 0:t.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:Na}),{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signUp(e){var t,r,s;try{let a;if("email"in e){const{email:h,password:p,options:x}=e;let y=null,_=null;this.flowType==="pkce"&&([y,_]=await Yu(this.storage,this.storageKey)),a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:x?.emailRedirectTo,body:{email:h,password:p,data:(t=x?.data)!==null&&t!==void 0?t:{},gotrue_meta_security:{captcha_token:x?.captchaToken},code_challenge:y,code_challenge_method:_},xform:Na})}else if("phone"in e){const{phone:h,password:p,options:x}=e;a=await At(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:h,password:p,data:(r=x?.data)!==null&&r!==void 0?r:{},channel:(s=x?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:x?.captchaToken}},xform:Na})}else throw new qp("You must provide either an email or phone number and a password");const{data:o,error:l}=a;if(l||!o)return this._returnResult({data:{user:null,session:null},error:l});const c=o.session,d=o.user;return o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null},error:a});throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:a,password:o,options:l}=e;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Gk})}else if("phone"in e){const{phone:a,password:o,options:l}=e;t=await At(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:a,password:o,gotrue_meta_security:{captcha_token:l?.captchaToken}},xform:Gk})}else throw new qp("You must provide either an email or phone number and a password");const{data:r,error:s}=t;if(s)return this._returnResult({data:{user:null,session:null},error:s});if(!r||!r.session||!r.user){const a=new Hu;return this._returnResult({data:{user:null,session:null},error:a})}return r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),this._returnResult({data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOAuth(e){var t,r,s,a;return await this._handleProviderSignIn(e.provider,{redirectTo:(t=e.options)===null||t===void 0?void 0:t.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(a=e.options)===null||a===void 0?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async signInWithWeb3(e){const{chain:t}=e;switch(t){case"ethereum":return await this.signInWithEthereum(e);case"solana":return await this.signInWithSolana(e);default:throw new Error(`@supabase/auth-js: Unsupported chain "${t}"`)}}async signInWithEthereum(e){var t,r,s,a,o,l,c,d,h,p,x;let y,_;if("message"in e)y=e.message,_=e.signature;else{const{chain:w,wallet:j,statement:C,options:P}=e;let O;if(Yr())if(typeof j=="object")O=j;else{const B=window;if("ethereum"in B&&typeof B.ethereum=="object"&&"request"in B.ethereum&&typeof B.ethereum.request=="function")O=B.ethereum;else throw new Error("@supabase/auth-js: No compatible Ethereum wallet interface on the window object (window.ethereum) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'ethereum', wallet: resolvedUserWallet }) instead.")}else{if(typeof j!="object"||!P?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");O=j}const M=new URL((t=P?.url)!==null&&t!==void 0?t:window.location.href),D=await O.request({method:"eth_requestAccounts"}).then(B=>B).catch(()=>{throw new Error("@supabase/auth-js: Wallet method eth_requestAccounts is missing or invalid")});if(!D||D.length===0)throw new Error("@supabase/auth-js: No accounts available. Please ensure the wallet is connected.");const I=oF(D[0]);let F=(r=P?.signInWithEthereum)===null||r===void 0?void 0:r.chainId;if(!F){const B=await O.request({method:"eth_chainId"});F=rV(B)}const q={domain:M.host,address:I,statement:C,uri:M.href,version:"1",chainId:F,nonce:(s=P?.signInWithEthereum)===null||s===void 0?void 0:s.nonce,issuedAt:(o=(a=P?.signInWithEthereum)===null||a===void 0?void 0:a.issuedAt)!==null&&o!==void 0?o:new Date,expirationTime:(l=P?.signInWithEthereum)===null||l===void 0?void 0:l.expirationTime,notBefore:(c=P?.signInWithEthereum)===null||c===void 0?void 0:c.notBefore,requestId:(d=P?.signInWithEthereum)===null||d===void 0?void 0:d.requestId,resources:(h=P?.signInWithEthereum)===null||h===void 0?void 0:h.resources};y=iV(q),_=await O.request({method:"personal_sign",params:[sV(y),I]})}try{const{data:w,error:j}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"ethereum",message:y,signature:_},!((p=e.options)===null||p===void 0)&&p.captchaToken?{gotrue_meta_security:{captcha_token:(x=e.options)===null||x===void 0?void 0:x.captchaToken}}:null),xform:Na});if(j)throw j;if(!w||!w.session||!w.user){const C=new Hu;return this._returnResult({data:{user:null,session:null},error:C})}return w.session&&(await this._saveSession(w.session),await this._notifyAllSubscribers("SIGNED_IN",w.session)),this._returnResult({data:Object.assign({},w),error:j})}catch(w){if(wt(w))return this._returnResult({data:{user:null,session:null},error:w});throw w}}async signInWithSolana(e){var t,r,s,a,o,l,c,d,h,p,x,y;let _,w;if("message"in e)_=e.message,w=e.signature;else{const{chain:j,wallet:C,statement:P,options:O}=e;let M;if(Yr())if(typeof C=="object")M=C;else{const I=window;if("solana"in I&&typeof I.solana=="object"&&("signIn"in I.solana&&typeof I.solana.signIn=="function"||"signMessage"in I.solana&&typeof I.solana.signMessage=="function"))M=I.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof C!="object"||!O?.url)throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");M=C}const D=new URL((t=O?.url)!==null&&t!==void 0?t:window.location.href);if("signIn"in M&&M.signIn){const I=await M.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},O?.signInWithSolana),{version:"1",domain:D.host,uri:D.href}),P?{statement:P}:null));let F;if(Array.isArray(I)&&I[0]&&typeof I[0]=="object")F=I[0];else if(I&&typeof I=="object"&&"signedMessage"in I&&"signature"in I)F=I;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in F&&"signature"in F&&(typeof F.signedMessage=="string"||F.signedMessage instanceof Uint8Array)&&F.signature instanceof Uint8Array)_=typeof F.signedMessage=="string"?F.signedMessage:new TextDecoder().decode(F.signedMessage),w=F.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in M)||typeof M.signMessage!="function"||!("publicKey"in M)||typeof M!="object"||!M.publicKey||!("toBase58"in M.publicKey)||typeof M.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${D.host} wants you to sign in with your Solana account:`,M.publicKey.toBase58(),...P?["",P,""]:[""],"Version: 1",`URI: ${D.href}`,`Issued At: ${(s=(r=O?.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&s!==void 0?s:new Date().toISOString()}`,...!((a=O?.signInWithSolana)===null||a===void 0)&&a.notBefore?[`Not Before: ${O.signInWithSolana.notBefore}`]:[],...!((o=O?.signInWithSolana)===null||o===void 0)&&o.expirationTime?[`Expiration Time: ${O.signInWithSolana.expirationTime}`]:[],...!((l=O?.signInWithSolana)===null||l===void 0)&&l.chainId?[`Chain ID: ${O.signInWithSolana.chainId}`]:[],...!((c=O?.signInWithSolana)===null||c===void 0)&&c.nonce?[`Nonce: ${O.signInWithSolana.nonce}`]:[],...!((d=O?.signInWithSolana)===null||d===void 0)&&d.requestId?[`Request ID: ${O.signInWithSolana.requestId}`]:[],...!((p=(h=O?.signInWithSolana)===null||h===void 0?void 0:h.resources)===null||p===void 0)&&p.length?["Resources",...O.signInWithSolana.resources.map(F=>`- ${F}`)]:[]].join(`
`);const I=await M.signMessage(new TextEncoder().encode(_),"utf8");if(!I||!(I instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=I}}try{const{data:j,error:C}=await At(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:au(w)},!((x=e.options)===null||x===void 0)&&x.captchaToken?{gotrue_meta_security:{captcha_token:(y=e.options)===null||y===void 0?void 0:y.captchaToken}}:null),xform:Na});if(C)throw C;if(!j||!j.session||!j.user){const P=new Hu;return this._returnResult({data:{user:null,session:null},error:P})}return j.session&&(await this._saveSession(j.session),await this._notifyAllSubscribers("SIGNED_IN",j.session)),this._returnResult({data:Object.assign({},j),error:C})}catch(j){if(wt(j))return this._returnResult({data:{user:null,session:null},error:j});throw j}}async _exchangeCodeForSession(e){const t=await Wd(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(t??"").split("/");try{const{data:a,error:o}=await At(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:Na});if(await jc(this.storage,`${this.storageKey}-code-verifier`),o)throw o;if(!a||!a.session||!a.user){const l=new Hu;return this._returnResult({data:{user:null,session:null,redirectType:null},error:l})}return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",a.session)),this._returnResult({data:Object.assign(Object.assign({},a),{redirectType:s??null}),error:o})}catch(a){if(wt(a))return this._returnResult({data:{user:null,session:null,redirectType:null},error:a});throw a}}async signInWithIdToken(e){try{const{options:t,provider:r,token:s,access_token:a,nonce:o}=e,l=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:a,nonce:o,gotrue_meta_security:{captcha_token:t?.captchaToken}},xform:Na}),{data:c,error:d}=l;if(d)return this._returnResult({data:{user:null,session:null},error:d});if(!c||!c.session||!c.user){const h=new Hu;return this._returnResult({data:{user:null,session:null},error:h})}return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",c.session)),this._returnResult({data:c,error:d})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async signInWithOtp(e){var t,r,s,a,o;try{if("email"in e){const{email:l,options:c}=e;let d=null,h=null;this.flowType==="pkce"&&([d,h]=await Yu(this.storage,this.storageKey));const{error:p}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:l,data:(t=c?.data)!==null&&t!==void 0?t:{},create_user:(r=c?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},code_challenge:d,code_challenge_method:h},redirectTo:c?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:p})}if("phone"in e){const{phone:l,options:c}=e,{data:d,error:h}=await At(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:l,data:(s=c?.data)!==null&&s!==void 0?s:{},create_user:(a=c?.shouldCreateUser)!==null&&a!==void 0?a:!0,gotrue_meta_security:{captcha_token:c?.captchaToken},channel:(o=c?.channel)!==null&&o!==void 0?o:"sms"}});return this._returnResult({data:{user:null,session:null,messageId:d?.message_id},error:h})}throw new qp("You must provide either an email or phone number.")}catch(l){if(wt(l))return this._returnResult({data:{user:null,session:null},error:l});throw l}}async verifyOtp(e){var t,r;try{let s,a;"options"in e&&(s=(t=e.options)===null||t===void 0?void 0:t.redirectTo,a=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:o,error:l}=await At(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:s,xform:Na});if(l)throw l;if(!o)throw new Error("An error occurred on token verification.");const c=o.session,d=o.user;return c?.access_token&&(await this._saveSession(c),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",c)),this._returnResult({data:{user:d,session:c},error:null})}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}}async signInWithSSO(e){var t,r,s,a,o;try{let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Yu(this.storage,this.storageKey));const d=await At(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(t=e.options)===null||t===void 0?void 0:t.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:KB});return!((a=d.data)===null||a===void 0)&&a.url&&Yr()&&!(!((o=e.options)===null||o===void 0)&&o.skipBrowserRedirect)&&window.location.assign(d.data.url),this._returnResult(d)}catch(l){if(wt(l))return this._returnResult({data:null,error:l});throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:t},error:r}=e;if(r)throw r;if(!t)throw new ja;const{error:s}=await At(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return this._returnResult({data:{user:null,session:null},error:s})})}catch(e){if(wt(e))return this._returnResult({data:{user:null,session:null},error:e});throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:a}=e,{error:o}=await At(this.fetch,"POST",t,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}},redirectTo:a?.emailRedirectTo});return this._returnResult({data:{user:null,session:null},error:o})}else if("phone"in e){const{phone:r,type:s,options:a}=e,{data:o,error:l}=await At(this.fetch,"POST",t,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:a?.captchaToken}}});return this._returnResult({data:{user:null,session:null,messageId:o?.message_id},error:l})}throw new qp("You must provide either an email or phone number and a type")}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async t=>t))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=t();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const t=await Wd(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),t!==null&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at*1e3-Date.now()<ib:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.userStorage){const o=await Wd(this.userStorage,this.storageKey+"-user");o?.user?e.user=o.user:e.user=lb()}if(this.storage.isServer&&e.user&&!e.user.__isUserNotAvailableProxy){const o={value:this.suppressGetSessionWarning};e.user=HB(e.user,o),o.value&&(this.suppressGetSessionWarning=!0)}return{data:{session:e},error:null}}const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{session:null},error:a}):this._returnResult({data:{session:s},error:null})}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:Ic}):await this._useSession(async t=>{var r,s,a;const{data:o,error:l}=t;if(l)throw l;return!(!((r=o.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ja}:await At(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(a=(s=o.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:void 0,xform:Ic})})}catch(t){if(wt(t))return NB(t)&&(await this._removeSession(),await jc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({data:{user:null},error:t});throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,t))}async _updateUser(e,t={}){try{return await this._useSession(async r=>{const{data:s,error:a}=r;if(a)throw a;if(!s.session)throw new ja;const o=s.session;let l=null,c=null;this.flowType==="pkce"&&e.email!=null&&([l,c]=await Yu(this.storage,this.storageKey));const{data:d,error:h}=await At(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:t?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:l,code_challenge_method:c}),jwt:o.access_token,xform:Ic});if(h)throw h;return o.user=d.user,await this._saveSession(o),await this._notifyAllSubscribers("USER_UPDATED",o),this._returnResult({data:{user:o.user},error:null})})}catch(r){if(wt(r))return this._returnResult({data:{user:null},error:r});throw r}}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ja;const t=Date.now()/1e3;let r=t,s=!0,a=null;const{payload:o}=ob(e.access_token);if(o.exp&&(r=o.exp,s=r<=t),s){const{data:l,error:c}=await this._callRefreshToken(e.refresh_token);if(c)return this._returnResult({data:{user:null,session:null},error:c});if(!l)return{data:{user:null,session:null},error:null};a=l}else{const{data:l,error:c}=await this._getUser(e.access_token);if(c)throw c;a={access_token:e.access_token,refresh_token:e.refresh_token,user:l.user,token_type:"bearer",expires_in:r-t,expires_at:r},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return this._returnResult({data:{user:a.user,session:a},error:null})}catch(t){if(wt(t))return this._returnResult({data:{session:null,user:null},error:t});throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async t=>{var r;if(!e){const{data:o,error:l}=t;if(l)throw l;e=(r=o.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ja;const{data:s,error:a}=await this._callRefreshToken(e.refresh_token);return a?this._returnResult({data:{user:null,session:null},error:a}):s?this._returnResult({data:{user:s.user,session:s},error:null}):this._returnResult({data:{user:null,session:null},error:null})})}catch(t){if(wt(t))return this._returnResult({data:{user:null,session:null},error:t});throw t}}async _getSessionFromURL(e,t){try{if(!Yr())throw new zp("No browser detected.");if(e.error||e.error_description||e.error_code)throw new zp(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if(this.flowType==="pkce")throw new Uk("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new zp("Not a valid implicit grant flow url.");break;default:}if(t==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Uk("No code detected.");const{data:P,error:O}=await this._exchangeCodeForSession(e.code);if(O)throw O;const M=new URL(window.location.href);return M.searchParams.delete("code"),window.history.replaceState(window.history.state,"",M.toString()),{data:{session:P.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:a,refresh_token:o,expires_in:l,expires_at:c,token_type:d}=e;if(!a||!l||!o||!d)throw new zp("No session defined in URL");const h=Math.round(Date.now()/1e3),p=parseInt(l);let x=h+p;c&&(x=parseInt(c));const y=x-h;y*1e3<=sf&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${y}s, should have been closer to ${p}s`);const _=x-p;h-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,x,h):h-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,x,h);const{data:w,error:j}=await this._getUser(a);if(j)throw j;const C={provider_token:r,provider_refresh_token:s,access_token:a,expires_in:p,expires_at:x,refresh_token:o,token_type:d,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),this._returnResult({data:{session:C,redirectType:e.type},error:null})}catch(r){if(wt(r))return this._returnResult({data:{session:null,redirectType:null},error:r});throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Wd(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({error:a});const o=(r=s.session)===null||r===void 0?void 0:r.access_token;if(o){const{error:l}=await this.admin.signOut(o,e);if(l&&!(jB(l)&&(l.status===404||l.status===401||l.status===403)))return this._returnResult({error:l})}return e!=="others"&&(await this._removeSession(),await jc(this.storage,`${this.storageKey}-code-verifier`)),this._returnResult({error:null})})}onAuthStateChange(e){const t=DB(),r={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(t)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async t=>{var r,s;try{const{data:{session:a},error:o}=t;if(o)throw o;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",a)),this._debug("INITIAL_SESSION","callback id",e,"session",a)}catch(a){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a),console.error(a)}})}async resetPasswordForEmail(e,t={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Yu(this.storage,this.storageKey,!0));try{return await At(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(wt(a))return this._returnResult({data:null,error:a});throw a}}async getUserIdentities(){var e;try{const{data:t,error:r}=await this.getUser();if(r)throw r;return this._returnResult({data:{identities:(e=t.user.identities)!==null&&e!==void 0?e:[]},error:null})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async linkIdentity(e){return"token"in e?this.linkIdentityIdToken(e):this.linkIdentityOAuth(e)}async linkIdentityOAuth(e){var t;try{const{data:r,error:s}=await this._useSession(async a=>{var o,l,c,d,h;const{data:p,error:x}=a;if(x)throw x;const y=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(o=e.options)===null||o===void 0?void 0:o.redirectTo,scopes:(l=e.options)===null||l===void 0?void 0:l.scopes,queryParams:(c=e.options)===null||c===void 0?void 0:c.queryParams,skipBrowserRedirect:!0});return await At(this.fetch,"GET",y,{headers:this.headers,jwt:(h=(d=p.session)===null||d===void 0?void 0:d.access_token)!==null&&h!==void 0?h:void 0})});if(s)throw s;return Yr()&&!(!((t=e.options)===null||t===void 0)&&t.skipBrowserRedirect)&&window.location.assign(r?.url),this._returnResult({data:{provider:e.provider,url:r?.url},error:null})}catch(r){if(wt(r))return this._returnResult({data:{provider:e.provider,url:null},error:r});throw r}}async linkIdentityIdToken(e){return await this._useSession(async t=>{var r;try{const{error:s,data:{session:a}}=t;if(s)throw s;const{options:o,provider:l,token:c,access_token:d,nonce:h}=e,p=await At(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,jwt:(r=a?.access_token)!==null&&r!==void 0?r:void 0,body:{provider:l,id_token:c,access_token:d,nonce:h,link_identity:!0,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Na}),{data:x,error:y}=p;return y?this._returnResult({data:{user:null,session:null},error:y}):!x||!x.session||!x.user?this._returnResult({data:{user:null,session:null},error:new Hu}):(x.session&&(await this._saveSession(x.session),await this._notifyAllSubscribers("USER_UPDATED",x.session)),this._returnResult({data:x,error:y}))}catch(s){if(wt(s))return this._returnResult({data:{user:null,session:null},error:s});throw s}})}async unlinkIdentity(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)throw o;return await At(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=a.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const r=Date.now();return await RB(async s=>(s>0&&await AB(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await At(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:Na})),(s,a)=>{const o=200*Math.pow(2,s);return a&&ab(a)&&Date.now()+o-r<sf})}catch(r){if(this._debug(t,"error",r),wt(r))return this._returnResult({data:{session:null,user:null},error:r});throw r}finally{this._debug(t,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",r),Yr()&&!t.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e,t;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const s=await Wd(this.storage,this.storageKey);if(s&&this.userStorage){let o=await Wd(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!o&&(o={user:s.user},await af(this.userStorage,this.storageKey+"-user",o)),s.user=(e=o?.user)!==null&&e!==void 0?e:lb()}else if(s&&!s.user&&!s.user){const o=await Wd(this.storage,this.storageKey+"-user");o&&o?.user?(s.user=o.user,await jc(this.storage,this.storageKey+"-user"),await af(this.storage,this.storageKey,s)):s.user=lb()}if(this._debug(r,"session from storage",s),!this._isValidSession(s)){this._debug(r,"session is not valid"),s!==null&&await this._removeSession();return}const a=((t=s.expires_at)!==null&&t!==void 0?t:1/0)*1e3-Date.now()<ib;if(this._debug(r,`session has${a?"":" not"} expired with margin of ${ib}s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:o}=await this._callRefreshToken(s.refresh_token);o&&(console.error(o),ab(o)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",o),await this._removeSession()))}}else if(s.user&&s.user.__isUserNotAvailableProxy===!0)try{const{data:o,error:l}=await this._getUser(s.access_token);!l&&o?.user?(s.user=o.user,await this._saveSession(s),await this._notifyAllSubscribers("SIGNED_IN",s)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(o){console.error("Error getting user data:",o),this._debug(r,"error getting user data, skipping SIGNED_IN notification",o)}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){this._debug(r,"error",s),console.error(s);return}finally{this._debug(r,"end")}}async _callRefreshToken(e){var t,r;if(!e)throw new ja;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new ey;const{data:a,error:o}=await this._refreshAccessToken(e);if(o)throw o;if(!a.session)throw new ja;await this._saveSession(a.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",a.session);const l={data:a.session,error:null};return this.refreshingDeferred.resolve(l),l}catch(a){if(this._debug(s,"error",a),wt(a)){const o={data:null,error:a};return ab(a)||await this._removeSession(),(t=this.refreshingDeferred)===null||t===void 0||t.resolve(o),o}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(a),a}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,t,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",t,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:t});const a=[],o=Array.from(this.stateChangeEmitters.values()).map(async l=>{try{await l.callback(e,t)}catch(c){a.push(c)}});if(await Promise.all(o),a.length>0){for(let l=0;l<a.length;l+=1)console.error(a[l]);throw a[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0;const t=Object.assign({},e),r=t.user&&t.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&t.user&&await af(this.userStorage,this.storageKey+"-user",{user:t.user});const s=Object.assign({},t);delete s.user;const a=Hk(s);await af(this.storage,this.storageKey,a)}else{const s=Hk(t);await af(this.storage,this.storageKey,s)}}async _removeSession(){this._debug("#_removeSession()"),await jc(this.storage,this.storageKey),await jc(this.storage,this.storageKey+"-code-verifier"),await jc(this.storage,this.storageKey+"-user"),this.userStorage&&await jc(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Yr()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(t){console.error("removing visibilitychange callback failed",t)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),sf);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async t=>{const{data:{session:r}}=t;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/sf);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${sf}ms, refresh threshold is ${tS} ticks`),s<=tS&&await this._callRefreshToken(r.refresh_token)})}catch(t){console.error("Auto refresh tick failed with error. This is likely a transient error.",t)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof aF)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Yr()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,r){const s=[`provider=${encodeURIComponent(t)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[a,o]=await Yu(this.storage,this.storageKey),l=new URLSearchParams({code_challenge:`${encodeURIComponent(a)}`,code_challenge_method:`${encodeURIComponent(o)}`});s.push(l.toString())}if(r?.queryParams){const a=new URLSearchParams(r.queryParams);s.push(a.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;return a?this._returnResult({data:null,error:a}):await At(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _enroll(e){try{return await this._useSession(async t=>{var r,s;const{data:a,error:o}=t;if(o)return this._returnResult({data:null,error:o});const l=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:e.factorType==="totp"?{issuer:e.issuer}:{}),{data:c,error:d}=await At(this.fetch,"POST",`${this.url}/factors`,{body:l,headers:this.headers,jwt:(r=a?.session)===null||r===void 0?void 0:r.access_token});return d?this._returnResult({data:null,error:d}):(e.factorType==="totp"&&c.type==="totp"&&(!((s=c?.totp)===null||s===void 0)&&s.qr_code)&&(c.totp.qr_code=`data:image/svg+xml;utf-8,${c.totp.qr_code}`),this._returnResult({data:c,error:null}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=Object.assign({challenge_id:e.challengeId},"webauthn"in e?{webauthn:Object.assign(Object.assign({},e.webauthn),{credential_response:e.webauthn.type==="create"?fV(e.webauthn.credential_response):hV(e.webauthn.credential_response)})}:{code:e.code}),{data:l,error:c}=await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:o,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return c?this._returnResult({data:null,error:c}):(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+l.expires_in},l)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",l),this._returnResult({data:l,error:c}))})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async t=>{var r;const{data:s,error:a}=t;if(a)return this._returnResult({data:null,error:a});const o=await At(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:e,headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});if(o.error)return o;const{data:l}=o;if(l.type!=="webauthn")return{data:l,error:null};switch(l.webauthn.type){case"create":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:dV(l.webauthn.credential_options.publicKey)})})}),error:null};case"request":return{data:Object.assign(Object.assign({},l),{webauthn:Object.assign(Object.assign({},l.webauthn),{credential_options:Object.assign(Object.assign({},l.webauthn.credential_options),{publicKey:uV(l.webauthn.credential_options.publicKey)})})}),error:null}}})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}})}async _challengeAndVerify(e){const{data:t,error:r}=await this._challenge({factorId:e.factorId});return r?this._returnResult({data:null,error:r}):await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){var e;const{data:{user:t},error:r}=await this.getUser();if(r)return{data:null,error:r};const s={all:[],phone:[],totp:[],webauthn:[]};for(const a of(e=t?.factors)!==null&&e!==void 0?e:[])s.all.push(a),a.status==="verified"&&s[a.factor_type].push(a);return{data:s,error:null}}async _getAuthenticatorAssuranceLevel(){var e,t;const{data:{session:r},error:s}=await this.getSession();if(s)return this._returnResult({data:null,error:s});if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:a}=ob(r.access_token);let o=null;a.aal&&(o=a.aal);let l=o;((t=(e=r.user.factors)===null||e===void 0?void 0:e.filter(h=>h.status==="verified"))!==null&&t!==void 0?t:[]).length>0&&(l="aal2");const d=a.amr||[];return{data:{currentLevel:o,nextLevel:l,currentAuthenticationMethods:d},error:null}}async _getAuthorizationDetails(e){try{return await this._useSession(async t=>{const{data:{session:r},error:s}=t;return s?this._returnResult({data:null,error:s}):r?await At(this.fetch,"GET",`${this.url}/oauth/authorizations/${e}`,{headers:this.headers,jwt:r.access_token,xform:a=>({data:a,error:null})}):this._returnResult({data:null,error:new ja})})}catch(t){if(wt(t))return this._returnResult({data:null,error:t});throw t}}async _approveAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ja});const o=await At(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"approve"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Yr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async _denyAuthorization(e,t){try{return await this._useSession(async r=>{const{data:{session:s},error:a}=r;if(a)return this._returnResult({data:null,error:a});if(!s)return this._returnResult({data:null,error:new ja});const o=await At(this.fetch,"POST",`${this.url}/oauth/authorizations/${e}/consent`,{headers:this.headers,jwt:s.access_token,body:{action:"deny"},xform:l=>({data:l,error:null})});return o.data&&o.data.redirect_url&&Yr()&&!t?.skipBrowserRedirect&&window.location.assign(o.data.redirect_url),o})}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}async fetchJwk(e,t={keys:[]}){let r=t.keys.find(l=>l.kid===e);if(r)return r;const s=Date.now();if(r=this.jwks.keys.find(l=>l.kid===e),r&&this.jwks_cached_at+wB>s)return r;const{data:a,error:o}=await At(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(o)throw o;return!a.keys||a.keys.length===0||(this.jwks=a,this.jwks_cached_at=s,r=a.keys.find(l=>l.kid===e),!r)?null:r}async getClaims(e,t={}){try{let r=e;if(!r){const{data:y,error:_}=await this.getSession();if(_||!y.session)return this._returnResult({data:null,error:_});r=y.session.access_token}const{header:s,payload:a,signature:o,raw:{header:l,payload:c}}=ob(r);t?.allowExpired||VB(a.exp);const d=!s.alg||s.alg.startsWith("HS")||!s.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(s.kid,t?.keys?{keys:t.keys}:t?.jwks);if(!d){const{error:y}=await this.getUser(r);if(y)throw y;return{data:{claims:a,header:s,signature:o},error:null}}const h=WB(s.alg),p=await crypto.subtle.importKey("jwk",d,h,!0,["verify"]);if(!await crypto.subtle.verify(h,p,o,MB(`${l}.${c}`)))throw new sS("Invalid JWT signature");return{data:{claims:a,header:s,signature:o},error:null}}catch(r){if(wt(r))return this._returnResult({data:null,error:r});throw r}}}dm.nextInstanceID={};const _V=dm;class jV extends _V{constructor(e){super(e)}}class NV{constructor(e,t,r){var s,a,o;this.supabaseUrl=e,this.supabaseKey=t;const l=gB(e);if(!t)throw new Error("supabaseKey is required.");this.realtimeUrl=new URL("realtime/v1",l),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",l),this.storageUrl=new URL("storage/v1",l),this.functionsUrl=new URL("functions/v1",l);const c=`sb-${l.hostname.split(".")[0]}-auth-token`,d={db:lB,realtime:dB,auth:Object.assign(Object.assign({},cB),{storageKey:c}),global:oB},h=pB(r??{},d);this.storageKey=(s=h.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(a=h.global.headers)!==null&&a!==void 0?a:{},h.accessToken?(this.accessToken=h.accessToken,this.auth=new Proxy({},{get:(p,x)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(x)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((o=h.auth)!==null&&o!==void 0?o:{},this.headers,h.global.fetch),this.fetch=hB(t,this._getAccessToken.bind(this),h.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},h.realtime)),this.accessToken&&this.accessToken().then(p=>this.realtime.setAuth(p)).catch(p=>console.warn("Failed to set initial Realtime auth token:",p)),this.rest=new xU(new URL("rest/v1",l).href,{headers:this.headers,schema:h.db.schema,fetch:this.fetch}),this.storage=new sB(this.storageUrl.href,this.headers,this.fetch,r?.storage),h.accessToken||this._listenForAuthEvents()}get functions(){return new hU(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},r={head:!1,get:!1,count:void 0}){return this.rest.rpc(e,t,r)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}async _getAccessToken(){var e,t;if(this.accessToken)return await this.accessToken();const{data:r}=await this.auth.getSession();return(t=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&t!==void 0?t:this.supabaseKey}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,storageKey:o,flowType:l,lock:c,debug:d,throwOnError:h},p,x){const y={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new jV({url:this.authUrl.href,headers:Object.assign(Object.assign({},y),p),storageKey:o,autoRefreshToken:e,persistSession:t,detectSessionInUrl:r,storage:s,userStorage:a,flowType:l,lock:c,debug:d,throwOnError:h,fetch:x,hasCustomAuthorizationHeader:Object.keys(this.headers).some(_=>_.toLowerCase()==="authorization")})}_initRealtimeClient(e){return new IU(this.realtimeUrl.href,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((t,r)=>{this._handleTokenChanged(t,"CLIENT",r?.access_token)})}_handleTokenChanged(e,t,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?(this.changedAccessToken=r,this.realtime.setAuth(r)):e==="SIGNED_OUT"&&(this.realtime.setAuth(),t=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const SV=(n,e,t)=>new NV(n,e,t);function CV(){if(typeof window<"u"||typeof process>"u")return!1;const n=process.version;if(n==null)return!1;const e=n.match(/^v(\d+)\./);return e?parseInt(e[1],10)<=18:!1}CV()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const cF="https://nuvbqinadhtrontvyuuh.supabase.co",dF="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im51dmJxaW5hZGh0cm9udHZ5dXVoIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjU0NzAyODIsImV4cCI6MjA4MTA0NjI4Mn0.vH-QCahvp-Btc3118cz8S0K_zH8yncMpnHcZPW7a8hk",TV=cF,kV=dF,Me=SV(TV,kV,{auth:{persistSession:!0,storage:window.localStorage,autoRefreshToken:!0,detectSessionInUrl:!0},global:{multiTab:!1}}),PV=Object.freeze(Object.defineProperty({__proto__:null,supabase:Me,supabaseAnonKey:dF,supabaseUrl:cF},Symbol.toStringTag,{value:"Module"})),MV=async n=>{try{let{data:e,error:t}=await Me.from("users").select("*, role_id").eq("id",n.id).single();if(t&&t.code==="PGRST116"){const r={id:n.id,name:n.user_metadata.name||"New User",email:n.email,role_id:"unverified"},{data:s,error:a}=await Me.from("users").insert(r).select("*, role_id").single();if(a)return console.error("Error creating user profile on-the-fly:",a.message,a),null;e=s,t=null}return t?(console.error("Error fetching app profile:",t.message,t),null):{id:e.id,name:e.name,email:n.email||"",phone:e.phone,role:e.role_id,organizationId:e.organization_id,organizationName:e.organization_name,reportingManagerId:e.reporting_manager_id,photoUrl:e.photo_url}}catch(e){return console.error("Exception fetching profile:",e),null}},EV=async(n,e)=>await Me.auth.signInWithPassword({email:n,password:e}),DV=async n=>{const{email:e,password:t,options:r}=n;return await Me.auth.signUp({email:e,password:t,options:{...r,emailRedirectTo:`${window.location.origin}/`}})},OV=async(n,e)=>await Me.from("users").update({role_id:e}).eq("id",n),IV=async()=>await Me.auth.signInWithOAuth({provider:"google",options:{redirectTo:window.location.origin}}),AV=async()=>{const{error:n}=await Me.auth.signOut();n&&console.error("Error signing out:",n.message)},RV=async n=>{const e=window.location.origin;return await Me.auth.resetPasswordForEmail(n,{redirectTo:e})},LV=async n=>await Me.auth.updateUser({password:n}),Ca={getAppUserProfile:MV,signInWithPassword:EV,signUpWithPassword:DV,signInWithGoogle:IV,signOut:AV,resetPasswordForEmail:RV,updateUserPassword:LV,approveUser:OV},FV="modulepreload",qV=function(n,e){return new URL(n,e).href},Xk={},Nf=function(e,t,r){let s=Promise.resolve();if(t&&t.length>0){let d=function(h){return Promise.all(h.map(p=>Promise.resolve(p).then(x=>({status:"fulfilled",value:x}),x=>({status:"rejected",reason:x}))))};const o=document.getElementsByTagName("link"),l=document.querySelector("meta[property=csp-nonce]"),c=l?.nonce||l?.getAttribute("nonce");s=d(t.map(h=>{if(h=qV(h,r),h in Xk)return;Xk[h]=!0;const p=h.endsWith(".css"),x=p?'[rel="stylesheet"]':"";if(r)for(let _=o.length-1;_>=0;_--){const w=o[_];if(w.href===h&&(!p||w.rel==="stylesheet"))return}else if(document.querySelector(`link[href="${h}"]${x}`))return;const y=document.createElement("link");if(y.rel=p?"stylesheet":FV,p||(y.as="script"),y.crossOrigin="",y.href=h,c&&y.setAttribute("nonce",c),document.head.appendChild(y),p)return new Promise((_,w)=>{y.addEventListener("load",_),y.addEventListener("error",()=>w(new Error(`Unable to preload CSS for ${h}`)))})}))}function a(o){const l=new Event("vite:preloadError",{cancelable:!0});if(l.payload=o,window.dispatchEvent(l),!l.defaultPrevented)throw o}return s.then(o=>{for(const l of o||[])l.status==="rejected"&&a(l.reason);return e().catch(a)})};function qt(n){const e=Object.prototype.toString.call(n);return n instanceof Date||typeof n=="object"&&e==="[object Date]"?new n.constructor(+n):typeof n=="number"||e==="[object Number]"||typeof n=="string"||e==="[object String]"?new Date(n):new Date(NaN)}function Vn(n,e){return n instanceof Date?new n.constructor(e):new Date(e)}function yl(n,e){const t=qt(n);return isNaN(e)?Vn(n,NaN):(e&&t.setDate(t.getDate()+e),t)}function ty(n,e){const t=qt(n);if(isNaN(e))return Vn(n,NaN);if(!e)return t;const r=t.getDate(),s=Vn(n,t.getTime());s.setMonth(t.getMonth()+e+1,0);const a=s.getDate();return r>=a?s:(t.setFullYear(s.getFullYear(),s.getMonth(),r),t)}const uF=6048e5,zV=864e5,fF=6e4,UV=36e5,BV=1e3,Up=43200,eP=1440;let VV={};function Kc(){return VV}function Co(n,e){const t=Kc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=qt(n),a=s.getDay(),o=(a<r?7:0)+a-r;return s.setDate(s.getDate()-o),s.setHours(0,0,0,0),s}function Sf(n){return Co(n,{weekStartsOn:1})}function hF(n){const e=qt(n),t=e.getFullYear(),r=Vn(n,0);r.setFullYear(t+1,0,4),r.setHours(0,0,0,0);const s=Sf(r),a=Vn(n,0);a.setFullYear(t,0,4),a.setHours(0,0,0,0);const o=Sf(a);return e.getTime()>=s.getTime()?t+1:e.getTime()>=o.getTime()?t:t-1}function Vc(n){const e=qt(n);return e.setHours(0,0,0,0),e}function Cf(n){const e=qt(n),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+n-+t}function Em(n,e){const t=Vc(n),r=Vc(e),s=+t-Cf(t),a=+r-Cf(r);return Math.round((s-a)/zV)}function WV(n){const e=hF(n),t=Vn(n,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),Sf(t)}function sx(n,e){const t=qt(n),r=qt(e),s=t.getTime()-r.getTime();return s<0?-1:s>0?1:s}function $V(n){return Vn(n,Date.now())}function mf(n,e){const t=Vc(n),r=Vc(e);return+t==+r}function HV(n){return n instanceof Date||typeof n=="object"&&Object.prototype.toString.call(n)==="[object Date]"}function YV(n){if(!HV(n)&&typeof n!="number")return!1;const e=qt(n);return!isNaN(Number(e))}function GV(n,e){const t=qt(n),r=qt(e),s=t.getFullYear()-r.getFullYear(),a=t.getMonth()-r.getMonth();return s*12+a}function ZV(n,e){const t=qt(n),r=qt(e),s=tP(t,r),a=Math.abs(Em(t,r));t.setDate(t.getDate()-s*a);const o=+(tP(t,r)===-s),l=s*(a-o);return l===0?0:l}function tP(n,e){const t=n.getFullYear()-e.getFullYear()||n.getMonth()-e.getMonth()||n.getDate()-e.getDate()||n.getHours()-e.getHours()||n.getMinutes()-e.getMinutes()||n.getSeconds()-e.getSeconds()||n.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function mF(n){return e=>{const r=(n?Math[n]:Math.trunc)(e);return r===0?0:r}}function pF(n,e){return+qt(n)-+qt(e)}function pf(n,e,t){const r=pF(n,e)/fF;return mF(t?.roundingMethod)(r)}function p1(n){const e=qt(n);return e.setHours(23,59,59,999),e}function Ma(n){const e=qt(n),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function KV(n){const e=qt(n);return+p1(e)==+Ma(e)}function JV(n,e){const t=qt(n),r=qt(e),s=sx(t,r),a=Math.abs(GV(t,r));let o;if(a<1)o=0;else{t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-s*a);let l=sx(t,r)===-s;KV(qt(n))&&a===1&&sx(n,r)===1&&(l=!1),o=s*(a-Number(l))}return o===0?0:o}function QV(n,e,t){const r=pF(n,e)/1e3;return mF(t?.roundingMethod)(r)}function yo(n,e){const t=qt(n.start),r=qt(n.end);let s=+t>+r;const a=s?+t:+r,o=s?r:t;o.setHours(0,0,0,0);let l=1;const c=[];for(;+o<=a;)c.push(qt(o)),o.setDate(o.getDate()+l),o.setHours(0,0,0,0);return s?c.reverse():c}function xi(n){const e=qt(n);return e.setDate(1),e.setHours(0,0,0,0),e}function XV(n){const e=qt(n),t=e.getFullYear();return e.setFullYear(t+1,0,0),e.setHours(23,59,59,999),e}function gF(n){const e=qt(n),t=Vn(n,0);return t.setFullYear(e.getFullYear(),0,1),t.setHours(0,0,0,0),t}function nP(n,e){const t=Kc(),r=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,s=qt(n),a=s.getDay(),o=(a<r?-7:0)+6-(a-r);return s.setDate(s.getDate()+o),s.setHours(23,59,59,999),s}function db(){return p1(Date.now())}const eW={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},tW=(n,e,t)=>{let r;const s=eW[n];return typeof s=="string"?r=s:e===1?r=s.one:r=s.other.replace("{{count}}",e.toString()),t?.addSuffix?t.comparison&&t.comparison>0?"in "+r:r+" ago":r};function ub(n){return(e={})=>{const t=e.width?String(e.width):n.defaultWidth;return n.formats[t]||n.formats[n.defaultWidth]}}const nW={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},rW={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},sW={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},iW={date:ub({formats:nW,defaultWidth:"full"}),time:ub({formats:rW,defaultWidth:"full"}),dateTime:ub({formats:sW,defaultWidth:"full"})},aW={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},oW=(n,e,t,r)=>aW[n];function vh(n){return(e,t)=>{const r=t?.context?String(t.context):"standalone";let s;if(r==="formatting"&&n.formattingValues){const o=n.defaultFormattingWidth||n.defaultWidth,l=t?.width?String(t.width):o;s=n.formattingValues[l]||n.formattingValues[o]}else{const o=n.defaultWidth,l=t?.width?String(t.width):n.defaultWidth;s=n.values[l]||n.values[o]}const a=n.argumentCallback?n.argumentCallback(e):e;return s[a]}}const lW={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},cW={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},dW={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},uW={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},fW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},hW={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},mW=(n,e)=>{const t=Number(n),r=t%100;if(r>20||r<10)switch(r%10){case 1:return t+"st";case 2:return t+"nd";case 3:return t+"rd"}return t+"th"},pW={ordinalNumber:mW,era:vh({values:lW,defaultWidth:"wide"}),quarter:vh({values:cW,defaultWidth:"wide",argumentCallback:n=>n-1}),month:vh({values:dW,defaultWidth:"wide"}),day:vh({values:uW,defaultWidth:"wide"}),dayPeriod:vh({values:fW,defaultWidth:"wide",formattingValues:hW,defaultFormattingWidth:"wide"})};function bh(n){return(e,t={})=>{const r=t.width,s=r&&n.matchPatterns[r]||n.matchPatterns[n.defaultMatchWidth],a=e.match(s);if(!a)return null;const o=a[0],l=r&&n.parsePatterns[r]||n.parsePatterns[n.defaultParseWidth],c=Array.isArray(l)?xW(l,p=>p.test(o)):gW(l,p=>p.test(o));let d;d=n.valueCallback?n.valueCallback(c):c,d=t.valueCallback?t.valueCallback(d):d;const h=e.slice(o.length);return{value:d,rest:h}}}function gW(n,e){for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)&&e(n[t]))return t}function xW(n,e){for(let t=0;t<n.length;t++)if(e(n[t]))return t}function yW(n){return(e,t={})=>{const r=e.match(n.matchPattern);if(!r)return null;const s=r[0],a=e.match(n.parsePattern);if(!a)return null;let o=n.valueCallback?n.valueCallback(a[0]):a[0];o=t.valueCallback?t.valueCallback(o):o;const l=e.slice(s.length);return{value:o,rest:l}}}const vW=/^(\d+)(th|st|nd|rd)?/i,bW=/\d+/i,wW={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},_W={any:[/^b/i,/^(a|c)/i]},jW={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},NW={any:[/1/i,/2/i,/3/i,/4/i]},SW={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},CW={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},TW={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kW={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},PW={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},MW={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},EW={ordinalNumber:yW({matchPattern:vW,parsePattern:bW,valueCallback:n=>parseInt(n,10)}),era:bh({matchPatterns:wW,defaultMatchWidth:"wide",parsePatterns:_W,defaultParseWidth:"any"}),quarter:bh({matchPatterns:jW,defaultMatchWidth:"wide",parsePatterns:NW,defaultParseWidth:"any",valueCallback:n=>n+1}),month:bh({matchPatterns:SW,defaultMatchWidth:"wide",parsePatterns:CW,defaultParseWidth:"any"}),day:bh({matchPatterns:TW,defaultMatchWidth:"wide",parsePatterns:kW,defaultParseWidth:"any"}),dayPeriod:bh({matchPatterns:PW,defaultMatchWidth:"any",parsePatterns:MW,defaultParseWidth:"any"})},g1={code:"en-US",formatDistance:tW,formatLong:iW,formatRelative:oW,localize:pW,match:EW,options:{weekStartsOn:0,firstWeekContainsDate:1}};function DW(n){const e=qt(n);return Em(e,gF(e))+1}function xF(n){const e=qt(n),t=+Sf(e)-+WV(e);return Math.round(t/uF)+1}function x1(n,e){const t=qt(n),r=t.getFullYear(),s=Kc(),a=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,o=Vn(n,0);o.setFullYear(r+1,0,a),o.setHours(0,0,0,0);const l=Co(o,e),c=Vn(n,0);c.setFullYear(r,0,a),c.setHours(0,0,0,0);const d=Co(c,e);return t.getTime()>=l.getTime()?r+1:t.getTime()>=d.getTime()?r:r-1}function OW(n,e){const t=Kc(),r=e?.firstWeekContainsDate??e?.locale?.options?.firstWeekContainsDate??t.firstWeekContainsDate??t.locale?.options?.firstWeekContainsDate??1,s=x1(n,e),a=Vn(n,0);return a.setFullYear(s,0,r),a.setHours(0,0,0,0),Co(a,e)}function yF(n,e){const t=qt(n),r=+Co(t,e)-+OW(t,e);return Math.round(r/uF)+1}function _n(n,e){const t=n<0?"-":"",r=Math.abs(n).toString().padStart(e,"0");return t+r}const Nc={y(n,e){const t=n.getFullYear(),r=t>0?t:1-t;return _n(e==="yy"?r%100:r,e.length)},M(n,e){const t=n.getMonth();return e==="M"?String(t+1):_n(t+1,2)},d(n,e){return _n(n.getDate(),e.length)},a(n,e){const t=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.toUpperCase();case"aaa":return t;case"aaaaa":return t[0];case"aaaa":default:return t==="am"?"a.m.":"p.m."}},h(n,e){return _n(n.getHours()%12||12,e.length)},H(n,e){return _n(n.getHours(),e.length)},m(n,e){return _n(n.getMinutes(),e.length)},s(n,e){return _n(n.getSeconds(),e.length)},S(n,e){const t=e.length,r=n.getMilliseconds(),s=Math.trunc(r*Math.pow(10,t-3));return _n(s,e.length)}},Ju={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},rP={G:function(n,e,t){const r=n.getFullYear()>0?1:0;switch(e){case"G":case"GG":case"GGG":return t.era(r,{width:"abbreviated"});case"GGGGG":return t.era(r,{width:"narrow"});case"GGGG":default:return t.era(r,{width:"wide"})}},y:function(n,e,t){if(e==="yo"){const r=n.getFullYear(),s=r>0?r:1-r;return t.ordinalNumber(s,{unit:"year"})}return Nc.y(n,e)},Y:function(n,e,t,r){const s=x1(n,r),a=s>0?s:1-s;if(e==="YY"){const o=a%100;return _n(o,2)}return e==="Yo"?t.ordinalNumber(a,{unit:"year"}):_n(a,e.length)},R:function(n,e){const t=hF(n);return _n(t,e.length)},u:function(n,e){const t=n.getFullYear();return _n(t,e.length)},Q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"Q":return String(r);case"QQ":return _n(r,2);case"Qo":return t.ordinalNumber(r,{unit:"quarter"});case"QQQ":return t.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return t.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return t.quarter(r,{width:"wide",context:"formatting"})}},q:function(n,e,t){const r=Math.ceil((n.getMonth()+1)/3);switch(e){case"q":return String(r);case"qq":return _n(r,2);case"qo":return t.ordinalNumber(r,{unit:"quarter"});case"qqq":return t.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return t.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return t.quarter(r,{width:"wide",context:"standalone"})}},M:function(n,e,t){const r=n.getMonth();switch(e){case"M":case"MM":return Nc.M(n,e);case"Mo":return t.ordinalNumber(r+1,{unit:"month"});case"MMM":return t.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return t.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return t.month(r,{width:"wide",context:"formatting"})}},L:function(n,e,t){const r=n.getMonth();switch(e){case"L":return String(r+1);case"LL":return _n(r+1,2);case"Lo":return t.ordinalNumber(r+1,{unit:"month"});case"LLL":return t.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return t.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return t.month(r,{width:"wide",context:"standalone"})}},w:function(n,e,t,r){const s=yF(n,r);return e==="wo"?t.ordinalNumber(s,{unit:"week"}):_n(s,e.length)},I:function(n,e,t){const r=xF(n);return e==="Io"?t.ordinalNumber(r,{unit:"week"}):_n(r,e.length)},d:function(n,e,t){return e==="do"?t.ordinalNumber(n.getDate(),{unit:"date"}):Nc.d(n,e)},D:function(n,e,t){const r=DW(n);return e==="Do"?t.ordinalNumber(r,{unit:"dayOfYear"}):_n(r,e.length)},E:function(n,e,t){const r=n.getDay();switch(e){case"E":case"EE":case"EEE":return t.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return t.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return t.day(r,{width:"short",context:"formatting"});case"EEEE":default:return t.day(r,{width:"wide",context:"formatting"})}},e:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"e":return String(a);case"ee":return _n(a,2);case"eo":return t.ordinalNumber(a,{unit:"day"});case"eee":return t.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return t.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return t.day(s,{width:"short",context:"formatting"});case"eeee":default:return t.day(s,{width:"wide",context:"formatting"})}},c:function(n,e,t,r){const s=n.getDay(),a=(s-r.weekStartsOn+8)%7||7;switch(e){case"c":return String(a);case"cc":return _n(a,e.length);case"co":return t.ordinalNumber(a,{unit:"day"});case"ccc":return t.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return t.day(s,{width:"narrow",context:"standalone"});case"cccccc":return t.day(s,{width:"short",context:"standalone"});case"cccc":default:return t.day(s,{width:"wide",context:"standalone"})}},i:function(n,e,t){const r=n.getDay(),s=r===0?7:r;switch(e){case"i":return String(s);case"ii":return _n(s,e.length);case"io":return t.ordinalNumber(s,{unit:"day"});case"iii":return t.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return t.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return t.day(r,{width:"short",context:"formatting"});case"iiii":default:return t.day(r,{width:"wide",context:"formatting"})}},a:function(n,e,t){const s=n.getHours()/12>=1?"pm":"am";switch(e){case"a":case"aa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(n,e,t){const r=n.getHours();let s;switch(r===12?s=Ju.noon:r===0?s=Ju.midnight:s=r/12>=1?"pm":"am",e){case"b":case"bb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(n,e,t){const r=n.getHours();let s;switch(r>=17?s=Ju.evening:r>=12?s=Ju.afternoon:r>=4?s=Ju.morning:s=Ju.night,e){case"B":case"BB":case"BBB":return t.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return t.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return t.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(n,e,t){if(e==="ho"){let r=n.getHours()%12;return r===0&&(r=12),t.ordinalNumber(r,{unit:"hour"})}return Nc.h(n,e)},H:function(n,e,t){return e==="Ho"?t.ordinalNumber(n.getHours(),{unit:"hour"}):Nc.H(n,e)},K:function(n,e,t){const r=n.getHours()%12;return e==="Ko"?t.ordinalNumber(r,{unit:"hour"}):_n(r,e.length)},k:function(n,e,t){let r=n.getHours();return r===0&&(r=24),e==="ko"?t.ordinalNumber(r,{unit:"hour"}):_n(r,e.length)},m:function(n,e,t){return e==="mo"?t.ordinalNumber(n.getMinutes(),{unit:"minute"}):Nc.m(n,e)},s:function(n,e,t){return e==="so"?t.ordinalNumber(n.getSeconds(),{unit:"second"}):Nc.s(n,e)},S:function(n,e){return Nc.S(n,e)},X:function(n,e,t){const r=n.getTimezoneOffset();if(r===0)return"Z";switch(e){case"X":return iP(r);case"XXXX":case"XX":return eu(r);case"XXXXX":case"XXX":default:return eu(r,":")}},x:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"x":return iP(r);case"xxxx":case"xx":return eu(r);case"xxxxx":case"xxx":default:return eu(r,":")}},O:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"O":case"OO":case"OOO":return"GMT"+sP(r,":");case"OOOO":default:return"GMT"+eu(r,":")}},z:function(n,e,t){const r=n.getTimezoneOffset();switch(e){case"z":case"zz":case"zzz":return"GMT"+sP(r,":");case"zzzz":default:return"GMT"+eu(r,":")}},t:function(n,e,t){const r=Math.trunc(n.getTime()/1e3);return _n(r,e.length)},T:function(n,e,t){const r=n.getTime();return _n(r,e.length)}};function sP(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=Math.trunc(r/60),a=r%60;return a===0?t+String(s):t+String(s)+e+_n(a,2)}function iP(n,e){return n%60===0?(n>0?"-":"+")+_n(Math.abs(n)/60,2):eu(n,e)}function eu(n,e=""){const t=n>0?"-":"+",r=Math.abs(n),s=_n(Math.trunc(r/60),2),a=_n(r%60,2);return t+s+e+a}const aP=(n,e)=>{switch(n){case"P":return e.date({width:"short"});case"PP":return e.date({width:"medium"});case"PPP":return e.date({width:"long"});case"PPPP":default:return e.date({width:"full"})}},vF=(n,e)=>{switch(n){case"p":return e.time({width:"short"});case"pp":return e.time({width:"medium"});case"ppp":return e.time({width:"long"});case"pppp":default:return e.time({width:"full"})}},IW=(n,e)=>{const t=n.match(/(P+)(p+)?/)||[],r=t[1],s=t[2];if(!s)return aP(n,e);let a;switch(r){case"P":a=e.dateTime({width:"short"});break;case"PP":a=e.dateTime({width:"medium"});break;case"PPP":a=e.dateTime({width:"long"});break;case"PPPP":default:a=e.dateTime({width:"full"});break}return a.replace("{{date}}",aP(r,e)).replace("{{time}}",vF(s,e))},iS={p:vF,P:IW},AW=/^D+$/,RW=/^Y+$/,LW=["D","DD","YY","YYYY"];function bF(n){return AW.test(n)}function wF(n){return RW.test(n)}function aS(n,e,t){const r=FW(n,e,t);if(console.warn(r),LW.includes(n))throw new RangeError(r)}function FW(n,e,t){const r=n[0]==="Y"?"years":"days of the month";return`Use \`${n.toLowerCase()}\` instead of \`${n}\` (in \`${e}\`) for formatting ${r} to the input \`${t}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const qW=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,zW=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,UW=/^'([^]*?)'?$/,BW=/''/g,VW=/[a-zA-Z]/;function We(n,e,t){const r=Kc(),s=r.locale??g1,a=r.firstWeekContainsDate??r.locale?.options?.firstWeekContainsDate??1,o=r.weekStartsOn??r.locale?.options?.weekStartsOn??0,l=qt(n);if(!YV(l))throw new RangeError("Invalid time value");let c=e.match(zW).map(h=>{const p=h[0];if(p==="p"||p==="P"){const x=iS[p];return x(h,s.formatLong)}return h}).join("").match(qW).map(h=>{if(h==="''")return{isToken:!1,value:"'"};const p=h[0];if(p==="'")return{isToken:!1,value:WW(h)};if(rP[p])return{isToken:!0,value:h};if(p.match(VW))throw new RangeError("Format string contains an unescaped latin alphabet character `"+p+"`");return{isToken:!1,value:h}});s.localize.preprocessor&&(c=s.localize.preprocessor(l,c));const d={firstWeekContainsDate:a,weekStartsOn:o,locale:s};return c.map(h=>{if(!h.isToken)return h.value;const p=h.value;(wF(p)||bF(p))&&aS(p,e,String(n));const x=rP[p[0]];return x(l,p,s.localize,d)}).join("")}function WW(n){const e=n.match(UW);return e?e[1].replace(BW,"'"):n}function $W(n,e,t){const r=Kc(),s=t?.locale??r.locale??g1,a=2520,o=sx(n,e);if(isNaN(o))throw new RangeError("Invalid time value");const l=Object.assign({},t,{addSuffix:t?.addSuffix,comparison:o});let c,d;o>0?(c=qt(e),d=qt(n)):(c=qt(n),d=qt(e));const h=QV(d,c),p=(Cf(d)-Cf(c))/1e3,x=Math.round((h-p)/60);let y;if(x<2)return t?.includeSeconds?h<5?s.formatDistance("lessThanXSeconds",5,l):h<10?s.formatDistance("lessThanXSeconds",10,l):h<20?s.formatDistance("lessThanXSeconds",20,l):h<40?s.formatDistance("halfAMinute",0,l):h<60?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",1,l):x===0?s.formatDistance("lessThanXMinutes",1,l):s.formatDistance("xMinutes",x,l);if(x<45)return s.formatDistance("xMinutes",x,l);if(x<90)return s.formatDistance("aboutXHours",1,l);if(x<eP){const _=Math.round(x/60);return s.formatDistance("aboutXHours",_,l)}else{if(x<a)return s.formatDistance("xDays",1,l);if(x<Up){const _=Math.round(x/eP);return s.formatDistance("xDays",_,l)}else if(x<Up*2)return y=Math.round(x/Up),s.formatDistance("aboutXMonths",y,l)}if(y=JV(d,c),y<12){const _=Math.round(x/Up);return s.formatDistance("xMonths",_,l)}else{const _=y%12,w=Math.trunc(y/12);return _<3?s.formatDistance("aboutXYears",w,l):_<9?s.formatDistance("overXYears",w,l):s.formatDistance("almostXYears",w+1,l)}}function hu(n,e){return $W(n,$V(n),e)}function y1(n){return qt(n).getDay()}function HW(){return Object.assign({},Kc())}function YW(n){let t=qt(n).getDay();return t===0&&(t=7),t}function GW(n,e){const t=qt(n),r=qt(e);return t.getTime()>r.getTime()}function ZW(n,e){const t=e instanceof Date?Vn(e,0):new e(0);return t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate()),t.setHours(n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t}const KW=10;let _F=class{subPriority=0;validate(e,t){return!0}};class JW extends _F{constructor(e,t,r,s,a){super(),this.value=e,this.validateValue=t,this.setValue=r,this.priority=s,a&&(this.subPriority=a)}validate(e,t){return this.validateValue(e,this.value,t)}set(e,t,r){return this.setValue(e,t,this.value,r)}}class QW extends _F{priority=KW;subPriority=-1;set(e,t){return t.timestampIsSet?e:Vn(e,ZW(e,Date))}}let pn=class{run(e,t,r,s){const a=this.parse(e,t,r,s);return a?{setter:new JW(a.value,this.validate,this.set,this.priority,this.subPriority),rest:a.rest}:null}validate(e,t,r){return!0}},XW=class extends pn{priority=140;parse(e,t,r){switch(t){case"G":case"GG":case"GGG":return r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"});case"GGGGG":return r.era(e,{width:"narrow"});case"GGGG":default:return r.era(e,{width:"wide"})||r.era(e,{width:"abbreviated"})||r.era(e,{width:"narrow"})}}set(e,t,r){return t.era=r,e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["R","u","t","T"]};const or={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},vo={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/};function lr(n,e){return n&&{value:e(n.value),rest:n.rest}}function Xn(n,e){const t=e.match(n);return t?{value:parseInt(t[0],10),rest:e.slice(t[0].length)}:null}function bo(n,e){const t=e.match(n);if(!t)return null;if(t[0]==="Z")return{value:0,rest:e.slice(1)};const r=t[1]==="+"?1:-1,s=t[2]?parseInt(t[2],10):0,a=t[3]?parseInt(t[3],10):0,o=t[5]?parseInt(t[5],10):0;return{value:r*(s*UV+a*fF+o*BV),rest:e.slice(t[0].length)}}function jF(n){return Xn(or.anyDigitsSigned,n)}function sr(n,e){switch(n){case 1:return Xn(or.singleDigit,e);case 2:return Xn(or.twoDigits,e);case 3:return Xn(or.threeDigits,e);case 4:return Xn(or.fourDigits,e);default:return Xn(new RegExp("^\\d{1,"+n+"}"),e)}}function _x(n,e){switch(n){case 1:return Xn(or.singleDigitSigned,e);case 2:return Xn(or.twoDigitsSigned,e);case 3:return Xn(or.threeDigitsSigned,e);case 4:return Xn(or.fourDigitsSigned,e);default:return Xn(new RegExp("^-?\\d{1,"+n+"}"),e)}}function v1(n){switch(n){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function NF(n,e){const t=e>0,r=t?e:1-e;let s;if(r<=50)s=n||100;else{const a=r+50,o=Math.trunc(a/100)*100,l=n>=a%100;s=n+o-(l?100:0)}return t?s:1-s}function SF(n){return n%400===0||n%4===0&&n%100!==0}let e$=class extends pn{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="yy"});switch(t){case"y":return lr(sr(4,e),s);case"yo":return lr(r.ordinalNumber(e,{unit:"year"}),s);default:return lr(sr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r){const s=e.getFullYear();if(r.isTwoDigitYear){const o=NF(r.year,s);return e.setFullYear(o,0,1),e.setHours(0,0,0,0),e}const a=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(a,0,1),e.setHours(0,0,0,0),e}},t$=class extends pn{priority=130;parse(e,t,r){const s=a=>({year:a,isTwoDigitYear:t==="YY"});switch(t){case"Y":return lr(sr(4,e),s);case"Yo":return lr(r.ordinalNumber(e,{unit:"year"}),s);default:return lr(sr(t.length,e),s)}}validate(e,t){return t.isTwoDigitYear||t.year>0}set(e,t,r,s){const a=x1(e,s);if(r.isTwoDigitYear){const l=NF(r.year,a);return e.setFullYear(l,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),Co(e,s)}const o=!("era"in t)||t.era===1?r.year:1-r.year;return e.setFullYear(o,0,s.firstWeekContainsDate),e.setHours(0,0,0,0),Co(e,s)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]},n$=class extends pn{priority=130;parse(e,t){return _x(t==="R"?4:t.length,e)}set(e,t,r){const s=Vn(e,0);return s.setFullYear(r,0,4),s.setHours(0,0,0,0),Sf(s)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]},r$=class extends pn{priority=130;parse(e,t){return _x(t==="u"?4:t.length,e)}set(e,t,r){return e.setFullYear(r,0,1),e.setHours(0,0,0,0),e}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]},s$=class extends pn{priority=120;parse(e,t,r){switch(t){case"Q":case"QQ":return sr(t.length,e);case"Qo":return r.ordinalNumber(e,{unit:"quarter"});case"QQQ":return r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQQ":return r.quarter(e,{width:"narrow",context:"formatting"});case"QQQQ":default:return r.quarter(e,{width:"wide",context:"formatting"})||r.quarter(e,{width:"abbreviated",context:"formatting"})||r.quarter(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]},i$=class extends pn{priority=120;parse(e,t,r){switch(t){case"q":case"qq":return sr(t.length,e);case"qo":return r.ordinalNumber(e,{unit:"quarter"});case"qqq":return r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"});case"qqqqq":return r.quarter(e,{width:"narrow",context:"standalone"});case"qqqq":default:return r.quarter(e,{width:"wide",context:"standalone"})||r.quarter(e,{width:"abbreviated",context:"standalone"})||r.quarter(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=1&&t<=4}set(e,t,r){return e.setMonth((r-1)*3,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]},a$=class extends pn{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"M":return lr(Xn(or.month,e),s);case"MM":return lr(sr(2,e),s);case"Mo":return lr(r.ordinalNumber(e,{unit:"month"}),s);case"MMM":return r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"});case"MMMMM":return r.month(e,{width:"narrow",context:"formatting"});case"MMMM":default:return r.month(e,{width:"wide",context:"formatting"})||r.month(e,{width:"abbreviated",context:"formatting"})||r.month(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}},o$=class extends pn{priority=110;parse(e,t,r){const s=a=>a-1;switch(t){case"L":return lr(Xn(or.month,e),s);case"LL":return lr(sr(2,e),s);case"Lo":return lr(r.ordinalNumber(e,{unit:"month"}),s);case"LLL":return r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"});case"LLLLL":return r.month(e,{width:"narrow",context:"standalone"});case"LLLL":default:return r.month(e,{width:"wide",context:"standalone"})||r.month(e,{width:"abbreviated",context:"standalone"})||r.month(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.setMonth(r,1),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};function l$(n,e,t){const r=qt(n),s=yF(r,t)-e;return r.setDate(r.getDate()-s*7),r}let c$=class extends pn{priority=100;parse(e,t,r){switch(t){case"w":return Xn(or.week,e);case"wo":return r.ordinalNumber(e,{unit:"week"});default:return sr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r,s){return Co(l$(e,r,s),s)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};function d$(n,e){const t=qt(n),r=xF(t)-e;return t.setDate(t.getDate()-r*7),t}let u$=class extends pn{priority=100;parse(e,t,r){switch(t){case"I":return Xn(or.week,e);case"Io":return r.ordinalNumber(e,{unit:"week"});default:return sr(t.length,e)}}validate(e,t){return t>=1&&t<=53}set(e,t,r){return Sf(d$(e,r))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};const f$=[31,28,31,30,31,30,31,31,30,31,30,31],h$=[31,29,31,30,31,30,31,31,30,31,30,31];let m$=class extends pn{priority=90;subPriority=1;parse(e,t,r){switch(t){case"d":return Xn(or.date,e);case"do":return r.ordinalNumber(e,{unit:"date"});default:return sr(t.length,e)}}validate(e,t){const r=e.getFullYear(),s=SF(r),a=e.getMonth();return s?t>=1&&t<=h$[a]:t>=1&&t<=f$[a]}set(e,t,r){return e.setDate(r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]},p$=class extends pn{priority=90;subpriority=1;parse(e,t,r){switch(t){case"D":case"DD":return Xn(or.dayOfYear,e);case"Do":return r.ordinalNumber(e,{unit:"date"});default:return sr(t.length,e)}}validate(e,t){const r=e.getFullYear();return SF(r)?t>=1&&t<=366:t>=1&&t<=365}set(e,t,r){return e.setMonth(0,r),e.setHours(0,0,0,0),e}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};function b1(n,e,t){const r=Kc(),s=t?.weekStartsOn??t?.locale?.options?.weekStartsOn??r.weekStartsOn??r.locale?.options?.weekStartsOn??0,a=qt(n),o=a.getDay(),c=(e%7+7)%7,d=7-s,h=e<0||e>6?e-(o+d)%7:(c+d)%7-(o+d)%7;return yl(a,h)}let g$=class extends pn{priority=90;parse(e,t,r){switch(t){case"E":case"EE":case"EEE":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEEE":return r.day(e,{width:"narrow",context:"formatting"});case"EEEEEE":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"EEEE":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=b1(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["D","i","e","c","t","T"]},x$=class extends pn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"e":case"ee":return lr(sr(t.length,e),a);case"eo":return lr(r.ordinalNumber(e,{unit:"day"}),a);case"eee":return r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeeee":return r.day(e,{width:"narrow",context:"formatting"});case"eeeeee":return r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"});case"eeee":default:return r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=b1(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]},y$=class extends pn{priority=90;parse(e,t,r,s){const a=o=>{const l=Math.floor((o-1)/7)*7;return(o+s.weekStartsOn+6)%7+l};switch(t){case"c":case"cc":return lr(sr(t.length,e),a);case"co":return lr(r.ordinalNumber(e,{unit:"day"}),a);case"ccc":return r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"ccccc":return r.day(e,{width:"narrow",context:"standalone"});case"cccccc":return r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"});case"cccc":default:return r.day(e,{width:"wide",context:"standalone"})||r.day(e,{width:"abbreviated",context:"standalone"})||r.day(e,{width:"short",context:"standalone"})||r.day(e,{width:"narrow",context:"standalone"})}}validate(e,t){return t>=0&&t<=6}set(e,t,r,s){return e=b1(e,r,s),e.setHours(0,0,0,0),e}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};function v$(n,e){const t=qt(n),r=YW(t),s=e-r;return yl(t,s)}let b$=class extends pn{priority=90;parse(e,t,r){const s=a=>a===0?7:a;switch(t){case"i":case"ii":return sr(t.length,e);case"io":return r.ordinalNumber(e,{unit:"day"});case"iii":return lr(r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiii":return lr(r.day(e,{width:"narrow",context:"formatting"}),s);case"iiiiii":return lr(r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s);case"iiii":default:return lr(r.day(e,{width:"wide",context:"formatting"})||r.day(e,{width:"abbreviated",context:"formatting"})||r.day(e,{width:"short",context:"formatting"})||r.day(e,{width:"narrow",context:"formatting"}),s)}}validate(e,t){return t>=1&&t<=7}set(e,t,r){return e=v$(e,r),e.setHours(0,0,0,0),e}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]},w$=class extends pn{priority=80;parse(e,t,r){switch(t){case"a":case"aa":case"aaa":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaaa":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"aaaa":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(v1(r),0,0,0),e}incompatibleTokens=["b","B","H","k","t","T"]},_$=class extends pn{priority=80;parse(e,t,r){switch(t){case"b":case"bb":case"bbb":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbbb":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"bbbb":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(v1(r),0,0,0),e}incompatibleTokens=["a","B","H","k","t","T"]},j$=class extends pn{priority=80;parse(e,t,r){switch(t){case"B":case"BB":case"BBB":return r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBBB":return r.dayPeriod(e,{width:"narrow",context:"formatting"});case"BBBB":default:return r.dayPeriod(e,{width:"wide",context:"formatting"})||r.dayPeriod(e,{width:"abbreviated",context:"formatting"})||r.dayPeriod(e,{width:"narrow",context:"formatting"})}}set(e,t,r){return e.setHours(v1(r),0,0,0),e}incompatibleTokens=["a","b","t","T"]},N$=class extends pn{priority=70;parse(e,t,r){switch(t){case"h":return Xn(or.hour12h,e);case"ho":return r.ordinalNumber(e,{unit:"hour"});default:return sr(t.length,e)}}validate(e,t){return t>=1&&t<=12}set(e,t,r){const s=e.getHours()>=12;return s&&r<12?e.setHours(r+12,0,0,0):!s&&r===12?e.setHours(0,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["H","K","k","t","T"]},S$=class extends pn{priority=70;parse(e,t,r){switch(t){case"H":return Xn(or.hour23h,e);case"Ho":return r.ordinalNumber(e,{unit:"hour"});default:return sr(t.length,e)}}validate(e,t){return t>=0&&t<=23}set(e,t,r){return e.setHours(r,0,0,0),e}incompatibleTokens=["a","b","h","K","k","t","T"]},C$=class extends pn{priority=70;parse(e,t,r){switch(t){case"K":return Xn(or.hour11h,e);case"Ko":return r.ordinalNumber(e,{unit:"hour"});default:return sr(t.length,e)}}validate(e,t){return t>=0&&t<=11}set(e,t,r){return e.getHours()>=12&&r<12?e.setHours(r+12,0,0,0):e.setHours(r,0,0,0),e}incompatibleTokens=["h","H","k","t","T"]},T$=class extends pn{priority=70;parse(e,t,r){switch(t){case"k":return Xn(or.hour24h,e);case"ko":return r.ordinalNumber(e,{unit:"hour"});default:return sr(t.length,e)}}validate(e,t){return t>=1&&t<=24}set(e,t,r){const s=r<=24?r%24:r;return e.setHours(s,0,0,0),e}incompatibleTokens=["a","b","h","H","K","t","T"]},k$=class extends pn{priority=60;parse(e,t,r){switch(t){case"m":return Xn(or.minute,e);case"mo":return r.ordinalNumber(e,{unit:"minute"});default:return sr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setMinutes(r,0,0),e}incompatibleTokens=["t","T"]},P$=class extends pn{priority=50;parse(e,t,r){switch(t){case"s":return Xn(or.second,e);case"so":return r.ordinalNumber(e,{unit:"second"});default:return sr(t.length,e)}}validate(e,t){return t>=0&&t<=59}set(e,t,r){return e.setSeconds(r,0),e}incompatibleTokens=["t","T"]},M$=class extends pn{priority=30;parse(e,t){const r=s=>Math.trunc(s*Math.pow(10,-t.length+3));return lr(sr(t.length,e),r)}set(e,t,r){return e.setMilliseconds(r),e}incompatibleTokens=["t","T"]},E$=class extends pn{priority=10;parse(e,t){switch(t){case"X":return bo(vo.basicOptionalMinutes,e);case"XX":return bo(vo.basic,e);case"XXXX":return bo(vo.basicOptionalSeconds,e);case"XXXXX":return bo(vo.extendedOptionalSeconds,e);case"XXX":default:return bo(vo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:Vn(e,e.getTime()-Cf(e)-r)}incompatibleTokens=["t","T","x"]},D$=class extends pn{priority=10;parse(e,t){switch(t){case"x":return bo(vo.basicOptionalMinutes,e);case"xx":return bo(vo.basic,e);case"xxxx":return bo(vo.basicOptionalSeconds,e);case"xxxxx":return bo(vo.extendedOptionalSeconds,e);case"xxx":default:return bo(vo.extended,e)}}set(e,t,r){return t.timestampIsSet?e:Vn(e,e.getTime()-Cf(e)-r)}incompatibleTokens=["t","T","X"]},O$=class extends pn{priority=40;parse(e){return jF(e)}set(e,t,r){return[Vn(e,r*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"},I$=class extends pn{priority=20;parse(e){return jF(e)}set(e,t,r){return[Vn(e,r),{timestampIsSet:!0}]}incompatibleTokens="*"};const A$={G:new XW,y:new e$,Y:new t$,R:new n$,u:new r$,Q:new s$,q:new i$,M:new a$,L:new o$,w:new c$,I:new u$,d:new m$,D:new p$,E:new g$,e:new x$,c:new y$,i:new b$,a:new w$,b:new _$,B:new j$,h:new N$,H:new S$,K:new C$,k:new T$,m:new k$,s:new P$,S:new M$,X:new E$,x:new D$,t:new O$,T:new I$},R$=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,L$=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,F$=/^'([^]*?)'?$/,q$=/''/g,z$=/\S/,U$=/[a-zA-Z]/;function B$(n,e,t,r){const s=HW(),a=s.locale??g1,o=s.firstWeekContainsDate??s.locale?.options?.firstWeekContainsDate??1,l=s.weekStartsOn??s.locale?.options?.weekStartsOn??0;if(e==="")return n===""?qt(t):Vn(t,NaN);const c={firstWeekContainsDate:o,weekStartsOn:l,locale:a},d=[new QW],h=e.match(L$).map(w=>{const j=w[0];if(j in iS){const C=iS[j];return C(w,a.formatLong)}return w}).join("").match(R$),p=[];for(let w of h){wF(w)&&aS(w,e,n),bF(w)&&aS(w,e,n);const j=w[0],C=A$[j];if(C){const{incompatibleTokens:P}=C;if(Array.isArray(P)){const M=p.find(D=>P.includes(D.token)||D.token===j);if(M)throw new RangeError(`The format string mustn't contain \`${M.fullToken}\` and \`${w}\` at the same time`)}else if(C.incompatibleTokens==="*"&&p.length>0)throw new RangeError(`The format string mustn't contain \`${w}\` and any other token at the same time`);p.push({token:j,fullToken:w});const O=C.run(n,w,a.match,c);if(!O)return Vn(t,NaN);d.push(O.setter),n=O.rest}else{if(j.match(U$))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");if(w==="''"?w="'":j==="'"&&(w=V$(w)),n.indexOf(w)===0)n=n.slice(w.length);else return Vn(t,NaN)}}if(n.length>0&&z$.test(n))return Vn(t,NaN);const x=d.map(w=>w.priority).sort((w,j)=>j-w).filter((w,j,C)=>C.indexOf(w)===j).map(w=>d.filter(j=>j.priority===w).sort((j,C)=>C.subPriority-j.subPriority)).map(w=>w[0]);let y=qt(t);if(isNaN(y.getTime()))return Vn(t,NaN);const _={};for(const w of x){if(!w.validate(y,c))return Vn(t,NaN);const j=w.set(y,_,c);Array.isArray(j)?(y=j[0],Object.assign(_,j[1])):y=j}return Vn(t,y)}function V$(n){return n.match(F$)[1].replace(q$,"'")}function gf(n,e){return yl(n,-e)}function ix(){return Vc(Date.now())}function w1(n,e){return ty(n,-1)}var un;(function(n){n.assertEqual=s=>{};function e(s){}n.assertIs=e;function t(s){throw new Error}n.assertNever=t,n.arrayToEnum=s=>{const a={};for(const o of s)a[o]=o;return a},n.getValidEnumValues=s=>{const a=n.objectKeys(s).filter(l=>typeof s[s[l]]!="number"),o={};for(const l of a)o[l]=s[l];return n.objectValues(o)},n.objectValues=s=>n.objectKeys(s).map(function(a){return s[a]}),n.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const a=[];for(const o in s)Object.prototype.hasOwnProperty.call(s,o)&&a.push(o);return a},n.find=(s,a)=>{for(const o of s)if(a(o))return o},n.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,a=" | "){return s.map(o=>typeof o=="string"?`'${o}'`:o).join(a)}n.joinValues=r,n.jsonStringifyReplacer=(s,a)=>typeof a=="bigint"?a.toString():a})(un||(un={}));var oP;(function(n){n.mergeShapes=(e,t)=>({...e,...t})})(oP||(oP={}));const ft=un.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Oc=n=>{switch(typeof n){case"undefined":return ft.undefined;case"string":return ft.string;case"number":return Number.isNaN(n)?ft.nan:ft.number;case"boolean":return ft.boolean;case"function":return ft.function;case"bigint":return ft.bigint;case"symbol":return ft.symbol;case"object":return Array.isArray(n)?ft.array:n===null?ft.null:n.then&&typeof n.then=="function"&&n.catch&&typeof n.catch=="function"?ft.promise:typeof Map<"u"&&n instanceof Map?ft.map:typeof Set<"u"&&n instanceof Set?ft.set:typeof Date<"u"&&n instanceof Date?ft.date:ft.object;default:return ft.unknown}},Qe=un.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Sl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(a){return a.message},r={_errors:[]},s=a=>{for(const o of a.issues)if(o.code==="invalid_union")o.unionErrors.map(s);else if(o.code==="invalid_return_type")s(o.returnTypeError);else if(o.code==="invalid_arguments")s(o.argumentsError);else if(o.path.length===0)r._errors.push(t(o));else{let l=r,c=0;for(;c<o.path.length;){const d=o.path[c];c===o.path.length-1?(l[d]=l[d]||{_errors:[]},l[d]._errors.push(t(o))):l[d]=l[d]||{_errors:[]},l=l[d],c++}}};return s(this),r}static assert(e){if(!(e instanceof Sl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,un.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=t=>t.message){const t={},r=[];for(const s of this.issues)if(s.path.length>0){const a=s.path[0];t[a]=t[a]||[],t[a].push(e(s))}else r.push(e(s));return{formErrors:r,fieldErrors:t}}get formErrors(){return this.flatten()}}Sl.create=n=>new Sl(n);const oS=(n,e)=>{let t;switch(n.code){case Qe.invalid_type:n.received===ft.undefined?t="Required":t=`Expected ${n.expected}, received ${n.received}`;break;case Qe.invalid_literal:t=`Invalid literal value, expected ${JSON.stringify(n.expected,un.jsonStringifyReplacer)}`;break;case Qe.unrecognized_keys:t=`Unrecognized key(s) in object: ${un.joinValues(n.keys,", ")}`;break;case Qe.invalid_union:t="Invalid input";break;case Qe.invalid_union_discriminator:t=`Invalid discriminator value. Expected ${un.joinValues(n.options)}`;break;case Qe.invalid_enum_value:t=`Invalid enum value. Expected ${un.joinValues(n.options)}, received '${n.received}'`;break;case Qe.invalid_arguments:t="Invalid function arguments";break;case Qe.invalid_return_type:t="Invalid function return type";break;case Qe.invalid_date:t="Invalid date";break;case Qe.invalid_string:typeof n.validation=="object"?"includes"in n.validation?(t=`Invalid input: must include "${n.validation.includes}"`,typeof n.validation.position=="number"&&(t=`${t} at one or more positions greater than or equal to ${n.validation.position}`)):"startsWith"in n.validation?t=`Invalid input: must start with "${n.validation.startsWith}"`:"endsWith"in n.validation?t=`Invalid input: must end with "${n.validation.endsWith}"`:un.assertNever(n.validation):n.validation!=="regex"?t=`Invalid ${n.validation}`:t="Invalid";break;case Qe.too_small:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at least":"more than"} ${n.minimum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at least":"over"} ${n.minimum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="bigint"?t=`Number must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${n.minimum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly equal to ":n.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(n.minimum))}`:t="Invalid input";break;case Qe.too_big:n.type==="array"?t=`Array must contain ${n.exact?"exactly":n.inclusive?"at most":"less than"} ${n.maximum} element(s)`:n.type==="string"?t=`String must contain ${n.exact?"exactly":n.inclusive?"at most":"under"} ${n.maximum} character(s)`:n.type==="number"?t=`Number must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="bigint"?t=`BigInt must be ${n.exact?"exactly":n.inclusive?"less than or equal to":"less than"} ${n.maximum}`:n.type==="date"?t=`Date must be ${n.exact?"exactly":n.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(n.maximum))}`:t="Invalid input";break;case Qe.custom:t="Invalid input";break;case Qe.invalid_intersection_types:t="Intersection results could not be merged";break;case Qe.not_multiple_of:t=`Number must be a multiple of ${n.multipleOf}`;break;case Qe.not_finite:t="Number must be finite";break;default:t=e.defaultError,un.assertNever(n)}return{message:t}};let W$=oS;function $$(){return W$}const H$=n=>{const{data:e,path:t,errorMaps:r,issueData:s}=n,a=[...t,...s.path||[]],o={...s,path:a};if(s.message!==void 0)return{...s,path:a,message:s.message};let l="";const c=r.filter(d=>!!d).slice().reverse();for(const d of c)l=d(o,{data:e,defaultError:l}).message;return{...s,path:a,message:l}};function it(n,e){const t=$$(),r=H$({issueData:e,data:n.data,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,t,t===oS?void 0:oS].filter(s=>!!s)});n.common.issues.push(r)}class Ss{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,t){const r=[];for(const s of t){if(s.status==="aborted")return Bt;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,t){const r=[];for(const s of t){const a=await s.key,o=await s.value;r.push({key:a,value:o})}return Ss.mergeObjectSync(e,r)}static mergeObjectSync(e,t){const r={};for(const s of t){const{key:a,value:o}=s;if(a.status==="aborted"||o.status==="aborted")return Bt;a.status==="dirty"&&e.dirty(),o.status==="dirty"&&e.dirty(),a.value!=="__proto__"&&(typeof o.value<"u"||s.alwaysSet)&&(r[a.value]=o.value)}return{status:e.value,value:r}}}const Bt=Object.freeze({status:"aborted"}),Wh=n=>({status:"dirty",value:n}),ea=n=>({status:"valid",value:n}),lP=n=>n.status==="aborted",cP=n=>n.status==="dirty",Tf=n=>n.status==="valid",jx=n=>typeof Promise<"u"&&n instanceof Promise;var yt;(function(n){n.errToObj=e=>typeof e=="string"?{message:e}:e||{},n.toString=e=>typeof e=="string"?e:e?.message})(yt||(yt={}));class To{constructor(e,t,r,s){this._cachedPath=[],this.parent=e,this.data=t,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const dP=(n,e)=>{if(Tf(e))return{success:!0,data:e.value};if(!n.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Sl(n.common.issues);return this._error=t,this._error}}};function Gt(n){if(!n)return{};const{errorMap:e,invalid_type_error:t,required_error:r,description:s}=n;if(e&&(t||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(o,l)=>{const{message:c}=n;return o.code==="invalid_enum_value"?{message:c??l.defaultError}:typeof l.data>"u"?{message:c??r??l.defaultError}:o.code!=="invalid_type"?{message:l.defaultError}:{message:c??t??l.defaultError}},description:s}}class sn{get description(){return this._def.description}_getType(e){return Oc(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Oc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ss,ctx:{common:e.parent.common,data:e.data,parsedType:Oc(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(jx(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const r=this.safeParse(e,t);if(r.success)return r.data;throw r.error}safeParse(e,t){const r={common:{issues:[],async:t?.async??!1,contextualErrorMap:t?.errorMap},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oc(e)},s=this._parseSync({data:e,path:r.path,parent:r});return dP(r,s)}"~validate"(e){const t={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oc(e)};if(!this["~standard"].async)try{const r=this._parseSync({data:e,path:[],parent:t});return Tf(r)?{value:r.value}:{issues:t.common.issues}}catch(r){r?.message?.toLowerCase()?.includes("encountered")&&(this["~standard"].async=!0),t.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:t}).then(r=>Tf(r)?{value:r.value}:{issues:t.common.issues})}async parseAsync(e,t){const r=await this.safeParseAsync(e,t);if(r.success)return r.data;throw r.error}async safeParseAsync(e,t){const r={common:{issues:[],contextualErrorMap:t?.errorMap,async:!0},path:t?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Oc(e)},s=this._parse({data:e,path:r.path,parent:r}),a=await(jx(s)?s:Promise.resolve(s));return dP(r,a)}refine(e,t){const r=s=>typeof t=="string"||typeof t>"u"?{message:t}:typeof t=="function"?t(s):t;return this._refinement((s,a)=>{const o=e(s),l=()=>a.addIssue({code:Qe.custom,...r(s)});return typeof Promise<"u"&&o instanceof Promise?o.then(c=>c?!0:(l(),!1)):o?!0:(l(),!1)})}refinement(e,t){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof t=="function"?t(r,s):t),!1))}_refinement(e){return new Mf({schema:this,typeName:Ut.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:t=>this["~validate"](t)}}optional(){return Uc.create(this,this._def)}nullable(){return Ef.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return No.create(this)}promise(){return kx.create(this,this._def)}or(e){return Sx.create([this,e],this._def)}and(e){return Cx.create(this,e,this._def)}transform(e){return new Mf({...Gt(this._def),schema:this,typeName:Ut.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t=typeof e=="function"?e:()=>e;return new uS({...Gt(this._def),innerType:this,defaultValue:t,typeName:Ut.ZodDefault})}brand(){return new p8({typeName:Ut.ZodBranded,type:this,...Gt(this._def)})}catch(e){const t=typeof e=="function"?e:()=>e;return new fS({...Gt(this._def),innerType:this,catchValue:t,typeName:Ut.ZodCatch})}describe(e){const t=this.constructor;return new t({...this._def,description:e})}pipe(e){return _1.create(this,e)}readonly(){return hS.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Y$=/^c[^\s-]{8,}$/i,G$=/^[0-9a-z]+$/,Z$=/^[0-9A-HJKMNP-TV-Z]{26}$/i,K$=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,J$=/^[a-z0-9_-]{21}$/i,Q$=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,X$=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,e8=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,t8="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let fb;const n8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,r8=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,s8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,i8=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,a8=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,o8=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,CF="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",l8=new RegExp(`^${CF}$`);function TF(n){let e="[0-5]\\d";n.precision?e=`${e}\\.\\d{${n.precision}}`:n.precision==null&&(e=`${e}(\\.\\d+)?`);const t=n.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${e})${t}`}function c8(n){return new RegExp(`^${TF(n)}$`)}function d8(n){let e=`${CF}T${TF(n)}`;const t=[];return t.push(n.local?"Z?":"Z"),n.offset&&t.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${t.join("|")})`,new RegExp(`^${e}$`)}function u8(n,e){return!!((e==="v4"||!e)&&n8.test(n)||(e==="v6"||!e)&&s8.test(n))}function f8(n,e){if(!Q$.test(n))return!1;try{const[t]=n.split(".");if(!t)return!1;const r=t.replace(/-/g,"+").replace(/_/g,"/").padEnd(t.length+(4-t.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&s?.typ!=="JWT"||!s.alg||e&&s.alg!==e)}catch{return!1}}function h8(n,e){return!!((e==="v4"||!e)&&r8.test(n)||(e==="v6"||!e)&&i8.test(n))}class wo extends sn{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==ft.string){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.string,received:a.parsedType}),Bt}const r=new Ss;let s;for(const a of this._def.checks)if(a.kind==="min")e.data.length<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="max")e.data.length>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!1,message:a.message}),r.dirty());else if(a.kind==="length"){const o=e.data.length>a.value,l=e.data.length<a.value;(o||l)&&(s=this._getOrReturnCtx(e,s),o?it(s,{code:Qe.too_big,maximum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}):l&&it(s,{code:Qe.too_small,minimum:a.value,type:"string",inclusive:!0,exact:!0,message:a.message}),r.dirty())}else if(a.kind==="email")e8.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"email",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="emoji")fb||(fb=new RegExp(t8,"u")),fb.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"emoji",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="uuid")K$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"uuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="nanoid")J$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"nanoid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid")Y$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="cuid2")G$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cuid2",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="ulid")Z$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ulid",code:Qe.invalid_string,message:a.message}),r.dirty());else if(a.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),it(s,{validation:"url",code:Qe.invalid_string,message:a.message}),r.dirty()}else a.kind==="regex"?(a.regex.lastIndex=0,a.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"regex",code:Qe.invalid_string,message:a.message}),r.dirty())):a.kind==="trim"?e.data=e.data.trim():a.kind==="includes"?e.data.includes(a.value,a.position)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{includes:a.value,position:a.position},message:a.message}),r.dirty()):a.kind==="toLowerCase"?e.data=e.data.toLowerCase():a.kind==="toUpperCase"?e.data=e.data.toUpperCase():a.kind==="startsWith"?e.data.startsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{startsWith:a.value},message:a.message}),r.dirty()):a.kind==="endsWith"?e.data.endsWith(a.value)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:{endsWith:a.value},message:a.message}),r.dirty()):a.kind==="datetime"?d8(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"datetime",message:a.message}),r.dirty()):a.kind==="date"?l8.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"date",message:a.message}),r.dirty()):a.kind==="time"?c8(a).test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.invalid_string,validation:"time",message:a.message}),r.dirty()):a.kind==="duration"?X$.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"duration",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="ip"?u8(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"ip",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="jwt"?f8(e.data,a.alg)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"jwt",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="cidr"?h8(e.data,a.version)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"cidr",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64"?a8.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64",code:Qe.invalid_string,message:a.message}),r.dirty()):a.kind==="base64url"?o8.test(e.data)||(s=this._getOrReturnCtx(e,s),it(s,{validation:"base64url",code:Qe.invalid_string,message:a.message}),r.dirty()):un.assertNever(a);return{status:r.value,value:e.data}}_regex(e,t,r){return this.refinement(s=>e.test(s),{validation:t,code:Qe.invalid_string,...yt.errToObj(r)})}_addCheck(e){return new wo({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...yt.errToObj(e)})}url(e){return this._addCheck({kind:"url",...yt.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...yt.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...yt.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...yt.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...yt.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...yt.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...yt.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...yt.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...yt.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...yt.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...yt.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...yt.errToObj(e)})}datetime(e){return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:e?.offset??!1,local:e?.local??!1,...yt.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...yt.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...yt.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...yt.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:t?.position,...yt.errToObj(t?.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...yt.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...yt.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...yt.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...yt.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...yt.errToObj(t)})}nonempty(e){return this.min(1,yt.errToObj(e))}trim(){return new wo({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new wo({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new wo({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}wo.create=n=>new wo({checks:[],typeName:Ut.ZodString,coerce:n?.coerce??!1,...Gt(n)});function m8(n,e){const t=(n.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=t>r?t:r,a=Number.parseInt(n.toFixed(s).replace(".","")),o=Number.parseInt(e.toFixed(s).replace(".",""));return a%o/10**s}class mu extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==ft.number){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.number,received:a.parsedType}),Bt}let r;const s=new Ss;for(const a of this._def.checks)a.kind==="int"?un.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.invalid_type,expected:"integer",received:"float",message:a.message}),s.dirty()):a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,minimum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,maximum:a.value,type:"number",inclusive:a.inclusive,exact:!1,message:a.message}),s.dirty()):a.kind==="multipleOf"?m8(e.data,a.value)!==0&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):a.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_finite,message:a.message}),s.dirty()):un.assertNever(a);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,yt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,yt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,yt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,yt.toString(t))}setLimit(e,t,r,s){return new mu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:yt.toString(s)}]})}_addCheck(e){return new mu({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:yt.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:yt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:yt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:yt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:yt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:yt.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:yt.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:yt.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:yt.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&un.isInteger(e.value))}get isFinite(){let e=null,t=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(t===null||r.value>t)&&(t=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(t)&&Number.isFinite(e)}}mu.create=n=>new mu({checks:[],typeName:Ut.ZodNumber,coerce:n?.coerce||!1,...Gt(n)});class pu extends sn{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==ft.bigint)return this._getInvalidInput(e);let r;const s=new Ss;for(const a of this._def.checks)a.kind==="min"?(a.inclusive?e.data<a.value:e.data<=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="max"?(a.inclusive?e.data>a.value:e.data>=a.value)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty()):a.kind==="multipleOf"?e.data%a.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),it(r,{code:Qe.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):un.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.bigint,received:t.parsedType}),Bt}gte(e,t){return this.setLimit("min",e,!0,yt.toString(t))}gt(e,t){return this.setLimit("min",e,!1,yt.toString(t))}lte(e,t){return this.setLimit("max",e,!0,yt.toString(t))}lt(e,t){return this.setLimit("max",e,!1,yt.toString(t))}setLimit(e,t,r,s){return new pu({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:r,message:yt.toString(s)}]})}_addCheck(e){return new pu({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:yt.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:yt.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:yt.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:yt.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:yt.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e}}pu.create=n=>new pu({checks:[],typeName:Ut.ZodBigInt,coerce:n?.coerce??!1,...Gt(n)});class Nx extends sn{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==ft.boolean){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.boolean,received:r.parsedType}),Bt}return ea(e.data)}}Nx.create=n=>new Nx({typeName:Ut.ZodBoolean,coerce:n?.coerce||!1,...Gt(n)});class kf extends sn{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==ft.date){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_type,expected:ft.date,received:a.parsedType}),Bt}if(Number.isNaN(e.data.getTime())){const a=this._getOrReturnCtx(e);return it(a,{code:Qe.invalid_date}),Bt}const r=new Ss;let s;for(const a of this._def.checks)a.kind==="min"?e.data.getTime()<a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_small,message:a.message,inclusive:!0,exact:!1,minimum:a.value,type:"date"}),r.dirty()):a.kind==="max"?e.data.getTime()>a.value&&(s=this._getOrReturnCtx(e,s),it(s,{code:Qe.too_big,message:a.message,inclusive:!0,exact:!1,maximum:a.value,type:"date"}),r.dirty()):un.assertNever(a);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new kf({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:yt.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:yt.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)t.kind==="min"&&(e===null||t.value>e)&&(e=t.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)t.kind==="max"&&(e===null||t.value<e)&&(e=t.value);return e!=null?new Date(e):null}}kf.create=n=>new kf({checks:[],coerce:n?.coerce||!1,typeName:Ut.ZodDate,...Gt(n)});class uP extends sn{_parse(e){if(this._getType(e)!==ft.symbol){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.symbol,received:r.parsedType}),Bt}return ea(e.data)}}uP.create=n=>new uP({typeName:Ut.ZodSymbol,...Gt(n)});class fP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.undefined,received:r.parsedType}),Bt}return ea(e.data)}}fP.create=n=>new fP({typeName:Ut.ZodUndefined,...Gt(n)});class hP extends sn{_parse(e){if(this._getType(e)!==ft.null){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.null,received:r.parsedType}),Bt}return ea(e.data)}}hP.create=n=>new hP({typeName:Ut.ZodNull,...Gt(n)});class mP extends sn{constructor(){super(...arguments),this._any=!0}_parse(e){return ea(e.data)}}mP.create=n=>new mP({typeName:Ut.ZodAny,...Gt(n)});class lS extends sn{constructor(){super(...arguments),this._unknown=!0}_parse(e){return ea(e.data)}}lS.create=n=>new lS({typeName:Ut.ZodUnknown,...Gt(n)});class Wc extends sn{_parse(e){const t=this._getOrReturnCtx(e);return it(t,{code:Qe.invalid_type,expected:ft.never,received:t.parsedType}),Bt}}Wc.create=n=>new Wc({typeName:Ut.ZodNever,...Gt(n)});class pP extends sn{_parse(e){if(this._getType(e)!==ft.undefined){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.void,received:r.parsedType}),Bt}return ea(e.data)}}pP.create=n=>new pP({typeName:Ut.ZodVoid,...Gt(n)});class No extends sn{_parse(e){const{ctx:t,status:r}=this._processInputParams(e),s=this._def;if(t.parsedType!==ft.array)return it(t,{code:Qe.invalid_type,expected:ft.array,received:t.parsedType}),Bt;if(s.exactLength!==null){const o=t.data.length>s.exactLength.value,l=t.data.length<s.exactLength.value;(o||l)&&(it(t,{code:o?Qe.too_big:Qe.too_small,minimum:l?s.exactLength.value:void 0,maximum:o?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&t.data.length<s.minLength.value&&(it(t,{code:Qe.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&t.data.length>s.maxLength.value&&(it(t,{code:Qe.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),t.common.async)return Promise.all([...t.data].map((o,l)=>s.type._parseAsync(new To(t,o,t.path,l)))).then(o=>Ss.mergeArray(r,o));const a=[...t.data].map((o,l)=>s.type._parseSync(new To(t,o,t.path,l)));return Ss.mergeArray(r,a)}get element(){return this._def.type}min(e,t){return new No({...this._def,minLength:{value:e,message:yt.toString(t)}})}max(e,t){return new No({...this._def,maxLength:{value:e,message:yt.toString(t)}})}length(e,t){return new No({...this._def,exactLength:{value:e,message:yt.toString(t)}})}nonempty(e){return this.min(1,e)}}No.create=(n,e)=>new No({type:n,minLength:null,maxLength:null,exactLength:null,typeName:Ut.ZodArray,...Gt(e)});function of(n){if(n instanceof yr){const e={};for(const t in n.shape){const r=n.shape[t];e[t]=Uc.create(of(r))}return new yr({...n._def,shape:()=>e})}else return n instanceof No?new No({...n._def,type:of(n.element)}):n instanceof Uc?Uc.create(of(n.unwrap())):n instanceof Ef?Ef.create(of(n.unwrap())):n instanceof gu?gu.create(n.items.map(e=>of(e))):n}class yr extends sn{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),t=un.objectKeys(e);return this._cached={shape:e,keys:t},this._cached}_parse(e){if(this._getType(e)!==ft.object){const d=this._getOrReturnCtx(e);return it(d,{code:Qe.invalid_type,expected:ft.object,received:d.parsedType}),Bt}const{status:r,ctx:s}=this._processInputParams(e),{shape:a,keys:o}=this._getCached(),l=[];if(!(this._def.catchall instanceof Wc&&this._def.unknownKeys==="strip"))for(const d in s.data)o.includes(d)||l.push(d);const c=[];for(const d of o){const h=a[d],p=s.data[d];c.push({key:{status:"valid",value:d},value:h._parse(new To(s,p,s.path,d)),alwaysSet:d in s.data})}if(this._def.catchall instanceof Wc){const d=this._def.unknownKeys;if(d==="passthrough")for(const h of l)c.push({key:{status:"valid",value:h},value:{status:"valid",value:s.data[h]}});else if(d==="strict")l.length>0&&(it(s,{code:Qe.unrecognized_keys,keys:l}),r.dirty());else if(d!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const d=this._def.catchall;for(const h of l){const p=s.data[h];c.push({key:{status:"valid",value:h},value:d._parse(new To(s,p,s.path,h)),alwaysSet:h in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const d=[];for(const h of c){const p=await h.key,x=await h.value;d.push({key:p,value:x,alwaysSet:h.alwaysSet})}return d}).then(d=>Ss.mergeObjectSync(r,d)):Ss.mergeObjectSync(r,c)}get shape(){return this._def.shape()}strict(e){return yt.errToObj,new yr({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(t,r)=>{const s=this._def.errorMap?.(t,r).message??r.defaultError;return t.code==="unrecognized_keys"?{message:yt.errToObj(e).message??s}:{message:s}}}:{}})}strip(){return new yr({...this._def,unknownKeys:"strip"})}passthrough(){return new yr({...this._def,unknownKeys:"passthrough"})}extend(e){return new yr({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new yr({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:Ut.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new yr({...this._def,catchall:e})}pick(e){const t={};for(const r of un.objectKeys(e))e[r]&&this.shape[r]&&(t[r]=this.shape[r]);return new yr({...this._def,shape:()=>t})}omit(e){const t={};for(const r of un.objectKeys(this.shape))e[r]||(t[r]=this.shape[r]);return new yr({...this._def,shape:()=>t})}deepPartial(){return of(this)}partial(e){const t={};for(const r of un.objectKeys(this.shape)){const s=this.shape[r];e&&!e[r]?t[r]=s:t[r]=s.optional()}return new yr({...this._def,shape:()=>t})}required(e){const t={};for(const r of un.objectKeys(this.shape))if(e&&!e[r])t[r]=this.shape[r];else{let a=this.shape[r];for(;a instanceof Uc;)a=a._def.innerType;t[r]=a}return new yr({...this._def,shape:()=>t})}keyof(){return kF(un.objectKeys(this.shape))}}yr.create=(n,e)=>new yr({shape:()=>n,unknownKeys:"strip",catchall:Wc.create(),typeName:Ut.ZodObject,...Gt(e)});yr.strictCreate=(n,e)=>new yr({shape:()=>n,unknownKeys:"strict",catchall:Wc.create(),typeName:Ut.ZodObject,...Gt(e)});yr.lazycreate=(n,e)=>new yr({shape:n,unknownKeys:"strip",catchall:Wc.create(),typeName:Ut.ZodObject,...Gt(e)});class Sx extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=this._def.options;function s(a){for(const l of a)if(l.result.status==="valid")return l.result;for(const l of a)if(l.result.status==="dirty")return t.common.issues.push(...l.ctx.common.issues),l.result;const o=a.map(l=>new Sl(l.ctx.common.issues));return it(t,{code:Qe.invalid_union,unionErrors:o}),Bt}if(t.common.async)return Promise.all(r.map(async a=>{const o={...t,common:{...t.common,issues:[]},parent:null};return{result:await a._parseAsync({data:t.data,path:t.path,parent:o}),ctx:o}})).then(s);{let a;const o=[];for(const c of r){const d={...t,common:{...t.common,issues:[]},parent:null},h=c._parseSync({data:t.data,path:t.path,parent:d});if(h.status==="valid")return h;h.status==="dirty"&&!a&&(a={result:h,ctx:d}),d.common.issues.length&&o.push(d.common.issues)}if(a)return t.common.issues.push(...a.ctx.common.issues),a.result;const l=o.map(c=>new Sl(c));return it(t,{code:Qe.invalid_union,unionErrors:l}),Bt}}get options(){return this._def.options}}Sx.create=(n,e)=>new Sx({options:n,typeName:Ut.ZodUnion,...Gt(e)});function cS(n,e){const t=Oc(n),r=Oc(e);if(n===e)return{valid:!0,data:n};if(t===ft.object&&r===ft.object){const s=un.objectKeys(e),a=un.objectKeys(n).filter(l=>s.indexOf(l)!==-1),o={...n,...e};for(const l of a){const c=cS(n[l],e[l]);if(!c.valid)return{valid:!1};o[l]=c.data}return{valid:!0,data:o}}else if(t===ft.array&&r===ft.array){if(n.length!==e.length)return{valid:!1};const s=[];for(let a=0;a<n.length;a++){const o=n[a],l=e[a],c=cS(o,l);if(!c.valid)return{valid:!1};s.push(c.data)}return{valid:!0,data:s}}else return t===ft.date&&r===ft.date&&+n==+e?{valid:!0,data:n}:{valid:!1}}class Cx extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=(a,o)=>{if(lP(a)||lP(o))return Bt;const l=cS(a.value,o.value);return l.valid?((cP(a)||cP(o))&&t.dirty(),{status:t.value,value:l.data}):(it(r,{code:Qe.invalid_intersection_types}),Bt)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([a,o])=>s(a,o)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Cx.create=(n,e,t)=>new Cx({left:n,right:e,typeName:Ut.ZodIntersection,...Gt(t)});class gu extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.array)return it(r,{code:Qe.invalid_type,expected:ft.array,received:r.parsedType}),Bt;if(r.data.length<this._def.items.length)return it(r,{code:Qe.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Bt;!this._def.rest&&r.data.length>this._def.items.length&&(it(r,{code:Qe.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const a=[...r.data].map((o,l)=>{const c=this._def.items[l]||this._def.rest;return c?c._parse(new To(r,o,r.path,l)):null}).filter(o=>!!o);return r.common.async?Promise.all(a).then(o=>Ss.mergeArray(t,o)):Ss.mergeArray(t,a)}get items(){return this._def.items}rest(e){return new gu({...this._def,rest:e})}}gu.create=(n,e)=>{if(!Array.isArray(n))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new gu({items:n,typeName:Ut.ZodTuple,rest:null,...Gt(e)})};class Tx extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.object)return it(r,{code:Qe.invalid_type,expected:ft.object,received:r.parsedType}),Bt;const s=[],a=this._def.keyType,o=this._def.valueType;for(const l in r.data)s.push({key:a._parse(new To(r,l,r.path,l)),value:o._parse(new To(r,r.data[l],r.path,l)),alwaysSet:l in r.data});return r.common.async?Ss.mergeObjectAsync(t,s):Ss.mergeObjectSync(t,s)}get element(){return this._def.valueType}static create(e,t,r){return t instanceof sn?new Tx({keyType:e,valueType:t,typeName:Ut.ZodRecord,...Gt(r)}):new Tx({keyType:wo.create(),valueType:e,typeName:Ut.ZodRecord,...Gt(t)})}}class gP extends sn{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.map)return it(r,{code:Qe.invalid_type,expected:ft.map,received:r.parsedType}),Bt;const s=this._def.keyType,a=this._def.valueType,o=[...r.data.entries()].map(([l,c],d)=>({key:s._parse(new To(r,l,r.path,[d,"key"])),value:a._parse(new To(r,c,r.path,[d,"value"]))}));if(r.common.async){const l=new Map;return Promise.resolve().then(async()=>{for(const c of o){const d=await c.key,h=await c.value;if(d.status==="aborted"||h.status==="aborted")return Bt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}})}else{const l=new Map;for(const c of o){const d=c.key,h=c.value;if(d.status==="aborted"||h.status==="aborted")return Bt;(d.status==="dirty"||h.status==="dirty")&&t.dirty(),l.set(d.value,h.value)}return{status:t.value,value:l}}}}gP.create=(n,e,t)=>new gP({valueType:e,keyType:n,typeName:Ut.ZodMap,...Gt(t)});class um extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.parsedType!==ft.set)return it(r,{code:Qe.invalid_type,expected:ft.set,received:r.parsedType}),Bt;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(it(r,{code:Qe.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),t.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(it(r,{code:Qe.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),t.dirty());const a=this._def.valueType;function o(c){const d=new Set;for(const h of c){if(h.status==="aborted")return Bt;h.status==="dirty"&&t.dirty(),d.add(h.value)}return{status:t.value,value:d}}const l=[...r.data.values()].map((c,d)=>a._parse(new To(r,c,r.path,d)));return r.common.async?Promise.all(l).then(c=>o(c)):o(l)}min(e,t){return new um({...this._def,minSize:{value:e,message:yt.toString(t)}})}max(e,t){return new um({...this._def,maxSize:{value:e,message:yt.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}um.create=(n,e)=>new um({valueType:n,minSize:null,maxSize:null,typeName:Ut.ZodSet,...Gt(e)});class dS extends sn{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}dS.create=(n,e)=>new dS({getter:n,typeName:Ut.ZodLazy,...Gt(e)});class xP extends sn{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return it(t,{received:t.data,code:Qe.invalid_literal,expected:this._def.value}),Bt}return{status:"valid",value:e.data}}get value(){return this._def.value}}xP.create=(n,e)=>new xP({value:n,typeName:Ut.ZodLiteral,...Gt(e)});function kF(n,e){return new Pf({values:n,typeName:Ut.ZodEnum,...Gt(e)})}class Pf extends sn{_parse(e){if(typeof e.data!="string"){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{expected:un.joinValues(r),received:t.parsedType,code:Qe.invalid_type}),Bt}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(e.data)){const t=this._getOrReturnCtx(e),r=this._def.values;return it(t,{received:t.data,code:Qe.invalid_enum_value,options:r}),Bt}return ea(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Pf.create(e,{...this._def,...t})}exclude(e,t=this._def){return Pf.create(this.options.filter(r=>!e.includes(r)),{...this._def,...t})}}Pf.create=kF;class yP extends sn{_parse(e){const t=un.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==ft.string&&r.parsedType!==ft.number){const s=un.objectValues(t);return it(r,{expected:un.joinValues(s),received:r.parsedType,code:Qe.invalid_type}),Bt}if(this._cache||(this._cache=new Set(un.getValidEnumValues(this._def.values))),!this._cache.has(e.data)){const s=un.objectValues(t);return it(r,{received:r.data,code:Qe.invalid_enum_value,options:s}),Bt}return ea(e.data)}get enum(){return this._def.values}}yP.create=(n,e)=>new yP({values:n,typeName:Ut.ZodNativeEnum,...Gt(e)});class kx extends sn{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==ft.promise&&t.common.async===!1)return it(t,{code:Qe.invalid_type,expected:ft.promise,received:t.parsedType}),Bt;const r=t.parsedType===ft.promise?t.data:Promise.resolve(t.data);return ea(r.then(s=>this._def.type.parseAsync(s,{path:t.path,errorMap:t.common.contextualErrorMap})))}}kx.create=(n,e)=>new kx({type:n,typeName:Ut.ZodPromise,...Gt(e)});class Mf extends sn{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===Ut.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:r}=this._processInputParams(e),s=this._def.effect||null,a={addIssue:o=>{it(r,o),o.fatal?t.abort():t.dirty()},get path(){return r.path}};if(a.addIssue=a.addIssue.bind(a),s.type==="preprocess"){const o=s.transform(r.data,a);if(r.common.async)return Promise.resolve(o).then(async l=>{if(t.value==="aborted")return Bt;const c=await this._def.schema._parseAsync({data:l,path:r.path,parent:r});return c.status==="aborted"?Bt:c.status==="dirty"||t.value==="dirty"?Wh(c.value):c});{if(t.value==="aborted")return Bt;const l=this._def.schema._parseSync({data:o,path:r.path,parent:r});return l.status==="aborted"?Bt:l.status==="dirty"||t.value==="dirty"?Wh(l.value):l}}if(s.type==="refinement"){const o=l=>{const c=s.refinement(l,a);if(r.common.async)return Promise.resolve(c);if(c instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return l};if(r.common.async===!1){const l=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return l.status==="aborted"?Bt:(l.status==="dirty"&&t.dirty(),o(l.value),{status:t.value,value:l.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(l=>l.status==="aborted"?Bt:(l.status==="dirty"&&t.dirty(),o(l.value).then(()=>({status:t.value,value:l.value}))))}if(s.type==="transform")if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Tf(o))return Bt;const l=s.transform(o.value,a);if(l instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:l}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>Tf(o)?Promise.resolve(s.transform(o.value,a)).then(l=>({status:t.value,value:l})):Bt);un.assertNever(s)}}Mf.create=(n,e,t)=>new Mf({schema:n,typeName:Ut.ZodEffects,effect:e,...Gt(t)});Mf.createWithPreprocess=(n,e,t)=>new Mf({schema:e,effect:{type:"preprocess",transform:n},typeName:Ut.ZodEffects,...Gt(t)});class Uc extends sn{_parse(e){return this._getType(e)===ft.undefined?ea(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Uc.create=(n,e)=>new Uc({innerType:n,typeName:Ut.ZodOptional,...Gt(e)});class Ef extends sn{_parse(e){return this._getType(e)===ft.null?ea(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Ef.create=(n,e)=>new Ef({innerType:n,typeName:Ut.ZodNullable,...Gt(e)});class uS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e);let r=t.data;return t.parsedType===ft.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}uS.create=(n,e)=>new uS({innerType:n,typeName:Ut.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...Gt(e)});class fS extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r={...t,common:{...t.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return jx(s)?s.then(a=>({status:"valid",value:a.status==="valid"?a.value:this._def.catchValue({get error(){return new Sl(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Sl(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}fS.create=(n,e)=>new fS({innerType:n,typeName:Ut.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...Gt(e)});class vP extends sn{_parse(e){if(this._getType(e)!==ft.nan){const r=this._getOrReturnCtx(e);return it(r,{code:Qe.invalid_type,expected:ft.nan,received:r.parsedType}),Bt}return{status:"valid",value:e.data}}}vP.create=n=>new vP({typeName:Ut.ZodNaN,...Gt(n)});class p8 extends sn{_parse(e){const{ctx:t}=this._processInputParams(e),r=t.data;return this._def.type._parse({data:r,path:t.path,parent:t})}unwrap(){return this._def.type}}class _1 extends sn{_parse(e){const{status:t,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const a=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return a.status==="aborted"?Bt:a.status==="dirty"?(t.dirty(),Wh(a.value)):this._def.out._parseAsync({data:a.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?Bt:s.status==="dirty"?(t.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,t){return new _1({in:e,out:t,typeName:Ut.ZodPipeline})}}class hS extends sn{_parse(e){const t=this._def.innerType._parse(e),r=s=>(Tf(s)&&(s.value=Object.freeze(s.value)),s);return jx(t)?t.then(s=>r(s)):r(t)}unwrap(){return this._def.innerType}}hS.create=(n,e)=>new hS({innerType:n,typeName:Ut.ZodReadonly,...Gt(e)});var Ut;(function(n){n.ZodString="ZodString",n.ZodNumber="ZodNumber",n.ZodNaN="ZodNaN",n.ZodBigInt="ZodBigInt",n.ZodBoolean="ZodBoolean",n.ZodDate="ZodDate",n.ZodSymbol="ZodSymbol",n.ZodUndefined="ZodUndefined",n.ZodNull="ZodNull",n.ZodAny="ZodAny",n.ZodUnknown="ZodUnknown",n.ZodNever="ZodNever",n.ZodVoid="ZodVoid",n.ZodArray="ZodArray",n.ZodObject="ZodObject",n.ZodUnion="ZodUnion",n.ZodDiscriminatedUnion="ZodDiscriminatedUnion",n.ZodIntersection="ZodIntersection",n.ZodTuple="ZodTuple",n.ZodRecord="ZodRecord",n.ZodMap="ZodMap",n.ZodSet="ZodSet",n.ZodFunction="ZodFunction",n.ZodLazy="ZodLazy",n.ZodLiteral="ZodLiteral",n.ZodEnum="ZodEnum",n.ZodEffects="ZodEffects",n.ZodNativeEnum="ZodNativeEnum",n.ZodOptional="ZodOptional",n.ZodNullable="ZodNullable",n.ZodDefault="ZodDefault",n.ZodCatch="ZodCatch",n.ZodPromise="ZodPromise",n.ZodBranded="ZodBranded",n.ZodPipeline="ZodPipeline",n.ZodReadonly="ZodReadonly"})(Ut||(Ut={}));const $d=wo.create,bP=mu.create;pu.create;const g8=Nx.create;kf.create;const wP=lS.create;Wc.create;const $h=No.create,x8=yr.create,y8=Sx.create;Cx.create;gu.create;const v8=Tx.create,b8=dS.create,w8=Pf.create;kx.create;Uc.create;Ef.create;const Qu={string:(n=>wo.create({...n,coerce:!0})),number:(n=>mu.create({...n,coerce:!0})),boolean:(n=>Nx.create({...n,coerce:!0})),bigint:(n=>pu.create({...n,coerce:!0})),date:(n=>kf.create({...n,coerce:!0}))};let _8,j8;function N8(){return{geminiUrl:_8,vertexUrl:j8}}function S8(n,e,t){var r,s,a;if(!(!((r=n.httpOptions)===null||r===void 0)&&r.baseUrl)){const o=N8();return n.vertexai?(s=o.vertexUrl)!==null&&s!==void 0?s:e:(a=o.geminiUrl)!==null&&a!==void 0?a:t}return n.httpOptions.baseUrl}class Dm{}function Ft(n,e){const t=/\{([^}]+)\}/g;return n.replace(t,(r,s)=>{if(Object.prototype.hasOwnProperty.call(e,s)){const a=e[s];return a!=null?String(a):""}else throw new Error(`Key '${s}' not found in valueMap.`)})}function S(n,e,t){for(let a=0;a<e.length-1;a++){const o=e[a];if(o.endsWith("[]")){const l=o.slice(0,-2);if(!(l in n))if(Array.isArray(t))n[l]=Array.from({length:t.length},()=>({}));else throw new Error(`Value must be a list given an array path ${o}`);if(Array.isArray(n[l])){const c=n[l];if(Array.isArray(t))for(let d=0;d<c.length;d++){const h=c[d];S(h,e.slice(a+1),t[d])}else for(const d of c)S(d,e.slice(a+1),t)}return}else if(o.endsWith("[0]")){const l=o.slice(0,-3);l in n||(n[l]=[{}]);const c=n[l];S(c[0],e.slice(a+1),t);return}(!n[o]||typeof n[o]!="object")&&(n[o]={}),n=n[o]}const r=e[e.length-1],s=n[r];if(s!==void 0){if(!t||typeof t=="object"&&Object.keys(t).length===0||t===s)return;if(typeof s=="object"&&typeof t=="object"&&s!==null&&t!==null)Object.assign(s,t);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else n[r]=t}function N(n,e){try{if(e.length===1&&e[0]==="_self")return n;for(let t=0;t<e.length;t++){if(typeof n!="object"||n===null)return;const r=e[t];if(r.endsWith("[]")){const s=r.slice(0,-2);if(s in n){const a=n[s];return Array.isArray(a)?a.map(o=>N(o,e.slice(t+1))):void 0}else return}else n=n[r]}return n}catch(t){if(t instanceof TypeError)return;throw t}}var _P;(function(n){n.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",n.OUTCOME_OK="OUTCOME_OK",n.OUTCOME_FAILED="OUTCOME_FAILED",n.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(_P||(_P={}));var jP;(function(n){n.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",n.PYTHON="PYTHON"})(jP||(jP={}));var NP;(function(n){n.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",n.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",n.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",n.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",n.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",n.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY"})(NP||(NP={}));var SP;(function(n){n.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",n.SEVERITY="SEVERITY",n.PROBABILITY="PROBABILITY"})(SP||(SP={}));var CP;(function(n){n.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE",n.OFF="OFF"})(CP||(CP={}));var Xe;(function(n){n.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",n.STRING="STRING",n.NUMBER="NUMBER",n.INTEGER="INTEGER",n.BOOLEAN="BOOLEAN",n.ARRAY="ARRAY",n.OBJECT="OBJECT"})(Xe||(Xe={}));var TP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(TP||(TP={}));var kP;(function(n){n.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",n.NO_AUTH="NO_AUTH",n.API_KEY_AUTH="API_KEY_AUTH",n.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",n.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",n.OAUTH="OAUTH",n.OIDC_AUTH="OIDC_AUTH"})(kP||(kP={}));var PP;(function(n){n.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",n.STOP="STOP",n.MAX_TOKENS="MAX_TOKENS",n.SAFETY="SAFETY",n.RECITATION="RECITATION",n.LANGUAGE="LANGUAGE",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT",n.SPII="SPII",n.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",n.IMAGE_SAFETY="IMAGE_SAFETY"})(PP||(PP={}));var MP;(function(n){n.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",n.NEGLIGIBLE="NEGLIGIBLE",n.LOW="LOW",n.MEDIUM="MEDIUM",n.HIGH="HIGH"})(MP||(MP={}));var EP;(function(n){n.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",n.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",n.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",n.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",n.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(EP||(EP={}));var DP;(function(n){n.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",n.SAFETY="SAFETY",n.OTHER="OTHER",n.BLOCKLIST="BLOCKLIST",n.PROHIBITED_CONTENT="PROHIBITED_CONTENT"})(DP||(DP={}));var OP;(function(n){n.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",n.ON_DEMAND="ON_DEMAND",n.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(OP||(OP={}));var fm;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.AUDIO="AUDIO"})(fm||(fm={}));var IP;(function(n){n.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",n.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",n.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",n.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(IP||(IP={}));var mS;(function(n){n.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",n.JOB_STATE_QUEUED="JOB_STATE_QUEUED",n.JOB_STATE_PENDING="JOB_STATE_PENDING",n.JOB_STATE_RUNNING="JOB_STATE_RUNNING",n.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",n.JOB_STATE_FAILED="JOB_STATE_FAILED",n.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",n.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",n.JOB_STATE_PAUSED="JOB_STATE_PAUSED",n.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",n.JOB_STATE_UPDATING="JOB_STATE_UPDATING",n.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(mS||(mS={}));var AP;(function(n){n.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",n.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",n.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",n.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",n.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",n.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",n.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(AP||(AP={}));var RP;(function(n){n.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",n.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",n.BALANCED="BALANCED",n.PRIORITIZE_COST="PRIORITIZE_COST"})(RP||(RP={}));var LP;(function(n){n.UNSPECIFIED="UNSPECIFIED",n.BLOCKING="BLOCKING",n.NON_BLOCKING="NON_BLOCKING"})(LP||(LP={}));var FP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.MODE_DYNAMIC="MODE_DYNAMIC"})(FP||(FP={}));var qP;(function(n){n.MODE_UNSPECIFIED="MODE_UNSPECIFIED",n.AUTO="AUTO",n.ANY="ANY",n.NONE="NONE"})(qP||(qP={}));var zP;(function(n){n.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",n.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",n.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(zP||(zP={}));var UP;(function(n){n.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",n.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",n.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",n.BLOCK_NONE="BLOCK_NONE"})(UP||(UP={}));var BP;(function(n){n.DONT_ALLOW="DONT_ALLOW",n.ALLOW_ADULT="ALLOW_ADULT",n.ALLOW_ALL="ALLOW_ALL"})(BP||(BP={}));var VP;(function(n){n.auto="auto",n.en="en",n.ja="ja",n.ko="ko",n.hi="hi"})(VP||(VP={}));var WP;(function(n){n.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",n.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",n.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",n.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",n.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(WP||(WP={}));var $P;(function(n){n.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",n.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",n.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",n.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})($P||($P={}));var HP;(function(n){n.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",n.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",n.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",n.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(HP||(HP={}));var YP;(function(n){n.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",n.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",n.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",n.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",n.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",n.EDIT_MODE_STYLE="EDIT_MODE_STYLE",n.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",n.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(YP||(YP={}));var GP;(function(n){n.STATE_UNSPECIFIED="STATE_UNSPECIFIED",n.PROCESSING="PROCESSING",n.ACTIVE="ACTIVE",n.FAILED="FAILED"})(GP||(GP={}));var ZP;(function(n){n.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",n.UPLOADED="UPLOADED",n.GENERATED="GENERATED"})(ZP||(ZP={}));var KP;(function(n){n.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",n.TEXT="TEXT",n.IMAGE="IMAGE",n.VIDEO="VIDEO",n.AUDIO="AUDIO",n.DOCUMENT="DOCUMENT"})(KP||(KP={}));var JP;(function(n){n.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",n.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",n.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(JP||(JP={}));var QP;(function(n){n.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",n.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",n.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})(QP||(QP={}));var XP;(function(n){n.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",n.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",n.NO_INTERRUPTION="NO_INTERRUPTION"})(XP||(XP={}));var eM;(function(n){n.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",n.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",n.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(eM||(eM={}));var tM;(function(n){n.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",n.SILENT="SILENT",n.WHEN_IDLE="WHEN_IDLE",n.INTERRUPT="INTERRUPT"})(tM||(tM={}));var nM;(function(n){n.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",n.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",n.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",n.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",n.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",n.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",n.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",n.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",n.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",n.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",n.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",n.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",n.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(nM||(nM={}));var rM;(function(n){n.MUSIC_GENERATION_MODE_UNSPECIFIED="MUSIC_GENERATION_MODE_UNSPECIFIED",n.QUALITY="QUALITY",n.DIVERSITY="DIVERSITY"})(rM||(rM={}));var cf;(function(n){n.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",n.PLAY="PLAY",n.PAUSE="PAUSE",n.STOP="STOP",n.RESET_CONTEXT="RESET_CONTEXT"})(cf||(cf={}));class wh{get text(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let d="",h=!1;const p=[];for(const x of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[y,_]of Object.entries(x))y!=="text"&&y!=="thought"&&(_!==null||_!==void 0)&&p.push(y);if(typeof x.text=="string"){if(typeof x.thought=="boolean"&&x.thought)continue;h=!0,d+=x.text}}return p.length>0&&console.warn(`there are non-text parts ${p} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),h?d:void 0}get data(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let d="";const h=[];for(const p of(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)!==null&&c!==void 0?c:[]){for(const[x,y]of Object.entries(p))x!=="inlineData"&&(y!==null||y!==void 0)&&h.push(x);p.inlineData&&typeof p.inlineData.data=="string"&&(d+=atob(p.inlineData.data))}return h.length>0&&console.warn(`there are non-data parts ${h} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),d.length>0?btoa(d):void 0}get functionCalls(){var e,t,r,s,a,o,l,c;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const d=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(h=>h.functionCall).map(h=>h.functionCall).filter(h=>h!==void 0);if(d?.length!==0)return d}get executableCode(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.executableCode).map(p=>p.executableCode).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.code}get codeExecutionResult(){var e,t,r,s,a,o,l,c,d;if(((s=(r=(t=(e=this.candidates)===null||e===void 0?void 0:e[0])===null||t===void 0?void 0:t.content)===null||r===void 0?void 0:r.parts)===null||s===void 0?void 0:s.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const h=(c=(l=(o=(a=this.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content)===null||l===void 0?void 0:l.parts)===null||c===void 0?void 0:c.filter(p=>p.codeExecutionResult).map(p=>p.codeExecutionResult).filter(p=>p!==void 0);if(h?.length!==0)return(d=h?.[0])===null||d===void 0?void 0:d.output}}class sM{}class iM{}class C8{}class T8{}class aM{}class oM{}class lM{}class k8{}class cM{}class dM{}class uM{}class P8{}class pS{constructor(e){const t={};for(const r of e.headers.entries())t[r[0]]=r[1];this.headers=t,this.responseInternal=e}json(){return this.responseInternal.json()}}class M8{}class E8{}class D8{get text(){var e,t,r;let s="",a=!1;const o=[];for(const l of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[c,d]of Object.entries(l))c!=="text"&&c!=="thought"&&d!==null&&o.push(c);if(typeof l.text=="string"){if(typeof l.thought=="boolean"&&l.thought)continue;a=!0,s+=l.text}}return o.length>0&&console.warn(`there are non-text parts ${o} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),a?s:void 0}get data(){var e,t,r;let s="";const a=[];for(const o of(r=(t=(e=this.serverContent)===null||e===void 0?void 0:e.modelTurn)===null||t===void 0?void 0:t.parts)!==null&&r!==void 0?r:[]){for(const[l,c]of Object.entries(o))l!=="inlineData"&&c!==null&&a.push(l);o.inlineData&&typeof o.inlineData.data=="string"&&(s+=atob(o.inlineData.data))}return a.length>0&&console.warn(`there are non-data parts ${a} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),s.length>0?btoa(s):void 0}}class O8{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}function Wn(n,e){if(!e||typeof e!="string")throw new Error("model is required and must be a string");if(n.isVertexAI()){if(e.startsWith("publishers/")||e.startsWith("projects/")||e.startsWith("models/"))return e;if(e.indexOf("/")>=0){const t=e.split("/",2);return`publishers/${t[0]}/models/${t[1]}`}else return`publishers/google/models/${e}`}else return e.startsWith("models/")||e.startsWith("tunedModels/")?e:`models/${e}`}function PF(n,e){const t=Wn(n,e);return t?t.startsWith("publishers/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}`:t.startsWith("models/")&&n.isVertexAI()?`projects/${n.getProject()}/locations/${n.getLocation()}/publishers/google/${t}`:t:""}function MF(n,e){return Array.isArray(e)?e.map(t=>Px(n,t)):[Px(n,e)]}function Px(n,e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function I8(n,e){const t=Px(n,e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function A8(n,e){const t=Px(n,e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function fM(n,e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function EF(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>fM(n,t)):[fM(n,e)]}function gS(n){return n!=null&&typeof n=="object"&&"parts"in n&&Array.isArray(n.parts)}function hM(n){return n!=null&&typeof n=="object"&&"functionCall"in n}function mM(n){return n!=null&&typeof n=="object"&&"functionResponse"in n}function Hs(n,e){if(e==null)throw new Error("ContentUnion is required");return gS(e)?e:{role:"user",parts:EF(n,e)}}function DF(n,e){if(!e)return[];if(n.isVertexAI()&&Array.isArray(e))return e.flatMap(t=>{const r=Hs(n,t);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(n.isVertexAI()){const t=Hs(n,e);return t.parts&&t.parts.length>0&&t.parts[0].text!==void 0?[t.parts[0].text]:[]}return Array.isArray(e)?e.map(t=>Hs(n,t)):[Hs(n,e)]}function Ea(n,e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(hM(e)||mM(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[Hs(n,e)]}const t=[],r=[],s=gS(e[0]);for(const a of e){const o=gS(a);if(o!=s)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(o)t.push(a);else{if(hM(a)||mM(a))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");r.push(a)}}return s||t.push({role:"user",parts:EF(n,r)}),t}const pM=w8(["string","number","integer","object","array","boolean","null"]),R8=y8([pM,$h(pM)]);function L8(n=!0){const e=b8(()=>{const t=x8({type:R8.optional(),format:$d().optional(),title:$d().optional(),description:$d().optional(),default:wP().optional(),items:e.optional(),minItems:Qu.string().optional(),maxItems:Qu.string().optional(),enum:$h(wP()).optional(),properties:v8($d(),e).optional(),required:$h($d()).optional(),minProperties:Qu.string().optional(),maxProperties:Qu.string().optional(),propertyOrdering:$h($d()).optional(),minimum:bP().optional(),maximum:bP().optional(),minLength:Qu.string().optional(),maxLength:Qu.string().optional(),pattern:$d().optional(),anyOf:$h(e).optional(),additionalProperties:g8().optional()});return n?t.strict():t});return e}function F8(n,e){n.includes("null")&&(e.nullable=!0);const t=n.filter(r=>r!=="null");if(t.length===1)e.type=Object.keys(Xe).includes(t[0].toUpperCase())?Xe[t[0].toUpperCase()]:Xe.TYPE_UNSPECIFIED;else{e.anyOf=[];for(const r of t)e.anyOf.push({type:Object.keys(Xe).includes(r.toUpperCase())?Xe[r.toUpperCase()]:Xe.TYPE_UNSPECIFIED})}}function Xh(n){const e={},t=["items"],r=["anyOf"],s=["properties"];if(n.type&&n.anyOf)throw new Error("type and anyOf cannot be both populated.");const a=n.anyOf;a!=null&&a.length==2&&(a[0].type==="null"?(e.nullable=!0,n=a[1]):a[1].type==="null"&&(e.nullable=!0,n=a[0])),n.type instanceof Array&&F8(n.type,e);for(const[o,l]of Object.entries(n))if(l!=null)if(o=="type"){if(l==="null")throw new Error("type: null can not be the only possible type for the field.");if(l instanceof Array)continue;e.type=Object.keys(Xe).includes(l.toUpperCase())?l.toUpperCase():Xe.TYPE_UNSPECIFIED}else if(t.includes(o))e[o]=Xh(l);else if(r.includes(o)){const c=[];for(const d of l){if(d.type=="null"){e.nullable=!0;continue}c.push(Xh(d))}e[o]=c}else if(s.includes(o)){const c={};for(const[d,h]of Object.entries(l))c[d]=Xh(h);e[o]=c}else{if(o==="additionalProperties")continue;e[o]=l}return e}function Mx(n,e){if(Object.keys(e).includes("$schema")){delete e.$schema;const t=L8().parse(e);return Xh(t)}else return Xh(e)}function OF(n,e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function IF(n,e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function ny(n,e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(t.parameters=Mx(n,t.parameters)),t.response&&(t.response=Mx(n,t.response));return e}function ry(n,e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const r of e)t.push(r);return t}function q8(n,e,t,r=1){const s=!e.startsWith(`${t}/`)&&e.split("/").length===r;return n.isVertexAI()?e.startsWith("projects/")?e:e.startsWith("locations/")?`projects/${n.getProject()}/${e}`:e.startsWith(`${t}/`)?`projects/${n.getProject()}/locations/${n.getLocation()}/${e}`:s?`projects/${n.getProject()}/locations/${n.getLocation()}/${t}/${e}`:e:s?`${t}/${e}`:e}function Jc(n,e){if(typeof e!="string")throw new Error("name must be a string");return q8(n,e,"cachedContents")}function AF(n,e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function Qc(n,e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}function z8(n){return n!=null&&typeof n=="object"&&"name"in n}function U8(n){return n!=null&&typeof n=="object"&&"video"in n}function B8(n){return n!=null&&typeof n=="object"&&"uri"in n}function RF(n,e){var t;let r;if(z8(e)&&(r=e.name),!(B8(e)&&(r=e.uri,r===void 0))&&!(U8(e)&&(r=(t=e.video)===null||t===void 0?void 0:t.uri,r===void 0))){if(typeof e=="string"&&(r=e),r===void 0)throw new Error("Could not extract file name from the provided input.");if(r.startsWith("https://")){const a=r.split("files/")[1].match(/[a-z0-9]+/);if(a===null)throw new Error(`Could not extract file name from URI ${r}`);r=a[0]}else r.startsWith("files/")&&(r=r.split("files/")[1]);return r}}function LF(n,e){let t;return n.isVertexAI()?t=e?"publishers/google/models":"models":t=e?"models":"tunedModels",t}function FF(n,e){for(const t of["models","tunedModels","publisherModels"])if(V8(e,t))return e[t];return[]}function V8(n,e){return n!==null&&typeof n=="object"&&e in n}function W8(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function $8(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function H8(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],W8(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],$8(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function gM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>H8(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function Y8(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function G8(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function Z8(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],G8(n,r)),t}function K8(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function J8(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],K8(n,r)),t}function Q8(){return{}}function X8(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Y8(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],Z8(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],J8(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],Q8());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function eH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function tH(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function nH(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],tH(n,r)),t}function rH(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],eH(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],nH(n,s)),t}function sH(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let p=Ea(n,l);Array.isArray(p)&&(p=p.map(x=>gM(n,x))),S(t,["contents"],p)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],gM(n,Hs(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let p=d;Array.isArray(p)&&(p=p.map(x=>X8(n,x))),S(t,["tools"],p)}const h=N(e,["toolConfig"]);if(t!==void 0&&h!=null&&S(t,["toolConfig"],rH(n,h)),N(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return r}function iH(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],PF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],sH(n,s,t)),t}function aH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function oH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function lH(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function cH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],lH(n,s,t)),t}function dH(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function uH(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],dH(n,r,t)),t}function fH(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function hH(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function mH(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],fH(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],hH(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function xM(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>mH(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function pH(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function gH(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function xH(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],gH(n,r)),t}function yH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function vH(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],yH(n,r)),t}function bH(){return{}}function wH(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function _H(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],wH(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function jH(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],_H(n,r)),t}function NH(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>pH(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],xH(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],vH(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],bH());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],jH(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function SH(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function CH(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function TH(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],CH(n,r)),t}function kH(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],SH(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],TH(n,s)),t}function PH(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);t!==void 0&&a!=null&&S(t,["expireTime"],a);const o=N(e,["displayName"]);t!==void 0&&o!=null&&S(t,["displayName"],o);const l=N(e,["contents"]);if(t!==void 0&&l!=null){let x=Ea(n,l);Array.isArray(x)&&(x=x.map(y=>xM(n,y))),S(t,["contents"],x)}const c=N(e,["systemInstruction"]);t!==void 0&&c!=null&&S(t,["systemInstruction"],xM(n,Hs(n,c)));const d=N(e,["tools"]);if(t!==void 0&&d!=null){let x=d;Array.isArray(x)&&(x=x.map(y=>NH(n,y))),S(t,["tools"],x)}const h=N(e,["toolConfig"]);t!==void 0&&h!=null&&S(t,["toolConfig"],kH(n,h));const p=N(e,["kmsKeyName"]);return t!==void 0&&p!=null&&S(t,["encryption_spec","kmsKeyName"],p),r}function MH(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],PF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],PH(n,s,t)),t}function EH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function DH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function OH(n,e,t){const r={},s=N(e,["ttl"]);t!==void 0&&s!=null&&S(t,["ttl"],s);const a=N(e,["expireTime"]);return t!==void 0&&a!=null&&S(t,["expireTime"],a),r}function IH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],Jc(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],OH(n,s,t)),t}function AH(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function RH(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],AH(n,r,t)),t}function ax(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function LH(){return{}}function FH(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>ax(n,o))),S(t,["cachedContents"],a)}return t}function ox(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["model"]);a!=null&&S(t,["model"],a);const o=N(e,["createTime"]);o!=null&&S(t,["createTime"],o);const l=N(e,["updateTime"]);l!=null&&S(t,["updateTime"],l);const c=N(e,["expireTime"]);c!=null&&S(t,["expireTime"],c);const d=N(e,["usageMetadata"]);return d!=null&&S(t,["usageMetadata"],d),t}function qH(){return{}}function zH(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["cachedContents"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>ox(n,o))),S(t,["cachedContents"],a)}return t}var Df;(function(n){n.PAGED_ITEM_BATCH_JOBS="batchJobs",n.PAGED_ITEM_MODELS="models",n.PAGED_ITEM_TUNING_JOBS="tuningJobs",n.PAGED_ITEM_FILES="files",n.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Df||(Df={}));class sy{constructor(e,t,r,s){this.pageInternal=[],this.paramsInternal={},this.requestInternal=t,this.init(e,r,s)}init(e,t,r){var s,a;this.nameInternal=e,this.pageInternal=t[this.nameInternal]||[],this.idxInternal=0;let o={config:{}};r?typeof r=="object"?o=Object.assign({},r):o=r:o={config:{}},o.config&&(o.config.pageToken=t.nextPageToken),this.paramsInternal=o,this.pageInternalSize=(a=(s=o.config)===null||s===void 0?void 0:s.pageSize)!==null&&a!==void 0?a:this.pageInternal.length}initNextPage(e){this.init(this.nameInternal,e,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(e){return this.pageInternal[e]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const e=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:e,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const e=await this.requestInternal(this.params);return this.initNextPage(e),this.page}hasNextPage(){var e;return((e=this.params.config)===null||e===void 0?void 0:e.pageToken)!==void 0}}class UH extends Dm{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new sy(Df.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(t),t)}async create(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=MH(this.apiClient,e);return l=Ft("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ox(this.apiClient,h))}else{const d=iH(this.apiClient,e);return l=Ft("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=EH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ox(this.apiClient,h))}else{const d=aH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=DH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=qH(),p=new dM;return Object.assign(p,h),p})}else{const d=oH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=LH(),p=new dM;return Object.assign(p,h),p})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=IH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>ox(this.apiClient,h))}else{const d=cH(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>ax(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=RH(this.apiClient,e);return l=Ft("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=zH(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}else{const d=uH(this.apiClient,e);return l=Ft("cachedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=FH(this.apiClient,h),x=new uM;return Object.assign(x,p),x})}}}function yM(n){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&n[e],r=0;if(t)return t.call(n);if(n&&typeof n.length=="number")return{next:function(){return n&&r>=n.length&&(n=void 0),{value:n&&n[r++],done:!n}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Jn(n){return this instanceof Jn?(this.v=n,this):new Jn(n)}function em(n,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=t.apply(n,e||[]),s,a=[];return s=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),l("next"),l("throw"),l("return",o),s[Symbol.asyncIterator]=function(){return this},s;function o(y){return function(_){return Promise.resolve(_).then(y,p)}}function l(y,_){r[y]&&(s[y]=function(w){return new Promise(function(j,C){a.push([y,w,j,C])>1||c(y,w)})},_&&(s[y]=_(s[y])))}function c(y,_){try{d(r[y](_))}catch(w){x(a[0][3],w)}}function d(y){y.value instanceof Jn?Promise.resolve(y.value.v).then(h,p):x(a[0][2],y)}function h(y){c("next",y)}function p(y){c("throw",y)}function x(y,_){y(_),a.shift(),a.length&&c(a[0][0],a[0][1])}}function lx(n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=n[Symbol.asyncIterator],t;return e?e.call(n):(n=typeof yM=="function"?yM(n):n[Symbol.iterator](),t={},r("next"),r("throw"),r("return"),t[Symbol.asyncIterator]=function(){return this},t);function r(a){t[a]=n[a]&&function(o){return new Promise(function(l,c){o=n[a](o),s(l,c,o.done,o.value)})}}function s(a,o,l,c){Promise.resolve(c).then(function(d){a({value:d,done:l})},o)}}function BH(n){var e;if(n.candidates==null||n.candidates.length===0)return!1;const t=(e=n.candidates[0])===null||e===void 0?void 0:e.content;return t===void 0?!1:qF(t)}function qF(n){if(n.parts===void 0||n.parts.length===0)return!1;for(const e of n.parts)if(e===void 0||Object.keys(e).length===0||!e.thought&&e.text!==void 0&&e.text==="")return!1;return!0}function VH(n){if(n.length!==0){for(const e of n)if(e.role!=="user"&&e.role!=="model")throw new Error(`Role must be user or model, but got ${e.role}.`)}}function vM(n){if(n===void 0||n.length===0)return[];const e=[],t=n.length;let r=0;for(;r<t;)if(n[r].role==="user")e.push(n[r]),r++;else{const s=[];let a=!0;for(;r<t&&n[r].role==="model";)s.push(n[r]),a&&!qF(n[r])&&(a=!1),r++;a?e.push(...s):e.pop()}return e}class WH{constructor(e,t){this.modelsModule=e,this.apiClient=t}create(e){return new $H(this.apiClient,this.modelsModule,e.model,e.config,structuredClone(e.history))}}class $H{constructor(e,t,r,s={},a=[]){this.apiClient=e,this.modelsModule=t,this.model=r,this.config=s,this.history=a,this.sendPromise=Promise.resolve(),VH(a)}async sendMessage(e){var t;await this.sendPromise;const r=Hs(this.apiClient,e.message),s=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});return this.sendPromise=(async()=>{var a,o,l;const c=await s,d=(o=(a=c.candidates)===null||a===void 0?void 0:a[0])===null||o===void 0?void 0:o.content,h=c.automaticFunctionCallingHistory,p=this.getHistory(!0).length;let x=[];h!=null&&(x=(l=h.slice(p))!==null&&l!==void 0?l:[]);const y=d?[d]:[];this.recordHistory(r,y,x)})(),await this.sendPromise,s}async sendMessageStream(e){var t;await this.sendPromise;const r=Hs(this.apiClient,e.message),s=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(t=e.config)!==null&&t!==void 0?t:this.config});this.sendPromise=s.then(()=>{}).catch(()=>{});const a=await s;return this.processStreamResponse(a,r)}getHistory(e=!1){const t=e?vM(this.history):this.history;return structuredClone(t)}processStreamResponse(e,t){var r,s;return em(this,arguments,function*(){var o,l,c,d;const h=[];try{for(var p=!0,x=lx(e),y;y=yield Jn(x.next()),o=y.done,!o;p=!0){d=y.value,p=!1;const _=d;if(BH(_)){const w=(s=(r=_.candidates)===null||r===void 0?void 0:r[0])===null||s===void 0?void 0:s.content;w!==void 0&&h.push(w)}yield yield Jn(_)}}catch(_){l={error:_}}finally{try{!p&&!o&&(c=x.return)&&(yield Jn(c.call(x)))}finally{if(l)throw l.error}}this.recordHistory(t,h)})}recordHistory(e,t,r){let s=[];t.length>0&&t.every(a=>a.role!==void 0)?s=t:s.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...vM(r)):this.history.push(e),this.history.push(...s)}}function HH(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);return t!==void 0&&a!=null&&S(t,["_query","pageToken"],a),r}function YH(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],HH(n,r,t)),t}function GH(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function ZH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const y=N(e,["state"]);y!=null&&S(t,["state"],y);const _=N(e,["source"]);_!=null&&S(t,["source"],_);const w=N(e,["videoMetadata"]);w!=null&&S(t,["videoMetadata"],w);const j=N(e,["error"]);return j!=null&&S(t,["error"],GH(n,j)),t}function KH(n,e){const t={},r=N(e,["file"]);r!=null&&S(t,["file"],ZH(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function JH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],RF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function QH(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","file"],RF(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function XH(n,e){const t={},r=N(e,["details"]);r!=null&&S(t,["details"],r);const s=N(e,["message"]);s!=null&&S(t,["message"],s);const a=N(e,["code"]);return a!=null&&S(t,["code"],a),t}function xS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["mimeType"]);a!=null&&S(t,["mimeType"],a);const o=N(e,["sizeBytes"]);o!=null&&S(t,["sizeBytes"],o);const l=N(e,["createTime"]);l!=null&&S(t,["createTime"],l);const c=N(e,["expirationTime"]);c!=null&&S(t,["expirationTime"],c);const d=N(e,["updateTime"]);d!=null&&S(t,["updateTime"],d);const h=N(e,["sha256Hash"]);h!=null&&S(t,["sha256Hash"],h);const p=N(e,["uri"]);p!=null&&S(t,["uri"],p);const x=N(e,["downloadUri"]);x!=null&&S(t,["downloadUri"],x);const y=N(e,["state"]);y!=null&&S(t,["state"],y);const _=N(e,["source"]);_!=null&&S(t,["source"],_);const w=N(e,["videoMetadata"]);w!=null&&S(t,["videoMetadata"],w);const j=N(e,["error"]);return j!=null&&S(t,["error"],XH(n,j)),t}function e9(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["files"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>xS(n,o))),S(t,["files"],a)}return t}function t9(){return{}}function n9(){return{}}let r9=class extends Dm{constructor(e){super(),this.apiClient=e,this.list=async(t={})=>new sy(Df.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(t),t)}async upload(e){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(e.file,e.config).then(t=>xS(this.apiClient,t))}async download(e){await this.apiClient.downloadFile(e)}async listInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=YH(this.apiClient,e);return a=Ft("files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=e9(this.apiClient,c),h=new P8;return Object.assign(h,d),h})}}async createInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=KH(this.apiClient,e);return a=Ft("upload/v1beta/files",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=t9(),d=new M8;return Object.assign(d,c),d})}}async get(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=JH(this.apiClient,e);return a=Ft("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>xS(this.apiClient,c))}}async delete(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=QH(this.apiClient,e);return a=Ft("files/{file}",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(()=>{const c=n9(),d=new E8;return Object.assign(d,c),d})}}};function s9(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function i9(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function zF(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],s9(n,r)),t}function a9(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],i9(n,r)),t}function o9(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],zF(n,s)),t}function l9(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>o9(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function c9(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],zF(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],l9(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function d9(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],a9(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function u9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function f9(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function h9(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function m9(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function p9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],u9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],h9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function g9(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],f9(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],m9(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function x9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>p9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function y9(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>g9(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function v9(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function b9(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function w9(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function _9(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function j9(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],w9(n,r)),t}function N9(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],_9(n,r)),t}function S9(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function C9(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function T9(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],S9(n,r)),t}function k9(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],C9(n,r)),t}function P9(){return{}}function M9(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function E9(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],M9(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function D9(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],E9(n,r)),t}function O9(){return{}}function I9(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>v9(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],j9(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],T9(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],O9());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function A9(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>b9(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],N9(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],k9(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],P9());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],D9(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function R9(n,e){const t={},r=N(e,["handle"]);if(r!=null&&S(t,["handle"],r),N(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function L9(n,e){const t={},r=N(e,["handle"]);r!=null&&S(t,["handle"],r);const s=N(e,["transparent"]);return s!=null&&S(t,["transparent"],s),t}function bM(){return{}}function wM(){return{}}function F9(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function q9(n,e){const t={},r=N(e,["disabled"]);r!=null&&S(t,["disabled"],r);const s=N(e,["startOfSpeechSensitivity"]);s!=null&&S(t,["startOfSpeechSensitivity"],s);const a=N(e,["endOfSpeechSensitivity"]);a!=null&&S(t,["endOfSpeechSensitivity"],a);const o=N(e,["prefixPaddingMs"]);o!=null&&S(t,["prefixPaddingMs"],o);const l=N(e,["silenceDurationMs"]);return l!=null&&S(t,["silenceDurationMs"],l),t}function z9(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],F9(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function U9(n,e){const t={},r=N(e,["automaticActivityDetection"]);r!=null&&S(t,["automaticActivityDetection"],q9(n,r));const s=N(e,["activityHandling"]);s!=null&&S(t,["activityHandling"],s);const a=N(e,["turnCoverage"]);return a!=null&&S(t,["turnCoverage"],a),t}function B9(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function V9(n,e){const t={},r=N(e,["targetTokens"]);return r!=null&&S(t,["targetTokens"],r),t}function W9(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],B9(n,s)),t}function $9(n,e){const t={},r=N(e,["triggerTokens"]);r!=null&&S(t,["triggerTokens"],r);const s=N(e,["slidingWindow"]);return s!=null&&S(t,["slidingWindow"],V9(n,s)),t}function H9(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function Y9(n,e){const t={},r=N(e,["proactiveAudio"]);return r!=null&&S(t,["proactiveAudio"],r),t}function G9(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],c9(n,IF(n,x)));const y=N(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],y);const _=N(e,["systemInstruction"]);t!==void 0&&_!=null&&S(t,["setup","systemInstruction"],x9(n,Hs(n,_)));const w=N(e,["tools"]);if(t!==void 0&&w!=null){let I=ry(n,w);Array.isArray(I)&&(I=I.map(F=>I9(n,ny(n,F)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],R9(n,j));const C=N(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&S(t,["setup","inputAudioTranscription"],bM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],bM());const O=N(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&S(t,["setup","realtimeInputConfig"],z9(n,O));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],W9(n,M));const D=N(e,["proactivity"]);return t!==void 0&&D!=null&&S(t,["setup","proactivity"],H9(n,D)),r}function Z9(n,e,t){const r={},s=N(e,["generationConfig"]);t!==void 0&&s!=null&&S(t,["setup","generationConfig"],s);const a=N(e,["responseModalities"]);t!==void 0&&a!=null&&S(t,["setup","generationConfig","responseModalities"],a);const o=N(e,["temperature"]);t!==void 0&&o!=null&&S(t,["setup","generationConfig","temperature"],o);const l=N(e,["topP"]);t!==void 0&&l!=null&&S(t,["setup","generationConfig","topP"],l);const c=N(e,["topK"]);t!==void 0&&c!=null&&S(t,["setup","generationConfig","topK"],c);const d=N(e,["maxOutputTokens"]);t!==void 0&&d!=null&&S(t,["setup","generationConfig","maxOutputTokens"],d);const h=N(e,["mediaResolution"]);t!==void 0&&h!=null&&S(t,["setup","generationConfig","mediaResolution"],h);const p=N(e,["seed"]);t!==void 0&&p!=null&&S(t,["setup","generationConfig","seed"],p);const x=N(e,["speechConfig"]);t!==void 0&&x!=null&&S(t,["setup","generationConfig","speechConfig"],d9(n,IF(n,x)));const y=N(e,["enableAffectiveDialog"]);t!==void 0&&y!=null&&S(t,["setup","generationConfig","enableAffectiveDialog"],y);const _=N(e,["systemInstruction"]);t!==void 0&&_!=null&&S(t,["setup","systemInstruction"],y9(n,Hs(n,_)));const w=N(e,["tools"]);if(t!==void 0&&w!=null){let I=ry(n,w);Array.isArray(I)&&(I=I.map(F=>A9(n,ny(n,F)))),S(t,["setup","tools"],I)}const j=N(e,["sessionResumption"]);t!==void 0&&j!=null&&S(t,["setup","sessionResumption"],L9(n,j));const C=N(e,["inputAudioTranscription"]);t!==void 0&&C!=null&&S(t,["setup","inputAudioTranscription"],wM());const P=N(e,["outputAudioTranscription"]);t!==void 0&&P!=null&&S(t,["setup","outputAudioTranscription"],wM());const O=N(e,["realtimeInputConfig"]);t!==void 0&&O!=null&&S(t,["setup","realtimeInputConfig"],U9(n,O));const M=N(e,["contextWindowCompression"]);t!==void 0&&M!=null&&S(t,["setup","contextWindowCompression"],$9(n,M));const D=N(e,["proactivity"]);return t!==void 0&&D!=null&&S(t,["setup","proactivity"],Y9(n,D)),r}function K9(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],G9(n,s,t)),t}function J9(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["setup","model"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],Z9(n,s,t)),t}function Q9(){return{}}function X9(){return{}}function e7(){return{}}function t7(){return{}}function n7(n,e){const t={},r=N(e,["media"]);r!=null&&S(t,["mediaChunks"],MF(n,r));const s=N(e,["audio"]);s!=null&&S(t,["audio"],A8(n,s));const a=N(e,["audioStreamEnd"]);a!=null&&S(t,["audioStreamEnd"],a);const o=N(e,["video"]);o!=null&&S(t,["video"],I8(n,o));const l=N(e,["text"]);return l!=null&&S(t,["text"],l),N(e,["activityStart"])!=null&&S(t,["activityStart"],Q9()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],e7()),t}function r7(n,e){const t={},r=N(e,["media"]);if(r!=null&&S(t,["mediaChunks"],MF(n,r)),N(e,["audio"])!==void 0)throw new Error("audio parameter is not supported in Vertex AI.");const s=N(e,["audioStreamEnd"]);if(s!=null&&S(t,["audioStreamEnd"],s),N(e,["video"])!==void 0)throw new Error("video parameter is not supported in Vertex AI.");if(N(e,["text"])!==void 0)throw new Error("text parameter is not supported in Vertex AI.");return N(e,["activityStart"])!=null&&S(t,["activityStart"],X9()),N(e,["activityEnd"])!=null&&S(t,["activityEnd"],t7()),t}function UF(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function s7(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>UF(n,a))),S(t,["weightedPrompts"],s)}return t}function BF(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const y=N(e,["onlyBassAndDrums"]);y!=null&&S(t,["onlyBassAndDrums"],y);const _=N(e,["musicGenerationMode"]);return _!=null&&S(t,["musicGenerationMode"],_),t}function i7(n,e){const t={},r=N(e,["musicGenerationConfig"]);return r!=null&&S(t,["musicGenerationConfig"],BF(n,r)),t}function VF(n,e){const t={},r=N(e,["model"]);return r!=null&&S(t,["model"],r),t}function WF(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>UF(n,a))),S(t,["weightedPrompts"],s)}return t}function yS(n,e){const t={},r=N(e,["setup"]);r!=null&&S(t,["setup"],VF(n,r));const s=N(e,["clientContent"]);s!=null&&S(t,["clientContent"],WF(n,s));const a=N(e,["musicGenerationConfig"]);a!=null&&S(t,["musicGenerationConfig"],BF(n,a));const o=N(e,["playbackControl"]);return o!=null&&S(t,["playbackControl"],o),t}function a7(){return{}}function o7(){return{}}function l7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function c7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function d7(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function u7(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function f7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],l7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],d7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function h7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],c7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],u7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function m7(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>f7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function p7(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>h7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function _M(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function jM(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["finished"]);return s!=null&&S(t,["finished"],s),t}function g7(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function x7(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>g7(n,a))),S(t,["urlMetadata"],s)}return t}function y7(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],m7(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],_M(n,c));const d=N(e,["outputTranscription"]);d!=null&&S(t,["outputTranscription"],_M(n,d));const h=N(e,["urlContextMetadata"]);return h!=null&&S(t,["urlContextMetadata"],x7(n,h)),t}function v7(n,e){const t={},r=N(e,["modelTurn"]);r!=null&&S(t,["modelTurn"],p7(n,r));const s=N(e,["turnComplete"]);s!=null&&S(t,["turnComplete"],s);const a=N(e,["interrupted"]);a!=null&&S(t,["interrupted"],a);const o=N(e,["groundingMetadata"]);o!=null&&S(t,["groundingMetadata"],o);const l=N(e,["generationComplete"]);l!=null&&S(t,["generationComplete"],l);const c=N(e,["inputTranscription"]);c!=null&&S(t,["inputTranscription"],jM(n,c));const d=N(e,["outputTranscription"]);return d!=null&&S(t,["outputTranscription"],jM(n,d)),t}function b7(n,e){const t={},r=N(e,["id"]);r!=null&&S(t,["id"],r);const s=N(e,["args"]);s!=null&&S(t,["args"],s);const a=N(e,["name"]);return a!=null&&S(t,["name"],a),t}function w7(n,e){const t={},r=N(e,["args"]);r!=null&&S(t,["args"],r);const s=N(e,["name"]);return s!=null&&S(t,["name"],s),t}function _7(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>b7(n,a))),S(t,["functionCalls"],s)}return t}function j7(n,e){const t={},r=N(e,["functionCalls"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>w7(n,a))),S(t,["functionCalls"],s)}return t}function N7(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function S7(n,e){const t={},r=N(e,["ids"]);return r!=null&&S(t,["ids"],r),t}function Bp(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function Vp(n,e){const t={},r=N(e,["modality"]);r!=null&&S(t,["modality"],r);const s=N(e,["tokenCount"]);return s!=null&&S(t,["tokenCount"],s),t}function C7(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["responseTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let y=d;Array.isArray(y)&&(y=y.map(_=>Bp(n,_))),S(t,["promptTokensDetails"],y)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let y=h;Array.isArray(y)&&(y=y.map(_=>Bp(n,_))),S(t,["cacheTokensDetails"],y)}const p=N(e,["responseTokensDetails"]);if(p!=null){let y=p;Array.isArray(y)&&(y=y.map(_=>Bp(n,_))),S(t,["responseTokensDetails"],y)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let y=x;Array.isArray(y)&&(y=y.map(_=>Bp(n,_))),S(t,["toolUsePromptTokensDetails"],y)}return t}function T7(n,e){const t={},r=N(e,["promptTokenCount"]);r!=null&&S(t,["promptTokenCount"],r);const s=N(e,["cachedContentTokenCount"]);s!=null&&S(t,["cachedContentTokenCount"],s);const a=N(e,["candidatesTokenCount"]);a!=null&&S(t,["responseTokenCount"],a);const o=N(e,["toolUsePromptTokenCount"]);o!=null&&S(t,["toolUsePromptTokenCount"],o);const l=N(e,["thoughtsTokenCount"]);l!=null&&S(t,["thoughtsTokenCount"],l);const c=N(e,["totalTokenCount"]);c!=null&&S(t,["totalTokenCount"],c);const d=N(e,["promptTokensDetails"]);if(d!=null){let _=d;Array.isArray(_)&&(_=_.map(w=>Vp(n,w))),S(t,["promptTokensDetails"],_)}const h=N(e,["cacheTokensDetails"]);if(h!=null){let _=h;Array.isArray(_)&&(_=_.map(w=>Vp(n,w))),S(t,["cacheTokensDetails"],_)}const p=N(e,["candidatesTokensDetails"]);if(p!=null){let _=p;Array.isArray(_)&&(_=_.map(w=>Vp(n,w))),S(t,["responseTokensDetails"],_)}const x=N(e,["toolUsePromptTokensDetails"]);if(x!=null){let _=x;Array.isArray(_)&&(_=_.map(w=>Vp(n,w))),S(t,["toolUsePromptTokensDetails"],_)}const y=N(e,["trafficType"]);return y!=null&&S(t,["trafficType"],y),t}function k7(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function P7(n,e){const t={},r=N(e,["timeLeft"]);return r!=null&&S(t,["timeLeft"],r),t}function M7(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function E7(n,e){const t={},r=N(e,["newHandle"]);r!=null&&S(t,["newHandle"],r);const s=N(e,["resumable"]);s!=null&&S(t,["resumable"],s);const a=N(e,["lastConsumedClientMessageIndex"]);return a!=null&&S(t,["lastConsumedClientMessageIndex"],a),t}function D7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],a7());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],y7(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],_7(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],N7(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],C7(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],k7(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],M7(n,d)),t}function O7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],o7());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],v7(n,s));const a=N(e,["toolCall"]);a!=null&&S(t,["toolCall"],j7(n,a));const o=N(e,["toolCallCancellation"]);o!=null&&S(t,["toolCallCancellation"],S7(n,o));const l=N(e,["usageMetadata"]);l!=null&&S(t,["usageMetadata"],T7(n,l));const c=N(e,["goAway"]);c!=null&&S(t,["goAway"],P7(n,c));const d=N(e,["sessionResumptionUpdate"]);return d!=null&&S(t,["sessionResumptionUpdate"],E7(n,d)),t}function I7(){return{}}function A7(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["weight"]);return s!=null&&S(t,["weight"],s),t}function R7(n,e){const t={},r=N(e,["weightedPrompts"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>A7(n,a))),S(t,["weightedPrompts"],s)}return t}function L7(n,e){const t={},r=N(e,["temperature"]);r!=null&&S(t,["temperature"],r);const s=N(e,["topK"]);s!=null&&S(t,["topK"],s);const a=N(e,["seed"]);a!=null&&S(t,["seed"],a);const o=N(e,["guidance"]);o!=null&&S(t,["guidance"],o);const l=N(e,["bpm"]);l!=null&&S(t,["bpm"],l);const c=N(e,["density"]);c!=null&&S(t,["density"],c);const d=N(e,["brightness"]);d!=null&&S(t,["brightness"],d);const h=N(e,["scale"]);h!=null&&S(t,["scale"],h);const p=N(e,["muteBass"]);p!=null&&S(t,["muteBass"],p);const x=N(e,["muteDrums"]);x!=null&&S(t,["muteDrums"],x);const y=N(e,["onlyBassAndDrums"]);y!=null&&S(t,["onlyBassAndDrums"],y);const _=N(e,["musicGenerationMode"]);return _!=null&&S(t,["musicGenerationMode"],_),t}function F7(n,e){const t={},r=N(e,["clientContent"]);r!=null&&S(t,["clientContent"],R7(n,r));const s=N(e,["musicGenerationConfig"]);return s!=null&&S(t,["musicGenerationConfig"],L7(n,s)),t}function q7(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);s!=null&&S(t,["mimeType"],s);const a=N(e,["sourceMetadata"]);return a!=null&&S(t,["sourceMetadata"],F7(n,a)),t}function z7(n,e){const t={},r=N(e,["audioChunks"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>q7(n,a))),S(t,["audioChunks"],s)}return t}function U7(n,e){const t={},r=N(e,["text"]);r!=null&&S(t,["text"],r);const s=N(e,["filteredReason"]);return s!=null&&S(t,["filteredReason"],s),t}function B7(n,e){const t={};N(e,["setupComplete"])!=null&&S(t,["setupComplete"],I7());const s=N(e,["serverContent"]);s!=null&&S(t,["serverContent"],z7(n,s));const a=N(e,["filteredPrompt"]);return a!=null&&S(t,["filteredPrompt"],U7(n,a)),t}function V7(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function W7(n,e){const t={};if(N(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function $7(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],V7(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],W7(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function iy(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>$7(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function H7(n,e){const t={};if(N(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const r=N(e,["category"]);r!=null&&S(t,["category"],r);const s=N(e,["threshold"]);return s!=null&&S(t,["threshold"],s),t}function Y7(n,e){const t={},r=N(e,["behavior"]);r!=null&&S(t,["behavior"],r);const s=N(e,["description"]);s!=null&&S(t,["description"],s);const a=N(e,["name"]);a!=null&&S(t,["name"],a);const o=N(e,["parameters"]);o!=null&&S(t,["parameters"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],l),t}function G7(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function Z7(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],G7(n,r)),t}function K7(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function J7(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],K7(n,r)),t}function Q7(){return{}}function X7(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let c=r;Array.isArray(c)&&(c=c.map(d=>Y7(n,d))),S(t,["functionDeclarations"],c)}if(N(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const s=N(e,["googleSearch"]);s!=null&&S(t,["googleSearch"],Z7(n,s));const a=N(e,["googleSearchRetrieval"]);if(a!=null&&S(t,["googleSearchRetrieval"],J7(n,a)),N(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(N(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");N(e,["urlContext"])!=null&&S(t,["urlContext"],Q7());const l=N(e,["codeExecution"]);return l!=null&&S(t,["codeExecution"],l),t}function eY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function tY(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function nY(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],tY(n,r)),t}function rY(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],eY(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],nY(n,s)),t}function sY(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function $F(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],sY(n,r)),t}function iY(n,e){const t={},r=N(e,["speaker"]);r!=null&&S(t,["speaker"],r);const s=N(e,["voiceConfig"]);return s!=null&&S(t,["voiceConfig"],$F(n,s)),t}function aY(n,e){const t={},r=N(e,["speakerVoiceConfigs"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>iY(n,a))),S(t,["speakerVoiceConfigs"],s)}return t}function oY(n,e){const t={},r=N(e,["voiceConfig"]);r!=null&&S(t,["voiceConfig"],$F(n,r));const s=N(e,["multiSpeakerVoiceConfig"]);s!=null&&S(t,["multiSpeakerVoiceConfig"],aY(n,s));const a=N(e,["languageCode"]);return a!=null&&S(t,["languageCode"],a),t}function lY(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function cY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],iy(n,Hs(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const y=N(e,["presencePenalty"]);y!=null&&S(r,["presencePenalty"],y);const _=N(e,["frequencyPenalty"]);_!=null&&S(r,["frequencyPenalty"],_);const w=N(e,["seed"]);w!=null&&S(r,["seed"],w);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const C=N(e,["responseSchema"]);if(C!=null&&S(r,["responseSchema"],Mx(n,C)),N(e,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(N(e,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const P=N(e,["safetySettings"]);if(t!==void 0&&P!=null){let U=P;Array.isArray(U)&&(U=U.map(W=>H7(n,W))),S(t,["safetySettings"],U)}const O=N(e,["tools"]);if(t!==void 0&&O!=null){let U=ry(n,O);Array.isArray(U)&&(U=U.map(W=>X7(n,ny(n,W)))),S(t,["tools"],U)}const M=N(e,["toolConfig"]);if(t!==void 0&&M!=null&&S(t,["toolConfig"],rY(n,M)),N(e,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const D=N(e,["cachedContent"]);t!==void 0&&D!=null&&S(t,["cachedContent"],Jc(n,D));const I=N(e,["responseModalities"]);I!=null&&S(r,["responseModalities"],I);const F=N(e,["mediaResolution"]);F!=null&&S(r,["mediaResolution"],F);const q=N(e,["speechConfig"]);if(q!=null&&S(r,["speechConfig"],oY(n,OF(n,q))),N(e,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const B=N(e,["thinkingConfig"]);return B!=null&&S(r,["thinkingConfig"],lY(n,B)),r}function NM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>iy(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],cY(n,a,t)),t}function dY(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["requests[]","taskType"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["requests[]","title"],a);const o=N(e,["outputDimensionality"]);if(t!==void 0&&o!=null&&S(t,["requests[]","outputDimensionality"],o),N(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(N(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return r}function uY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);s!=null&&S(t,["requests[]","content"],DF(n,s));const a=N(e,["config"]);a!=null&&S(t,["config"],dY(n,a,t));const o=N(e,["model"]);return o!==void 0&&S(t,["requests[]","model"],Wn(n,o)),t}function fY(n,e,t){const r={};if(N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const s=N(e,["numberOfImages"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["aspectRatio"]);t!==void 0&&a!=null&&S(t,["parameters","aspectRatio"],a);const o=N(e,["guidanceScale"]);if(t!==void 0&&o!=null&&S(t,["parameters","guidanceScale"],o),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const l=N(e,["safetyFilterLevel"]);t!==void 0&&l!=null&&S(t,["parameters","safetySetting"],l);const c=N(e,["personGeneration"]);t!==void 0&&c!=null&&S(t,["parameters","personGeneration"],c);const d=N(e,["includeSafetyAttributes"]);t!==void 0&&d!=null&&S(t,["parameters","includeSafetyAttributes"],d);const h=N(e,["includeRaiReason"]);t!==void 0&&h!=null&&S(t,["parameters","includeRaiReason"],h);const p=N(e,["language"]);t!==void 0&&p!=null&&S(t,["parameters","language"],p);const x=N(e,["outputMimeType"]);t!==void 0&&x!=null&&S(t,["parameters","outputOptions","mimeType"],x);const y=N(e,["outputCompressionQuality"]);if(t!==void 0&&y!=null&&S(t,["parameters","outputOptions","compressionQuality"],y),N(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function hY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],fY(n,a,t)),t}function mY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function pY(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],LF(n,l)),r}function gY(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],pY(n,r,t)),t}function xY(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function yY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],xY(n,s,t)),t}function vY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function bY(n,e){const t={};if(N(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(N(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(N(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function wY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>iy(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],bY(n,a)),t}function _Y(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["imageBytes"]);r!=null&&S(t,["bytesBase64Encoded"],Qc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function jY(n,e,t){const r={},s=N(e,["numberOfVideos"]);if(t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s),N(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(N(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const a=N(e,["durationSeconds"]);if(t!==void 0&&a!=null&&S(t,["parameters","durationSeconds"],a),N(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const o=N(e,["aspectRatio"]);if(t!==void 0&&o!=null&&S(t,["parameters","aspectRatio"],o),N(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const l=N(e,["personGeneration"]);if(t!==void 0&&l!=null&&S(t,["parameters","personGeneration"],l),N(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const c=N(e,["negativePrompt"]);if(t!==void 0&&c!=null&&S(t,["parameters","negativePrompt"],c),N(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return r}function NY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],_Y(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],jY(n,o,t)),t}function SY(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function CY(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function TY(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],SY(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],CY(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function $f(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>TY(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function kY(n,e){const t={},r=N(e,["featureSelectionPreference"]);return r!=null&&S(t,["featureSelectionPreference"],r),t}function PY(n,e){const t={},r=N(e,["method"]);r!=null&&S(t,["method"],r);const s=N(e,["category"]);s!=null&&S(t,["category"],s);const a=N(e,["threshold"]);return a!=null&&S(t,["threshold"],a),t}function MY(n,e){const t={};if(N(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const r=N(e,["description"]);r!=null&&S(t,["description"],r);const s=N(e,["name"]);s!=null&&S(t,["name"],s);const a=N(e,["parameters"]);a!=null&&S(t,["parameters"],a);const o=N(e,["response"]);return o!=null&&S(t,["response"],o),t}function EY(n,e){const t={},r=N(e,["startTime"]);r!=null&&S(t,["startTime"],r);const s=N(e,["endTime"]);return s!=null&&S(t,["endTime"],s),t}function DY(n,e){const t={},r=N(e,["timeRangeFilter"]);return r!=null&&S(t,["timeRangeFilter"],EY(n,r)),t}function OY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["dynamicThreshold"]);return s!=null&&S(t,["dynamicThreshold"],s),t}function IY(n,e){const t={},r=N(e,["dynamicRetrievalConfig"]);return r!=null&&S(t,["dynamicRetrievalConfig"],OY(n,r)),t}function AY(){return{}}function RY(n,e){const t={},r=N(e,["apiKeyString"]);return r!=null&&S(t,["apiKeyString"],r),t}function LY(n,e){const t={},r=N(e,["apiKeyConfig"]);r!=null&&S(t,["apiKeyConfig"],RY(n,r));const s=N(e,["authType"]);s!=null&&S(t,["authType"],s);const a=N(e,["googleServiceAccountConfig"]);a!=null&&S(t,["googleServiceAccountConfig"],a);const o=N(e,["httpBasicAuthConfig"]);o!=null&&S(t,["httpBasicAuthConfig"],o);const l=N(e,["oauthConfig"]);l!=null&&S(t,["oauthConfig"],l);const c=N(e,["oidcConfig"]);return c!=null&&S(t,["oidcConfig"],c),t}function FY(n,e){const t={},r=N(e,["authConfig"]);return r!=null&&S(t,["authConfig"],LY(n,r)),t}function HF(n,e){const t={},r=N(e,["functionDeclarations"]);if(r!=null){let h=r;Array.isArray(h)&&(h=h.map(p=>MY(n,p))),S(t,["functionDeclarations"],h)}const s=N(e,["retrieval"]);s!=null&&S(t,["retrieval"],s);const a=N(e,["googleSearch"]);a!=null&&S(t,["googleSearch"],DY(n,a));const o=N(e,["googleSearchRetrieval"]);o!=null&&S(t,["googleSearchRetrieval"],IY(n,o)),N(e,["enterpriseWebSearch"])!=null&&S(t,["enterpriseWebSearch"],AY());const c=N(e,["googleMaps"]);if(c!=null&&S(t,["googleMaps"],FY(n,c)),N(e,["urlContext"])!==void 0)throw new Error("urlContext parameter is not supported in Vertex AI.");const d=N(e,["codeExecution"]);return d!=null&&S(t,["codeExecution"],d),t}function qY(n,e){const t={},r=N(e,["mode"]);r!=null&&S(t,["mode"],r);const s=N(e,["allowedFunctionNames"]);return s!=null&&S(t,["allowedFunctionNames"],s),t}function zY(n,e){const t={},r=N(e,["latitude"]);r!=null&&S(t,["latitude"],r);const s=N(e,["longitude"]);return s!=null&&S(t,["longitude"],s),t}function UY(n,e){const t={},r=N(e,["latLng"]);return r!=null&&S(t,["latLng"],zY(n,r)),t}function BY(n,e){const t={},r=N(e,["functionCallingConfig"]);r!=null&&S(t,["functionCallingConfig"],qY(n,r));const s=N(e,["retrievalConfig"]);return s!=null&&S(t,["retrievalConfig"],UY(n,s)),t}function VY(n,e){const t={},r=N(e,["voiceName"]);return r!=null&&S(t,["voiceName"],r),t}function WY(n,e){const t={},r=N(e,["prebuiltVoiceConfig"]);return r!=null&&S(t,["prebuiltVoiceConfig"],VY(n,r)),t}function $Y(n,e){const t={},r=N(e,["voiceConfig"]);if(r!=null&&S(t,["voiceConfig"],WY(n,r)),N(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const s=N(e,["languageCode"]);return s!=null&&S(t,["languageCode"],s),t}function HY(n,e){const t={},r=N(e,["includeThoughts"]);r!=null&&S(t,["includeThoughts"],r);const s=N(e,["thinkingBudget"]);return s!=null&&S(t,["thinkingBudget"],s),t}function YY(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],$f(n,Hs(n,s)));const a=N(e,["temperature"]);a!=null&&S(r,["temperature"],a);const o=N(e,["topP"]);o!=null&&S(r,["topP"],o);const l=N(e,["topK"]);l!=null&&S(r,["topK"],l);const c=N(e,["candidateCount"]);c!=null&&S(r,["candidateCount"],c);const d=N(e,["maxOutputTokens"]);d!=null&&S(r,["maxOutputTokens"],d);const h=N(e,["stopSequences"]);h!=null&&S(r,["stopSequences"],h);const p=N(e,["responseLogprobs"]);p!=null&&S(r,["responseLogprobs"],p);const x=N(e,["logprobs"]);x!=null&&S(r,["logprobs"],x);const y=N(e,["presencePenalty"]);y!=null&&S(r,["presencePenalty"],y);const _=N(e,["frequencyPenalty"]);_!=null&&S(r,["frequencyPenalty"],_);const w=N(e,["seed"]);w!=null&&S(r,["seed"],w);const j=N(e,["responseMimeType"]);j!=null&&S(r,["responseMimeType"],j);const C=N(e,["responseSchema"]);C!=null&&S(r,["responseSchema"],Mx(n,C));const P=N(e,["routingConfig"]);P!=null&&S(r,["routingConfig"],P);const O=N(e,["modelSelectionConfig"]);O!=null&&S(r,["modelConfig"],kY(n,O));const M=N(e,["safetySettings"]);if(t!==void 0&&M!=null){let Y=M;Array.isArray(Y)&&(Y=Y.map(ae=>PY(n,ae))),S(t,["safetySettings"],Y)}const D=N(e,["tools"]);if(t!==void 0&&D!=null){let Y=ry(n,D);Array.isArray(Y)&&(Y=Y.map(ae=>HF(n,ny(n,ae)))),S(t,["tools"],Y)}const I=N(e,["toolConfig"]);t!==void 0&&I!=null&&S(t,["toolConfig"],BY(n,I));const F=N(e,["labels"]);t!==void 0&&F!=null&&S(t,["labels"],F);const q=N(e,["cachedContent"]);t!==void 0&&q!=null&&S(t,["cachedContent"],Jc(n,q));const B=N(e,["responseModalities"]);B!=null&&S(r,["responseModalities"],B);const U=N(e,["mediaResolution"]);U!=null&&S(r,["mediaResolution"],U);const W=N(e,["speechConfig"]);W!=null&&S(r,["speechConfig"],$Y(n,OF(n,W)));const G=N(e,["audioTimestamp"]);G!=null&&S(r,["audioTimestamp"],G);const Z=N(e,["thinkingConfig"]);return Z!=null&&S(r,["thinkingConfig"],HY(n,Z)),r}function SM(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>$f(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["generationConfig"],YY(n,a,t)),t}function GY(n,e,t){const r={},s=N(e,["taskType"]);t!==void 0&&s!=null&&S(t,["instances[]","task_type"],s);const a=N(e,["title"]);t!==void 0&&a!=null&&S(t,["instances[]","title"],a);const o=N(e,["outputDimensionality"]);t!==void 0&&o!=null&&S(t,["parameters","outputDimensionality"],o);const l=N(e,["mimeType"]);t!==void 0&&l!=null&&S(t,["instances[]","mimeType"],l);const c=N(e,["autoTruncate"]);return t!==void 0&&c!=null&&S(t,["parameters","autoTruncate"],c),r}function ZY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);s!=null&&S(t,["instances[]","content"],DF(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],GY(n,a,t)),t}function KY(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const y=N(e,["includeRaiReason"]);t!==void 0&&y!=null&&S(t,["parameters","includeRaiReason"],y);const _=N(e,["language"]);t!==void 0&&_!=null&&S(t,["parameters","language"],_);const w=N(e,["outputMimeType"]);t!==void 0&&w!=null&&S(t,["parameters","outputOptions","mimeType"],w);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const C=N(e,["addWatermark"]);t!==void 0&&C!=null&&S(t,["parameters","addWatermark"],C);const P=N(e,["enhancePrompt"]);return t!==void 0&&P!=null&&S(t,["parameters","enhancePrompt"],P),r}function JY(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],KY(n,a,t)),t}function j1(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["imageBytes"]);s!=null&&S(t,["bytesBase64Encoded"],Qc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function QY(n,e){const t={},r=N(e,["maskMode"]);r!=null&&S(t,["maskMode"],r);const s=N(e,["segmentationClasses"]);s!=null&&S(t,["maskClasses"],s);const a=N(e,["maskDilation"]);return a!=null&&S(t,["dilation"],a),t}function XY(n,e){const t={},r=N(e,["controlType"]);r!=null&&S(t,["controlType"],r);const s=N(e,["enableControlImageComputation"]);return s!=null&&S(t,["computeControl"],s),t}function eG(n,e){const t={},r=N(e,["styleDescription"]);return r!=null&&S(t,["styleDescription"],r),t}function tG(n,e){const t={},r=N(e,["subjectType"]);r!=null&&S(t,["subjectType"],r);const s=N(e,["subjectDescription"]);return s!=null&&S(t,["subjectDescription"],s),t}function nG(n,e){const t={},r=N(e,["referenceImage"]);r!=null&&S(t,["referenceImage"],j1(n,r));const s=N(e,["referenceId"]);s!=null&&S(t,["referenceId"],s);const a=N(e,["referenceType"]);a!=null&&S(t,["referenceType"],a);const o=N(e,["maskImageConfig"]);o!=null&&S(t,["maskImageConfig"],QY(n,o));const l=N(e,["controlImageConfig"]);l!=null&&S(t,["controlImageConfig"],XY(n,l));const c=N(e,["styleImageConfig"]);c!=null&&S(t,["styleImageConfig"],eG(n,c));const d=N(e,["subjectImageConfig"]);return d!=null&&S(t,["subjectImageConfig"],tG(n,d)),t}function rG(n,e,t){const r={},s=N(e,["outputGcsUri"]);t!==void 0&&s!=null&&S(t,["parameters","storageUri"],s);const a=N(e,["negativePrompt"]);t!==void 0&&a!=null&&S(t,["parameters","negativePrompt"],a);const o=N(e,["numberOfImages"]);t!==void 0&&o!=null&&S(t,["parameters","sampleCount"],o);const l=N(e,["aspectRatio"]);t!==void 0&&l!=null&&S(t,["parameters","aspectRatio"],l);const c=N(e,["guidanceScale"]);t!==void 0&&c!=null&&S(t,["parameters","guidanceScale"],c);const d=N(e,["seed"]);t!==void 0&&d!=null&&S(t,["parameters","seed"],d);const h=N(e,["safetyFilterLevel"]);t!==void 0&&h!=null&&S(t,["parameters","safetySetting"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["includeSafetyAttributes"]);t!==void 0&&x!=null&&S(t,["parameters","includeSafetyAttributes"],x);const y=N(e,["includeRaiReason"]);t!==void 0&&y!=null&&S(t,["parameters","includeRaiReason"],y);const _=N(e,["language"]);t!==void 0&&_!=null&&S(t,["parameters","language"],_);const w=N(e,["outputMimeType"]);t!==void 0&&w!=null&&S(t,["parameters","outputOptions","mimeType"],w);const j=N(e,["outputCompressionQuality"]);t!==void 0&&j!=null&&S(t,["parameters","outputOptions","compressionQuality"],j);const C=N(e,["editMode"]);t!==void 0&&C!=null&&S(t,["parameters","editMode"],C);const P=N(e,["baseSteps"]);return t!==void 0&&P!=null&&S(t,["parameters","editConfig","baseSteps"],P),r}function sG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["referenceImages"]);if(a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>nG(n,c))),S(t,["instances[0]","referenceImages"],l)}const o=N(e,["config"]);return o!=null&&S(t,["config"],rG(n,o,t)),t}function iG(n,e,t){const r={},s=N(e,["includeRaiReason"]);t!==void 0&&s!=null&&S(t,["parameters","includeRaiReason"],s);const a=N(e,["outputMimeType"]);t!==void 0&&a!=null&&S(t,["parameters","outputOptions","mimeType"],a);const o=N(e,["outputCompressionQuality"]);t!==void 0&&o!=null&&S(t,["parameters","outputOptions","compressionQuality"],o);const l=N(e,["numberOfImages"]);t!==void 0&&l!=null&&S(t,["parameters","sampleCount"],l);const c=N(e,["mode"]);return t!==void 0&&c!=null&&S(t,["parameters","mode"],c),r}function aG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["image"]);s!=null&&S(t,["instances[0]","image"],j1(n,s));const a=N(e,["upscaleFactor"]);a!=null&&S(t,["parameters","upscaleConfig","upscaleFactor"],a);const o=N(e,["config"]);return o!=null&&S(t,["config"],iG(n,o,t)),t}function oG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function lG(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);t!==void 0&&o!=null&&S(t,["_query","filter"],o);const l=N(e,["queryBase"]);return t!==void 0&&l!=null&&S(t,["_url","models_url"],LF(n,l)),r}function cG(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],lG(n,r,t)),t}function dG(n,e,t){const r={},s=N(e,["displayName"]);t!==void 0&&s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);t!==void 0&&a!=null&&S(t,["description"],a);const o=N(e,["defaultCheckpointId"]);return t!==void 0&&o!=null&&S(t,["defaultCheckpointId"],o),r}function uG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],dG(n,s,t)),t}function fG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","name"],Wn(n,r));const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function hG(n,e,t){const r={},s=N(e,["systemInstruction"]);t!==void 0&&s!=null&&S(t,["systemInstruction"],$f(n,Hs(n,s)));const a=N(e,["tools"]);if(t!==void 0&&a!=null){let l=a;Array.isArray(l)&&(l=l.map(c=>HF(n,c))),S(t,["tools"],l)}const o=N(e,["generationConfig"]);return t!==void 0&&o!=null&&S(t,["generationConfig"],o),r}function mG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>$f(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],hG(n,a,t)),t}function pG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["contents"]);if(s!=null){let o=Ea(n,s);Array.isArray(o)&&(o=o.map(l=>$f(n,l))),S(t,["contents"],o)}const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function gG(n,e,t){const r={},s=N(e,["numberOfVideos"]);t!==void 0&&s!=null&&S(t,["parameters","sampleCount"],s);const a=N(e,["outputGcsUri"]);t!==void 0&&a!=null&&S(t,["parameters","storageUri"],a);const o=N(e,["fps"]);t!==void 0&&o!=null&&S(t,["parameters","fps"],o);const l=N(e,["durationSeconds"]);t!==void 0&&l!=null&&S(t,["parameters","durationSeconds"],l);const c=N(e,["seed"]);t!==void 0&&c!=null&&S(t,["parameters","seed"],c);const d=N(e,["aspectRatio"]);t!==void 0&&d!=null&&S(t,["parameters","aspectRatio"],d);const h=N(e,["resolution"]);t!==void 0&&h!=null&&S(t,["parameters","resolution"],h);const p=N(e,["personGeneration"]);t!==void 0&&p!=null&&S(t,["parameters","personGeneration"],p);const x=N(e,["pubsubTopic"]);t!==void 0&&x!=null&&S(t,["parameters","pubsubTopic"],x);const y=N(e,["negativePrompt"]);t!==void 0&&y!=null&&S(t,["parameters","negativePrompt"],y);const _=N(e,["enhancePrompt"]);return t!==void 0&&_!=null&&S(t,["parameters","enhancePrompt"],_),r}function xG(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["_url","model"],Wn(n,r));const s=N(e,["prompt"]);s!=null&&S(t,["instances[0]","prompt"],s);const a=N(e,["image"]);a!=null&&S(t,["instances[0]","image"],j1(n,a));const o=N(e,["config"]);return o!=null&&S(t,["config"],gG(n,o,t)),t}function yG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function vG(n,e){const t={},r=N(e,["data"]);r!=null&&S(t,["data"],r);const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function bG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],yG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],vG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function wG(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>bG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function _G(n,e){const t={},r=N(e,["citationSources"]);return r!=null&&S(t,["citations"],r),t}function jG(n,e){const t={},r=N(e,["retrievedUrl"]);r!=null&&S(t,["retrievedUrl"],r);const s=N(e,["urlRetrievalStatus"]);return s!=null&&S(t,["urlRetrievalStatus"],s),t}function NG(n,e){const t={},r=N(e,["urlMetadata"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>jG(n,a))),S(t,["urlMetadata"],s)}return t}function SG(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],wG(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],_G(n,s));const a=N(e,["tokenCount"]);a!=null&&S(t,["tokenCount"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["urlContextMetadata"]);l!=null&&S(t,["urlContextMetadata"],NG(n,l));const c=N(e,["avgLogprobs"]);c!=null&&S(t,["avgLogprobs"],c);const d=N(e,["groundingMetadata"]);d!=null&&S(t,["groundingMetadata"],d);const h=N(e,["index"]);h!=null&&S(t,["index"],h);const p=N(e,["logprobsResult"]);p!=null&&S(t,["logprobsResult"],p);const x=N(e,["safetyRatings"]);return x!=null&&S(t,["safetyRatings"],x),t}function CM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let l=r;Array.isArray(l)&&(l=l.map(c=>SG(n,c))),S(t,["candidates"],l)}const s=N(e,["modelVersion"]);s!=null&&S(t,["modelVersion"],s);const a=N(e,["promptFeedback"]);a!=null&&S(t,["promptFeedback"],a);const o=N(e,["usageMetadata"]);return o!=null&&S(t,["usageMetadata"],o),t}function CG(n,e){const t={},r=N(e,["values"]);return r!=null&&S(t,["values"],r),t}function TG(){return{}}function kG(n,e){const t={},r=N(e,["embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>CG(n,o))),S(t,["embeddings"],a)}return N(e,["metadata"])!=null&&S(t,["metadata"],TG()),t}function PG(n,e){const t={},r=N(e,["bytesBase64Encoded"]);r!=null&&S(t,["imageBytes"],Qc(n,r));const s=N(e,["mimeType"]);return s!=null&&S(t,["mimeType"],s),t}function YF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function MG(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],PG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);return a!=null&&S(t,["safetyAttributes"],YF(n,a)),t}function EG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>MG(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],YF(n,s)),t}function DG(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function vS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["version"]);o!=null&&S(t,["version"],o);const l=N(e,["_self"]);l!=null&&S(t,["tunedModelInfo"],DG(n,l));const c=N(e,["inputTokenLimit"]);c!=null&&S(t,["inputTokenLimit"],c);const d=N(e,["outputTokenLimit"]);d!=null&&S(t,["outputTokenLimit"],d);const h=N(e,["supportedGenerationMethods"]);return h!=null&&S(t,["supportedActions"],h),t}function OG(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=FF(n,s);Array.isArray(a)&&(a=a.map(o=>vS(n,o))),S(t,["models"],a)}return t}function IG(){return{}}function AG(n,e){const t={},r=N(e,["totalTokens"]);r!=null&&S(t,["totalTokens"],r);const s=N(e,["cachedContentTokenCount"]);return s!=null&&S(t,["cachedContentTokenCount"],s),t}function RG(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Qc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function LG(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],RG(n,r)),t}function FG(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>LG(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function qG(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],FG(n,l)),t}function zG(n,e){const t={},r=N(e,["fps"]);r!=null&&S(t,["fps"],r);const s=N(e,["endOffset"]);s!=null&&S(t,["endOffset"],s);const a=N(e,["startOffset"]);return a!=null&&S(t,["startOffset"],a),t}function UG(n,e){const t={},r=N(e,["displayName"]);r!=null&&S(t,["displayName"],r);const s=N(e,["data"]);s!=null&&S(t,["data"],s);const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function BG(n,e){const t={},r=N(e,["videoMetadata"]);r!=null&&S(t,["videoMetadata"],zG(n,r));const s=N(e,["thought"]);s!=null&&S(t,["thought"],s);const a=N(e,["inlineData"]);a!=null&&S(t,["inlineData"],UG(n,a));const o=N(e,["codeExecutionResult"]);o!=null&&S(t,["codeExecutionResult"],o);const l=N(e,["executableCode"]);l!=null&&S(t,["executableCode"],l);const c=N(e,["fileData"]);c!=null&&S(t,["fileData"],c);const d=N(e,["functionCall"]);d!=null&&S(t,["functionCall"],d);const h=N(e,["functionResponse"]);h!=null&&S(t,["functionResponse"],h);const p=N(e,["text"]);return p!=null&&S(t,["text"],p),t}function VG(n,e){const t={},r=N(e,["parts"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>BG(n,o))),S(t,["parts"],a)}const s=N(e,["role"]);return s!=null&&S(t,["role"],s),t}function WG(n,e){const t={},r=N(e,["citations"]);return r!=null&&S(t,["citations"],r),t}function $G(n,e){const t={},r=N(e,["content"]);r!=null&&S(t,["content"],VG(n,r));const s=N(e,["citationMetadata"]);s!=null&&S(t,["citationMetadata"],WG(n,s));const a=N(e,["finishMessage"]);a!=null&&S(t,["finishMessage"],a);const o=N(e,["finishReason"]);o!=null&&S(t,["finishReason"],o);const l=N(e,["avgLogprobs"]);l!=null&&S(t,["avgLogprobs"],l);const c=N(e,["groundingMetadata"]);c!=null&&S(t,["groundingMetadata"],c);const d=N(e,["index"]);d!=null&&S(t,["index"],d);const h=N(e,["logprobsResult"]);h!=null&&S(t,["logprobsResult"],h);const p=N(e,["safetyRatings"]);return p!=null&&S(t,["safetyRatings"],p),t}function TM(n,e){const t={},r=N(e,["candidates"]);if(r!=null){let d=r;Array.isArray(d)&&(d=d.map(h=>$G(n,h))),S(t,["candidates"],d)}const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["responseId"]);a!=null&&S(t,["responseId"],a);const o=N(e,["modelVersion"]);o!=null&&S(t,["modelVersion"],o);const l=N(e,["promptFeedback"]);l!=null&&S(t,["promptFeedback"],l);const c=N(e,["usageMetadata"]);return c!=null&&S(t,["usageMetadata"],c),t}function HG(n,e){const t={},r=N(e,["truncated"]);r!=null&&S(t,["truncated"],r);const s=N(e,["token_count"]);return s!=null&&S(t,["tokenCount"],s),t}function YG(n,e){const t={},r=N(e,["values"]);r!=null&&S(t,["values"],r);const s=N(e,["statistics"]);return s!=null&&S(t,["statistics"],HG(n,s)),t}function GG(n,e){const t={},r=N(e,["billableCharacterCount"]);return r!=null&&S(t,["billableCharacterCount"],r),t}function ZG(n,e){const t={},r=N(e,["predictions[]","embeddings"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>YG(n,o))),S(t,["embeddings"],a)}const s=N(e,["metadata"]);return s!=null&&S(t,["metadata"],GG(n,s)),t}function KG(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["gcsUri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["imageBytes"],Qc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function GF(n,e){const t={},r=N(e,["safetyAttributes","categories"]);r!=null&&S(t,["categories"],r);const s=N(e,["safetyAttributes","scores"]);s!=null&&S(t,["scores"],s);const a=N(e,["contentType"]);return a!=null&&S(t,["contentType"],a),t}function N1(n,e){const t={},r=N(e,["_self"]);r!=null&&S(t,["image"],KG(n,r));const s=N(e,["raiFilteredReason"]);s!=null&&S(t,["raiFilteredReason"],s);const a=N(e,["_self"]);a!=null&&S(t,["safetyAttributes"],GF(n,a));const o=N(e,["prompt"]);return o!=null&&S(t,["enhancedPrompt"],o),t}function JG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let a=r;Array.isArray(a)&&(a=a.map(o=>N1(n,o))),S(t,["generatedImages"],a)}const s=N(e,["positivePromptSafetyAttributes"]);return s!=null&&S(t,["positivePromptSafetyAttributes"],GF(n,s)),t}function QG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>N1(n,a))),S(t,["generatedImages"],s)}return t}function XG(n,e){const t={},r=N(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>N1(n,a))),S(t,["generatedImages"],s)}return t}function eZ(n,e){const t={},r=N(e,["endpoint"]);r!=null&&S(t,["name"],r);const s=N(e,["deployedModelId"]);return s!=null&&S(t,["deployedModelId"],s),t}function tZ(n,e){const t={},r=N(e,["labels","google-vertex-llm-tuning-base-model-id"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["createTime"]);s!=null&&S(t,["createTime"],s);const a=N(e,["updateTime"]);return a!=null&&S(t,["updateTime"],a),t}function nZ(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);return a!=null&&S(t,["step"],a),t}function bS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["displayName"]);s!=null&&S(t,["displayName"],s);const a=N(e,["description"]);a!=null&&S(t,["description"],a);const o=N(e,["versionId"]);o!=null&&S(t,["version"],o);const l=N(e,["deployedModels"]);if(l!=null){let x=l;Array.isArray(x)&&(x=x.map(y=>eZ(n,y))),S(t,["endpoints"],x)}const c=N(e,["labels"]);c!=null&&S(t,["labels"],c);const d=N(e,["_self"]);d!=null&&S(t,["tunedModelInfo"],tZ(n,d));const h=N(e,["defaultCheckpointId"]);h!=null&&S(t,["defaultCheckpointId"],h);const p=N(e,["checkpoints"]);if(p!=null){let x=p;Array.isArray(x)&&(x=x.map(y=>nZ(n,y))),S(t,["checkpoints"],x)}return t}function rZ(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["_self"]);if(s!=null){let a=FF(n,s);Array.isArray(a)&&(a=a.map(o=>bS(n,o))),S(t,["models"],a)}return t}function sZ(){return{}}function iZ(n,e){const t={},r=N(e,["totalTokens"]);return r!=null&&S(t,["totalTokens"],r),t}function aZ(n,e){const t={},r=N(e,["tokensInfo"]);return r!=null&&S(t,["tokensInfo"],r),t}function oZ(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Qc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function lZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],oZ(n,r)),t}function cZ(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>lZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function dZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],cZ(n,l)),t}const uZ="Content-Type",fZ="X-Server-Timeout",hZ="User-Agent",wS="x-goog-api-client",mZ="0.15.0",pZ=`google-genai-sdk/${mZ}`,gZ="v1beta1",xZ="v1beta",kM=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class ZF extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ClientError"}}class _S extends Error{constructor(e,t){t?super(e,{cause:t}):super(e,{cause:new Error().stack}),this.message=e,this.name="ServerError"}}class yZ{constructor(e){var t,r;this.clientOptions=Object.assign(Object.assign({},e),{project:e.project,location:e.location,apiKey:e.apiKey,vertexai:e.vertexai});const s={};this.clientOptions.vertexai?(s.apiVersion=(t=this.clientOptions.apiVersion)!==null&&t!==void 0?t:gZ,s.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(s.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:xZ,s.baseUrl="https://generativelanguage.googleapis.com/"),s.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=s,e.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(s,e.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var e;return(e=this.clientOptions.vertexai)!==null&&e!==void 0?e:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(e){if(!e||e.baseUrl===void 0||e.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[e.baseUrl.endsWith("/")?e.baseUrl.slice(0,-1):e.baseUrl];return e.apiVersion&&e.apiVersion!==""&&r.push(e.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const e=this.getBaseUrl(),t=new URL(e);return t.protocol=t.protocol=="http:"?"ws":"wss",t.toString()}setBaseUrl(e){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=e;else throw new Error("HTTP options are not correctly set.")}constructUrl(e,t,r){const s=[this.getRequestUrlInternal(t)];return r&&s.push(this.getBaseResourcePath()),e!==""&&s.push(e),new URL(`${s.join("/")}`)}shouldPrependVertexProjectPath(e){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||e.path.startsWith("projects/")||e.httpMethod==="GET"&&e.path.startsWith("publishers/google/models"))}async request(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);if(e.queryParams)for(const[o,l]of Object.entries(e.queryParams))s.searchParams.append(o,String(l));let a={};if(e.httpMethod==="GET"){if(e.body&&e.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else a.body=e.body;return a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.unaryApiCall(s,a,e.httpMethod)}patchHttpOptions(e,t){const r=JSON.parse(JSON.stringify(e));for(const[s,a]of Object.entries(t))typeof a=="object"?r[s]=Object.assign(Object.assign({},r[s]),a):a!==void 0&&(r[s]=a);return r}async requestStream(e){let t=this.clientOptions.httpOptions;e.httpOptions&&(t=this.patchHttpOptions(this.clientOptions.httpOptions,e.httpOptions));const r=this.shouldPrependVertexProjectPath(e),s=this.constructUrl(e.path,t,r);(!s.searchParams.has("alt")||s.searchParams.get("alt")!=="sse")&&s.searchParams.set("alt","sse");let a={};return a.body=e.body,a=await this.includeExtraHttpOptionsToRequestInit(a,t,e.abortSignal),this.streamApiCall(s,a,e.httpMethod)}async includeExtraHttpOptionsToRequestInit(e,t,r){if(t&&t.timeout||r){const s=new AbortController,a=s.signal;t.timeout&&t?.timeout>0&&setTimeout(()=>s.abort(),t.timeout),r&&r.addEventListener("abort",()=>{s.abort()}),e.signal=a}return e.headers=await this.getHeadersInternal(t),e}async unaryApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await PM(s),new pS(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}async streamApiCall(e,t,r){return this.apiCall(e.toString(),Object.assign(Object.assign({},t),{method:r})).then(async s=>(await PM(s),this.processStreamResponse(s))).catch(s=>{throw s instanceof Error?s:new Error(JSON.stringify(s))})}processStreamResponse(e){var t;return em(this,arguments,function*(){const s=(t=e?.body)===null||t===void 0?void 0:t.getReader(),a=new TextDecoder("utf-8");if(!s)throw new Error("Response body is empty");try{let o="";for(;;){const{done:l,value:c}=yield Jn(s.read());if(l){if(o.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const d=a.decode(c);try{const p=JSON.parse(d);if("error"in p){const x=JSON.parse(JSON.stringify(p.error)),y=x.status,_=x.code,w=`got status: ${y}. ${JSON.stringify(p)}`;if(_>=400&&_<500)throw new ZF(w);if(_>=500&&_<600)throw new _S(w)}}catch(p){const x=p;if(x.name==="ClientError"||x.name==="ServerError")throw p}o+=d;let h=o.match(kM);for(;h;){const p=h[1];try{const x=new Response(p,{headers:e?.headers,status:e?.status,statusText:e?.statusText});yield yield Jn(new pS(x)),o=o.slice(h[0].length),h=o.match(kM)}catch(x){throw new Error(`exception parsing stream chunk ${p}. ${x}`)}}}}finally{s.releaseLock()}})}async apiCall(e,t){return fetch(e,t).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const e={},t=pZ+" "+this.clientOptions.userAgentExtra;return e[hZ]=t,e[wS]=t,e[uZ]="application/json",e}async getHeadersInternal(e){const t=new Headers;if(e&&e.headers){for(const[r,s]of Object.entries(e.headers))t.append(r,s);e.timeout&&e.timeout>0&&t.append(fZ,String(Math.ceil(e.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(t),t}async uploadFile(e,t){var r;const s={};t!=null&&(s.mimeType=t.mimeType,s.name=t.name,s.displayName=t.displayName),s.name&&!s.name.startsWith("files/")&&(s.name=`files/${s.name}`);const a=this.clientOptions.uploader,o=await a.stat(e);s.sizeBytes=String(o.size);const l=(r=t?.mimeType)!==null&&r!==void 0?r:o.type;if(l===void 0||l==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");s.mimeType=l;const c=await this.fetchUploadUrl(s,t);return a.upload(e,c,this)}async downloadFile(e){await this.clientOptions.downloader.download(e,this)}async fetchUploadUrl(e,t){var r;let s={};t?.httpOptions?s=t.httpOptions:s={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${e.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${e.mimeType}`}};const a={file:e},o=await this.request({path:Ft("upload/v1beta/files",a._url),body:JSON.stringify(a),httpMethod:"POST",httpOptions:s});if(!o||!o?.headers)throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const l=(r=o?.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(l===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return l}}async function PM(n){var e;if(n===void 0)throw new _S("response is undefined");if(!n.ok){const t=n.status,r=n.statusText;let s;!((e=n.headers.get("content-type"))===null||e===void 0)&&e.includes("application/json")?s=await n.json():s={error:{message:await n.text(),code:n.status,status:n.statusText}};const a=`got status: ${t} ${r}. ${JSON.stringify(s)}`;throw t>=400&&t<500?new ZF(a):t>=500&&t<600?new _S(a):new Error(a)}}const vZ="mcp_used/unknown";function jS(n){for(const e of n)if(S1(e)||typeof e=="object"&&"inputSchema"in e)return!0;return!1}function NS(n){var e;n[wS]=(((e=n[wS])!==null&&e!==void 0?e:"")+` ${vZ}`).trimStart()}function bZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>S1(s)))!==null&&r!==void 0?r:!1}function wZ(n){var e,t,r;return(r=(t=(e=n.config)===null||e===void 0?void 0:e.tools)===null||t===void 0?void 0:t.some(s=>!S1(s)))!==null&&r!==void 0?r:!1}function S1(n){return n!==null&&typeof n=="object"&&"tool"in n&&"callTool"in n}async function _Z(n,e,t){const r=new O8,s=JSON.parse(t.data),a=B7(n,s);Object.assign(r,a),e(r)}class jZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r}async connect(e){var t,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const s=this.apiClient.getWebsocketBaseUrl(),a=this.apiClient.getApiVersion(),o=CZ(this.apiClient.getDefaultHeaders()),l=this.apiClient.getApiKey(),c=`${s}/ws/google.ai.generativelanguage.${a}.GenerativeService.BidiGenerateMusic?key=${l}`;let d=()=>{};const h=new Promise(O=>{d=O}),p=e.callbacks,x=function(){d({})},y=this.apiClient,_={onopen:x,onmessage:O=>{_Z(y,p.onmessage,O)},onerror:(t=p?.onerror)!==null&&t!==void 0?t:function(O){},onclose:(r=p?.onclose)!==null&&r!==void 0?r:function(O){}},w=this.webSocketFactory.create(c,SZ(o),_);w.connect(),await h;const j=Wn(this.apiClient,e.model),C=VF(this.apiClient,{model:j}),P=yS(this.apiClient,{setup:C});return w.send(JSON.stringify(P)),new NZ(w,this.apiClient)}}class NZ{constructor(e,t){this.conn=e,this.apiClient=t}async setClientContent(e){if(!e.weightedPrompts||Object.keys(e.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const t=s7(this.apiClient,e),r=WF(this.apiClient,t);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(e){e.musicGenerationConfig||(e.musicGenerationConfig={});const t=i7(this.apiClient,e),r=yS(this.apiClient,t);this.conn.send(JSON.stringify(r))}sendPlaybackControl(e){const t=yS(this.apiClient,{playbackControl:e});this.conn.send(JSON.stringify(t))}play(){this.sendPlaybackControl(cf.PLAY)}pause(){this.sendPlaybackControl(cf.PAUSE)}stop(){this.sendPlaybackControl(cf.STOP)}resetContext(){this.sendPlaybackControl(cf.RESET_CONTEXT)}close(){this.conn.close()}}function SZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function CZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const TZ="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function kZ(n,e,t){const r=new D8;let s;if(t.data instanceof Blob?s=JSON.parse(await t.data.text()):s=JSON.parse(t.data),n.isVertexAI()){const a=O7(n,s);Object.assign(r,a)}else{const a=D7(n,s);Object.assign(r,a)}e(r)}class PZ{constructor(e,t,r){this.apiClient=e,this.auth=t,this.webSocketFactory=r,this.music=new jZ(this.apiClient,this.auth,this.webSocketFactory)}async connect(e){var t,r,s,a,o,l;const c=this.apiClient.getWebsocketBaseUrl(),d=this.apiClient.getApiVersion();let h;const p=this.apiClient.getDefaultHeaders();e.config&&e.config.tools&&jS(e.config.tools)&&NS(p);const x=OZ(p);if(this.apiClient.isVertexAI())h=`${c}/ws/google.cloud.aiplatform.${d}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(x);else{const B=this.apiClient.getApiKey();h=`${c}/ws/google.ai.generativelanguage.${d}.GenerativeService.BidiGenerateContent?key=${B}`}let y=()=>{};const _=new Promise(B=>{y=B}),w=e.callbacks,j=function(){var B;(B=w?.onopen)===null||B===void 0||B.call(w),y({})},C=this.apiClient,P={onopen:j,onmessage:B=>{kZ(C,w.onmessage,B)},onerror:(t=w?.onerror)!==null&&t!==void 0?t:function(B){},onclose:(r=w?.onclose)!==null&&r!==void 0?r:function(B){}},O=this.webSocketFactory.create(h,DZ(x),P);O.connect(),await _;let M=Wn(this.apiClient,e.model);if(this.apiClient.isVertexAI()&&M.startsWith("publishers/")){const B=this.apiClient.getProject(),U=this.apiClient.getLocation();M=`projects/${B}/locations/${U}/`+M}let D={};this.apiClient.isVertexAI()&&((s=e.config)===null||s===void 0?void 0:s.responseModalities)===void 0&&(e.config===void 0?e.config={responseModalities:[fm.AUDIO]}:e.config.responseModalities=[fm.AUDIO]),!((a=e.config)===null||a===void 0)&&a.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const I=(l=(o=e.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[],F=[];for(const B of I)if(this.isCallableTool(B)){const U=B;F.push(await U.tool())}else F.push(B);F.length>0&&(e.config.tools=F);const q={model:M,config:e.config,callbacks:e.callbacks};return this.apiClient.isVertexAI()?D=J9(this.apiClient,q):D=K9(this.apiClient,q),delete D.config,O.send(JSON.stringify(D)),new EZ(O,this.apiClient)}isCallableTool(e){return"callTool"in e&&typeof e.callTool=="function"}}const MZ={turnComplete:!0};class EZ{constructor(e,t){this.conn=e,this.apiClient=t}tLiveClientContent(e,t){if(t.turns!==null&&t.turns!==void 0){let r=[];try{r=Ea(e,t.turns),e.isVertexAI()?r=r.map(s=>$f(e,s)):r=r.map(s=>iy(e,s))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof t.turns}'`)}return{clientContent:{turns:r,turnComplete:t.turnComplete}}}return{clientContent:{turnComplete:t.turnComplete}}}tLiveClienttToolResponse(e,t){let r=[];if(t.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(t.functionResponses)?r=t.functionResponses:r=[t.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const a of r){if(typeof a!="object"||a===null||!("name"in a)||!("response"in a))throw new Error(`Could not parse function response, type '${typeof a}'.`);if(!e.isVertexAI()&&!("id"in a))throw new Error(TZ)}return{toolResponse:{functionResponses:r}}}sendClientContent(e){e=Object.assign(Object.assign({},MZ),e);const t=this.tLiveClientContent(this.apiClient,e);this.conn.send(JSON.stringify(t))}sendRealtimeInput(e){let t={};this.apiClient.isVertexAI()?t={realtimeInput:r7(this.apiClient,e)}:t={realtimeInput:n7(this.apiClient,e)},this.conn.send(JSON.stringify(t))}sendToolResponse(e){if(e.functionResponses==null)throw new Error("Tool response parameters are required.");const t=this.tLiveClienttToolResponse(this.apiClient,e);this.conn.send(JSON.stringify(t))}close(){this.conn.close()}}function DZ(n){const e={};return n.forEach((t,r)=>{e[r]=t}),e}function OZ(n){const e=new Headers;for(const[t,r]of Object.entries(n))e.append(t,r);return e}const MM=10;function EM(n){var e,t,r;if(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.disable)return!0;let s=!1;for(const o of(t=n?.tools)!==null&&t!==void 0?t:[])if(cx(o)){s=!0;break}if(!s)return!0;const a=(r=n?.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return a&&(a<0||!Number.isInteger(a))||a==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",a),!0):!1}function cx(n){return"callTool"in n&&typeof n.callTool=="function"}function DM(n){var e;return!(!((e=n?.automaticFunctionCalling)===null||e===void 0)&&e.ignoreCallHistory)}class IZ extends Dm{constructor(e){super(),this.apiClient=e,this.generateContent=async t=>{var r,s,a,o,l;if(t.config&&t.config.tools&&jS(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),NS(t.config.httpOptions.headers)),!bZ(t)||EM(t.config))return await this.generateContentInternal(t);if(wZ(t))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");const c=await this.transformCallableTools(t);let d,h;const p=Ea(this.apiClient,c.contents),x=(a=(s=(r=c.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||s===void 0?void 0:s.maximumRemoteCalls)!==null&&a!==void 0?a:MM;let y=0;for(;y<x&&(d=await this.generateContentInternal(c),!(!d.functionCalls||d.functionCalls.length===0));){const _=d.candidates[0].content,w=[];for(const j of(l=(o=t.config)===null||o===void 0?void 0:o.tools)!==null&&l!==void 0?l:[])if(cx(j)){const P=await j.callTool(d.functionCalls);w.push(...P)}y++,h={role:"user",parts:w},c.contents=Ea(this.apiClient,c.contents),c.contents.push(_),c.contents.push(h),DM(c.config)&&(p.push(_),p.push(h))}return DM(c.config)&&(d.automaticFunctionCallingHistory=p),d},this.generateContentStream=async t=>{if(t.config&&t.config.tools&&jS(t.config.tools)&&(t.config.httpOptions||(t.config.httpOptions={}),t.config.httpOptions.headers||(t.config.httpOptions.headers=this.apiClient.getDefaultHeaders()),NS(t.config.httpOptions.headers)),EM(t.config)){const r=await this.transformCallableTools(t);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(t)},this.generateImages=async t=>await this.generateImagesInternal(t).then(r=>{var s;let a;const o=[];if(r?.generatedImages)for(const c of r.generatedImages)c&&c?.safetyAttributes&&((s=c?.safetyAttributes)===null||s===void 0?void 0:s.contentType)==="Positive Prompt"?a=c?.safetyAttributes:o.push(c);let l;return a?l={generatedImages:o,positivePromptSafetyAttributes:a}:l={generatedImages:o},l}),this.list=async t=>{var r;const o={config:Object.assign(Object.assign({},{queryBase:!0}),t?.config)};if(this.apiClient.isVertexAI()&&!o.config.queryBase){if(!((r=o.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");o.config.filter="labels.tune-type:*"}return new sy(Df.PAGED_ITEM_MODELS,l=>this.listInternal(l),await this.listInternal(o),o)},this.editImage=async t=>{const r={model:t.model,prompt:t.prompt,referenceImages:[],config:t.config};return t.referenceImages&&t.referenceImages&&(r.referenceImages=t.referenceImages.map(s=>s.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async t=>{let r={numberOfImages:1,mode:"upscale"};t.config&&(r=Object.assign(Object.assign({},r),t.config));const s={model:t.model,image:t.image,upscaleFactor:t.upscaleFactor,config:r};return await this.upscaleImageInternal(s)}}async transformCallableTools(e){var t;const r=(t=e.config)===null||t===void 0?void 0:t.tools;if(!r)return e;const s=await Promise.all(r.map(async o=>cx(o)?await o.tool():o)),a={model:e.model,contents:e.contents,config:Object.assign(Object.assign({},e.config),{tools:s})};return a.config.tools=s,a}async initAfcToolsMap(e){var t,r,s;const a=new Map;for(const o of(r=(t=e.config)===null||t===void 0?void 0:t.tools)!==null&&r!==void 0?r:[])if(cx(o)){const l=o,c=await l.tool();for(const d of(s=c.functionDeclarations)!==null&&s!==void 0?s:[]){if(!d.name)throw new Error("Function declaration name is required.");if(a.has(d.name))throw new Error(`Duplicate tool declaration name: ${d.name}`);a.set(d.name,l)}}return a}async processAfcStream(e){var t,r,s;const a=(s=(r=(t=e.config)===null||t===void 0?void 0:t.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&s!==void 0?s:MM;let o=!1,l=0;const c=await this.initAfcToolsMap(e);return(function(d,h,p){var x,y;return em(this,arguments,function*(){for(var _,w,j,C;l<a;){o&&(l++,o=!1);const D=yield Jn(d.transformCallableTools(p)),I=yield Jn(d.generateContentStreamInternal(D)),F=[],q=[];try{for(var P=!0,O=(w=void 0,lx(I)),M;M=yield Jn(O.next()),_=M.done,!_;P=!0){C=M.value,P=!1;const B=C;if(yield yield Jn(B),B.candidates&&(!((x=B.candidates[0])===null||x===void 0)&&x.content)){q.push(B.candidates[0].content);for(const U of(y=B.candidates[0].content.parts)!==null&&y!==void 0?y:[])if(l<a&&U.functionCall){if(!U.functionCall.name)throw new Error("Function call name was not returned by the model.");if(h.has(U.functionCall.name)){const W=yield Jn(h.get(U.functionCall.name).callTool([U.functionCall]));F.push(...W)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${h.keys()}, mising tool: ${U.functionCall.name}`)}}}}catch(B){w={error:B}}finally{try{!P&&!_&&(j=O.return)&&(yield Jn(j.call(O)))}finally{if(w)throw w.error}}if(F.length>0){o=!0;const B=new wh;B.candidates=[{content:{role:"user",parts:F}}],yield yield Jn(B);const U=[];U.push(...q),U.push({role:"user",parts:F});const W=Ea(d.apiClient,p.contents).concat(U);p.contents=W}else break}})})(this,c,e)}async generateContentInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=SM(this.apiClient,e);return l=Ft("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=TM(this.apiClient,h),x=new wh;return Object.assign(x,p),x})}else{const d=NM(this.apiClient,e);return l=Ft("{model}:generateContent",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=CM(this.apiClient,h),x=new wh;return Object.assign(x,p),x})}}async generateContentStreamInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=SM(this.apiClient,e);l=Ft("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}),o.then(function(p){return em(this,arguments,function*(){var x,y,_,w;try{for(var j=!0,C=lx(p),P;P=yield Jn(C.next()),x=P.done,!x;j=!0){w=P.value,j=!1;const M=TM(h,yield Jn(w.json())),D=new wh;Object.assign(D,M),yield yield Jn(D)}}catch(O){y={error:O}}finally{try{!j&&!x&&(_=C.return)&&(yield Jn(_.call(C)))}finally{if(y)throw y.error}}})})}else{const d=NM(this.apiClient,e);l=Ft("{model}:streamGenerateContent?alt=sse",d._url),c=d._query,delete d.config,delete d._url,delete d._query;const h=this.apiClient;return o=h.requestStream({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}),o.then(function(p){return em(this,arguments,function*(){var x,y,_,w;try{for(var j=!0,C=lx(p),P;P=yield Jn(C.next()),x=P.done,!x;j=!0){w=P.value,j=!1;const M=CM(h,yield Jn(w.json())),D=new wh;Object.assign(D,M),yield yield Jn(D)}}catch(O){y={error:O}}finally{try{!j&&!x&&(_=C.return)&&(yield Jn(_.call(C)))}finally{if(y)throw y.error}}})})}}async embedContent(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=ZY(this.apiClient,e);return l=Ft("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=ZG(this.apiClient,h),x=new sM;return Object.assign(x,p),x})}else{const d=uY(this.apiClient,e);return l=Ft("{model}:batchEmbedContents",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=kG(this.apiClient,h),x=new sM;return Object.assign(x,p),x})}}async generateImagesInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=JY(this.apiClient,e);return l=Ft("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=JG(this.apiClient,h),x=new iM;return Object.assign(x,p),x})}else{const d=hY(this.apiClient,e);return l=Ft("{model}:predict",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=EG(this.apiClient,h),x=new iM;return Object.assign(x,p),x})}}async editImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=sG(this.apiClient,e);return a=Ft("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=QG(this.apiClient,c),h=new C8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=aG(this.apiClient,e);return a=Ft("{model}:predict",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=XG(this.apiClient,c),h=new T8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async get(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=oG(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>bS(this.apiClient,h))}else{const d=mY(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>vS(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=cG(this.apiClient,e);return l=Ft("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=rZ(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}else{const d=gY(this.apiClient,e);return l=Ft("{models_url}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=OG(this.apiClient,h),x=new aM;return Object.assign(x,p),x})}}async update(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=uG(this.apiClient,e);return l=Ft("{model}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>bS(this.apiClient,h))}else{const d=yY(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"PATCH",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>vS(this.apiClient,h))}}async delete(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=fG(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(()=>{const h=sZ(),p=new oM;return Object.assign(p,h),p})}else{const d=vY(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"DELETE",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(()=>{const h=IG(),p=new oM;return Object.assign(p,h),p})}}async countTokens(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=mG(this.apiClient,e);return l=Ft("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=iZ(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}else{const d=wY(this.apiClient,e);return l=Ft("{model}:countTokens",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=AG(this.apiClient,h),x=new lM;return Object.assign(x,p),x})}}async computeTokens(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=pG(this.apiClient,e);return a=Ft("{model}:computeTokens",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>{const d=aZ(this.apiClient,c),h=new k8;return Object.assign(h,d),h})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideos(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=xG(this.apiClient,e);return l=Ft("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>dZ(this.apiClient,h))}else{const d=NY(this.apiClient,e);return l=Ft("{model}:predictLongRunning",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"POST",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>qG(this.apiClient,h))}}}function AZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function RZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["_url","operationName"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function LZ(n,e){const t={},r=N(e,["operationName"]);r!=null&&S(t,["operationName"],r);const s=N(e,["resourceName"]);s!=null&&S(t,["_url","resourceName"],s);const a=N(e,["config"]);return a!=null&&S(t,["config"],a),t}function FZ(n,e){const t={},r=N(e,["video","uri"]);r!=null&&S(t,["uri"],r);const s=N(e,["video","encodedVideo"]);s!=null&&S(t,["videoBytes"],Qc(n,s));const a=N(e,["encoding"]);return a!=null&&S(t,["mimeType"],a),t}function qZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],FZ(n,r)),t}function zZ(n,e){const t={},r=N(e,["generatedSamples"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>qZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function UZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response","generateVideoResponse"]);return l!=null&&S(t,["response"],zZ(n,l)),t}function BZ(n,e){const t={},r=N(e,["gcsUri"]);r!=null&&S(t,["uri"],r);const s=N(e,["bytesBase64Encoded"]);s!=null&&S(t,["videoBytes"],Qc(n,s));const a=N(e,["mimeType"]);return a!=null&&S(t,["mimeType"],a),t}function VZ(n,e){const t={},r=N(e,["_self"]);return r!=null&&S(t,["video"],BZ(n,r)),t}function WZ(n,e){const t={},r=N(e,["videos"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>VZ(n,l))),S(t,["generatedVideos"],o)}const s=N(e,["raiMediaFilteredCount"]);s!=null&&S(t,["raiMediaFilteredCount"],s);const a=N(e,["raiMediaFilteredReasons"]);return a!=null&&S(t,["raiMediaFilteredReasons"],a),t}function OM(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);o!=null&&S(t,["error"],o);const l=N(e,["response"]);return l!=null&&S(t,["response"],WZ(n,l)),t}class $Z extends Dm{constructor(e){super(),this.apiClient=e}async getVideosOperation(e){const t=e.operation,r=e.config;if(t.name===void 0||t.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const s=t.name.split("/operations/")[0];let a;return r&&"httpOptions"in r&&(a=r.httpOptions),this.fetchPredictVideosOperationInternal({operationName:t.name,resourceName:s,config:{httpOptions:a}})}else return this.getVideosOperationInternal({operationName:t.name,config:r})}async getVideosOperationInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=RZ(this.apiClient,e);return l=Ft("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>OM(this.apiClient,h))}else{const d=AZ(this.apiClient,e);return l=Ft("{operationName}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>UZ(this.apiClient,h))}}async fetchPredictVideosOperationInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=LZ(this.apiClient,e);return a=Ft("{resourceName}:fetchPredictOperation",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>OM(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}}function HZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function YZ(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function GZ(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],YZ(n,r,t)),t}function ZZ(n,e){const t={},r=N(e,["textInput"]);r!=null&&S(t,["textInput"],r);const s=N(e,["output"]);return s!=null&&S(t,["output"],s),t}function KZ(n,e){const t={};if(N(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const r=N(e,["examples"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>ZZ(n,a))),S(t,["examples","examples"],s)}return t}function JZ(n,e,t){const r={};if(N(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const s=N(e,["tunedModelDisplayName"]);if(t!==void 0&&s!=null&&S(t,["displayName"],s),N(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const a=N(e,["epochCount"]);t!==void 0&&a!=null&&S(t,["tuningTask","hyperparameters","epochCount"],a);const o=N(e,["learningRateMultiplier"]);if(o!=null&&S(r,["tuningTask","hyperparameters","learningRateMultiplier"],o),N(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(N(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const l=N(e,["batchSize"]);t!==void 0&&l!=null&&S(t,["tuningTask","hyperparameters","batchSize"],l);const c=N(e,["learningRate"]);return t!==void 0&&c!=null&&S(t,["tuningTask","hyperparameters","learningRate"],c),r}function QZ(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["tuningTask","trainingData"],KZ(n,s));const a=N(e,["config"]);return a!=null&&S(t,["config"],JZ(n,a,t)),t}function XZ(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["_url","name"],r);const s=N(e,["config"]);return s!=null&&S(t,["config"],s),t}function eK(n,e,t){const r={},s=N(e,["pageSize"]);t!==void 0&&s!=null&&S(t,["_query","pageSize"],s);const a=N(e,["pageToken"]);t!==void 0&&a!=null&&S(t,["_query","pageToken"],a);const o=N(e,["filter"]);return t!==void 0&&o!=null&&S(t,["_query","filter"],o),r}function tK(n,e){const t={},r=N(e,["config"]);return r!=null&&S(t,["config"],eK(n,r,t)),t}function nK(n,e,t){const r={},s=N(e,["gcsUri"]);if(t!==void 0&&s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],s),N(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return r}function rK(n,e){const t={},r=N(e,["gcsUri"]);return r!=null&&S(t,["validationDatasetUri"],r),t}function sK(n,e,t){const r={},s=N(e,["validationDataset"]);t!==void 0&&s!=null&&S(t,["supervisedTuningSpec"],rK(n,s));const a=N(e,["tunedModelDisplayName"]);t!==void 0&&a!=null&&S(t,["tunedModelDisplayName"],a);const o=N(e,["description"]);t!==void 0&&o!=null&&S(t,["description"],o);const l=N(e,["epochCount"]);t!==void 0&&l!=null&&S(t,["supervisedTuningSpec","hyperParameters","epochCount"],l);const c=N(e,["learningRateMultiplier"]);t!==void 0&&c!=null&&S(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],c);const d=N(e,["exportLastCheckpointOnly"]);t!==void 0&&d!=null&&S(t,["supervisedTuningSpec","exportLastCheckpointOnly"],d);const h=N(e,["adapterSize"]);if(t!==void 0&&h!=null&&S(t,["supervisedTuningSpec","hyperParameters","adapterSize"],h),N(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(N(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return r}function iK(n,e){const t={},r=N(e,["baseModel"]);r!=null&&S(t,["baseModel"],r);const s=N(e,["trainingDataset"]);s!=null&&S(t,["supervisedTuningSpec","trainingDatasetUri"],nK(n,s,t));const a=N(e,["config"]);return a!=null&&S(t,["config"],sK(n,a,t)),t}function aK(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["model"],r);const s=N(e,["name"]);return s!=null&&S(t,["endpoint"],s),t}function KF(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],AF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["tuningTask","startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["tuningTask","completeTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["description"]);d!=null&&S(t,["description"],d);const h=N(e,["baseModel"]);h!=null&&S(t,["baseModel"],h);const p=N(e,["_self"]);p!=null&&S(t,["tunedModel"],aK(n,p));const x=N(e,["distillationSpec"]);x!=null&&S(t,["distillationSpec"],x);const y=N(e,["experiment"]);y!=null&&S(t,["experiment"],y);const _=N(e,["labels"]);_!=null&&S(t,["labels"],_);const w=N(e,["pipelineJob"]);w!=null&&S(t,["pipelineJob"],w);const j=N(e,["tunedModelDisplayName"]);return j!=null&&S(t,["tunedModelDisplayName"],j),t}function oK(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tunedModels"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>KF(n,o))),S(t,["tuningJobs"],a)}return t}function lK(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["metadata"]);s!=null&&S(t,["metadata"],s);const a=N(e,["done"]);a!=null&&S(t,["done"],a);const o=N(e,["error"]);return o!=null&&S(t,["error"],o),t}function cK(n,e){const t={},r=N(e,["checkpointId"]);r!=null&&S(t,["checkpointId"],r);const s=N(e,["epoch"]);s!=null&&S(t,["epoch"],s);const a=N(e,["step"]);a!=null&&S(t,["step"],a);const o=N(e,["endpoint"]);return o!=null&&S(t,["endpoint"],o),t}function dK(n,e){const t={},r=N(e,["model"]);r!=null&&S(t,["model"],r);const s=N(e,["endpoint"]);s!=null&&S(t,["endpoint"],s);const a=N(e,["checkpoints"]);if(a!=null){let o=a;Array.isArray(o)&&(o=o.map(l=>cK(n,l))),S(t,["checkpoints"],o)}return t}function SS(n,e){const t={},r=N(e,["name"]);r!=null&&S(t,["name"],r);const s=N(e,["state"]);s!=null&&S(t,["state"],AF(n,s));const a=N(e,["createTime"]);a!=null&&S(t,["createTime"],a);const o=N(e,["startTime"]);o!=null&&S(t,["startTime"],o);const l=N(e,["endTime"]);l!=null&&S(t,["endTime"],l);const c=N(e,["updateTime"]);c!=null&&S(t,["updateTime"],c);const d=N(e,["error"]);d!=null&&S(t,["error"],d);const h=N(e,["description"]);h!=null&&S(t,["description"],h);const p=N(e,["baseModel"]);p!=null&&S(t,["baseModel"],p);const x=N(e,["tunedModel"]);x!=null&&S(t,["tunedModel"],dK(n,x));const y=N(e,["supervisedTuningSpec"]);y!=null&&S(t,["supervisedTuningSpec"],y);const _=N(e,["tuningDataStats"]);_!=null&&S(t,["tuningDataStats"],_);const w=N(e,["encryptionSpec"]);w!=null&&S(t,["encryptionSpec"],w);const j=N(e,["partnerModelTuningSpec"]);j!=null&&S(t,["partnerModelTuningSpec"],j);const C=N(e,["distillationSpec"]);C!=null&&S(t,["distillationSpec"],C);const P=N(e,["experiment"]);P!=null&&S(t,["experiment"],P);const O=N(e,["labels"]);O!=null&&S(t,["labels"],O);const M=N(e,["pipelineJob"]);M!=null&&S(t,["pipelineJob"],M);const D=N(e,["tunedModelDisplayName"]);return D!=null&&S(t,["tunedModelDisplayName"],D),t}function uK(n,e){const t={},r=N(e,["nextPageToken"]);r!=null&&S(t,["nextPageToken"],r);const s=N(e,["tuningJobs"]);if(s!=null){let a=s;Array.isArray(a)&&(a=a.map(o=>SS(n,o))),S(t,["tuningJobs"],a)}return t}class fK extends Dm{constructor(e){super(),this.apiClient=e,this.get=async t=>await this.getInternal(t),this.list=async(t={})=>new sy(Df.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(t),t),this.tune=async t=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(t);{const r=await this.tuneMldevInternal(t);let s="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?s=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(s=r.name.split("/operations/")[0]),{name:s,state:mS.JOB_STATE_QUEUED}}}}async getInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=XZ(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>SS(this.apiClient,h))}else{const d=HZ(this.apiClient,e);return l=Ft("{name}",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>KF(this.apiClient,h))}}async listInternal(e){var t,r,s,a;let o,l="",c={};if(this.apiClient.isVertexAI()){const d=tK(this.apiClient,e);return l=Ft("tuningJobs",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(h=>h.json()),o.then(h=>{const p=uK(this.apiClient,h),x=new cM;return Object.assign(x,p),x})}else{const d=GZ(this.apiClient,e);return l=Ft("tunedModels",d._url),c=d._query,delete d.config,delete d._url,delete d._query,o=this.apiClient.request({path:l,queryParams:c,body:JSON.stringify(d),httpMethod:"GET",httpOptions:(s=e.config)===null||s===void 0?void 0:s.httpOptions,abortSignal:(a=e.config)===null||a===void 0?void 0:a.abortSignal}).then(h=>h.json()),o.then(h=>{const p=oK(this.apiClient,h),x=new cM;return Object.assign(x,p),x})}}async tuneInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI()){const l=iK(this.apiClient,e);return a=Ft("tuningJobs",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>SS(this.apiClient,c))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(e){var t,r;let s,a="",o={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const l=QZ(this.apiClient,e);return a=Ft("tunedModels",l._url),o=l._query,delete l.config,delete l._url,delete l._query,s=this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(t=e.config)===null||t===void 0?void 0:t.httpOptions,abortSignal:(r=e.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),s.then(c=>lK(this.apiClient,c))}}}class hK{async download(e,t){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const mK=1024*1024*8,pK=3,gK=1e3,xK=2,hb="x-goog-upload-status";async function yK(n,e,t){var r,s,a;let o=0,l=0,c=new pS(new Response),d="upload";for(o=n.size;l<o;){const p=Math.min(mK,o-l),x=n.slice(l,l+p);l+p>=o&&(d+=", finalize");let y=0,_=gK;for(;y<pK&&(c=await t.request({path:"",body:x,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:e,headers:{"X-Goog-Upload-Command":d,"X-Goog-Upload-Offset":String(l),"Content-Length":String(p)}}}),!(!((r=c?.headers)===null||r===void 0)&&r[hb]));)y++,await bK(_),_=_*xK;if(l+=p,((s=c?.headers)===null||s===void 0?void 0:s[hb])!=="active")break;if(o<=l)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const h=await c?.json();if(((a=c?.headers)===null||a===void 0?void 0:a[hb])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return h.file}async function vK(n){return{size:n.size,type:n.type}}function bK(n){return new Promise(e=>setTimeout(e,n))}class wK{async upload(e,t,r){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await yK(e,t,r)}async stat(e){if(typeof e=="string")throw new Error("File path is not supported in browser uploader.");return await vK(e)}}class _K{create(e,t,r){return new jK(e,t,r)}}class jK{constructor(e,t,r){this.url=e,this.headers=t,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(e){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(e)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}const IM="x-goog-api-key";class NK{constructor(e){this.apiKey=e}async addAuthHeaders(e){e.get(IM)===null&&e.append(IM,this.apiKey)}}const SK="gl-node/";class CK{constructor(e){var t;if(e.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(e.project||e.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(t=e.vertexai)!==null&&t!==void 0?t:!1,this.apiKey=e.apiKey;const r=S8(e,void 0,void 0);r&&(e.httpOptions?e.httpOptions.baseUrl=r:e.httpOptions={baseUrl:r}),this.apiVersion=e.apiVersion;const s=new NK(this.apiKey);this.apiClient=new yZ({auth:s,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:e.httpOptions,userAgentExtra:SK+"web",uploader:new wK,downloader:new hK}),this.models=new IZ(this.apiClient),this.live=new PZ(this.apiClient,s,new _K),this.chats=new WH(this.models,this.apiClient),this.caches=new UH(this.apiClient),this.files=new r9(this.apiClient),this.operations=new $Z(this.apiClient),this.tunings=new fK(this.apiClient)}}const hm="onboarding-documents",CS="avatars",AM="support-attachments",_h="logo",jh="background",TK="task-attachments",kK="your-google-genai-api-key";let ml=null;ml=new CK({apiKey:kK});const TS=n=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return n.map(TS);const e={...n};if(typeof e.name=="string"&&typeof e.path=="string"){const t=e.path.startsWith("avatars/")?CS:hm,{data:{publicUrl:r}}=Me.storage.from(t).getPublicUrl(e.path);e.preview=r,e.url=r}for(const t in e)e[t]=TS(e[t]);return e},kS=async(n,e,t)=>{if(n===null||typeof n!="object")return n;if(Array.isArray(n))return Promise.all(n.map(s=>kS(s,e,t)));const r={...n};if(r.file instanceof File){const s=r.file,a=`${e}/documents/${Date.now()}_${s.name}`,{error:o}=await Me.storage.from(hm).upload(a,s);if(o)throw o;try{await Me.from("user_documents").insert({user_id:e,submission_id:t||null,name:r.name||s.name,bucket:hm,path:a,file_type:s.type,file_size:s.size})}catch(l){console.error("Failed to record uploaded document:",l)}return{name:r.name||s.name,type:s.type,size:s.size,path:a}}if(typeof r.name=="string"&&r.path)return{name:r.name,type:r.type,size:r.size,path:r.path};for(const s in r)Object.prototype.hasOwnProperty.call(r,s)&&(r[s]=await kS(r[s],e,t));return r},PK=async n=>await(await fetch(n)).blob(),hn=n=>{if(Array.isArray(n))return n.map(e=>hn(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)&&!(n instanceof File)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/[A-Z]/g,s=>`_${s.toLowerCase()}`);e[r]=hn(n[t])}return e}return n},xt=n=>{if(Array.isArray(n))return n.map(e=>xt(e));if(n!==null&&typeof n=="object"&&!(n instanceof Date)){const e={};for(const t in n)if(Object.prototype.hasOwnProperty.call(n,t)){const r=t.replace(/_([a-z])/g,s=>s[1].toUpperCase());e[r]=xt(n[t])}return TS(e)}return n},ue={getInitialAppData:async()=>{const{data:n,error:e}=await Me.from("settings").select("*").eq("id","singleton").single();if(e)throw new Error("Failed to fetch core application settings.");const{data:t,error:r}=await Me.from("roles").select("*");if(r)throw new Error("Failed to fetch user roles.");const{data:s,error:a}=await Me.from("holidays").select("*");if(a)throw new Error("Failed to fetch holidays.");return{settings:xt(n),roles:(t||[]).map(xt),holidays:(s||[]).map(xt)}},getVerificationSubmissions:async(n,e)=>{let t=Me.from("onboarding_submissions").select("*");n&&(t=t.eq("status",n)),e&&(t=t.eq("organization_id",e));const{data:r,error:s}=await t.order("created_at",{ascending:!1});if(s)throw s;return(r||[]).map(xt)},getOnboardingDataById:async n=>{const{data:e,error:t}=await Me.from("onboarding_submissions").select("*").eq("id",n).single();if(t&&t.code!=="PGRST116")throw t;return e?xt(e):null},_saveSubmission:async(n,e)=>{const{data:{session:t}}=await Me.auth.getSession();if(!t?.user)throw new Error("User not authenticated");const r=n.id&&!n.id.startsWith("draft_")?n.id:crypto.randomUUID(),s=await kS(n,t.user.id,r),a={...hn(s),id:r,user_id:t.user.id,status:e?"draft":n.status};delete a.file,delete a.confirm_account_number;const{data:o,error:l}=await Me.from("onboarding_submissions").upsert(a,{onConflict:"id"}).select("id").single();if(l)throw l;return{draftId:o.id}},saveDraft:async n=>ue._saveSubmission(n,!0),submitOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,!1),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve submitted data.");return t},updateOnboarding:async n=>{const{draftId:e}=await ue._saveSubmission(n,n.status==="draft"),t=await ue.getOnboardingDataById(e);if(!t)throw new Error("Failed to retrieve updated data.");return t},verifySubmission:async n=>{const{error:e}=await Me.from("onboarding_submissions").update({status:"verified",portal_sync_status:"pending_sync"}).eq("id",n);if(e)throw e},requestChanges:async(n,e)=>{const{error:t}=await Me.from("onboarding_submissions").update({status:"rejected"}).eq("id",n);if(t)throw t},syncPortals:async n=>{const{data:e,error:t}=await Me.functions.invoke("sync-portals",{body:{submissionId:n}});if(t)throw t;return xt(e)},deleteFile:async n=>{const{error:e}=await Me.storage.from(hm).remove([n]);if(e)throw e},uploadDocument:async(n,e=hm,t,r)=>{const{data:{session:s}}=await Me.auth.getSession(),a=s?.user?.id||"anonymous_user",o=`${a}/documents/${Date.now()}_${n.name}`,{error:l}=await Me.storage.from(e).upload(o,n);if(l)throw l;const{data:c}=Me.storage.from(e).getPublicUrl(o);if(!c.publicUrl)throw new Error("Could not get public URL for uploaded file.");try{await Me.from("user_documents").insert({user_id:a,submission_id:t||null,name:r||n.name,bucket:e,path:o,file_type:n.type,file_size:n.size})}catch(d){console.error("Failed to insert user_documents record:",d)}return{url:c.publicUrl,path:o}},getUsers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, role_id");if(e)throw e;return(n||[]).map(t=>xt({...t,role:t.role_id}))},getUsersWithManagers:async()=>{const{data:n,error:e}=await Me.from("users").select("*, reporting_manager_id, role_id");if(e)throw e;const t=(n||[]).map(s=>xt({...s,role:s.role_id})),r=new Map(t.map(s=>[s.id,s.name]));return t.map(s=>({...s,managerName:s.reportingManagerId?r.get(s.reportingManagerId):void 0}))},getFieldOfficers:async()=>ue.getUsers().then(n=>n.filter(e=>e.role==="field_officer")),getNearbyUsers:async()=>{const n=await ue.getUsers();let e={};try{const t=new Date;t.setHours(0,0,0,0);const r=new Date,s=await ue.getAllAttendanceEvents(t.toISOString(),r.toISOString()),a={};s.forEach(o=>{const{userId:l,type:c,timestamp:d}=o;l&&(!a[l]||new Date(d)>new Date(a[l].timestamp))&&(a[l]={type:c.toLowerCase(),timestamp:d})}),e=Object.fromEntries(Object.entries(a).map(([o,l])=>{const c=l.type.toLowerCase().replace(/[-_\s]/g,""),d=c==="checkin";return console.log(`User ${o}: latest event type = "${l.type}", normalized = "${c}", isCheckIn = ${d}`),[o,d]}))}catch(t){console.warn("Failed to compute user availability:",t)}return n.map(t=>({...t,isAvailable:e[t.id]??!1}))},updateUser:async(n,e)=>{const{role:t,...r}=e,s=hn(r);if(t&&(s.role_id=t),"photo_url"in s){const{data:{session:l}}=await Me.auth.getSession();if(!l?.user)throw new Error("User not authenticated for photo upload");const c=l.user.id,{data:d}=await Me.from("users").select("photo_url").eq("id",n).single(),h=d?.photo_url,p=async x=>{if(x)try{const _=new URL(x).pathname.split("/public/")[1];if(_){const[w,...j]=_.split("/"),C=j.join("/");C&&await Me.storage.from(w).remove([C])}}catch(y){console.error("Failed to process old avatar URL for deletion:",y)}};if(s.photo_url&&s.photo_url.startsWith("data:")){await p(h);const x=await PK(s.photo_url),y=s.photo_url.split(";")[0].split("/")[1]||"jpg",_=`${c}/${Date.now()}.${y}`,{error:w}=await Me.storage.from(CS).upload(_,x,{upsert:!0});if(w)throw w;const{data:{publicUrl:j}}=Me.storage.from(CS).getPublicUrl(_);s.photo_url=j}else s.photo_url===null&&await p(h)}const{data:a,error:o}=await Me.from("users").update(s).eq("id",n).select().single();if(o)throw o;return xt({...a,role:a.role_id})},createUser:async n=>{const{role:e,...t}=n,r=hn(t);e&&(r.role_id=e);const{data:s,error:a}=await Me.from("users").insert(r).select().single();if(a)throw a;return xt({...s,role:s.role_id})},deleteUser:async n=>{const{error:e}=await Me.from("users").delete().eq("id",n);if(e)throw e},updateUserReportingManager:async(n,e)=>{const{error:t}=await Me.from("users").update({reporting_manager_id:e}).eq("id",n);if(t)throw t},getOrganizations:async()=>{const{data:n,error:e}=await Me.from("organizations").select("*").order("short_name");if(e)throw e;return(n||[]).map(xt)},createOrganization:async n=>{const{data:e,error:t}=await Me.from("organizations").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getOrganizationStructure:async()=>{const{data:n,error:e}=await Me.from("organization_groups").select("*");if(e)throw e;const{data:t,error:r}=await Me.from("companies").select("*");if(r)throw r;const{data:s,error:a}=await Me.from("entities").select("*");if(a)throw a;const o=(n||[]).map(xt),l=(t||[]).map(xt),c=(s||[]).map(xt),d=new Map;return l.forEach(h=>{const p={...h,entities:c.filter(x=>x.companyId===h.id)};d.has(h.groupId)||d.set(h.groupId,[]),d.get(h.groupId).push(p)}),o.map(h=>({...h,companies:d.get(h.id)||[],locations:[]}))},getSiteConfigurations:async()=>{const{data:n,error:e}=await Me.from("site_configurations").select("*");if(e)throw e;return(n||[]).map(xt)},bulkUploadOrganizations:async n=>{const{count:e,error:t}=await Me.from("organizations").upsert(hn(n),{onConflict:"id"});if(t)throw t;return{count:e||0}},getModules:async()=>{const{data:n,error:e}=await Me.from("app_modules").select("*");if(e)throw e;return(n||[]).map(xt)},saveModules:async n=>{const{error:e}=await Me.from("app_modules").upsert(hn(n));if(e)throw e},getRoles:async()=>{const{data:n,error:e}=await Me.from("roles").select("*");if(e)throw e;return(n||[]).map(xt)},saveRoles:async n=>{const{error:e}=await Me.from("roles").upsert(hn(n));if(e)throw e},getHolidays:async()=>{const{data:n,error:e}=await Me.from("holidays").select("*");if(e)throw e;return(n||[]).map(xt)},addHoliday:async n=>{const{data:e,error:t}=await Me.from("holidays").insert(hn(n)).select().single();if(t)throw t;return xt(e)},removeHoliday:async n=>{const{error:e}=await Me.from("holidays").delete().eq("id",n);if(e)throw e},getAttendanceEvents:async(n,e,t)=>{const{data:r,error:s}=await Me.from("attendance_events").select("*").eq("user_id",n).gte("timestamp",e).lte("timestamp",t);if(s)throw s;return(r||[]).map(xt)},getAllAttendanceEvents:async(n,e)=>{const{data:t,error:r}=await Me.from("attendance_events").select("*").gte("timestamp",n).lte("timestamp",e);if(r)throw r;return(t||[]).map(xt)},getAttendanceDashboardData:async(n,e,t,r="UTC")=>{const{data:s,error:a}=await Me.rpc("get_attendance_dashboard_data",{start_date_iso:We(n,"yyyy-MM-dd"),end_date_iso:We(e,"yyyy-MM-dd"),current_date_iso:We(t,"yyyy-MM-dd"),p_timezone:r});if(a)throw new Error("Could not load attendance dashboard data from the database function.");return s},addAttendanceEvent:async n=>{const{error:e}=await Me.from("attendance_events").insert(hn(n));if(e)throw e},getLocations:async()=>{const{data:n,error:e}=await Me.from("locations").select("*, created_by_user:created_by (id, name)");if(e)throw e;return(n||[]).map(t=>{const r=xt(t),a=r.createdByUser?.name||void 0,{createdByUser:o,...l}=r;return{...l,createdByName:a}})},getUserLocations:async n=>{const{data:e,error:t}=await Me.from("user_locations").select("location_id:location_id (*), id").eq("user_id",n);if(t)throw t;return(e||[]).map(r=>{const s=r.location_id||{};return xt(s)})},createLocation:async n=>{const e=hn(n),{data:t,error:r}=await Me.from("locations").insert(e).select("*").single();if(r)throw r;return xt(t)},assignLocationToUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").insert({user_id:n,location_id:e});if(t)throw t},updateLocation:async(n,e)=>{const t=hn(e),{data:r,error:s}=await Me.from("locations").update(t).eq("id",n).select("*").single();if(s)throw s;return xt(r)},deleteLocation:async n=>{const{error:e}=await Me.from("locations").delete().eq("id",n);if(e)throw e},unassignLocationFromUser:async(n,e)=>{const{error:t}=await Me.from("user_locations").delete().match({user_id:n,location_id:e});if(t)throw t},uploadLogo:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(_h).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(_h).getPublicUrl(t);return s},getLogos:async()=>{const{data:n,error:e}=await Me.storage.from(_h).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(_h).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteLogo:async n=>{const{error:e}=await Me.storage.from(_h).remove([n]);if(e)throw e},uploadBackground:async n=>{n.name.split(".").pop();const t=`${`${Date.now()}_${n.name}`}`,{error:r}=await Me.storage.from(jh).upload(t,n,{upsert:!0});if(r)throw r;const{data:{publicUrl:s}}=Me.storage.from(jh).getPublicUrl(t);return s},getBackgroundImages:async()=>{const{data:n,error:e}=await Me.storage.from(jh).list("",{limit:100,sortBy:{column:"name",order:"asc"}});if(e)throw e;return(n||[]).map(t=>{const{data:{publicUrl:r}}=Me.storage.from(jh).getPublicUrl(t.name);return{name:t.name,url:r}})},deleteBackground:async n=>{const{error:e}=await Me.storage.from(jh).remove([n]);if(e)throw e},getAttendanceSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(e)throw e;if(!n?.attendance_settings)throw new Error("Attendance settings are not configured.");return xt(n.attendance_settings)},saveAttendanceSettings:async n=>{const{error:e}=await Me.from("settings").upsert({id:"singleton",attendance_settings:hn(n),updated_at:new Date().toISOString()},{onConflict:"id"});if(e)throw console.error("Error saving attendance settings:",e),e},getRecurringHolidays:async()=>{const{data:n,error:e}=await Me.from("recurring_holidays").select("*");if(e)throw e;return(n||[]).map(t=>({id:t.id,type:t.role_type,day:t.day,n:t.occurrence}))},addRecurringHoliday:async n=>{const e={role_type:n.type||"office",day:n.day,occurrence:n.n},{data:t,error:r}=await Me.from("recurring_holidays").insert(e).select().single();if(r)throw r;return{id:t.id,type:t.role_type,day:t.day,n:t.occurrence}},deleteRecurringHoliday:async n=>{const{error:e}=await Me.from("recurring_holidays").delete().eq("id",n);if(e)throw e},createAssignment:async(n,e,t)=>{const r=(await ue.getOrganizations()).find(s=>s.id===e);await ue.createTask({name:`Visit ${r?.shortName||"site"} for verification`,description:`Perform on-site duties and verification tasks for ${r?.shortName}.`,dueDate:t,priority:"Medium",assignedToId:n})},getLeaveBalancesForUser:async n=>{const e=w=>["hr","admin","finance"].includes(w)?"office":"field",{data:t,error:r}=await Me.from("settings").select("attendance_settings").eq("id","singleton").single();if(r||!t?.attendance_settings)throw new Error("Could not load attendance rules.");const{data:s,error:a}=await Me.from("users").select("role_id").eq("id",n).single();if(a)throw a;const o=e(s.role_id),l=xt(t.attendance_settings)[o],[{data:c,error:d},{data:h,error:p},{data:x,error:y}]=await Promise.all([Me.from("leave_requests").select("leave_type, start_date, end_date, day_option").eq("user_id",n).eq("status","approved"),Me.from("comp_off_logs").select("*").eq("user_id",n),Me.from("extra_work_logs").select("hours_worked").eq("user_id",n).eq("claim_type","OT").eq("status","Approved").gte("work_date",We(xi(new Date),"yyyy-MM-dd")).lte("work_date",We(Ma(new Date),"yyyy-MM-dd"))]);if(d||p||y)throw new Error("Failed to fetch all leave balance data.");const _={userId:n,earnedTotal:l.annualEarnedLeaves||0,earnedUsed:0,sickTotal:l.annualSickLeaves||0,sickUsed:0,floatingTotal:(l.monthlyFloatingLeaves||0)*12,floatingUsed:0,compOffTotal:(h||[]).length,compOffUsed:(h||[]).filter(w=>w.status==="used").length,otHoursThisMonth:(x||[]).reduce((w,j)=>w+(j.hours_worked||0),0)};return(c||[]).forEach(w=>{const j=w.day_option==="half"?.5:Em(new Date(w.end_date),new Date(w.start_date))+1;w.leave_type==="Earned"&&(_.earnedUsed+=j),w.leave_type==="Sick"&&(_.sickUsed+=j),w.leave_type==="Floating"&&(_.floatingUsed+=j)}),_},submitLeaveRequest:async n=>{const{data:e,error:t}=await Me.from("users").select("reporting_manager_id").eq("id",n.userId).single();if(t)throw t;const{data:r,error:s}=await Me.from("leave_requests").insert({...hn(n),status:"pending_manager_approval",current_approver_id:e.reporting_manager_id||null,approval_history:[]}).select("*").single();if(s)throw s;return xt(r)},getLeaveRequests:async n=>{let e=Me.from("leave_requests").select("*");n?.userId&&(e=e.eq("user_id",n.userId)),n?.userIds&&(e=e.in("user_id",n.userIds)),n?.status&&(e=e.eq("status",n.status)),n?.forApproverId&&(e=e.eq("current_approver_id",n.forApproverId)),n?.startDate&&n?.endDate&&(e=e.lte("start_date",n.endDate).gte("end_date",n.startDate));const{data:t,error:r}=await e.order("start_date",{ascending:!1});if(r)throw r;return(t||[]).map(xt)},getTasks:async()=>{const{data:n,error:e}=await Me.from("tasks").select("*").order("created_at",{ascending:!1});if(e)throw e;return(n||[]).map(xt)},createTask:async n=>{const{data:e,error:t}=await Me.from("tasks").insert(hn({...n,status:"To Do",escalationStatus:"None"})).select().single();if(t)throw t;return xt(e)},updateTask:async(n,e)=>{if(e?.completionPhoto&&e.completionPhoto.file){const s=e.completionPhoto,a=s.file;try{const{path:o}=await ue.uploadDocument(a,TK);e.completionPhoto={name:s.name,type:s.type,size:s.size,path:o}}catch(o){console.error("Failed to upload task completion photo:",o),delete e.completionPhoto}}const{data:t,error:r}=await Me.from("tasks").update(hn(e)).eq("id",n).select().single();if(r)throw r;return xt(t)},deleteTask:async n=>{const{error:e}=await Me.from("tasks").delete().eq("id",n);if(e)throw e},runAutomaticEscalations:async()=>{const{data:n,error:e}=await Me.functions.invoke("run-escalations");if(e)throw e;return xt(n)},getNotifications:async n=>{const{data:e,error:t}=await Me.from("notifications").select("*").eq("user_id",n).order("created_at",{ascending:!1});if(t)throw t;return(e||[]).map(xt)},createNotification:async n=>{const{data:e,error:t}=await Me.from("notifications").insert(hn(n)).select().single();if(t)throw t;return xt(e)},markNotificationAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("id",n)},markAllNotificationsAsRead:async n=>{await Me.from("notifications").update({is_read:!0}).eq("user_id",n).eq("is_read",!1)},createAuthUser:async n=>{const{name:e,email:t,password:r,role:s}=n;try{const{error:a}=await Me.functions.invoke("admin-create-user",{body:{name:e,email:t,password:r,role:s}});if(a)throw a;const l=(await ue.getUsers()).find(c=>c.email===t);if(l)return l;console.warn("admin-create-user completed but user not found; falling back to client side signup")}catch(a){const o=typeof a?.message=="string"?a.message:String(a);if(!o.toLowerCase().includes("failed to send a request")&&!o.toLowerCase().includes("edge function"))throw a;console.warn("Edge function not reachable, falling back to client side signup");const{data:l,error:c}=await Me.auth.signUp({email:t,password:r,options:{data:{name:e}}});if(c||!l?.user)throw c||new Error("Failed to sign up user");const d=l.user;try{await Me.from("users").upsert({id:d.id,name:e,email:t,role_id:s},{onConflict:"id"})}catch(h){console.warn("Failed to upsert user profile after fallback signup:",h)}return{id:d.id,name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}}return{id:"",name:e,email:t,role:s,phone:void 0,organizationId:void 0,organizationName:void 0,reportingManagerId:void 0,photoUrl:void 0}},getPolicies:async()=>{const{data:n,error:e}=await Me.from("policies").select("*");if(e)throw e;return(n||[]).map(xt)},createPolicy:async n=>{const{data:e,error:t}=await Me.from("policies").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getInsurances:async()=>{const{data:n,error:e}=await Me.from("insurances").select("*");if(e)throw e;return(n||[]).map(xt)},createInsurance:async n=>{const{data:e,error:t}=await Me.from("insurances").insert(hn(n)).select().single();if(t)throw t;return xt(e)},getApprovalWorkflowSettings:async()=>{const{data:n,error:e}=await Me.from("settings").select("approval_workflow_settings").eq("id","singleton").single();if(e)throw e;if(!n?.approval_workflow_settings)throw new Error("Approval workflow settings are not configured.");return xt(n.approval_workflow_settings)},updateApprovalWorkflowSettings:async n=>{const{error:e}=await Me.from("settings").update({approval_workflow_settings:hn({finalConfirmationRole:n})}).eq("id","singleton");if(e)throw e},approveLeaveRequest:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(r)throw r;const{finalConfirmationRole:s}=await ue.getApprovalWorkflowSettings(),{data:a}=await Me.from("users").select("id").eq("role_id",s).limit(1).single(),{data:o,error:l}=await Me.from("users").select("name").eq("id",e).single();if(l)throw l;const c={approver_id:e,approver_name:o.name,status:"approved",timestamp:new Date().toISOString()},d=[...t.approval_history||[],c],{error:h}=await Me.from("leave_requests").update({status:"pending_hr_confirmation",current_approver_id:a?.id,approval_history:d}).eq("id",n);if(h)throw h},rejectLeaveRequest:async(n,e,t="")=>{const{data:r,error:s}=await Me.from("leave_requests").select("approval_history").eq("id",n).single();if(s)throw s;const{data:a,error:o}=await Me.from("users").select("name").eq("id",e).single();if(o)throw o;const l={approver_id:e,approver_name:a.name,status:"rejected",timestamp:new Date().toISOString(),comments:t},c=[...r.approval_history||[],l],{error:d}=await Me.from("leave_requests").update({status:"rejected",current_approver_id:null,approval_history:c}).eq("id",n);if(d)throw d},confirmLeaveByHR:async(n,e)=>{const{data:t,error:r}=await Me.from("leave_requests").select("leave_type, user_id, approval_history").eq("id",n).single();if(r)throw r;const{data:s,error:a}=await Me.from("users").select("name").eq("id",e).single();if(a)throw a;const o={approver_id:e,approver_name:s.name,status:"approved",timestamp:new Date().toISOString(),comments:"Final approval."},l=[...t.approval_history||[],o],{error:c}=await Me.from("leave_requests").update({status:"approved",current_approver_id:null,approval_history:l}).eq("id",n);if(c)throw c;if(t.leave_type==="Comp Off"){const{data:d,error:h}=await Me.from("comp_off_logs").select("id").eq("user_id",t.user_id).eq("status","earned").limit(1).single();if(h&&h.code!=="PGRST116")throw h;d&&await Me.from("comp_off_logs").update({status:"used",leave_request_id:n}).eq("id",d.id)}},submitExtraWorkClaim:async n=>{const{error:e}=await Me.from("extra_work_logs").insert(hn({...n,status:"Pending"}));if(e)throw e},getExtraWorkLogs:async n=>{let e=Me.from("extra_work_logs").select("*");n?e=e.eq("user_id",n):e=e.eq("status","Pending");const{data:t,error:r}=await e.order("work_date",{ascending:!1});if(r)throw r;return(t||[]).map(xt)},approveExtraWorkClaim:async(n,e)=>{const{data:t,error:r}=await Me.from("users").select("name").eq("id",e).single();if(r)throw r;const{data:s,error:a}=await Me.from("extra_work_logs").select("*").eq("id",n).single();if(a)throw a;if(!s)throw new Error("Claim not found.");const{error:o}=await Me.from("extra_work_logs").update({status:"Approved",approver_id:e,approver_name:t.name,approved_at:new Date().toISOString()}).eq("id",n);if(o)throw o;s.claim_type==="Comp Off"&&await ue.addCompOffLog({userId:s.user_id,userName:s.user_name,dateEarned:s.work_date,reason:`Claim approved: ${s.reason}`,status:"earned",grantedById:e,grantedByName:t.name})},rejectExtraWorkClaim:async(n,e,t)=>{const{data:r,error:s}=await Me.from("users").select("name").eq("id",e).single();if(s)throw s;const{error:a}=await Me.from("extra_work_logs").update({status:"Rejected",approver_id:e,approver_name:r.name,rejection_reason:t}).eq("id",n);if(a)throw a},getManpowerDetails:async n=>{const{data:e,error:t}=await Me.rpc("get_manpower_details",{site_id_param:n});if(t)throw t;return xt(e)},addCompOffLog:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").insert(hn(n)).select().single();if(t)throw t;return xt(e)},exportAllData:async()=>{const n=["users","organizations","onboarding_submissions","settings"],e={};for(const t of n){const{data:r,error:s}=await Me.from(t).select("*");if(s)throw new Error(`Failed to export ${t}`);e[t]=r}return xt(e)},getPincodeDetails:async n=>new Promise(e=>setTimeout(()=>e({city:"Bengaluru",state:"Karnataka"}),500)),suggestDepartmentForDesignation:async n=>{const e={"Security Guard":"Security","Housekeeping Staff":"Housekeeping","Site Manager":"Management"},t=Object.keys(e).find(r=>n.toLowerCase().includes(r.toLowerCase()));return Promise.resolve(t?e[t]:null)},verifyBankAccountWithPerfios:async n=>{console.log("Mock verifying bank account:",n),await new Promise(t=>setTimeout(t,1500));const e=Math.random()>.1;return{success:e,message:e?"Bank account verified successfully.":"Account holder name did not match.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:e,uan:null,esi:null,accountHolderName:e,accountNumber:e,ifscCode:!0}}},verifyAadhaar:async n=>{console.log("Mock verifying Aadhaar:",n),await new Promise(t=>setTimeout(t,1e3));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"Aadhaar details verified.":"Invalid Aadhaar number.",verifiedFields:{name:null,dob:null,aadhaar:e,bank:null,uan:null,esi:null}}},lookupUan:async n=>{console.log("Mock looking up UAN:",n),await new Promise(t=>setTimeout(t,1200));const e=n.length===12&&Math.random()>.1;return{success:e,message:e?"UAN found and linked.":"UAN not found in EPFO database.",verifiedFields:{name:null,dob:null,aadhaar:null,bank:null,uan:e,esi:null}}},extractDataFromImage:async(n,e,t,r)=>{if(!ml)return console.warn("AI feature disabled: cannot extract data from image. Returning empty result."),{};const a=(await ml.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:`Extract the structured data from this document image. It is a ${r||"document"}.`},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:t}})).text.trim();return JSON.parse(a)},crossVerifyNames:async(n,e)=>{if(!ml){const s=n.trim().toLowerCase()===e.trim().toLowerCase();return{isMatch:s,reason:s?"Names are identical (case-insensitive match) without AI.":"AI disabled; simple case-insensitive comparison used."}}const r=(await ml.models.generateContent({model:"gemini-2.5-flash",contents:`Are these two names referring to the same person? Name 1: "${n}", Name 2: "${e}". Respond in JSON format with two keys: "isMatch" (boolean) and "reason" (a brief string explanation).`,config:{responseMimeType:"application/json",responseSchema:{type:Xe.OBJECT,properties:{isMatch:{type:Xe.BOOLEAN},reason:{type:Xe.STRING}}}}})).text.trim();return JSON.parse(r)},verifyFingerprintImage:async(n,e)=>{if(!ml)return{containsFingerprints:!1,reason:"AI disabled; cannot detect fingerprints."};const r=(await ml.models.generateContent({model:"gemini-2.5-flash",contents:{parts:[{text:'Does this image contain one or more human fingerprints? The image might be a scan from paper. Respond in JSON with "containsFingerprints" (boolean) and "reason" (string).'},{inlineData:{data:n,mimeType:e}}]},config:{responseMimeType:"application/json",responseSchema:{type:Xe.OBJECT,properties:{containsFingerprints:{type:Xe.BOOLEAN},reason:{type:Xe.STRING}}}}})).text.trim();return JSON.parse(r)},enhanceDocumentPhoto:async(n,e)=>{if(!ml)return console.warn("AI disabled; returning original document photo without enhancement."),n;const t=await ml.models.generateContent({model:"gemini-2.5-flash-image",contents:{parts:[{text:"Enhance this document photo. Improve contrast, correct perspective to be flat, and make text as clear as possible. Return only the enhanced image."},{inlineData:{data:n,mimeType:e}}]},config:{responseModalities:[fm.IMAGE]}});for(const r of t.candidates[0].content.parts)if(r.inlineData)return r.inlineData.data;throw new Error("AI did not return an enhanced image.")},getSiteStaffDesignations:async()=>{const{data:n,error:e}=await Me.from("site_staff_designations").select("*");if(e)throw e;return(n||[]).map(xt)},updateManpowerDetails:async(n,e)=>{console.log("Mock updating manpower for",n,e),await new Promise(t=>setTimeout(t,500))},getCompOffLogs:async n=>{const{data:e,error:t}=await Me.from("comp_off_logs").select("*").eq("user_id",n).order("date_earned",{ascending:!1});if(t)throw t;return(e||[]).map(xt)},checkCompOffTableExists:async()=>{const{error:n}=await Me.from("comp_off_logs").select("id").limit(1);if(n)throw n},getAllSiteAssets:async()=>Promise.resolve({}),updateSiteAssets:async(n,e)=>(console.log("Mock updating assets for site",n,e),Promise.resolve()),getBackOfficeIdSeries:async()=>{const{data:n,error:e}=await Me.from("settings").select("back_office_id_series").eq("id","singleton").single();if(e)throw e;return n?.back_office_id_series?xt(n.back_office_id_series):[]},updateBackOfficeIdSeries:async n=>{const{error:e}=await Me.from("settings").update({back_office_id_series:hn(n)}).eq("id","singleton");if(e)throw e},updateSiteStaffDesignations:async n=>{const{error:e}=await Me.from("site_staff_designations").upsert(hn(n),{onConflict:"id"});if(e)throw e},getAllSiteIssuedTools:async()=>Promise.resolve({}),getToolsList:async()=>Promise.resolve({}),updateSiteIssuedTools:async(n,e)=>{console.log("Mock updating tools for site",n,e)},getAllSiteGentsUniforms:async()=>Promise.resolve({}),getMasterGentsUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteGentsUniforms:async(n,e)=>{console.log("Mock updating gents uniforms for",n,e)},getAllSiteUniformDetails:async()=>Promise.resolve({}),updateSiteUniformDetails:async(n,e)=>{console.log("Mock updating uniform details for",n,e)},getAllSiteLadiesUniforms:async()=>Promise.resolve({}),getMasterLadiesUniforms:async()=>Promise.resolve({pants:[],shirts:[]}),updateSiteLadiesUniforms:async(n,e)=>{console.log("Mock updating ladies uniforms for",n,e)},getUniformRequests:async()=>{const{data:n,error:e}=await Me.from("uniform_requests").select("*");if(e)throw e;return(n||[]).map(xt)},submitUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").insert(hn(n)).select().single();if(t)throw t;return xt(e)},updateUniformRequest:async n=>{const{data:e,error:t}=await Me.from("uniform_requests").update(hn(n)).eq("id",n.id).select().single();if(t)throw t;return xt(e)},deleteUniformRequest:async n=>{const{error:e}=await Me.from("uniform_requests").delete().eq("id",n);if(e)throw e},getInvoiceStatuses:async n=>(console.log("Mock fetching invoice statuses for",n),Promise.resolve({})),getInvoiceSummaryData:async(n,e)=>(console.log("Mock fetching invoice data for",n,e),Promise.resolve({siteName:"Mock Site",siteAddress:"Mock Address",invoiceNumber:"INV-001",invoiceDate:"2023-01-31",statementMonth:"January-2023",lineItems:[]})),getSupportTickets:async()=>{const{data:n,error:e}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))");if(e)throw e;return(n||[]).map(xt)},getSupportTicketById:async n=>{const{data:e,error:t}=await Me.from("support_tickets").select("*, posts:ticket_posts(*, comments:ticket_comments(*))").eq("id",n).single();if(t)throw t;return xt(e)},createSupportTicket:async n=>{const e=n.attachment;if(e&&e.file instanceof File)try{const{path:s}=await ue.uploadDocument(e.file,AM);n.attachment={name:e.name,type:e.type,size:e.size,path:s}}catch(s){console.error("Failed to upload support ticket attachment:",s),delete n.attachment}const{data:t,error:r}=await Me.from("support_tickets").insert(hn(n)).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(r)throw r;return xt(t)},updateSupportTicket:async(n,e)=>{const t=e.attachment;if(t&&t.file instanceof File)try{const{path:a}=await ue.uploadDocument(t.file,AM);e.attachment={name:t.name,type:t.type,size:t.size,path:a}}catch(a){console.error("Failed to upload updated support ticket attachment:",a),delete e.attachment}const{data:r,error:s}=await Me.from("support_tickets").update(hn(e)).eq("id",n).select("*, posts:ticket_posts(*, comments:ticket_comments(*))").single();if(s)throw s;return xt(r)},addTicketPost:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").insert(hn(e)).select("*, comments:ticket_comments(*)").single();if(r)throw r;return xt(t)},togglePostLike:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_posts").select("likes").eq("id",n).single();if(r)throw r;const s=t.likes||[],a=s.includes(e)?s.filter(l=>l!==e):[...s,e],{error:o}=await Me.from("ticket_posts").update({likes:a}).eq("id",n);if(o)throw o},addPostComment:async(n,e)=>{const{data:t,error:r}=await Me.from("ticket_comments").insert(hn(e)).select().single();if(r)throw r;return xt(t)},getVerificationCostBreakdown:async(n,e)=>{const{data:t,error:r}=await Me.from("onboarding_submissions").select("id, employee_id, personal, enrollment_date, verification_usage").gte("enrollment_date",n).lte("enrollment_date",e);if(r)throw r;return(t||[]).map(s=>{const a=xt(s);return{id:a.id,employeeId:a.personal.employeeId,employeeName:`${a.personal.firstName} ${a.personal.lastName}`,enrollmentDate:a.enrollmentDate,totalCost:0,breakdown:a.verificationUsage||[]}})},generatePdf:async(n,e)=>{try{const t=(await Nf(async()=>{const{default:r}=await import("./html2pdf-CGq9y-nT.js").then(s=>s.h);return{default:r}},[],import.meta.url)).default;await t().set(e).from(n).save()}catch(t){throw console.error("PDF generation failed:",t),t}},batchResolveAddresses:async n=>{if(n.length===0)return{};const e=c=>parseFloat(c.toFixed(6)),t=Array.from(new Set(n.map(c=>`${e(c.lat)},${e(c.lon)}`))).map(c=>{const[d,h]=c.split(",").map(Number);return{lat:d,lon:h}}),r={},s=[],a=t.map(c=>c.lat),{data:o,error:l}=await Me.from("location_cache").select("*").in("latitude",a);!l&&o&&o.forEach(c=>{const d=e(parseFloat(c.latitude)),h=e(parseFloat(c.longitude)),p=`${d},${h}`;t.some(x=>e(x.lat)===d&&e(x.lon)===h)&&(r[p]=c.address)}),t.forEach(c=>{const d=`${e(c.lat)},${e(c.lon)}`;r[d]||s.push(c)}),console.log("Geocoding API: Found",Object.keys(r).length,"cached,",s.length,"missing");for(const c of s)try{const d=await Nf(()=>Promise.resolve().then(()=>EK),void 0,import.meta.url).then(p=>p.reverseGeocode(c.lat,c.lon)),h=`${e(c.lat)},${e(c.lon)}`;r[h]=d,await Me.from("location_cache").insert({latitude:e(c.lat),longitude:e(c.lon),address:d}),console.log("Geocoding API: Fetched and cached",h,"->",d),await new Promise(p=>setTimeout(p,1e3))}catch(d){console.error(`Failed to resolve address for ${c.lat},${c.lon}`,d);const h=`${e(c.lat)},${e(c.lon)}`;r[h]=`${c.lat.toFixed(4)}, ${c.lon.toFixed(4)}`}return r},sendSecurityAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for security alert");return}const o=t==="developer_mode"?"attempted to access the application with Developer Mode enabled":"attempted to access the application with Location Spoofing detected",l=r?` using device: ${r}`:"";await ue.createNotification({userId:s.reporting_manager_id,title:" Security Alert",message:`${e} ${o}${l}. Access was blocked for security reasons.`,type:"security",link:"/user-management"})},sendDeviceChangeAlert:async(n,e,t,r)=>{const{data:s,error:a}=await Me.from("users").select("reporting_manager_id").eq("id",n).single();if(a||!s?.reporting_manager_id){console.warn("Could not find reporting manager for device change alert");return}await ue.createNotification({userId:s.reporting_manager_id,title:" Device Change Detected",message:`${e} logged in from a new device. Previous device: ${t}, New device: ${r}`,type:"info",link:"/user-management"})}},MK=(n,e,t="Operation timed out")=>{const r=new Promise((s,a)=>{setTimeout(()=>a(new Error(t)),e)});return Promise.race([n,r])};function PS(n,e,t,r){const s=h=>h*Math.PI/180,o=s(t-n),l=s(r-e),c=Math.sin(o/2)*Math.sin(o/2)+Math.cos(s(n))*Math.cos(s(t))*Math.sin(l/2)*Math.sin(l/2);return 6371e3*(2*Math.atan2(Math.sqrt(c),Math.sqrt(1-c)))}async function mm(n,e){const t=`${n.toFixed(4)}, ${e.toFixed(4)}`;try{const{supabase:r}=await Nf(async()=>{const{supabase:l}=await Promise.resolve().then(()=>PV);return{supabase:l}},void 0,import.meta.url),s=Math.round(n*1e4)/1e4,a=Math.round(e*1e4)/1e4,{data:o}=await r.from("location_cache").select("address").eq("latitude",s).eq("longitude",a).maybeSingle();return o?.address?o.address:t}catch(r){return console.warn("Reverse geocode failed:",r),t}}function ay(n=50,e=1e4){return new Promise((t,r)=>{if(!("geolocation"in navigator))return r(new Error("Geolocation is not supported by this browser."));let s=null;const a=setTimeout(()=>{s?(navigator.geolocation.clearWatch(o),t(s)):(navigator.geolocation.clearWatch(o),r(new Error("Unable to acquire a precise position within the timeout period")))},e),o=navigator.geolocation.watchPosition(l=>{(!s||l.coords.accuracy<s.coords.accuracy)&&(s=l),l.coords.accuracy<=n&&(clearTimeout(a),navigator.geolocation.clearWatch(o),t(l))},l=>{clearTimeout(a),navigator.geolocation.clearWatch(o),r(l)},{enableHighAccuracy:!0,maximumAge:0})})}const EK=Object.freeze(Object.defineProperty({__proto__:null,calculateDistanceMeters:PS,getPrecisePosition:ay,reverseGeocode:mm},Symbol.toStringTag,{value:"Module"})),Wp=n=>{const e=n.toLowerCase();return e.includes("timed out")?"The request took too long. Please check your internet connection and try again.":e.includes("invalid api key")||e.includes("configuration")?"System configuration error. Please contact support.":e.includes("failed to fetch")||e.includes("network")?"Unable to connect. Please check your internet connection.":e.includes("invalid login credentials")?'Incorrect email or password. If you use Google Sign-In, please click "Sign in with Google".':e.includes("user already registered")||e.includes("already exists")?"This email is already registered. Please sign in.":e.includes("email not confirmed")?"Please verify your email address. Check your inbox for the confirmation link.":e.includes("too many requests")||e.includes("rate limit")?"Too many attempts. Please wait a few minutes before trying again.":e.includes("weak password")?"Password is too weak. Please use a stronger password.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again or contact support.")},mb=()=>{const n=new Date().getHours();return n<12?"Good Morning":n<17?"Good Afternoon":"Good Evening"},jt=Xi()((n,e)=>({user:null,isInitialized:!1,isCheckedIn:!1,isAttendanceLoading:!0,lastCheckInTime:null,lastCheckOutTime:null,error:null,loading:!1,isLoginAnimationPending:!1,setLoginAnimationPending:t=>n({isLoginAnimationPending:t}),setUser:t=>n({user:t,error:null,loading:!1}),setInitialized:t=>n({isInitialized:t}),setLoading:t=>n({loading:t}),resetAttendance:()=>n({isCheckedIn:!1,isAttendanceLoading:!1,lastCheckInTime:null,lastCheckOutTime:null,isLoginAnimationPending:!1}),setError:t=>n({error:t}),loginWithEmail:async(t,r,s)=>{n({error:null,loading:!0});try{await Ca.signOut()}catch{}try{const{data:a,error:o}=await MK(Ca.signInWithPassword(t,r),2e4,"Login attempt timed out. Please check your network connection.").catch(c=>({data:{user:null,session:null},error:{message:c.message}}));if(o||!a.user||!a.session){const c=Wp(o?.message||"Invalid login credentials");return n({error:c,loading:!1}),{error:{message:c}}}s?(localStorage.setItem("rememberedEmail",t),localStorage.setItem("supabase.auth.rememberMe",a.session.refresh_token)):(localStorage.removeItem("rememberedEmail"),localStorage.removeItem("supabase.auth.rememberMe"));const l=await Ca.getAppUserProfile(a.user);if(l){n({user:l,error:null,loading:!1});try{const c=`greetingSent_${l.id}`,d=mb();await ue.createNotification({userId:l.id,message:`${d}, ${l.name||"there"}! Welcome back to Paradigm Services.`,type:"greeting"})}catch(c){console.error("Failed to send login greeting notification",c)}return{error:null}}else{await Ca.signOut();const c="Login successful, but failed to retrieve user profile. Please try again.";return n({user:null,error:c,loading:!1}),{error:{message:c}}}}catch(a){console.error("Unexpected error during login flow:",a);const o=Wp("Unexpected error during login flow");return n({user:null,error:o,loading:!1}),{error:{message:o}}}},signUp:async(t,r,s)=>{n({error:null,loading:!0});const{error:a}=await Ca.signUpWithPassword({email:r,password:s,options:{data:{name:t}}});if(a){const o=Wp(a.message);return n({error:o,loading:!1}),{error:{message:o}}}return n({loading:!1}),{error:null}},loginWithGoogle:async()=>{n({error:null,loading:!0});const{error:t}=await Ca.signInWithGoogle();if(t){const r=Wp(t.message);return n({error:r,loading:!1}),{error:{message:r}}}return n({loading:!1}),{error:null}},sendPasswordReset:async t=>{const{error:r}=await Ca.resetPasswordForEmail(t);return r?{error:{message:r.message}}:{error:null}},logout:async()=>{const t=e().user;if(t)try{const r=mb(),s=new Date().getHours()>=20?"Good Night":r;await ue.createNotification({userId:t.id,message:`${s}, ${t.name||"there"}! Thanks for your hard work today.`,type:"greeting"})}catch(r){console.error("Failed to send logout farewell notification",r)}localStorage.removeItem("supabase.auth.rememberMe"),await Ca.signOut()},updateUserProfile:t=>n(r=>({user:r.user?{...r.user,...t}:null})),checkAttendanceStatus:async()=>{const{user:t}=e();if(!t){n({isAttendanceLoading:!1});return}n({isAttendanceLoading:!0});try{const r=new Date,s=new Date(r.getFullYear(),r.getMonth(),r.getDate(),0,0,0,0).toISOString(),a=new Date(r.getFullYear(),r.getMonth(),r.getDate(),23,59,59,999).toISOString(),o=await ue.getAttendanceEvents(t.id,s,a);if(o.length===0){n({isCheckedIn:!1,lastCheckInTime:null,lastCheckOutTime:null,isAttendanceLoading:!1});return}o.sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime());const l=o.find(h=>h.type==="check-in"),c=[...o].reverse().find(h=>h.type==="check-out"),d=o[o.length-1];n({isCheckedIn:d?.type==="check-in",lastCheckInTime:l?l.timestamp:null,lastCheckOutTime:c?c.timestamp:null,isAttendanceLoading:!1})}catch(r){console.error("Failed to check attendance status:",r),n({isAttendanceLoading:!1})}},toggleCheckInStatus:async()=>{const{user:t,isCheckedIn:r}=e();if(!t)return{success:!1,message:"User not found"};const s=r?"check-out":"check-in";try{let a=null;try{a=await ay()}catch{}(!a||!a.coords)&&(a=await new Promise(p=>{navigator.geolocation.getCurrentPosition(x=>p(x),()=>p(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})}));const o=async(p,x,y)=>{await ue.addAttendanceEvent({userId:t.id,timestamp:new Date().toISOString(),type:s,latitude:p,longitude:x,locationId:y}),await e().checkAttendanceStatus();try{const _=mb(),w=s==="check-in"?"checking in":"checking out";await ue.createNotification({userId:t.id,message:`${_}, ${t.name||"there"}! Thanks for ${w}.`,type:"greeting"})}catch(_){console.warn("Failed to send user attendance notification",_)}try{const _=await ue.getAttendanceSettings();if((["admin","hr","finance","developer"].includes(t.role)?_?.office:_?.field)?.enableAttendanceNotifications){const C=[];t.reportingManagerId&&C.push({id:t.reportingManagerId});const P=await ue.getNearbyUsers();for(const I of P)C.find(F=>F.id===I.id)||C.push({id:I.id});const O=t.name||"An employee",M=y?"":p&&x?` at ${p.toFixed(4)}, ${x.toFixed(4)}`:"",D=`${O} ${s.replace("-"," ")}${M}`;await Promise.all(C.map(I=>ue.createNotification({userId:I.id,message:D,type:"greeting"})))}}catch(_){console.warn("Failed to create manager notifications:",_)}return{success:!0,message:`Successfully ${s.replace("-"," ")}!`}};if(!a||!a.coords)return await o(void 0,void 0,null);const{latitude:l,longitude:c,accuracy:d}=a.coords;if(typeof d=="number"&&d>1e3)return await o(l,c,null);let h=null;try{const p=await ue.getUserLocations(t.id);for(const x of p)if(PS(l,c,x.latitude,x.longitude)<=x.radius){h=x.id;break}if(!h){const x=await ue.getLocations();for(const y of x)if(PS(l,c,y.latitude,y.longitude)<=y.radius){h=y.id;try{await ue.assignLocationToUser(t.id,y.id)}catch(w){console.warn("Failed to autoassign location to user:",w)}break}}}catch(p){console.warn("Geofencing check failed:",p)}if(!h)try{let p=null;try{p=await mm(l,c)}catch(_){console.warn("Reverse geocode failed for new location:",_)}const y=await ue.createLocation({name:p||null,latitude:l,longitude:c,radius:100,address:p||null,createdBy:t.id});try{await ue.assignLocationToUser(t.id,y.id)}catch(_){console.warn("Failed to autoassign new location to user:",_)}h=y.id}catch(p){console.warn("Failed to create a new geofence location:",p),h=null}return await o(l,c,h)}catch(a){return console.error("Error during attendance update:",a),{success:!1,message:"Failed to update attendance."}}}})),DK={};function Xc(n,e){let t;try{t=n()}catch{return}return{getItem:s=>{var a;const o=c=>c===null?null:JSON.parse(c,void 0),l=(a=t.getItem(s))!=null?a:null;return l instanceof Promise?l.then(o):o(l)},setItem:(s,a)=>t.setItem(s,JSON.stringify(a,void 0)),removeItem:s=>t.removeItem(s)}}const pm=n=>e=>{try{const t=n(e);return t instanceof Promise?t:{then(r){return pm(r)(t)},catch(r){return this}}}catch(t){return{then(r){return this},catch(r){return pm(r)(t)}}}},OK=(n,e)=>(t,r,s)=>{let a={getStorage:()=>localStorage,serialize:JSON.stringify,deserialize:JSON.parse,partialize:j=>j,version:0,merge:(j,C)=>({...C,...j}),...e},o=!1;const l=new Set,c=new Set;let d;try{d=a.getStorage()}catch{}if(!d)return n((...j)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...j)},r,s);const h=pm(a.serialize),p=()=>{const j=a.partialize({...r()});let C;const P=h({state:j,version:a.version}).then(O=>d.setItem(a.name,O)).catch(O=>{C=O});if(C)throw C;return P},x=s.setState;s.setState=(j,C)=>{x(j,C),p()};const y=n((...j)=>{t(...j),p()},r,s);let _;const w=()=>{var j;if(!d)return;o=!1,l.forEach(P=>P(r()));const C=((j=a.onRehydrateStorage)==null?void 0:j.call(a,r()))||void 0;return pm(d.getItem.bind(d))(a.name).then(P=>{if(P)return a.deserialize(P)}).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return a.migrate(P.state,P.version);console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return P.state}).then(P=>{var O;return _=a.merge(P,(O=r())!=null?O:y),t(_,!0),p()}).then(()=>{C?.(_,void 0),o=!0,c.forEach(P=>P(_))}).catch(P=>{C?.(void 0,P)})};return s.persist={setOptions:j=>{a={...a,...j},j.getStorage&&(d=j.getStorage())},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>w(),hasHydrated:()=>o,onHydrate:j=>(l.add(j),()=>{l.delete(j)}),onFinishHydration:j=>(c.add(j),()=>{c.delete(j)})},w(),_||y},IK=(n,e)=>(t,r,s)=>{let a={storage:Xc(()=>localStorage),partialize:w=>w,version:0,merge:(w,j)=>({...j,...w}),...e},o=!1;const l=new Set,c=new Set;let d=a.storage;if(!d)return n((...w)=>{console.warn(`[zustand persist middleware] Unable to update item '${a.name}', the given storage is currently unavailable.`),t(...w)},r,s);const h=()=>{const w=a.partialize({...r()});return d.setItem(a.name,{state:w,version:a.version})},p=s.setState;s.setState=(w,j)=>{p(w,j),h()};const x=n((...w)=>{t(...w),h()},r,s);s.getInitialState=()=>x;let y;const _=()=>{var w,j;if(!d)return;o=!1,l.forEach(P=>{var O;return P((O=r())!=null?O:x)});const C=((j=a.onRehydrateStorage)==null?void 0:j.call(a,(w=r())!=null?w:x))||void 0;return pm(d.getItem.bind(d))(a.name).then(P=>{if(P)if(typeof P.version=="number"&&P.version!==a.version){if(a.migrate)return[!0,a.migrate(P.state,P.version)];console.error("State loaded from storage couldn't be migrated since no migrate function was provided")}else return[!1,P.state];return[!1,void 0]}).then(P=>{var O;const[M,D]=P;if(y=a.merge(D,(O=r())!=null?O:x),t(y,!0),M)return h()}).then(()=>{C?.(y,void 0),y=r(),o=!0,c.forEach(P=>P(y))}).catch(P=>{C?.(void 0,P)})};return s.persist={setOptions:w=>{a={...a,...w},w.storage&&(d=w.storage)},clearStorage:()=>{d?.removeItem(a.name)},getOptions:()=>a,rehydrate:()=>_(),hasHydrated:()=>o,onHydrate:w=>(l.add(w),()=>{l.delete(w)}),onFinishHydration:w=>(c.add(w),()=>{c.delete(w)})},a.skipHydration||_(),y||x},AK=(n,e)=>"getStorage"in e||"serialize"in e||"deserialize"in e?((DK?"production":void 0)!=="production"&&console.warn("[DEPRECATED] `getStorage`, `serialize` and `deserialize` options are deprecated. Use `storage` option instead."),OK(n,e)):IK(n,e),_u=AK,ed=Xi(_u(n=>({theme:"light",isAutomatic:!0,setTheme:e=>n({theme:e,isAutomatic:!1}),setAutomatic:e=>n({isAutomatic:e}),_setThemeInternal:e=>n({theme:e})}),{name:"paradigm-app-theme",storage:Xc(()=>localStorage)})),RK={esiCtcThreshold:21e3,enforceManpowerLimit:!1,manpowerLimitRule:"warn",allowSalaryEdit:!1,salaryThreshold:21e3,defaultPolicySingle:"1L",defaultPolicyMarried:"2L",enableEsiRule:!1,enableGmcRule:!1,enforceFamilyValidation:!0,rulesByDesignation:{}},td=Xi()(n=>({...RK,init:e=>{e&&n(e)},updateRules:e=>n(t=>({...t,...e}))})),LK={unverified:[],admin:["view_all_submissions","manage_users","manage_sites","view_entity_management","view_developer_settings","view_operations_dashboard","view_site_dashboard","create_enrollment","manage_roles_and_permissions","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_approval_workflow","download_attendance_report","manage_tasks","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","view_field_officer_tracking","manage_modules","access_support_desk"],hr:["view_all_submissions","manage_users","manage_sites","view_entity_management","manage_attendance_rules","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","download_attendance_report","manage_policies","manage_insurance","manage_enrollment_rules","manage_uniforms","view_invoice_summary","view_verification_costing","access_support_desk"],finance:["view_invoice_summary","view_verification_costing","view_own_attendance","apply_for_leave"],developer:["view_developer_settings"],operation_manager:["view_operations_dashboard","view_all_attendance","view_own_attendance","apply_for_leave","manage_leave_requests","manage_tasks","access_support_desk"],site_manager:["view_site_dashboard","create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"],field_officer:["create_enrollment","view_own_attendance","apply_for_leave","access_support_desk"]},ta=Xi(_u((n,e)=>({permissions:LK,initRoles:t=>{if(!t)return;const s={...e().permissions};let a=!1;t.forEach(o=>{s[o.id]||(s[o.id]=[],a=!0)}),a&&n({permissions:s})},addRolePermissionEntry:t=>{n(r=>({permissions:{...r.permissions,[t.id]:[]}}))},removeRolePermissionEntry:t=>{n(r=>{const s={...r.permissions};return delete s[t],{permissions:s}})},renameRolePermissionEntry:(t,r)=>{n(s=>{const a={...s.permissions};return a[t]&&(a[r]=a[t],delete a[t]),{permissions:a}})},setRolePermissions:(t,r)=>{n(s=>({permissions:{...s.permissions,[t]:r}}))}}),{name:"paradigm_app_permissions_v2",storage:Xc(()=>localStorage)})),FK={enablePincodeVerification:!0},qK={office:{minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},field:{minimumHoursFullDay:9,minimumHoursHalfDay:5,annualEarnedLeaves:10,annualSickLeaves:10,monthlyFloatingLeaves:0,annualCompOffLeaves:10,enableAttendanceNotifications:!0,sickLeaveCertificateThreshold:3}},zK={applicability:"Optional - Opt-in Default",optInDisclaimer:"Please note that currently the GMC facility covers only spouse and two children. If you would like to continue, please select below relationships and submit.",coverageDetails:"Spouse and two children",optOutDisclaimer:"Please note that you are opting out of the GMC Facility. You will have to submit a declaration to the company towards the same along with proof of your existing insurance.",requireAlternateInsurance:!0,collectProvider:!0,collectStartDate:!0,collectEndDate:!0,collectExtentOfCover:!0},UK={enabled:!0,clientId:"",clientSecret:""},BK={enabled:!0},VK={enabled:!0},WK={email:{enabled:!1}},$K=[{id:"cost_1",name:"Profile Picture",cost:0},{id:"cost_2",name:"Mobile to Form Prefill",cost:7},{id:"cost_3",name:"KYC OCR (Plus)",cost:1.5},{id:"cost_4",name:"Aadhaar Mobile Link",cost:2.5},{id:"cost_5",name:"EPF UAN Lookup",cost:2.5},{id:"cost_6",name:"Cheque OCR",cost:3},{id:"cost_7",name:"Bank AC Verification Advanced",cost:2.25},{id:"cost_8",name:"PAN Profile Detailed",cost:5},{id:"cost_9",name:"Aadhaar Verification",cost:1.75},{id:"cost_10",name:"Voter ID OCR",cost:1.5},{id:"cost_11",name:"Driving License OCR",cost:1.5},{id:"cost_12",name:"Education Certificate OCR",cost:2},{id:"cost_13",name:"Experience/Salary Slip OCR",cost:2},{id:"cost_14",name:"ESI Card OCR",cost:1.5}],HK={enableProvisionalSites:!1},yi=Xi()(_u(n=>({address:FK,attendance:qK,officeHolidays:[],fieldHolidays:[],recurringHolidays:[],gmcPolicy:zK,perfiosApi:UK,geminiApi:BK,otp:VK,notifications:WK,verificationCosts:$K,siteManagement:HK,initSettings:e=>{if(e){const{holidays:t,attendanceSettings:r,recurringHolidays:s}=e,a=t.filter(l=>l.type==="office"),o=t.filter(l=>l.type==="field");n({officeHolidays:a,fieldHolidays:o,attendance:r,recurringHolidays:s||[]})}},updateAddressSettings:e=>n(t=>({address:{...t.address,...e}})),updateAttendanceSettings:e=>n({attendance:e}),updateGmcPolicySettings:e=>n(t=>({gmcPolicy:{...t.gmcPolicy,...e}})),updatePerfiosApiSettings:e=>n(t=>({perfiosApi:{...t.perfiosApi,...e}})),updateGeminiApiSettings:e=>n(t=>({geminiApi:{...t.geminiApi,...e}})),updateOtpSettings:e=>n(t=>({otp:{...t.otp,...e}})),updateNotificationSettings:e=>n(t=>({notifications:{...t.notifications,...e,email:{...t.notifications.email,...e.email}}})),updateVerificationCosts:e=>n({verificationCosts:e}),updateSiteManagementSettings:e=>n(t=>({siteManagement:{...t.siteManagement,...e}})),addHoliday:async(e,t)=>{const r=await ue.addHoliday({...t,type:e});n(s=>{const a=e==="office"?"officeHolidays":"fieldHolidays",o=[...s[a],r].sort((l,c)=>new Date(l.date).getTime()-new Date(c.date).getTime());return{[a]:o}})},removeHoliday:async(e,t)=>{await ue.removeHoliday(t),n(r=>{const s=e==="office"?"officeHolidays":"fieldHolidays";return{[s]:r[s].filter(a=>a.id!==t)}})},addRecurringHoliday:async e=>{const t=await ue.addRecurringHoliday(e);n(r=>({recurringHolidays:[...r.recurringHolidays,t]}))},removeRecurringHoliday:async e=>{await ue.deleteRecurringHoliday(e),n(t=>({recurringHolidays:t.recurringHolidays.filter(r=>r.id!==e)}))}}),{name:"paradigm_app_settings",storage:Xc(()=>localStorage)})),an=Xi()(_u(n=>({colorScheme:"green",setColorScheme:e=>n({colorScheme:e}),initBranding:e=>n({colorScheme:e})}),{name:"paradigm-branding",storage:Xc(()=>localStorage)})),Rt=n=>{const[e,t]=E.useState(window.matchMedia(n).matches);return E.useEffect(()=>{const r=window.matchMedia(n),s=()=>t(r.matches);try{r.addEventListener("change",s)}catch{r.addListener(s)}return()=>{try{r.removeEventListener("change",s)}catch{r.removeListener(s)}}},[n]),e},RM=()=>({id:`draft_${Date.now()}`,status:"draft",enrollmentDate:new Date().toISOString().split("T")[0],personal:{employeeId:`PARA-${Math.floor(1e3+Math.random()*9e3)}`,firstName:"",lastName:"",dob:"",gender:"",maritalStatus:"",bloodGroup:"",mobile:"",alternateMobile:"",email:"",emergencyContactName:"",emergencyContactNumber:"",relationship:"",salary:null,verifiedStatus:{}},address:{present:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},permanent:{line1:"",city:"",state:"",country:"India",pincode:"",verifiedStatus:{country:!0}},sameAsPresent:!0},family:[],education:[],bank:{accountHolderName:"",accountNumber:"",confirmAccountNumber:"",ifscCode:"",bankName:"",branchName:"",verifiedStatus:{}},uan:{hasPreviousPf:!1,verifiedStatus:{},salarySlip:null},esi:{hasEsi:!1,verifiedStatus:{}},gmc:{isOptedIn:null,policyAmount:"",nomineeName:"",nomineeRelation:"",selectedSpouseId:"",selectedChildIds:[],gmcPolicyCopy:null,declarationAccepted:!1},organization:{designation:"",department:"",reportingManager:"",organizationId:"",organizationName:"",joiningDate:We(new Date,"yyyy-MM-dd"),workType:"Full-time",defaultSalary:null},uniforms:[],biometrics:{signatureImage:null,fingerprints:{leftThumb:null,leftIndex:null,leftMiddle:null,leftRing:null,leftLittle:null,rightThumb:null,rightIndex:null,rightMiddle:null,rightRing:null,rightLittle:null}},salaryChangeRequest:null,requiresManualVerification:!1,formsGenerated:!1,verificationUsage:[]}),Yn=Xi(n=>({data:RM(),setData:e=>n({data:e}),updatePersonal:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,...e}}})),setPersonalVerifiedStatus:e=>n(t=>({data:{...t.data,personal:{...t.data.personal,verifiedStatus:{...t.data.personal.verifiedStatus,...e}}}})),updateAddress:e=>n(t=>({data:{...t.data,address:{...t.data.address,...e}}})),setAddressVerifiedStatus:(e,t)=>n(r=>({data:{...r.data,address:{...r.data.address,[e]:{...r.data.address[e],verifiedStatus:{...r.data.address[e].verifiedStatus,...t}}}}})),updateFamily:e=>n(t=>({data:{...t.data,family:e}})),updateEducation:e=>n(t=>({data:{...t.data,education:e}})),updateBank:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,...e}}})),setBankVerifiedStatus:e=>n(t=>({data:{...t.data,bank:{...t.data.bank,verifiedStatus:{...t.data.bank.verifiedStatus,...e}}}})),updateUan:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,...e}}})),setUanVerifiedStatus:e=>n(t=>({data:{...t.data,uan:{...t.data.uan,verifiedStatus:{...t.data.uan.verifiedStatus,...e}}}})),updateEsi:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,...e}}})),setEsiVerifiedStatus:e=>n(t=>({data:{...t.data,esi:{...t.data.esi,verifiedStatus:{...t.data.esi.verifiedStatus,...e}}}})),updateGmc:e=>n(t=>({data:{...t.data,gmc:{...t.data.gmc,...e}}})),updateOrganization:e=>n(t=>({data:{...t.data,organization:{...t.data.organization,...e}}})),updateUniforms:e=>n(t=>({data:{...t.data,uniforms:e}})),updateBiometrics:e=>n(t=>({data:{...t.data,biometrics:{...t.data.biometrics,...e}}})),setSalaryChangeRequest:e=>n(t=>({data:{...t.data,salaryChangeRequest:e}})),setRequiresManualVerification:e=>n(t=>({data:{...t.data,requiresManualVerification:e}})),setFormsGenerated:e=>n(t=>({data:{...t.data,formsGenerated:e}})),logVerificationUsage:e=>n(t=>{const r=JSON.parse(JSON.stringify(t.data.verificationUsage||[])),s=r.find(a=>a.name===e);return s?s.count+=1:r.push({name:e,count:1}),{data:{...t.data,verificationUsage:r}}}),reset:()=>n({data:RM()}),addFamilyMember:()=>n(e=>({data:{...e.data,family:[...e.data.family,{id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""}]}})),updateFamilyMember:(e,t)=>n(r=>({data:{...r.data,family:r.data.family.map(s=>s.id===e?{...s,...t}:s)}})),removeFamilyMember:e=>n(t=>({data:{...t.data,family:t.data.family.filter(r=>r.id!==e)}})),addEducationRecord:()=>n(e=>({data:{...e.data,education:[...e.data.education,{id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""}]}})),updateEducationRecord:(e,t)=>n(r=>({data:{...r.data,education:r.data.education.map(s=>s.id===e?{...s,...t}:s)}})),removeEducationRecord:e=>n(t=>({data:{...t.data,education:t.data.education.filter(r=>r.id!==e)}})),addOrUpdateEmergencyContactAsFamilyMember:()=>n(e=>{const{personal:t,family:r}=e.data,{emergencyContactName:s,emergencyContactNumber:a,relationship:o}=t;if(s&&["Spouse","Child","Father","Mother"].includes(o)){const c=r.find(d=>d.name.toLowerCase()===s.toLowerCase()&&d.relation===o);if(c){if(c.phone!==a){const d=r.map(h=>h.id===c.id?{...h,phone:a}:h);return{data:{...e.data,family:d}}}}else{const d={id:`fam_emergency_${Date.now()}`,name:s,relation:o,phone:a,dob:"",gender:"",dependent:!1,idProof:null,occupation:""};return{data:{...e.data,family:[...r,d]}}}}return e})}));const YK=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),JF=(...n)=>n.filter((e,t,r)=>!!e&&r.indexOf(e)===t).join(" ");var GK={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};const ZK=E.forwardRef(({color:n="currentColor",size:e=24,strokeWidth:t=2,absoluteStrokeWidth:r,className:s="",children:a,iconNode:o,...l},c)=>E.createElement("svg",{ref:c,...GK,width:e,height:e,stroke:n,strokeWidth:r?Number(t)*24/Number(e):t,className:JF("lucide",s),...l},[...o.map(([d,h])=>E.createElement(d,h)),...Array.isArray(a)?a:[a]]));const Ae=(n,e)=>{const t=E.forwardRef(({className:r,...s},a)=>E.createElement(ZK,{ref:a,iconNode:e,className:JF(`lucide-${YK(n)}`,r),...s}));return t.displayName=`${n}`,t};const Hh=Ae("Activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]);const KK=Ae("Archive",[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]]);const Fa=Ae("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);const JK=Ae("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);const QK=Ae("BadgeCheck",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const XK=Ae("Badge",[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]]);const eJ=Ae("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);const tJ=Ae("BarChart",[["line",{x1:"12",x2:"12",y1:"20",y2:"10",key:"1vz5eb"}],["line",{x1:"18",x2:"18",y1:"20",y2:"4",key:"cun8e5"}],["line",{x1:"6",x2:"6",y1:"20",y2:"16",key:"hq0ia6"}]]);const Of=Ae("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);const nJ=Ae("BriefcaseBusiness",[["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M16 6V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v2",key:"1ksdt3"}],["path",{d:"M22 13a18.15 18.15 0 0 1-20 0",key:"12hx5q"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const QF=Ae("Briefcase",[["path",{d:"M16 20V4a2 2 0 0 0-2-2h-4a2 2 0 0 0-2 2v16",key:"jecpp"}],["rect",{width:"20",height:"14",x:"2",y:"6",rx:"2",key:"i6l2r4"}]]);const Zi=Ae("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);const rJ=Ae("Calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);const sJ=Ae("CalendarCheck2",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8",key:"bce9hv"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m16 20 2 2 4-4",key:"13tcca"}]]);const iJ=Ae("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);const aJ=Ae("CalendarClock",[["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M17.5 17.5 16 16.3V14",key:"akvzfd"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]]);const oJ=Ae("CalendarDays",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 18h.01",key:"lrp35t"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M16 18h.01",key:"kzsmim"}]]);const Da=Ae("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]);const C1=Ae("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);const lJ=Ae("Car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]]);const jl=Ae("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);const ju=Ae("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);const oy=Ae("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);const If=Ae("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);const cJ=Ae("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);const dJ=Ae("ChevronsLeft",[["path",{d:"m11 17-5-5 5-5",key:"13zhaf"}],["path",{d:"m18 17-5-5 5-5",key:"h8a8et"}]]);const uJ=Ae("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);const XF=Ae("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);const Ki=Ae("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);const LM=Ae("CircleCheck",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const FM=Ae("CircleHelp",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const fJ=Ae("CircleUserRound",[["path",{d:"M18 20a6 6 0 0 0-12 0",key:"1qehca"}],["circle",{cx:"12",cy:"10",r:"4",key:"1h16sb"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]);const gm=Ae("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const e3=Ae("ClipboardCheck",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"m9 14 2 2 4-4",key:"df797q"}]]);const t3=Ae("ClipboardList",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}],["path",{d:"M12 11h4",key:"1jrz19"}],["path",{d:"M12 16h4",key:"n85exb"}],["path",{d:"M8 11h.01",key:"1dfujw"}],["path",{d:"M8 16h.01",key:"18s6g9"}]]);const $c=Ae("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);const hJ=Ae("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);const n3=Ae("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);const mJ=Ae("Crop",[["path",{d:"M6 2v14a2 2 0 0 0 2 2h14",key:"ron5a4"}],["path",{d:"M18 22V8a2 2 0 0 0-2-2H2",key:"7s9ehn"}]]);const MS=Ae("Crosshair",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"22",x2:"18",y1:"12",y2:"12",key:"l9bcsi"}],["line",{x1:"6",x2:"2",y1:"12",y2:"12",key:"13hhkx"}],["line",{x1:"12",x2:"12",y1:"6",y2:"2",key:"10w3f3"}],["line",{x1:"12",x2:"12",y1:"22",y2:"18",key:"15g9kq"}]]);const bi=Ae("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);const pJ=Ae("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);const Cl=Ae("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const gJ=Ae("FileCheck",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"m9 15 2 2 4-4",key:"1grp1n"}]]);const xJ=Ae("FileDigit",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v4",key:"1pf5j1"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["rect",{width:"4",height:"6",x:"2",y:"12",rx:"2",key:"jm304g"}],["path",{d:"M10 12h2v6",key:"12zw74"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);const r3=Ae("FileDown",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]]);const ES=Ae("FilePenLine",[["path",{d:"m18 5-3-3H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2",key:"h0fsxq"}],["path",{d:"M8 18h1",key:"13wk12"}],["path",{d:"M18.4 9.6a2 2 0 1 1 3 3L17 17l-4 1 1-4Z",key:"dyo8mm"}]]);const us=Ae("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);const yJ=Ae("FileUp",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]]);const vJ=Ae("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]);const bJ=Ae("Files",[["path",{d:"M20 7h-3a2 2 0 0 1-2-2V2",key:"x099mo"}],["path",{d:"M9 18a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h7l4 4v10a2 2 0 0 1-2 2Z",key:"18t6ie"}],["path",{d:"M3 7.6v12.8A1.6 1.6 0 0 0 4.6 22h9.8",key:"1nja0z"}]]);const s3=Ae("Fingerprint",[["path",{d:"M12 10a2 2 0 0 0-2 2c0 1.02-.1 2.51-.26 4",key:"1nerag"}],["path",{d:"M14 13.12c0 2.38 0 6.38-1 8.88",key:"o46ks0"}],["path",{d:"M17.29 21.02c.12-.6.43-2.3.5-3.02",key:"ptglia"}],["path",{d:"M2 12a10 10 0 0 1 18-6",key:"ydlgp0"}],["path",{d:"M2 16h.01",key:"1gqxmh"}],["path",{d:"M21.8 16c.2-2 .131-5.354 0-6",key:"drycrb"}],["path",{d:"M5 19.5C5.5 18 6 15 6 12a6 6 0 0 1 .34-2",key:"1tidbn"}],["path",{d:"M8.65 22c.21-.66.45-1.32.57-2",key:"13wd9y"}],["path",{d:"M9 6.8a6 6 0 0 1 9 5.2v2",key:"1fr1j5"}]]);const qM=Ae("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]);const wJ=Ae("GitBranch",[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]]);const _J=Ae("GitPullRequest",[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]]);const i3=Ae("GraduationCap",[["path",{d:"M21.42 10.922a1 1 0 0 0-.019-1.838L12.83 5.18a2 2 0 0 0-1.66 0L2.6 9.08a1 1 0 0 0 0 1.832l8.57 3.908a2 2 0 0 0 1.66 0z",key:"j76jl0"}],["path",{d:"M22 10v6",key:"1lu8f3"}],["path",{d:"M6 12.5V16a6 3 0 0 0 12 0v-3.5",key:"1r8lef"}]]);const jJ=Ae("HardHat",[["path",{d:"M2 18a1 1 0 0 0 1 1h18a1 1 0 0 0 1-1v-2a1 1 0 0 0-1-1H3a1 1 0 0 0-1 1v2z",key:"1dej2m"}],["path",{d:"M10 10V5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v5",key:"1p9q5i"}],["path",{d:"M4 15v-3a6 6 0 0 1 6-6h0",key:"1uc279"}],["path",{d:"M14 6h0a6 6 0 0 1 6 6v3",key:"1j9mnm"}]]);const T1=Ae("HeartPulse",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}],["path",{d:"M3.22 12H9.5l.5-1 2 4.5 2-7 1.5 3.5h5.27",key:"1uw2ng"}]]);const k1=Ae("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);const NJ=Ae("Hourglass",[["path",{d:"M5 22h14",key:"ehvnwv"}],["path",{d:"M5 2h14",key:"pdyrp9"}],["path",{d:"M17 22v-4.172a2 2 0 0 0-.586-1.414L12 12l-4.414 4.414A2 2 0 0 0 7 17.828V22",key:"1d314k"}],["path",{d:"M7 2v4.172a2 2 0 0 0 .586 1.414L12 12l4.414-4.414A2 2 0 0 0 17 6.172V2",key:"1vvvr6"}]]);const a3=Ae("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);const Tl=Ae("IndianRupee",[["path",{d:"M6 3h12",key:"ggurg9"}],["path",{d:"M6 8h12",key:"6g4wlu"}],["path",{d:"m6 13 8.5 8",key:"u1kupk"}],["path",{d:"M6 13h3",key:"wdp6ag"}],["path",{d:"M9 13c6.667 0 6.667-10 0-10",key:"1nkvk2"}]]);const cu=Ae("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);const SJ=Ae("Laptop",[["path",{d:"M20 16V7a2 2 0 0 0-2-2H6a2 2 0 0 0-2 2v9m16 0H4m16 0 1.28 2.55a1 1 0 0 1-.9 1.45H3.62a1 1 0 0 1-.9-1.45L4 16",key:"tarvll"}]]);const o3=Ae("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);const CJ=Ae("Leaf",[["path",{d:"M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.48 19 2c1 2 2 4.18 2 8 0 5.5-4.78 10-10 10Z",key:"nnexq3"}],["path",{d:"M2 21c0-3 1.85-5.36 5.08-6C9.5 14.52 12 13 13 12",key:"mt58a7"}]]);const Ex=Ae("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);const P1=Ae("ListTodo",[["rect",{x:"3",y:"5",width:"6",height:"6",rx:"1",key:"1defrl"}],["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);const TJ=Ae("List",[["line",{x1:"8",x2:"21",y1:"6",y2:"6",key:"7ey8pc"}],["line",{x1:"8",x2:"21",y1:"12",y2:"12",key:"rjfblc"}],["line",{x1:"8",x2:"21",y1:"18",y2:"18",key:"c3b1m8"}],["line",{x1:"3",x2:"3.01",y1:"6",y2:"6",key:"1g7gq3"}],["line",{x1:"3",x2:"3.01",y1:"12",y2:"12",key:"1pjlvk"}],["line",{x1:"3",x2:"3.01",y1:"18",y2:"18",key:"28t2mc"}]]);const _t=Ae("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);const DS=Ae("Lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);const Dx=Ae("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);const _o=Ae("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);const l3=Ae("MailCheck",[["path",{d:"M22 13V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v12c0 1.1.9 2 2 2h8",key:"12jkf8"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}],["path",{d:"m16 19 2 2 4-4",key:"1b14m6"}]]);const Hf=Ae("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);const kl=Ae("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);const c3=Ae("Map",[["path",{d:"M14.106 5.553a2 2 0 0 0 1.788 0l3.659-1.83A1 1 0 0 1 21 4.619v12.764a1 1 0 0 1-.553.894l-4.553 2.277a2 2 0 0 1-1.788 0l-4.212-2.106a2 2 0 0 0-1.788 0l-3.659 1.83A1 1 0 0 1 3 19.381V6.618a1 1 0 0 1 .553-.894l4.553-2.277a2 2 0 0 1 1.788 0z",key:"169xi5"}],["path",{d:"M15 5.764v15",key:"1pn4in"}],["path",{d:"M9 3.236v15",key:"1uimfh"}]]);const OS=Ae("Maximize2",[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const zM=Ae("MessageSquarePlus",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]]);const xm=Ae("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);const kJ=Ae("Minimize2",[["polyline",{points:"4 14 10 14 10 20",key:"11kfnr"}],["polyline",{points:"20 10 14 10 14 4",key:"rlmsce"}],["line",{x1:"14",x2:"21",y1:"10",y2:"3",key:"o5lafz"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]]);const PJ=Ae("MousePointerClick",[["path",{d:"m9 9 5 12 1.8-5.2L21 14Z",key:"1b76lo"}],["path",{d:"M7.2 2.2 8 5.1",key:"1cfko1"}],["path",{d:"m5.1 8-2.9-.8",key:"1go3kf"}],["path",{d:"M14 4.1 12 6",key:"ita8i4"}],["path",{d:"m6 12-1.9 2",key:"mnht97"}]]);const MJ=Ae("Navigation",[["polygon",{points:"3 11 22 2 13 21 11 13 3 11",key:"1ltx0t"}]]);const EJ=Ae("Network",[["rect",{x:"16",y:"16",width:"6",height:"6",rx:"1",key:"4q2zg0"}],["rect",{x:"2",y:"16",width:"6",height:"6",rx:"1",key:"8cvhb9"}],["rect",{x:"9",y:"2",width:"6",height:"6",rx:"1",key:"1egb70"}],["path",{d:"M5 16v-3a1 1 0 0 1 1-1h12a1 1 0 0 1 1 1v3",key:"1jsf9p"}],["path",{d:"M12 12V8",key:"2874zd"}]]);const DJ=Ae("PackagePlus",[["path",{d:"M16 16h6",key:"100bgy"}],["path",{d:"M19 13v6",key:"85cyf1"}],["path",{d:"M21 10V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l2-1.14",key:"e7tb2h"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["line",{x1:"12",x2:"12",y1:"22",y2:"12",key:"a4e8g8"}]]);const ym=Ae("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]);const OJ=Ae("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);const IJ=Ae("Paperclip",[["path",{d:"m21.44 11.05-9.19 9.19a6 6 0 0 1-8.49-8.49l8.57-8.57A4 4 0 1 1 18 8.84l-8.59 8.57a2 2 0 0 1-2.83-2.83l8.49-8.48",key:"1u3ebp"}]]);const Af=Ae("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);const d3=Ae("Pin",[["line",{x1:"12",x2:"12",y1:"17",y2:"22",key:"1jrz49"}],["path",{d:"M5 17h14v-1.76a2 2 0 0 0-1.11-1.79l-1.78-.9A2 2 0 0 1 15 10.76V6h1a2 2 0 0 0 0-4H8a2 2 0 0 0 0 4h1v4.76a2 2 0 0 1-1.11 1.79l-1.78.9A2 2 0 0 0 5 15.24Z",key:"13yl11"}]]);const AJ=Ae("Plane",[["path",{d:"M17.8 19.2 16 11l3.5-3.5C21 6 21.5 4 21 3c-1-.5-3 0-4.5 1.5L13 8 4.8 6.2c-.5-.1-.9.1-1.1.5l-.3.5c-.2.5-.1 1 .3 1.3L9 12l-2 3H4l-1 1 3 2 2 3 1-1v-3l3-2 3.5 5.3c.3.4.8.5 1.3.3l.5-.2c.4-.3.6-.7.5-1.2z",key:"1v9wt8"}]]);const Vt=Ae("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);const IS=Ae("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);const RJ=Ae("Route",[["circle",{cx:"6",cy:"19",r:"3",key:"1kj8tv"}],["path",{d:"M9 19h8.5a3.5 3.5 0 0 0 0-7h-11a3.5 3.5 0 0 1 0-7H15",key:"1d8sl"}],["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}]]);const Cs=Ae("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);const Ia=Ae("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);const M1=Ae("Send",[["path",{d:"m22 2-7 20-4-9-9-4Z",key:"1q3vgg"}],["path",{d:"M22 2 11 13",key:"nzbqef"}]]);const Om=Ae("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);const u3=Ae("ShieldAlert",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]]);const ly=Ae("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);const f3=Ae("ShieldHalf",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 22V2",key:"zs6s6o"}]]);const LJ=Ae("ShieldPlus",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M9 12h6",key:"1c52cq"}],["path",{d:"M12 9v6",key:"199k2o"}]]);const vm=Ae("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);const Rf=Ae("Shirt",[["path",{d:"M20.38 3.46 16 2a4 4 0 0 1-8 0L3.62 3.46a2 2 0 0 0-1.34 2.23l.58 3.47a1 1 0 0 0 .99.84H6v10c0 1.1.9 2 2 2h8a2 2 0 0 0 2-2V10h2.15a1 1 0 0 0 .99-.84l.58-3.47a2 2 0 0 0-1.34-2.23z",key:"1wgbhj"}]]);const FJ=Ae("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);const bm=Ae("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);const dr=Ae("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]);const h3=Ae("SquareX",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);const m3=Ae("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);const p3=Ae("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);const g3=Ae("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);const qJ=Ae("Table",[["path",{d:"M12 3v18",key:"108xh3"}],["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}]]);const zJ=Ae("ThumbsUp",[["path",{d:"M7 10v12",key:"1qc93n"}],["path",{d:"M15 5.88 14 10h5.83a2 2 0 0 1 1.92 2.56l-2.33 8A2 2 0 0 1 17.5 22H4a2 2 0 0 1-2-2v-8a2 2 0 0 1 2-2h2.76a2 2 0 0 0 1.79-1.11L12 2h0a3.13 3.13 0 0 1 3 3.88Z",key:"y3tblf"}]]);const rn=Ae("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);const UM=Ae("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);const Aa=Ae("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);const Hc=Ae("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);const xu=Ae("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]);const Yc=Ae("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);const Ox=Ae("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]);const Pl=Ae("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);const Ji=Ae("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);const x3=Ae("Video",[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]]);const y3=Ae("Wrench",[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]]);const vi=Ae("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);const UJ=Ae("ZapOff",[["path",{d:"M10.513 4.856 13.12 2.17a.5.5 0 0 1 .86.46l-1.377 4.317",key:"193nxd"}],["path",{d:"M15.656 10H20a1 1 0 0 1 .78 1.63l-1.72 1.773",key:"27a7lr"}],["path",{d:"M16.273 16.273 10.88 21.83a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14H4a1 1 0 0 1-.78-1.63l4.507-4.643",key:"1e0qe9"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);const AS=Ae("Zap",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const E1=Ae("ZoomIn",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"11",x2:"11",y1:"8",y2:"14",key:"1vmskp"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]);const D1=Ae("ZoomOut",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["line",{x1:"21",x2:"16.65",y1:"21",y2:"16.65",key:"13gj7c"}],["line",{x1:"8",x2:"14",y1:"11",y2:"11",key:"durymu"}]]),Qi=({className:n=""})=>{const{colorScheme:e}=an(),t=(()=>{switch(e){case"purple":return"#5B21B6";case"red":return"#991B1B";case"amber":return"#B45309";default:return"#006B3F"}})();return i.jsxs("div",{className:`flex items-center gap-2 ${n}`,children:[i.jsx("div",{className:"relative",children:i.jsx(CJ,{className:"w-8 h-8",style:{color:t}})}),i.jsx("div",{className:"flex flex-col leading-tight",children:i.jsxs("span",{className:"font-bold text-lg tracking-wide",style:{color:t},children:["PARADIGM SER",i.jsx("span",{className:"text-xs align-super",children:"vi"}),"CES"]})})]})},ne=({children:n,className:e="",variant:t="primary",size:r="md",isLoading:s=!1,...a})=>{const l=`btn-${t}`,c=`btn-${r}`,{colorScheme:d}=an(),h=()=>t==="primary"?{backgroundColor:"#006B3F",borderColor:"#005632",color:"#FFFFFF"}:t==="outline"?{borderColor:"#006B3F",color:"#006B3F"}:{};return i.jsx("button",{className:`btn ${l} ${c} ${e}`,disabled:s||a.disabled,style:{...h(),...a.style},...a,children:s?i.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[i.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),i.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}):n})},v3=Xi(_u(n=>({autoClickOnHover:!0,autoScrollOnHover:!0,setAutoClickOnHover:e=>n({autoClickOnHover:e}),setAutoScrollOnHover:e=>n({autoScrollOnHover:e})}),{name:"paradigm-ui-settings",storage:Xc(()=>localStorage)})),cy=Xi((n,e)=>({notifications:[],unreadCount:0,isLoading:!1,error:null,fetchNotifications:async()=>{const t=jt.getState().user;if(t){n({isLoading:!0,error:null});try{const r=await ue.getNotifications(t.id),s=r.filter(a=>!a.isRead).length;n({notifications:r,unreadCount:s,isLoading:!1})}catch{n({error:"Failed to fetch notifications.",isLoading:!1})}}},markAsRead:async t=>{const r=e().notifications.find(s=>s.id===t);if(!(r&&r.isRead))try{await ue.markNotificationAsRead(t),n(s=>({notifications:s.notifications.map(a=>a.id===t?{...a,isRead:!0}:a),unreadCount:Math.max(0,s.unreadCount-1)}))}catch(s){console.error("Failed to mark notification as read",s)}},markAllAsRead:async()=>{const t=jt.getState().user;if(t&&e().unreadCount!==0)try{await ue.markAllNotificationsAsRead(t.id),n(r=>({notifications:r.notifications.map(s=>({...s,isRead:!0})),unreadCount:0}))}catch(r){console.error("Failed to mark all notifications as read",r)}}})),BJ=({type:n})=>{const e={task_assigned:Yc,task_escalated:Aa,provisional_site_reminder:e3,security:vm,info:cu,greeting:g3},t={task_assigned:"text-blue-500 dark:text-blue-400",task_escalated:"text-orange-500 dark:text-orange-400",provisional_site_reminder:"text-purple-500 dark:text-purple-400",security:"text-red-500 dark:text-red-400",info:"text-blue-400 dark:text-blue-300",greeting:"text-yellow-500 dark:text-yellow-400"},r=e[n]||Of;return i.jsx(r,{className:`h-5 w-5 ${t[n]}`})},VJ=({className:n=""})=>{const{notifications:e,unreadCount:t,markAsRead:r,markAllAsRead:s}=cy(),{colorScheme:a}=an();Rt("(max-width: 767px)");const[o,l]=E.useState(!1),c=E.useRef(null),d=E.useRef(null),h=St();E.useEffect(()=>{const y=_=>{c.current&&!c.current.contains(_.target)&&d.current&&!d.current.contains(_.target)&&l(!1)};return document.addEventListener("mousedown",y),()=>document.removeEventListener("mousedown",y)},[]);const p=y=>{r(y.id),y.linkTo&&h(y.linkTo),l(!1)},x=()=>{s()};return i.jsxs("div",{className:`relative notification-bell ${n}`,children:[i.jsxs("button",{ref:d,onClick:()=>l(!o),className:"btn-icon relative p-2 rounded-full hover:bg-page text-muted","aria-label":`Notifications (${t} unread)`,children:[i.jsx(Of,{className:"h-5 w-5"}),t>0&&i.jsx("span",{className:"notification-dot absolute top-0 right-0 block h-2.5 w-2.5 rounded-full bg-red-500"})]}),o&&n4.createPortal(i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"fixed inset-0 bg-black/80 backdrop-blur-sm z-[90] md:hidden",onClick:()=>l(!1)}),i.jsxs("div",{ref:c,className:"fixed inset-x-4 top-20 bottom-20 z-[100] flex flex-col bg-white dark:!bg-[#0d1f12] rounded-2xl shadow-2xl border border-gray-200 dark:border-gray-800 md:absolute md:inset-auto md:top-16 md:right-4 md:mt-2 md:w-[400px] md:h-auto md:max-h-[600px] md:bottom-auto animate-in fade-in zoom-in-95 duration-200 overflow-hidden",style:{position:window.innerWidth>=768?"absolute":"fixed"},children:[i.jsxs("div",{className:"flex items-center justify-between p-5 border-b border-gray-200 dark:border-white/10 bg-gray-50 dark:!bg-[#0d1f12]",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white",children:"Notifications"}),i.jsxs("p",{className:"text-xs text-gray-500 dark:text-gray-400 mt-0.5",children:["You have ",t," unread messages"]})]}),i.jsx("div",{className:"flex items-center gap-2",children:t>0&&i.jsx("span",{onClick:x,className:"relative isolate overflow-hidden before:!content-none after:!content-none text-xs h-8 px-4 flex items-center justify-center rounded-3xl !bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D] !font-bold cursor-pointer transition-colors",style:{backgroundImage:"none"},children:i.jsx("span",{className:"relative z-10",children:"Mark all read"})})})]}),i.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar bg-white dark:!bg-[#0d1f12] dark:[color-scheme:dark]",children:e.slice(0,10).length>0?i.jsx("div",{className:"divide-y divide-gray-100 dark:divide-white/20",children:e.slice(0,10).map(y=>i.jsxs("div",{onClick:()=>p(y),className:`group flex items-start gap-4 p-5 cursor-pointer transition-all duration-200 ${y.isRead?"bg-white dark:!bg-[#0d1f12] hover:bg-gray-50 dark:hover:!bg-[#152b1b]":"bg-emerald-50 dark:!bg-[#0d1f12] hover:bg-emerald-100 dark:hover:!bg-[#152b1b]"}`,children:[i.jsx("div",{className:`flex-shrink-0 p-2.5 rounded-full ${y.isRead?"bg-gray-100 dark:bg-[#1a2e1a]":"bg-white dark:bg-[#1a2e1a] shadow-sm"}`,children:i.jsx(BJ,{type:y.type})}),i.jsxs("div",{className:"flex-1 min-w-0 pt-1",children:[i.jsx("p",{className:`text-sm font-medium leading-snug mb-1.5 ${y.isRead?"text-gray-600 dark:text-gray-300":"text-gray-900 dark:text-white"}`,children:y.message}),i.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-500 flex items-center gap-1",children:hu(new Date(y.createdAt),{addSuffix:!0})})]}),!y.isRead&&i.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500 mt-2.5 flex-shrink-0 shadow-[0_0_8px_rgba(16,185,129,0.5)]"})]},y.id))}):i.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-center p-8",children:[i.jsx("div",{className:"w-16 h-16 bg-gray-100 dark:bg-[#1a2e1a] rounded-full flex items-center justify-center mb-4",children:i.jsx(Of,{className:"h-8 w-8 text-gray-400 dark:text-gray-500"})}),i.jsx("h5",{className:"text-gray-900 dark:text-white font-medium mb-1",children:"No notifications"}),i.jsx("p",{className:"text-sm text-gray-500 dark:text-gray-400",children:"You're all caught up! Check back later."})]})})]})]}),document.body)]})},Kr=({isOpen:n,onClose:e,onConfirm:t,title:r,children:s,confirmButtonVariant:a="danger",confirmButtonText:o="Confirm",isConfirming:l=!1,isLoading:c})=>{if(!n)return null;const d=c!==void 0?c:l;return i.jsx("div",{className:"fixed inset-0 z-[999] flex items-center justify-center bg-black bg-opacity-50","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card shadow-card flex flex-col animate-fade-in-scale overflow-hidden w-full h-full sm:w-full sm:h-full sm:max-w-full sm:rounded-none md:w-auto md:h-auto md:max-w-md md:max-h-[90vh] md:rounded-xl",children:[i.jsx("div",{className:"flex-shrink-0 p-6 border-b border-border",children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:r})}),i.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:i.jsx("div",{className:"text-sm text-muted",children:s})}),i.jsx("div",{className:"flex-shrink-0 p-6 border-t border-border bg-card",children:i.jsxs("div",{className:"flex justify-end space-x-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ne,{onClick:t,variant:a,isLoading:d,children:o})]})})]})})},WJ=({className:n})=>i.jsxs("svg",{viewBox:"0 0 144 144",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:n,children:[i.jsx("circle",{cx:"72",cy:"72",r:"72",fill:"#F0EBE3"}),i.jsx("path",{d:"M109.5 144H34.5C34.5 119.464 51.18 99 72 99C92.82 99 109.5 119.464 109.5 144Z",fill:"white"}),i.jsx("path",{d:"M84 99C84 105.627 78.6274 111 72 111C65.3726 111 60 105.627 60 99H84Z",fill:"#E1C699"}),i.jsx("path",{d:"M96 87C96 70.4315 85.3726 57 72 57C58.6274 57 48 70.4315 48 87H96Z",fill:"#4A4A4A"}),i.jsx("rect",{x:"62",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"}),i.jsx("rect",{x:"77",y:"77",width:"5",height:"2",rx:"1",fill:"#2D2D2D"})]}),pb=[WJ],Gi=({className:n,photoUrl:e,seed:t})=>{const{user:r}=jt();if(e)return i.jsx("img",{src:e,alt:"Profile",className:`object-cover ${n||""}`});const s=t||r?.id;if(!s){const l=pb[0];return i.jsx(l,{className:`text-muted/60 ${n||""}`})}const a=s.charCodeAt(s.length-1)%pb.length,o=pb[a];return i.jsx(o,{className:n||""})},b3=({setIsMobileMenuOpen:n})=>{const{user:e,logout:t}=jt(),{permissions:r}=ta(),{colorScheme:s}=an(),a=St(),[o,l]=E.useState(!1),[c,d]=E.useState(!1),h=E.useRef(null),p=Rt("(max-width: 767px)");Zr(),E.useEffect(()=>{const w=j=>{h.current&&!h.current.contains(j.target)&&l(!1)};return document.addEventListener("mousedown",w),()=>document.removeEventListener("mousedown",w)},[]);const x=w=>w.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase()),y=()=>{n?.(!1),l(!1),d(!0)},_=async()=>{d(!1),await t(),a("/auth/login",{replace:!0})};return i.jsxs(i.Fragment,{children:[i.jsx(Kr,{isOpen:c,onClose:()=>d(!1),onConfirm:_,title:"Confirm Log Out",children:"Are you sure you want to log out?"}),i.jsx("header",{className:`sticky top-0 z-40 ${p?s!=="green"?"bg-[#1a3a6e] border-white/10":"bg-[#041b0f] border-[#1f3d2b]":"md:bg-gray-50/50 md:border-gray-200/50"} backdrop-blur-md border-b transition-all duration-200`,style:{paddingTop:"env(safe-area-inset-top)"},children:i.jsx("div",{className:"px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center h-16",children:[i.jsx("div",{className:"flex-1 flex justify-center md:justify-start min-w-0 px-2",children:p&&i.jsx("div",{className:"flex items-center justify-center bg-transparent p-2 border-0",children:i.jsx(Qi,{className:"border-0 h-[52px]"})})}),i.jsx("div",{className:"flex-none flex justify-end w-auto min-w-10",children:i.jsxs("div",{className:"flex items-center gap-1 sm:gap-2",children:[i.jsx(VJ,{}),!p&&e&&i.jsxs("div",{className:"relative",ref:h,children:[i.jsxs("button",{onClick:()=>l(!o),className:"flex items-center space-x-2 p-2 rounded-lg hover:bg-page transition-colors","aria-expanded":o,"aria-haspopup":"true",children:[i.jsx(Gi,{photoUrl:e.photoUrl,seed:e.id,className:"h-8 w-8 rounded-lg"}),i.jsxs("div",{className:"text-left hidden sm:block",children:[i.jsx("span",{className:"text-sm font-semibold",children:e.name}),i.jsx("span",{className:"text-xs text-muted block",children:x(e.role)})]}),i.jsx(ju,{className:"h-4 w-4 text-muted"})]}),o&&i.jsxs("div",{className:"absolute right-0 mt-2 w-48 bg-card rounded-xl shadow-card border border-border py-1 z-40 animate-fade-in-down",role:"menu",children:[i.jsxs(Oa,{to:"/profile",onClick:()=>l(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(Pl,{className:"mr-2 h-4 w-4"}),"Profile"]}),e&&r[e.role]?.includes("apply_for_leave")&&i.jsxs(Oa,{to:"/leaves/dashboard",onClick:()=>l(!1),className:"flex items-center px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(MS,{className:"mr-2 h-4 w-4"}),"Tracker"]}),i.jsxs("button",{onClick:y,className:"flex items-center w-full text-left px-4 py-2 text-sm text-primary-text hover:bg-page",role:"menuitem",children:[i.jsx(_o,{className:"mr-2 h-4 w-4"}),"Log Out"]})]})]})]})})]})})})]})},w3=[{to:"/verification/dashboard",label:"All Submissions",icon:o3,permission:"view_all_submissions"},{to:"/developer/api",label:"API Settings",icon:Om,permission:"view_developer_settings"},{to:"/attendance/dashboard",label:"Attendance",icon:Da,permission:"view_own_attendance"},{to:"/hr/attendance-settings",label:"Attendance Rules",icon:sJ,permission:"manage_attendance_rules"},{to:"/support",label:"Backend Support",icon:Ex,permission:"access_support_desk"},{to:"/hr/entities",label:"Client Management",icon:QF,permission:"view_entity_management"},{to:"/hr/enrollment-rules",label:"Enrollment Rules",icon:e3,permission:"manage_enrollment_rules"},{to:"/hr/policies-and-insurance",label:"Insurance Management",icon:f3,permission:"manage_insurance"},{to:"/billing/summary",label:"Invoice Summary",icon:xJ,permission:"view_invoice_summary"},{to:"/billing/cost-analysis",label:"Verification Costing",icon:Tl,permission:"view_verification_costing"},{to:"/admin/approval-workflow",label:"Leave Approval Settings",icon:wJ,permission:"manage_approval_workflow"},{to:"/hr/leave-management",label:"Leave Management",icon:_J,permission:"manage_leave_requests"},{to:"/admin/modules",label:"Module Management",icon:DJ,permission:"manage_modules"},{to:"/onboarding",label:"New Enrollment",icon:Yc,permission:"create_enrollment"},{to:"/operations/dashboard",label:"Operations",icon:nJ,permission:"view_operations_dashboard"},{to:"/profile",label:"Profile",icon:Pl,permission:"view_own_attendance"},{to:"/admin/roles",label:"Role Management",icon:ly,permission:"manage_roles_and_permissions"},{to:"/site/dashboard",label:"Site Dashboard",icon:k1,permission:"view_site_dashboard"},{to:"/admin/sites",label:"Site Management",icon:Zi,permission:"manage_sites"},{to:"/tasks",label:"Task Management",icon:P1,permission:"manage_tasks"},{to:"/uniforms",label:"Uniform Management",icon:Rf,permission:"manage_uniforms"},{to:"/admin/users",label:"User Management",icon:Ji,permission:"manage_users"},{to:"/hr/field-officer-tracking",label:"User Activity Tracking",icon:c3,permission:"view_field_officer_tracking"},{to:"/hr/locations",label:"Geo Locations",icon:kl,permission:"manage_attendance_rules"},{to:"/attendance/locations",label:"My Locations",icon:MJ,permission:"view_own_attendance"}],$J=({isCollapsed:n,onLinkClick:e,onExpand:t,hideHeader:r=!1,mode:s="light",isMobile:a=!1})=>{const{user:o}=jt(),{permissions:l}=ta(),{colorScheme:c}=an();Zr();const d=o?w3.filter(x=>l[o.role]?.includes(x.permission)).sort((x,y)=>x.label.localeCompare(y.label)):[],h=(()=>{switch(c){case"purple":return{bg:"#5B21B6",border:"#4C1D95"};case"red":return{bg:"#991B1B",border:"#7F1D1D"};case"amber":return{bg:"#B45309",border:"#92400E"};default:return{bg:"#006B3F",border:"#005632"}}})(),p=x=>{if(a&&n&&t){x.preventDefault(),t();return}e&&e()};return i.jsxs("div",{className:"flex flex-col",children:[r&&n&&i.jsx("div",{className:"p-4 border-b flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",style:{borderColor:c==="purple"?"#4C1D95":c==="red"?"#7F1D1D":c==="amber"?"#92400E":"#1f3d2b",backgroundColor:c==="purple"?"#3B0764":c==="red"?"#450A0A":c==="amber"?"#451A03":"#041b0f"},children:i.jsxs("button",{onClick:()=>window.location.href="/#/profile",className:"btn-icon inline-flex items-center justify-center p-2 rounded-md text-white hover:bg-white/10 focus:outline-none","aria-label":"Go to profile page",children:[i.jsx("span",{className:"sr-only",children:"Go to profile"}),i.jsx(Fa,{className:"block h-6 w-6"})]})}),r&&!n&&i.jsx("div",{className:"p-4 border-b flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",style:{borderColor:c==="purple"?"#4C1D95":c==="red"?"#7F1D1D":c==="amber"?"#92400E":"#1f3d2b",backgroundColor:c==="purple"?"#3B0764":c==="red"?"#450A0A":c==="amber"?"#451A03":"#041b0f"}}),!r&&i.jsx("div",{className:"p-4 border-b border-gray-200 bg-white flex justify-center h-16 items-center transition-all duration-300 flex-shrink-0",children:n?i.jsx("div",{className:"h-8 w-8 overflow-hidden",children:i.jsx(Qi,{className:"h-8 max-w-none object-left object-cover"})}):i.jsx(Qi,{className:"h-14 lg:h-16"})}),i.jsx("nav",{className:"px-3 py-4 space-y-1.5",children:d.map(x=>i.jsx(m4,{to:x.to,onClick:p,className:({isActive:y})=>`group flex items-center px-3 py-3 rounded-xl text-sm font-medium transition-all duration-200 ease-in-out ${n?"justify-center":""} ${s==="light"?y?"!text-white shadow-sm border":"text-slate-700 hover:bg-gray-100 hover:text-slate-900":y?`${c==="purple"?"bg-[#5B21B6]":c==="red"?"bg-[#991B1B]":c==="amber"?"bg-[#B45309]":"bg-[#1c3a23]"} !text-white shadow-sm border border-white/5`:"text-white hover:bg-white/10 hover:text-white"} ${y&&s==="light"?"nav-active-white":""}`,style:({isActive:y})=>y?s==="light"?{backgroundColor:h.bg,borderColor:h.border,color:"#ffffff"}:{}:{},title:x.label,children:({isActive:y})=>i.jsxs(i.Fragment,{children:[i.jsx(x.icon,{className:`h-5 w-5 flex-shrink-0 transition-colors duration-200 ${s==="light"?y?"text-white":"text-slate-500 group-hover:text-slate-700":y?"text-white":"text-white group-hover:text-white"} ${n?"":"mr-3"}`}),!n&&i.jsx("span",{className:y&&s==="light"?"!text-white":"",style:y&&s==="light"?{color:"#ffffff"}:{},children:x.label})]})},x.to))}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                .nav-active-white,
                .nav-active-white *,
                a[aria-current="page"] span,
                a[aria-current="page"] svg {
                    color: #ffffff !important;
                }
            `}})]})},HJ=()=>{const{user:n}=jt(),{fetchNotifications:e}=cy(),{permissions:t}=ta(),{autoScrollOnHover:r}=v3(),{colorScheme:s}=an();Zr();const a=Rt("(max-width: 767px)"),o=E.useRef(null),l=E.useRef(null),[c,d]=E.useState(!0),[h,p]=E.useState(0),[x,y]=E.useState(!1);E.useEffect(()=>{d(a)},[a]);const _=E.useCallback(()=>{l.current!==null&&(clearInterval(l.current),l.current=null)},[]),w=E.useCallback(j=>{_();const C=o.current;if(!C)return;const P=()=>{C.scrollBy({top:j==="up"?-window.innerHeight*.8:window.innerHeight*.8,behavior:"smooth"})};P(),l.current=window.setInterval(P,300)},[_]);return E.useEffect(()=>{const j=()=>{const P=o.current;P&&(y(P.scrollHeight>P.clientHeight),p(P.scrollTop))},C=o.current;return C?.addEventListener("scroll",j,{passive:!0}),window.addEventListener("resize",j),j(),()=>{C?.removeEventListener("scroll",j),window.removeEventListener("resize",j),_()}},[_]),E.useEffect(()=>{n&&e()},[n,e]),n?i.jsxs("div",{className:`flex min-h-screen ${a?"bg-[#041b0f]":"bg-page"} ${a?"":"p-4 md:p-6 lg:p-8 gap-4 md:gap-6 lg:gap-8"}`,children:[a&&!c&&i.jsx("div",{className:"fixed inset-0 bg-black/50 z-20 transition-opacity duration-300",onClick:()=>d(!0)}),i.jsxs("aside",{className:`flex flex-col flex-shrink-0 transition-all duration-300 ease-in-out ${a?c?"w-16":"w-64":c?"w-20":"w-72"} ${a?"border-r":"bg-white border-r border-gray-200/60"} ${a?"fixed left-0 top-0 bottom-0 z-50":""}`,style:a?{backgroundColor:s==="purple"?"#3B0764":s==="red"?"#450A0A":s==="amber"?"#451A03":"#041b0f",borderRightColor:s==="purple"?"#4C1D95":s==="red"?"#7F1D1D":s==="amber"?"#92400E":"#1f3d2b"}:void 0,children:[i.jsx("div",{className:"flex-1 overflow-y-auto overflow-x-hidden",children:i.jsx($J,{isCollapsed:c,mode:a?"dark":"light",onLinkClick:a?()=>d(!0):void 0,onExpand:()=>d(!1),hideHeader:a,isMobile:a})}),i.jsx("div",{className:`flex-shrink-0 px-2 pt-2 mt-auto flex items-center ${a?"border-t border-[#1f3d2b]":"border-t border-border"}`,children:i.jsx("button",{onClick:()=>d(!c),className:`flex-1 flex items-center justify-center p-2 rounded-lg transition-colors ${a?"text-white/70 hover:bg-white/10":"text-muted hover:bg-page"}`,title:c?"Expand sidebar":"Collapse sidebar",children:c?i.jsx(uJ,{className:"h-5 w-5"}):i.jsx(dJ,{className:"h-5 w-5"})})})]}),i.jsxs("div",{className:`flex-1 flex flex-col ${a?"bg-[#041b0f]":"bg-gray-50/50"} ${a&&c?"ml-16":""}`,children:[i.jsx(b3,{}),i.jsx("main",{ref:o,className:`flex-1 overflow-y-auto ${a?"bg-[#041b0f]":"bg-page"}`,children:i.jsx("div",{className:"p-4",children:i.jsx(_f,{})})})]}),x&&!a&&i.jsxs("div",{className:"fixed bottom-8 right-8 z-50 flex flex-col gap-2 no-print",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>w("up"):void 0,onMouseLeave:_,onMouseDown:()=>w("up"),onMouseUp:_,onTouchStart:()=>w("up"),onTouchEnd:_,disabled:h<=0,"aria-label":"Scroll Up",children:i.jsx(cJ,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"secondary",size:"sm",className:"!rounded-full !p-2 shadow-lg",onMouseEnter:r?()=>w("down"):void 0,onMouseLeave:_,onMouseDown:()=>w("down"),onMouseUp:_,onTouchStart:()=>w("down"),onTouchEnd:_,disabled:o.current?Math.ceil(o.current.clientHeight+h)>=o.current.scrollHeight:!1,"aria-label":"Scroll Down",children:i.jsx(ju,{className:"h-5 w-5"})})]})]}):i.jsx(bl,{to:"/auth/login",replace:!0})},YJ=()=>{const{user:n}=jt(),{permissions:e}=ta(),{colorScheme:t}=an();if(!n)return null;const r=e[n.role]||[],s=[{to:"/mobile-home",label:"Home",icon:k1,show:!0},{to:"/attendance/dashboard",label:"Attendance",icon:iJ,show:r.includes("view_own_attendance")},{to:"/tasks",label:"Tasks",icon:P1,show:r.includes("manage_tasks")},{to:"/profile",label:"Profile",icon:Pl,show:!0}],a=t!=="green"?{bg:"#FFFFFF",border:"#e2e8f0",activeText:"#1a3a6e",inactiveText:"text-slate-400"}:{bg:"#041b0f",border:"#1f3d2b",activeText:"#22c55e",inactiveText:"text-gray-400"};return i.jsx("nav",{id:"mobile-bottom-nav",className:"fixed bottom-0 left-0 right-0 z-40 transition-colors duration-300",style:{paddingBottom:"env(safe-area-inset-bottom)",backgroundColor:a.bg,borderTopColor:a.border,borderTopWidth:"1px"},children:i.jsx("div",{className:"flex justify-around items-center h-16",children:s.filter(o=>o.show).map(o=>i.jsxs(m4,{to:o.to,className:({isActive:l})=>`flex flex-col items-center justify-center flex-1 h-full transition-colors ${l?"":a.inactiveText}`,style:({isActive:l})=>l?{color:a.activeText}:{},children:[i.jsx(o.icon,{className:"w-6 h-6"}),i.jsx("span",{className:"text-xs mt-1",children:o.label})]},o.to))})})},GJ=()=>{const{colorScheme:n}=an(),[e,t]=E.useState(!0),r=E.useRef(0),s=E.useRef(!1);return E.useEffect(()=>{const a=()=>{s.current||(window.requestAnimationFrame(()=>{const o=window.scrollY;o<r.current||o<10?t(!0):o>r.current&&o>10&&t(!1),r.current=o,s.current=!1}),s.current=!0)};return window.addEventListener("scroll",a,{passive:!0}),()=>window.removeEventListener("scroll",a)},[]),i.jsxs("div",{className:`flex flex-col min-h-screen ${n!=="green"?"!bg-white":"!bg-[#041b0f]"}`,children:[i.jsx("div",{className:`sticky top-0 z-50 transition-transform duration-200 ${e?"translate-y-0":"-translate-y-full"}`,children:i.jsx(b3,{})}),i.jsx("main",{className:`flex-1 overflow-y-auto px-4 pt-2 ${n!=="green"?"!bg-white":"!bg-[#041b0f]"}`,style:{paddingBottom:"calc(9.1rem + env(safe-area-inset-bottom))"},children:i.jsx(_f,{})}),i.jsx(YJ,{})]})},ZJ=["https://picsum.photos/seed/corporate_campus/1200/900","https://picsum.photos/seed/luxury_complex/1200/900","https://picsum.photos/seed/office_interior/1200/900","https://picsum.photos/seed/landscaping/1200/900","https://picsum.photos/seed/lobby_design/1200/900"],_3=Xi(_u((n,e)=>({backgroundImages:ZJ,addBackgroundImage:t=>{const r=e();return r.backgroundImages.includes(t)?!1:(n({backgroundImages:[...r.backgroundImages,t]}),!0)},removeBackgroundImage:t=>n(r=>({backgroundImages:r.backgroundImages.filter((s,a)=>a!==t)}))}),{name:"paradigm-auth-layout-settings",storage:Xc(()=>localStorage)})),KJ=()=>{const{backgroundImages:n}=_3(),[e,t]=E.useState(0),r=Zr();E.useEffect(()=>{if(n.length>1){const o=setInterval(()=>{t(l=>(l+1)%n.length)},5e3);return()=>clearInterval(o)}},[n.length]);const s=E.useMemo(()=>n&&n.length>0?n:["https://picsum.photos/seed/default_fallback_1/1200/900"],[n]),a=E.useMemo(()=>r.pathname.includes("signup")?{title:"Create an Account",subtitle:"Join our platform to get started."}:r.pathname.includes("forgot-password")?{title:"Forgot Password?",subtitle:"No worries, we'll send you reset instructions."}:r.pathname.includes("update-password")?{title:"Set a New Password",subtitle:"Please enter your new password."}:{title:"Sign In",subtitle:"Enter your credentials to access your account."},[r.pathname]);return i.jsxs("div",{className:"min-h-screen font-sans flex items-center justify-center bg-page relative overflow-hidden",children:[i.jsxs("div",{className:"absolute inset-0 w-full h-full",children:[s.map((o,l)=>i.jsx("div",{className:`absolute inset-0 w-full h-full bg-cover bg-center transition-opacity duration-1000 ease-in-out ${l===e?"opacity-100":"opacity-0"}`,style:{backgroundImage:`url(${o})`}},l)),i.jsx("div",{className:"absolute inset-0 bg-black/30"})," "]}),i.jsx("div",{className:"relative w-full max-w-3xl lg:max-w-4xl xl:max-w-5xl p-4",children:i.jsxs("div",{className:"auth-card-container w-full grid md:grid-cols-2 rounded-2xl shadow-2xl overflow-hidden backdrop-blur-md bg-black/40 border border-white/10",children:[i.jsxs("div",{className:"hidden md:flex flex-col justify-between p-6 lg:p-10 xl:p-16 bg-gradient-to-br from-black/40 to-black/70",children:[i.jsxs("div",{className:"flex flex-col items-center text-center",children:[i.jsx(Qi,{className:"h-10 lg:h-14 xl:h-24"}),i.jsx("h1",{className:"text-xl lg:text-2xl xl:text-4xl font-bold !text-white mt-6 lg:mt-8 leading-tight drop-shadow-lg relative z-10",style:{color:"#ffffff",textShadow:"0 2px 4px rgba(0,0,0,0.5)"},children:"Welcome to the Future of Onboarding."}),i.jsx("p",{className:"!text-white mt-4 max-w-md drop-shadow-lg text-xs lg:text-sm xl:text-base relative z-10",style:{color:"#ffffff",textShadow:"0 1px 2px rgba(0,0,0,0.5)"},children:"Streamlining the journey for every new member of the Paradigm family."})]}),i.jsx("div",{children:i.jsxs("p",{className:"!text-white text-[10px] lg:text-xs mt-4",style:{color:"#ffffff"},children:[" ",new Date().getFullYear()," Paradigm Services. All rights reserved."]})})]}),i.jsx("div",{className:"p-6 lg:p-10 xl:p-16 flex flex-col justify-center bg-[#050505]/85 backdrop-blur-xl border-l border-white/10",children:i.jsxs("div",{className:"w-full max-w-md mx-auto",children:[i.jsx("div",{className:"md:hidden flex justify-center mb-8",children:i.jsx(Qi,{className:"h-12"})}),i.jsx("h2",{className:"text-xl lg:text-2xl xl:text-3xl font-bold text-white mb-2",style:{color:"#ffffff"},children:a.title}),i.jsx("p",{className:"text-white mb-4 lg:mb-6 xl:mb-8 text-xs lg:text-sm xl:text-base",style:{color:"#ffffff"},children:a.subtitle}),i.jsx(_f,{})]})})]})})]})};function JJ(){const[n,e]=E.useState({isSecure:!0,issues:[],developerModeEnabled:!1,locationSpoofingDetected:!1});return E.useEffect(()=>{const t=()=>{const s=[];let a=!1,o=!1;("geolocation"in navigator,!1)&&(o=!0,s.push("Location spoofing detected. Please disable location mocking apps to continue."));const c=s.length===0;e({isSecure:c,issues:s,developerModeEnabled:a,locationSpoofingDetected:o})};t();const r=setInterval(t,2e3);return window.addEventListener("resize",t),()=>{clearInterval(r),window.removeEventListener("resize",t)}},[]),n}const QJ=({issues:n,onDismiss:e})=>{const[t,r]=E.useState(!1);return E.useEffect(()=>{const s=()=>{r(window.innerWidth<768)};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)},[]),t?i.jsx("div",{className:"fixed inset-0 z-50 bg-white overflow-y-auto",children:i.jsxs("div",{className:"min-h-screen p-4 flex flex-col",children:[i.jsx("div",{className:"flex justify-center mt-8 mb-6",children:i.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(vm,{className:"w-8 h-8 text-red-600"})})}),i.jsx("h2",{className:"text-xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-4",children:[i.jsx("p",{className:"text-gray-700 text-center text-sm",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-xs text-red-800",children:[i.jsx(Aa,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2 text-sm",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ne,{onClick:e,variant:"outline",className:"w-full mt-auto",size:"sm",children:"I Understand"})]})}):i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/70 backdrop-blur-sm",children:i.jsxs("div",{className:"relative bg-white rounded-2xl shadow-2xl p-8 max-w-md w-full mx-4 animate-in fade-in zoom-in duration-300",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:i.jsx(vm,{className:"w-10 h-10 text-red-600"})})}),i.jsx("h2",{className:"text-2xl font-bold text-center text-gray-900 mb-4",children:"Security Warning"}),i.jsxs("div",{className:"space-y-3 mb-6",children:[i.jsx("p",{className:"text-gray-700 text-center",children:"Access to this application has been temporarily blocked for security reasons:"}),i.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:i.jsx("ul",{className:"space-y-2",children:n.map((s,a)=>i.jsxs("li",{className:"flex items-start gap-2 text-sm text-red-800",children:[i.jsx(Aa,{className:"w-4 h-4 flex-shrink-0 mt-0.5"}),i.jsx("span",{children:s})]},a))})})]}),i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"To continue:"}),i.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[i.jsx("li",{children:"Close browser developer tools (F12)"}),i.jsx("li",{children:"Disable any location spoofing apps or extensions"}),i.jsx("li",{children:"Refresh this page"})]})]}),i.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-6",children:i.jsx("p",{className:"text-xs text-yellow-800 text-center",children:" Your reporting manager has been notified of this security alert."})}),e&&i.jsx(ne,{onClick:e,variant:"outline",className:"w-full",children:"I Understand"})]})})},XJ=({children:n})=>{const{user:e}=jt(),t=JJ(),[r,s]=E.useState(!1),a=e&&(e.role==="admin"||e.role==="developer");return E.useEffect(()=>{if(e&&!a&&!t.isSecure&&!r){const o=t.developerModeEnabled?"developer_mode":"location_spoofing";ue.sendSecurityAlert(e.id,e.name,o,void 0).catch(l=>console.error("Failed to send security alert:",l)),s(!0)}},[e,t,r,a]),e&&!a&&!t.isSecure?i.jsx(QJ,{issues:t.issues}):i.jsx(i.Fragment,{children:n})};var Lf;(function(n){n.Unimplemented="UNIMPLEMENTED",n.Unavailable="UNAVAILABLE"})(Lf||(Lf={}));class xf extends Error{constructor(e,t,r){super(e),this.message=e,this.code=t,this.data=r}}const eQ=n=>{var e,t;return n?.androidBridge?"android":!((t=(e=n?.webkit)===null||e===void 0?void 0:e.messageHandlers)===null||t===void 0)&&t.bridge?"ios":"web"},tQ=n=>{const e=n.CapacitorCustomPlatform||null,t=n.Capacitor||{},r=t.Plugins=t.Plugins||{},s=()=>e!==null?e.name:eQ(n),a=()=>s()!=="web",o=p=>{const x=d.get(p);return!!(x?.platforms.has(s())||l(p))},l=p=>{var x;return(x=t.PluginHeaders)===null||x===void 0?void 0:x.find(y=>y.name===p)},c=p=>n.console.error(p),d=new Map,h=(p,x={})=>{const y=d.get(p);if(y)return console.warn(`Capacitor plugin "${p}" already registered. Cannot register plugins twice.`),y.proxy;const _=s(),w=l(p);let j;const C=async()=>(!j&&_ in x?j=typeof x[_]=="function"?j=await x[_]():j=x[_]:e!==null&&!j&&"web"in x&&(j=typeof x.web=="function"?j=await x.web():j=x.web),j),P=(q,B)=>{var U,W;if(w){const G=w?.methods.find(Z=>B===Z.name);if(G)return G.rtype==="promise"?Z=>t.nativePromise(p,B.toString(),Z):(Z,Y)=>t.nativeCallback(p,B.toString(),Z,Y);if(q)return(U=q[B])===null||U===void 0?void 0:U.bind(q)}else{if(q)return(W=q[B])===null||W===void 0?void 0:W.bind(q);throw new xf(`"${p}" plugin is not implemented on ${_}`,Lf.Unimplemented)}},O=q=>{let B;const U=(...W)=>{const G=C().then(Z=>{const Y=P(Z,q);if(Y){const ae=Y(...W);return B=ae?.remove,ae}else throw new xf(`"${p}.${q}()" is not implemented on ${_}`,Lf.Unimplemented)});return q==="addListener"&&(G.remove=async()=>B()),G};return U.toString=()=>`${q.toString()}() { [capacitor code] }`,Object.defineProperty(U,"name",{value:q,writable:!1,configurable:!1}),U},M=O("addListener"),D=O("removeListener"),I=(q,B)=>{const U=M({eventName:q},B),W=async()=>{const Z=await U;D({eventName:q,callbackId:Z},B)},G=new Promise(Z=>U.then(()=>Z({remove:W})));return G.remove=async()=>{console.warn("Using addListener() without 'await' is deprecated."),await W()},G},F=new Proxy({},{get(q,B){switch(B){case"$$typeof":return;case"toJSON":return()=>({});case"addListener":return w?I:M;case"removeListener":return D;default:return O(B)}}});return r[p]=F,d.set(p,{name:p,proxy:F,platforms:new Set([...Object.keys(x),...w?[_]:[]])}),F};return t.convertFileSrc||(t.convertFileSrc=p=>p),t.getPlatform=s,t.handleError=c,t.isNativePlatform=a,t.isPluginAvailable=o,t.registerPlugin=h,t.Exception=xf,t.DEBUG=!!t.DEBUG,t.isLoggingEnabled=!!t.isLoggingEnabled,t},nQ=n=>n.Capacitor=tQ(n),Ix=nQ(typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:typeof global<"u"?global:{}),nd=Ix.registerPlugin;class O1{constructor(){this.listeners={},this.retainedEventArguments={},this.windowListeners={}}addListener(e,t){let r=!1;this.listeners[e]||(this.listeners[e]=[],r=!0),this.listeners[e].push(t);const a=this.windowListeners[e];a&&!a.registered&&this.addWindowListener(a),r&&this.sendRetainedArgumentsForEvent(e);const o=async()=>this.removeListener(e,t);return Promise.resolve({remove:o})}async removeAllListeners(){this.listeners={};for(const e in this.windowListeners)this.removeWindowListener(this.windowListeners[e]);this.windowListeners={}}notifyListeners(e,t,r){const s=this.listeners[e];if(!s){if(r){let a=this.retainedEventArguments[e];a||(a=[]),a.push(t),this.retainedEventArguments[e]=a}return}s.forEach(a=>a(t))}hasListeners(e){var t;return!!(!((t=this.listeners[e])===null||t===void 0)&&t.length)}registerWindowListener(e,t){this.windowListeners[t]={registered:!1,windowEventName:e,pluginEventName:t,handler:r=>{this.notifyListeners(t,r)}}}unimplemented(e="not implemented"){return new Ix.Exception(e,Lf.Unimplemented)}unavailable(e="not available"){return new Ix.Exception(e,Lf.Unavailable)}async removeListener(e,t){const r=this.listeners[e];if(!r)return;const s=r.indexOf(t);this.listeners[e].splice(s,1),this.listeners[e].length||this.removeWindowListener(this.windowListeners[e])}addWindowListener(e){window.addEventListener(e.windowEventName,e.handler),e.registered=!0}removeWindowListener(e){e&&(window.removeEventListener(e.windowEventName,e.handler),e.registered=!1)}sendRetainedArgumentsForEvent(e){const t=this.retainedEventArguments[e];t&&(delete this.retainedEventArguments[e],t.forEach(r=>{this.notifyListeners(e,r)}))}}const BM=n=>encodeURIComponent(n).replace(/%(2[346B]|5E|60|7C)/g,decodeURIComponent).replace(/[()]/g,escape),VM=n=>n.replace(/(%[\dA-F]{2})+/gi,decodeURIComponent);class rQ extends O1{async getCookies(){const e=document.cookie,t={};return e.split(";").forEach(r=>{if(r.length<=0)return;let[s,a]=r.replace(/=/,"CAP_COOKIE").split("CAP_COOKIE");s=VM(s).trim(),a=VM(a).trim(),t[s]=a}),t}async setCookie(e){try{const t=BM(e.key),r=BM(e.value),s=`; expires=${(e.expires||"").replace("expires=","")}`,a=(e.path||"/").replace("path=",""),o=e.url!=null&&e.url.length>0?`domain=${e.url}`:"";document.cookie=`${t}=${r||""}${s}; path=${a}; ${o};`}catch(t){return Promise.reject(t)}}async deleteCookie(e){try{document.cookie=`${e.key}=; Max-Age=0`}catch(t){return Promise.reject(t)}}async clearCookies(){try{const e=document.cookie.split(";")||[];for(const t of e)document.cookie=t.replace(/^ +/,"").replace(/=.*/,`=;expires=${new Date().toUTCString()};path=/`)}catch(e){return Promise.reject(e)}}async clearAllCookies(){try{await this.clearCookies()}catch(e){return Promise.reject(e)}}}nd("CapacitorCookies",{web:()=>new rQ});const sQ=async n=>new Promise((e,t)=>{const r=new FileReader;r.onload=()=>{const s=r.result;e(s.indexOf(",")>=0?s.split(",")[1]:s)},r.onerror=s=>t(s),r.readAsDataURL(n)}),iQ=(n={})=>{const e=Object.keys(n);return Object.keys(n).map(s=>s.toLocaleLowerCase()).reduce((s,a,o)=>(s[a]=n[e[o]],s),{})},aQ=(n,e=!0)=>n?Object.entries(n).reduce((r,s)=>{const[a,o]=s;let l,c;return Array.isArray(o)?(c="",o.forEach(d=>{l=e?encodeURIComponent(d):d,c+=`${a}=${l}&`}),c.slice(0,-1)):(l=e?encodeURIComponent(o):o,c=`${a}=${l}`),`${r}&${c}`},"").substr(1):null,oQ=(n,e={})=>{const t=Object.assign({method:n.method||"GET",headers:n.headers},e),s=iQ(n.headers)["content-type"]||"";if(typeof n.data=="string")t.body=n.data;else if(s.includes("application/x-www-form-urlencoded")){const a=new URLSearchParams;for(const[o,l]of Object.entries(n.data||{}))a.set(o,l);t.body=a.toString()}else if(s.includes("multipart/form-data")||n.data instanceof FormData){const a=new FormData;if(n.data instanceof FormData)n.data.forEach((l,c)=>{a.append(c,l)});else for(const l of Object.keys(n.data))a.append(l,n.data[l]);t.body=a;const o=new Headers(t.headers);o.delete("content-type"),t.headers=o}else(s.includes("application/json")||typeof n.data=="object")&&(t.body=JSON.stringify(n.data));return t};class lQ extends O1{async request(e){const t=oQ(e,e.webFetchExtra),r=aQ(e.params,e.shouldEncodeUrlParams),s=r?`${e.url}?${r}`:e.url,a=await fetch(s,t),o=a.headers.get("content-type")||"";let{responseType:l="text"}=a.ok?e:{};o.includes("application/json")&&(l="json");let c,d;switch(l){case"arraybuffer":case"blob":d=await a.blob(),c=await sQ(d);break;case"json":c=await a.json();break;case"document":case"text":default:c=await a.text()}const h={};return a.headers.forEach((p,x)=>{h[x]=p}),{data:c,headers:h,status:a.status,url:a.url}}async get(e){return this.request(Object.assign(Object.assign({},e),{method:"GET"}))}async post(e){return this.request(Object.assign(Object.assign({},e),{method:"POST"}))}async put(e){return this.request(Object.assign(Object.assign({},e),{method:"PUT"}))}async patch(e){return this.request(Object.assign(Object.assign({},e),{method:"PATCH"}))}async delete(e){return this.request(Object.assign(Object.assign({},e),{method:"DELETE"}))}}nd("CapacitorHttp",{web:()=>new lQ});function cQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return new Proxy({},{get(r,s){return(a,o,l)=>{const c=n.Capacitor.Plugins[t];if(c===void 0){l(new Error(`Capacitor plugin ${t} not found`));return}if(typeof c[s]!="function"){l(new Error(`Method ${s} not found in Capacitor plugin ${t}`));return}(async()=>{try{const d=await c[s](a);o(d)}catch(d){l(d)}})()}}})}})}function dQ(n){n.CapacitorUtils.Synapse=new Proxy({},{get(e,t){return n.cordova.plugins[t]}})}function j3(n=!1){typeof window>"u"||(window.CapacitorUtils=window.CapacitorUtils||{},window.Capacitor!==void 0&&!n?cQ(window):window.cordova!==void 0&&dQ(window))}const uQ=nd("Geolocation",{web:()=>Nf(()=>import("./web-DTtBf7Td.js"),[],import.meta.url).then(n=>new n.GeolocationWeb)});j3();var df;(function(n){n.Prompt="PROMPT",n.Camera="CAMERA",n.Photos="PHOTOS"})(df||(df={}));var tm;(function(n){n.Rear="REAR",n.Front="FRONT"})(tm||(tm={}));var WM;(function(n){n.Uri="uri",n.Base64="base64",n.DataUrl="dataUrl"})(WM||(WM={}));class fQ extends O1{async getPhoto(e){return new Promise(async(t,r)=>{if(e.webUseInput||e.source===df.Photos)this.fileInputExperience(e,t,r);else if(e.source===df.Prompt){let s=document.querySelector("pwa-action-sheet");s||(s=document.createElement("pwa-action-sheet"),document.body.appendChild(s)),s.header=e.promptLabelHeader||"Photo",s.cancelable=!1,s.options=[{title:e.promptLabelPhoto||"From Photos"},{title:e.promptLabelPicture||"Take Picture"}],s.addEventListener("onSelection",async a=>{a.detail===0?this.fileInputExperience(e,t,r):this.cameraExperience(e,t,r)})}else this.cameraExperience(e,t,r)})}async pickImages(e){return new Promise(async(t,r)=>{this.multipleFileInputExperience(t,r)})}async cameraExperience(e,t,r){if(customElements.get("pwa-camera-modal")){const s=document.createElement("pwa-camera-modal");s.facingMode=e.direction===tm.Front?"user":"environment",document.body.appendChild(s);try{await s.componentOnReady(),s.addEventListener("onPhoto",async a=>{const o=a.detail;o===null?r(new xf("User cancelled photos app")):o instanceof Error?r(o):t(await this._getCameraPhoto(o,e)),s.dismiss(),document.body.removeChild(s)}),s.present()}catch{this.fileInputExperience(e,t,r)}}else console.error("Unable to load PWA Element 'pwa-camera-modal'. See the docs: https://capacitorjs.com/docs/web/pwa-elements."),this.fileInputExperience(e,t,r)}fileInputExperience(e,t,r){let s=document.querySelector("#_capacitor-camera-input");const a=()=>{var o;(o=s.parentNode)===null||o===void 0||o.removeChild(s)};s||(s=document.createElement("input"),s.id="_capacitor-camera-input",s.type="file",s.hidden=!0,document.body.appendChild(s),s.addEventListener("change",o=>{const l=s.files[0];let c="jpeg";if(l.type==="image/png"?c="png":l.type==="image/gif"&&(c="gif"),e.resultType==="dataUrl"||e.resultType==="base64"){const d=new FileReader;d.addEventListener("load",()=>{if(e.resultType==="dataUrl")t({dataUrl:d.result,format:c});else if(e.resultType==="base64"){const h=d.result.split(",")[1];t({base64String:h,format:c})}a()}),d.readAsDataURL(l)}else t({webPath:URL.createObjectURL(l),format:c}),a()}),s.addEventListener("cancel",o=>{r(new xf("User cancelled photos app")),a()})),s.accept="image/*",s.capture=!0,e.source===df.Photos||e.source===df.Prompt?s.removeAttribute("capture"):e.direction===tm.Front?s.capture="user":e.direction===tm.Rear&&(s.capture="environment"),s.click()}multipleFileInputExperience(e,t){let r=document.querySelector("#_capacitor-camera-input-multiple");const s=()=>{var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)};r||(r=document.createElement("input"),r.id="_capacitor-camera-input-multiple",r.type="file",r.hidden=!0,r.multiple=!0,document.body.appendChild(r),r.addEventListener("change",a=>{const o=[];for(let l=0;l<r.files.length;l++){const c=r.files[l];let d="jpeg";c.type==="image/png"?d="png":c.type==="image/gif"&&(d="gif"),o.push({webPath:URL.createObjectURL(c),format:d})}e({photos:o}),s()}),r.addEventListener("cancel",a=>{t(new xf("User cancelled photos app")),s()})),r.accept="image/*",r.click()}_getCameraPhoto(e,t){return new Promise((r,s)=>{const a=new FileReader,o=e.type.split("/")[1];t.resultType==="uri"?r({webPath:URL.createObjectURL(e),format:o,saved:!1}):(a.readAsDataURL(e),a.onloadend=()=>{const l=a.result;t.resultType==="dataUrl"?r({dataUrl:l,format:o,saved:!1}):r({base64String:l.split(",")[1],format:o,saved:!1})},a.onerror=l=>{s(l)})})}async checkPermissions(){if(typeof navigator>"u"||!navigator.permissions)throw this.unavailable("Permissions API not available in this browser");try{return{camera:(await window.navigator.permissions.query({name:"camera"})).state,photos:"granted"}}catch{throw this.unavailable("Camera permissions are not available in this browser")}}async requestPermissions(){throw this.unimplemented("Not implemented on web.")}async pickLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}async getLimitedLibraryPhotos(){throw this.unavailable("Not implemented on web.")}}const hQ=nd("Camera",{web:()=>new fQ}),mQ=nd("PushNotifications",{});var $M;(function(n){n.Documents="DOCUMENTS",n.Data="DATA",n.Library="LIBRARY",n.Cache="CACHE",n.External="EXTERNAL",n.ExternalStorage="EXTERNAL_STORAGE",n.ExternalCache="EXTERNAL_CACHE",n.LibraryNoCloud="LIBRARY_NO_CLOUD",n.Temporary="TEMPORARY"})($M||($M={}));var HM;(function(n){n.UTF8="utf8",n.ASCII="ascii",n.UTF16="utf16"})(HM||(HM={}));const pQ=nd("Filesystem",{web:()=>Nf(()=>import("./web-BBrdy72o.js"),[],import.meta.url).then(n=>new n.FilesystemWeb)});j3();const YM=nd("App",{web:()=>Nf(()=>import("./web-DLOSpf4P.js"),[],import.meta.url).then(n=>new n.AppWeb)}),gQ=nd("SecurityCheck"),xQ=({children:n})=>{const[e,t]=E.useState({location:!1,camera:!1,notification:!1,microphone:!1,storage:!1,calendar:!1,contacts:!1,activity:!1}),[r,s]=E.useState({developerMode:!1}),[a,o]=E.useState(!0),l=Ix.isNativePlatform(),c=async()=>{if(!l){o(!1);return}try{let p=!1,x=!1,y=!1,_=!1,w=!1,j=!1;try{const B=await gQ.getSecurityStatus();p=B.developerMode,x=B.microphoneGranted===!0,y=B.calendarGranted===!0,_=B.contactsGranted===!0,w=B.filesGranted===!0,j=B.activityGranted===!0}catch(B){console.warn("Failed to check security status or plugin not available",B)}const C=await uQ.checkPermissions(),P=C.location==="granted"||C.coarseLocation==="granted",O=await hQ.checkPermissions(),M=O.camera==="granted"||O.photos==="granted";let D=!1;try{D=(await mQ.checkPermissions()).receive==="granted"}catch(B){console.warn("Push details not available or failed",B)}const F=(await pQ.checkPermissions()).publicStorage==="granted";t({location:P,camera:M,notification:D,storage:F,microphone:x,calendar:y,contacts:_,activity:j}),s({developerMode:p})}catch(p){console.error("Error checking permissions:",p)}finally{o(!1)}};if(E.useEffect(()=>{c();const p=YM.addListener("appStateChange",({isActive:x})=>{x&&c()});return()=>{p.then(x=>x.remove())}},[l]),!l)return i.jsx(i.Fragment,{children:n});if(a)return i.jsx("div",{className:"flex items-center justify-center h-screen bg-gray-100",children:i.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-primary-600"})});if(r.developerMode)return i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-50 px-6 text-center animate-fade-in",children:i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-xl max-w-sm w-full border-2 border-red-500",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-red-50 ring-8 ring-red-50/50",children:i.jsx("svg",{className:"h-10 w-10 text-red-500",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Security Alert"}),i.jsx("p",{className:"text-gray-600 mb-6 text-sm leading-relaxed",children:"Developer Options are enabled on this device."}),i.jsxs("div",{className:"bg-red-50 rounded-lg p-4 mb-6 text-left border border-red-100",children:[i.jsx("p",{className:"text-xs text-red-800 font-medium mb-1",children:"Action Required"}),i.jsxs("p",{className:"text-xs text-red-600",children:["Please disable ",i.jsx("strong",{children:"Developer Options"})," in your device settings to continue using the application securely."]})]}),i.jsx("button",{onClick:()=>c(),className:"w-full bg-red-600 hover:bg-red-700 text-white font-semibold py-3.5 px-4 rounded-xl shadow-lg shadow-red-600/20 transition-all duration-200 active:scale-[0.98]",children:"Retry Check"})]})});if(e.location&&e.camera&&e.notification&&e.storage&&e.microphone&&e.calendar&&e.contacts&&e.activity)return i.jsx(i.Fragment,{children:n});const h=async()=>{try{await YM.openAppSettings()}catch(p){console.error("Failed to open settings",p)}};return i.jsx("div",{className:"flex flex-col items-center justify-center h-screen bg-gray-900 px-6 text-center animate-fade-in",children:i.jsxs("div",{className:"bg-white p-8 rounded-2xl shadow-2xl max-w-sm w-full border-4 border-red-600 relative overflow-hidden",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"mx-auto flex h-20 w-20 items-center justify-center rounded-full bg-red-50 ring-8 ring-red-50/50",children:i.jsx("svg",{className:"h-10 w-10 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:i.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),i.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-2",children:"Permissions Access"}),i.jsx("p",{className:"text-gray-500 mb-6 text-sm leading-relaxed",children:"This app requires full access to function. Please grant the following permissions in Settings."}),i.jsxs("div",{className:"w-full space-y-3 mb-8 text-left text-sm max-h-[320px] overflow-y-auto pr-1",children:[i.jsx(Sc,{label:"Location",granted:e.location}),i.jsx(Sc,{label:"Camera",granted:e.camera}),i.jsx(Sc,{label:"Notifications",granted:e.notification}),i.jsx(Sc,{label:"Microphone",granted:e.microphone}),i.jsx(Sc,{label:"Files & Media",granted:e.storage}),i.jsx(Sc,{label:"Calendar",granted:e.calendar}),i.jsx(Sc,{label:"Contacts",granted:e.contacts}),i.jsx(Sc,{label:"Physical Activity",granted:e.activity})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx("button",{onClick:h,className:"w-full bg-red-600 hover:bg-red-700 text-white font-bold py-4 px-4 rounded-xl shadow-lg shadow-red-600/20 transition-all duration-200 active:scale-[0.98] uppercase tracking-wide text-sm",children:"Grant Access"}),i.jsx("button",{onClick:c,className:"text-gray-500 text-xs hover:text-gray-700 underline underline-offset-2",children:"I have granted them, Check Again"})]})]})})},Sc=({label:n,granted:e})=>i.jsxs("div",{className:"flex justify-between items-center py-2.5 px-3 rounded-lg bg-gray-50 border border-gray-100",children:[i.jsx("span",{className:"font-medium text-gray-700 text-sm",children:n}),e?i.jsx("svg",{className:"h-5 w-5 text-emerald-500",viewBox:"0 0 20 20",fill:"currentColor",children:i.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}):i.jsx("span",{className:"text-[10px] font-bold px-2 py-0.5 rounded-full bg-red-100 text-red-600 tracking-wide uppercase",children:"Required"})]}),yQ=({onComplete:n})=>{const e=Rt("(max-width: 767px)"),{colorScheme:t}=an(),[r,s]=E.useState("prompt"),[a,o]=E.useState("prompt"),[l,c]=E.useState(!1),[d,h]=E.useState(null),p=r==="granted"&&a==="granted",x=t==="blue",y=x?"bg-[#1a3a6e]":"bg-white",_=x?"text-white":"text-gray-600",w=x?"text-white":"text-gray-900",j=x?"bg-white/10 border-white/20":"bg-gray-100 border-gray-300",C=x?"text-white":"text-gray-900",P=x?"text-gray-300":"text-gray-600";E.useEffect(()=>{(!e||p)&&n()},[e,p,n]);const O=async()=>{c(!0),h(null);try{try{const M=await navigator.mediaDevices.getUserMedia({video:!0});o("granted"),M.getTracks().forEach(D=>D.stop())}catch{throw o("denied"),new Error("Camera permission was denied.")}try{await new Promise((M,D)=>{navigator.geolocation.getCurrentPosition(()=>{s("granted"),M(!0)},()=>{s("denied"),D(new Error("Location permission was denied."))},{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})})}catch{throw new Error("Location permission was denied.")}n()}catch(M){h(M.message||"Permissions are required to use this app.")}finally{c(!1)}};return e?i.jsxs("div",{className:`min-h-screen flex flex-col items-center justify-center p-4 text-center ${y}`,children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Qi,{className:"h-16 mb-8"})}),i.jsxs("div",{className:"max-w-md",children:[i.jsx("h1",{className:`text-2xl font-bold mb-4 ${w}`,children:"Permissions Required"}),i.jsx("p",{className:`mb-8 ${_}`,children:"To ensure the best experience and enable features like location-based check-ins and photo uploads, we need access to your device's Camera and Location."}),i.jsxs("div",{className:"space-y-4 mb-8",children:[i.jsxs("div",{className:`p-4 rounded-lg border ${r==="granted"?"bg-emerald-500/20 border-emerald-500 text-emerald-100":j}`,children:[i.jsx("p",{className:`font-semibold ${C}`,children:"Location Access"}),i.jsx("p",{className:`text-sm ${P}`,children:r==="granted"?"Permission Granted":"Needed for check-in/out"})]}),i.jsxs("div",{className:`p-4 rounded-lg border ${a==="granted"?"bg-emerald-500/20 border-emerald-500 text-emerald-100":j}`,children:[i.jsx("p",{className:`font-semibold ${C}`,children:"Camera Access"}),i.jsx("p",{className:`text-sm ${P}`,children:a==="granted"?"Permission Granted":"Needed for identity verification"})]})]}),i.jsx(ne,{onClick:O,disabled:l,className:x?"w-full bg-white text-[#1a3a6e] hover:bg-gray-100":"w-full",children:l?"Requesting...":"Grant Permissions"}),d&&i.jsx("p",{className:"text-red-500 mt-4",children:d}),i.jsx("p",{className:`text-xs mt-8 ${x?"text-white/50":"text-gray-500"}`,children:"You can manage these permissions in your device settings at any time."})]})]}):null},vQ=()=>{const[n,e]=E.useState(!1),t=()=>{e(!0)};return n?i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-white p-4",children:[i.jsx("div",{className:"splash-logo",children:i.jsx(Qi,{className:"h-16 mb-8"})}),i.jsx("p",{className:"text-gray-600",children:"Loading Application..."})]}):i.jsx(yQ,{onComplete:t})},bQ=()=>{const{user:n,logout:e}=jt(),{permissions:t}=ta(),{colorScheme:r}=an(),s=St(),a={bg:"bg-[#041b0f]",cardBg:"bg-[#041b0f]",iconBg:"bg-[#041b0f]",border:"border-[#1f3d2b]",highlightBorder:"border-[#22c55e]",iconColor:"text-[#22c55e]",textColor:"text-white",subTextColor:"text-gray-400",headingColor:"text-white",cardHeadingColor:"text-white"};if(!n)return null;const o=w3.filter(c=>t[n.role]?.includes(c.permission)).sort((c,d)=>c.label.localeCompare(d.label)),l=async()=>{await e(),s("/auth/login")};return i.jsxs("div",{className:`min-h-[calc(100vh-180px)] flex flex-col pb-4 ${a.bg}`,children:[i.jsx("div",{className:`${a.cardBg} border ${a.border} p-6 rounded-3xl shadow-lg -mx-4 mb-6`,children:i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{className:"flex items-center space-x-3",children:[i.jsx(Gi,{photoUrl:n.photoUrl,seed:n.id,className:`h-14 w-14 rounded-full border-2 ${a.highlightBorder}`}),i.jsxs("div",{children:[i.jsxs("h1",{className:`text-2xl font-bold ${a.cardHeadingColor}`,children:["Hi, ",n.name.split(" ")[0]]}),i.jsx("p",{className:`text-xs ${a.subTextColor} uppercase tracking-wider`,children:n.role.replace(/_/g," ")})]})]})})}),i.jsxs("div",{className:"flex-1 flex flex-col",children:[i.jsx("h2",{className:`text-lg font-semibold ${a.headingColor} mb-4 px-2`,children:"Apps & Features"}),i.jsx("div",{className:"grid grid-cols-3 gap-3 px-2 flex-1 content-start",children:o.map(c=>i.jsxs("div",{onClick:()=>s(c.to),className:`flex flex-col items-center justify-center p-4 ${a.cardBg} border ${a.border} rounded-2xl active:scale-95 transition-transform duration-150 shadow-md min-h-[110px]`,children:[i.jsx("div",{className:`p-3 ${a.iconBg} rounded-full mb-2 ${a.iconColor}`,children:i.jsx(c.icon,{className:"w-7 h-7"})}),i.jsx("span",{className:`text-xs text-center ${a.textColor} font-medium leading-tight`,children:c.label})]},c.to))})]}),i.jsx("div",{className:"px-2 mt-6",children:i.jsxs("button",{onClick:l,className:"w-full flex items-center justify-center space-x-2 p-4 bg-[#1f2937] text-white rounded-xl font-semibold active:bg-[#374151] transition-colors",children:[i.jsx(_o,{className:"w-5 h-5"}),i.jsx("span",{children:"Log Out"})]})})]})};var Im=n=>n.type==="checkbox",ou=n=>n instanceof Date,Ws=n=>n==null;const N3=n=>typeof n=="object";var br=n=>!Ws(n)&&!Array.isArray(n)&&N3(n)&&!ou(n),S3=n=>br(n)&&n.target?Im(n.target)?n.target.checked:n.target.value:n,wQ=n=>n.substring(0,n.search(/\.\d+(\.|$)/))||n,C3=(n,e)=>n.has(wQ(e)),_Q=n=>{const e=n.constructor&&n.constructor.prototype;return br(e)&&e.hasOwnProperty("isPrototypeOf")},I1=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function Un(n){let e;const t=Array.isArray(n),r=typeof FileList<"u"?n instanceof FileList:!1;if(n instanceof Date)e=new Date(n);else if(!(I1&&(n instanceof Blob||r))&&(t||br(n)))if(e=t?[]:Object.create(Object.getPrototypeOf(n)),!t&&!_Q(n))e=n;else for(const s in n)n.hasOwnProperty(s)&&(e[s]=Un(n[s]));else return n;return e}var dy=n=>/^\w*$/.test(n),Fn=n=>n===void 0,uy=n=>Array.isArray(n)?n.filter(Boolean):[],A1=n=>uy(n.replace(/["|']|\]/g,"").split(/\.|\[/)),nt=(n,e,t)=>{if(!e||!br(n))return t;const r=(dy(e)?[e]:A1(e)).reduce((s,a)=>Ws(s)?s:s[a],n);return Fn(r)||r===n?Fn(n[e])?t:n[e]:r},fi=n=>typeof n=="boolean",mn=(n,e,t)=>{let r=-1;const s=dy(e)?[e]:A1(e),a=s.length,o=a-1;for(;++r<a;){const l=s[r];let c=t;if(r!==o){const d=n[l];c=br(d)||Array.isArray(d)?d:isNaN(+s[r+1])?{}:[]}if(l==="__proto__"||l==="constructor"||l==="prototype")return;n[l]=c,n=n[l]}};const Ax={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Yi={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},ul={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},T3=ot.createContext(null);T3.displayName="HookFormContext";const fy=()=>ot.useContext(T3);var k3=(n,e,t,r=!0)=>{const s={defaultValues:e._defaultValues};for(const a in n)Object.defineProperty(s,a,{get:()=>{const o=a;return e._proxyFormState[o]!==Yi.all&&(e._proxyFormState[o]=!r||Yi.all),t&&(t[o]=!0),n[o]}});return s};const hy=typeof window<"u"?ot.useLayoutEffect:ot.useEffect;function jQ(n){const e=fy(),{control:t=e.control,disabled:r,name:s,exact:a}=n||{},[o,l]=ot.useState(t._formState),c=ot.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return hy(()=>t._subscribe({name:s,formState:c.current,exact:a,callback:d=>{!r&&l({...t._formState,...d})}}),[s,r,a]),ot.useEffect(()=>{c.current.isValid&&t._setValid(!0)},[t]),ot.useMemo(()=>k3(o,t,c.current,!1),[o,t])}var gi=n=>typeof n=="string",RS=(n,e,t,r,s)=>gi(n)?(r&&e.watch.add(n),nt(t,n,s)):Array.isArray(n)?n.map(a=>(r&&e.watch.add(a),nt(t,a))):(r&&(e.watchAll=!0),t),LS=n=>Ws(n)||!N3(n);function Ta(n,e,t=new WeakSet){if(LS(n)||LS(e))return n===e;if(ou(n)&&ou(e))return n.getTime()===e.getTime();const r=Object.keys(n),s=Object.keys(e);if(r.length!==s.length)return!1;if(t.has(n)||t.has(e))return!0;t.add(n),t.add(e);for(const a of r){const o=n[a];if(!s.includes(a))return!1;if(a!=="ref"){const l=e[a];if(ou(o)&&ou(l)||br(o)&&br(l)||Array.isArray(o)&&Array.isArray(l)?!Ta(o,l,t):o!==l)return!1}}return!0}function du(n){const e=fy(),{control:t=e.control,name:r,defaultValue:s,disabled:a,exact:o,compute:l}=n||{},c=ot.useRef(s),d=ot.useRef(l),h=ot.useRef(void 0),p=ot.useRef(t),x=ot.useRef(r);d.current=l;const[y,_]=ot.useState(()=>{const M=t._getWatch(r,c.current);return d.current?d.current(M):M}),w=ot.useCallback(M=>{const D=RS(r,t._names,M||t._formValues,!1,c.current);return d.current?d.current(D):D},[t._formValues,t._names,r]),j=ot.useCallback(M=>{if(!a){const D=RS(r,t._names,M||t._formValues,!1,c.current);if(d.current){const I=d.current(D);Ta(I,h.current)||(_(I),h.current=I)}else _(D)}},[t._formValues,t._names,a,r]);hy(()=>((p.current!==t||!Ta(x.current,r))&&(p.current=t,x.current=r,j()),t._subscribe({name:r,formState:{values:!0},exact:o,callback:M=>{j(M.values)}})),[t,o,r,j]),ot.useEffect(()=>t._removeUnmounted());const C=p.current!==t,P=x.current,O=ot.useMemo(()=>{if(a)return null;const M=!C&&!Ta(P,r);return C||M?w():null},[a,C,r,P,w]);return O!==null?O:y}function NQ(n){const e=fy(),{name:t,disabled:r,control:s=e.control,shouldUnregister:a,defaultValue:o}=n,l=C3(s._names.array,t),c=ot.useMemo(()=>nt(s._formValues,t,nt(s._defaultValues,t,o)),[s,t,o]),d=du({control:s,name:t,defaultValue:c,exact:!0}),h=jQ({control:s,name:t,exact:!0}),p=ot.useRef(n),x=ot.useRef(void 0),y=ot.useRef(s.register(t,{...n.rules,value:d,...fi(n.disabled)?{disabled:n.disabled}:{}}));p.current=n;const _=ot.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!nt(h.errors,t)},isDirty:{enumerable:!0,get:()=>!!nt(h.dirtyFields,t)},isTouched:{enumerable:!0,get:()=>!!nt(h.touchedFields,t)},isValidating:{enumerable:!0,get:()=>!!nt(h.validatingFields,t)},error:{enumerable:!0,get:()=>nt(h.errors,t)}}),[h,t]),w=ot.useCallback(O=>y.current.onChange({target:{value:S3(O),name:t},type:Ax.CHANGE}),[t]),j=ot.useCallback(()=>y.current.onBlur({target:{value:nt(s._formValues,t),name:t},type:Ax.BLUR}),[t,s._formValues]),C=ot.useCallback(O=>{const M=nt(s._fields,t);M&&O&&(M._f.ref={focus:()=>O.focus&&O.focus(),select:()=>O.select&&O.select(),setCustomValidity:D=>O.setCustomValidity(D),reportValidity:()=>O.reportValidity()})},[s._fields,t]),P=ot.useMemo(()=>({name:t,value:d,...fi(r)||h.disabled?{disabled:h.disabled||r}:{},onChange:w,onBlur:j,ref:C}),[t,r,h.disabled,w,j,C,d]);return ot.useEffect(()=>{const O=s._options.shouldUnregister||a,M=x.current;M&&M!==t&&!l&&s.unregister(M),s.register(t,{...p.current.rules,...fi(p.current.disabled)?{disabled:p.current.disabled}:{}});const D=(I,F)=>{const q=nt(s._fields,I);q&&q._f&&(q._f.mount=F)};if(D(t,!0),O){const I=Un(nt(s._options.defaultValues,t,p.current.defaultValue));mn(s._defaultValues,t,I),Fn(nt(s._formValues,t))&&mn(s._formValues,t,I)}return!l&&s.register(t),x.current=t,()=>{(l?O&&!s._state.action:O)?s.unregister(t):D(t,!1)}},[t,s,l,a]),ot.useEffect(()=>{s._setDisabledField({disabled:r,name:t})},[r,t,s]),ot.useMemo(()=>({field:P,formState:h,fieldState:_}),[P,h,_])}const _e=n=>n.render(NQ(n));var P3=(n,e,t,r,s)=>e?{...t[n],types:{...t[n]&&t[n].types?t[n].types:{},[r]:s||!0}}:{},Ys=n=>Array.isArray(n)?n:[n],GM=()=>{let n=[];return{get observers(){return n},next:s=>{for(const a of n)a.next&&a.next(s)},subscribe:s=>(n.push(s),{unsubscribe:()=>{n=n.filter(a=>a!==s)}}),unsubscribe:()=>{n=[]}}};function M3(n,e){const t={};for(const r in n)if(n.hasOwnProperty(r)){const s=n[r],a=e[r];if(s&&br(s)&&a){const o=M3(s,a);br(o)&&(t[r]=o)}else n[r]&&(t[r]=a)}return t}var os=n=>br(n)&&!Object.keys(n).length,R1=n=>n.type==="file",ka=n=>typeof n=="function",Rx=n=>{if(!I1)return!1;const e=n?n.ownerDocument:0;return n instanceof(e&&e.defaultView?e.defaultView.HTMLElement:HTMLElement)},E3=n=>n.type==="select-multiple",L1=n=>n.type==="radio",SQ=n=>L1(n)||Im(n),gb=n=>Rx(n)&&n.isConnected;function CQ(n,e){const t=e.slice(0,-1).length;let r=0;for(;r<t;)n=Fn(n)?r++:n[e[r++]];return n}function TQ(n){for(const e in n)if(n.hasOwnProperty(e)&&!Fn(n[e]))return!1;return!0}function ar(n,e){const t=Array.isArray(e)?e:dy(e)?[e]:A1(e),r=t.length===1?n:CQ(n,t),s=t.length-1,a=t[s];return r&&delete r[a],s!==0&&(br(r)&&os(r)||Array.isArray(r)&&TQ(r))&&ar(n,t.slice(0,-1)),n}var kQ=n=>{for(const e in n)if(ka(n[e]))return!0;return!1};function D3(n){return Array.isArray(n)||br(n)&&!kQ(n)}function FS(n,e={}){for(const t in n)D3(n[t])?(e[t]=Array.isArray(n[t])?[]:{},FS(n[t],e[t])):Fn(n[t])||(e[t]=!0);return e}function lf(n,e,t){t||(t=FS(e));for(const r in n)D3(n[r])?Fn(e)||LS(t[r])?t[r]=FS(n[r],Array.isArray(n[r])?[]:{}):lf(n[r],Ws(e)?{}:e[r],t[r]):t[r]=!Ta(n[r],e[r]);return t}const ZM={value:!1,isValid:!1},KM={value:!0,isValid:!0};var O3=n=>{if(Array.isArray(n)){if(n.length>1){const e=n.filter(t=>t&&t.checked&&!t.disabled).map(t=>t.value);return{value:e,isValid:!!e.length}}return n[0].checked&&!n[0].disabled?n[0].attributes&&!Fn(n[0].attributes.value)?Fn(n[0].value)||n[0].value===""?KM:{value:n[0].value,isValid:!0}:KM:ZM}return ZM},I3=(n,{valueAsNumber:e,valueAsDate:t,setValueAs:r})=>Fn(n)?n:e?n===""?NaN:n&&+n:t&&gi(n)?new Date(n):r?r(n):n;const JM={isValid:!1,value:null};var A3=n=>Array.isArray(n)?n.reduce((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e,JM):JM;function QM(n){const e=n.ref;return R1(e)?e.files:L1(e)?A3(n.refs).value:E3(e)?[...e.selectedOptions].map(({value:t})=>t):Im(e)?O3(n.refs).value:I3(Fn(e.value)?n.ref.value:e.value,n)}var PQ=(n,e,t,r)=>{const s={};for(const a of n){const o=nt(e,a);o&&mn(s,a,o._f)}return{criteriaMode:t,names:[...n],fields:s,shouldUseNativeValidation:r}},Lx=n=>n instanceof RegExp,Nh=n=>Fn(n)?n:Lx(n)?n.source:br(n)?Lx(n.value)?n.value.source:n.value:n,uf=n=>({isOnSubmit:!n||n===Yi.onSubmit,isOnBlur:n===Yi.onBlur,isOnChange:n===Yi.onChange,isOnAll:n===Yi.all,isOnTouch:n===Yi.onTouched});const XM="AsyncFunction";var MQ=n=>!!n&&!!n.validate&&!!(ka(n.validate)&&n.validate.constructor.name===XM||br(n.validate)&&Object.values(n.validate).find(e=>e.constructor.name===XM)),EQ=n=>n.mount&&(n.required||n.min||n.max||n.maxLength||n.minLength||n.pattern||n.validate),qS=(n,e,t)=>!t&&(e.watchAll||e.watch.has(n)||[...e.watch].some(r=>n.startsWith(r)&&/^\.\w+/.test(n.slice(r.length))));const yf=(n,e,t,r)=>{for(const s of t||Object.keys(n)){const a=nt(n,s);if(a){const{_f:o,...l}=a;if(o){if(o.refs&&o.refs[0]&&e(o.refs[0],s)&&!r)return!0;if(o.ref&&e(o.ref,o.name)&&!r)return!0;if(yf(l,e))break}else if(br(l)&&yf(l,e))break}}};function eE(n,e,t){const r=nt(n,t);if(r||dy(t))return{error:r,name:t};const s=t.split(".");for(;s.length;){const a=s.join("."),o=nt(e,a),l=nt(n,a);if(o&&!Array.isArray(o)&&t!==a)return{name:t};if(l&&l.type)return{name:a,error:l};if(l&&l.root&&l.root.type)return{name:`${a}.root`,error:l.root};s.pop()}return{name:t}}var DQ=(n,e,t,r)=>{t(n);const{name:s,...a}=n;return os(a)||Object.keys(a).length>=Object.keys(e).length||Object.keys(a).find(o=>e[o]===(!r||Yi.all))},OQ=(n,e,t)=>!n||!e||n===e||Ys(n).some(r=>r&&(t?r===e:r.startsWith(e)||e.startsWith(r))),IQ=(n,e,t,r,s)=>s.isOnAll?!1:!t&&s.isOnTouch?!(e||n):(t?r.isOnBlur:s.isOnBlur)?!n:(t?r.isOnChange:s.isOnChange)?n:!0,AQ=(n,e)=>!uy(nt(n,e)).length&&ar(n,e),R3=(n,e,t)=>{const r=Ys(nt(n,t));return mn(r,"root",e[t]),mn(n,t,r),n};function tE(n,e,t="validate"){if(gi(n)||Array.isArray(n)&&n.every(gi)||fi(n)&&!n)return{type:t,message:gi(n)?n:"",ref:e}}var Xu=n=>br(n)&&!Lx(n)?n:{value:n,message:""},zS=async(n,e,t,r,s,a)=>{const{ref:o,refs:l,required:c,maxLength:d,minLength:h,min:p,max:x,pattern:y,validate:_,name:w,valueAsNumber:j,mount:C}=n._f,P=nt(t,w);if(!C||e.has(w))return{};const O=l?l[0]:o,M=G=>{s&&O.reportValidity&&(O.setCustomValidity(fi(G)?"":G||""),O.reportValidity())},D={},I=L1(o),F=Im(o),q=I||F,B=(j||R1(o))&&Fn(o.value)&&Fn(P)||Rx(o)&&o.value===""||P===""||Array.isArray(P)&&!P.length,U=P3.bind(null,w,r,D),W=(G,Z,Y,ae=ul.maxLength,ee=ul.minLength)=>{const me=G?Z:Y;D[w]={type:G?ae:ee,message:me,ref:o,...U(G?ae:ee,me)}};if(a?!Array.isArray(P)||!P.length:c&&(!q&&(B||Ws(P))||fi(P)&&!P||F&&!O3(l).isValid||I&&!A3(l).isValid)){const{value:G,message:Z}=gi(c)?{value:!!c,message:c}:Xu(c);if(G&&(D[w]={type:ul.required,message:Z,ref:O,...U(ul.required,Z)},!r))return M(Z),D}if(!B&&(!Ws(p)||!Ws(x))){let G,Z;const Y=Xu(x),ae=Xu(p);if(!Ws(P)&&!isNaN(P)){const ee=o.valueAsNumber||P&&+P;Ws(Y.value)||(G=ee>Y.value),Ws(ae.value)||(Z=ee<ae.value)}else{const ee=o.valueAsDate||new Date(P),me=re=>new Date(new Date().toDateString()+" "+re),$=o.type=="time",K=o.type=="week";gi(Y.value)&&P&&(G=$?me(P)>me(Y.value):K?P>Y.value:ee>new Date(Y.value)),gi(ae.value)&&P&&(Z=$?me(P)<me(ae.value):K?P<ae.value:ee<new Date(ae.value))}if((G||Z)&&(W(!!G,Y.message,ae.message,ul.max,ul.min),!r))return M(D[w].message),D}if((d||h)&&!B&&(gi(P)||a&&Array.isArray(P))){const G=Xu(d),Z=Xu(h),Y=!Ws(G.value)&&P.length>+G.value,ae=!Ws(Z.value)&&P.length<+Z.value;if((Y||ae)&&(W(Y,G.message,Z.message),!r))return M(D[w].message),D}if(y&&!B&&gi(P)){const{value:G,message:Z}=Xu(y);if(Lx(G)&&!P.match(G)&&(D[w]={type:ul.pattern,message:Z,ref:o,...U(ul.pattern,Z)},!r))return M(Z),D}if(_){if(ka(_)){const G=await _(P,t),Z=tE(G,O);if(Z&&(D[w]={...Z,...U(ul.validate,Z.message)},!r))return M(Z.message),D}else if(br(_)){let G={};for(const Z in _){if(!os(G)&&!r)break;const Y=tE(await _[Z](P,t),O,Z);Y&&(G={...Y,...U(Z,Y.message)},M(Y.message),r&&(D[w]=G))}if(!os(G)&&(D[w]={ref:O,...G},!r))return D}}return M(!0),D};const RQ={mode:Yi.onSubmit,reValidateMode:Yi.onChange,shouldFocusError:!0};function LQ(n={}){let e={...RQ,...n},t={submitCount:0,isDirty:!1,isReady:!1,isLoading:ka(e.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1},r={},s=br(e.defaultValues)||br(e.values)?Un(e.defaultValues||e.values)||{}:{},a=e.shouldUnregister?{}:Un(s),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c,d=0;const h={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let p={...h};const x={array:GM(),state:GM()},y=e.criteriaMode===Yi.all,_=X=>le=>{clearTimeout(d),d=setTimeout(X,le)},w=async X=>{if(!e.disabled&&(h.isValid||p.isValid||X)){const le=e.resolver?os((await F()).errors):await B(r,!0);le!==t.isValid&&x.state.next({isValid:le})}},j=(X,le)=>{!e.disabled&&(h.isValidating||h.validatingFields||p.isValidating||p.validatingFields)&&((X||Array.from(l.mount)).forEach(he=>{he&&(le?mn(t.validatingFields,he,le):ar(t.validatingFields,he))}),x.state.next({validatingFields:t.validatingFields,isValidating:!os(t.validatingFields)}))},C=(X,le=[],he,Le,Ie=!0,ze=!0)=>{if(Le&&he&&!e.disabled){if(o.action=!0,ze&&Array.isArray(nt(r,X))){const et=he(nt(r,X),Le.argA,Le.argB);Ie&&mn(r,X,et)}if(ze&&Array.isArray(nt(t.errors,X))){const et=he(nt(t.errors,X),Le.argA,Le.argB);Ie&&mn(t.errors,X,et),AQ(t.errors,X)}if((h.touchedFields||p.touchedFields)&&ze&&Array.isArray(nt(t.touchedFields,X))){const et=he(nt(t.touchedFields,X),Le.argA,Le.argB);Ie&&mn(t.touchedFields,X,et)}(h.dirtyFields||p.dirtyFields)&&(t.dirtyFields=lf(s,a)),x.state.next({name:X,isDirty:W(X,le),dirtyFields:t.dirtyFields,errors:t.errors,isValid:t.isValid})}else mn(a,X,le)},P=(X,le)=>{mn(t.errors,X,le),x.state.next({errors:t.errors})},O=X=>{t.errors=X,x.state.next({errors:t.errors,isValid:!1})},M=(X,le,he,Le)=>{const Ie=nt(r,X);if(Ie){const ze=nt(a,X,Fn(he)?nt(s,X):he);Fn(ze)||Le&&Le.defaultChecked||le?mn(a,X,le?ze:QM(Ie._f)):Y(X,ze),o.mount&&w()}},D=(X,le,he,Le,Ie)=>{let ze=!1,et=!1;const tt={name:X};if(!e.disabled){if(!he||Le){(h.isDirty||p.isDirty)&&(et=t.isDirty,t.isDirty=tt.isDirty=W(),ze=et!==tt.isDirty);const ct=Ta(nt(s,X),le);et=!!nt(t.dirtyFields,X),ct?ar(t.dirtyFields,X):mn(t.dirtyFields,X,!0),tt.dirtyFields=t.dirtyFields,ze=ze||(h.dirtyFields||p.dirtyFields)&&et!==!ct}if(he){const ct=nt(t.touchedFields,X);ct||(mn(t.touchedFields,X,he),tt.touchedFields=t.touchedFields,ze=ze||(h.touchedFields||p.touchedFields)&&ct!==he)}ze&&Ie&&x.state.next(tt)}return ze?tt:{}},I=(X,le,he,Le)=>{const Ie=nt(t.errors,X),ze=(h.isValid||p.isValid)&&fi(le)&&t.isValid!==le;if(e.delayError&&he?(c=_(()=>P(X,he)),c(e.delayError)):(clearTimeout(d),c=null,he?mn(t.errors,X,he):ar(t.errors,X)),(he?!Ta(Ie,he):Ie)||!os(Le)||ze){const et={...Le,...ze&&fi(le)?{isValid:le}:{},errors:t.errors,name:X};t={...t,...et},x.state.next(et)}},F=async X=>{j(X,!0);const le=await e.resolver(a,e.context,PQ(X||l.mount,r,e.criteriaMode,e.shouldUseNativeValidation));return j(X),le},q=async X=>{const{errors:le}=await F(X);if(X)for(const he of X){const Le=nt(le,he);Le?mn(t.errors,he,Le):ar(t.errors,he)}else t.errors=le;return le},B=async(X,le,he={valid:!0})=>{for(const Le in X){const Ie=X[Le];if(Ie){const{_f:ze,...et}=Ie;if(ze){const tt=l.array.has(ze.name),ct=Ie._f&&MQ(Ie._f);ct&&h.validatingFields&&j([ze.name],!0);const ht=await zS(Ie,l.disabled,a,y,e.shouldUseNativeValidation&&!le,tt);if(ct&&h.validatingFields&&j([ze.name]),ht[ze.name]&&(he.valid=!1,le))break;!le&&(nt(ht,ze.name)?tt?R3(t.errors,ht,ze.name):mn(t.errors,ze.name,ht[ze.name]):ar(t.errors,ze.name))}!os(et)&&await B(et,le,he)}}return he.valid},U=()=>{for(const X of l.unMount){const le=nt(r,X);le&&(le._f.refs?le._f.refs.every(he=>!gb(he)):!gb(le._f.ref))&&te(X)}l.unMount=new Set},W=(X,le)=>!e.disabled&&(X&&le&&mn(a,X,le),!Ta(re(),s)),G=(X,le,he)=>RS(X,l,{...o.mount?a:Fn(le)?s:gi(X)?{[X]:le}:le},he,le),Z=X=>uy(nt(o.mount?a:s,X,e.shouldUnregister?nt(s,X,[]):[])),Y=(X,le,he={})=>{const Le=nt(r,X);let Ie=le;if(Le){const ze=Le._f;ze&&(!ze.disabled&&mn(a,X,I3(le,ze)),Ie=Rx(ze.ref)&&Ws(le)?"":le,E3(ze.ref)?[...ze.ref.options].forEach(et=>et.selected=Ie.includes(et.value)):ze.refs?Im(ze.ref)?ze.refs.forEach(et=>{(!et.defaultChecked||!et.disabled)&&(Array.isArray(Ie)?et.checked=!!Ie.find(tt=>tt===et.value):et.checked=Ie===et.value||!!Ie)}):ze.refs.forEach(et=>et.checked=et.value===Ie):R1(ze.ref)?ze.ref.value="":(ze.ref.value=Ie,ze.ref.type||x.state.next({name:X,values:Un(a)})))}(he.shouldDirty||he.shouldTouch)&&D(X,Ie,he.shouldTouch,he.shouldDirty,!0),he.shouldValidate&&K(X)},ae=(X,le,he)=>{for(const Le in le){if(!le.hasOwnProperty(Le))return;const Ie=le[Le],ze=X+"."+Le,et=nt(r,ze);(l.array.has(X)||br(Ie)||et&&!et._f)&&!ou(Ie)?ae(ze,Ie,he):Y(ze,Ie,he)}},ee=(X,le,he={})=>{const Le=nt(r,X),Ie=l.array.has(X),ze=Un(le);mn(a,X,ze),Ie?(x.array.next({name:X,values:Un(a)}),(h.isDirty||h.dirtyFields||p.isDirty||p.dirtyFields)&&he.shouldDirty&&x.state.next({name:X,dirtyFields:lf(s,a),isDirty:W(X,ze)})):Le&&!Le._f&&!Ws(ze)?ae(X,ze,he):Y(X,ze,he),qS(X,l)&&x.state.next({...t,name:X}),x.state.next({name:o.mount?X:void 0,values:Un(a)})},me=async X=>{o.mount=!0;const le=X.target;let he=le.name,Le=!0;const Ie=nt(r,he),ze=ct=>{Le=Number.isNaN(ct)||ou(ct)&&isNaN(ct.getTime())||Ta(ct,nt(a,he,ct))},et=uf(e.mode),tt=uf(e.reValidateMode);if(Ie){let ct,ht;const Et=le.type?QM(Ie._f):S3(X),Mt=X.type===Ax.BLUR||X.type===Ax.FOCUS_OUT,en=!EQ(Ie._f)&&!e.resolver&&!nt(t.errors,he)&&!Ie._f.deps||IQ(Mt,nt(t.touchedFields,he),t.isSubmitted,tt,et),Jt=qS(he,l,Mt);mn(a,he,Et),Mt?(!le||!le.readOnly)&&(Ie._f.onBlur&&Ie._f.onBlur(X),c&&c(0)):Ie._f.onChange&&Ie._f.onChange(X);const Zt=D(he,Et,Mt),on=!os(Zt)||Jt;if(!Mt&&x.state.next({name:he,type:X.type,values:Un(a)}),en)return(h.isValid||p.isValid)&&(e.mode==="onBlur"?Mt&&w():Mt||w()),on&&x.state.next({name:he,...Jt?{}:Zt});if(!Mt&&Jt&&x.state.next({...t}),e.resolver){const{errors:zt}=await F([he]);if(ze(Et),Le){const Sn=eE(t.errors,r,he),qn=eE(zt,r,Sn.name||he);ct=qn.error,he=qn.name,ht=os(zt)}}else j([he],!0),ct=(await zS(Ie,l.disabled,a,y,e.shouldUseNativeValidation))[he],j([he]),ze(Et),Le&&(ct?ht=!1:(h.isValid||p.isValid)&&(ht=await B(r,!0)));Le&&(Ie._f.deps&&(!Array.isArray(Ie._f.deps)||Ie._f.deps.length>0)&&K(Ie._f.deps),I(he,ht,ct,Zt))}},$=(X,le)=>{if(nt(t.errors,le)&&X.focus)return X.focus(),1},K=async(X,le={})=>{let he,Le;const Ie=Ys(X);if(e.resolver){const ze=await q(Fn(X)?X:Ie);he=os(ze),Le=X?!Ie.some(et=>nt(ze,et)):he}else X?(Le=(await Promise.all(Ie.map(async ze=>{const et=nt(r,ze);return await B(et&&et._f?{[ze]:et}:et)}))).every(Boolean),!(!Le&&!t.isValid)&&w()):Le=he=await B(r);return x.state.next({...!gi(X)||(h.isValid||p.isValid)&&he!==t.isValid?{}:{name:X},...e.resolver||!X?{isValid:he}:{},errors:t.errors}),le.shouldFocus&&!Le&&yf(r,$,X?Ie:l.mount),Le},re=(X,le)=>{let he={...o.mount?a:s};return le&&(he=M3(le.dirtyFields?t.dirtyFields:t.touchedFields,he)),Fn(X)?he:gi(X)?nt(he,X):X.map(Le=>nt(he,Le))},H=(X,le)=>({invalid:!!nt((le||t).errors,X),isDirty:!!nt((le||t).dirtyFields,X),error:nt((le||t).errors,X),isValidating:!!nt(t.validatingFields,X),isTouched:!!nt((le||t).touchedFields,X)}),se=X=>{X&&Ys(X).forEach(le=>ar(t.errors,le)),x.state.next({errors:X?t.errors:{}})},ie=(X,le,he)=>{const Le=(nt(r,X,{_f:{}})._f||{}).ref,Ie=nt(t.errors,X)||{},{ref:ze,message:et,type:tt,...ct}=Ie;mn(t.errors,X,{...ct,...le,ref:Le}),x.state.next({name:X,errors:t.errors,isValid:!1}),he&&he.shouldFocus&&Le&&Le.focus&&Le.focus()},ce=(X,le)=>ka(X)?x.state.subscribe({next:he=>"values"in he&&X(G(void 0,le),he)}):G(X,le,!0),oe=X=>x.state.subscribe({next:le=>{OQ(X.name,le.name,X.exact)&&DQ(le,X.formState||h,Oe,X.reRenderRoot)&&X.callback({values:{...a},...t,...le,defaultValues:s})}}).unsubscribe,de=X=>(o.mount=!0,p={...p,...X.formState},oe({...X,formState:p})),te=(X,le={})=>{for(const he of X?Ys(X):l.mount)l.mount.delete(he),l.array.delete(he),le.keepValue||(ar(r,he),ar(a,he)),!le.keepError&&ar(t.errors,he),!le.keepDirty&&ar(t.dirtyFields,he),!le.keepTouched&&ar(t.touchedFields,he),!le.keepIsValidating&&ar(t.validatingFields,he),!e.shouldUnregister&&!le.keepDefaultValue&&ar(s,he);x.state.next({values:Un(a)}),x.state.next({...t,...le.keepDirty?{isDirty:W()}:{}}),!le.keepIsValid&&w()},ye=({disabled:X,name:le})=>{(fi(X)&&o.mount||X||l.disabled.has(le))&&(X?l.disabled.add(le):l.disabled.delete(le))},Ce=(X,le={})=>{let he=nt(r,X);const Le=fi(le.disabled)||fi(e.disabled);return mn(r,X,{...he||{},_f:{...he&&he._f?he._f:{ref:{name:X}},name:X,mount:!0,...le}}),l.mount.add(X),he?ye({disabled:fi(le.disabled)?le.disabled:e.disabled,name:X}):M(X,!0,le.value),{...Le?{disabled:le.disabled||e.disabled}:{},...e.progressive?{required:!!le.required,min:Nh(le.min),max:Nh(le.max),minLength:Nh(le.minLength),maxLength:Nh(le.maxLength),pattern:Nh(le.pattern)}:{},name:X,onChange:me,onBlur:me,ref:Ie=>{if(Ie){Ce(X,le),he=nt(r,X);const ze=Fn(Ie.value)&&Ie.querySelectorAll&&Ie.querySelectorAll("input,select,textarea")[0]||Ie,et=SQ(ze),tt=he._f.refs||[];if(et?tt.find(ct=>ct===ze):ze===he._f.ref)return;mn(r,X,{_f:{...he._f,...et?{refs:[...tt.filter(gb),ze,...Array.isArray(nt(s,X))?[{}]:[]],ref:{type:ze.type,name:X}}:{ref:ze}}}),M(X,!1,void 0,ze)}else he=nt(r,X,{}),he._f&&(he._f.mount=!1),(e.shouldUnregister||le.shouldUnregister)&&!(C3(l.array,X)&&o.action)&&l.unMount.add(X)}}},Re=()=>e.shouldFocusError&&yf(r,$,l.mount),Te=X=>{fi(X)&&(x.state.next({disabled:X}),yf(r,(le,he)=>{const Le=nt(r,he);Le&&(le.disabled=Le._f.disabled||X,Array.isArray(Le._f.refs)&&Le._f.refs.forEach(Ie=>{Ie.disabled=Le._f.disabled||X}))},0,!1))},je=(X,le)=>async he=>{let Le;he&&(he.preventDefault&&he.preventDefault(),he.persist&&he.persist());let Ie=Un(a);if(x.state.next({isSubmitting:!0}),e.resolver){const{errors:ze,values:et}=await F();t.errors=ze,Ie=Un(et)}else await B(r);if(l.disabled.size)for(const ze of l.disabled)ar(Ie,ze);if(ar(t.errors,"root"),os(t.errors)){x.state.next({errors:{}});try{await X(Ie,he)}catch(ze){Le=ze}}else le&&await le({...t.errors},he),Re(),setTimeout(Re);if(x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:os(t.errors)&&!Le,submitCount:t.submitCount+1,errors:t.errors}),Le)throw Le},ke=(X,le={})=>{nt(r,X)&&(Fn(le.defaultValue)?ee(X,Un(nt(s,X))):(ee(X,le.defaultValue),mn(s,X,Un(le.defaultValue))),le.keepTouched||ar(t.touchedFields,X),le.keepDirty||(ar(t.dirtyFields,X),t.isDirty=le.defaultValue?W(X,Un(nt(s,X))):W()),le.keepError||(ar(t.errors,X),h.isValid&&w()),x.state.next({...t}))},Ue=(X,le={})=>{const he=X?Un(X):s,Le=Un(he),Ie=os(X),ze=Ie?s:Le;if(le.keepDefaultValues||(s=he),!le.keepValues){if(le.keepDirtyValues){const et=new Set([...l.mount,...Object.keys(lf(s,a))]);for(const tt of Array.from(et))nt(t.dirtyFields,tt)?mn(ze,tt,nt(a,tt)):ee(tt,nt(ze,tt))}else{if(I1&&Fn(X))for(const et of l.mount){const tt=nt(r,et);if(tt&&tt._f){const ct=Array.isArray(tt._f.refs)?tt._f.refs[0]:tt._f.ref;if(Rx(ct)){const ht=ct.closest("form");if(ht){ht.reset();break}}}}if(le.keepFieldsRef)for(const et of l.mount)ee(et,nt(ze,et));else r={}}a=e.shouldUnregister?le.keepDefaultValues?Un(s):{}:Un(ze),x.array.next({values:{...ze}}),x.state.next({values:{...ze}})}l={mount:le.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!h.isValid||!!le.keepIsValid||!!le.keepDirtyValues||!e.shouldUnregister&&!os(ze),o.watch=!!e.shouldUnregister,x.state.next({submitCount:le.keepSubmitCount?t.submitCount:0,isDirty:Ie?!1:le.keepDirty?t.isDirty:!!(le.keepDefaultValues&&!Ta(X,s)),isSubmitted:le.keepIsSubmitted?t.isSubmitted:!1,dirtyFields:Ie?{}:le.keepDirtyValues?le.keepDefaultValues&&a?lf(s,a):t.dirtyFields:le.keepDefaultValues&&X?lf(s,X):le.keepDirty?t.dirtyFields:{},touchedFields:le.keepTouched?t.touchedFields:{},errors:le.keepErrors?t.errors:{},isSubmitSuccessful:le.keepIsSubmitSuccessful?t.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:s})},Ye=(X,le)=>Ue(ka(X)?X(a):X,le),ve=(X,le={})=>{const he=nt(r,X),Le=he&&he._f;if(Le){const Ie=Le.refs?Le.refs[0]:Le.ref;Ie.focus&&(Ie.focus(),le.shouldSelect&&ka(Ie.select)&&Ie.select())}},Oe=X=>{t={...t,...X}},qe={control:{register:Ce,unregister:te,getFieldState:H,handleSubmit:je,setError:ie,_subscribe:oe,_runSchema:F,_focusError:Re,_getWatch:G,_getDirty:W,_setValid:w,_setFieldArray:C,_setDisabledField:ye,_setErrors:O,_getFieldArray:Z,_reset:Ue,_resetDefaultValues:()=>ka(e.defaultValues)&&e.defaultValues().then(X=>{Ye(X,e.resetOptions),x.state.next({isLoading:!1})}),_removeUnmounted:U,_disableForm:Te,_subjects:x,_proxyFormState:h,get _fields(){return r},get _formValues(){return a},get _state(){return o},set _state(X){o=X},get _defaultValues(){return s},get _names(){return l},set _names(X){l=X},get _formState(){return t},get _options(){return e},set _options(X){e={...e,...X}}},subscribe:de,trigger:K,register:Ce,handleSubmit:je,watch:ce,setValue:ee,getValues:re,reset:Ye,resetField:ke,clearErrors:se,unregister:te,setError:ie,setFocus:ve,getFieldState:H};return{...qe,formControl:qe}}var Cc=()=>{if(typeof crypto<"u"&&crypto.randomUUID)return crypto.randomUUID();const n=typeof performance>"u"?Date.now():performance.now()*1e3;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,e=>{const t=(Math.random()*16+n)%16|0;return(e=="x"?t:t&3|8).toString(16)})},xb=(n,e,t={})=>t.shouldFocus||Fn(t.shouldFocus)?t.focusName||`${n}.${Fn(t.focusIndex)?e:t.focusIndex}.`:"",yb=(n,e)=>[...n,...Ys(e)],vb=n=>Array.isArray(n)?n.map(()=>{}):void 0;function bb(n,e,t){return[...n.slice(0,e),...Ys(t),...n.slice(e)]}var wb=(n,e,t)=>Array.isArray(n)?(Fn(n[t])&&(n[t]=void 0),n.splice(t,0,n.splice(e,1)[0]),n):[],_b=(n,e)=>[...Ys(e),...Ys(n)];function FQ(n,e){let t=0;const r=[...n];for(const s of e)r.splice(s-t,1),t++;return uy(r).length?r:[]}var jb=(n,e)=>Fn(e)?[]:FQ(n,Ys(e).sort((t,r)=>t-r)),Nb=(n,e,t)=>{[n[e],n[t]]=[n[t],n[e]]},nE=(n,e,t)=>(n[e]=t,n);function Ns(n){const e=fy(),{control:t=e.control,name:r,keyName:s="id",shouldUnregister:a,rules:o}=n,[l,c]=ot.useState(t._getFieldArray(r)),d=ot.useRef(t._getFieldArray(r).map(Cc)),h=ot.useRef(!1);t._names.array.add(r),ot.useMemo(()=>o&&l.length>=0&&t.register(r,o),[t,r,l.length,o]),hy(()=>t._subjects.array.subscribe({next:({values:M,name:D})=>{if(D===r||!D){const I=nt(M,r);Array.isArray(I)&&(c(I),d.current=I.map(Cc))}}}).unsubscribe,[t,r]);const p=ot.useCallback(M=>{h.current=!0,t._setFieldArray(r,M)},[t,r]),x=(M,D)=>{const I=Ys(Un(M)),F=yb(t._getFieldArray(r),I);t._names.focus=xb(r,F.length-1,D),d.current=yb(d.current,I.map(Cc)),p(F),c(F),t._setFieldArray(r,F,yb,{argA:vb(M)})},y=(M,D)=>{const I=Ys(Un(M)),F=_b(t._getFieldArray(r),I);t._names.focus=xb(r,0,D),d.current=_b(d.current,I.map(Cc)),p(F),c(F),t._setFieldArray(r,F,_b,{argA:vb(M)})},_=M=>{const D=jb(t._getFieldArray(r),M);d.current=jb(d.current,M),p(D),c(D),!Array.isArray(nt(t._fields,r))&&mn(t._fields,r,void 0),t._setFieldArray(r,D,jb,{argA:M})},w=(M,D,I)=>{const F=Ys(Un(D)),q=bb(t._getFieldArray(r),M,F);t._names.focus=xb(r,M,I),d.current=bb(d.current,M,F.map(Cc)),p(q),c(q),t._setFieldArray(r,q,bb,{argA:M,argB:vb(D)})},j=(M,D)=>{const I=t._getFieldArray(r);Nb(I,M,D),Nb(d.current,M,D),p(I),c(I),t._setFieldArray(r,I,Nb,{argA:M,argB:D},!1)},C=(M,D)=>{const I=t._getFieldArray(r);wb(I,M,D),wb(d.current,M,D),p(I),c(I),t._setFieldArray(r,I,wb,{argA:M,argB:D},!1)},P=(M,D)=>{const I=Un(D),F=nE(t._getFieldArray(r),M,I);d.current=[...F].map((q,B)=>!q||B===M?Cc():d.current[B]),p(F),c([...F]),t._setFieldArray(r,F,nE,{argA:M,argB:I},!0,!1)},O=M=>{const D=Ys(Un(M));d.current=D.map(Cc),p([...D]),c([...D]),t._setFieldArray(r,[...D],I=>I,{},!0,!1)};return ot.useEffect(()=>{if(t._state.action=!1,qS(r,t._names)&&t._subjects.state.next({...t._formState}),h.current&&(!uf(t._options.mode).isOnSubmit||t._formState.isSubmitted)&&!uf(t._options.reValidateMode).isOnSubmit)if(t._options.resolver)t._runSchema([r]).then(M=>{const D=nt(M.errors,r),I=nt(t._formState.errors,r);(I?!D&&I.type||D&&(I.type!==D.type||I.message!==D.message):D&&D.type)&&(D?mn(t._formState.errors,r,D):ar(t._formState.errors,r),t._subjects.state.next({errors:t._formState.errors}))});else{const M=nt(t._fields,r);M&&M._f&&!(uf(t._options.reValidateMode).isOnSubmit&&uf(t._options.mode).isOnSubmit)&&zS(M,t._names.disabled,t._formValues,t._options.criteriaMode===Yi.all,t._options.shouldUseNativeValidation,!0).then(D=>!os(D)&&t._subjects.state.next({errors:R3(t._formState.errors,D,r)}))}t._subjects.state.next({name:r,values:Un(t._formValues)}),t._names.focus&&yf(t._fields,(M,D)=>{if(t._names.focus&&D.startsWith(t._names.focus)&&M.focus)return M.focus(),1}),t._names.focus="",t._setValid(),h.current=!1},[l,r,t]),ot.useEffect(()=>(!nt(t._formValues,r)&&t._setFieldArray(r),()=>{const M=(D,I)=>{const F=nt(t._fields,D);F&&F._f&&(F._f.mount=I)};t._options.shouldUnregister||a?t.unregister(r):M(r,!1)}),[r,t,s,a]),{swap:ot.useCallback(j,[p,r,t]),move:ot.useCallback(C,[p,r,t]),prepend:ot.useCallback(y,[p,r,t]),append:ot.useCallback(x,[p,r,t]),remove:ot.useCallback(_,[p,r,t]),insert:ot.useCallback(w,[p,r,t]),update:ot.useCallback(P,[p,r,t]),replace:ot.useCallback(O,[p,r,t]),fields:ot.useMemo(()=>l.map((M,D)=>({...M,[s]:d.current[D]||Cc()})),[l,s])}}function tn(n={}){const e=ot.useRef(void 0),t=ot.useRef(void 0),[r,s]=ot.useState({isDirty:!1,isValidating:!1,isLoading:ka(n.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:n.errors||{},disabled:n.disabled||!1,isReady:!1,defaultValues:ka(n.defaultValues)?void 0:n.defaultValues});if(!e.current)if(n.formControl)e.current={...n.formControl,formState:r},n.defaultValues&&!ka(n.defaultValues)&&n.formControl.reset(n.defaultValues,n.resetOptions);else{const{formControl:o,...l}=LQ(n);e.current={...l,formState:r}}const a=e.current.control;return a._options=n,hy(()=>{const o=a._subscribe({formState:a._proxyFormState,callback:()=>s({...a._formState}),reRenderRoot:!0});return s(l=>({...l,isReady:!0})),a._formState.isReady=!0,o},[a]),ot.useEffect(()=>a._disableForm(n.disabled),[a,n.disabled]),ot.useEffect(()=>{n.mode&&(a._options.mode=n.mode),n.reValidateMode&&(a._options.reValidateMode=n.reValidateMode)},[a,n.mode,n.reValidateMode]),ot.useEffect(()=>{n.errors&&(a._setErrors(n.errors),a._focusError())},[a,n.errors]),ot.useEffect(()=>{n.shouldUnregister&&a._subjects.state.next({values:a._getWatch()})},[a,n.shouldUnregister]),ot.useEffect(()=>{if(a._proxyFormState.isDirty){const o=a._getDirty();o!==r.isDirty&&a._subjects.state.next({isDirty:o})}},[a,r.isDirty]),ot.useEffect(()=>{n.values&&!Ta(n.values,t.current)?(a._reset(n.values,{keepFieldsRef:!0,...a._options.resetOptions}),t.current=n.values,s(o=>({...o}))):a._resetDefaultValues()},[a,n.values]),ot.useEffect(()=>{a._state.mount||(a._setValid(),a._state.mount=!0),a._state.watch&&(a._state.watch=!1,a._subjects.state.next({...a._formState})),a._removeUnmounted()}),e.current.formState=k3(r,a),e.current}const rE=(n,e,t)=>{if(n&&"reportValidity"in n){const r=nt(t,e);n.setCustomValidity(r&&r.message||""),n.reportValidity()}},L3=(n,e)=>{for(const t in e.fields){const r=e.fields[t];r&&r.ref&&"reportValidity"in r.ref?rE(r.ref,t,n):r.refs&&r.refs.forEach(s=>rE(s,t,n))}},qQ=(n,e)=>{e.shouldUseNativeValidation&&L3(n,e);const t={};for(const r in n){const s=nt(e.fields,r),a=Object.assign(n[r]||{},{ref:s&&s.ref});if(zQ(e.names||Object.keys(n),r)){const o=Object.assign({},nt(t,r));mn(o,"root",a),mn(t,r,o)}else mn(t,r,a)}return t},zQ=(n,e)=>n.some(t=>t.startsWith(e+"."));function In(n,e,t){return e===void 0&&(e={}),t===void 0&&(t={}),function(r,s,a){try{return Promise.resolve((function(o,l){try{var c=(e.context,Promise.resolve(n[t.mode==="sync"?"validateSync":"validate"](r,Object.assign({abortEarly:!1},e,{context:s}))).then(function(d){return a.shouldUseNativeValidation&&L3({},a),{values:t.raw?r:d,errors:{}}}))}catch(d){return l(d)}return c&&c.then?c.then(void 0,l):c})(0,function(o){if(!o.inner)throw o;return{values:{},errors:qQ((l=o,c=!a.shouldUseNativeValidation&&a.criteriaMode==="all",(l.inner||[]).reduce(function(d,h){if(d[h.path]||(d[h.path]={message:h.message,type:h.type}),c){var p=d[h.path].types,x=p&&p[h.type];d[h.path]=P3(h.path,c,d,h.type,x?[].concat(x,h.message):h.message)}return d},{})),a)};var l,c}))}catch(o){return Promise.reject(o)}}}var Sb,sE;function UQ(){if(sE)return Sb;sE=1;function n(C){this._maxSize=C,this.clear()}n.prototype.clear=function(){this._size=0,this._values=Object.create(null)},n.prototype.get=function(C){return this._values[C]},n.prototype.set=function(C,P){return this._size>=this._maxSize&&this.clear(),C in this._values||this._size++,this._values[C]=P};var e=/[^.^\]^[]+|(?=\[\]|\.\.)/g,t=/^\d+$/,r=/^\d/,s=/[~`!#$%\^&*+=\-\[\]\\';,/{}|\\":<>\?]/g,a=/^\s*(['"]?)(.*?)(\1)\s*$/,o=512,l=new n(o),c=new n(o),d=new n(o);Sb={Cache:n,split:p,normalizePath:h,setter:function(C){var P=h(C);return c.get(C)||c.set(C,function(M,D){for(var I=0,F=P.length,q=M;I<F-1;){var B=P[I];if(B==="__proto__"||B==="constructor"||B==="prototype")return M;q=q[P[I++]]}q[P[I]]=D})},getter:function(C,P){var O=h(C);return d.get(C)||d.set(C,function(D){for(var I=0,F=O.length;I<F;)if(D!=null||!P)D=D[O[I++]];else return;return D})},join:function(C){return C.reduce(function(P,O){return P+(y(O)||t.test(O)?"["+O+"]":(P?".":"")+O)},"")},forEach:function(C,P,O){x(Array.isArray(C)?C:p(C),P,O)}};function h(C){return l.get(C)||l.set(C,p(C).map(function(P){return P.replace(a,"$2")}))}function p(C){return C.match(e)||[""]}function x(C,P,O){var M=C.length,D,I,F,q;for(I=0;I<M;I++)D=C[I],D&&(j(D)&&(D='"'+D+'"'),q=y(D),F=!q&&/^\d+$/.test(D),P.call(O,D,q,F,I,C))}function y(C){return typeof C=="string"&&C&&["'",'"'].indexOf(C.charAt(0))!==-1}function _(C){return C.match(r)&&!C.match(t)}function w(C){return s.test(C)}function j(C){return!y(C)&&(_(C)||w(C))}return Sb}var uu=UQ(),Cb,iE;function BQ(){if(iE)return Cb;iE=1;const n=/[A-Z\xc0-\xd6\xd8-\xde]?[a-z\xdf-\xf6\xf8-\xff]+(?:['](?:d|ll|m|re|s|t|ve))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde]|$)|(?:[A-Z\xc0-\xd6\xd8-\xde]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:D|LL|M|RE|S|T|VE))?(?=[\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000]|[A-Z\xc0-\xd6\xd8-\xde](?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])|$)|[A-Z\xc0-\xd6\xd8-\xde]?(?:[a-z\xdf-\xf6\xf8-\xff]|[^\ud800-\udfff\xac\xb1\xd7\xf7\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\xbf\u2000-\u206f \t\x0b\f\xa0\ufeff\n\r\u2028\u2029\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\d+\u2700-\u27bfa-z\xdf-\xf6\xf8-\xffA-Z\xc0-\xd6\xd8-\xde])+(?:['](?:d|ll|m|re|s|t|ve))?|[A-Z\xc0-\xd6\xd8-\xde]+(?:['](?:D|LL|M|RE|S|T|VE))?|\d*(?:1ST|2ND|3RD|(?![123])\dTH)(?=\b|[a-z_])|\d*(?:1st|2nd|3rd|(?![123])\dth)(?=\b|[A-Z_])|\d+|(?:[\u2700-\u27bf]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?(?:\u200d(?:[^\ud800-\udfff]|(?:\ud83c[\udde6-\uddff]){2}|[\ud800-\udbff][\udc00-\udfff])[\ufe0e\ufe0f]?(?:[\u0300-\u036f\ufe20-\ufe2f\u20d0-\u20ff]|\ud83c[\udffb-\udfff])?)*/g,e=h=>h.match(n)||[],t=h=>h[0].toUpperCase()+h.slice(1),r=(h,p)=>e(h).join(p).toLowerCase(),s=h=>e(h).reduce((p,x)=>`${p}${p?x[0].toUpperCase()+x.slice(1).toLowerCase():x.toLowerCase()}`,"");return Cb={words:e,upperFirst:t,camelCase:s,pascalCase:h=>t(s(h)),snakeCase:h=>r(h,"_"),kebabCase:h=>r(h,"-"),sentenceCase:h=>t(r(h," ")),titleCase:h=>e(h).map(t).join(" ")},Cb}var Tb=BQ(),$p={exports:{}},aE;function VQ(){if(aE)return $p.exports;aE=1,$p.exports=function(s){return n(e(s),s)},$p.exports.array=n;function n(s,a){var o=s.length,l=new Array(o),c={},d=o,h=t(a),p=r(s);for(a.forEach(function(y){if(!p.has(y[0])||!p.has(y[1]))throw new Error("Unknown node. There is an unknown node in the supplied edges.")});d--;)c[d]||x(s[d],d,new Set);return l;function x(y,_,w){if(w.has(y)){var j;try{j=", node was:"+JSON.stringify(y)}catch{j=""}throw new Error("Cyclic dependency"+j)}if(!p.has(y))throw new Error("Found unknown node. Make sure to provided all involved nodes. Unknown node: "+JSON.stringify(y));if(!c[_]){c[_]=!0;var C=h.get(y)||new Set;if(C=Array.from(C),_=C.length){w.add(y);do{var P=C[--_];x(P,p.get(P),w)}while(_);w.delete(y)}l[--o]=y}}}function e(s){for(var a=new Set,o=0,l=s.length;o<l;o++){var c=s[o];a.add(c[0]),a.add(c[1])}return Array.from(a)}function t(s){for(var a=new Map,o=0,l=s.length;o<l;o++){var c=s[o];a.has(c[0])||a.set(c[0],new Set),a.has(c[1])||a.set(c[1],new Set),a.get(c[0]).add(c[1])}return a}function r(s){for(var a=new Map,o=0,l=s.length;o<l;o++)a.set(s[o],o);return a}return $p.exports}var WQ=VQ();const $Q=bu(WQ),HQ=Object.prototype.toString,YQ=Error.prototype.toString,GQ=RegExp.prototype.toString,ZQ=typeof Symbol<"u"?Symbol.prototype.toString:()=>"",KQ=/^Symbol\((.*)\)(.*)$/;function JQ(n){return n!=+n?"NaN":n===0&&1/n<0?"-0":""+n}function oE(n,e=!1){if(n==null||n===!0||n===!1)return""+n;const t=typeof n;if(t==="number")return JQ(n);if(t==="string")return e?`"${n}"`:n;if(t==="function")return"[Function "+(n.name||"anonymous")+"]";if(t==="symbol")return ZQ.call(n).replace(KQ,"Symbol($1)");const r=HQ.call(n).slice(8,-1);return r==="Date"?isNaN(n.getTime())?""+n:n.toISOString(n):r==="Error"||n instanceof Error?"["+YQ.call(n)+"]":r==="RegExp"?GQ.call(n):null}function Nl(n,e){let t=oE(n,e);return t!==null?t:JSON.stringify(n,function(r,s){let a=oE(this[r],e);return a!==null?a:s},2)}function F3(n){return n==null?[]:[].concat(n)}let q3,z3,U3,QQ=/\$\{\s*(\w+)\s*\}/g;q3=Symbol.toStringTag;class lE{constructor(e,t,r,s){this.name=void 0,this.message=void 0,this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=void 0,this.inner=void 0,this[q3]="Error",this.name="ValidationError",this.value=t,this.path=r,this.type=s,this.errors=[],this.inner=[],F3(e).forEach(a=>{if(_s.isError(a)){this.errors.push(...a.errors);const o=a.inner.length?a.inner:[a];this.inner.push(...o)}else this.errors.push(a)}),this.message=this.errors.length>1?`${this.errors.length} errors occurred`:this.errors[0]}}z3=Symbol.hasInstance;U3=Symbol.toStringTag;class _s extends Error{static formatError(e,t){const r=t.label||t.path||"this";return t=Object.assign({},t,{path:r,originalPath:t.path}),typeof e=="string"?e.replace(QQ,(s,a)=>Nl(t[a])):typeof e=="function"?e(t):e}static isError(e){return e&&e.name==="ValidationError"}constructor(e,t,r,s,a){const o=new lE(e,t,r,s);if(a)return o;super(),this.value=void 0,this.path=void 0,this.type=void 0,this.params=void 0,this.errors=[],this.inner=[],this[U3]="Error",this.name=o.name,this.message=o.message,this.type=o.type,this.value=o.value,this.path=o.path,this.errors=o.errors,this.inner=o.inner,Error.captureStackTrace&&Error.captureStackTrace(this,_s)}static[z3](e){return lE[Symbol.hasInstance](e)||super[Symbol.hasInstance](e)}}let xo={default:"${path} is invalid",required:"${path} is a required field",defined:"${path} must be defined",notNull:"${path} cannot be null",oneOf:"${path} must be one of the following values: ${values}",notOneOf:"${path} must not be one of the following values: ${values}",notType:({path:n,type:e,value:t,originalValue:r})=>{const s=r!=null&&r!==t?` (cast from the value \`${Nl(r,!0)}\`).`:".";return e!=="mixed"?`${n} must be a \`${e}\` type, but the final value was: \`${Nl(t,!0)}\``+s:`${n} must match the configured type. The validated value was: \`${Nl(t,!0)}\``+s}},Vs={length:"${path} must be exactly ${length} characters",min:"${path} must be at least ${min} characters",max:"${path} must be at most ${max} characters",matches:'${path} must match the following: "${regex}"',email:"${path} must be a valid email",url:"${path} must be a valid URL",uuid:"${path} must be a valid UUID",datetime:"${path} must be a valid ISO date-time",datetime_precision:"${path} must be a valid ISO date-time with a sub-second precision of exactly ${precision} digits",datetime_offset:'${path} must be a valid ISO date-time with UTC "Z" timezone',trim:"${path} must be a trimmed string",lowercase:"${path} must be a lowercase string",uppercase:"${path} must be a upper case string"},Dc={min:"${path} must be greater than or equal to ${min}",max:"${path} must be less than or equal to ${max}",lessThan:"${path} must be less than ${less}",moreThan:"${path} must be greater than ${more}",positive:"${path} must be a positive number",negative:"${path} must be a negative number",integer:"${path} must be an integer"},US={min:"${path} field must be later than ${min}",max:"${path} field must be at earlier than ${max}"},BS={isValue:"${path} field must be ${value}"},dx={noUnknown:"${path} field has unspecified keys: ${unknown}",exact:"${path} object contains unknown properties: ${properties}"},ux={min:"${path} field must have at least ${min} items",max:"${path} field must have less than or equal to ${max} items",length:"${path} must have ${length} items"},XQ={notType:n=>{const{path:e,value:t,spec:r}=n,s=r.types.length;if(Array.isArray(t)){if(t.length<s)return`${e} tuple value has too few items, expected a length of ${s} but got ${t.length} for value: \`${Nl(t,!0)}\``;if(t.length>s)return`${e} tuple value has too many items, expected a length of ${s} but got ${t.length} for value: \`${Nl(t,!0)}\``}return _s.formatError(xo.notType,n)}};Object.assign(Object.create(null),{mixed:xo,string:Vs,number:Dc,date:US,object:dx,array:ux,boolean:BS,tuple:XQ});const my=n=>n&&n.__isYupSchema__;class Fx{static fromOptions(e,t){if(!t.then&&!t.otherwise)throw new TypeError("either `then:` or `otherwise:` is required for `when()` conditions");let{is:r,then:s,otherwise:a}=t,o=typeof r=="function"?r:(...l)=>l.every(c=>c===r);return new Fx(e,(l,c)=>{var d;let h=o(...l)?s:a;return(d=h?.(c))!=null?d:c})}constructor(e,t){this.fn=void 0,this.refs=e,this.refs=e,this.fn=t}resolve(e,t){let r=this.refs.map(a=>a.getValue(t?.value,t?.parent,t?.context)),s=this.fn(r,e,t);if(s===void 0||s===e)return e;if(!my(s))throw new TypeError("conditions must return a schema object");return s.resolve(t)}}const Hp={context:"$",value:"."};function F1(n,e){return new rd(n,e)}class rd{constructor(e,t={}){if(this.key=void 0,this.isContext=void 0,this.isValue=void 0,this.isSibling=void 0,this.path=void 0,this.getter=void 0,this.map=void 0,typeof e!="string")throw new TypeError("ref must be a string, got: "+e);if(this.key=e.trim(),e==="")throw new TypeError("ref must be a non-empty string");this.isContext=this.key[0]===Hp.context,this.isValue=this.key[0]===Hp.value,this.isSibling=!this.isContext&&!this.isValue;let r=this.isContext?Hp.context:this.isValue?Hp.value:"";this.path=this.key.slice(r.length),this.getter=this.path&&uu.getter(this.path,!0),this.map=t.map}getValue(e,t,r){let s=this.isContext?r:this.isValue?e:t;return this.getter&&(s=this.getter(s||{})),this.map&&(s=this.map(s)),s}cast(e,t){return this.getValue(e,t?.parent,t?.context)}resolve(){return this}describe(){return{type:"ref",key:this.key}}toString(){return`Ref(${this.key})`}static isRef(e){return e&&e.__isYupRef}}rd.prototype.__isYupRef=!0;const Pa=n=>n==null;function ef(n){function e({value:t,path:r="",options:s,originalValue:a,schema:o},l,c){const{name:d,test:h,params:p,message:x,skipAbsent:y}=n;let{parent:_,context:w,abortEarly:j=o.spec.abortEarly,disableStackTrace:C=o.spec.disableStackTrace}=s;const P={value:t,parent:_,context:w};function O(W={}){const G=B3(Object.assign({value:t,originalValue:a,label:o.spec.label,path:W.path||r,spec:o.spec,disableStackTrace:W.disableStackTrace||C},p,W.params),P),Z=new _s(_s.formatError(W.message||x,G),t,G.path,W.type||d,G.disableStackTrace);return Z.params=G,Z}const M=j?l:c;let D={path:r,parent:_,type:d,from:s.from,createError:O,resolve(W){return V3(W,P)},options:s,originalValue:a,schema:o};const I=W=>{_s.isError(W)?M(W):W?c(null):M(O())},F=W=>{_s.isError(W)?M(W):l(W)};if(y&&Pa(t))return I(!0);let B;try{var U;if(B=h.call(D,t,D),typeof((U=B)==null?void 0:U.then)=="function"){if(s.sync)throw new Error(`Validation test of type: "${D.type}" returned a Promise during a synchronous validate. This test will finish after the validate call has returned`);return Promise.resolve(B).then(I,F)}}catch(W){F(W);return}I(B)}return e.OPTIONS=n,e}function B3(n,e){if(!n)return n;for(const t of Object.keys(n))n[t]=V3(n[t],e);return n}function V3(n,e){return rd.isRef(n)?n.getValue(e.value,e.parent,e.context):n}function eX(n,e,t,r=t){let s,a,o;return e?(uu.forEach(e,(l,c,d)=>{let h=c?l.slice(1,l.length-1):l;n=n.resolve({context:r,parent:s,value:t});let p=n.type==="tuple",x=d?parseInt(h,10):0;if(n.innerType||p){if(p&&!d)throw new Error(`Yup.reach cannot implicitly index into a tuple type. the path part "${o}" must contain an index to the tuple element, e.g. "${o}[0]"`);if(t&&x>=t.length)throw new Error(`Yup.reach cannot resolve an array item at index: ${l}, in the path: ${e}. because there is no value at that index. `);s=t,t=t&&t[x],n=p?n.spec.types[x]:n.innerType}if(!d){if(!n.fields||!n.fields[h])throw new Error(`The schema does not contain the path: ${e}. (failed at: ${o} which is a type: "${n.type}")`);s=t,t=t&&t[h],n=n.fields[h]}a=h,o=c?"["+l+"]":"."+l}),{schema:n,parent:s,parentPath:a}):{parent:s,parentPath:e,schema:n}}class qx extends Set{describe(){const e=[];for(const t of this.values())e.push(rd.isRef(t)?t.describe():t);return e}resolveAll(e){let t=[];for(const r of this.values())t.push(e(r));return t}clone(){return new qx(this.values())}merge(e,t){const r=this.clone();return e.forEach(s=>r.add(s)),t.forEach(s=>r.delete(s)),r}}function ff(n,e=new Map){if(my(n)||!n||typeof n!="object")return n;if(e.has(n))return e.get(n);let t;if(n instanceof Date)t=new Date(n.getTime()),e.set(n,t);else if(n instanceof RegExp)t=new RegExp(n),e.set(n,t);else if(Array.isArray(n)){t=new Array(n.length),e.set(n,t);for(let r=0;r<n.length;r++)t[r]=ff(n[r],e)}else if(n instanceof Map){t=new Map,e.set(n,t);for(const[r,s]of n.entries())t.set(r,ff(s,e))}else if(n instanceof Set){t=new Set,e.set(n,t);for(const r of n)t.add(ff(r,e))}else if(n instanceof Object){t={},e.set(n,t);for(const[r,s]of Object.entries(n))t[r]=ff(s,e)}else throw Error(`Unable to clone ${n}`);return t}function tX(n){if(!(n!=null&&n.length))return;const e=[];let t="",r=!1,s=!1;for(let a=0;a<n.length;a++){const o=n[a];if(o==="["&&!s){t&&(e.push(...t.split(".").filter(Boolean)),t=""),r=!0;continue}if(o==="]"&&!s){t&&(/^\d+$/.test(t)?e.push(t):e.push(t.replace(/^"|"$/g,"")),t=""),r=!1;continue}if(o==='"'){s=!s;continue}if(o==="."&&!r&&!s){t&&(e.push(t),t="");continue}t+=o}return t&&e.push(...t.split(".").filter(Boolean)),e}function nX(n,e){const t=e?`${e}.${n.path}`:n.path;return n.errors.map(r=>({message:r,path:tX(t)}))}function W3(n,e){var t;if(!((t=n.inner)!=null&&t.length)&&n.errors.length)return nX(n,e);const r=e?`${e}.${n.path}`:n.path;return n.inner.flatMap(s=>W3(s,r))}class Zs{constructor(e){this.type=void 0,this.deps=[],this.tests=void 0,this.transforms=void 0,this.conditions=[],this._mutate=void 0,this.internalTests={},this._whitelist=new qx,this._blacklist=new qx,this.exclusiveTests=Object.create(null),this._typeCheck=void 0,this.spec=void 0,this.tests=[],this.transforms=[],this.withMutation(()=>{this.typeError(xo.notType)}),this.type=e.type,this._typeCheck=e.check,this.spec=Object.assign({strip:!1,strict:!1,abortEarly:!0,recursive:!0,disableStackTrace:!1,nullable:!1,optional:!0,coerce:!0},e?.spec),this.withMutation(t=>{t.nonNullable()})}get _type(){return this.type}clone(e){if(this._mutate)return e&&Object.assign(this.spec,e),this;const t=Object.create(Object.getPrototypeOf(this));return t.type=this.type,t._typeCheck=this._typeCheck,t._whitelist=this._whitelist.clone(),t._blacklist=this._blacklist.clone(),t.internalTests=Object.assign({},this.internalTests),t.exclusiveTests=Object.assign({},this.exclusiveTests),t.deps=[...this.deps],t.conditions=[...this.conditions],t.tests=[...this.tests],t.transforms=[...this.transforms],t.spec=ff(Object.assign({},this.spec,e)),t}label(e){let t=this.clone();return t.spec.label=e,t}meta(...e){if(e.length===0)return this.spec.meta;let t=this.clone();return t.spec.meta=Object.assign(t.spec.meta||{},e[0]),t}withMutation(e){let t=this._mutate;this._mutate=!0;let r=e(this);return this._mutate=t,r}concat(e){if(!e||e===this)return this;if(e.type!==this.type&&this.type!=="mixed")throw new TypeError(`You cannot \`concat()\` schema's of different types: ${this.type} and ${e.type}`);let t=this,r=e.clone();const s=Object.assign({},t.spec,r.spec);return r.spec=s,r.internalTests=Object.assign({},t.internalTests,r.internalTests),r._whitelist=t._whitelist.merge(e._whitelist,e._blacklist),r._blacklist=t._blacklist.merge(e._blacklist,e._whitelist),r.tests=t.tests,r.exclusiveTests=t.exclusiveTests,r.withMutation(a=>{e.tests.forEach(o=>{a.test(o.OPTIONS)})}),r.transforms=[...t.transforms,...r.transforms],r}isType(e){return e==null?!!(this.spec.nullable&&e===null||this.spec.optional&&e===void 0):this._typeCheck(e)}resolve(e){let t=this;if(t.conditions.length){let r=t.conditions;t=t.clone(),t.conditions=[],t=r.reduce((s,a)=>a.resolve(s,e),t),t=t.resolve(e)}return t}resolveOptions(e){var t,r,s,a;return Object.assign({},e,{from:e.from||[],strict:(t=e.strict)!=null?t:this.spec.strict,abortEarly:(r=e.abortEarly)!=null?r:this.spec.abortEarly,recursive:(s=e.recursive)!=null?s:this.spec.recursive,disableStackTrace:(a=e.disableStackTrace)!=null?a:this.spec.disableStackTrace})}cast(e,t={}){let r=this.resolve(Object.assign({},t,{value:e})),s=t.assert==="ignore-optionality",a=r._cast(e,t);if(t.assert!==!1&&!r.isType(a)){if(s&&Pa(a))return a;let o=Nl(e),l=Nl(a);throw new TypeError(`The value of ${t.path||"field"} could not be cast to a value that satisfies the schema type: "${r.type}". 

attempted value: ${o} 
`+(l!==o?`result of cast: ${l}`:""))}return a}_cast(e,t){let r=e===void 0?e:this.transforms.reduce((s,a)=>a.call(this,s,e,this,t),e);return r===void 0&&(r=this.getDefault(t)),r}_validate(e,t={},r,s){let{path:a,originalValue:o=e,strict:l=this.spec.strict}=t,c=e;l||(c=this._cast(c,Object.assign({assert:!1},t)));let d=[];for(let h of Object.values(this.internalTests))h&&d.push(h);this.runTests({path:a,value:c,originalValue:o,options:t,tests:d},r,h=>{if(h.length)return s(h,c);this.runTests({path:a,value:c,originalValue:o,options:t,tests:this.tests},r,s)})}runTests(e,t,r){let s=!1,{tests:a,value:o,originalValue:l,path:c,options:d}=e,h=w=>{s||(s=!0,t(w,o))},p=w=>{s||(s=!0,r(w,o))},x=a.length,y=[];if(!x)return p([]);let _={value:o,originalValue:l,path:c,options:d,schema:this};for(let w=0;w<a.length;w++){const j=a[w];j(_,h,function(P){P&&(Array.isArray(P)?y.push(...P):y.push(P)),--x<=0&&p(y)})}}asNestedTest({key:e,index:t,parent:r,parentPath:s,originalParent:a,options:o}){const l=e??t;if(l==null)throw TypeError("Must include `key` or `index` for nested validations");const c=typeof l=="number";let d=r[l];const h=Object.assign({},o,{strict:!0,parent:r,value:d,originalValue:a[l],key:void 0,[c?"index":"key"]:l,path:c||l.includes(".")?`${s||""}[${c?l:`"${l}"`}]`:(s?`${s}.`:"")+e});return(p,x,y)=>this.resolve(h)._validate(d,h,x,y)}validate(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return new Promise((o,l)=>s._validate(e,t,(c,d)=>{_s.isError(c)&&(c.value=d),l(c)},(c,d)=>{c.length?l(new _s(c,d,void 0,void 0,a)):o(d)}))}validateSync(e,t){var r;let s=this.resolve(Object.assign({},t,{value:e})),a,o=(r=t?.disableStackTrace)!=null?r:s.spec.disableStackTrace;return s._validate(e,Object.assign({},t,{sync:!0}),(l,c)=>{throw _s.isError(l)&&(l.value=c),l},(l,c)=>{if(l.length)throw new _s(l,e,void 0,void 0,o);a=c}),a}isValid(e,t){return this.validate(e,t).then(()=>!0,r=>{if(_s.isError(r))return!1;throw r})}isValidSync(e,t){try{return this.validateSync(e,t),!0}catch(r){if(_s.isError(r))return!1;throw r}}_getDefault(e){let t=this.spec.default;return t==null?t:typeof t=="function"?t.call(this,e):ff(t)}getDefault(e){return this.resolve(e||{})._getDefault(e)}default(e){return arguments.length===0?this._getDefault():this.clone({default:e})}strict(e=!0){return this.clone({strict:e})}nullability(e,t){const r=this.clone({nullable:e});return r.internalTests.nullable=ef({message:t,name:"nullable",test(s){return s===null?this.schema.spec.nullable:!0}}),r}optionality(e,t){const r=this.clone({optional:e});return r.internalTests.optionality=ef({message:t,name:"optionality",test(s){return s===void 0?this.schema.spec.optional:!0}}),r}optional(){return this.optionality(!0)}defined(e=xo.defined){return this.optionality(!1,e)}nullable(){return this.nullability(!0)}nonNullable(e=xo.notNull){return this.nullability(!1,e)}required(e=xo.required){return this.clone().withMutation(t=>t.nonNullable(e).defined(e))}notRequired(){return this.clone().withMutation(e=>e.nullable().optional())}transform(e){let t=this.clone();return t.transforms.push(e),t}test(...e){let t;if(e.length===1?typeof e[0]=="function"?t={test:e[0]}:t=e[0]:e.length===2?t={name:e[0],test:e[1]}:t={name:e[0],message:e[1],test:e[2]},t.message===void 0&&(t.message=xo.default),typeof t.test!="function")throw new TypeError("`test` is a required parameters");let r=this.clone(),s=ef(t),a=t.exclusive||t.name&&r.exclusiveTests[t.name]===!0;if(t.exclusive&&!t.name)throw new TypeError("Exclusive tests must provide a unique `name` identifying the test");return t.name&&(r.exclusiveTests[t.name]=!!t.exclusive),r.tests=r.tests.filter(o=>!(o.OPTIONS.name===t.name&&(a||o.OPTIONS.test===s.OPTIONS.test))),r.tests.push(s),r}when(e,t){!Array.isArray(e)&&typeof e!="string"&&(t=e,e=".");let r=this.clone(),s=F3(e).map(a=>new rd(a));return s.forEach(a=>{a.isSibling&&r.deps.push(a.key)}),r.conditions.push(typeof t=="function"?new Fx(s,t):Fx.fromOptions(s,t)),r}typeError(e){let t=this.clone();return t.internalTests.typeError=ef({message:e,name:"typeError",skipAbsent:!0,test(r){return this.schema._typeCheck(r)?!0:this.createError({params:{type:this.schema.type}})}}),t}oneOf(e,t=xo.oneOf){let r=this.clone();return e.forEach(s=>{r._whitelist.add(s),r._blacklist.delete(s)}),r.internalTests.whiteList=ef({message:t,name:"oneOf",skipAbsent:!0,test(s){let a=this.schema._whitelist,o=a.resolveAll(this.resolve);return o.includes(s)?!0:this.createError({params:{values:Array.from(a).join(", "),resolved:o}})}}),r}notOneOf(e,t=xo.notOneOf){let r=this.clone();return e.forEach(s=>{r._blacklist.add(s),r._whitelist.delete(s)}),r.internalTests.blacklist=ef({message:t,name:"notOneOf",test(s){let a=this.schema._blacklist,o=a.resolveAll(this.resolve);return o.includes(s)?this.createError({params:{values:Array.from(a).join(", "),resolved:o}}):!0}}),r}strip(e=!0){let t=this.clone();return t.spec.strip=e,t}describe(e){const t=(e?this.resolve(e):this).clone(),{label:r,meta:s,optional:a,nullable:o}=t.spec;return{meta:s,label:r,optional:a,nullable:o,default:t.getDefault(e),type:t.type,oneOf:t._whitelist.describe(),notOneOf:t._blacklist.describe(),tests:t.tests.filter((c,d,h)=>h.findIndex(p=>p.OPTIONS.name===c.OPTIONS.name)===d).map(c=>{const d=c.OPTIONS.params&&e?B3(Object.assign({},c.OPTIONS.params),e):c.OPTIONS.params;return{name:c.OPTIONS.name,params:d}})}}get"~standard"(){const e=this;return{version:1,vendor:"yup",async validate(r){try{return{value:await e.validate(r,{abortEarly:!1})}}catch(s){if(s instanceof _s)return{issues:W3(s)};throw s}}}}}Zs.prototype.__isYupSchema__=!0;for(const n of["validate","validateSync"])Zs.prototype[`${n}At`]=function(e,t,r={}){const{parent:s,parentPath:a,schema:o}=eX(this,e,t,r.context);return o[n](s&&s[a],Object.assign({},r,{parent:s,path:e}))};for(const n of["equals","is"])Zs.prototype[n]=Zs.prototype.oneOf;for(const n of["not","nope"])Zs.prototype[n]=Zs.prototype.notOneOf;const rX=()=>!0;function Wt(n){return new $3(n)}class $3 extends Zs{constructor(e){super(typeof e=="function"?{type:"mixed",check:e}:Object.assign({type:"mixed",check:rX},e))}}Wt.prototype=$3.prototype;function ls(){return new H3}class H3 extends Zs{constructor(){super({type:"boolean",check(e){return e instanceof Boolean&&(e=e.valueOf()),typeof e=="boolean"}}),this.withMutation(()=>{this.transform((e,t)=>{if(this.spec.coerce&&!this.isType(e)){if(/^(true|1)$/i.test(String(e)))return!0;if(/^(false|0)$/i.test(String(e)))return!1}return e})})}isTrue(e=BS.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"true"},test(t){return Pa(t)||t===!0}})}isFalse(e=BS.isValue){return this.test({message:e,name:"is-value",exclusive:!0,params:{value:"false"},test(t){return Pa(t)||t===!1}})}default(e){return super.default(e)}defined(e){return super.defined(e)}optional(){return super.optional()}required(e){return super.required(e)}notRequired(){return super.notRequired()}nullable(){return super.nullable()}nonNullable(e){return super.nonNullable(e)}strip(e){return super.strip(e)}}ls.prototype=H3.prototype;const sX=/^(\d{4}|[+-]\d{6})(?:-?(\d{2})(?:-?(\d{2}))?)?(?:[ T]?(\d{2}):?(\d{2})(?::?(\d{2})(?:[,.](\d{1,}))?)?(?:(Z)|([+-])(\d{2})(?::?(\d{2}))?)?)?$/;function iX(n){const e=VS(n);if(!e)return Date.parse?Date.parse(n):Number.NaN;if(e.z===void 0&&e.plusMinus===void 0)return new Date(e.year,e.month,e.day,e.hour,e.minute,e.second,e.millisecond).valueOf();let t=0;return e.z!=="Z"&&e.plusMinus!==void 0&&(t=e.hourOffset*60+e.minuteOffset,e.plusMinus==="+"&&(t=0-t)),Date.UTC(e.year,e.month,e.day,e.hour,e.minute+t,e.second,e.millisecond)}function VS(n){var e,t;const r=sX.exec(n);return r?{year:fl(r[1]),month:fl(r[2],1)-1,day:fl(r[3],1),hour:fl(r[4]),minute:fl(r[5]),second:fl(r[6]),millisecond:r[7]?fl(r[7].substring(0,3)):0,precision:(e=(t=r[7])==null?void 0:t.length)!=null?e:void 0,z:r[8]||void 0,plusMinus:r[9]||void 0,hourOffset:fl(r[10]),minuteOffset:fl(r[11])}:null}function fl(n,e=0){return Number(n)||e}let aX=/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/,oX=/^((https?|ftp):)?\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(\#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i,lX=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,cX="^\\d{4}-\\d{2}-\\d{2}",dX="\\d{2}:\\d{2}:\\d{2}",uX="(([+-]\\d{2}(:?\\d{2})?)|Z)",fX=new RegExp(`${cX}T${dX}(\\.\\d+)?${uX}$`),hX=n=>Pa(n)||n===n.trim(),mX={}.toString();function xe(){return new Y3}class Y3 extends Zs{constructor(){super({type:"string",check(e){return e instanceof String&&(e=e.valueOf()),typeof e=="string"}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce||this.isType(e)||Array.isArray(e))return e;const r=e!=null&&e.toString?e.toString():e;return r===mX?e:r})})}required(e){return super.required(e).withMutation(t=>t.test({message:e||xo.required,name:"required",skipAbsent:!0,test:r=>!!r.length}))}notRequired(){return super.notRequired().withMutation(e=>(e.tests=e.tests.filter(t=>t.OPTIONS.name!=="required"),e))}length(e,t=Vs.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t=Vs.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t=Vs.max){return this.test({name:"max",exclusive:!0,message:t,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}matches(e,t){let r=!1,s,a;return t&&(typeof t=="object"?{excludeEmptyString:r=!1,message:s,name:a}=t:s=t),this.test({name:a||"matches",message:s||Vs.matches,params:{regex:e},skipAbsent:!0,test:o=>o===""&&r||o.search(e)!==-1})}email(e=Vs.email){return this.matches(aX,{name:"email",message:e,excludeEmptyString:!0})}url(e=Vs.url){return this.matches(oX,{name:"url",message:e,excludeEmptyString:!0})}uuid(e=Vs.uuid){return this.matches(lX,{name:"uuid",message:e,excludeEmptyString:!1})}datetime(e){let t="",r,s;return e&&(typeof e=="object"?{message:t="",allowOffset:r=!1,precision:s=void 0}=e:t=e),this.matches(fX,{name:"datetime",message:t||Vs.datetime,excludeEmptyString:!0}).test({name:"datetime_offset",message:t||Vs.datetime_offset,params:{allowOffset:r},skipAbsent:!0,test:a=>{if(!a||r)return!0;const o=VS(a);return o?!!o.z:!1}}).test({name:"datetime_precision",message:t||Vs.datetime_precision,params:{precision:s},skipAbsent:!0,test:a=>{if(!a||s==null)return!0;const o=VS(a);return o?o.precision===s:!1}})}ensure(){return this.default("").transform(e=>e===null?"":e)}trim(e=Vs.trim){return this.transform(t=>t!=null?t.trim():t).test({message:e,name:"trim",test:hX})}lowercase(e=Vs.lowercase){return this.transform(t=>Pa(t)?t:t.toLowerCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Pa(t)||t===t.toLowerCase()})}uppercase(e=Vs.uppercase){return this.transform(t=>Pa(t)?t:t.toUpperCase()).test({message:e,name:"string_case",exclusive:!0,skipAbsent:!0,test:t=>Pa(t)||t===t.toUpperCase()})}}xe.prototype=Y3.prototype;let pX=n=>n!=+n;function cs(){return new G3}class G3 extends Zs{constructor(){super({type:"number",check(e){return e instanceof Number&&(e=e.valueOf()),typeof e=="number"&&!pX(e)}}),this.withMutation(()=>{this.transform((e,t)=>{if(!this.spec.coerce)return e;let r=e;if(typeof r=="string"){if(r=r.replace(/\s/g,""),r==="")return NaN;r=+r}return this.isType(r)||r===null?r:parseFloat(r)})})}min(e,t=Dc.min){return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r>=this.resolve(e)}})}max(e,t=Dc.max){return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r<=this.resolve(e)}})}lessThan(e,t=Dc.lessThan){return this.test({message:t,name:"max",exclusive:!0,params:{less:e},skipAbsent:!0,test(r){return r<this.resolve(e)}})}moreThan(e,t=Dc.moreThan){return this.test({message:t,name:"min",exclusive:!0,params:{more:e},skipAbsent:!0,test(r){return r>this.resolve(e)}})}positive(e=Dc.positive){return this.moreThan(0,e)}negative(e=Dc.negative){return this.lessThan(0,e)}integer(e=Dc.integer){return this.test({name:"integer",message:e,skipAbsent:!0,test:t=>Number.isInteger(t)})}truncate(){return this.transform(e=>Pa(e)?e:e|0)}round(e){var t;let r=["ceil","floor","round","trunc"];if(e=((t=e)==null?void 0:t.toLowerCase())||"round",e==="trunc")return this.truncate();if(r.indexOf(e.toLowerCase())===-1)throw new TypeError("Only valid options for round() are: "+r.join(", "));return this.transform(s=>Pa(s)?s:Math[e](s))}}cs.prototype=G3.prototype;let gX=new Date(""),xX=n=>Object.prototype.toString.call(n)==="[object Date]";class q1 extends Zs{constructor(){super({type:"date",check(e){return xX(e)&&!isNaN(e.getTime())}}),this.withMutation(()=>{this.transform((e,t)=>!this.spec.coerce||this.isType(e)||e===null?e:(e=iX(e),isNaN(e)?q1.INVALID_DATE:new Date(e)))})}prepareParam(e,t){let r;if(rd.isRef(e))r=e;else{let s=this.cast(e);if(!this._typeCheck(s))throw new TypeError(`\`${t}\` must be a Date or a value that can be \`cast()\` to a Date`);r=s}return r}min(e,t=US.min){let r=this.prepareParam(e,"min");return this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(s){return s>=this.resolve(r)}})}max(e,t=US.max){let r=this.prepareParam(e,"max");return this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(s){return s<=this.resolve(r)}})}}q1.INVALID_DATE=gX;function yX(n,e=[]){let t=[],r=new Set,s=new Set(e.map(([o,l])=>`${o}-${l}`));function a(o,l){let c=uu.split(o)[0];r.add(c),s.has(`${l}-${c}`)||t.push([l,c])}for(const o of Object.keys(n)){let l=n[o];r.add(o),rd.isRef(l)&&l.isSibling?a(l.path,o):my(l)&&"deps"in l&&l.deps.forEach(c=>a(c,o))}return $Q.array(Array.from(r),t).reverse()}function cE(n,e){let t=1/0;return n.some((r,s)=>{var a;if((a=e.path)!=null&&a.includes(r))return t=s,!0}),t}function Z3(n){return(e,t)=>cE(n,e)-cE(n,t)}const K3=(n,e,t)=>{if(typeof n!="string")return n;let r=n;try{r=JSON.parse(n)}catch{}return t.isType(r)?r:n};function fx(n){if("fields"in n){const e={};for(const[t,r]of Object.entries(n.fields))e[t]=fx(r);return n.setFields(e)}if(n.type==="array"){const e=n.optional();return e.innerType&&(e.innerType=fx(e.innerType)),e}return n.type==="tuple"?n.optional().clone({types:n.spec.types.map(fx)}):"optional"in n?n.optional():n}const vX=(n,e)=>{const t=[...uu.normalizePath(e)];if(t.length===1)return t[0]in n;let r=t.pop(),s=uu.getter(uu.join(t),!0)(n);return!!(s&&r in s)};let dE=n=>Object.prototype.toString.call(n)==="[object Object]";function uE(n,e){let t=Object.keys(n.fields);return Object.keys(e).filter(r=>t.indexOf(r)===-1)}const bX=Z3([]);function Pt(n){return new J3(n)}class J3 extends Zs{constructor(e){super({type:"object",check(t){return dE(t)||typeof t=="function"}}),this.fields=Object.create(null),this._sortErrors=bX,this._nodes=[],this._excludedEdges=[],this.withMutation(()=>{e&&this.shape(e)})}_cast(e,t={}){var r;let s=super._cast(e,t);if(s===void 0)return this.getDefault(t);if(!this._typeCheck(s))return s;let a=this.fields,o=(r=t.stripUnknown)!=null?r:this.spec.noUnknown,l=[].concat(this._nodes,Object.keys(s).filter(p=>!this._nodes.includes(p))),c={},d=Object.assign({},t,{parent:c,__validating:t.__validating||!1}),h=!1;for(const p of l){let x=a[p],y=p in s,_=s[p];if(x){let w;d.path=(t.path?`${t.path}.`:"")+p,x=x.resolve({value:_,context:t.context,parent:c});let j=x instanceof Zs?x.spec:void 0,C=j?.strict;if(j!=null&&j.strip){h=h||p in s;continue}w=!t.__validating||!C?x.cast(_,d):_,w!==void 0&&(c[p]=w)}else y&&!o&&(c[p]=_);(y!==p in c||c[p]!==_)&&(h=!0)}return h?c:s}_validate(e,t={},r,s){let{from:a=[],originalValue:o=e,recursive:l=this.spec.recursive}=t;t.from=[{schema:this,value:o},...a],t.__validating=!0,t.originalValue=o,super._validate(e,t,r,(c,d)=>{if(!l||!dE(d)){s(c,d);return}o=o||d;let h=[];for(let p of this._nodes){let x=this.fields[p];!x||rd.isRef(x)||h.push(x.asNestedTest({options:t,key:p,parent:d,parentPath:t.path,originalParent:o}))}this.runTests({tests:h,value:d,originalValue:o,options:t},r,p=>{s(p.sort(this._sortErrors).concat(c),d)})})}clone(e){const t=super.clone(e);return t.fields=Object.assign({},this.fields),t._nodes=this._nodes,t._excludedEdges=this._excludedEdges,t._sortErrors=this._sortErrors,t}concat(e){let t=super.concat(e),r=t.fields;for(let[s,a]of Object.entries(this.fields)){const o=r[s];r[s]=o===void 0?a:o}return t.withMutation(s=>s.setFields(r,[...this._excludedEdges,...e._excludedEdges]))}_getDefault(e){if("default"in this.spec)return super._getDefault(e);if(!this._nodes.length)return;let t={};return this._nodes.forEach(r=>{var s;const a=this.fields[r];let o=e;(s=o)!=null&&s.value&&(o=Object.assign({},o,{parent:o.value,value:o.value[r]})),t[r]=a&&"getDefault"in a?a.getDefault(o):void 0}),t}setFields(e,t){let r=this.clone();return r.fields=e,r._nodes=yX(e,t),r._sortErrors=Z3(Object.keys(e)),t&&(r._excludedEdges=t),r}shape(e,t=[]){return this.clone().withMutation(r=>{let s=r._excludedEdges;return t.length&&(Array.isArray(t[0])||(t=[t]),s=[...r._excludedEdges,...t]),r.setFields(Object.assign(r.fields,e),s)})}partial(){const e={};for(const[t,r]of Object.entries(this.fields))e[t]="optional"in r&&r.optional instanceof Function?r.optional():r;return this.setFields(e)}deepPartial(){return fx(this)}pick(e){const t={};for(const r of e)this.fields[r]&&(t[r]=this.fields[r]);return this.setFields(t,this._excludedEdges.filter(([r,s])=>e.includes(r)&&e.includes(s)))}omit(e){const t=[];for(const r of Object.keys(this.fields))e.includes(r)||t.push(r);return this.pick(t)}from(e,t,r){let s=uu.getter(e,!0);return this.transform(a=>{if(!a)return a;let o=a;return vX(a,e)&&(o=Object.assign({},a),r||delete o[e],o[t]=s(a)),o})}json(){return this.transform(K3)}exact(e){return this.test({name:"exact",exclusive:!0,message:e||dx.exact,test(t){if(t==null)return!0;const r=uE(this.schema,t);return r.length===0||this.createError({params:{properties:r.join(", ")}})}})}stripUnknown(){return this.clone({noUnknown:!0})}noUnknown(e=!0,t=dx.noUnknown){typeof e!="boolean"&&(t=e,e=!0);let r=this.test({name:"noUnknown",exclusive:!0,message:t,test(s){if(s==null)return!0;const a=uE(this.schema,s);return!e||a.length===0||this.createError({params:{unknown:a.join(", ")}})}});return r.spec.noUnknown=e,r}unknown(e=!0,t=dx.noUnknown){return this.noUnknown(!e,t)}transformKeys(e){return this.transform(t=>{if(!t)return t;const r={};for(const s of Object.keys(t))r[e(s)]=t[s];return r})}camelCase(){return this.transformKeys(Tb.camelCase)}snakeCase(){return this.transformKeys(Tb.snakeCase)}constantCase(){return this.transformKeys(e=>Tb.snakeCase(e).toUpperCase())}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);r.fields={};for(const[a,o]of Object.entries(t.fields)){var s;let l=e;(s=l)!=null&&s.value&&(l=Object.assign({},l,{parent:l.value,value:l.value[a]})),r.fields[a]=o.describe(l)}return r}}Pt.prototype=J3.prototype;function js(n){return new Q3(n)}class Q3 extends Zs{constructor(e){super({type:"array",spec:{types:e},check(t){return Array.isArray(t)}}),this.innerType=void 0,this.innerType=e}_cast(e,t){const r=super._cast(e,t);if(!this._typeCheck(r)||!this.innerType)return r;let s=!1;const a=r.map((o,l)=>{const c=this.innerType.cast(o,Object.assign({},t,{path:`${t.path||""}[${l}]`,parent:r,originalValue:o,value:o,index:l}));return c!==o&&(s=!0),c});return s?a:r}_validate(e,t={},r,s){var a;let o=this.innerType,l=(a=t.recursive)!=null?a:this.spec.recursive;t.originalValue!=null&&t.originalValue,super._validate(e,t,r,(c,d)=>{var h;if(!l||!o||!this._typeCheck(d)){s(c,d);return}let p=new Array(d.length);for(let y=0;y<d.length;y++){var x;p[y]=o.asNestedTest({options:t,index:y,parent:d,parentPath:t.path,originalParent:(x=t.originalValue)!=null?x:e})}this.runTests({value:d,tests:p,originalValue:(h=t.originalValue)!=null?h:e,options:t},r,y=>s(y.concat(c),d))})}clone(e){const t=super.clone(e);return t.innerType=this.innerType,t}json(){return this.transform(K3)}concat(e){let t=super.concat(e);return t.innerType=this.innerType,e.innerType&&(t.innerType=t.innerType?t.innerType.concat(e.innerType):e.innerType),t}of(e){let t=this.clone();if(!my(e))throw new TypeError("`array.of()` sub-schema must be a valid yup schema not: "+Nl(e));return t.innerType=e,t.spec=Object.assign({},t.spec,{types:e}),t}length(e,t=ux.length){return this.test({message:t,name:"length",exclusive:!0,params:{length:e},skipAbsent:!0,test(r){return r.length===this.resolve(e)}})}min(e,t){return t=t||ux.min,this.test({message:t,name:"min",exclusive:!0,params:{min:e},skipAbsent:!0,test(r){return r.length>=this.resolve(e)}})}max(e,t){return t=t||ux.max,this.test({message:t,name:"max",exclusive:!0,params:{max:e},skipAbsent:!0,test(r){return r.length<=this.resolve(e)}})}ensure(){return this.default(()=>[]).transform((e,t)=>this._typeCheck(e)?e:t==null?[]:[].concat(t))}compact(e){let t=e?(r,s,a)=>!e(r,s,a):r=>!!r;return this.transform(r=>r!=null?r.filter(t):r)}describe(e){const t=(e?this.resolve(e):this).clone(),r=super.describe(e);if(t.innerType){var s;let a=e;(s=a)!=null&&s.value&&(a=Object.assign({},a,{parent:a.value,value:a.value[0]})),r.innerType=t.innerType.describe(a)}return r}}js.prototype=Q3.prototype;const we=E.forwardRef(({label:n,id:e,error:t,registration:r,className:s,labelClassName:a,...o},l)=>{const h=`form-input ${t?"form-input--error":""} ${s||""}`;return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:`block text-sm font-medium text-muted ${a||""}`,children:n}),i.jsx("div",{className:n?"mt-1":"",children:i.jsx("input",{ref:l,id:e,className:h,"aria-invalid":!!t,...r,...o})}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})});we.displayName="Input";const Dn=E.forwardRef(({id:n,label:e,description:t,className:r,labelClassName:s,inputClassName:a,...o},l)=>{const c=n||o.name;return i.jsxs("div",{className:`relative flex items-start ${r}`,children:[i.jsx("div",{className:"flex h-6 items-center",children:i.jsx("input",{id:c,"aria-describedby":t?`${c}-description`:void 0,type:"checkbox",ref:l,className:`h-4 w-4 rounded border-gray-300 text-accent focus:ring-accent cursor-pointer ${a||""}`,...o})}),i.jsxs("div",{className:"ml-3 text-sm leading-6",children:[i.jsx("label",{htmlFor:c,className:`font-medium text-primary-text cursor-pointer ${s}`,children:e}),t&&i.jsx("p",{id:`${c}-description`,className:"text-muted",children:t})]})]})});Dn.displayName="Checkbox";function wX(){const[n,e]=E.useState(null),[t,r]=E.useState(!1),[s,a]=E.useState(null);return E.useEffect(()=>{const l=(()=>{const p=navigator.userAgent,x=`${window.screen.width}x${window.screen.height}`,y=Intl.DateTimeFormat().resolvedOptions().timeZone,_=navigator.language,w=navigator.platform,j=navigator.hardwareConcurrency||0,C=`${p}|${x}|${y}|${_}|${w}|${j}`;let P=0;for(let I=0;I<C.length;I++){const F=C.charCodeAt(I);P=(P<<5)-P+F,P=P&P}const O="dev_"+Math.abs(P).toString(36),M=()=>p.indexOf("Chrome")>-1?"Chrome":p.indexOf("Firefox")>-1?"Firefox":p.indexOf("Safari")>-1?"Safari":p.indexOf("Edge")>-1?"Edge":"Unknown",D=()=>p.indexOf("Win")>-1?"Windows":p.indexOf("Mac")>-1?"MacOS":p.indexOf("Linux")>-1?"Linux":p.indexOf("Android")>-1?"Android":p.indexOf("iOS")>-1?"iOS":"Unknown";return{deviceId:O,deviceName:`${D()} - ${M()}`,browser:M(),os:D(),timestamp:new Date().toISOString()}})();e(l);const c=localStorage.getItem("device_id"),d=localStorage.getItem("device_name"),h=localStorage.getItem("device_timestamp");c&&c!==l.deviceId&&(r(!0),a({deviceId:c,deviceName:d||"Unknown Device",browser:"",os:"",timestamp:h||new Date().toISOString()})),localStorage.setItem("device_id",l.deviceId),localStorage.setItem("device_name",l.deviceName),localStorage.setItem("device_timestamp",l.timestamp)},[]),{deviceInfo:n,isNewDevice:t,previousDevice:s}}const _X=Pt({email:xe().email("Must be a valid email").required("Email is required"),password:xe().required("Password is required"),rememberMe:ls().optional()}).defined(),jX=n=>n.role==="unverified"?"/pending-approval":"/profile",NX=()=>{const{user:n,loginWithEmail:e,loginWithGoogle:t,error:r,setError:s,loading:a,setLoginAnimationPending:o,isLoginAnimationPending:l}=jt(),{colorScheme:c}=an(),d=St(),h=Zr(),{deviceInfo:p,isNewDevice:x,previousDevice:y}=wX(),[_,w]=E.useState(!1),[j,C]=E.useState(!1);E.useEffect(()=>{s(null);const B=new URLSearchParams(h.hash.substring(1)),U=B.get("error_code"),W=B.get("error_description");U==="otp_expired"&&W&&(s("Email confirmation link has expired or is invalid. Please try signing up again or request a new confirmation email."),d("/auth/login",{replace:!0}))},[s,h,d]),E.useEffect(()=>{n&&x&&y&&!_&&(ue.sendDeviceChangeAlert(n.id,n.name,y.deviceName,p?.deviceName||"Unknown Device").catch(B=>console.error("Failed to send device change alert:",B)),w(!0))},[n,x,y,_,p]),E.useEffect(()=>{n&&!l&&d(jX(n),{replace:!0})},[n,d,l]);const{register:P,handleSubmit:O,setValue:M,formState:{errors:D}}=tn({resolver:In(_X)});E.useEffect(()=>{const B=localStorage.getItem("rememberedEmail");B&&(M("email",B),M("rememberMe",!0)),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&M("rememberMe",!0)},[M]);const I=async B=>{o(!0);const W=/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)?!0:B.rememberMe||!1;(await e(B.email,B.password,W)).error?o(!1):(C(!0),setTimeout(()=>{o(!1)},1500))},F=async()=>{await t()},q=a||j;return i.jsxs(i.Fragment,{children:[i.jsxs("form",{onSubmit:O(I),className:"space-y-3",children:[i.jsxs("fieldset",{disabled:q,className:"space-y-3",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Hf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(we,{id:"email",type:"email",autoComplete:"email",placeholder:"Email",registration:P("email"),error:D.email?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"relative group",children:[i.jsx(DS,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none"}),i.jsx(we,{id:"password",type:"password",autoComplete:"current-password",placeholder:"Password",registration:P("password"),error:D.password?.message,className:"!pl-12 !bg-black/60 !text-white !border-white/10 focus:!border-[#22c55e] placeholder:!text-gray-500 !py-3 !rounded-xl transition-all"})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center sm:items-center justify-between gap-3",children:[i.jsxs("div",{className:"flex-shrink-0 login-checkbox-container",children:[i.jsx(Dn,{id:"rememberMe",label:"Remember me",labelClassName:"!text-white font-medium",...P("rememberMe"),inputClassName:"text-[#22c55e] focus:ring-[#22c55e] border-white/20 rounded bg-black/40"}),i.jsx("style",{dangerouslySetInnerHTML:{__html:`
                                .login-checkbox-container label {
                                    color: #ffffff !important;
                                    opacity: 1 !important;
                                    pointer-events: auto !important;
                                    position: relative !important;
                                    z-index: 10 !important;
                                }
                            `}})]}),i.jsx(Oa,{to:"/auth/forgot-password",className:`text-sm font-medium !text-white hover:text-gray-200 transition-colors auth-link ${q?"pointer-events-none opacity-50":""}`,"aria-disabled":q,onClick:B=>{q&&B.preventDefault()},style:{color:"#ffffff"},children:"Forgot your password?"})]})]}),i.jsx("div",{className:"min-h-[24px] flex items-center justify-center",children:r&&i.jsxs("div",{className:"flex items-center gap-2 text-sm text-red-400 text-center p-2 bg-red-500/10 rounded-lg border border-red-500/20",children:[i.jsx(Aa,{className:"h-4 w-4 flex-shrink-0"}),i.jsx("span",{children:r})]})}),i.jsx(ne,{type:"submit",className:`w-full !font-bold !py-3 !rounded-full shadow-lg transition-all transform hover:scale-[1.02] signin-btn ${j?"!bg-[#22c55e] !border-[#22c55e] !text-white hover:!bg-[#22c55e]":"!bg-[#22c55e] border border-[#22c55e] !text-white hover:!bg-[#16a34a] hover:!border-[#16a34a] hover:!text-white shadow-green-500/20"}`,isLoading:a&&!j,size:"lg",disabled:q&&!j,children:j?i.jsx(jl,{className:"w-6 h-6 animate-bounce"}):"Sign In"})]}),i.jsxs("div",{className:"flex items-center my-6",children:[i.jsx("div",{className:"flex-1 border-t border-white/10"}),i.jsx("span",{className:"px-4 text-sm text-gray-400 font-medium",children:"OR"}),i.jsx("div",{className:"flex-1 border-t border-white/10"})]}),i.jsxs("button",{type:"button",onClick:F,className:"w-full flex items-center justify-center gap-3 bg-white text-gray-900 hover:bg-gray-100 font-bold py-3 rounded-full transition-all transform hover:scale-[1.02] shadow-lg google-btn",disabled:q,children:[i.jsxs("svg",{className:"w-5 h-5",viewBox:"0 0 48 48",children:[i.jsx("path",{fill:"#FFC107",d:"M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z"}),i.jsx("path",{fill:"#FF3D00",d:"M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z"}),i.jsx("path",{fill:"#4CAF50",d:"M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36c-5.222,0-9.519-3.487-11.181-8.264l-6.522,5.025C9.505,39.556,16.227,44,24,44z"}),i.jsx("path",{fill:"#1976D2",d:"M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.574l6.19,5.238C39.99,35.508,44,30.021,44,24C44,22.659,43.862,21.35,43.611,20.083z"})]}),"Sign in with Google"]}),i.jsx("div",{className:"text-center mt-4",children:i.jsxs("p",{className:"text-sm text-gray-300",style:{color:"#e5e7eb"},children:["Don't have an account?"," ",i.jsx(Oa,{to:"/auth/signup",className:"font-medium !text-white hover:text-gray-200 auth-link",style:{color:"#ffffff"},children:"Sign Up"})]})})]})},SX=Pt({name:xe().required("Your name is required"),email:xe().email("Must be a valid email").required("Email is required"),password:xe().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:xe().oneOf([F1("password")],"Passwords must match").required("Please confirm your password")}).defined(),CX=()=>{const{signUp:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),{register:a,handleSubmit:o,formState:{errors:l,isSubmitting:c}}=tn({resolver:In(SX)}),d=async h=>{t("");const{error:p}=await n(h.name,h.email,h.password);p?t(p.message):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(l3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",style:{color:"#ffffff"},children:"Confirm your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",style:{color:"#ffffff"},children:"We've sent a confirmation link to your email address. Please click the link to activate your account."}),i.jsx("div",{className:"mt-6",children:i.jsx(Oa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:" Back to Login"})})]}):i.jsxs("form",{onSubmit:o(d),className:"space-y-4",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Pl,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"name",type:"text",placeholder:"Full Name",registration:a("name"),error:l.name?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Hf,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"email",type:"email",placeholder:"Email Address",registration:a("email"),error:l.email?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(DS,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"password",type:"password",placeholder:"Password",registration:a("password"),error:l.password?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),i.jsxs("div",{className:"relative",children:[i.jsx(DS,{className:"absolute left-3.5 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 pointer-events-none"}),i.jsx(we,{id:"confirmPassword",type:"password",placeholder:"Confirm Password",registration:a("confirmPassword"),error:l.confirmPassword?.message,className:"pl-11 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{className:"pt-2",children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:c,size:"lg",children:"Sign Up"})}),i.jsx("div",{className:"text-center pt-2",children:i.jsx(Oa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:"Already have an account? Sign In"})})]})},TX=Pt({email:xe().email("Must be a valid email").required("Email is required")}).defined(),kX=()=>{const{sendPasswordReset:n}=jt(),[e,t]=E.useState(""),[r,s]=E.useState(!1),a=St();E.useEffect(()=>{if(r){const p=setTimeout(()=>{a("/auth/login",{replace:!0})},3e3);return()=>clearTimeout(p)}},[r,a]);const{register:o,handleSubmit:l,formState:{errors:c,isSubmitting:d}}=tn({resolver:In(TX)}),h=async p=>{t("");const{error:x}=await n(p.email);x&&x.message.includes("rate limit")?t("Too many attempts. Please wait a few minutes before trying again."):s(!0)};return r?i.jsxs("div",{className:"text-center",children:[i.jsx(l3,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",style:{color:"#ffffff"},children:"Check your email"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",style:{color:"#ffffff"},children:"If an account exists for the email you provided, we've sent password reset instructions. Redirecting to login..."})]}):i.jsx(i.Fragment,{children:i.jsxs("form",{onSubmit:l(h),className:"space-y-6",children:[i.jsxs("div",{className:"relative group",children:[i.jsx(Hf,{className:"absolute left-4 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-400 group-focus-within:text-[#22c55e] transition-colors pointer-events-none z-10"}),i.jsx(we,{id:"email",type:"email",autoComplete:"email",placeholder:"Email Address",registration:o("email"),error:c.email?.message,className:"!pl-12 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-400 focus:!border-[#22c55e] !py-3 !rounded-xl transition-all"})]}),e&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:e}),i.jsx("div",{children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:d,size:"lg",children:"Send Reset Link"})}),i.jsx("div",{className:"text-center",children:i.jsx(Oa,{to:"/auth/login",className:"text-sm font-medium text-white/80 hover:text-white",style:{color:"#ffffff"},children:" Back to Login"})})]})})},PX=Pt({password:xe().min(6,"Password must be at least 6 characters").required("Password is required"),confirmPassword:xe().oneOf([F1("password")],"Passwords must match").required("Please confirm your password")}).defined(),MX=n=>{const e=n.toLowerCase();return e.includes("weak password")?"Password is too weak. Please use at least 6 characters.":e.includes("requires a recent login")?"For your security, please sign in again to continue.":(console.error("Unhandled auth error:",n),"Something went wrong. Please try again.")},EX=()=>{const[n,e]=E.useState(""),[t,r]=E.useState(!1),s=St(),{user:a,logout:o}=jt();E.useEffect(()=>{a||e("Invalid or expired password reset session. Please request a new password reset link.")},[a]);const{register:l,handleSubmit:c,formState:{errors:d,isSubmitting:h}}=tn({resolver:In(PX)}),p=async x=>{e("");const{error:y}=await Ca.updateUserPassword(x.password);y?e(MX(y.message)):(r(!0),await o(),setTimeout(()=>s("/auth/login",{replace:!0}),2e3))};return t?i.jsxs("div",{className:"text-center",children:[i.jsx(Ki,{className:"mx-auto h-12 w-12 text-accent"}),i.jsx("h3",{className:"mt-4 text-lg font-semibold text-white",children:"Password Updated!"}),i.jsx("p",{className:"mt-2 text-sm text-gray-300",children:"Your password has been changed successfully. You will be redirected to the login page shortly."}),i.jsx("div",{className:"mt-6",children:i.jsx(Oa,{to:"/auth/login",className:"font-medium text-white/80 hover:text-white",children:" Back to Login Now"})})]}):n&&!a?i.jsxs("div",{className:"text-center",children:[i.jsx("h3",{className:"text-3xl font-bold text-white",children:"Link Expired"}),i.jsx("p",{className:"text-sm text-gray-300 mt-1",children:"This password reset link is no longer valid."}),i.jsxs("div",{className:"mt-6 flex flex-col gap-4",children:[i.jsx(Oa,{to:"/auth/forgot-password",className:"font-medium text-white/80 hover:text-white",children:"Request a new link"}),i.jsx("div",{className:"auth-separator",children:"OR"}),i.jsx(ne,{onClick:()=>s("/auth/login"),className:"w-full",size:"lg",children:"Back to Sign In"})]})]}):i.jsxs("div",{children:[i.jsxs("p",{className:"text-sm text-center text-gray-300 -mt-6 mb-6",children:["for ",i.jsx("span",{className:"font-semibold text-white",children:a?.email}),"."]}),i.jsxs("form",{onSubmit:c(p),className:"space-y-6",children:[i.jsx(we,{id:"password",type:"password",placeholder:"New Password",autoComplete:"new-password",registration:l("password"),error:d.password?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),i.jsx(we,{id:"confirmPassword",type:"password",placeholder:"Confirm New Password",autoComplete:"new-password",registration:l("confirmPassword"),error:d.confirmPassword?.message,className:"pl-4 !bg-white/10 !text-white !border-white/20 placeholder:!text-gray-300"}),n&&i.jsx("p",{className:"text-sm text-red-400 text-center",children:n}),i.jsx("div",{children:i.jsx(ne,{type:"submit",className:"w-full",isLoading:h,size:"lg",disabled:!a,children:"Update Password"})})]})]})},DX=()=>{const n=St(),{logout:e}=jt(),t=async()=>{await e(),n("/auth/login",{replace:!0})},r=()=>{n(-1)};return i.jsx("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-red-100",children:i.jsx(_o,{className:"h-10 w-10 text-red-600"})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:"Log Out"}),i.jsx("p",{className:"text-muted mb-8",children:"Are you sure you want to log out? You will need to sign in again to access your account."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsx(ne,{onClick:t,variant:"danger",className:"w-full !py-3 !text-lg shadow-lg shadow-red-100",children:"Yes, Log Out"}),i.jsx(ne,{onClick:r,variant:"secondary",className:"w-full !py-3",children:"Cancel"})]})]})})},OX=()=>{const{logout:n,user:e}=jt(),t=St(),r=async()=>{await n(),t("/auth/login",{replace:!0})};return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx(Qi,{className:"h-10 mx-auto mb-6"}),i.jsx(NJ,{className:"h-16 w-16 text-accent mx-auto mb-4"}),i.jsx("h2",{className:"text-2xl font-bold text-primary-text mb-2",children:"Account Pending Approval"}),i.jsxs("p",{className:"text-muted mb-6",children:["Welcome, ",e?.name||"user","! Your account has been created successfully and is pending approval. An administrator will review your details and perform a security check before activating your account."]}),i.jsx("div",{className:"flex justify-center",children:i.jsxs(ne,{onClick:r,variant:"secondary",children:[i.jsx(_o,{className:"mr-2 h-4 w-4"}),"Log Out"]})})]})})},IX=()=>{const n=St();return i.jsx("div",{className:"min-h-screen flex items-center justify-center bg-page p-4",children:i.jsxs("div",{className:"text-center p-8 bg-card rounded-2xl shadow-card w-full",children:[i.jsx("div",{className:"flex justify-center mb-4",children:i.jsx(u3,{className:"h-16 w-16 text-red-500"})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Access Denied"}),i.jsx("p",{className:"text-muted mb-6",children:"You do not have the necessary permissions to view this page. If you believe this is an error, please contact your administrator."}),i.jsxs("div",{className:"flex justify-center gap-4",children:[i.jsx(ne,{onClick:()=>n(-1),variant:"secondary",children:"Go Back"}),i.jsx(ne,{onClick:async()=>{await jt.getState().logout(),n("/auth/login")},children:"Login"})]})]})})},AX=()=>{const n=St(),{data:e,reset:t}=Yn(),{user:r}=jt(),s=e.personal.firstName||e.personal.lastName,a=Rt("(max-width: 767px)"),o=()=>{t(),n("/onboarding/select-organization")},l=()=>{n("/onboarding/add/personal")};return a?i.jsx("div",{className:"flex flex-col items-center justify-center text-center relative min-h-[70vh]",children:i.jsxs("div",{className:"p-8 max-w-sm w-full bg-transparent",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"p-4 rounded-full bg-black/20",children:i.jsx(ES,{className:"h-10 w-10 text-emerald-400"})})}),i.jsx("h1",{className:"text-2xl font-bold text-white mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-gray-400 text-sm mb-8",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"flex flex-col gap-3",children:[s&&i.jsx(ne,{onClick:l,variant:"secondary",className:"w-full !py-3",children:"Continue Previous Application"}),i.jsx(ne,{onClick:o,variant:"primary",className:"w-full !py-3 !text-lg",children:"Start New Application"})]})]})}):i.jsx("div",{className:"h-full flex items-center justify-center p-4",children:i.jsxs("div",{className:"bg-card p-8 sm:p-12 rounded-2xl shadow-card text-center w-full",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:"bg-accent-light p-4 rounded-full",children:i.jsx(ES,{className:"h-12 w-12 text-accent-dark"})})}),i.jsx("h2",{className:"text-3xl font-bold text-primary-text mb-2",children:"Welcome to Employee Onboarding"}),i.jsx("p",{className:"text-muted mb-8 max-w-md mx-auto",children:"We need to collect some information to get you set up. This should only take a few minutes."}),i.jsxs("div",{className:"mt-10 flex justify-center items-center gap-4 flex-wrap",children:[s&&i.jsx(ne,{onClick:l,variant:"secondary",children:"Continue Draft"}),i.jsx(ne,{onClick:o,variant:"primary",children:s?"Start Fresh":"Start New Application"})]})]})})},Ze=E.forwardRef(({label:n,id:e,error:t,registration:r,children:s,className:a,...o},l)=>{const h=`form-input ${t?"form-input--error":""} ${a||""}`;return i.jsxs("div",{children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsx("div",{className:n?"mt-1":"",children:i.jsx("select",{ref:l,id:e,className:h,"aria-invalid":!!t,...r,...o,children:s})}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})});Ze.displayName="Select";const RX=()=>{const n=St(),{updateOrganization:e,updatePersonal:t}=Yn(),{enforceManpowerLimit:r,manpowerLimitRule:s}=td(),{user:a}=jt(),[o,l]=E.useState(!0),[c,d]=E.useState([]),[h,p]=E.useState([]),[x,y]=E.useState([]),[_,w]=E.useState(""),[j,C]=E.useState(""),[P,O]=E.useState(""),[M,D]=E.useState(""),[I,F]=E.useState([]),[q,B]=E.useState(window.innerWidth<768);E.useEffect(()=>{const K=()=>B(window.innerWidth<768);return window.addEventListener("resize",K),()=>window.removeEventListener("resize",K)},[]);const[U,W]=E.useState({isOverLimit:!1,message:""}),G=a?.role==="field_officer"&&q;E.useEffect(()=>{(async()=>{l(!0);try{const[re,H,se]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteStaffDesignations()]);d(re),p(H),y(se)}catch(re){console.error("Failed to fetch organization structure",re)}finally{l(!1)}})()},[]);const Z=E.useMemo(()=>c.find(K=>K.id===_),[c,_]),Y=E.useMemo(()=>Z?.companies||[],[Z]),ae=E.useMemo(()=>Y.find(K=>K.id===j),[Y,j]),ee=E.useMemo(()=>ae?.entities||[],[ae]);E.useEffect(()=>{D("");const K=ee.find(re=>re.id===P);F(K?x:[])},[P,ee,x]),E.useEffect(()=>{(async()=>{if(W({isOverLimit:!1,message:""}),!P||!r)return;const H=ee.find(ce=>ce.id===P)?.organizationId;if(!H)return;const ie=h.find(ce=>ce.id===H)?.manpowerApprovedCount;if(ie==null){W({isOverLimit:!1,message:"Manpower limit not set for this site."});return}try{const oe=(await ue.getVerificationSubmissions()).filter(de=>de.organizationId===H&&(de.status==="verified"||de.status==="pending")).length;if(oe>=ie){const de=`Manpower limit of ${ie} reached (${oe} deployed).`;W({isOverLimit:!0,message:de})}else{const de=`Manpower: ${oe} / ${ie} deployed.`;W({isOverLimit:!1,message:de})}}catch{W({isOverLimit:!1,message:"Could not verify manpower count."})}})()},[P,h,ee,r]);const me=()=>{const K=ee.find(re=>re.id===P);if(K?.organizationId){const re=h.find(se=>se.id===K.organizationId),H=x.find(se=>se.designation===M);re&&H?(e({organizationId:re.id,organizationName:re.shortName,joiningDate:We(new Date,"yyyy-MM-dd"),workType:"Full-time",designation:M,department:H.department,defaultSalary:H.monthlySalary||null}),t({salary:H.monthlySalary||null}),n("/onboarding/pre-upload")):console.error("Organization or Designation details not found.")}};if(o)return i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const $=!P||!M||U.isOverLimit&&s==="block";return G?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header text-white",children:[i.jsx("button",{onClick:()=>n("/onboarding"),"aria-label":"Go back",className:"text-white",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-xl font-bold",children:"New Enrollment"})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Choose the client and site for the new employee."})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("select",{value:_,onChange:K=>{w(K.target.value),C(""),O("")},className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:j,onChange:K=>{C(K.target.value),O("")},disabled:!_,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:P,onChange:K=>O(K.target.value),disabled:!j,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),ee.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs("select",{value:M,onChange:K=>D(K.target.value),disabled:!P,className:"form-input",children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(K=>i.jsx("option",{value:K.designation,children:K.designation},K.id))]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-900/50 text-red-300 border border-red-500/50":"bg-green-900/50 text-green-300 border border-green-500/50"}`,children:U.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center justify-between gap-4",children:[i.jsx("button",{onClick:()=>n("/onboarding"),className:"fo-btn-secondary px-6",children:"Back"}),i.jsx("button",{onClick:me,disabled:$,className:"fo-btn-primary flex-1",children:"Continue"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Select Site"}),i.jsx("p",{className:"text-muted",children:"Choose the client and site for the new employee."})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs(Ze,{label:"Company Group",id:"group",value:_,onChange:K=>{w(K.target.value),C(""),O("")},children:[i.jsx("option",{value:"",children:"-- Select a Group --"}),c.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Company",id:"company",value:j,onChange:K=>{C(K.target.value),O("")},disabled:!_,children:[i.jsx("option",{value:"",children:"-- Select a Company --"}),Y.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Client / Site",id:"entity",value:P,onChange:K=>O(K.target.value),disabled:!j,children:[i.jsx("option",{value:"",children:"-- Select a Client/Site --"}),ee.map(K=>i.jsx("option",{value:K.id,children:K.name},K.id))]}),i.jsxs(Ze,{label:"Designation",id:"designation",value:M,onChange:K=>D(K.target.value),disabled:!P,children:[i.jsx("option",{value:"",children:"-- Select a Designation --"}),I.map(K=>i.jsx("option",{value:K.designation,children:K.designation},K.id))]})]}),U.message&&i.jsx("div",{className:`mt-4 text-sm p-3 rounded-lg ${U.isOverLimit?"bg-red-50 text-red-700":"bg-green-50 text-green-700"}`,children:U.message}),i.jsx("div",{className:"mt-8 pt-6 border-t flex justify-end",children:i.jsxs(ne,{onClick:me,disabled:$,children:["Continue ",i.jsx(JK,{className:"ml-2 h-4 w-4"})]})})]})})},fE=({steps:n,currentStepIndex:e,onStepClick:t,highestStepReached:r,isMobileOptimized:s=!1})=>{const[a,o]=E.useState(0),l=4,c=Math.ceil(n.length/l);E.useEffect(()=>{if(s){const x=Math.floor(e/l);o(x)}},[e,s,l]);const d=()=>{o(x=>Math.min(x+1,c-1))},h=()=>{o(x=>Math.max(x-1,0))},p=E.useMemo(()=>{if(!s)return[];const x=a*l,y=x+l;return Array.from({length:n.length},(_,w)=>w).slice(x,y)},[a,l,n.length,s]);if(!s){const x=e>0?e/(n.length-1)*100:0,_=100/n.length/2;return i.jsx("nav",{"aria-label":"Onboarding Progress",className:"py-4",children:i.jsxs("div",{className:"relative",children:[i.jsxs("div",{className:"absolute top-4 h-1",style:{left:`${_}%`,right:`${_}%`},children:[i.jsx("div",{className:"w-full h-full bg-border rounded-full"}),i.jsx("div",{className:"absolute top-0 left-0 h-full bg-accent rounded-full transition-all duration-500 ease-in-out",style:{width:`${x}%`}})]}),i.jsx("ol",{role:"list",className:"relative flex items-center",children:n.map((w,j)=>{const C=j<e,P=j===e,O=j<=r;return i.jsx("li",{className:"flex-1",children:i.jsxs("div",{className:"relative flex flex-col items-center group",children:[i.jsx("button",{type:"button",onClick:()=>O&&t(j),disabled:!O,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-accent-dark rounded-full disabled:cursor-not-allowed","aria-current":P?"step":void 0,title:w.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-9 h-9 rounded-full transition-all duration-300 border-2 z-10 ${C?"bg-accent border-accent text-white":""} ${P?"bg-card border-accent text-accent scale-110":""} ${!C&&!P?"bg-card border-border text-muted":""} ${O?"group-hover:border-accent-dark":""}`,children:C?i.jsx(jl,{className:"w-5 h-5"}):ot.createElement(w.icon,{className:"w-5 h-5"})})}),i.jsx("span",{className:`hidden sm:block absolute top-12 w-24 text-center text-xs transition-colors duration-300 ${P?"text-accent font-bold":"text-muted"} ${O?"group-hover:text-primary-text":""}`,children:w.label})]})},w.key)})})]})})}return i.jsxs("nav",{"aria-label":"Onboarding Progress",className:"bg-card rounded-2xl mx-4 my-2 p-2 flex items-center gap-1",children:[i.jsx("button",{type:"button",onClick:h,disabled:a===0,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Previous steps",children:i.jsx(oy,{className:"h-6 w-6"})}),i.jsx("div",{className:"flex-1 overflow-hidden",children:i.jsx("ol",{role:"list",className:"flex items-center justify-around",children:p.map(x=>{const y=n[x],_=x<e,w=x===e,j=x<=r;return i.jsx("li",{className:"flex-shrink-0",children:i.jsx("div",{className:"relative flex flex-col items-center group",children:i.jsx("button",{type:"button",onClick:()=>j&&t(x),disabled:!j,className:"flex flex-col items-center focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-full disabled:cursor-not-allowed","aria-current":w?"step":void 0,title:y.label,children:i.jsx("div",{className:`relative flex items-center justify-center w-10 h-10 rounded-full transition-all duration-300 border-2 z-10
                      ${_?"bg-green-600 border-green-600 text-white":""}
                      ${w?"bg-transparent border-green-500 text-white scale-110":""}
                      ${!_&&!w?`bg-transparent ${j?"border-gray-500 text-gray-400 group-hover:border-emerald-400":"border-gray-700 text-gray-600 opacity-50"}`:""}`,children:_?i.jsx(jl,{className:"w-6 h-6 text-white"}):ot.createElement(y.icon,{className:"w-6 h-6"})})})})},y.key)})})}),i.jsx("button",{type:"button",onClick:d,disabled:a>=c-1,className:"p-2 rounded-full disabled:opacity-30 disabled:cursor-not-allowed text-white hover:bg-white/10","aria-label":"Next steps",children:i.jsx(If,{className:"h-6 w-6"})})]})},pt=({message:n,type:e,onDismiss:t})=>{const{colorScheme:r}=an();E.useEffect(()=>{const l=setTimeout(()=>{t()},5e3);return()=>{clearTimeout(l)}},[t]);const a=e==="error"?"bg-red-500":{blue:"bg-[#1a3a6e]",green:"bg-green-500",purple:"bg-[#5B21B6]",red:"bg-[#991B1B]",amber:"bg-[#B45309]"}[r]||"bg-green-500",o=e==="success"?Ki:gm;return i.jsxs("div",{className:`fixed top-5 right-5 z-50 flex items-center p-4 rounded-lg text-white shadow-lg ${a}`,children:[i.jsx(o,{className:"h-6 w-6 mr-3"}),i.jsx("span",{className:"text-sm font-medium",children:n}),i.jsx("button",{onClick:t,className:"ml-4 -mr-2 p-1.5 rounded-md hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-white",children:i.jsx(vi,{className:"h-5 w-5"})})]})},X3=[{key:"personal",label:"Personal",icon:Pl},{key:"address",label:"Address",icon:kl},{key:"organization",label:"Organization",icon:Zi},{key:"family",label:"Family",icon:Ji},{key:"education",label:"Education",icon:i3},{key:"bank",label:"Bank",icon:Tl},{key:"uan",label:"UAN/PF",icon:QK},{key:"esi",label:"ESI",icon:LJ},{key:"gmc",label:"GMC",icon:T1},{key:"uniform",label:"Uniform",icon:Rf},{key:"documents",label:"Documents",icon:bJ},{key:"biometrics",label:"Biometrics",icon:s3},{key:"review",label:"Review",icon:gJ}],Vi=X3.map(n=>n.key),LX=()=>{const n=St(),e=Zr(),{data:t,reset:r,setData:s}=Yn(),{user:a}=jt(),{salaryThreshold:o}=td(),[l,c]=E.useState(!1),[d,h]=E.useState(!0),[p,x]=E.useState(null),[y]=p4(),[_,w]=E.useState(!1),[j,C]=E.useState("idle"),P=E.useRef(null),O=Rt("(max-width: 767px)"),M=E.useRef(null),D=e.pathname.split("/").pop(),I=E.useMemo(()=>Vi.indexOf(D),[D]),[F,q]=E.useState(0);E.useEffect(()=>{const $=t.personal.firstName==="Ravi"&&t.status==="draft";if(t.status!=="draft"||$){q(Vi.length-1);return}const K=sessionStorage.getItem(`onboarding_progress_${t.id}`),re=K?parseInt(K,10):0,H=Math.max(re,I);q(H),I>re&&sessionStorage.setItem(`onboarding_progress_${t.id}`,String(I))},[t,I]);const B=E.useMemo(()=>X3.map(($,K)=>({...$,status:K<I?"complete":K===I?"current":"upcoming"})),[I]);E.useEffect(()=>{const $=y.get("id");$?(async re=>{h(!0);try{const H=await ue.getOnboardingDataById(re);H?(s(H),C("saved")):(x({message:"Could not find submission data.",type:"error"}),r())}catch(H){console.error("Failed to fetch submission data",H),x({message:"Failed to load submission data.",type:"error"}),r()}finally{h(!1)}})($):h(!1)},[y,s,r]);const U=E.useCallback(async()=>{C("saving");try{const{draftId:$}=await ue.saveDraft(t);$!==t.id&&s({...t,id:$}),C("saved")}catch{x({message:"Auto-save failed. Check your connection.",type:"error"}),C("dirty")}},[t,s]);E.useEffect(()=>((!t.id||t.id.startsWith("draft_")||t.status==="draft")&&!d&&(j!=="saving"&&C("dirty"),P.current&&clearTimeout(P.current),P.current=window.setTimeout(()=>{U()},2e3)),()=>{P.current&&clearTimeout(P.current)}),[t,d,U,j]);const W=async()=>{P.current&&clearTimeout(P.current),await U();const $=M.current;if(M.current=null,$)n(`/onboarding/add/${$}`);else if(I<Vi.length-1){let K=I+1;D==="esi"&&Vi[K]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||K++),K<Vi.length&&n(`/onboarding/add/${Vi[K]}`)}},G=$=>{$<=F&&n(`/onboarding/add/${Vi[$]}`)},Z=()=>{if(I>0){let $=I-1;D==="uniform"&&Vi[$]==="gmc"&&(t.personal.salary!=null&&t.personal.salary>o||$--),$>=0?n(`/onboarding/add/${Vi[$]}`):n("/onboarding/select-organization")}else n("/onboarding/select-organization")},Y=async()=>{c(!0);const $={...t,status:"pending"};try{!!t.id&&!t.id.startsWith("draft_")?(await ue.updateOnboarding($),x({message:"Application updated successfully!",type:"success"})):(await ue.submitOnboarding($),x({message:"Application submitted successfully!",type:"success"})),setTimeout(()=>{r(),a?.role==="site_manager"?n("/site/dashboard"):n("/onboarding")},2e3)}catch{x({message:"Failed to submit application.",type:"error"}),c(!1)}},ae=()=>{sessionStorage.removeItem(`onboarding_progress_${t.id}`),r(),w(!1),n("/onboarding/add/personal",{replace:!0}),x({message:"Form has been cleared.",type:"success"})},ee=$=>{if($.key!=="ArrowUp"&&$.key!=="ArrowDown"&&$.key!=="Enter")return;const K=$.target;if($.key==="Enter"&&K.tagName!=="TEXTAREA"&&K.tagName!=="BUTTON"&&$.preventDefault(),$.key==="Enter"&&K.tagName==="BUTTON"||($.key==="ArrowUp"||$.key==="ArrowDown")&&(K.tagName==="TEXTAREA"||K.type==="number"))return;const re=$.currentTarget,H=Array.from(re.querySelectorAll('input:not([type="hidden"]):not([readonly]), select, textarea, button')).filter(ce=>!ce.hasAttribute("disabled")&&ce.offsetParent!==null),se=H.indexOf(document.activeElement);if(se===-1)return;($.key==="ArrowUp"||$.key==="ArrowDown")&&$.preventDefault();let ie=se;if($.key==="ArrowUp"?ie=se-1:ie=se+1,ie>=0&&ie<H.length)H[ie].focus();else if($.key==="Enter"&&ie>=H.length){const ce=document.getElementById("save-and-next-button");ce&&ce.click()}};if(d)return i.jsxs("div",{className:"flex justify-center items-center h-full text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin mr-4"}),i.jsx("p",{children:"Loading application data..."})]});const me=Vi[I]==="review";return O?i.jsxs("div",{className:"h-full flex flex-col",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(fE,{steps:B,currentStepIndex:I,onStepClick:G,highestStepReached:F,isMobileOptimized:!0}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 pb-28",onKeyDown:ee,children:i.jsx("div",{className:"bg-card p-6 rounded-2xl",children:i.jsx(_f,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})})}),i.jsxs("footer",{className:"fixed bottom-0 left-0 right-0 p-4 flex items-center justify-between gap-2 bg-card border-t border-[#123820] z-10",children:[i.jsx(ne,{type:"button",onClick:Z,variant:"secondary",children:"Back"}),i.jsx(ne,{type:"button",onClick:()=>n("/onboarding"),variant:"secondary",className:"!p-3 !rounded-full","aria-label":"Go to Home",children:i.jsx(k1,{className:"h-5 w-5"})}),i.jsx(ne,{id:"save-and-next-button",type:"submit",form:`${Vi[I]}-form`,children:me?"Submit":"Next"})]})]}):i.jsx("div",{className:"p-4 md:p-0",children:i.jsxs("div",{className:`transition-opacity duration-300 ${l?"opacity-50 pointer-events-none":""}`,children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Kr,{isOpen:_,onClose:()=>w(!1),onConfirm:ae,title:"Confirm Clear Form",children:"Are you sure you want to clear all data entered in this form? This action cannot be undone."}),i.jsx(fE,{steps:B,currentStepIndex:I,onStepClick:G,highestStepReached:F,isMobileOptimized:O}),i.jsx("div",{className:"mt-8 bg-card p-6 sm:p-8 rounded-xl shadow-card",onKeyDown:ee,children:i.jsx(_f,{context:{onValidated:W,onSubmit:Y,isSubmitting:l,setToast:x}})}),i.jsxs("div",{className:"mt-8 flex justify-between items-center",children:[i.jsx(ne,{onClick:Z,disabled:I===0,variant:"secondary",children:"Back"}),i.jsxs("div",{className:"flex flex-wrap gap-4 justify-end items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted italic transition-opacity duration-300 min-h-[20px]",children:[j==="saving"&&i.jsxs(i.Fragment,{children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"}),i.jsx("span",{children:"Saving..."})]}),j==="saved"&&i.jsxs(i.Fragment,{children:[i.jsx(Ki,{className:"h-4 w-4 text-accent"}),i.jsx("span",{children:"Draft saved"})]}),j==="dirty"&&i.jsx("span",{className:"text-gray-500",children:"Unsaved changes"})]}),!me&&i.jsx(ne,{id:"save-and-next-button",type:"submit",form:`${Vi[I]}-form`,children:"Save & Next"})]})]})]})})},z1=({status:n})=>{const t={pending:"status-chip--pending",verified:"status-chip--verified",rejected:"status-chip--rejected",draft:"status-chip--draft"}[n]||"status-chip--draft";return i.jsx("span",{className:`status-chip ${t}`,children:n})},Gr=({className:n=""})=>i.jsx("div",{className:`skeleton-pulse rounded-md ${n}`}),FX=({rows:n,cols:e})=>i.jsx("div",{className:"space-y-4",children:Array.from({length:n}).map((t,r)=>i.jsx("div",{className:"bg-card rounded-2xl border border-border p-4 space-y-3",children:Array.from({length:e}).map((s,a)=>i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx(Gr,{className:"h-4 w-1/4"}),i.jsx(Gr,{className:"h-4 w-1/2"})]},a))},r))}),qX=({rows:n,cols:e})=>i.jsx(i.Fragment,{children:Array.from({length:n}).map((t,r)=>i.jsx("tr",{children:Array.from({length:e}).map((s,a)=>i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"space-y-2",children:[i.jsx(Gr,{className:`h-4 ${a===0?"w-3/4":"w-full"}`}),a===0&&i.jsx(Gr,{className:"h-3 w-1/2"})]})},a))},r))}),Ra=({rows:n=5,cols:e=4,isMobile:t=!1,mobileCols:r})=>t?i.jsx(FX,{rows:n,cols:r||e}):i.jsx(qX,{rows:n,cols:e}),zX=({submission:n,isSyncing:e})=>{if(n.status!=="verified"||!n.portalSyncStatus)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});if(e)return i.jsxs("div",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx(_t,{className:"h-4 w-4 animate-spin"})," Syncing..."]});const t=n.uan?.hasPreviousPf,r=[{label:"Aadhaar",verified:n.personal?.verifiedStatus?.idProofNumber},{label:"Bank",verified:n.bank?.verifiedStatus?.accountNumber},...t?[{label:"UAN",verified:n.uan?.verifiedStatus?.uanNumber}]:[]],s=n.portalSyncStatus==="synced"||n.portalSyncStatus==="failed",a=({label:o,status:l})=>{const c=s&&l===!0,d=s&&l===!1,h=c?bm:d?h3:m3,p=c?"text-green-600":d?"text-red-600":"text-muted",x=c?"Verified":d?"Failed":"Pending Verification";return i.jsxs("div",{className:`flex items-center gap-1.5 text-xs font-medium ${p}`,title:x,children:[i.jsx(h,{className:"h-4 w-4"}),i.jsx("span",{children:o})]})};return i.jsx("div",{className:"flex flex-row gap-3 items-center",children:r.map(o=>i.jsx(a,{label:o.label,status:o.verified},o.label))})},UX=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),[h,p]=E.useState(null),x=St(),y=Rt("(max-width: 767px)"),_=E.useCallback(async()=>{r(!0);try{const M=await ue.getVerificationSubmissions(s==="all"?void 0:s);e(M)}catch(M){console.error("Failed to fetch submissions",M)}finally{r(!1)}},[s]);E.useEffect(()=>{_();const M=Me.channel("submissions-feed").on("postgres_changes",{event:"*",schema:"public",table:"onboarding_submissions"},D=>{console.log("Real-time change received!",D),_()}).subscribe();return()=>{Me.removeChannel(M)}},[_]);const w=E.useMemo(()=>n?n.filter(M=>M.personal.firstName?.toLowerCase().includes(o.toLowerCase())||M.personal.lastName?.toLowerCase().includes(o.toLowerCase())||M.personal.employeeId?.toLowerCase().includes(o.toLowerCase())||M.organizationName?.toLowerCase().includes(o.toLowerCase())):[],[n,o]),j=async(M,D)=>{e(I=>I.map(F=>F.id===D?{...F,status:M==="approve"?"verified":"rejected",portalSyncStatus:M==="approve"?"pending_sync":void 0}:F));try{M==="approve"?await ue.verifySubmission(D):await ue.requestChanges(D,"Changes requested by admin.")}catch(I){console.error(`Failed to ${M} submission`,I)}},C=async M=>{d(M);try{const D=await ue.syncPortals(M);e(I=>I.map(F=>F.id===M?D:F)),D.portalSyncStatus==="synced"?p({message:"Portals synced successfully!",type:"success"}):p({message:"Portal sync failed. Check details.",type:"error"})}catch{p({message:"An error occurred during sync.",type:"error"})}finally{d(null)}},P=["all","pending","verified","rejected"],O=s==="verified"?4:5;return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("h2",{className:"text-2xl font-semibold text-primary-text mb-6",children:"Onboarding Forms"}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center mb-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:P.map(M=>i.jsx("button",{onClick:()=>a(M),className:`${s===M?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize`,children:M},M))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ia,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name, ID, site...",value:o,onChange:M=>l(M.target.value),className:"form-input block w-full pl-10 pr-3 py-2 border-border rounded-lg leading-5 placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site"}),s!=="verified"&&i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Verification"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"bg-card md:divide-y-0",children:t?y?i.jsx("tr",{children:i.jsx("td",{colSpan:O,children:i.jsx(Ra,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:O}):w.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:O,className:"text-center py-10 text-white",children:"No submissions found."})}):w.map(M=>i.jsxs("tr",{className:M.requiresManualVerification?"bg-orange-50":"",children:[i.jsx("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center",children:[M.requiresManualVerification&&i.jsx("span",{title:"Manual verification required due to data mismatch.",children:i.jsx(Aa,{className:"h-4 w-4 text-orange-500 mr-2 flex-shrink-0"})}),i.jsxs("div",{children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[M.personal.firstName," ",M.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:M.personal.employeeId})]})]})}),i.jsx("td",{"data-label":"Site",className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-primary-text",children:M.organizationName}),s!=="verified"&&i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(z1,{status:M.status})}),i.jsx("td",{"data-label":"Portal Verification",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(zX,{submission:M,isSyncing:c===M.id})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/add/personal?id=${M.id}`),title:"View Details","aria-label":`View details for ${M.personal.firstName}`,children:i.jsx(Cl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>x(`/onboarding/pdf/${M.id}`),title:"Download Forms","aria-label":`Download forms for ${M.personal.firstName}`,children:i.jsx(us,{className:"h-4 w-4"})}),M.status==="pending"&&i.jsxs(i.Fragment,{children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j("approve",M.id),title:"Verify","aria-label":`Verify submission for ${M.personal.firstName}`,children:i.jsx(bm,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j("reject",M.id),title:"Request Changes","aria-label":`Request changes for ${M.personal.firstName}`,children:i.jsx(h3,{className:"h-4 w-4 text-red-600"})})]}),M.status==="verified"&&(M.portalSyncStatus==="pending_sync"||M.portalSyncStatus==="failed")&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>C(M.id),isLoading:c===M.id,title:"Push data to government portals",children:[c!==M.id&&i.jsx(M1,{className:"h-4 w-4 mr-1"}),"Sync Portals"]})]})})]},M.id))})]})})]})},na=({title:n,children:e})=>i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:n}),e&&i.jsx("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:e})]}),BX=({isOpen:n,onClose:e,onApprove:t,user:r,isConfirming:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState(""),[d,h]=E.useState(!0);E.useEffect(()=>{n&&(h(!0),ue.getRoles().then(x=>{const y=x.filter(_=>_.id!=="unverified"&&_.id!=="admin");o(y),y.length>0&&c(y[0].id),h(!1)}))},[n]);const p=()=>{r&&l&&t(r.id,l)};return!n||!r?null:i.jsx(Kr,{isOpen:n,onClose:e,onConfirm:p,title:"Approve User Account",confirmButtonText:"Confirm Approval",confirmButtonVariant:"primary",isConfirming:s,children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("p",{children:["You are approving the account for ",i.jsx("strong",{className:"text-primary-text",children:r.name})," (",r.email,")."]}),i.jsx("p",{children:"Please assign a role to activate their account."}),d?i.jsx("p",{children:"Loading roles..."}):i.jsx(Ze,{label:"Assign Role",id:"approval-role",value:l,onChange:x=>c(x.target.value),children:a.map(x=>i.jsx("option",{value:x.id,children:x.displayName},x.id))})]})})},VX=({isOpen:n,onClose:e,userId:t,userName:r,onSuccess:s})=>{const[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[y,_]=E.useState(""),[w,j]=E.useState(null);E.useEffect(()=>{n&&t&&C()},[n,t]);const C=async()=>{h(!0);try{const[I,F]=await Promise.all([ue.getUserLocations(t),ue.getLocations()]);o(I),c(F)}catch(I){console.error("Failed to load locations:",I),j({message:"Failed to load locations.",type:"error"})}finally{h(!1)}},P=async I=>{x(!0);try{await ue.assignLocationToUser(t,I);const F=await ue.getUserLocations(t);o(F),j({message:"Location assigned successfully!",type:"success"}),s?.()}catch(F){console.error("Failed to assign location:",F),j({message:F.message||"Failed to assign location.",type:"error"})}finally{x(!1)}},O=async I=>{x(!0);try{await ue.unassignLocationFromUser(t,I);const F=await ue.getUserLocations(t);o(F),j({message:"Location unassigned successfully!",type:"success"}),s?.()}catch(F){console.error("Failed to unassign location:",F),j({message:F.message||"Failed to unassign location.",type:"error"})}finally{x(!1)}},M=I=>a.some(F=>F.id===I),D=l.filter(I=>!M(I.id)).filter(I=>y===""||I.name?.toLowerCase().includes(y.toLowerCase())||I.address?.toLowerCase().includes(y.toLowerCase()));return i.jsxs(i.Fragment,{children:[w&&i.jsx(pt,{message:w.message,type:w.type,onDismiss:()=>j(null)}),i.jsx(Kr,{isOpen:n,onClose:e,title:`Manage Locations for ${r}`,children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Assigned Locations (",a.length,")"]}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):a.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:"No locations assigned yet."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:a.map(I=>i.jsxs("div",{className:"flex items-start justify-between bg-accent/10 border border-accent/30 rounded-lg p-3",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"})]}),i.jsx("button",{type:"button",onClick:()=>O(I.id),disabled:p,className:"text-red-500 hover:text-red-700 disabled:opacity-50 p-1",title:"Remove",children:i.jsx(vi,{className:"h-5 w-5"})})]},I.id))})]}),i.jsxs("div",{children:[i.jsxs("h3",{className:"text-sm font-semibold text-primary-text mb-3",children:["Available Locations (",D.length,")"]}),i.jsx(we,{type:"text",placeholder:"Search locations...",value:y,onChange:I=>_(I.target.value),className:"mb-3"}),d?i.jsx("p",{className:"text-sm text-muted",children:"Loading..."}):D.length===0?i.jsx("p",{className:"text-sm text-muted bg-gray-50 p-3 rounded-lg",children:y?"No locations found.":"All assigned."}):i.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto",children:D.map(I=>i.jsxs("div",{className:"flex items-start justify-between border border-border rounded-lg p-3 hover:bg-gray-50",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("h4",{className:"font-semibold text-sm text-primary-text",children:I.name||"Unnamed"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:I.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-1",children:[I.latitude.toFixed(4),", ",I.longitude.toFixed(4),"  Radius: ",I.radius,"m"]})]}),i.jsx("button",{type:"button",onClick:()=>P(I.id),disabled:p,className:"text-accent hover:text-accent-dark disabled:opacity-50 p-1",title:"Assign",children:i.jsx(Vt,{className:"h-5 w-5"})})]},I.id))})]}),i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsx(ne,{onClick:e,variant:"secondary",children:"Done"})})]})})]})},WX=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(!1),[y,_]=E.useState(null),[w,j]=E.useState(null),[C,P]=E.useState(null),O=Rt("(max-width: 767px)"),M=E.useCallback(async()=>{s(!0);try{const G=await ue.getUsers();t(G)}catch{P({message:"Failed to fetch users.",type:"error"})}finally{s(!1)}},[]);E.useEffect(()=>{M()},[M]);const D=()=>{n("/admin/users/add")},I=G=>{n(`/admin/users/edit/${G.id}`)},F=G=>{_(G),h(!0)},q=G=>{_(G),c(!0)},B=async(G,Z)=>{o(!0);try{await ue.updateUser(G,{role:Z}),P({message:"User approved successfully!",type:"success"}),h(!1),M()}catch{P({message:"Failed to approve user.",type:"error"})}finally{o(!1)}},U=async()=>{if(y){o(!0);try{await ue.deleteUser(y.id),P({message:"User deleted. Remember to also remove them from Supabase Auth.",type:"success"}),c(!1),M()}catch{P({message:"Failed to delete user.",type:"error"})}finally{o(!1)}}},W=G=>G?G.replace(/_/g," ").replace(/\b\w/g,Z=>Z.toUpperCase()):"N/A";return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[C&&i.jsx(pt,{message:C.message,type:C.type,onDismiss:()=>P(null)}),i.jsx(BX,{isOpen:d,onClose:()=>h(!1),onApprove:B,user:y,isConfirming:a}),i.jsxs(Kr,{isOpen:l,onClose:()=>c(!1),onConfirm:U,title:"Confirm Deletion",isConfirming:a,children:['Are you sure you want to delete the user "',y?.name,'"? This action cannot be undone.']}),i.jsx(VX,{isOpen:p,onClose:()=>x(!1),userId:w?.id||"",userName:w?.name||""}),i.jsx(na,{title:"User Management",children:i.jsxs(ne,{onClick:D,children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add User"]})}),i.jsx("div",{className:"mb-6 bg-blue-50 border border-blue-200 text-blue-800 p-4 rounded-lg text-sm",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(cu,{className:"h-5 w-5 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold",children:"Adding New Users"}),i.jsxs("p",{className:"mt-1",children:["Use the ",i.jsx("strong",{children:"Add User"})," button below to create a new user. Provide their name, email, role and a temporary password. The system will automatically provision their login, send them a verification email and create their profile."]}),i.jsx("p",{className:"mt-2",children:"Once they confirm their email they can sign in using the password you set. You can edit or delete users at any time from this page."})]})]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Email"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:r?O?i.jsx("tr",{children:i.jsx("td",{colSpan:4,children:i.jsx(Ra,{rows:3,cols:4,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:4}):e.map(G=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Name",className:"px-6 py-4 font-medium",children:G.name}),i.jsx("td",{"data-label":"Email",className:"px-6 py-4 text-sm text-muted",children:G.email}),i.jsxs("td",{"data-label":"Role",className:"px-6 py-4 text-sm text-muted",children:[i.jsxs("div",{className:"flex items-center md:justify-start justify-end",children:[i.jsx(ly,{className:"h-4 w-4 mr-2 text-accent"}),W(G.role)]}),G.role==="unverified"&&i.jsx("span",{className:"text-xs font-semibold px-2 py-0.5 rounded-full bg-yellow-100 text-yellow-800 ml-2",children:"Pending Approval"})]}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[G.role==="unverified"&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>F(G),"aria-label":`Approve user ${G.name}`,title:`Approve user ${G.name}`,children:[i.jsx(xu,{className:"h-4 w-4 mr-2"}),"Approve"]}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(G),"aria-label":`Edit user ${G.name}`,title:`Edit user ${G.name}`,children:i.jsx(dr,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>q(G),"aria-label":`Delete user ${G.name}`,title:`Delete user ${G.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})})]},G.id))})]})})]})};var kb,hE;function $X(){if(hE)return kb;hE=1;var n=!1,e,t,r,s,a,o,l,c,d,h,p,x,y,_,w;function j(){if(!n){n=!0;var P=navigator.userAgent,O=/(?:MSIE.(\d+\.\d+))|(?:(?:Firefox|GranParadiso|Iceweasel).(\d+\.\d+))|(?:Opera(?:.+Version.|.)(\d+\.\d+))|(?:AppleWebKit.(\d+(?:\.\d+)?))|(?:Trident\/\d+\.\d+.*rv:(\d+\.\d+))/.exec(P),M=/(Mac OS X)|(Windows)|(Linux)/.exec(P);if(x=/\b(iPhone|iP[ao]d)/.exec(P),y=/\b(iP[ao]d)/.exec(P),h=/Android/i.exec(P),_=/FBAN\/\w+;/i.exec(P),w=/Mobile/i.exec(P),p=!!/Win64/.exec(P),O){e=O[1]?parseFloat(O[1]):O[5]?parseFloat(O[5]):NaN,e&&document&&document.documentMode&&(e=document.documentMode);var D=/(?:Trident\/(\d+.\d+))/.exec(P);o=D?parseFloat(D[1])+4:e,t=O[2]?parseFloat(O[2]):NaN,r=O[3]?parseFloat(O[3]):NaN,s=O[4]?parseFloat(O[4]):NaN,s?(O=/(?:Chrome\/(\d+\.\d+))/.exec(P),a=O&&O[1]?parseFloat(O[1]):NaN):a=NaN}else e=t=r=a=s=NaN;if(M){if(M[1]){var I=/(?:Mac OS X (\d+(?:[._]\d+)?))/.exec(P);l=I?parseFloat(I[1].replace("_",".")):!0}else l=!1;c=!!M[2],d=!!M[3]}else l=c=d=!1}}var C={ie:function(){return j()||e},ieCompatibilityMode:function(){return j()||o>e},ie64:function(){return C.ie()&&p},firefox:function(){return j()||t},opera:function(){return j()||r},webkit:function(){return j()||s},safari:function(){return C.webkit()},chrome:function(){return j()||a},windows:function(){return j()||c},osx:function(){return j()||l},linux:function(){return j()||d},iphone:function(){return j()||x},mobile:function(){return j()||x||y||h||w},nativeApp:function(){return j()||_},android:function(){return j()||h},ipad:function(){return j()||y}};return kb=C,kb}var Pb,mE;function HX(){if(mE)return Pb;mE=1;var n=!!(typeof window<"u"&&window.document&&window.document.createElement),e={canUseDOM:n,canUseWorkers:typeof Worker<"u",canUseEventListeners:n&&!!(window.addEventListener||window.attachEvent),canUseViewport:n&&!!window.screen,isInWorker:!n};return Pb=e,Pb}var Mb,pE;function YX(){if(pE)return Mb;pE=1;var n=HX(),e;n.canUseDOM&&(e=document.implementation&&document.implementation.hasFeature&&document.implementation.hasFeature("","")!==!0);function t(r,s){if(!n.canUseDOM||s&&!("addEventListener"in document))return!1;var a="on"+r,o=a in document;if(!o){var l=document.createElement("div");l.setAttribute(a,"return;"),o=typeof l[a]=="function"}return!o&&e&&r==="wheel"&&(o=document.implementation.hasFeature("Events.wheel","3.0")),o}return Mb=t,Mb}var Eb,gE;function GX(){if(gE)return Eb;gE=1;var n=$X(),e=YX(),t=10,r=40,s=800;function a(o){var l=0,c=0,d=0,h=0;return"detail"in o&&(c=o.detail),"wheelDelta"in o&&(c=-o.wheelDelta/120),"wheelDeltaY"in o&&(c=-o.wheelDeltaY/120),"wheelDeltaX"in o&&(l=-o.wheelDeltaX/120),"axis"in o&&o.axis===o.HORIZONTAL_AXIS&&(l=c,c=0),d=l*t,h=c*t,"deltaY"in o&&(h=o.deltaY),"deltaX"in o&&(d=o.deltaX),(d||h)&&o.deltaMode&&(o.deltaMode==1?(d*=r,h*=r):(d*=s,h*=s)),d&&!l&&(l=d<1?-1:1),h&&!c&&(c=h<1?-1:1),{spinX:l,spinY:c,pixelX:d,pixelY:h}}return a.getEventType=function(){return n.firefox()?"DOMMouseScroll":e("wheel")?"wheel":"mousewheel"},Eb=a,Eb}var Db,xE;function ZX(){return xE||(xE=1,Db=GX()),Db}var KX=ZX();const JX=bu(KX);function QX(n,e,t,r,s,a){a===void 0&&(a=0);var o=Ff(n,e,a),l=o.width,c=o.height,d=Math.min(l,t),h=Math.min(c,r);return d>h*s?{width:h*s,height:h}:{width:d,height:d/s}}function XX(n){return n.width>n.height?n.width/n.naturalWidth:n.height/n.naturalHeight}function Sh(n,e,t,r,s){s===void 0&&(s=0);var a=Ff(e.width,e.height,s),o=a.width,l=a.height;return{x:yE(n.x,o,t.width,r),y:yE(n.y,l,t.height,r)}}function yE(n,e,t,r){var s=e*r/2-t/2;return py(n,-s,s)}function vE(n,e){return Math.sqrt(Math.pow(n.y-e.y,2)+Math.pow(n.x-e.x,2))}function bE(n,e){return Math.atan2(e.y-n.y,e.x-n.x)*180/Math.PI}function eee(n,e,t,r,s,a,o){a===void 0&&(a=0),o===void 0&&(o=!0);var l=o?tee:nee,c=Ff(e.width,e.height,a),d=Ff(e.naturalWidth,e.naturalHeight,a),h={x:l(100,((c.width-t.width/s)/2-n.x/s)/c.width*100),y:l(100,((c.height-t.height/s)/2-n.y/s)/c.height*100),width:l(100,t.width/c.width*100/s),height:l(100,t.height/c.height*100/s)},p=Math.round(l(d.width,h.width*d.width/100)),x=Math.round(l(d.height,h.height*d.height/100)),y=d.width>=d.height*r,_=y?{width:Math.round(x*r),height:x}:{width:p,height:Math.round(p/r)},w=gr(gr({},_),{x:Math.round(l(d.width-_.width,h.x*d.width/100)),y:Math.round(l(d.height-_.height,h.y*d.height/100))});return{croppedAreaPercentages:h,croppedAreaPixels:w}}function tee(n,e){return Math.min(n,Math.max(0,e))}function nee(n,e){return e}function ree(n,e,t,r,s,a){var o=Ff(e.width,e.height,t),l=py(r.width/o.width*(100/n.width),s,a),c={x:l*o.width/2-r.width/2-o.width*l*(n.x/100),y:l*o.height/2-r.height/2-o.height*l*(n.y/100)};return{crop:c,zoom:l}}function see(n,e,t){var r=XX(e);return t.height>t.width?t.height/(n.height*r):t.width/(n.width*r)}function iee(n,e,t,r,s,a){t===void 0&&(t=0);var o=Ff(e.naturalWidth,e.naturalHeight,t),l=py(see(n,e,r),s,a),c=r.height>r.width?r.height/n.height:r.width/n.width,d={x:((o.width-n.width)/2-n.x)*c,y:((o.height-n.height)/2-n.y)*c};return{crop:d,zoom:l}}function wE(n,e){return{x:(e.x+n.x)/2,y:(e.y+n.y)/2}}function aee(n){return n*Math.PI/180}function Ff(n,e,t){var r=aee(t);return{width:Math.abs(Math.cos(r)*n)+Math.abs(Math.sin(r)*e),height:Math.abs(Math.sin(r)*n)+Math.abs(Math.cos(r)*e)}}function py(n,e,t){return Math.min(Math.max(n,e),t)}function Yp(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return n.filter(function(t){return typeof t=="string"&&t.length>0}).join(" ").trim()}var oee=`.reactEasyCrop_Container {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  overflow: hidden;
  user-select: none;
  touch-action: none;
  cursor: move;
  display: flex;
  justify-content: center;
  align-items: center;
}

.reactEasyCrop_Image,
.reactEasyCrop_Video {
  will-change: transform; /* this improves performances and prevent painting issues on iOS Chrome */
}

.reactEasyCrop_Contain {
  max-width: 100%;
  max-height: 100%;
  margin: auto;
  position: absolute;
  top: 0;
  bottom: 0;
  left: 0;
  right: 0;
}
.reactEasyCrop_Cover_Horizontal {
  width: 100%;
  height: auto;
}
.reactEasyCrop_Cover_Vertical {
  width: auto;
  height: 100%;
}

.reactEasyCrop_CropArea {
  position: absolute;
  left: 50%;
  top: 50%;
  transform: translate(-50%, -50%);
  border: 1px solid rgba(255, 255, 255, 0.5);
  box-sizing: border-box;
  box-shadow: 0 0 0 9999em;
  color: rgba(0, 0, 0, 0.5);
  overflow: hidden;
}

.reactEasyCrop_CropAreaRound {
  border-radius: 50%;
}

.reactEasyCrop_CropAreaGrid::before {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 0;
  bottom: 0;
  left: 33.33%;
  right: 33.33%;
  border-top: 0;
  border-bottom: 0;
}

.reactEasyCrop_CropAreaGrid::after {
  content: ' ';
  box-sizing: border-box;
  position: absolute;
  border: 1px solid rgba(255, 255, 255, 0.5);
  top: 33.33%;
  bottom: 33.33%;
  left: 0;
  right: 0;
  border-left: 0;
  border-right: 0;
}
`,lee=1,cee=3,dee=1,uee=(function(n){i1(e,n);function e(){var t=n!==null&&n.apply(this,arguments)||this;return t.cropperRef=E.createRef(),t.imageRef=E.createRef(),t.videoRef=E.createRef(),t.containerPosition={x:0,y:0},t.containerRef=null,t.styleRef=null,t.containerRect=null,t.mediaSize={width:0,height:0,naturalWidth:0,naturalHeight:0},t.dragStartPosition={x:0,y:0},t.dragStartCrop={x:0,y:0},t.gestureZoomStart=0,t.gestureRotationStart=0,t.isTouching=!1,t.lastPinchDistance=0,t.lastPinchRotation=0,t.rafDragTimeout=null,t.rafPinchTimeout=null,t.wheelTimer=null,t.currentDoc=typeof document<"u"?document:null,t.currentWindow=typeof window<"u"?window:null,t.resizeObserver=null,t.previousCropSize=null,t.isInitialized=!1,t.state={cropSize:null,hasWheelJustStarted:!1,mediaObjectFit:void 0},t.initResizeObserver=function(){if(!(typeof window.ResizeObserver>"u"||!t.containerRef)){var r=!0;t.resizeObserver=new window.ResizeObserver(function(s){if(r){r=!1;return}t.computeSizes()}),t.resizeObserver.observe(t.containerRef)}},t.preventZoomSafari=function(r){return r.preventDefault()},t.cleanEvents=function(){t.currentDoc&&(t.currentDoc.removeEventListener("mousemove",t.onMouseMove),t.currentDoc.removeEventListener("mouseup",t.onDragStopped),t.currentDoc.removeEventListener("touchmove",t.onTouchMove),t.currentDoc.removeEventListener("touchend",t.onDragStopped),t.currentDoc.removeEventListener("gesturechange",t.onGestureChange),t.currentDoc.removeEventListener("gestureend",t.onGestureEnd),t.currentDoc.removeEventListener("scroll",t.onScroll))},t.clearScrollEvent=function(){t.containerRef&&t.containerRef.removeEventListener("wheel",t.onWheel),t.wheelTimer&&clearTimeout(t.wheelTimer)},t.onMediaLoad=function(){var r=t.computeSizes();r&&(t.previousCropSize=r,t.emitCropData(),t.setInitialCrop(r),t.isInitialized=!0),t.props.onMediaLoaded&&t.props.onMediaLoaded(t.mediaSize)},t.setInitialCrop=function(r){if(t.props.initialCroppedAreaPercentages){var s=ree(t.props.initialCroppedAreaPercentages,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=s.crop,o=s.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}else if(t.props.initialCroppedAreaPixels){var l=iee(t.props.initialCroppedAreaPixels,t.mediaSize,t.props.rotation,r,t.props.minZoom,t.props.maxZoom),a=l.crop,o=l.zoom;t.props.onCropChange(a),t.props.onZoomChange&&t.props.onZoomChange(o)}},t.computeSizes=function(){var r,s,a,o,l,c,d=t.imageRef.current||t.videoRef.current;if(d&&t.containerRef){t.containerRect=t.containerRef.getBoundingClientRect(),t.saveContainerPosition();var h=t.containerRect.width/t.containerRect.height,p=((r=t.imageRef.current)===null||r===void 0?void 0:r.naturalWidth)||((s=t.videoRef.current)===null||s===void 0?void 0:s.videoWidth)||0,x=((a=t.imageRef.current)===null||a===void 0?void 0:a.naturalHeight)||((o=t.videoRef.current)===null||o===void 0?void 0:o.videoHeight)||0,y=d.offsetWidth<p||d.offsetHeight<x,_=p/x,w=void 0;if(y)switch(t.state.mediaObjectFit){default:case"contain":w=h>_?{width:t.containerRect.height*_,height:t.containerRect.height}:{width:t.containerRect.width,height:t.containerRect.width/_};break;case"horizontal-cover":w={width:t.containerRect.width,height:t.containerRect.width/_};break;case"vertical-cover":w={width:t.containerRect.height*_,height:t.containerRect.height};break}else w={width:d.offsetWidth,height:d.offsetHeight};t.mediaSize=gr(gr({},w),{naturalWidth:p,naturalHeight:x}),t.props.setMediaSize&&t.props.setMediaSize(t.mediaSize);var j=t.props.cropSize?t.props.cropSize:QX(t.mediaSize.width,t.mediaSize.height,t.containerRect.width,t.containerRect.height,t.props.aspect,t.props.rotation);return(((l=t.state.cropSize)===null||l===void 0?void 0:l.height)!==j.height||((c=t.state.cropSize)===null||c===void 0?void 0:c.width)!==j.width)&&t.props.onCropSizeChange&&t.props.onCropSizeChange(j),t.setState({cropSize:j},t.recomputeCropPosition),t.props.setCropSize&&t.props.setCropSize(j),j}},t.saveContainerPosition=function(){if(t.containerRef){var r=t.containerRef.getBoundingClientRect();t.containerPosition={x:r.left,y:r.top}}},t.onMouseDown=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("mousemove",t.onMouseMove),t.currentDoc.addEventListener("mouseup",t.onDragStopped),t.saveContainerPosition(),t.onDragStart(e.getMousePoint(r)))},t.onMouseMove=function(r){return t.onDrag(e.getMousePoint(r))},t.onScroll=function(r){t.currentDoc&&(r.preventDefault(),t.saveContainerPosition())},t.onTouchStart=function(r){t.currentDoc&&(t.isTouching=!0,!(t.props.onTouchRequest&&!t.props.onTouchRequest(r))&&(t.currentDoc.addEventListener("touchmove",t.onTouchMove,{passive:!1}),t.currentDoc.addEventListener("touchend",t.onDragStopped),t.saveContainerPosition(),r.touches.length===2?t.onPinchStart(r):r.touches.length===1&&t.onDragStart(e.getTouchPoint(r.touches[0]))))},t.onTouchMove=function(r){r.preventDefault(),r.touches.length===2?t.onPinchMove(r):r.touches.length===1&&t.onDrag(e.getTouchPoint(r.touches[0]))},t.onGestureStart=function(r){t.currentDoc&&(r.preventDefault(),t.currentDoc.addEventListener("gesturechange",t.onGestureChange),t.currentDoc.addEventListener("gestureend",t.onGestureEnd),t.gestureZoomStart=t.props.zoom,t.gestureRotationStart=t.props.rotation)},t.onGestureChange=function(r){if(r.preventDefault(),!t.isTouching){var s=e.getMousePoint(r),a=t.gestureZoomStart-1+r.scale;if(t.setNewZoom(a,s,{shouldUpdatePosition:!0}),t.props.onRotationChange){var o=t.gestureRotationStart+r.rotation;t.props.onRotationChange(o)}}},t.onGestureEnd=function(r){t.cleanEvents()},t.onDragStart=function(r){var s,a,o=r.x,l=r.y;t.dragStartPosition={x:o,y:l},t.dragStartCrop=gr({},t.props.crop),(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s)},t.onDrag=function(r){var s=r.x,a=r.y;t.currentWindow&&(t.rafDragTimeout&&t.currentWindow.cancelAnimationFrame(t.rafDragTimeout),t.rafDragTimeout=t.currentWindow.requestAnimationFrame(function(){if(t.state.cropSize&&!(s===void 0||a===void 0)){var o=s-t.dragStartPosition.x,l=a-t.dragStartPosition.y,c={x:t.dragStartCrop.x+o,y:t.dragStartCrop.y+l},d=t.props.restrictPosition?Sh(c,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):c;t.props.onCropChange(d)}}))},t.onDragStopped=function(){var r,s;t.isTouching=!1,t.cleanEvents(),t.emitCropData(),(s=(r=t.props).onInteractionEnd)===null||s===void 0||s.call(r)},t.onWheel=function(r){if(t.currentWindow&&!(t.props.onWheelRequest&&!t.props.onWheelRequest(r))){r.preventDefault();var s=e.getMousePoint(r),a=JX(r).pixelY,o=t.props.zoom-a*t.props.zoomSpeed/200;t.setNewZoom(o,s,{shouldUpdatePosition:!0}),t.state.hasWheelJustStarted||t.setState({hasWheelJustStarted:!0},function(){var l,c;return(c=(l=t.props).onInteractionStart)===null||c===void 0?void 0:c.call(l)}),t.wheelTimer&&clearTimeout(t.wheelTimer),t.wheelTimer=t.currentWindow.setTimeout(function(){return t.setState({hasWheelJustStarted:!1},function(){var l,c;return(c=(l=t.props).onInteractionEnd)===null||c===void 0?void 0:c.call(l)})},250)}},t.getPointOnContainer=function(r,s){var a=r.x,o=r.y;if(!t.containerRect)throw new Error("The Cropper is not mounted");return{x:t.containerRect.width/2-(a-s.x),y:t.containerRect.height/2-(o-s.y)}},t.getPointOnMedia=function(r){var s=r.x,a=r.y,o=t.props,l=o.crop,c=o.zoom;return{x:(s+l.x)/c,y:(a+l.y)/c}},t.setNewZoom=function(r,s,a){var o=a===void 0?{}:a,l=o.shouldUpdatePosition,c=l===void 0?!0:l;if(!(!t.state.cropSize||!t.props.onZoomChange)){var d=py(r,t.props.minZoom,t.props.maxZoom);if(c){var h=t.getPointOnContainer(s,t.containerPosition),p=t.getPointOnMedia(h),x={x:p.x*d-h.x,y:p.y*d-h.y},y=t.props.restrictPosition?Sh(x,t.mediaSize,t.state.cropSize,d,t.props.rotation):x;t.props.onCropChange(y)}t.props.onZoomChange(d)}},t.getCropData=function(){if(!t.state.cropSize)return null;var r=t.props.restrictPosition?Sh(t.props.crop,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):t.props.crop;return eee(r,t.mediaSize,t.state.cropSize,t.getAspect(),t.props.zoom,t.props.rotation,t.props.restrictPosition)},t.emitCropData=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropComplete&&t.props.onCropComplete(s,a),t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.emitCropAreaChange=function(){var r=t.getCropData();if(r){var s=r.croppedAreaPercentages,a=r.croppedAreaPixels;t.props.onCropAreaChange&&t.props.onCropAreaChange(s,a)}},t.recomputeCropPosition=function(){if(t.state.cropSize){var r=t.props.crop;if(t.isInitialized&&t.previousCropSize){var s=Math.abs(t.previousCropSize.width-t.state.cropSize.width)>1e-6||Math.abs(t.previousCropSize.height-t.state.cropSize.height)>1e-6;if(s){var a=t.state.cropSize.width/t.previousCropSize.width,o=t.state.cropSize.height/t.previousCropSize.height;r={x:t.props.crop.x*a,y:t.props.crop.y*o}}}var l=t.props.restrictPosition?Sh(r,t.mediaSize,t.state.cropSize,t.props.zoom,t.props.rotation):r;t.previousCropSize=t.state.cropSize,t.props.onCropChange(l),t.emitCropData()}},t.onKeyDown=function(r){var s,a,o=t.props,l=o.crop,c=o.onCropChange,d=o.keyboardStep,h=o.zoom,p=o.rotation,x=d;if(t.state.cropSize){r.shiftKey&&(x*=.2);var y=gr({},l);switch(r.key){case"ArrowUp":y.y-=x,r.preventDefault();break;case"ArrowDown":y.y+=x,r.preventDefault();break;case"ArrowLeft":y.x-=x,r.preventDefault();break;case"ArrowRight":y.x+=x,r.preventDefault();break;default:return}t.props.restrictPosition&&(y=Sh(y,t.mediaSize,t.state.cropSize,h,p)),r.repeat||(a=(s=t.props).onInteractionStart)===null||a===void 0||a.call(s),c(y)}},t.onKeyUp=function(r){var s,a;switch(r.key){case"ArrowUp":case"ArrowDown":case"ArrowLeft":case"ArrowRight":r.preventDefault();break;default:return}t.emitCropData(),(a=(s=t.props).onInteractionEnd)===null||a===void 0||a.call(s)},t}return e.prototype.componentDidMount=function(){!this.currentDoc||!this.currentWindow||(this.containerRef&&(this.containerRef.ownerDocument&&(this.currentDoc=this.containerRef.ownerDocument),this.currentDoc.defaultView&&(this.currentWindow=this.currentDoc.defaultView),this.initResizeObserver(),typeof window.ResizeObserver>"u"&&this.currentWindow.addEventListener("resize",this.computeSizes),this.props.zoomWithScroll&&this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}),this.containerRef.addEventListener("gesturestart",this.onGestureStart)),this.currentDoc.addEventListener("scroll",this.onScroll),this.props.disableAutomaticStylesInjection||(this.styleRef=this.currentDoc.createElement("style"),this.styleRef.setAttribute("type","text/css"),this.props.nonce&&this.styleRef.setAttribute("nonce",this.props.nonce),this.styleRef.innerHTML=oee,this.currentDoc.head.appendChild(this.styleRef)),this.imageRef.current&&this.imageRef.current.complete&&this.onMediaLoad(),this.props.setImageRef&&this.props.setImageRef(this.imageRef),this.props.setVideoRef&&this.props.setVideoRef(this.videoRef),this.props.setCropperRef&&this.props.setCropperRef(this.cropperRef))},e.prototype.componentWillUnmount=function(){var t,r;!this.currentDoc||!this.currentWindow||(typeof window.ResizeObserver>"u"&&this.currentWindow.removeEventListener("resize",this.computeSizes),(t=this.resizeObserver)===null||t===void 0||t.disconnect(),this.containerRef&&this.containerRef.removeEventListener("gesturestart",this.preventZoomSafari),this.styleRef&&((r=this.styleRef.parentNode)===null||r===void 0||r.removeChild(this.styleRef)),this.cleanEvents(),this.props.zoomWithScroll&&this.clearScrollEvent())},e.prototype.componentDidUpdate=function(t){var r,s,a,o,l,c,d,h,p;t.rotation!==this.props.rotation?(this.computeSizes(),this.recomputeCropPosition()):t.aspect!==this.props.aspect?this.computeSizes():t.objectFit!==this.props.objectFit?this.computeSizes():t.zoom!==this.props.zoom?this.recomputeCropPosition():((r=t.cropSize)===null||r===void 0?void 0:r.height)!==((s=this.props.cropSize)===null||s===void 0?void 0:s.height)||((a=t.cropSize)===null||a===void 0?void 0:a.width)!==((o=this.props.cropSize)===null||o===void 0?void 0:o.width)?this.computeSizes():(((l=t.crop)===null||l===void 0?void 0:l.x)!==((c=this.props.crop)===null||c===void 0?void 0:c.x)||((d=t.crop)===null||d===void 0?void 0:d.y)!==((h=this.props.crop)===null||h===void 0?void 0:h.y))&&this.emitCropAreaChange(),t.zoomWithScroll!==this.props.zoomWithScroll&&this.containerRef&&(this.props.zoomWithScroll?this.containerRef.addEventListener("wheel",this.onWheel,{passive:!1}):this.clearScrollEvent()),t.video!==this.props.video&&((p=this.videoRef.current)===null||p===void 0||p.load());var x=this.getObjectFit();x!==this.state.mediaObjectFit&&this.setState({mediaObjectFit:x},this.computeSizes)},e.prototype.getAspect=function(){var t=this.props,r=t.cropSize,s=t.aspect;return r?r.width/r.height:s},e.prototype.getObjectFit=function(){var t,r,s,a;if(this.props.objectFit==="cover"){var o=this.imageRef.current||this.videoRef.current;if(o&&this.containerRef){this.containerRect=this.containerRef.getBoundingClientRect();var l=this.containerRect.width/this.containerRect.height,c=((t=this.imageRef.current)===null||t===void 0?void 0:t.naturalWidth)||((r=this.videoRef.current)===null||r===void 0?void 0:r.videoWidth)||0,d=((s=this.imageRef.current)===null||s===void 0?void 0:s.naturalHeight)||((a=this.videoRef.current)===null||a===void 0?void 0:a.videoHeight)||0,h=c/d;return h<l?"horizontal-cover":"vertical-cover"}return"horizontal-cover"}return this.props.objectFit},e.prototype.onPinchStart=function(t){var r=e.getTouchPoint(t.touches[0]),s=e.getTouchPoint(t.touches[1]);this.lastPinchDistance=vE(r,s),this.lastPinchRotation=bE(r,s),this.onDragStart(wE(r,s))},e.prototype.onPinchMove=function(t){var r=this;if(!(!this.currentDoc||!this.currentWindow)){var s=e.getTouchPoint(t.touches[0]),a=e.getTouchPoint(t.touches[1]),o=wE(s,a);this.onDrag(o),this.rafPinchTimeout&&this.currentWindow.cancelAnimationFrame(this.rafPinchTimeout),this.rafPinchTimeout=this.currentWindow.requestAnimationFrame(function(){var l=vE(s,a),c=r.props.zoom*(l/r.lastPinchDistance);r.setNewZoom(c,o,{shouldUpdatePosition:!1}),r.lastPinchDistance=l;var d=bE(s,a),h=r.props.rotation+(d-r.lastPinchRotation);r.props.onRotationChange&&r.props.onRotationChange(h),r.lastPinchRotation=d})}},e.prototype.render=function(){var t=this,r,s=this.props,a=s.image,o=s.video,l=s.mediaProps,c=s.cropperProps,d=s.transform,h=s.crop,p=h.x,x=h.y,y=s.rotation,_=s.zoom,w=s.cropShape,j=s.showGrid,C=s.roundCropAreaPixels,P=s.style,O=P.containerStyle,M=P.cropAreaStyle,D=P.mediaStyle,I=s.classes,F=I.containerClassName,q=I.cropAreaClassName,B=I.mediaClassName,U=(r=this.state.mediaObjectFit)!==null&&r!==void 0?r:this.getObjectFit();return E.createElement("div",{onMouseDown:this.onMouseDown,onTouchStart:this.onTouchStart,ref:function(G){return t.containerRef=G},"data-testid":"container",style:O,className:Yp("reactEasyCrop_Container",F)},a?E.createElement("img",gr({alt:"",className:Yp("reactEasyCrop_Image",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",B)},l,{src:a,ref:this.imageRef,style:gr(gr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(y,"deg) scale(").concat(_,")")}),onLoad:this.onMediaLoad})):o&&E.createElement("video",gr({autoPlay:!0,playsInline:!0,loop:!0,muted:!0,className:Yp("reactEasyCrop_Video",U==="contain"&&"reactEasyCrop_Contain",U==="horizontal-cover"&&"reactEasyCrop_Cover_Horizontal",U==="vertical-cover"&&"reactEasyCrop_Cover_Vertical",B)},l,{ref:this.videoRef,onLoadedMetadata:this.onMediaLoad,style:gr(gr({},D),{transform:d||"translate(".concat(p,"px, ").concat(x,"px) rotate(").concat(y,"deg) scale(").concat(_,")")}),controls:!1}),(Array.isArray(o)?o:[{src:o}]).map(function(W){return E.createElement("source",gr({key:W.src},W))})),this.state.cropSize&&E.createElement("div",gr({ref:this.cropperRef,style:gr(gr({},M),{width:C?Math.round(this.state.cropSize.width):this.state.cropSize.width,height:C?Math.round(this.state.cropSize.height):this.state.cropSize.height}),tabIndex:0,onKeyDown:this.onKeyDown,onKeyUp:this.onKeyUp,"data-testid":"cropper",className:Yp("reactEasyCrop_CropArea",w==="round"&&"reactEasyCrop_CropAreaRound",j&&"reactEasyCrop_CropAreaGrid",q)},c)))},e.defaultProps={zoom:1,rotation:0,aspect:4/3,maxZoom:cee,minZoom:lee,cropShape:"rect",objectFit:"contain",showGrid:!0,style:{},classes:{},mediaProps:{},cropperProps:{},zoomSpeed:1,restrictPosition:!0,zoomWithScroll:!0,keyboardStep:dee},e.getMousePoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e.getTouchPoint=function(t){return{x:Number(t.clientX),y:Number(t.clientY)}},e})(E.Component);const fee=n=>new Promise((e,t)=>{const r=new Image;r.addEventListener("load",()=>e(r)),r.addEventListener("error",s=>t(s)),r.src=n});async function hee(n,e){const t=await fee(n),r=document.createElement("canvas"),s=r.getContext("2d");if(!s)throw new Error("No 2d context");return r.width=e.width,r.height=e.height,s.drawImage(t,e.x,e.y,e.width,e.height,0,0,e.width,e.height),r.toDataURL("image/jpeg",.9)}const e5=({isOpen:n,onClose:e,onCapture:t,captureGuidance:r="none"})=>{const s=E.useRef(null),a=E.useRef(null),o=E.useRef(null),[l,c]=E.useState(null),[d,h]=E.useState(null),[p,x]=E.useState(!1),[y,_]=E.useState(""),[w,j]=E.useState(!1),[C,P]=E.useState({x:0,y:0}),[O,M]=E.useState(1),[D,I]=E.useState(null),[F,q]=E.useState(null),[B,U]=E.useState([]),[W,G]=E.useState(0),[Z,Y]=E.useState(!1),[ae,ee]=E.useState(!1),[me,$]=E.useState(!1),[K,re]=E.useState(!1),[H,se]=E.useState(),ie=E.useCallback(()=>{o.current&&(o.current.getTracks().forEach(ve=>ve.stop()),o.current=null)},[]),ce=E.useCallback(async ve=>{ie(),c(null),j(!1),Y(!1);try{const Oe={video:ve?{deviceId:{exact:ve}}:{facingMode:"environment"}},Ve=await navigator.mediaDevices.getUserMedia(Oe);o.current=Ve,s.current&&(s.current.srcObject=Ve),h(null);const qe=Ve.getVideoTracks()[0];if(qe){const X=qe.getCapabilities();ee(!!X.torch),se(qe.getSettings().facingMode)}else ee(!1)}catch(Oe){console.error("Error accessing camera:",Oe),h("Could not access camera. Please check permissions.")}},[ie]);E.useEffect(()=>{if(!n){ie();return}let ve=!1;return(async()=>{try{const Ve=await navigator.mediaDevices.getUserMedia({video:!0});if(ve){Ve.getTracks().forEach(le=>le.stop());return}const X=(await navigator.mediaDevices.enumerateDevices()).filter(le=>le.kind==="videoinput");if(Ve.getTracks().forEach(le=>le.stop()),ve)return;if(U(X),X.length>0){let le=W;le>=X.length&&(le=0),await ce(X[le].deviceId)}else h("No camera found.")}catch(Ve){console.error(Ve),h("Could not access camera.")}})(),()=>{ve=!0,ie()}},[n,W,ce,ie]);const oe=()=>{if(s.current&&a.current){const ve=s.current,Oe=a.current;Oe.width=ve.videoWidth,Oe.height=ve.videoHeight,Oe.getContext("2d")?.drawImage(ve,0,0,ve.videoWidth,ve.videoHeight),c(Oe.toDataURL("image/jpeg",.9)),ie()}},de=()=>{H==="user"&&me?(re(!0),setTimeout(()=>{oe(),re(!1)},100)):oe()},te=()=>{h(null),c(null),q(null),j(!1),M(1)},ye=async()=>{if(!o.current||!ae)return;const ve=o.current.getVideoTracks()[0];try{await ve.applyConstraints({advanced:[{torch:!Z}]}),Y(!Z)}catch(Oe){console.error("Failed to toggle flash",Oe)}},Ce=E.useCallback((ve,Oe)=>{I(Oe)},[]),Re=()=>{j(!0),M(1)},Te=async()=>{try{if(l&&D){const ve=await hee(l,D);q(ve),j(!1)}}catch(ve){console.error(ve),h("Failed to crop image")}},je=()=>{j(!1),M(1),q(null)},ke=async()=>{const ve=F||l;if(ve){x(!0);try{const Oe=ve.split(",")[1];_("Enhancing photo...");const qe=(r==="document"?await ue.enhanceDocumentPhoto(Oe,"image/jpeg"):null)||Oe;t(qe,"image/jpeg"),e()}catch(Oe){h(Oe.message||"Processing failed.")}finally{x(!1)}}},Ue=()=>{ie(),e()};if(!n)return null;const Ye=F||l;return i.jsxs("div",{className:"fixed inset-0 z-[200] flex flex-col bg-black text-white",children:[K&&i.jsx("div",{className:"absolute inset-0 bg-white z-50"}),p&&i.jsxs("div",{className:"absolute inset-0 z-40 flex flex-col items-center justify-center bg-black/80",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-white"}),i.jsx("p",{className:"mt-4 text-lg font-semibold",children:y})]}),i.jsxs("div",{className:"absolute top-0 left-0 right-0 p-4 bg-gradient-to-b from-black/70 to-transparent z-30 flex justify-between items-center",children:[i.jsx(ne,{variant:"icon",className:"!text-white hover:!bg-white/20 !p-2",onClick:Ue,children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h3",{className:"text-lg font-bold flex-1 text-center",children:w?"Crop Photo":l?"Preview":"Capture Photo"}),i.jsx("div",{className:"w-10"})]}),i.jsxs("div",{className:"flex-grow relative flex items-center justify-center overflow-hidden bg-black",children:[d&&!l&&i.jsx("div",{className:"absolute inset-0 flex items-center justify-center text-white p-4 text-center bg-black/50 z-10",children:d}),w&&l?i.jsx("div",{className:"absolute inset-0",children:i.jsx(uee,{image:l,crop:C,zoom:O,aspect:r==="profile"?1:4/3,onCropChange:P,onCropComplete:Ce,onZoomChange:M,cropShape:r==="profile"?"round":"rect",style:{containerStyle:{backgroundColor:"transparent"},mediaStyle:{objectFit:"contain"}},classes:{containerClassName:"bg-black/30"}})}):i.jsxs(i.Fragment,{children:[i.jsx("video",{ref:s,autoPlay:!0,playsInline:!0,muted:!0,className:`w-full h-full object-cover ${l?"hidden":""}`}),Ye&&i.jsx("img",{src:Ye,alt:"Preview",className:"w-full h-full object-contain"})]}),i.jsx("canvas",{ref:a,className:"hidden"})]}),i.jsxs("div",{className:"absolute bottom-0 left-0 right-0 p-6 bg-gradient-to-t from-black/80 to-transparent z-30",children:[d&&!l&&i.jsx("div",{className:"mb-2 p-3 bg-red-500/30 text-white text-sm rounded-lg text-center",children:d}),w&&i.jsx("div",{className:"mb-4 px-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(D1,{className:"h-5 w-5 text-white/70"}),i.jsx("input",{type:"range",min:1,max:3,step:.1,value:O,onChange:ve=>M(Number(ve.target.value)),className:"flex-1 h-1 bg-white/20 rounded-lg"}),i.jsx(E1,{className:"h-5 w-5 text-white/70"})]})}),i.jsx("div",{className:"flex justify-around items-center",children:w?i.jsxs(i.Fragment,{children:[i.jsx(ne,{onClick:je,variant:"secondary",size:"lg",className:"!rounded-full !px-6",children:"Cancel"}),i.jsxs(ne,{onClick:Te,size:"lg",className:"!rounded-full !px-6",children:[i.jsx(jl,{className:"h-5 w-5 mr-2"})," Apply"]})]}):l?i.jsxs(i.Fragment,{children:[i.jsx(ne,{onClick:te,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(IS,{className:"h-6 w-6"})}),i.jsx(ne,{onClick:Re,variant:"secondary",size:"lg",className:"!rounded-full !p-4",children:i.jsx(mJ,{className:"h-6 w-6"})}),i.jsx(ne,{onClick:ke,size:"lg",className:"!rounded-full !p-4",children:i.jsx(jl,{className:"h-6 w-6"})})]}):i.jsxs(i.Fragment,{children:[i.jsxs("div",{className:"w-16 h-16 flex items-center justify-center",children:[H==="environment"&&ae&&i.jsx(ne,{onClick:ye,variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:Z?i.jsx(UJ,{className:"h-6 w-6"}):i.jsx(AS,{className:"h-6 w-6"})}),H==="user"&&i.jsx(ne,{onClick:()=>$(!me),variant:"icon",className:`!rounded-full !p-3 ${me?"!text-yellow-400":"!text-white"} hover:!bg-white/20`,children:i.jsx(g3,{className:"h-6 w-6"})})]}),i.jsx(ne,{onClick:de,disabled:!!d||!o.current,size:"lg",className:"!rounded-full !w-20 !h-20",children:i.jsx(C1,{className:"h-8 w-8"})}),i.jsx("div",{className:"w-16 h-16 flex items-center justify-center",children:B.length>1&&i.jsx(ne,{onClick:()=>G(ve=>(ve+1)%B.length),variant:"icon",className:"!text-white hover:!bg-white/20 !rounded-full !p-3",children:i.jsx(IS,{className:"h-6 w-6"})})})]})})]})]})},mee=({isOpen:n,onClose:e,imageUrl:t})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-80 p-4",onClick:e,role:"dialog","aria-modal":"true",children:i.jsxs("div",{className:"relative w-full h-full flex items-center justify-center",onClick:r=>r.stopPropagation(),children:[i.jsx("img",{src:t,alt:"Document Preview",className:"max-w-full max-h-full object-contain rounded-lg"}),i.jsx("button",{onClick:e,className:"absolute top-0 right-0 m-2 p-2 bg-black/50 rounded-full text-white hover:bg-black/80 transition-colors","aria-label":"Close image preview",children:i.jsx(vi,{className:"h-6 w-6"})})]})}):null,vt=({label:n,file:e,onFileChange:t,allowedTypes:r=["image/jpeg","image/png","application/pdf"],error:s,allowCapture:a=!1,costingItemName:o,verificationStatus:l,onOcrComplete:c,ocrSchema:d,setToast:h,docType:p,onVerification:x})=>{const[y,_]=E.useState(!1),[w,j]=E.useState(""),[C,P]=E.useState(!1),[O,M]=E.useState(!1),{logVerificationUsage:D}=Yn.getState(),I=E.useMemo(()=>{const Y=n.toLowerCase();return Y.includes("photo")?"profile":["proof","document","card","slip","passbook","cheque","certificate"].some(ae=>Y.includes(ae))?"document":"none"},[n]),F=E.useCallback(async Y=>{if(!r.includes(Y.type)){j(`Invalid file type. Allowed: ${r.join(", ")}.`);return}if(Y.size>5*1024*1024){j("File size must be less than 5MB.");return}j(""),_(!0);const ae=URL.createObjectURL(Y);let ee={name:Y.name,type:Y.type,size:Y.size,preview:ae,file:Y};t(ee),o&&D(o);try{const me=new FileReader;me.readAsDataURL(Y),me.onloadend=async()=>{try{const $=me.result.split(",")[1];if(x){const K=await x($,Y.type);if(!K.success){j(K.reason),_(!1);return}}if(c&&d&&h)try{const K=await ue.extractDataFromImage($,Y.type,d,p);c(K)}catch(K){console.error("OCR failed:",K),h({message:"AI extraction failed. Please check the document.",type:"error"})}}catch($){j($.message||"Processing failed.")}finally{_(!1)}},me.onerror=()=>{throw new Error("Could not read file for processing.")}}catch(me){j(me.message||"Processing failed."),_(!1)}},[r,t,o,D,c,d,h,p,x]),q=E.useCallback(async(Y,ae)=>{const ee=await(await fetch(`data:${ae};base64,${Y}`)).blob(),me=new File([ee],`capture-${Date.now()}.jpg`,{type:ae});F(me)},[F]),B=()=>{e&&URL.revokeObjectURL(e.preview),t(null),j("")},U=`file-upload-${n.replace(/\s+/g,"-")}`,W=s||w,Z=(Y=>{const ae=Y.toLowerCase();return ae.includes("profile photo")?Pl:ae.includes("id proof")||ae.includes("aadhaar")||ae.includes("pan")||ae.includes("voter")?n3:ae.includes("bank proof")?Tl:ae.includes("signature")?ES:ae.includes("fingerprint")?s3:ae.includes("certificate")?i3:us})(n);return i.jsxs("div",{className:"w-full",children:[i.jsx(mee,{isOpen:O,onClose:()=>M(!1),imageUrl:e?.preview||""}),C&&i.jsx(e5,{isOpen:C,onClose:()=>P(!1),onCapture:q,captureGuidance:I}),i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx("label",{className:"block text-sm font-medium text-muted",htmlFor:U,children:n}),l===!0&&i.jsx("span",{title:"Verified",children:i.jsx(Ki,{className:"h-4 w-4 text-green-400"})}),l===!1&&i.jsx("span",{title:"Verification Failed",children:i.jsx(gm,{className:"h-4 w-4 text-red-400"})})]}),i.jsx("div",{className:"w-full text-center transition-all duration-300",children:e?i.jsxs("div",{className:"w-full flex flex-col h-full bg-page p-2 border border-border rounded-lg relative pro-dark-theme:bg-[#0d2c18] pro-dark-theme:border-[#123820]",children:[i.jsxs("div",{className:"flex-grow w-full rounded-md overflow-hidden group relative bg-black/10 flex items-center justify-center min-h-[100px]",children:[y?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):e.type.startsWith("image/")?i.jsx("img",{src:e.preview,alt:"preview",className:"max-w-full max-h-28 object-contain"}):i.jsxs("div",{className:"text-muted p-2",children:[i.jsx(vJ,{className:"h-10 w-10 mx-auto"}),i.jsx("span",{className:"text-xs mt-1 block break-all",children:e.name})]}),i.jsx("label",{htmlFor:U,className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center rounded-md cursor-pointer",children:i.jsx(IS,{className:"h-6 w-6 text-white"})})]}),i.jsxs("div",{className:"mt-2 flex items-center justify-center gap-2 flex-shrink-0",children:[e.type.startsWith("image/")&&i.jsxs("button",{type:"button",onClick:()=>M(!0),className:"text-xs font-medium text-accent hover:underline flex items-center gap-1 p-1",children:[i.jsx(Cl,{className:"h-3 w-3"})," View"]}),i.jsxs("button",{type:"button",onClick:B,className:"text-xs font-medium text-red-500 hover:underline flex items-center gap-1 p-1",children:[i.jsx(rn,{className:"h-3 w-3"})," Remove"]})]})]}):i.jsxs("label",{htmlFor:U,className:`
                        cursor-pointer flex flex-col items-center justify-center
                        p-6 border-2 border-dashed rounded-lg transition-colors
                        border-border hover:border-accent hover:bg-accent-light
                        pro-dark-theme:border-gray-600 pro-dark-theme:hover:border-accent pro-dark-theme:hover:bg-accent-light
                        ${W?"!border-red-500":""}
                    `,children:[i.jsx("div",{className:"p-3 bg-accent-light rounded-full text-accent-dark pro-dark-theme:bg-accent/20 pro-dark-theme:text-accent",children:i.jsx(Z,{className:"h-8 w-8"})}),i.jsx("p",{className:"font-semibold text-primary-text mt-2",children:"Click to upload"}),i.jsx("p",{className:"text-xs text-muted mt-1",children:"or drag & drop"}),a&&i.jsxs(i.Fragment,{children:[i.jsx("span",{className:"text-xs text-muted my-2",children:"OR"}),i.jsxs(ne,{type:"button",onClick:Y=>{Y.preventDefault(),P(!0)},variant:"secondary",size:"sm",children:[i.jsx(C1,{className:"h-4 w-4 mr-2"}),"Capture with Camera"]})]})]})}),i.jsx("input",{id:U,type:"file",className:"sr-only",onChange:Y=>Y.target.files?.[0]&&F(Y.target.files[0]),accept:r.join(",")}),i.jsx("div",{className:"text-center mt-1 min-h-[16px]",children:W&&i.jsx("p",{className:"text-xs text-red-500",children:W})})]})};var Ob={},Ch={},Ib={exports:{}},Ab,_E;function pee(){if(_E)return Ab;_E=1;var n="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return Ab=n,Ab}var Rb,jE;function gee(){if(jE)return Rb;jE=1;var n=pee();function e(){}function t(){}return t.resetWarningCache=e,Rb=function(){function r(o,l,c,d,h,p){if(p!==n){var x=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw x.name="Invariant Violation",x}}r.isRequired=r;function s(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:s,element:r,elementType:r,instanceOf:s,node:r,objectOf:s,oneOf:s,oneOfType:s,shape:s,exact:s,checkPropTypes:t,resetWarningCache:e};return a.PropTypes=a,a},Rb}var NE;function El(){return NE||(NE=1,Ib.exports=gee()()),Ib.exports}var Th={},Hd={},Lb={exports:{}};var SE;function Nu(){return SE||(SE=1,(function(n){(function(){var e={}.hasOwnProperty;function t(){for(var a="",o=0;o<arguments.length;o++){var l=arguments[o];l&&(a=s(a,r(l)))}return a}function r(a){if(typeof a=="string"||typeof a=="number")return a;if(typeof a!="object")return"";if(Array.isArray(a))return t.apply(null,a);if(a.toString!==Object.prototype.toString&&!a.toString.toString().includes("[native code]"))return a.toString();var o="";for(var l in a)e.call(a,l)&&a[l]&&(o=s(o,l));return o}function s(a,o){return o?a?a+" "+o:a+o:a}n.exports?(t.default=t,n.exports=t):window.classNames=t})()})(Lb)),Lb.exports}var Fb={},qb={},zb={},Ub={},CE;function Fe(){if(CE)return Ub;CE=1,Ub.toDate=n;function n(e){const t=Object.prototype.toString.call(e);return e instanceof Date||typeof e=="object"&&t==="[object Date]"?new e.constructor(+e):typeof e=="number"||t==="[object Number]"||typeof e=="string"||t==="[object String]"?new Date(e):new Date(NaN)}return Ub}var Bb={},TE;function fn(){if(TE)return Bb;TE=1,Bb.constructFrom=n;function n(e,t){return e instanceof Date?new e.constructor(t):new Date(t)}return Bb}var kE;function Dl(){if(kE)return zb;kE=1,zb.addDays=t;var n=Fe(),e=fn();function t(r,s){const a=(0,n.toDate)(r);return isNaN(s)?(0,e.constructFrom)(r,NaN):(s&&a.setDate(a.getDate()+s),a)}return zb}var Vb={},PE;function Am(){if(PE)return Vb;PE=1,Vb.addMonths=t;var n=Fe(),e=fn();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(s))return(0,e.constructFrom)(r,NaN);if(!s)return a;const o=a.getDate(),l=(0,e.constructFrom)(r,a.getTime());l.setMonth(a.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(a.setFullYear(l.getFullYear(),l.getMonth(),o),a)}return Vb}var ME;function t5(){if(ME)return qb;ME=1,qb.add=s;var n=Dl(),e=Am(),t=fn(),r=Fe();function s(a,o){const{years:l=0,months:c=0,weeks:d=0,days:h=0,hours:p=0,minutes:x=0,seconds:y=0}=o,_=(0,r.toDate)(a),w=c||l?(0,e.addMonths)(_,c+l*12):_,j=h||d?(0,n.addDays)(w,h+d*7):w,C=x+p*60,O=(y+C*60)*1e3;return(0,t.constructFrom)(a,j.getTime()+O)}return qb}var Wb={},$b={},EE;function n5(){if(EE)return $b;EE=1,$b.isSaturday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===6}return $b}var Hb={},DE;function r5(){if(DE)return Hb;DE=1,Hb.isSunday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===0}return Hb}var Yb={},OE;function gy(){if(OE)return Yb;OE=1,Yb.isWeekend=e;var n=Fe();function e(t){const r=(0,n.toDate)(t).getDay();return r===0||r===6}return Yb}var IE;function s5(){if(IE)return Wb;IE=1,Wb.addBusinessDays=a;var n=fn(),e=n5(),t=r5(),r=gy(),s=Fe();function a(o,l){const c=(0,s.toDate)(o),d=(0,r.isWeekend)(c);if(isNaN(l))return(0,n.constructFrom)(o,NaN);const h=c.getHours(),p=l<0?-1:1,x=Math.trunc(l/5);c.setDate(c.getDate()+x*7);let y=Math.abs(l%5);for(;y>0;)c.setDate(c.getDate()+p),(0,r.isWeekend)(c)||(y-=1);return d&&(0,r.isWeekend)(c)&&l!==0&&((0,e.isSaturday)(c)&&c.setDate(c.getDate()+(p<0?2:-1)),(0,t.isSunday)(c)&&c.setDate(c.getDate()+(p<0?1:-2))),c.setHours(h),c}return Wb}var Gb={},Zb={},AE;function Rm(){if(AE)return Zb;AE=1,Zb.addMilliseconds=t;var n=Fe(),e=fn();function t(r,s){const a=+(0,n.toDate)(r);return(0,e.constructFrom)(r,a+s)}return Zb}var It={},RE;function Xt(){if(RE)return It;RE=1,It.secondsInYear=It.secondsInWeek=It.secondsInQuarter=It.secondsInMonth=It.secondsInMinute=It.secondsInHour=It.secondsInDay=It.quartersInYear=It.monthsInYear=It.monthsInQuarter=It.minutesInYear=It.minutesInMonth=It.minutesInHour=It.minutesInDay=It.minTime=It.millisecondsInWeek=It.millisecondsInSecond=It.millisecondsInMinute=It.millisecondsInHour=It.millisecondsInDay=It.maxTime=It.daysInYear=It.daysInWeek=void 0,It.daysInWeek=7;const n=It.daysInYear=365.2425,e=It.maxTime=Math.pow(10,8)*24*60*60*1e3;It.minTime=-e,It.millisecondsInWeek=6048e5,It.millisecondsInDay=864e5,It.millisecondsInMinute=6e4,It.millisecondsInHour=36e5,It.millisecondsInSecond=1e3,It.minutesInYear=525600,It.minutesInMonth=43200,It.minutesInDay=1440,It.minutesInHour=60,It.monthsInQuarter=3,It.monthsInYear=12,It.quartersInYear=4;const t=It.secondsInHour=3600;It.secondsInMinute=60;const r=It.secondsInDay=t*24;It.secondsInWeek=r*7;const s=It.secondsInYear=r*n,a=It.secondsInMonth=s/12;return It.secondsInQuarter=a*3,It}var LE;function U1(){if(LE)return Gb;LE=1,Gb.addHours=t;var n=Rm(),e=Xt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInHour)}return Gb}var Kb={},Jb={},Qb={},Xb={},Gp={},FE;function Ts(){if(FE)return Gp;FE=1,Gp.getDefaultOptions=e,Gp.setDefaultOptions=t;let n={};function e(){return n}function t(r){n=r}return Gp}var qE;function Po(){if(qE)return Xb;qE=1,Xb.startOfWeek=t;var n=Fe(),e=Ts();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?7:0)+c-o;return l.setDate(l.getDate()-d),l.setHours(0,0,0,0),l}return Xb}var zE;function Ol(){if(zE)return Qb;zE=1,Qb.startOfISOWeek=e;var n=Po();function e(t){return(0,n.startOfWeek)(t,{weekStartsOn:1})}return Qb}var UE;function Su(){if(UE)return Jb;UE=1,Jb.getISOWeekYear=r;var n=fn(),e=Ol(),t=Fe();function r(s){const a=(0,t.toDate)(s),o=a.getFullYear(),l=(0,n.constructFrom)(s,0);l.setFullYear(o+1,0,4),l.setHours(0,0,0,0);const c=(0,e.startOfISOWeek)(l),d=(0,n.constructFrom)(s,0);d.setFullYear(o,0,4),d.setHours(0,0,0,0);const h=(0,e.startOfISOWeek)(d);return a.getTime()>=c.getTime()?o+1:a.getTime()>=h.getTime()?o:o-1}return Jb}var e0={},t0={},n0={},BE;function xy(){if(BE)return n0;BE=1,n0.startOfDay=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setHours(0,0,0,0),r}return n0}var r0={},VE;function sd(){if(VE)return r0;VE=1,r0.getTimezoneOffsetInMilliseconds=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=new Date(Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));return s.setUTCFullYear(r.getFullYear()),+t-+s}return r0}var WE;function id(){if(WE)return t0;WE=1,t0.differenceInCalendarDays=r;var n=Xt(),e=xy(),t=sd();function r(s,a){const o=(0,e.startOfDay)(s),l=(0,e.startOfDay)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInDay)}return t0}var s0={},$E;function Lm(){if($E)return s0;$E=1,s0.startOfISOWeekYear=r;var n=Su(),e=Ol(),t=fn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);return o.setFullYear(a,0,4),o.setHours(0,0,0,0),(0,e.startOfISOWeek)(o)}return s0}var HE;function i5(){if(HE)return e0;HE=1,e0.setISOWeekYear=s;var n=fn(),e=id(),t=Lm(),r=Fe();function s(a,o){let l=(0,r.toDate)(a);const c=(0,e.differenceInCalendarDays)(l,(0,t.startOfISOWeekYear)(l)),d=(0,n.constructFrom)(a,0);return d.setFullYear(o,0,4),d.setHours(0,0,0,0),l=(0,t.startOfISOWeekYear)(d),l.setDate(l.getDate()+c),l}return e0}var YE;function a5(){if(YE)return Kb;YE=1,Kb.addISOWeekYears=t;var n=Su(),e=i5();function t(r,s){return(0,e.setISOWeekYear)(r,(0,n.getISOWeekYear)(r)+s)}return Kb}var i0={},GE;function B1(){if(GE)return i0;GE=1,i0.addMinutes=t;var n=Rm(),e=Xt();function t(r,s){return(0,n.addMilliseconds)(r,s*e.millisecondsInMinute)}return i0}var a0={},ZE;function V1(){if(ZE)return a0;ZE=1,a0.addQuarters=e;var n=Am();function e(t,r){const s=r*3;return(0,n.addMonths)(t,s)}return a0}var o0={},KE;function o5(){if(KE)return o0;KE=1,o0.addSeconds=e;var n=Rm();function e(t,r){return(0,n.addMilliseconds)(t,r*1e3)}return o0}var l0={},JE;function yy(){if(JE)return l0;JE=1,l0.addWeeks=e;var n=Dl();function e(t,r){const s=r*7;return(0,n.addDays)(t,s)}return l0}var c0={},QE;function l5(){if(QE)return c0;QE=1,c0.addYears=e;var n=Am();function e(t,r){return(0,n.addMonths)(t,r*12)}return c0}var d0={},XE;function xee(){if(XE)return d0;XE=1,d0.areIntervalsOverlapping=e;var n=Fe();function e(t,r,s){const[a,o]=[+(0,n.toDate)(t.start),+(0,n.toDate)(t.end)].sort((d,h)=>d-h),[l,c]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((d,h)=>d-h);return s?.inclusive?a<=c&&l<=o:a<c&&l<o}return d0}var u0={},f0={},e2;function c5(){if(e2)return f0;e2=1,f0.max=e;var n=Fe();function e(t){let r;return t.forEach(function(s){const a=(0,n.toDate)(s);(r===void 0||r<a||isNaN(Number(a)))&&(r=a)}),r||new Date(NaN)}return f0}var h0={},t2;function d5(){if(t2)return h0;t2=1,h0.min=e;var n=Fe();function e(t){let r;return t.forEach(s=>{const a=(0,n.toDate)(s);(!r||r>a||isNaN(+a))&&(r=a)}),r||new Date(NaN)}return h0}var n2;function yee(){if(n2)return u0;n2=1,u0.clamp=t;var n=c5(),e=d5();function t(r,s){return(0,e.min)([(0,n.max)([r,s.start]),s.end])}return u0}var m0={},r2;function vee(){if(r2)return m0;r2=1,m0.closestIndexTo=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);if(isNaN(Number(s)))return NaN;const a=s.getTime();let o,l;return r.forEach(function(c,d){const h=(0,n.toDate)(c);if(isNaN(Number(h))){o=NaN,l=NaN;return}const p=Math.abs(a-h.getTime());(o==null||p<l)&&(o=d,l=p)}),o}return m0}var p0={},s2;function bee(){if(s2)return p0;s2=1,p0.closestTo=t;var n=fn(),e=Fe();function t(r,s){const a=(0,e.toDate)(r);if(isNaN(Number(a)))return(0,n.constructFrom)(r,NaN);const o=a.getTime();let l,c;return s.forEach(d=>{const h=(0,e.toDate)(d);if(isNaN(Number(h))){l=(0,n.constructFrom)(r,NaN),c=NaN;return}const p=Math.abs(o-h.getTime());(l==null||p<c)&&(l=h,c=p)}),l}return p0}var g0={},i2;function Yf(){if(i2)return g0;i2=1,g0.compareAsc=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o<0?-1:o>0?1:o}return g0}var x0={},a2;function wee(){if(a2)return x0;a2=1,x0.compareDesc=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getTime()-a.getTime();return o>0?-1:o<0?1:o}return x0}var y0={},o2;function Js(){if(o2)return y0;o2=1,y0.constructNow=e;var n=fn();function e(t){return(0,n.constructFrom)(t,Date.now())}return y0}var v0={},l2;function _ee(){if(l2)return v0;l2=1,v0.daysToWeeks=e;var n=Xt();function e(t){const r=t/n.daysInWeek,s=Math.trunc(r);return s===0?0:s}return v0}var b0={},w0={},c2;function Fm(){if(c2)return w0;c2=1,w0.isSameDay=e;var n=xy();function e(t,r){const s=(0,n.startOfDay)(t),a=(0,n.startOfDay)(r);return+s==+a}return w0}var _0={},j0={},d2;function u5(){if(d2)return j0;d2=1,j0.isDate=n;function n(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}return j0}var u2;function ad(){if(u2)return _0;u2=1,_0.isValid=t;var n=u5(),e=Fe();function t(r){if(!(0,n.isDate)(r)&&typeof r!="number")return!1;const s=(0,e.toDate)(r);return!isNaN(Number(s))}return _0}var f2;function jee(){if(f2)return b0;f2=1,b0.differenceInBusinessDays=o;var n=Dl(),e=id(),t=Fm(),r=ad(),s=gy(),a=Fe();function o(l,c){const d=(0,a.toDate)(l);let h=(0,a.toDate)(c);if(!(0,r.isValid)(d)||!(0,r.isValid)(h))return NaN;const p=(0,e.differenceInCalendarDays)(d,h),x=p<0?-1:1,y=Math.trunc(p/7);let _=y*5;for(h=(0,n.addDays)(h,y*7);!(0,t.isSameDay)(d,h);)_+=(0,s.isWeekend)(h)?0:x,h=(0,n.addDays)(h,x);return _===0?0:_}return b0}var N0={},h2;function f5(){if(h2)return N0;h2=1,N0.differenceInCalendarISOWeekYears=e;var n=Su();function e(t,r){return(0,n.getISOWeekYear)(t)-(0,n.getISOWeekYear)(r)}return N0}var S0={},m2;function Nee(){if(m2)return S0;m2=1,S0.differenceInCalendarISOWeeks=r;var n=Xt(),e=Ol(),t=sd();function r(s,a){const o=(0,e.startOfISOWeek)(s),l=(0,e.startOfISOWeek)(a),c=+o-(0,t.getTimezoneOffsetInMilliseconds)(o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l);return Math.round((c-d)/n.millisecondsInWeek)}return S0}var C0={},p2;function W1(){if(p2)return C0;p2=1,C0.differenceInCalendarMonths=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r),o=s.getFullYear()-a.getFullYear(),l=s.getMonth()-a.getMonth();return o*12+l}return C0}var T0={},k0={},g2;function h5(){if(g2)return k0;g2=1,k0.getQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return Math.trunc(r.getMonth()/3)+1}return k0}var x2;function m5(){if(x2)return T0;x2=1,T0.differenceInCalendarQuarters=t;var n=h5(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=(0,e.toDate)(s),l=a.getFullYear()-o.getFullYear(),c=(0,n.getQuarter)(a)-(0,n.getQuarter)(o);return l*4+c}return T0}var P0={},y2;function $1(){if(y2)return P0;y2=1,P0.differenceInCalendarWeeks=r;var n=Xt(),e=Po(),t=sd();function r(s,a,o){const l=(0,e.startOfWeek)(s,o),c=(0,e.startOfWeek)(a,o),d=+l-(0,t.getTimezoneOffsetInMilliseconds)(l),h=+c-(0,t.getTimezoneOffsetInMilliseconds)(c);return Math.round((d-h)/n.millisecondsInWeek)}return P0}var M0={},v2;function H1(){if(v2)return M0;v2=1,M0.differenceInCalendarYears=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()-a.getFullYear()}return M0}var E0={},b2;function Y1(){if(b2)return E0;b2=1,E0.differenceInDays=t;var n=id(),e=Fe();function t(s,a){const o=(0,e.toDate)(s),l=(0,e.toDate)(a),c=r(o,l),d=Math.abs((0,n.differenceInCalendarDays)(o,l));o.setDate(o.getDate()-c*d);const h=+(r(o,l)===-c),p=c*(d-h);return p===0?0:p}function r(s,a){const o=s.getFullYear()-a.getFullYear()||s.getMonth()-a.getMonth()||s.getDate()-a.getDate()||s.getHours()-a.getHours()||s.getMinutes()-a.getMinutes()||s.getSeconds()-a.getSeconds()||s.getMilliseconds()-a.getMilliseconds();return o<0?-1:o>0?1:o}return E0}var D0={},O0={},w2;function od(){if(w2)return O0;w2=1,O0.getRoundingMethod=n;function n(e){return t=>{const s=(e?Math[e]:Math.trunc)(t);return s===0?0:s}}return O0}var I0={},_2;function vy(){if(_2)return I0;_2=1,I0.differenceInMilliseconds=e;var n=Fe();function e(t,r){return+(0,n.toDate)(t)-+(0,n.toDate)(r)}return I0}var j2;function G1(){if(j2)return D0;j2=1,D0.differenceInHours=r;var n=od(),e=Xt(),t=vy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInHour;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return D0}var A0={},R0={},N2;function p5(){if(N2)return R0;N2=1,R0.subISOWeekYears=e;var n=a5();function e(t,r){return(0,n.addISOWeekYears)(t,-r)}return R0}var S2;function See(){if(S2)return A0;S2=1,A0.differenceInISOWeekYears=s;var n=Yf(),e=f5(),t=p5(),r=Fe();function s(a,o){let l=(0,r.toDate)(a);const c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarISOWeekYears)(l,c));l=(0,t.subISOWeekYears)(l,d*h);const p=+((0,n.compareAsc)(l,c)===-d),x=d*(h-p);return x===0?0:x}return A0}var L0={},C2;function Z1(){if(C2)return L0;C2=1,L0.differenceInMinutes=r;var n=od(),e=Xt(),t=vy();function r(s,a,o){const l=(0,t.differenceInMilliseconds)(s,a)/e.millisecondsInMinute;return(0,n.getRoundingMethod)(o?.roundingMethod)(l)}return L0}var F0={},q0={},z0={},T2;function K1(){if(T2)return z0;T2=1,z0.endOfDay=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setHours(23,59,59,999),r}return z0}var U0={},k2;function J1(){if(k2)return U0;k2=1,U0.endOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(23,59,59,999),r}return U0}var P2;function g5(){if(P2)return q0;P2=1,q0.isLastDayOfMonth=r;var n=K1(),e=J1(),t=Fe();function r(s){const a=(0,t.toDate)(s);return+(0,n.endOfDay)(a)==+(0,e.endOfMonth)(a)}return q0}var M2;function by(){if(M2)return F0;M2=1,F0.differenceInMonths=s;var n=Yf(),e=W1(),t=g5(),r=Fe();function s(a,o){const l=(0,r.toDate)(a),c=(0,r.toDate)(o),d=(0,n.compareAsc)(l,c),h=Math.abs((0,e.differenceInCalendarMonths)(l,c));let p;if(h<1)p=0;else{l.getMonth()===1&&l.getDate()>27&&l.setDate(30),l.setMonth(l.getMonth()-d*h);let x=(0,n.compareAsc)(l,c)===-d;(0,t.isLastDayOfMonth)((0,r.toDate)(a))&&h===1&&(0,n.compareAsc)(a,c)===1&&(x=!1),p=d*(h-Number(x))}return p===0?0:p}return F0}var B0={},E2;function Cee(){if(E2)return B0;E2=1,B0.differenceInQuarters=t;var n=od(),e=by();function t(r,s,a){const o=(0,e.differenceInMonths)(r,s)/3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return B0}var V0={},D2;function wy(){if(D2)return V0;D2=1,V0.differenceInSeconds=t;var n=od(),e=vy();function t(r,s,a){const o=(0,e.differenceInMilliseconds)(r,s)/1e3;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return V0}var W0={},O2;function Tee(){if(O2)return W0;O2=1,W0.differenceInWeeks=t;var n=od(),e=Y1();function t(r,s,a){const o=(0,e.differenceInDays)(r,s)/7;return(0,n.getRoundingMethod)(a?.roundingMethod)(o)}return W0}var $0={},I2;function x5(){if(I2)return $0;I2=1,$0.differenceInYears=r;var n=Yf(),e=H1(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=(0,t.toDate)(a),c=(0,n.compareAsc)(o,l),d=Math.abs((0,e.differenceInCalendarYears)(o,l));o.setFullYear(1584),l.setFullYear(1584);const h=(0,n.compareAsc)(o,l)===-c,p=c*(d-+h);return p===0?0:p}return $0}var H0={},A2;function y5(){if(A2)return H0;A2=1,H0.eachDayOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setDate(c.getDate()+d),c.setHours(0,0,0,0);return o?h.reverse():h}return H0}var Y0={},R2;function kee(){if(R2)return Y0;R2=1,Y0.eachHourOfInterval=t;var n=U1(),e=Fe();function t(r,s){const a=(0,e.toDate)(r.start),o=(0,e.toDate)(r.end);let l=+a>+o;const c=l?+a:+o;let d=l?o:a;d.setMinutes(0,0,0);let h=s?.step??1;if(!h)return[];h<0&&(h=-h,l=!l);const p=[];for(;+d<=c;)p.push((0,e.toDate)(d)),d=(0,n.addHours)(d,h);return l?p.reverse():p}return Y0}var G0={},Z0={},L2;function Q1(){if(L2)return Z0;L2=1,Z0.startOfMinute=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(0,0),r}return Z0}var F2;function Pee(){if(F2)return G0;F2=1,G0.eachMinuteOfInterval=r;var n=B1(),e=Q1(),t=Fe();function r(s,a){const o=(0,e.startOfMinute)((0,t.toDate)(s.start)),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+o:+l;let h=c?l:o,p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addMinutes)(h,p);return c?x.reverse():x}return G0}var K0={},q2;function Mee(){if(q2)return K0;q2=1,K0.eachMonthOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setDate(1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setMonth(c.getMonth()+d);return o?h.reverse():h}return K0}var J0={},Q0={},z2;function X1(){if(z2)return Q0;z2=1,Q0.startOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3;return r.setMonth(a,1),r.setHours(0,0,0,0),r}return Q0}var U2;function Eee(){if(U2)return J0;U2=1,J0.eachQuarterOfInterval=r;var n=V1(),e=X1(),t=Fe();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?+(0,e.startOfQuarter)(o):+(0,e.startOfQuarter)(l);let h=c?(0,e.startOfQuarter)(l):(0,e.startOfQuarter)(o),p=a?.step??1;if(!p)return[];p<0&&(p=-p,c=!c);const x=[];for(;+h<=d;)x.push((0,t.toDate)(h)),h=(0,n.addQuarters)(h,p);return c?x.reverse():x}return J0}var X0={},B2;function Dee(){if(B2)return X0;B2=1,X0.eachWeekOfInterval=r;var n=yy(),e=Po(),t=Fe();function r(s,a){const o=(0,t.toDate)(s.start),l=(0,t.toDate)(s.end);let c=+o>+l;const d=c?(0,e.startOfWeek)(l,a):(0,e.startOfWeek)(o,a),h=c?(0,e.startOfWeek)(o,a):(0,e.startOfWeek)(l,a);d.setHours(15),h.setHours(15);const p=+h.getTime();let x=d,y=a?.step??1;if(!y)return[];y<0&&(y=-y,c=!c);const _=[];for(;+x<=p;)x.setHours(0),_.push((0,t.toDate)(x)),x=(0,n.addWeeks)(x,y),x.setHours(15);return c?_.reverse():_}return X0}var ew={},V2;function eC(){if(V2)return ew;V2=1,ew.eachWeekendOfInterval=t;var n=y5(),e=gy();function t(r){const s=(0,n.eachDayOfInterval)(r),a=[];let o=0;for(;o<s.length;){const l=s[o++];(0,e.isWeekend)(l)&&a.push(l)}return a}return ew}var tw={},nw={},W2;function _y(){if(W2)return nw;W2=1,nw.startOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setDate(1),r.setHours(0,0,0,0),r}return nw}var $2;function Oee(){if($2)return tw;$2=1,tw.eachWeekendOfMonth=r;var n=eC(),e=J1(),t=_y();function r(s){const a=(0,t.startOfMonth)(s),o=(0,e.endOfMonth)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return tw}var rw={},sw={},H2;function v5(){if(H2)return sw;H2=1,sw.endOfYear=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}return sw}var iw={},Y2;function tC(){if(Y2)return iw;Y2=1,iw.startOfYear=t;var n=Fe(),e=fn();function t(r){const s=(0,n.toDate)(r),a=(0,e.constructFrom)(r,0);return a.setFullYear(s.getFullYear(),0,1),a.setHours(0,0,0,0),a}return iw}var G2;function Iee(){if(G2)return rw;G2=1,rw.eachWeekendOfYear=r;var n=eC(),e=v5(),t=tC();function r(s){const a=(0,t.startOfYear)(s),o=(0,e.endOfYear)(s);return(0,n.eachWeekendOfInterval)({start:a,end:o})}return rw}var aw={},Z2;function Aee(){if(Z2)return aw;Z2=1,aw.eachYearOfInterval=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t.start),a=(0,n.toDate)(t.end);let o=+s>+a;const l=o?+s:+a,c=o?a:s;c.setHours(0,0,0,0),c.setMonth(0,1);let d=r?.step??1;if(!d)return[];d<0&&(d=-d,o=!o);const h=[];for(;+c<=l;)h.push((0,n.toDate)(c)),c.setFullYear(c.getFullYear()+d);return o?h.reverse():h}return aw}var ow={},K2;function Ree(){if(K2)return ow;K2=1,ow.endOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a,11,31),r.setHours(23,59,59,999),r}return ow}var lw={},J2;function Lee(){if(J2)return lw;J2=1,lw.endOfHour=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(59,59,999),r}return lw}var cw={},dw={},Q2;function b5(){if(Q2)return dw;Q2=1,dw.endOfWeek=t;var n=Fe(),e=Ts();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setDate(l.getDate()+d),l.setHours(23,59,59,999),l}return dw}var X2;function Fee(){if(X2)return cw;X2=1,cw.endOfISOWeek=e;var n=b5();function e(t){return(0,n.endOfWeek)(t,{weekStartsOn:1})}return cw}var uw={},eD;function qee(){if(eD)return uw;eD=1,uw.endOfISOWeekYear=r;var n=Su(),e=Ol(),t=fn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setMilliseconds(l.getMilliseconds()-1),l}return uw}var fw={},tD;function zee(){if(tD)return fw;tD=1,fw.endOfMinute=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setSeconds(59,999),r}return fw}var hw={},nD;function Uee(){if(nD)return hw;nD=1,hw.endOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(23,59,59,999),r}return hw}var mw={},rD;function Bee(){if(rD)return mw;rD=1,mw.endOfSecond=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(999),r}return mw}var pw={},sD;function Vee(){if(sD)return pw;sD=1,pw.endOfToday=e;var n=K1();function e(){return(0,n.endOfDay)(Date.now())}return pw}var gw={},iD;function Wee(){if(iD)return gw;iD=1,gw.endOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(23,59,59,999),a}return gw}var xw={},aD;function $ee(){if(aD)return xw;aD=1,xw.endOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(23,59,59,999),a}return xw}var yw={},vw={},Zp={},Kp={},oD;function Hee(){if(oD)return Kp;oD=1,Kp.formatDistance=void 0;const n={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},e=(t,r,s)=>{let a;const o=n[t];return typeof o=="string"?a=o:r===1?a=o.one:a=o.other.replace("{{count}}",r.toString()),s?.addSuffix?s.comparison&&s.comparison>0?"in "+a:a+" ago":a};return Kp.formatDistance=e,Kp}var Jp={},bw={},lD;function Yee(){if(lD)return bw;lD=1,bw.buildFormatLongFn=n;function n(e){return(t={})=>{const r=t.width?String(t.width):e.defaultWidth;return e.formats[r]||e.formats[e.defaultWidth]}}return bw}var cD;function Gee(){if(cD)return Jp;cD=1,Jp.formatLong=void 0;var n=Yee();const e={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},t={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},r={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"};return Jp.formatLong={date:(0,n.buildFormatLongFn)({formats:e,defaultWidth:"full"}),time:(0,n.buildFormatLongFn)({formats:t,defaultWidth:"full"}),dateTime:(0,n.buildFormatLongFn)({formats:r,defaultWidth:"full"})},Jp}var Qp={},dD;function Zee(){if(dD)return Qp;dD=1,Qp.formatRelative=void 0;const n={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},e=(t,r,s,a)=>n[t];return Qp.formatRelative=e,Qp}var Xp={},ww={},uD;function Kee(){if(uD)return ww;uD=1,ww.buildLocalizeFn=n;function n(e){return(t,r)=>{const s=r?.context?String(r.context):"standalone";let a;if(s==="formatting"&&e.formattingValues){const l=e.defaultFormattingWidth||e.defaultWidth,c=r?.width?String(r.width):l;a=e.formattingValues[c]||e.formattingValues[l]}else{const l=e.defaultWidth,c=r?.width?String(r.width):e.defaultWidth;a=e.values[c]||e.values[l]}const o=e.argumentCallback?e.argumentCallback(t):t;return a[o]}}return ww}var fD;function Jee(){if(fD)return Xp;fD=1,Xp.localize=void 0;var n=Kee();const e={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},t={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},r={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},s={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},a={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},o={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},l=(c,d)=>{const h=Number(c),p=h%100;if(p>20||p<10)switch(p%10){case 1:return h+"st";case 2:return h+"nd";case 3:return h+"rd"}return h+"th"};return Xp.localize={ordinalNumber:l,era:(0,n.buildLocalizeFn)({values:e,defaultWidth:"wide"}),quarter:(0,n.buildLocalizeFn)({values:t,defaultWidth:"wide",argumentCallback:c=>c-1}),month:(0,n.buildLocalizeFn)({values:r,defaultWidth:"wide"}),day:(0,n.buildLocalizeFn)({values:s,defaultWidth:"wide"}),dayPeriod:(0,n.buildLocalizeFn)({values:a,defaultWidth:"wide",formattingValues:o,defaultFormattingWidth:"wide"})},Xp}var eg={},_w={},hD;function Qee(){if(hD)return _w;hD=1,_w.buildMatchFn=n;function n(r){return(s,a={})=>{const o=a.width,l=o&&r.matchPatterns[o]||r.matchPatterns[r.defaultMatchWidth],c=s.match(l);if(!c)return null;const d=c[0],h=o&&r.parsePatterns[o]||r.parsePatterns[r.defaultParseWidth],p=Array.isArray(h)?t(h,_=>_.test(d)):e(h,_=>_.test(d));let x;x=r.valueCallback?r.valueCallback(p):p,x=a.valueCallback?a.valueCallback(x):x;const y=s.slice(d.length);return{value:x,rest:y}}}function e(r,s){for(const a in r)if(Object.prototype.hasOwnProperty.call(r,a)&&s(r[a]))return a}function t(r,s){for(let a=0;a<r.length;a++)if(s(r[a]))return a}return _w}var jw={},mD;function Xee(){if(mD)return jw;mD=1,jw.buildMatchPatternFn=n;function n(e){return(t,r={})=>{const s=t.match(e.matchPattern);if(!s)return null;const a=s[0],o=t.match(e.parsePattern);if(!o)return null;let l=e.valueCallback?e.valueCallback(o[0]):o[0];l=r.valueCallback?r.valueCallback(l):l;const c=t.slice(a.length);return{value:l,rest:c}}}return jw}var pD;function ete(){if(pD)return eg;pD=1,eg.match=void 0;var n=Qee(),e=Xee();const t=/^(\d+)(th|st|nd|rd)?/i,r=/\d+/i,s={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},a={any:[/^b/i,/^(a|c)/i]},o={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},l={any:[/1/i,/2/i,/3/i,/4/i]},c={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},d={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},h={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},p={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},x={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},y={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}};return eg.match={ordinalNumber:(0,e.buildMatchPatternFn)({matchPattern:t,parsePattern:r,valueCallback:_=>parseInt(_,10)}),era:(0,n.buildMatchFn)({matchPatterns:s,defaultMatchWidth:"wide",parsePatterns:a,defaultParseWidth:"any"}),quarter:(0,n.buildMatchFn)({matchPatterns:o,defaultMatchWidth:"wide",parsePatterns:l,defaultParseWidth:"any",valueCallback:_=>_+1}),month:(0,n.buildMatchFn)({matchPatterns:c,defaultMatchWidth:"wide",parsePatterns:d,defaultParseWidth:"any"}),day:(0,n.buildMatchFn)({matchPatterns:h,defaultMatchWidth:"wide",parsePatterns:p,defaultParseWidth:"any"}),dayPeriod:(0,n.buildMatchFn)({matchPatterns:x,defaultMatchWidth:"any",parsePatterns:y,defaultParseWidth:"any"})},eg}var gD;function w5(){if(gD)return Zp;gD=1,Zp.enUS=void 0;var n=Hee(),e=Gee(),t=Zee(),r=Jee(),s=ete();return Zp.enUS={code:"en-US",formatDistance:n.formatDistance,formatLong:e.formatLong,formatRelative:t.formatRelative,localize:r.localize,match:s.match,options:{weekStartsOn:0,firstWeekContainsDate:1}},Zp}var xD;function Gf(){return xD||(xD=1,(function(n){Object.defineProperty(n,"defaultLocale",{enumerable:!0,get:function(){return e.enUS}});var e=w5()})(vw)),vw}var tg={},Nw={},yD;function _5(){if(yD)return Nw;yD=1,Nw.getDayOfYear=r;var n=id(),e=tC(),t=Fe();function r(s){const a=(0,t.toDate)(s);return(0,n.differenceInCalendarDays)(a,(0,e.startOfYear)(a))+1}return Nw}var Sw={},vD;function nC(){if(vD)return Sw;vD=1,Sw.getISOWeek=s;var n=Xt(),e=Ol(),t=Lm(),r=Fe();function s(a){const o=(0,r.toDate)(a),l=+(0,e.startOfISOWeek)(o)-+(0,t.startOfISOWeekYear)(o);return Math.round(l/n.millisecondsInWeek)+1}return Sw}var Cw={},Tw={},kw={},bD;function jy(){if(bD)return kw;bD=1,kw.getWeekYear=s;var n=fn(),e=Po(),t=Fe(),r=Ts();function s(a,o){const l=(0,t.toDate)(a),c=l.getFullYear(),d=(0,r.getDefaultOptions)(),h=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1,p=(0,n.constructFrom)(a,0);p.setFullYear(c+1,0,h),p.setHours(0,0,0,0);const x=(0,e.startOfWeek)(p,o),y=(0,n.constructFrom)(a,0);y.setFullYear(c,0,h),y.setHours(0,0,0,0);const _=(0,e.startOfWeek)(y,o);return l.getTime()>=x.getTime()?c+1:l.getTime()>=_.getTime()?c:c-1}return kw}var wD;function rC(){if(wD)return Tw;wD=1,Tw.startOfWeekYear=s;var n=fn(),e=jy(),t=Po(),r=Ts();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.firstWeekContainsDate??o?.locale?.options?.firstWeekContainsDate??l.firstWeekContainsDate??l.locale?.options?.firstWeekContainsDate??1,d=(0,e.getWeekYear)(a,o),h=(0,n.constructFrom)(a,0);return h.setFullYear(d,0,c),h.setHours(0,0,0,0),(0,t.startOfWeek)(h,o)}return Tw}var _D;function sC(){if(_D)return Cw;_D=1,Cw.getWeek=s;var n=Xt(),e=Po(),t=rC(),r=Fe();function s(a,o){const l=(0,r.toDate)(a),c=+(0,e.startOfWeek)(l,o)-+(0,t.startOfWeekYear)(l,o);return Math.round(c/n.millisecondsInWeek)+1}return Cw}var Pw={},jD;function Zf(){if(jD)return Pw;jD=1,Pw.addLeadingZeros=n;function n(e,t){const r=e<0?"-":"",s=Math.abs(e).toString().padStart(t,"0");return r+s}return Pw}var ng={},ND;function j5(){if(ND)return ng;ND=1,ng.lightFormatters=void 0;var n=Zf();return ng.lightFormatters={y(e,t){const r=e.getFullYear(),s=r>0?r:1-r;return(0,n.addLeadingZeros)(t==="yy"?s%100:s,t.length)},M(e,t){const r=e.getMonth();return t==="M"?String(r+1):(0,n.addLeadingZeros)(r+1,2)},d(e,t){return(0,n.addLeadingZeros)(e.getDate(),t.length)},a(e,t){const r=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return r.toUpperCase();case"aaa":return r;case"aaaaa":return r[0];case"aaaa":default:return r==="am"?"a.m.":"p.m."}},h(e,t){return(0,n.addLeadingZeros)(e.getHours()%12||12,t.length)},H(e,t){return(0,n.addLeadingZeros)(e.getHours(),t.length)},m(e,t){return(0,n.addLeadingZeros)(e.getMinutes(),t.length)},s(e,t){return(0,n.addLeadingZeros)(e.getSeconds(),t.length)},S(e,t){const r=t.length,s=e.getMilliseconds(),a=Math.trunc(s*Math.pow(10,r-3));return(0,n.addLeadingZeros)(a,t.length)}},ng}var SD;function tte(){if(SD)return tg;SD=1,tg.formatters=void 0;var n=_5(),e=nC(),t=Su(),r=sC(),s=jy(),a=Zf(),o=j5();const l={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"};tg.formatters={G:function(p,x,y){const _=p.getFullYear()>0?1:0;switch(x){case"G":case"GG":case"GGG":return y.era(_,{width:"abbreviated"});case"GGGGG":return y.era(_,{width:"narrow"});case"GGGG":default:return y.era(_,{width:"wide"})}},y:function(p,x,y){if(x==="yo"){const _=p.getFullYear(),w=_>0?_:1-_;return y.ordinalNumber(w,{unit:"year"})}return o.lightFormatters.y(p,x)},Y:function(p,x,y,_){const w=(0,s.getWeekYear)(p,_),j=w>0?w:1-w;if(x==="YY"){const C=j%100;return(0,a.addLeadingZeros)(C,2)}return x==="Yo"?y.ordinalNumber(j,{unit:"year"}):(0,a.addLeadingZeros)(j,x.length)},R:function(p,x){const y=(0,t.getISOWeekYear)(p);return(0,a.addLeadingZeros)(y,x.length)},u:function(p,x){const y=p.getFullYear();return(0,a.addLeadingZeros)(y,x.length)},Q:function(p,x,y){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"Q":return String(_);case"QQ":return(0,a.addLeadingZeros)(_,2);case"Qo":return y.ordinalNumber(_,{unit:"quarter"});case"QQQ":return y.quarter(_,{width:"abbreviated",context:"formatting"});case"QQQQQ":return y.quarter(_,{width:"narrow",context:"formatting"});case"QQQQ":default:return y.quarter(_,{width:"wide",context:"formatting"})}},q:function(p,x,y){const _=Math.ceil((p.getMonth()+1)/3);switch(x){case"q":return String(_);case"qq":return(0,a.addLeadingZeros)(_,2);case"qo":return y.ordinalNumber(_,{unit:"quarter"});case"qqq":return y.quarter(_,{width:"abbreviated",context:"standalone"});case"qqqqq":return y.quarter(_,{width:"narrow",context:"standalone"});case"qqqq":default:return y.quarter(_,{width:"wide",context:"standalone"})}},M:function(p,x,y){const _=p.getMonth();switch(x){case"M":case"MM":return o.lightFormatters.M(p,x);case"Mo":return y.ordinalNumber(_+1,{unit:"month"});case"MMM":return y.month(_,{width:"abbreviated",context:"formatting"});case"MMMMM":return y.month(_,{width:"narrow",context:"formatting"});case"MMMM":default:return y.month(_,{width:"wide",context:"formatting"})}},L:function(p,x,y){const _=p.getMonth();switch(x){case"L":return String(_+1);case"LL":return(0,a.addLeadingZeros)(_+1,2);case"Lo":return y.ordinalNumber(_+1,{unit:"month"});case"LLL":return y.month(_,{width:"abbreviated",context:"standalone"});case"LLLLL":return y.month(_,{width:"narrow",context:"standalone"});case"LLLL":default:return y.month(_,{width:"wide",context:"standalone"})}},w:function(p,x,y,_){const w=(0,r.getWeek)(p,_);return x==="wo"?y.ordinalNumber(w,{unit:"week"}):(0,a.addLeadingZeros)(w,x.length)},I:function(p,x,y){const _=(0,e.getISOWeek)(p);return x==="Io"?y.ordinalNumber(_,{unit:"week"}):(0,a.addLeadingZeros)(_,x.length)},d:function(p,x,y){return x==="do"?y.ordinalNumber(p.getDate(),{unit:"date"}):o.lightFormatters.d(p,x)},D:function(p,x,y){const _=(0,n.getDayOfYear)(p);return x==="Do"?y.ordinalNumber(_,{unit:"dayOfYear"}):(0,a.addLeadingZeros)(_,x.length)},E:function(p,x,y){const _=p.getDay();switch(x){case"E":case"EE":case"EEE":return y.day(_,{width:"abbreviated",context:"formatting"});case"EEEEE":return y.day(_,{width:"narrow",context:"formatting"});case"EEEEEE":return y.day(_,{width:"short",context:"formatting"});case"EEEE":default:return y.day(_,{width:"wide",context:"formatting"})}},e:function(p,x,y,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"e":return String(j);case"ee":return(0,a.addLeadingZeros)(j,2);case"eo":return y.ordinalNumber(j,{unit:"day"});case"eee":return y.day(w,{width:"abbreviated",context:"formatting"});case"eeeee":return y.day(w,{width:"narrow",context:"formatting"});case"eeeeee":return y.day(w,{width:"short",context:"formatting"});case"eeee":default:return y.day(w,{width:"wide",context:"formatting"})}},c:function(p,x,y,_){const w=p.getDay(),j=(w-_.weekStartsOn+8)%7||7;switch(x){case"c":return String(j);case"cc":return(0,a.addLeadingZeros)(j,x.length);case"co":return y.ordinalNumber(j,{unit:"day"});case"ccc":return y.day(w,{width:"abbreviated",context:"standalone"});case"ccccc":return y.day(w,{width:"narrow",context:"standalone"});case"cccccc":return y.day(w,{width:"short",context:"standalone"});case"cccc":default:return y.day(w,{width:"wide",context:"standalone"})}},i:function(p,x,y){const _=p.getDay(),w=_===0?7:_;switch(x){case"i":return String(w);case"ii":return(0,a.addLeadingZeros)(w,x.length);case"io":return y.ordinalNumber(w,{unit:"day"});case"iii":return y.day(_,{width:"abbreviated",context:"formatting"});case"iiiii":return y.day(_,{width:"narrow",context:"formatting"});case"iiiiii":return y.day(_,{width:"short",context:"formatting"});case"iiii":default:return y.day(_,{width:"wide",context:"formatting"})}},a:function(p,x,y){const w=p.getHours()/12>=1?"pm":"am";switch(x){case"a":case"aa":return y.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"aaa":return y.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return y.dayPeriod(w,{width:"narrow",context:"formatting"});case"aaaa":default:return y.dayPeriod(w,{width:"wide",context:"formatting"})}},b:function(p,x,y){const _=p.getHours();let w;switch(_===12?w=l.noon:_===0?w=l.midnight:w=_/12>=1?"pm":"am",x){case"b":case"bb":return y.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"bbb":return y.dayPeriod(w,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return y.dayPeriod(w,{width:"narrow",context:"formatting"});case"bbbb":default:return y.dayPeriod(w,{width:"wide",context:"formatting"})}},B:function(p,x,y){const _=p.getHours();let w;switch(_>=17?w=l.evening:_>=12?w=l.afternoon:_>=4?w=l.morning:w=l.night,x){case"B":case"BB":case"BBB":return y.dayPeriod(w,{width:"abbreviated",context:"formatting"});case"BBBBB":return y.dayPeriod(w,{width:"narrow",context:"formatting"});case"BBBB":default:return y.dayPeriod(w,{width:"wide",context:"formatting"})}},h:function(p,x,y){if(x==="ho"){let _=p.getHours()%12;return _===0&&(_=12),y.ordinalNumber(_,{unit:"hour"})}return o.lightFormatters.h(p,x)},H:function(p,x,y){return x==="Ho"?y.ordinalNumber(p.getHours(),{unit:"hour"}):o.lightFormatters.H(p,x)},K:function(p,x,y){const _=p.getHours()%12;return x==="Ko"?y.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},k:function(p,x,y){let _=p.getHours();return _===0&&(_=24),x==="ko"?y.ordinalNumber(_,{unit:"hour"}):(0,a.addLeadingZeros)(_,x.length)},m:function(p,x,y){return x==="mo"?y.ordinalNumber(p.getMinutes(),{unit:"minute"}):o.lightFormatters.m(p,x)},s:function(p,x,y){return x==="so"?y.ordinalNumber(p.getSeconds(),{unit:"second"}):o.lightFormatters.s(p,x)},S:function(p,x){return o.lightFormatters.S(p,x)},X:function(p,x,y){const _=p.getTimezoneOffset();if(_===0)return"Z";switch(x){case"X":return d(_);case"XXXX":case"XX":return h(_);case"XXXXX":case"XXX":default:return h(_,":")}},x:function(p,x,y){const _=p.getTimezoneOffset();switch(x){case"x":return d(_);case"xxxx":case"xx":return h(_);case"xxxxx":case"xxx":default:return h(_,":")}},O:function(p,x,y){const _=p.getTimezoneOffset();switch(x){case"O":case"OO":case"OOO":return"GMT"+c(_,":");case"OOOO":default:return"GMT"+h(_,":")}},z:function(p,x,y){const _=p.getTimezoneOffset();switch(x){case"z":case"zz":case"zzz":return"GMT"+c(_,":");case"zzzz":default:return"GMT"+h(_,":")}},t:function(p,x,y){const _=Math.trunc(p.getTime()/1e3);return(0,a.addLeadingZeros)(_,x.length)},T:function(p,x,y){const _=p.getTime();return(0,a.addLeadingZeros)(_,x.length)}};function c(p,x=""){const y=p>0?"-":"+",_=Math.abs(p),w=Math.trunc(_/60),j=_%60;return j===0?y+String(w):y+String(w)+x+(0,a.addLeadingZeros)(j,2)}function d(p,x){return p%60===0?(p>0?"-":"+")+(0,a.addLeadingZeros)(Math.abs(p)/60,2):h(p,x)}function h(p,x=""){const y=p>0?"-":"+",_=Math.abs(p),w=(0,a.addLeadingZeros)(Math.trunc(_/60),2),j=(0,a.addLeadingZeros)(_%60,2);return y+w+x+j}return tg}var rg={},CD;function N5(){if(CD)return rg;CD=1,rg.longFormatters=void 0;const n=(r,s)=>{switch(r){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},e=(r,s)=>{switch(r){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},t=(r,s)=>{const a=r.match(/(P+)(p+)?/)||[],o=a[1],l=a[2];if(!l)return n(r,s);let c;switch(o){case"P":c=s.dateTime({width:"short"});break;case"PP":c=s.dateTime({width:"medium"});break;case"PPP":c=s.dateTime({width:"long"});break;case"PPPP":default:c=s.dateTime({width:"full"});break}return c.replace("{{date}}",n(o,s)).replace("{{time}}",e(l,s))};return rg.longFormatters={p:e,P:t},rg}var kh={},TD;function S5(){if(TD)return kh;TD=1,kh.isProtectedDayOfYearToken=r,kh.isProtectedWeekYearToken=s,kh.warnOrThrowProtectedError=a;const n=/^D+$/,e=/^Y+$/,t=["D","DD","YY","YYYY"];function r(l){return n.test(l)}function s(l){return e.test(l)}function a(l,c,d){const h=o(l,c,d);if(console.warn(h),t.includes(l))throw new RangeError(h)}function o(l,c,d){const h=l[0]==="Y"?"years":"days of the month";return`Use \`${l.toLowerCase()}\` instead of \`${l}\` (in \`${c}\`) for formatting ${h} to the input \`${d}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}return kh}var kD;function C5(){return kD||(kD=1,(function(n){n.format=n.formatDate=y,Object.defineProperty(n,"formatters",{enumerable:!0,get:function(){return r.formatters}}),Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return s.longFormatters}});var e=Gf(),t=Ts(),r=tte(),s=N5(),a=S5(),o=ad(),l=Fe();const c=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,d=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,h=/^'([^]*?)'?$/,p=/''/g,x=/[a-zA-Z]/;function y(w,j,C){const P=(0,t.getDefaultOptions)(),O=C?.locale??P.locale??e.defaultLocale,M=C?.firstWeekContainsDate??C?.locale?.options?.firstWeekContainsDate??P.firstWeekContainsDate??P.locale?.options?.firstWeekContainsDate??1,D=C?.weekStartsOn??C?.locale?.options?.weekStartsOn??P.weekStartsOn??P.locale?.options?.weekStartsOn??0,I=(0,l.toDate)(w);if(!(0,o.isValid)(I))throw new RangeError("Invalid time value");let F=j.match(d).map(B=>{const U=B[0];if(U==="p"||U==="P"){const W=s.longFormatters[U];return W(B,O.formatLong)}return B}).join("").match(c).map(B=>{if(B==="''")return{isToken:!1,value:"'"};const U=B[0];if(U==="'")return{isToken:!1,value:_(B)};if(r.formatters[U])return{isToken:!0,value:B};if(U.match(x))throw new RangeError("Format string contains an unescaped latin alphabet character `"+U+"`");return{isToken:!1,value:B}});O.localize.preprocessor&&(F=O.localize.preprocessor(I,F));const q={firstWeekContainsDate:M,weekStartsOn:D,locale:O};return F.map(B=>{if(!B.isToken)return B.value;const U=B.value;(!C?.useAdditionalWeekYearTokens&&(0,a.isProtectedWeekYearToken)(U)||!C?.useAdditionalDayOfYearTokens&&(0,a.isProtectedDayOfYearToken)(U))&&(0,a.warnOrThrowProtectedError)(U,j,String(w));const W=r.formatters[U[0]];return W(I,U,O.localize,q)}).join("")}function _(w){const j=w.match(h);return j?j[1].replace(p,"'"):w}})(yw)),yw}var Mw={},PD;function T5(){if(PD)return Mw;PD=1,Mw.formatDistance=c;var n=Yf(),e=Xt(),t=by(),r=wy(),s=Fe(),a=Gf(),o=Ts(),l=sd();function c(d,h,p){const x=(0,o.getDefaultOptions)(),y=p?.locale??x.locale??a.defaultLocale,_=2520,w=(0,n.compareAsc)(d,h);if(isNaN(w))throw new RangeError("Invalid time value");const j=Object.assign({},p,{addSuffix:p?.addSuffix,comparison:w});let C,P;w>0?(C=(0,s.toDate)(h),P=(0,s.toDate)(d)):(C=(0,s.toDate)(d),P=(0,s.toDate)(h));const O=(0,r.differenceInSeconds)(P,C),M=((0,l.getTimezoneOffsetInMilliseconds)(P)-(0,l.getTimezoneOffsetInMilliseconds)(C))/1e3,D=Math.round((O-M)/60);let I;if(D<2)return p?.includeSeconds?O<5?y.formatDistance("lessThanXSeconds",5,j):O<10?y.formatDistance("lessThanXSeconds",10,j):O<20?y.formatDistance("lessThanXSeconds",20,j):O<40?y.formatDistance("halfAMinute",0,j):O<60?y.formatDistance("lessThanXMinutes",1,j):y.formatDistance("xMinutes",1,j):D===0?y.formatDistance("lessThanXMinutes",1,j):y.formatDistance("xMinutes",D,j);if(D<45)return y.formatDistance("xMinutes",D,j);if(D<90)return y.formatDistance("aboutXHours",1,j);if(D<e.minutesInDay){const F=Math.round(D/60);return y.formatDistance("aboutXHours",F,j)}else{if(D<_)return y.formatDistance("xDays",1,j);if(D<e.minutesInMonth){const F=Math.round(D/e.minutesInDay);return y.formatDistance("xDays",F,j)}else if(D<e.minutesInMonth*2)return I=Math.round(D/e.minutesInMonth),y.formatDistance("aboutXMonths",I,j)}if(I=(0,t.differenceInMonths)(P,C),I<12){const F=Math.round(D/e.minutesInMonth);return y.formatDistance("xMonths",F,j)}else{const F=I%12,q=Math.trunc(I/12);return F<3?y.formatDistance("aboutXYears",q,j):F<9?y.formatDistance("overXYears",q,j):y.formatDistance("almostXYears",q+1,j)}}return Mw}var Ew={},MD;function k5(){if(MD)return Ew;MD=1,Ew.formatDistanceStrict=l;var n=Gf(),e=Ts(),t=od(),r=sd(),s=Yf(),a=Xt(),o=Fe();function l(c,d,h){const p=(0,e.getDefaultOptions)(),x=h?.locale??p.locale??n.defaultLocale,y=(0,s.compareAsc)(c,d);if(isNaN(y))throw new RangeError("Invalid time value");const _=Object.assign({},h,{addSuffix:h?.addSuffix,comparison:y});let w,j;y>0?(w=(0,o.toDate)(d),j=(0,o.toDate)(c)):(w=(0,o.toDate)(c),j=(0,o.toDate)(d));const C=(0,t.getRoundingMethod)(h?.roundingMethod??"round"),P=j.getTime()-w.getTime(),O=P/a.millisecondsInMinute,M=(0,r.getTimezoneOffsetInMilliseconds)(j)-(0,r.getTimezoneOffsetInMilliseconds)(w),D=(P-M)/a.millisecondsInMinute,I=h?.unit;let F;if(I?F=I:O<1?F="second":O<60?F="minute":O<a.minutesInDay?F="hour":D<a.minutesInMonth?F="day":D<a.minutesInYear?F="month":F="year",F==="second"){const q=C(P/1e3);return x.formatDistance("xSeconds",q,_)}else if(F==="minute"){const q=C(O);return x.formatDistance("xMinutes",q,_)}else if(F==="hour"){const q=C(O/60);return x.formatDistance("xHours",q,_)}else if(F==="day"){const q=C(D/a.minutesInDay);return x.formatDistance("xDays",q,_)}else if(F==="month"){const q=C(D/a.minutesInMonth);return q===12&&I!=="month"?x.formatDistance("xYears",1,_):x.formatDistance("xMonths",q,_)}else{const q=C(D/a.minutesInYear);return x.formatDistance("xYears",q,_)}}return Ew}var Dw={},ED;function nte(){if(ED)return Dw;ED=1,Dw.formatDistanceToNow=t;var n=Js(),e=T5();function t(r,s){return(0,e.formatDistance)(r,(0,n.constructNow)(r),s)}return Dw}var Ow={},DD;function rte(){if(DD)return Ow;DD=1,Ow.formatDistanceToNowStrict=t;var n=k5(),e=Js();function t(r,s){return(0,n.formatDistanceStrict)(r,(0,e.constructNow)(r),s)}return Ow}var Iw={},OD;function ste(){if(OD)return Iw;OD=1,Iw.formatDuration=r;var n=Gf(),e=Ts();const t=["years","months","weeks","days","hours","minutes","seconds"];function r(s,a){const o=(0,e.getDefaultOptions)(),l=a?.locale??o.locale??n.defaultLocale,c=a?.format??t,d=a?.zero??!1,h=a?.delimiter??" ";return l.formatDistance?c.reduce((x,y)=>{const _=`x${y.replace(/(^.)/,j=>j.toUpperCase())}`,w=s[y];return w!==void 0&&(d||s[y])?x.concat(l.formatDistance(_,w)):x},[]).join(h):""}return Iw}var Aw={},ID;function ite(){if(ID)return Aw;ID=1,Aw.formatISO=t;var n=Fe(),e=Zf();function t(r,s){const a=(0,n.toDate)(r);if(isNaN(a.getTime()))throw new RangeError("Invalid time value");const o=s?.format??"extended",l=s?.representation??"complete";let c="",d="";const h=o==="extended"?"-":"",p=o==="extended"?":":"";if(l!=="time"){const x=(0,e.addLeadingZeros)(a.getDate(),2),y=(0,e.addLeadingZeros)(a.getMonth()+1,2);c=`${(0,e.addLeadingZeros)(a.getFullYear(),4)}${h}${y}${h}${x}`}if(l!=="date"){const x=a.getTimezoneOffset();if(x!==0){const P=Math.abs(x),O=(0,e.addLeadingZeros)(Math.trunc(P/60),2),M=(0,e.addLeadingZeros)(P%60,2);d=`${x<0?"+":"-"}${O}:${M}`}else d="Z";const y=(0,e.addLeadingZeros)(a.getHours(),2),_=(0,e.addLeadingZeros)(a.getMinutes(),2),w=(0,e.addLeadingZeros)(a.getSeconds(),2),j=c===""?"":"T",C=[y,_,w].join(p);c=`${c}${j}${C}${d}`}return c}return Aw}var Rw={},AD;function ate(){if(AD)return Rw;AD=1,Rw.formatISO9075=r;var n=ad(),e=Fe(),t=Zf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.format??"extended",c=a?.representation??"complete";let d="";const h=l==="extended"?"-":"",p=l==="extended"?":":"";if(c!=="time"){const x=(0,t.addLeadingZeros)(o.getDate(),2),y=(0,t.addLeadingZeros)(o.getMonth()+1,2);d=`${(0,t.addLeadingZeros)(o.getFullYear(),4)}${h}${y}${h}${x}`}if(c!=="date"){const x=(0,t.addLeadingZeros)(o.getHours(),2),y=(0,t.addLeadingZeros)(o.getMinutes(),2),_=(0,t.addLeadingZeros)(o.getSeconds(),2);d=`${d}${d===""?"":" "}${x}${p}${y}${p}${_}`}return d}return Rw}var Lw={},RD;function ote(){if(RD)return Lw;RD=1,Lw.formatISODuration=n;function n(e){const{years:t=0,months:r=0,days:s=0,hours:a=0,minutes:o=0,seconds:l=0}=e;return`P${t}Y${r}M${s}DT${a}H${o}M${l}S`}return Lw}var Fw={},LD;function lte(){if(LD)return Fw;LD=1,Fw.formatRFC3339=r;var n=ad(),e=Fe(),t=Zf();function r(s,a){const o=(0,e.toDate)(s);if(!(0,n.isValid)(o))throw new RangeError("Invalid time value");const l=a?.fractionDigits??0,c=(0,t.addLeadingZeros)(o.getDate(),2),d=(0,t.addLeadingZeros)(o.getMonth()+1,2),h=o.getFullYear(),p=(0,t.addLeadingZeros)(o.getHours(),2),x=(0,t.addLeadingZeros)(o.getMinutes(),2),y=(0,t.addLeadingZeros)(o.getSeconds(),2);let _="";if(l>0){const C=o.getMilliseconds(),P=Math.trunc(C*Math.pow(10,l-3));_="."+(0,t.addLeadingZeros)(P,l)}let w="";const j=o.getTimezoneOffset();if(j!==0){const C=Math.abs(j),P=(0,t.addLeadingZeros)(Math.trunc(C/60),2),O=(0,t.addLeadingZeros)(C%60,2);w=`${j<0?"+":"-"}${P}:${O}`}else w="Z";return`${h}-${d}-${c}T${p}:${x}:${y}${_}${w}`}return Fw}var qw={},FD;function cte(){if(FD)return qw;FD=1,qw.formatRFC7231=a;var n=ad(),e=Fe(),t=Zf();const r=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function a(o){const l=(0,e.toDate)(o);if(!(0,n.isValid)(l))throw new RangeError("Invalid time value");const c=r[l.getUTCDay()],d=(0,t.addLeadingZeros)(l.getUTCDate(),2),h=s[l.getUTCMonth()],p=l.getUTCFullYear(),x=(0,t.addLeadingZeros)(l.getUTCHours(),2),y=(0,t.addLeadingZeros)(l.getUTCMinutes(),2),_=(0,t.addLeadingZeros)(l.getUTCSeconds(),2);return`${c}, ${d} ${h} ${p} ${x}:${y}:${_} GMT`}return qw}var zw={},qD;function dte(){if(qD)return zw;qD=1,zw.formatRelative=a;var n=id(),e=C5(),t=Fe(),r=Gf(),s=Ts();function a(o,l,c){const d=(0,t.toDate)(o),h=(0,t.toDate)(l),p=(0,s.getDefaultOptions)(),x=c?.locale??p.locale??r.defaultLocale,y=c?.weekStartsOn??c?.locale?.options?.weekStartsOn??p.weekStartsOn??p.locale?.options?.weekStartsOn??0,_=(0,n.differenceInCalendarDays)(d,h);if(isNaN(_))throw new RangeError("Invalid time value");let w;_<-6?w="other":_<-1?w="lastWeek":_<0?w="yesterday":_<1?w="today":_<2?w="tomorrow":_<7?w="nextWeek":w="other";const j=x.formatRelative(w,d,h,{locale:x,weekStartsOn:y});return(0,e.format)(d,j,{locale:x,weekStartsOn:y})}return zw}var Uw={},zD;function ute(){if(zD)return Uw;zD=1,Uw.fromUnixTime=e;var n=Fe();function e(t){return(0,n.toDate)(t*1e3)}return Uw}var Bw={},UD;function P5(){if(UD)return Bw;UD=1,Bw.getDate=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDate()}return Bw}var Vw={},BD;function Ny(){if(BD)return Vw;BD=1,Vw.getDay=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()}return Vw}var Ww={},VD;function M5(){if(VD)return Ww;VD=1,Ww.getDaysInMonth=t;var n=Fe(),e=fn();function t(r){const s=(0,n.toDate)(r),a=s.getFullYear(),o=s.getMonth(),l=(0,e.constructFrom)(r,0);return l.setFullYear(a,o+1,0),l.setHours(0,0,0,0),l.getDate()}return Ww}var $w={},Hw={},WD;function E5(){if(WD)return Hw;WD=1,Hw.isLeapYear=e;var n=Fe();function e(t){const s=(0,n.toDate)(t).getFullYear();return s%400===0||s%4===0&&s%100!==0}return Hw}var $D;function fte(){if($D)return $w;$D=1,$w.getDaysInYear=t;var n=E5(),e=Fe();function t(r){const s=(0,e.toDate)(r);return String(new Date(s))==="Invalid Date"?NaN:(0,n.isLeapYear)(s)?366:365}return $w}var Yw={},HD;function hte(){if(HD)return Yw;HD=1,Yw.getDecade=e;var n=Fe();function e(t){const s=(0,n.toDate)(t).getFullYear();return Math.floor(s/10)*10}return Yw}var Gw={},YD;function D5(){if(YD)return Gw;YD=1,Gw.getDefaultOptions=e;var n=Ts();function e(){return Object.assign({},(0,n.getDefaultOptions)())}return Gw}var Zw={},GD;function mte(){if(GD)return Zw;GD=1,Zw.getHours=e;var n=Fe();function e(t){return(0,n.toDate)(t).getHours()}return Zw}var Kw={},ZD;function O5(){if(ZD)return Kw;ZD=1,Kw.getISODay=e;var n=Fe();function e(t){let s=(0,n.toDate)(t).getDay();return s===0&&(s=7),s}return Kw}var Jw={},KD;function pte(){if(KD)return Jw;KD=1,Jw.getISOWeeksInYear=r;var n=yy(),e=Xt(),t=Lm();function r(s){const a=(0,t.startOfISOWeekYear)(s),l=+(0,t.startOfISOWeekYear)((0,n.addWeeks)(a,60))-+a;return Math.round(l/e.millisecondsInWeek)}return Jw}var Qw={},JD;function gte(){if(JD)return Qw;JD=1,Qw.getMilliseconds=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMilliseconds()}return Qw}var Xw={},QD;function xte(){if(QD)return Xw;QD=1,Xw.getMinutes=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMinutes()}return Xw}var e_={},XD;function yte(){if(XD)return e_;XD=1,e_.getMonth=e;var n=Fe();function e(t){return(0,n.toDate)(t).getMonth()}return e_}var t_={},eO;function vte(){if(eO)return t_;eO=1,t_.getOverlappingDaysInIntervals=r;var n=sd(),e=Xt(),t=Fe();function r(s,a){const[o,l]=[+(0,t.toDate)(s.start),+(0,t.toDate)(s.end)].sort((w,j)=>w-j),[c,d]=[+(0,t.toDate)(a.start),+(0,t.toDate)(a.end)].sort((w,j)=>w-j);if(!(o<d&&c<l))return 0;const p=c<o?o:c,x=p-(0,n.getTimezoneOffsetInMilliseconds)(p),y=d>l?l:d,_=y-(0,n.getTimezoneOffsetInMilliseconds)(y);return Math.ceil((_-x)/e.millisecondsInDay)}return t_}var n_={},tO;function bte(){if(tO)return n_;tO=1,n_.getSeconds=e;var n=Fe();function e(t){return(0,n.toDate)(t).getSeconds()}return n_}var r_={},nO;function wte(){if(nO)return r_;nO=1,r_.getTime=e;var n=Fe();function e(t){return(0,n.toDate)(t).getTime()}return r_}var s_={},rO;function _te(){if(rO)return s_;rO=1,s_.getUnixTime=e;var n=Fe();function e(t){return Math.trunc(+(0,n.toDate)(t)/1e3)}return s_}var i_={},sO;function jte(){if(sO)return i_;sO=1,i_.getWeekOfMonth=s;var n=P5(),e=Ny(),t=_y(),r=Ts();function s(a,o){const l=(0,r.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,n.getDate)(a);if(isNaN(d))return NaN;const h=(0,e.getDay)((0,t.startOfMonth)(a));let p=c-h;p<=0&&(p+=7);const x=d-p;return Math.ceil(x/7)+1}return i_}var a_={},o_={},iO;function I5(){if(iO)return o_;iO=1,o_.lastDayOfMonth=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth();return r.setFullYear(r.getFullYear(),s+1,0),r.setHours(0,0,0,0),r}return o_}var aO;function Nte(){if(aO)return a_;aO=1,a_.getWeeksInMonth=r;var n=$1(),e=I5(),t=_y();function r(s,a){return(0,n.differenceInCalendarWeeks)((0,e.lastDayOfMonth)(s),(0,t.startOfMonth)(s),a)+1}return a_}var l_={},oO;function Ste(){if(oO)return l_;oO=1,l_.getYear=e;var n=Fe();function e(t){return(0,n.toDate)(t).getFullYear()}return l_}var c_={},lO;function Cte(){if(lO)return c_;lO=1,c_.hoursToMilliseconds=e;var n=Xt();function e(t){return Math.trunc(t*n.millisecondsInHour)}return c_}var d_={},cO;function Tte(){if(cO)return d_;cO=1,d_.hoursToMinutes=e;var n=Xt();function e(t){return Math.trunc(t*n.minutesInHour)}return d_}var u_={},dO;function kte(){if(dO)return u_;dO=1,u_.hoursToSeconds=e;var n=Xt();function e(t){return Math.trunc(t*n.secondsInHour)}return u_}var f_={},uO;function Pte(){if(uO)return f_;uO=1,f_.interval=e;var n=Fe();function e(t,r,s){const a=(0,n.toDate)(t);if(isNaN(+a))throw new TypeError("Start date is invalid");const o=(0,n.toDate)(r);if(isNaN(+o))throw new TypeError("End date is invalid");if(s?.assertPositive&&+a>+o)throw new TypeError("End date must be after start date");return{start:a,end:o}}return f_}var h_={},fO;function Mte(){if(fO)return h_;fO=1,h_.intervalToDuration=c;var n=t5(),e=Y1(),t=G1(),r=Z1(),s=by(),a=wy(),o=x5(),l=Fe();function c(d){const h=(0,l.toDate)(d.start),p=(0,l.toDate)(d.end),x={},y=(0,o.differenceInYears)(p,h);y&&(x.years=y);const _=(0,n.add)(h,{years:x.years}),w=(0,s.differenceInMonths)(p,_);w&&(x.months=w);const j=(0,n.add)(_,{months:x.months}),C=(0,e.differenceInDays)(p,j);C&&(x.days=C);const P=(0,n.add)(j,{days:x.days}),O=(0,t.differenceInHours)(p,P);O&&(x.hours=O);const M=(0,n.add)(P,{hours:x.hours}),D=(0,r.differenceInMinutes)(p,M);D&&(x.minutes=D);const I=(0,n.add)(M,{minutes:x.minutes}),F=(0,a.differenceInSeconds)(p,I);return F&&(x.seconds=F),x}return h_}var m_={},hO;function Ete(){if(hO)return m_;hO=1,m_.intlFormat=e;var n=Fe();function e(r,s,a){let o;return t(s)?o=s:a=s,new Intl.DateTimeFormat(a?.locale,o).format((0,n.toDate)(r))}function t(r){return r!==void 0&&!("locale"in r)}return m_}var p_={},mO;function Dte(){if(mO)return p_;mO=1,p_.intlFormatDistance=h;var n=Xt(),e=id(),t=W1(),r=m5(),s=$1(),a=H1(),o=G1(),l=Z1(),c=wy(),d=Fe();function h(p,x,y){let _=0,w;const j=(0,d.toDate)(p),C=(0,d.toDate)(x);if(y?.unit)w=y?.unit,w==="second"?_=(0,c.differenceInSeconds)(j,C):w==="minute"?_=(0,l.differenceInMinutes)(j,C):w==="hour"?_=(0,o.differenceInHours)(j,C):w==="day"?_=(0,e.differenceInCalendarDays)(j,C):w==="week"?_=(0,s.differenceInCalendarWeeks)(j,C):w==="month"?_=(0,t.differenceInCalendarMonths)(j,C):w==="quarter"?_=(0,r.differenceInCalendarQuarters)(j,C):w==="year"&&(_=(0,a.differenceInCalendarYears)(j,C));else{const O=(0,c.differenceInSeconds)(j,C);Math.abs(O)<n.secondsInMinute?(_=(0,c.differenceInSeconds)(j,C),w="second"):Math.abs(O)<n.secondsInHour?(_=(0,l.differenceInMinutes)(j,C),w="minute"):Math.abs(O)<n.secondsInDay&&Math.abs((0,e.differenceInCalendarDays)(j,C))<1?(_=(0,o.differenceInHours)(j,C),w="hour"):Math.abs(O)<n.secondsInWeek&&(_=(0,e.differenceInCalendarDays)(j,C))&&Math.abs(_)<7?w="day":Math.abs(O)<n.secondsInMonth?(_=(0,s.differenceInCalendarWeeks)(j,C),w="week"):Math.abs(O)<n.secondsInQuarter?(_=(0,t.differenceInCalendarMonths)(j,C),w="month"):Math.abs(O)<n.secondsInYear&&(0,r.differenceInCalendarQuarters)(j,C)<4?(_=(0,r.differenceInCalendarQuarters)(j,C),w="quarter"):(_=(0,a.differenceInCalendarYears)(j,C),w="year")}return new Intl.RelativeTimeFormat(y?.locale,{localeMatcher:y?.localeMatcher,numeric:y?.numeric||"auto",style:y?.style}).format(_,w)}return p_}var g_={},pO;function Ote(){if(pO)return g_;pO=1,g_.isAfter=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getTime()>a.getTime()}return g_}var x_={},gO;function Ite(){if(gO)return x_;gO=1,x_.isBefore=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s<+a}return x_}var y_={},xO;function Ate(){if(xO)return y_;xO=1,y_.isEqual=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return+s==+a}return y_}var v_={},yO;function Rte(){if(yO)return v_;yO=1,v_.isExists=n;function n(e,t,r){const s=new Date(e,t,r);return s.getFullYear()===e&&s.getMonth()===t&&s.getDate()===r}return v_}var b_={},vO;function Lte(){if(vO)return b_;vO=1,b_.isFirstDayOfMonth=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDate()===1}return b_}var w_={},bO;function Fte(){if(bO)return w_;bO=1,w_.isFriday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===5}return w_}var __={},wO;function qte(){if(wO)return __;wO=1,__.isFuture=e;var n=Fe();function e(t){return+(0,n.toDate)(t)>Date.now()}return __}var j_={},N_={},sg={},ig={},ag={},Tc={},S_={},_O;function A5(){if(_O)return S_;_O=1,S_.transpose=e;var n=fn();function e(t,r){const s=r instanceof Date?(0,n.constructFrom)(r,0):new r(0);return s.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),s.setHours(t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()),s}return S_}var jO;function R5(){if(jO)return Tc;jO=1,Tc.ValueSetter=Tc.Setter=Tc.DateToSystemTimezoneSetter=void 0;var n=A5(),e=fn();const t=10;let r=class{subPriority=0;validate(l,c){return!0}};Tc.Setter=r;class s extends r{constructor(l,c,d,h,p){super(),this.value=l,this.validateValue=c,this.setValue=d,this.priority=h,p&&(this.subPriority=p)}validate(l,c){return this.validateValue(l,this.value,c)}set(l,c,d){return this.setValue(l,c,this.value,d)}}Tc.ValueSetter=s;class a extends r{priority=t;subPriority=-1;set(l,c){return c.timestampIsSet?l:(0,e.constructFrom)(l,(0,n.transpose)(l,Date))}}return Tc.DateToSystemTimezoneSetter=a,Tc}var NO;function gn(){if(NO)return ag;NO=1,ag.Parser=void 0;var n=R5();let e=class{run(r,s,a,o){const l=this.parse(r,s,a,o);return l?{setter:new n.ValueSetter(l.value,this.validate,this.set,this.priority,this.subPriority),rest:l.rest}:null}validate(r,s,a){return!0}};return ag.Parser=e,ag}var SO;function zte(){if(SO)return ig;SO=1,ig.EraParser=void 0;var n=gn();let e=class extends n.Parser{priority=140;parse(r,s,a){switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})||a.era(r,{width:"abbreviated"})||a.era(r,{width:"narrow"})}}set(r,s,a){return s.era=a,r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}incompatibleTokens=["R","u","t","T"]};return ig.EraParser=e,ig}var og={},_a={},tf={},CO;function ks(){return CO||(CO=1,tf.timezonePatterns=tf.numericPatterns=void 0,tf.numericPatterns={month:/^(1[0-2]|0?\d)/,date:/^(3[0-1]|[0-2]?\d)/,dayOfYear:/^(36[0-6]|3[0-5]\d|[0-2]?\d?\d)/,week:/^(5[0-3]|[0-4]?\d)/,hour23h:/^(2[0-3]|[0-1]?\d)/,hour24h:/^(2[0-4]|[0-1]?\d)/,hour11h:/^(1[0-1]|0?\d)/,hour12h:/^(1[0-2]|0?\d)/,minute:/^[0-5]?\d/,second:/^[0-5]?\d/,singleDigit:/^\d/,twoDigits:/^\d{1,2}/,threeDigits:/^\d{1,3}/,fourDigits:/^\d{1,4}/,anyDigitsSigned:/^-?\d+/,singleDigitSigned:/^-?\d/,twoDigitsSigned:/^-?\d{1,2}/,threeDigitsSigned:/^-?\d{1,3}/,fourDigitsSigned:/^-?\d{1,4}/},tf.timezonePatterns={basicOptionalMinutes:/^([+-])(\d{2})(\d{2})?|Z/,basic:/^([+-])(\d{2})(\d{2})|Z/,basicOptionalSeconds:/^([+-])(\d{2})(\d{2})((\d{2}))?|Z/,extended:/^([+-])(\d{2}):(\d{2})|Z/,extendedOptionalSeconds:/^([+-])(\d{2}):(\d{2})(:(\d{2}))?|Z/}),tf}var TO;function Nn(){if(TO)return _a;TO=1,_a.dayPeriodEnumToHours=c,_a.isLeapYearIndex=h,_a.mapValue=t,_a.normalizeTwoDigitYear=d,_a.parseAnyDigitsSigned=a,_a.parseNDigits=o,_a.parseNDigitsSigned=l,_a.parseNumericPattern=r,_a.parseTimezonePattern=s;var n=Xt(),e=ks();function t(p,x){return p&&{value:x(p.value),rest:p.rest}}function r(p,x){const y=x.match(p);return y?{value:parseInt(y[0],10),rest:x.slice(y[0].length)}:null}function s(p,x){const y=x.match(p);if(!y)return null;if(y[0]==="Z")return{value:0,rest:x.slice(1)};const _=y[1]==="+"?1:-1,w=y[2]?parseInt(y[2],10):0,j=y[3]?parseInt(y[3],10):0,C=y[5]?parseInt(y[5],10):0;return{value:_*(w*n.millisecondsInHour+j*n.millisecondsInMinute+C*n.millisecondsInSecond),rest:x.slice(y[0].length)}}function a(p){return r(e.numericPatterns.anyDigitsSigned,p)}function o(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigit,x);case 2:return r(e.numericPatterns.twoDigits,x);case 3:return r(e.numericPatterns.threeDigits,x);case 4:return r(e.numericPatterns.fourDigits,x);default:return r(new RegExp("^\\d{1,"+p+"}"),x)}}function l(p,x){switch(p){case 1:return r(e.numericPatterns.singleDigitSigned,x);case 2:return r(e.numericPatterns.twoDigitsSigned,x);case 3:return r(e.numericPatterns.threeDigitsSigned,x);case 4:return r(e.numericPatterns.fourDigitsSigned,x);default:return r(new RegExp("^-?\\d{1,"+p+"}"),x)}}function c(p){switch(p){case"morning":return 4;case"evening":return 17;case"pm":case"noon":case"afternoon":return 12;case"am":case"midnight":case"night":default:return 0}}function d(p,x){const y=x>0,_=y?x:1-x;let w;if(_<=50)w=p||100;else{const j=_+50,C=Math.trunc(j/100)*100,P=p>=j%100;w=p+C-(P?100:0)}return y?w:1-w}function h(p){return p%400===0||p%4===0&&p%100!==0}return _a}var kO;function Ute(){if(kO)return og;kO=1,og.YearParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=130;incompatibleTokens=["Y","R","u","w","I","i","e","c","t","T"];parse(s,a,o){const l=c=>({year:c,isTwoDigitYear:a==="yy"});switch(a){case"y":return(0,e.mapValue)((0,e.parseNDigits)(4,s),l);case"yo":return(0,e.mapValue)(o.ordinalNumber(s,{unit:"year"}),l);default:return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),l)}}validate(s,a){return a.isTwoDigitYear||a.year>0}set(s,a,o){const l=s.getFullYear();if(o.isTwoDigitYear){const d=(0,e.normalizeTwoDigitYear)(o.year,l);return s.setFullYear(d,0,1),s.setHours(0,0,0,0),s}const c=!("era"in a)||a.era===1?o.year:1-o.year;return s.setFullYear(c,0,1),s.setHours(0,0,0,0),s}};return og.YearParser=t,og}var lg={},PO;function Bte(){if(PO)return lg;PO=1,lg.LocalWeekYearParser=void 0;var n=jy(),e=Po(),t=gn(),r=Nn();let s=class extends t.Parser{priority=130;parse(o,l,c){const d=h=>({year:h,isTwoDigitYear:l==="YY"});switch(l){case"Y":return(0,r.mapValue)((0,r.parseNDigits)(4,o),d);case"Yo":return(0,r.mapValue)(c.ordinalNumber(o,{unit:"year"}),d);default:return(0,r.mapValue)((0,r.parseNDigits)(l.length,o),d)}}validate(o,l){return l.isTwoDigitYear||l.year>0}set(o,l,c,d){const h=(0,n.getWeekYear)(o,d);if(c.isTwoDigitYear){const x=(0,r.normalizeTwoDigitYear)(c.year,h);return o.setFullYear(x,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}const p=!("era"in l)||l.era===1?c.year:1-c.year;return o.setFullYear(p,0,d.firstWeekContainsDate),o.setHours(0,0,0,0),(0,e.startOfWeek)(o,d)}incompatibleTokens=["y","R","u","Q","q","M","L","I","d","D","i","t","T"]};return lg.LocalWeekYearParser=s,lg}var cg={},MO;function Vte(){if(MO)return cg;MO=1,cg.ISOWeekYearParser=void 0;var n=Ol(),e=fn(),t=gn(),r=Nn();let s=class extends t.Parser{priority=130;parse(o,l){return l==="R"?(0,r.parseNDigitsSigned)(4,o):(0,r.parseNDigitsSigned)(l.length,o)}set(o,l,c){const d=(0,e.constructFrom)(o,0);return d.setFullYear(c,0,4),d.setHours(0,0,0,0),(0,n.startOfISOWeek)(d)}incompatibleTokens=["G","y","Y","u","Q","q","M","L","w","d","D","e","c","t","T"]};return cg.ISOWeekYearParser=s,cg}var dg={},EO;function Wte(){if(EO)return dg;EO=1,dg.ExtendedYearParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=130;parse(s,a){return a==="u"?(0,e.parseNDigitsSigned)(4,s):(0,e.parseNDigitsSigned)(a.length,s)}set(s,a,o){return s.setFullYear(o,0,1),s.setHours(0,0,0,0),s}incompatibleTokens=["G","y","Y","R","w","I","i","e","c","t","T"]};return dg.ExtendedYearParser=t,dg}var ug={},DO;function $te(){if(DO)return ug;DO=1,ug.QuarterParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"Q":case"QQ":return(0,e.parseNDigits)(a.length,s);case"Qo":return o.ordinalNumber(s,{unit:"quarter"});case"QQQ":return o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQQ":return o.quarter(s,{width:"narrow",context:"formatting"});case"QQQQ":default:return o.quarter(s,{width:"wide",context:"formatting"})||o.quarter(s,{width:"abbreviated",context:"formatting"})||o.quarter(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","q","M","L","w","I","d","D","i","e","c","t","T"]};return ug.QuarterParser=t,ug}var fg={},OO;function Hte(){if(OO)return fg;OO=1,fg.StandAloneQuarterParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=120;parse(s,a,o){switch(a){case"q":case"qq":return(0,e.parseNDigits)(a.length,s);case"qo":return o.ordinalNumber(s,{unit:"quarter"});case"qqq":return o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"});case"qqqqq":return o.quarter(s,{width:"narrow",context:"standalone"});case"qqqq":default:return o.quarter(s,{width:"wide",context:"standalone"})||o.quarter(s,{width:"abbreviated",context:"standalone"})||o.quarter(s,{width:"narrow",context:"standalone"})}}validate(s,a){return a>=1&&a<=4}set(s,a,o){return s.setMonth((o-1)*3,1),s.setHours(0,0,0,0),s}incompatibleTokens=["Y","R","Q","M","L","w","I","d","D","i","e","c","t","T"]};return fg.StandAloneQuarterParser=t,fg}var hg={},IO;function Yte(){if(IO)return hg;IO=1,hg.MonthParser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{incompatibleTokens=["Y","R","q","Q","L","w","I","D","i","e","c","t","T"];priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"M":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"MM":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Mo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"MMM":return l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"});case"MMMMM":return l.month(a,{width:"narrow",context:"formatting"});case"MMMM":default:return l.month(a,{width:"wide",context:"formatting"})||l.month(a,{width:"abbreviated",context:"formatting"})||l.month(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}};return hg.MonthParser=r,hg}var mg={},AO;function Gte(){if(AO)return mg;AO=1,mg.StandAloneMonthParser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=110;parse(a,o,l){const c=d=>d-1;switch(o){case"L":return(0,t.mapValue)((0,t.parseNumericPattern)(n.numericPatterns.month,a),c);case"LL":return(0,t.mapValue)((0,t.parseNDigits)(2,a),c);case"Lo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"month"}),c);case"LLL":return l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"});case"LLLLL":return l.month(a,{width:"narrow",context:"standalone"});case"LLLL":default:return l.month(a,{width:"wide",context:"standalone"})||l.month(a,{width:"abbreviated",context:"standalone"})||l.month(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.setMonth(l,1),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","w","I","D","i","e","c","t","T"]};return mg.StandAloneMonthParser=r,mg}var pg={},C_={},RO;function L5(){if(RO)return C_;RO=1,C_.setWeek=t;var n=sC(),e=Fe();function t(r,s,a){const o=(0,e.toDate)(r),l=(0,n.getWeek)(o,a)-s;return o.setDate(o.getDate()-l*7),o}return C_}var LO;function Zte(){if(LO)return pg;LO=1,pg.LocalWeekParser=void 0;var n=L5(),e=Po(),t=ks(),r=gn(),s=Nn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"w":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"wo":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d,h){return(0,e.startOfWeek)((0,n.setWeek)(l,d,h),h)}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","i","t","T"]};return pg.LocalWeekParser=a,pg}var gg={},T_={},FO;function F5(){if(FO)return T_;FO=1,T_.setISOWeek=t;var n=nC(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=(0,n.getISOWeek)(a)-s;return a.setDate(a.getDate()-o*7),a}return T_}var qO;function Kte(){if(qO)return gg;qO=1,gg.ISOWeekParser=void 0;var n=F5(),e=Ol(),t=ks(),r=gn(),s=Nn();let a=class extends r.Parser{priority=100;parse(l,c,d){switch(c){case"I":return(0,s.parseNumericPattern)(t.numericPatterns.week,l);case"Io":return d.ordinalNumber(l,{unit:"week"});default:return(0,s.parseNDigits)(c.length,l)}}validate(l,c){return c>=1&&c<=53}set(l,c,d){return(0,e.startOfISOWeek)((0,n.setISOWeek)(l,d))}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","e","c","t","T"]};return gg.ISOWeekParser=a,gg}var xg={},zO;function Jte(){if(zO)return xg;zO=1,xg.DateParser=void 0;var n=ks(),e=gn(),t=Nn();const r=[31,28,31,30,31,30,31,31,30,31,30,31],s=[31,29,31,30,31,30,31,31,30,31,30,31];let a=class extends e.Parser{priority=90;subPriority=1;parse(l,c,d){switch(c){case"d":return(0,t.parseNumericPattern)(n.numericPatterns.date,l);case"do":return d.ordinalNumber(l,{unit:"date"});default:return(0,t.parseNDigits)(c.length,l)}}validate(l,c){const d=l.getFullYear(),h=(0,t.isLeapYearIndex)(d),p=l.getMonth();return h?c>=1&&c<=s[p]:c>=1&&c<=r[p]}set(l,c,d){return l.setDate(d),l.setHours(0,0,0,0),l}incompatibleTokens=["Y","R","q","Q","w","I","D","i","e","c","t","T"]};return xg.DateParser=a,xg}var yg={},UO;function Qte(){if(UO)return yg;UO=1,yg.DayOfYearParser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=90;subpriority=1;parse(a,o,l){switch(o){case"D":case"DD":return(0,t.parseNumericPattern)(n.numericPatterns.dayOfYear,a);case"Do":return l.ordinalNumber(a,{unit:"date"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){const l=a.getFullYear();return(0,t.isLeapYearIndex)(l)?o>=1&&o<=366:o>=1&&o<=365}set(a,o,l){return a.setMonth(0,l),a.setHours(0,0,0,0),a}incompatibleTokens=["Y","R","q","Q","M","L","w","I","d","E","i","e","c","t","T"]};return yg.DayOfYearParser=r,yg}var vg={},k_={},BO;function Sy(){if(BO)return k_;BO=1,k_.setDay=r;var n=Dl(),e=Fe(),t=Ts();function r(s,a,o){const l=(0,t.getDefaultOptions)(),c=o?.weekStartsOn??o?.locale?.options?.weekStartsOn??l.weekStartsOn??l.locale?.options?.weekStartsOn??0,d=(0,e.toDate)(s),h=d.getDay(),x=(a%7+7)%7,y=7-c,_=a<0||a>6?a-(h+y)%7:(x+y)%7-(h+y)%7;return(0,n.addDays)(d,_)}return k_}var VO;function Xte(){if(VO)return vg;VO=1,vg.DayParser=void 0;var n=Sy(),e=gn();let t=class extends e.Parser{priority=90;parse(s,a,o){switch(a){case"E":case"EE":case"EEE":return o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEEE":return o.day(s,{width:"narrow",context:"formatting"});case"EEEEEE":return o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"});case"EEEE":default:return o.day(s,{width:"wide",context:"formatting"})||o.day(s,{width:"abbreviated",context:"formatting"})||o.day(s,{width:"short",context:"formatting"})||o.day(s,{width:"narrow",context:"formatting"})}}validate(s,a){return a>=0&&a<=6}set(s,a,o,l){return s=(0,n.setDay)(s,o,l),s.setHours(0,0,0,0),s}incompatibleTokens=["D","i","e","c","t","T"]};return vg.DayParser=t,vg}var bg={},WO;function ene(){if(WO)return bg;WO=1,bg.LocalDayParser=void 0;var n=Sy(),e=gn(),t=Nn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"e":case"ee":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"eo":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"eee":return l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeeee":return l.day(a,{width:"narrow",context:"formatting"});case"eeeeee":return l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"});case"eeee":default:return l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","c","t","T"]};return bg.LocalDayParser=r,bg}var wg={},$O;function tne(){if($O)return wg;$O=1,wg.StandAloneLocalDayParser=void 0;var n=Sy(),e=gn(),t=Nn();let r=class extends e.Parser{priority=90;parse(a,o,l,c){const d=h=>{const p=Math.floor((h-1)/7)*7;return(h+c.weekStartsOn+6)%7+p};switch(o){case"c":case"cc":return(0,t.mapValue)((0,t.parseNDigits)(o.length,a),d);case"co":return(0,t.mapValue)(l.ordinalNumber(a,{unit:"day"}),d);case"ccc":return l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"ccccc":return l.day(a,{width:"narrow",context:"standalone"});case"cccccc":return l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"});case"cccc":default:return l.day(a,{width:"wide",context:"standalone"})||l.day(a,{width:"abbreviated",context:"standalone"})||l.day(a,{width:"short",context:"standalone"})||l.day(a,{width:"narrow",context:"standalone"})}}validate(a,o){return o>=0&&o<=6}set(a,o,l,c){return a=(0,n.setDay)(a,l,c),a.setHours(0,0,0,0),a}incompatibleTokens=["y","R","u","q","Q","M","L","I","d","D","E","i","e","t","T"]};return wg.StandAloneLocalDayParser=r,wg}var _g={},P_={},HO;function q5(){if(HO)return P_;HO=1,P_.setISODay=r;var n=Dl(),e=O5(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=(0,e.getISODay)(o),c=a-l;return(0,n.addDays)(o,c)}return P_}var YO;function nne(){if(YO)return _g;YO=1,_g.ISODayParser=void 0;var n=q5(),e=gn(),t=Nn();let r=class extends e.Parser{priority=90;parse(a,o,l){const c=d=>d===0?7:d;switch(o){case"i":case"ii":return(0,t.parseNDigits)(o.length,a);case"io":return l.ordinalNumber(a,{unit:"day"});case"iii":return(0,t.mapValue)(l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiii":return(0,t.mapValue)(l.day(a,{width:"narrow",context:"formatting"}),c);case"iiiiii":return(0,t.mapValue)(l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c);case"iiii":default:return(0,t.mapValue)(l.day(a,{width:"wide",context:"formatting"})||l.day(a,{width:"abbreviated",context:"formatting"})||l.day(a,{width:"short",context:"formatting"})||l.day(a,{width:"narrow",context:"formatting"}),c)}}validate(a,o){return o>=1&&o<=7}set(a,o,l){return a=(0,n.setISODay)(a,l),a.setHours(0,0,0,0),a}incompatibleTokens=["y","Y","u","q","Q","M","L","w","d","D","E","e","c","t","T"]};return _g.ISODayParser=r,_g}var jg={},GO;function rne(){if(GO)return jg;GO=1,jg.AMPMParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"a":case"aa":case"aaa":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaaa":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["b","B","H","k","t","T"]};return jg.AMPMParser=t,jg}var Ng={},ZO;function sne(){if(ZO)return Ng;ZO=1,Ng.AMPMMidnightParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"b":case"bb":case"bbb":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbbb":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","B","H","k","t","T"]};return Ng.AMPMMidnightParser=t,Ng}var Sg={},KO;function ine(){if(KO)return Sg;KO=1,Sg.DayPeriodParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=80;parse(s,a,o){switch(a){case"B":case"BB":case"BBB":return o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBBB":return o.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return o.dayPeriod(s,{width:"wide",context:"formatting"})||o.dayPeriod(s,{width:"abbreviated",context:"formatting"})||o.dayPeriod(s,{width:"narrow",context:"formatting"})}}set(s,a,o){return s.setHours((0,e.dayPeriodEnumToHours)(o),0,0,0),s}incompatibleTokens=["a","b","t","T"]};return Sg.DayPeriodParser=t,Sg}var Cg={},JO;function ane(){if(JO)return Cg;JO=1,Cg.Hour1to12Parser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"h":return(0,t.parseNumericPattern)(n.numericPatterns.hour12h,a);case"ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=12}set(a,o,l){const c=a.getHours()>=12;return c&&l<12?a.setHours(l+12,0,0,0):!c&&l===12?a.setHours(0,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["H","K","k","t","T"]};return Cg.Hour1to12Parser=r,Cg}var Tg={},QO;function one(){if(QO)return Tg;QO=1,Tg.Hour0to23Parser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"H":return(0,t.parseNumericPattern)(n.numericPatterns.hour23h,a);case"Ho":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=23}set(a,o,l){return a.setHours(l,0,0,0),a}incompatibleTokens=["a","b","h","K","k","t","T"]};return Tg.Hour0to23Parser=r,Tg}var kg={},XO;function lne(){if(XO)return kg;XO=1,kg.Hour0To11Parser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"K":return(0,t.parseNumericPattern)(n.numericPatterns.hour11h,a);case"Ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=11}set(a,o,l){return a.getHours()>=12&&l<12?a.setHours(l+12,0,0,0):a.setHours(l,0,0,0),a}incompatibleTokens=["h","H","k","t","T"]};return kg.Hour0To11Parser=r,kg}var Pg={},eI;function cne(){if(eI)return Pg;eI=1,Pg.Hour1To24Parser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=70;parse(a,o,l){switch(o){case"k":return(0,t.parseNumericPattern)(n.numericPatterns.hour24h,a);case"ko":return l.ordinalNumber(a,{unit:"hour"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=1&&o<=24}set(a,o,l){const c=l<=24?l%24:l;return a.setHours(c,0,0,0),a}incompatibleTokens=["a","b","h","H","K","t","T"]};return Pg.Hour1To24Parser=r,Pg}var Mg={},tI;function dne(){if(tI)return Mg;tI=1,Mg.MinuteParser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=60;parse(a,o,l){switch(o){case"m":return(0,t.parseNumericPattern)(n.numericPatterns.minute,a);case"mo":return l.ordinalNumber(a,{unit:"minute"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setMinutes(l,0,0),a}incompatibleTokens=["t","T"]};return Mg.MinuteParser=r,Mg}var Eg={},nI;function une(){if(nI)return Eg;nI=1,Eg.SecondParser=void 0;var n=ks(),e=gn(),t=Nn();let r=class extends e.Parser{priority=50;parse(a,o,l){switch(o){case"s":return(0,t.parseNumericPattern)(n.numericPatterns.second,a);case"so":return l.ordinalNumber(a,{unit:"second"});default:return(0,t.parseNDigits)(o.length,a)}}validate(a,o){return o>=0&&o<=59}set(a,o,l){return a.setSeconds(l,0),a}incompatibleTokens=["t","T"]};return Eg.SecondParser=r,Eg}var Dg={},rI;function fne(){if(rI)return Dg;rI=1,Dg.FractionOfSecondParser=void 0;var n=gn(),e=Nn();let t=class extends n.Parser{priority=30;parse(s,a){const o=l=>Math.trunc(l*Math.pow(10,-a.length+3));return(0,e.mapValue)((0,e.parseNDigits)(a.length,s),o)}set(s,a,o){return s.setMilliseconds(o),s}incompatibleTokens=["t","T"]};return Dg.FractionOfSecondParser=t,Dg}var Og={},sI;function hne(){if(sI)return Og;sI=1,Og.ISOTimezoneWithZParser=void 0;var n=fn(),e=sd(),t=ks(),r=gn(),s=Nn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"X":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"XX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"XXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"XXXXX":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"XXX":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","x"]};return Og.ISOTimezoneWithZParser=a,Og}var Ig={},iI;function mne(){if(iI)return Ig;iI=1,Ig.ISOTimezoneParser=void 0;var n=fn(),e=sd(),t=ks(),r=gn(),s=Nn();let a=class extends r.Parser{priority=10;parse(l,c){switch(c){case"x":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalMinutes,l);case"xx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basic,l);case"xxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.basicOptionalSeconds,l);case"xxxxx":return(0,s.parseTimezonePattern)(t.timezonePatterns.extendedOptionalSeconds,l);case"xxx":default:return(0,s.parseTimezonePattern)(t.timezonePatterns.extended,l)}}set(l,c,d){return c.timestampIsSet?l:(0,n.constructFrom)(l,l.getTime()-(0,e.getTimezoneOffsetInMilliseconds)(l)-d)}incompatibleTokens=["t","T","X"]};return Ig.ISOTimezoneParser=a,Ig}var Ag={},aI;function pne(){if(aI)return Ag;aI=1,Ag.TimestampSecondsParser=void 0;var n=fn(),e=gn(),t=Nn();let r=class extends e.Parser{priority=40;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l*1e3),{timestampIsSet:!0}]}incompatibleTokens="*"};return Ag.TimestampSecondsParser=r,Ag}var Rg={},oI;function gne(){if(oI)return Rg;oI=1,Rg.TimestampMillisecondsParser=void 0;var n=fn(),e=gn(),t=Nn();let r=class extends e.Parser{priority=20;parse(a){return(0,t.parseAnyDigitsSigned)(a)}set(a,o,l){return[(0,n.constructFrom)(a,l),{timestampIsSet:!0}]}incompatibleTokens="*"};return Rg.TimestampMillisecondsParser=r,Rg}var lI;function xne(){if(lI)return sg;lI=1,sg.parsers=void 0;var n=zte(),e=Ute(),t=Bte(),r=Vte(),s=Wte(),a=$te(),o=Hte(),l=Yte(),c=Gte(),d=Zte(),h=Kte(),p=Jte(),x=Qte(),y=Xte(),_=ene(),w=tne(),j=nne(),C=rne(),P=sne(),O=ine(),M=ane(),D=one(),I=lne(),F=cne(),q=dne(),B=une(),U=fne(),W=hne(),G=mne(),Z=pne(),Y=gne();return sg.parsers={G:new n.EraParser,y:new e.YearParser,Y:new t.LocalWeekYearParser,R:new r.ISOWeekYearParser,u:new s.ExtendedYearParser,Q:new a.QuarterParser,q:new o.StandAloneQuarterParser,M:new l.MonthParser,L:new c.StandAloneMonthParser,w:new d.LocalWeekParser,I:new h.ISOWeekParser,d:new p.DateParser,D:new x.DayOfYearParser,E:new y.DayParser,e:new _.LocalDayParser,c:new w.StandAloneLocalDayParser,i:new j.ISODayParser,a:new C.AMPMParser,b:new P.AMPMMidnightParser,B:new O.DayPeriodParser,h:new M.Hour1to12Parser,H:new D.Hour0to23Parser,K:new I.Hour0To11Parser,k:new F.Hour1To24Parser,m:new q.MinuteParser,s:new B.SecondParser,S:new U.FractionOfSecondParser,X:new W.ISOTimezoneWithZParser,x:new G.ISOTimezoneParser,t:new Z.TimestampSecondsParser,T:new Y.TimestampMillisecondsParser},sg}var cI;function z5(){return cI||(cI=1,(function(n){Object.defineProperty(n,"longFormatters",{enumerable:!0,get:function(){return a.longFormatters}}),n.parse=w,Object.defineProperty(n,"parsers",{enumerable:!0,get:function(){return l.parsers}});var e=fn(),t=D5(),r=Gf(),s=Fe(),a=N5(),o=S5(),l=xne(),c=R5();const d=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,h=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,p=/^'([^]*?)'?$/,x=/''/g,y=/\S/,_=/[a-zA-Z]/;function w(C,P,O,M){const D=(0,t.getDefaultOptions)(),I=M?.locale??D.locale??r.defaultLocale,F=M?.firstWeekContainsDate??M?.locale?.options?.firstWeekContainsDate??D.firstWeekContainsDate??D.locale?.options?.firstWeekContainsDate??1,q=M?.weekStartsOn??M?.locale?.options?.weekStartsOn??D.weekStartsOn??D.locale?.options?.weekStartsOn??0;if(P==="")return C===""?(0,s.toDate)(O):(0,e.constructFrom)(O,NaN);const B={firstWeekContainsDate:F,weekStartsOn:q,locale:I},U=[new c.DateToSystemTimezoneSetter],W=P.match(h).map(ee=>{const me=ee[0];if(me in a.longFormatters){const $=a.longFormatters[me];return $(ee,I.formatLong)}return ee}).join("").match(d),G=[];for(let ee of W){!M?.useAdditionalWeekYearTokens&&(0,o.isProtectedWeekYearToken)(ee)&&(0,o.warnOrThrowProtectedError)(ee,P,C),!M?.useAdditionalDayOfYearTokens&&(0,o.isProtectedDayOfYearToken)(ee)&&(0,o.warnOrThrowProtectedError)(ee,P,C);const me=ee[0],$=l.parsers[me];if($){const{incompatibleTokens:K}=$;if(Array.isArray(K)){const H=G.find(se=>K.includes(se.token)||se.token===me);if(H)throw new RangeError(`The format string mustn't contain \`${H.fullToken}\` and \`${ee}\` at the same time`)}else if($.incompatibleTokens==="*"&&G.length>0)throw new RangeError(`The format string mustn't contain \`${ee}\` and any other token at the same time`);G.push({token:me,fullToken:ee});const re=$.run(C,ee,I.match,B);if(!re)return(0,e.constructFrom)(O,NaN);U.push(re.setter),C=re.rest}else{if(me.match(_))throw new RangeError("Format string contains an unescaped latin alphabet character `"+me+"`");if(ee==="''"?ee="'":me==="'"&&(ee=j(ee)),C.indexOf(ee)===0)C=C.slice(ee.length);else return(0,e.constructFrom)(O,NaN)}}if(C.length>0&&y.test(C))return(0,e.constructFrom)(O,NaN);const Z=U.map(ee=>ee.priority).sort((ee,me)=>me-ee).filter((ee,me,$)=>$.indexOf(ee)===me).map(ee=>U.filter(me=>me.priority===ee).sort((me,$)=>$.subPriority-me.subPriority)).map(ee=>ee[0]);let Y=(0,s.toDate)(O);if(isNaN(Y.getTime()))return(0,e.constructFrom)(O,NaN);const ae={};for(const ee of Z){if(!ee.validate(Y,B))return(0,e.constructFrom)(O,NaN);const me=ee.set(Y,ae,B);Array.isArray(me)?(Y=me[0],Object.assign(ae,me[1])):Y=me}return(0,e.constructFrom)(O,Y)}function j(C){return C.match(p)[1].replace(x,"'")}})(N_)),N_}var dI;function yne(){if(dI)return j_;dI=1,j_.isMatch=t;var n=ad(),e=z5();function t(r,s,a){return(0,n.isValid)((0,e.parse)(r,s,new Date,a))}return j_}var M_={},uI;function vne(){if(uI)return M_;uI=1,M_.isMonday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===1}return M_}var E_={},fI;function bne(){if(fI)return E_;fI=1,E_.isPast=e;var n=Fe();function e(t){return+(0,n.toDate)(t)<Date.now()}return E_}var D_={},O_={},hI;function U5(){if(hI)return O_;hI=1,O_.startOfHour=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMinutes(0,0,0),r}return O_}var mI;function B5(){if(mI)return D_;mI=1,D_.isSameHour=e;var n=U5();function e(t,r){const s=(0,n.startOfHour)(t),a=(0,n.startOfHour)(r);return+s==+a}return D_}var I_={},A_={},pI;function iC(){if(pI)return A_;pI=1,A_.isSameWeek=e;var n=Po();function e(t,r,s){const a=(0,n.startOfWeek)(t,s),o=(0,n.startOfWeek)(r,s);return+a==+o}return A_}var gI;function V5(){if(gI)return I_;gI=1,I_.isSameISOWeek=e;var n=iC();function e(t,r){return(0,n.isSameWeek)(t,r,{weekStartsOn:1})}return I_}var R_={},xI;function wne(){if(xI)return R_;xI=1,R_.isSameISOWeekYear=e;var n=Lm();function e(t,r){const s=(0,n.startOfISOWeekYear)(t),a=(0,n.startOfISOWeekYear)(r);return+s==+a}return R_}var L_={},yI;function W5(){if(yI)return L_;yI=1,L_.isSameMinute=e;var n=Q1();function e(t,r){const s=(0,n.startOfMinute)(t),a=(0,n.startOfMinute)(r);return+s==+a}return L_}var F_={},vI;function $5(){if(vI)return F_;vI=1,F_.isSameMonth=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()&&s.getMonth()===a.getMonth()}return F_}var q_={},bI;function H5(){if(bI)return q_;bI=1,q_.isSameQuarter=e;var n=X1();function e(t,r){const s=(0,n.startOfQuarter)(t),a=(0,n.startOfQuarter)(r);return+s==+a}return q_}var z_={},U_={},wI;function Y5(){if(wI)return U_;wI=1,U_.startOfSecond=e;var n=Fe();function e(t){const r=(0,n.toDate)(t);return r.setMilliseconds(0),r}return U_}var _I;function G5(){if(_I)return z_;_I=1,z_.isSameSecond=e;var n=Y5();function e(t,r){const s=(0,n.startOfSecond)(t),a=(0,n.startOfSecond)(r);return+s==+a}return z_}var B_={},jI;function Z5(){if(jI)return B_;jI=1,B_.isSameYear=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t),a=(0,n.toDate)(r);return s.getFullYear()===a.getFullYear()}return B_}var V_={},NI;function _ne(){if(NI)return V_;NI=1,V_.isThisHour=t;var n=Js(),e=B5();function t(r){return(0,e.isSameHour)(r,(0,n.constructNow)(r))}return V_}var W_={},SI;function jne(){if(SI)return W_;SI=1,W_.isThisISOWeek=t;var n=Js(),e=V5();function t(r){return(0,e.isSameISOWeek)(r,(0,n.constructNow)(r))}return W_}var $_={},CI;function Nne(){if(CI)return $_;CI=1,$_.isThisMinute=t;var n=Js(),e=W5();function t(r){return(0,e.isSameMinute)(r,(0,n.constructNow)(r))}return $_}var H_={},TI;function Sne(){if(TI)return H_;TI=1,H_.isThisMonth=t;var n=Js(),e=$5();function t(r){return(0,e.isSameMonth)(r,(0,n.constructNow)(r))}return H_}var Y_={},kI;function Cne(){if(kI)return Y_;kI=1,Y_.isThisQuarter=t;var n=Js(),e=H5();function t(r){return(0,e.isSameQuarter)(r,(0,n.constructNow)(r))}return Y_}var G_={},PI;function Tne(){if(PI)return G_;PI=1,G_.isThisSecond=t;var n=Js(),e=G5();function t(r){return(0,e.isSameSecond)(r,(0,n.constructNow)(r))}return G_}var Z_={},MI;function kne(){if(MI)return Z_;MI=1,Z_.isThisWeek=t;var n=Js(),e=iC();function t(r,s){return(0,e.isSameWeek)(r,(0,n.constructNow)(r),s)}return Z_}var K_={},EI;function Pne(){if(EI)return K_;EI=1,K_.isThisYear=t;var n=Js(),e=Z5();function t(r){return(0,e.isSameYear)(r,(0,n.constructNow)(r))}return K_}var J_={},DI;function Mne(){if(DI)return J_;DI=1,J_.isThursday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===4}return J_}var Q_={},OI;function Ene(){if(OI)return Q_;OI=1,Q_.isToday=t;var n=Js(),e=Fm();function t(r){return(0,e.isSameDay)(r,(0,n.constructNow)(r))}return Q_}var X_={},II;function Dne(){if(II)return X_;II=1,X_.isTomorrow=r;var n=Dl(),e=Js(),t=Fm();function r(s){return(0,t.isSameDay)(s,(0,n.addDays)((0,e.constructNow)(s),1))}return X_}var ej={},AI;function One(){if(AI)return ej;AI=1,ej.isTuesday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===2}return ej}var tj={},RI;function Ine(){if(RI)return tj;RI=1,tj.isWednesday=e;var n=Fe();function e(t){return(0,n.toDate)(t).getDay()===3}return tj}var nj={},LI;function Ane(){if(LI)return nj;LI=1,nj.isWithinInterval=e;var n=Fe();function e(t,r){const s=+(0,n.toDate)(t),[a,o]=[+(0,n.toDate)(r.start),+(0,n.toDate)(r.end)].sort((l,c)=>l-c);return s>=a&&s<=o}return nj}var rj={},sj={},FI;function Cy(){if(FI)return sj;FI=1,sj.subDays=e;var n=Dl();function e(t,r){return(0,n.addDays)(t,-r)}return sj}var qI;function Rne(){if(qI)return rj;qI=1,rj.isYesterday=r;var n=Js(),e=Fm(),t=Cy();function r(s){return(0,e.isSameDay)(s,(0,t.subDays)((0,n.constructNow)(s),1))}return rj}var ij={},zI;function Lne(){if(zI)return ij;zI=1,ij.lastDayOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=9+Math.floor(s/10)*10;return r.setFullYear(a+1,0,0),r.setHours(0,0,0,0),r}return ij}var aj={},oj={},UI;function K5(){if(UI)return oj;UI=1,oj.lastDayOfWeek=t;var n=Fe(),e=Ts();function t(r,s){const a=(0,e.getDefaultOptions)(),o=s?.weekStartsOn??s?.locale?.options?.weekStartsOn??a.weekStartsOn??a.locale?.options?.weekStartsOn??0,l=(0,n.toDate)(r),c=l.getDay(),d=(c<o?-7:0)+6-(c-o);return l.setHours(0,0,0,0),l.setDate(l.getDate()+d),l}return oj}var BI;function Fne(){if(BI)return aj;BI=1,aj.lastDayOfISOWeek=e;var n=K5();function e(t){return(0,n.lastDayOfWeek)(t,{weekStartsOn:1})}return aj}var lj={},VI;function qne(){if(VI)return lj;VI=1,lj.lastDayOfISOWeekYear=r;var n=Su(),e=Ol(),t=fn();function r(s){const a=(0,n.getISOWeekYear)(s),o=(0,t.constructFrom)(s,0);o.setFullYear(a+1,0,4),o.setHours(0,0,0,0);const l=(0,e.startOfISOWeek)(o);return l.setDate(l.getDate()-1),l}return lj}var cj={},WI;function zne(){if(WI)return cj;WI=1,cj.lastDayOfQuarter=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getMonth(),a=s-s%3+3;return r.setMonth(a,0),r.setHours(0,0,0,0),r}return cj}var dj={},$I;function Une(){if($I)return dj;$I=1,dj.lastDayOfYear=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(0,0,0,0),r}return dj}var uj={},HI;function Bne(){return HI||(HI=1,(function(n){n.lightFormat=c,Object.defineProperty(n,"lightFormatters",{enumerable:!0,get:function(){return r.lightFormatters}});var e=ad(),t=Fe(),r=j5();const s=/(\w)\1*|''|'(''|[^'])+('|$)|./g,a=/^'([^]*?)'?$/,o=/''/g,l=/[a-zA-Z]/;function c(h,p){const x=(0,t.toDate)(h);if(!(0,e.isValid)(x))throw new RangeError("Invalid time value");const y=p.match(s);return y?y.map(w=>{if(w==="''")return"'";const j=w[0];if(j==="'")return d(w);const C=r.lightFormatters[j];if(C)return C(x,w);if(j.match(l))throw new RangeError("Format string contains an unescaped latin alphabet character `"+j+"`");return w}).join(""):""}function d(h){const p=h.match(a);return p?p[1].replace(o,"'"):h}})(uj)),uj}var fj={},YI;function Vne(){if(YI)return fj;YI=1,fj.milliseconds=e;var n=Xt();function e({years:t,months:r,weeks:s,days:a,hours:o,minutes:l,seconds:c}){let d=0;t&&(d+=t*n.daysInYear),r&&(d+=r*(n.daysInYear/12)),s&&(d+=s*7),a&&(d+=a);let h=d*24*60*60;return o&&(h+=o*60*60),l&&(h+=l*60),c&&(h+=c),Math.trunc(h*1e3)}return fj}var hj={},GI;function Wne(){if(GI)return hj;GI=1,hj.millisecondsToHours=e;var n=Xt();function e(t){const r=t/n.millisecondsInHour;return Math.trunc(r)}return hj}var mj={},ZI;function $ne(){if(ZI)return mj;ZI=1,mj.millisecondsToMinutes=e;var n=Xt();function e(t){const r=t/n.millisecondsInMinute;return Math.trunc(r)}return mj}var pj={},KI;function Hne(){if(KI)return pj;KI=1,pj.millisecondsToSeconds=e;var n=Xt();function e(t){const r=t/n.millisecondsInSecond;return Math.trunc(r)}return pj}var gj={},JI;function Yne(){if(JI)return gj;JI=1,gj.minutesToHours=e;var n=Xt();function e(t){const r=t/n.minutesInHour;return Math.trunc(r)}return gj}var xj={},QI;function Gne(){if(QI)return xj;QI=1,xj.minutesToMilliseconds=e;var n=Xt();function e(t){return Math.trunc(t*n.millisecondsInMinute)}return xj}var yj={},XI;function Zne(){if(XI)return yj;XI=1,yj.minutesToSeconds=e;var n=Xt();function e(t){return Math.trunc(t*n.secondsInMinute)}return yj}var vj={},eA;function Kne(){if(eA)return vj;eA=1,vj.monthsToQuarters=e;var n=Xt();function e(t){const r=t/n.monthsInQuarter;return Math.trunc(r)}return vj}var bj={},tA;function Jne(){if(tA)return bj;tA=1,bj.monthsToYears=e;var n=Xt();function e(t){const r=t/n.monthsInYear;return Math.trunc(r)}return bj}var wj={},nA;function ld(){if(nA)return wj;nA=1,wj.nextDay=t;var n=Dl(),e=Ny();function t(r,s){let a=s-(0,e.getDay)(r);return a<=0&&(a+=7),(0,n.addDays)(r,a)}return wj}var _j={},rA;function Qne(){if(rA)return _j;rA=1,_j.nextFriday=e;var n=ld();function e(t){return(0,n.nextDay)(t,5)}return _j}var jj={},sA;function Xne(){if(sA)return jj;sA=1,jj.nextMonday=e;var n=ld();function e(t){return(0,n.nextDay)(t,1)}return jj}var Nj={},iA;function ere(){if(iA)return Nj;iA=1,Nj.nextSaturday=e;var n=ld();function e(t){return(0,n.nextDay)(t,6)}return Nj}var Sj={},aA;function tre(){if(aA)return Sj;aA=1,Sj.nextSunday=e;var n=ld();function e(t){return(0,n.nextDay)(t,0)}return Sj}var Cj={},oA;function nre(){if(oA)return Cj;oA=1,Cj.nextThursday=e;var n=ld();function e(t){return(0,n.nextDay)(t,4)}return Cj}var Tj={},lA;function rre(){if(lA)return Tj;lA=1,Tj.nextTuesday=e;var n=ld();function e(t){return(0,n.nextDay)(t,2)}return Tj}var kj={},cA;function sre(){if(cA)return kj;cA=1,kj.nextWednesday=e;var n=ld();function e(t){return(0,n.nextDay)(t,3)}return kj}var Pj={},dA;function ire(){if(dA)return Pj;dA=1,Pj.parseISO=e;var n=Xt();function e(D,I){const F=I?.additionalDigits??2,q=o(D);let B;if(q.date){const Z=l(q.date,F);B=c(Z.restDateString,Z.year)}if(!B||isNaN(B.getTime()))return new Date(NaN);const U=B.getTime();let W=0,G;if(q.time&&(W=h(q.time),isNaN(W)))return new Date(NaN);if(q.timezone){if(G=x(q.timezone),isNaN(G))return new Date(NaN)}else{const Z=new Date(U+W),Y=new Date(0);return Y.setFullYear(Z.getUTCFullYear(),Z.getUTCMonth(),Z.getUTCDate()),Y.setHours(Z.getUTCHours(),Z.getUTCMinutes(),Z.getUTCSeconds(),Z.getUTCMilliseconds()),Y}return new Date(U+W+G)}const t={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},r=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,s=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,a=/^([+-])(\d{2})(?::?(\d{2}))?$/;function o(D){const I={},F=D.split(t.dateTimeDelimiter);let q;if(F.length>2)return I;if(/:/.test(F[0])?q=F[0]:(I.date=F[0],q=F[1],t.timeZoneDelimiter.test(I.date)&&(I.date=D.split(t.timeZoneDelimiter)[0],q=D.substr(I.date.length,D.length))),q){const B=t.timezone.exec(q);B?(I.time=q.replace(B[1],""),I.timezone=B[1]):I.time=q}return I}function l(D,I){const F=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+I)+"})|(\\d{2}|[+-]\\d{"+(2+I)+"})$)"),q=D.match(F);if(!q)return{year:NaN,restDateString:""};const B=q[1]?parseInt(q[1]):null,U=q[2]?parseInt(q[2]):null;return{year:U===null?B:U*100,restDateString:D.slice((q[1]||q[2]).length)}}function c(D,I){if(I===null)return new Date(NaN);const F=D.match(r);if(!F)return new Date(NaN);const q=!!F[4],B=d(F[1]),U=d(F[2])-1,W=d(F[3]),G=d(F[4]),Z=d(F[5])-1;if(q)return P(I,G,Z)?y(I,G,Z):new Date(NaN);{const Y=new Date(0);return!j(I,U,W)||!C(I,B)?new Date(NaN):(Y.setUTCFullYear(I,U,Math.max(B,W)),Y)}}function d(D){return D?parseInt(D):1}function h(D){const I=D.match(s);if(!I)return NaN;const F=p(I[1]),q=p(I[2]),B=p(I[3]);return O(F,q,B)?F*n.millisecondsInHour+q*n.millisecondsInMinute+B*1e3:NaN}function p(D){return D&&parseFloat(D.replace(",","."))||0}function x(D){if(D==="Z")return 0;const I=D.match(a);if(!I)return 0;const F=I[1]==="+"?-1:1,q=parseInt(I[2]),B=I[3]&&parseInt(I[3])||0;return M(q,B)?F*(q*n.millisecondsInHour+B*n.millisecondsInMinute):NaN}function y(D,I,F){const q=new Date(0);q.setUTCFullYear(D,0,4);const B=q.getUTCDay()||7,U=(I-1)*7+F+1-B;return q.setUTCDate(q.getUTCDate()+U),q}const _=[31,null,31,30,31,30,31,31,30,31,30,31];function w(D){return D%400===0||D%4===0&&D%100!==0}function j(D,I,F){return I>=0&&I<=11&&F>=1&&F<=(_[I]||(w(D)?29:28))}function C(D,I){return I>=1&&I<=(w(D)?366:365)}function P(D,I,F){return I>=1&&I<=53&&F>=0&&F<=6}function O(D,I,F){return D===24?I===0&&F===0:F>=0&&F<60&&I>=0&&I<60&&D>=0&&D<25}function M(D,I){return I>=0&&I<=59}return Pj}var Mj={},uA;function are(){if(uA)return Mj;uA=1,Mj.parseJSON=n;function n(e){const t=e.match(/(\d{4})-(\d{2})-(\d{2})[T ](\d{2}):(\d{2}):(\d{2})(?:\.(\d{0,7}))?(?:Z|(.)(\d{2}):?(\d{2})?)?/);return t?new Date(Date.UTC(+t[1],+t[2]-1,+t[3],+t[4]-(+t[9]||0)*(t[8]=="-"?-1:1),+t[5]-(+t[10]||0)*(t[8]=="-"?-1:1),+t[6],+((t[7]||"0")+"00").substring(0,3))):new Date(NaN)}return Mj}var Ej={},fA;function cd(){if(fA)return Ej;fA=1,Ej.previousDay=t;var n=Ny(),e=Cy();function t(r,s){let a=(0,n.getDay)(r)-s;return a<=0&&(a+=7),(0,e.subDays)(r,a)}return Ej}var Dj={},hA;function ore(){if(hA)return Dj;hA=1,Dj.previousFriday=e;var n=cd();function e(t){return(0,n.previousDay)(t,5)}return Dj}var Oj={},mA;function lre(){if(mA)return Oj;mA=1,Oj.previousMonday=e;var n=cd();function e(t){return(0,n.previousDay)(t,1)}return Oj}var Ij={},pA;function cre(){if(pA)return Ij;pA=1,Ij.previousSaturday=e;var n=cd();function e(t){return(0,n.previousDay)(t,6)}return Ij}var Aj={},gA;function dre(){if(gA)return Aj;gA=1,Aj.previousSunday=e;var n=cd();function e(t){return(0,n.previousDay)(t,0)}return Aj}var Rj={},xA;function ure(){if(xA)return Rj;xA=1,Rj.previousThursday=e;var n=cd();function e(t){return(0,n.previousDay)(t,4)}return Rj}var Lj={},yA;function fre(){if(yA)return Lj;yA=1,Lj.previousTuesday=e;var n=cd();function e(t){return(0,n.previousDay)(t,2)}return Lj}var Fj={},vA;function hre(){if(vA)return Fj;vA=1,Fj.previousWednesday=e;var n=cd();function e(t){return(0,n.previousDay)(t,3)}return Fj}var qj={},bA;function mre(){if(bA)return qj;bA=1,qj.quartersToMonths=e;var n=Xt();function e(t){return Math.trunc(t*n.monthsInQuarter)}return qj}var zj={},wA;function pre(){if(wA)return zj;wA=1,zj.quartersToYears=e;var n=Xt();function e(t){const r=t/n.quartersInYear;return Math.trunc(r)}return zj}var Uj={},_A;function gre(){if(_A)return Uj;_A=1,Uj.roundToNearestHours=r;var n=od(),e=fn(),t=Fe();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>12)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getMinutes()/60,d=l.getSeconds()/60/60,h=l.getMilliseconds()/1e3/60/60,p=l.getHours()+c+d+h,x=a?.roundingMethod??"round",_=(0,n.getRoundingMethod)(x)(p/o)*o,w=(0,e.constructFrom)(s,l);return w.setHours(_,0,0,0),w}return Uj}var Bj={},jA;function xre(){if(jA)return Bj;jA=1,Bj.roundToNearestMinutes=r;var n=od(),e=fn(),t=Fe();function r(s,a){const o=a?.nearestTo??1;if(o<1||o>30)return(0,e.constructFrom)(s,NaN);const l=(0,t.toDate)(s),c=l.getSeconds()/60,d=l.getMilliseconds()/1e3/60,h=l.getMinutes()+c+d,p=a?.roundingMethod??"round",y=(0,n.getRoundingMethod)(p)(h/o)*o,_=(0,e.constructFrom)(s,l);return _.setMinutes(y,0,0),_}return Bj}var Vj={},NA;function yre(){if(NA)return Vj;NA=1,Vj.secondsToHours=e;var n=Xt();function e(t){const r=t/n.secondsInHour;return Math.trunc(r)}return Vj}var Wj={},SA;function vre(){if(SA)return Wj;SA=1,Wj.secondsToMilliseconds=e;var n=Xt();function e(t){return t*n.millisecondsInSecond}return Wj}var $j={},CA;function bre(){if(CA)return $j;CA=1,$j.secondsToMinutes=e;var n=Xt();function e(t){const r=t/n.secondsInMinute;return Math.trunc(r)}return $j}var Hj={},Yj={},TA;function aC(){if(TA)return Yj;TA=1,Yj.setMonth=r;var n=fn(),e=M5(),t=Fe();function r(s,a){const o=(0,t.toDate)(s),l=o.getFullYear(),c=o.getDate(),d=(0,n.constructFrom)(s,0);d.setFullYear(l,a,15),d.setHours(0,0,0,0);const h=(0,e.getDaysInMonth)(d);return o.setMonth(a,Math.min(c,h)),o}return Yj}var kA;function wre(){if(kA)return Hj;kA=1,Hj.set=r;var n=fn(),e=aC(),t=Fe();function r(s,a){let o=(0,t.toDate)(s);return isNaN(+o)?(0,n.constructFrom)(s,NaN):(a.year!=null&&o.setFullYear(a.year),a.month!=null&&(o=(0,e.setMonth)(o,a.month)),a.date!=null&&o.setDate(a.date),a.hours!=null&&o.setHours(a.hours),a.minutes!=null&&o.setMinutes(a.minutes),a.seconds!=null&&o.setSeconds(a.seconds),a.milliseconds!=null&&o.setMilliseconds(a.milliseconds),o)}return Hj}var Gj={},PA;function _re(){if(PA)return Gj;PA=1,Gj.setDate=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setDate(r),s}return Gj}var Zj={},MA;function jre(){if(MA)return Zj;MA=1,Zj.setDayOfYear=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMonth(0),s.setDate(r),s}return Zj}var Kj={},EA;function Nre(){if(EA)return Kj;EA=1,Kj.setDefaultOptions=e;var n=Ts();function e(t){const r={},s=(0,n.getDefaultOptions)();for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&(r[a]=s[a]);for(const a in t)Object.prototype.hasOwnProperty.call(t,a)&&(t[a]===void 0?delete r[a]:r[a]=t[a]);(0,n.setDefaultOptions)(r)}return Kj}var Jj={},DA;function Sre(){if(DA)return Jj;DA=1,Jj.setHours=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setHours(r),s}return Jj}var Qj={},OA;function Cre(){if(OA)return Qj;OA=1,Qj.setMilliseconds=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMilliseconds(r),s}return Qj}var Xj={},IA;function Tre(){if(IA)return Xj;IA=1,Xj.setMinutes=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setMinutes(r),s}return Xj}var eN={},AA;function kre(){if(AA)return eN;AA=1,eN.setQuarter=t;var n=aC(),e=Fe();function t(r,s){const a=(0,e.toDate)(r),o=Math.trunc(a.getMonth()/3)+1,l=s-o;return(0,n.setMonth)(a,a.getMonth()+l*3)}return eN}var tN={},RA;function Pre(){if(RA)return tN;RA=1,tN.setSeconds=e;var n=Fe();function e(t,r){const s=(0,n.toDate)(t);return s.setSeconds(r),s}return tN}var nN={},LA;function Mre(){if(LA)return nN;LA=1,nN.setWeekYear=a;var n=fn(),e=id(),t=rC(),r=Fe(),s=Ts();function a(o,l,c){const d=(0,s.getDefaultOptions)(),h=c?.firstWeekContainsDate??c?.locale?.options?.firstWeekContainsDate??d.firstWeekContainsDate??d.locale?.options?.firstWeekContainsDate??1;let p=(0,r.toDate)(o);const x=(0,e.differenceInCalendarDays)(p,(0,t.startOfWeekYear)(p,c)),y=(0,n.constructFrom)(o,0);return y.setFullYear(l,0,h),y.setHours(0,0,0,0),p=(0,t.startOfWeekYear)(y,c),p.setDate(p.getDate()+x),p}return nN}var rN={},FA;function Ere(){if(FA)return rN;FA=1,rN.setYear=t;var n=fn(),e=Fe();function t(r,s){const a=(0,e.toDate)(r);return isNaN(+a)?(0,n.constructFrom)(r,NaN):(a.setFullYear(s),a)}return rN}var sN={},qA;function Dre(){if(qA)return sN;qA=1,sN.startOfDecade=e;var n=Fe();function e(t){const r=(0,n.toDate)(t),s=r.getFullYear(),a=Math.floor(s/10)*10;return r.setFullYear(a,0,1),r.setHours(0,0,0,0),r}return sN}var iN={},zA;function Ore(){if(zA)return iN;zA=1,iN.startOfToday=e;var n=xy();function e(){return(0,n.startOfDay)(Date.now())}return iN}var aN={},UA;function Ire(){if(UA)return aN;UA=1,aN.startOfTomorrow=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s+1),a.setHours(0,0,0,0),a}return aN}var oN={},BA;function Are(){if(BA)return oN;BA=1,oN.startOfYesterday=n;function n(){const e=new Date,t=e.getFullYear(),r=e.getMonth(),s=e.getDate(),a=new Date(0);return a.setFullYear(t,r,s-1),a.setHours(0,0,0,0),a}return oN}var lN={},cN={},VA;function J5(){if(VA)return cN;VA=1,cN.subMonths=e;var n=Am();function e(t,r){return(0,n.addMonths)(t,-r)}return cN}var WA;function Rre(){if(WA)return lN;WA=1,lN.sub=r;var n=Cy(),e=J5(),t=fn();function r(s,a){const{years:o=0,months:l=0,weeks:c=0,days:d=0,hours:h=0,minutes:p=0,seconds:x=0}=a,y=(0,e.subMonths)(s,l+o*12),_=(0,n.subDays)(y,d+c*7),w=p+h*60,C=(x+w*60)*1e3;return(0,t.constructFrom)(s,_.getTime()-C)}return lN}var dN={},$A;function Lre(){if($A)return dN;$A=1,dN.subBusinessDays=e;var n=s5();function e(t,r){return(0,n.addBusinessDays)(t,-r)}return dN}var uN={},HA;function Fre(){if(HA)return uN;HA=1,uN.subHours=e;var n=U1();function e(t,r){return(0,n.addHours)(t,-r)}return uN}var fN={},YA;function qre(){if(YA)return fN;YA=1,fN.subMilliseconds=e;var n=Rm();function e(t,r){return(0,n.addMilliseconds)(t,-r)}return fN}var hN={},GA;function zre(){if(GA)return hN;GA=1,hN.subMinutes=e;var n=B1();function e(t,r){return(0,n.addMinutes)(t,-r)}return hN}var mN={},ZA;function Ure(){if(ZA)return mN;ZA=1,mN.subQuarters=e;var n=V1();function e(t,r){return(0,n.addQuarters)(t,-r)}return mN}var pN={},KA;function Bre(){if(KA)return pN;KA=1,pN.subSeconds=e;var n=o5();function e(t,r){return(0,n.addSeconds)(t,-r)}return pN}var gN={},JA;function Vre(){if(JA)return gN;JA=1,gN.subWeeks=e;var n=yy();function e(t,r){return(0,n.addWeeks)(t,-r)}return gN}var xN={},QA;function Wre(){if(QA)return xN;QA=1,xN.subYears=e;var n=l5();function e(t,r){return(0,n.addYears)(t,-r)}return xN}var yN={},XA;function $re(){if(XA)return yN;XA=1,yN.weeksToDays=e;var n=Xt();function e(t){return Math.trunc(t*n.daysInWeek)}return yN}var vN={},eR;function Hre(){if(eR)return vN;eR=1,vN.yearsToDays=e;var n=Xt();function e(t){return Math.trunc(t*n.daysInYear)}return vN}var bN={},tR;function Yre(){if(tR)return bN;tR=1,bN.yearsToMonths=e;var n=Xt();function e(t){return Math.trunc(t*n.monthsInYear)}return bN}var wN={},nR;function Gre(){if(nR)return wN;nR=1,wN.yearsToQuarters=e;var n=Xt();function e(t){return Math.trunc(t*n.quartersInYear)}return wN}var rR;function Cu(){return rR||(rR=1,(function(n){var e=t5();Object.keys(e).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===e[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return e[g]}})});var t=s5();Object.keys(t).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===t[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return t[g]}})});var r=Dl();Object.keys(r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return r[g]}})});var s=U1();Object.keys(s).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===s[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return s[g]}})});var a=a5();Object.keys(a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return a[g]}})});var o=Rm();Object.keys(o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return o[g]}})});var l=B1();Object.keys(l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return l[g]}})});var c=Am();Object.keys(c).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===c[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return c[g]}})});var d=V1();Object.keys(d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return d[g]}})});var h=o5();Object.keys(h).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===h[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return h[g]}})});var p=yy();Object.keys(p).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===p[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return p[g]}})});var x=l5();Object.keys(x).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===x[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return x[g]}})});var y=xee();Object.keys(y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return y[g]}})});var _=yee();Object.keys(_).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _[g]}})});var w=vee();Object.keys(w).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===w[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return w[g]}})});var j=bee();Object.keys(j).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===j[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return j[g]}})});var C=Yf();Object.keys(C).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===C[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return C[g]}})});var P=wee();Object.keys(P).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===P[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return P[g]}})});var O=fn();Object.keys(O).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===O[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return O[g]}})});var M=Js();Object.keys(M).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===M[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return M[g]}})});var D=_ee();Object.keys(D).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===D[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return D[g]}})});var I=jee();Object.keys(I).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===I[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return I[g]}})});var F=id();Object.keys(F).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===F[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return F[g]}})});var q=f5();Object.keys(q).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===q[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return q[g]}})});var B=Nee();Object.keys(B).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===B[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return B[g]}})});var U=W1();Object.keys(U).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===U[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return U[g]}})});var W=m5();Object.keys(W).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===W[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return W[g]}})});var G=$1();Object.keys(G).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===G[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return G[g]}})});var Z=H1();Object.keys(Z).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Z[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Z[g]}})});var Y=Y1();Object.keys(Y).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Y[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Y[g]}})});var ae=G1();Object.keys(ae).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ae[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ae[g]}})});var ee=See();Object.keys(ee).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ee[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ee[g]}})});var me=vy();Object.keys(me).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===me[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return me[g]}})});var $=Z1();Object.keys($).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $[g]}})});var K=by();Object.keys(K).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===K[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return K[g]}})});var re=Cee();Object.keys(re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return re[g]}})});var H=wy();Object.keys(H).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===H[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return H[g]}})});var se=Tee();Object.keys(se).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===se[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return se[g]}})});var ie=x5();Object.keys(ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ie[g]}})});var ce=y5();Object.keys(ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ce[g]}})});var oe=kee();Object.keys(oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oe[g]}})});var de=Pee();Object.keys(de).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===de[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return de[g]}})});var te=Mee();Object.keys(te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return te[g]}})});var ye=Eee();Object.keys(ye).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ye[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ye[g]}})});var Ce=Dee();Object.keys(Ce).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ce[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ce[g]}})});var Re=eC();Object.keys(Re).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Re[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Re[g]}})});var Te=Oee();Object.keys(Te).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Te[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Te[g]}})});var je=Iee();Object.keys(je).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===je[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return je[g]}})});var ke=Aee();Object.keys(ke).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ke[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ke[g]}})});var Ue=K1();Object.keys(Ue).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ue[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ue[g]}})});var Ye=Ree();Object.keys(Ye).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ye[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ye[g]}})});var ve=Lee();Object.keys(ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ve[g]}})});var Oe=Fee();Object.keys(Oe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oe[g]}})});var Ve=qee();Object.keys(Ve).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ve[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ve[g]}})});var qe=zee();Object.keys(qe).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qe[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qe[g]}})});var X=J1();Object.keys(X).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===X[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return X[g]}})});var le=Uee();Object.keys(le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return le[g]}})});var he=Bee();Object.keys(he).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===he[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return he[g]}})});var Le=Vee();Object.keys(Le).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Le[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Le[g]}})});var Ie=Wee();Object.keys(Ie).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ie[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ie[g]}})});var ze=b5();Object.keys(ze).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ze[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ze[g]}})});var et=v5();Object.keys(et).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===et[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return et[g]}})});var tt=$ee();Object.keys(tt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===tt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return tt[g]}})});var ct=C5();Object.keys(ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ct[g]}})});var ht=T5();Object.keys(ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ht[g]}})});var Et=k5();Object.keys(Et).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Et[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Et[g]}})});var Mt=nte();Object.keys(Mt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mt[g]}})});var en=rte();Object.keys(en).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===en[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return en[g]}})});var Jt=ste();Object.keys(Jt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jt[g]}})});var Zt=ite();Object.keys(Zt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zt[g]}})});var on=ate();Object.keys(on).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===on[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return on[g]}})});var zt=ote();Object.keys(zt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zt[g]}})});var Sn=lte();Object.keys(Sn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Sn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Sn[g]}})});var qn=cte();Object.keys(qn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qn[g]}})});var bn=dte();Object.keys(bn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bn[g]}})});var nr=ute();Object.keys(nr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===nr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return nr[g]}})});var st=P5();Object.keys(st).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===st[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return st[g]}})});var Cn=Ny();Object.keys(Cn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cn[g]}})});var Rr=_5();Object.keys(Rr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rr[g]}})});var Jr=M5();Object.keys(Jr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jr[g]}})});var kn=fte();Object.keys(kn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kn[g]}})});var Ps=hte();Object.keys(Ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ps[g]}})});var Qs=D5();Object.keys(Qs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qs[g]}})});var Lr=mte();Object.keys(Lr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lr[g]}})});var _i=O5();Object.keys(_i).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_i[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _i[g]}})});var ra=nC();Object.keys(ra).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ra[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ra[g]}})});var Mo=Su();Object.keys(Mo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mo[g]}})});var sa=pte();Object.keys(sa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===sa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return sa[g]}})});var fd=gte();Object.keys(fd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fd[g]}})});var ur=xte();Object.keys(ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ur[g]}})});var dt=yte();Object.keys(dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return dt[g]}})});var ia=vte();Object.keys(ia).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ia[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ia[g]}})});var qa=h5();Object.keys(qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qa[g]}})});var Il=bte();Object.keys(Il).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Il[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Il[g]}})});var Al=wte();Object.keys(Al).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Al[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Al[g]}})});var Eo=_te();Object.keys(Eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Eo[g]}})});var Ms=sC();Object.keys(Ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ms[g]}})});var Xs=jte();Object.keys(Xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xs[g]}})});var Do=jy();Object.keys(Do).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Do[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Do[g]}})});var hd=Nte();Object.keys(hd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hd[g]}})});var Rl=Ste();Object.keys(Rl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Rl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Rl[g]}})});var Ll=Cte();Object.keys(Ll).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ll[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ll[g]}})});var Fl=Tte();Object.keys(Fl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fl[g]}})});var Oo=kte();Object.keys(Oo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oo[g]}})});var md=Pte();Object.keys(md).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===md[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return md[g]}})});var za=Mte();Object.keys(za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return za[g]}})});var Pn=Ete();Object.keys(Pn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pn[g]}})});var pd=Dte();Object.keys(pd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pd[g]}})});var Io=Ote();Object.keys(Io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Io[g]}})});var ql=Ite();Object.keys(ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ql[g]}})});var Ua=u5();Object.keys(Ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ua[g]}})});var Ao=Ate();Object.keys(Ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ao[g]}})});var ji=Rte();Object.keys(ji).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ji[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ji[g]}})});var aa=Lte();Object.keys(aa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===aa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return aa[g]}})});var Fr=Fte();Object.keys(Fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fr[g]}})});var oa=qte();Object.keys(oa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===oa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return oa[g]}})});var Ot=g5();Object.keys(Ot).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ot[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ot[g]}})});var wn=E5();Object.keys(wn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wn[g]}})});var Ba=yne();Object.keys(Ba).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ba[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ba[g]}})});var Ni=vne();Object.keys(Ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ni[g]}})});var hs=bne();Object.keys(hs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hs[g]}})});var Si=Fm();Object.keys(Si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Si[g]}})});var Dt=B5();Object.keys(Dt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Dt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Dt[g]}})});var xn=V5();Object.keys(xn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xn[g]}})});var Ro=wne();Object.keys(Ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ro[g]}})});var Va=W5();Object.keys(Va).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Va[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Va[g]}})});var fr=$5();Object.keys(fr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fr[g]}})});var zl=H5();Object.keys(zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zl[g]}})});var Ci=G5();Object.keys(Ci).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ci[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ci[g]}})});var qr=iC();Object.keys(qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qr[g]}})});var An=Z5();Object.keys(An).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===An[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return An[g]}})});var ms=n5();Object.keys(ms).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ms[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ms[g]}})});var Kt=r5();Object.keys(Kt).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kt[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kt[g]}})});var Ti=_ne();Object.keys(Ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ti[g]}})});var Wa=jne();Object.keys(Wa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wa[g]}})});var ei=Nne();Object.keys(ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ei[g]}})});var $a=Sne();Object.keys($a).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$a[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $a[g]}})});var Ha=Cne();Object.keys(Ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ha[g]}})});var la=Tne();Object.keys(la).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===la[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return la[g]}})});var ca=kne();Object.keys(ca).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ca[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ca[g]}})});var ki=Pne();Object.keys(ki).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ki[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ki[g]}})});var zr=Mne();Object.keys(zr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zr[g]}})});var ps=Ene();Object.keys(ps).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ps[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ps[g]}})});var Qr=Dne();Object.keys(Qr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qr[g]}})});var da=One();Object.keys(da).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===da[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return da[g]}})});var Ct=ad();Object.keys(Ct).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ct[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ct[g]}})});var Gn=Ine();Object.keys(Gn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gn[g]}})});var cn=gy();Object.keys(cn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===cn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return cn[g]}})});var Lo=Ane();Object.keys(Lo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Lo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Lo[g]}})});var ti=Rne();Object.keys(ti).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ti[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ti[g]}})});var Fo=Lne();Object.keys(Fo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Fo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Fo[g]}})});var Ya=Fne();Object.keys(Ya).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ya[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ya[g]}})});var Xr=qne();Object.keys(Xr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xr[g]}})});var Ga=I5();Object.keys(Ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ga[g]}})});var ua=zne();Object.keys(ua).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ua[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ua[g]}})});var Mn=K5();Object.keys(Mn).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mn[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mn[g]}})});var Ur=Une();Object.keys(Ur).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ur[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ur[g]}})});var ni=Bne();Object.keys(ni).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ni[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ni[g]}})});var fa=c5();Object.keys(fa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===fa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return fa[g]}})});var gd=Vne();Object.keys(gd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gd[g]}})});var Ul=Wne();Object.keys(Ul).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ul[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ul[g]}})});var ha=$ne();Object.keys(ha).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ha[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ha[g]}})});var Za=Hne();Object.keys(Za).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Za[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Za[g]}})});var Ka=d5();Object.keys(Ka).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ka[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ka[g]}})});var Ht=Yne();Object.keys(Ht).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ht[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ht[g]}})});var Es=Gne();Object.keys(Es).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Es[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Es[g]}})});var wr=Zne();Object.keys(wr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wr[g]}})});var Ds=Kne();Object.keys(Ds).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ds[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ds[g]}})});var qo=Jne();Object.keys(qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return qo[g]}})});var Ja=ld();Object.keys(Ja).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ja[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ja[g]}})});var Pi=Qne();Object.keys(Pi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Pi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Pi[g]}})});var Bl=Xne();Object.keys(Bl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bl[g]}})});var hr=ere();Object.keys(hr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===hr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return hr[g]}})});var Mi=tre();Object.keys(Mi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mi[g]}})});var zo=nre();Object.keys(zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return zo[g]}})});var ri=rre();Object.keys(ri).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ri[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ri[g]}})});var xd=sre();Object.keys(xd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xd[g]}})});var Mr=z5();Object.keys(Mr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Mr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Mr[g]}})});var Uo=ire();Object.keys(Uo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Uo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Uo[g]}})});var Ei=are();Object.keys(Ei).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ei[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ei[g]}})});var Br=cd();Object.keys(Br).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Br[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Br[g]}})});var Bo=ore();Object.keys(Bo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Bo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Bo[g]}})});var Vl=lre();Object.keys(Vl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vl[g]}})});var Vo=cre();Object.keys(Vo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vo[g]}})});var yd=dre();Object.keys(yd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===yd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return yd[g]}})});var Qa=ure();Object.keys(Qa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qa[g]}})});var Wl=fre();Object.keys(Wl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wl[g]}})});var vd=hre();Object.keys(vd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===vd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return vd[g]}})});var bd=mre();Object.keys(bd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===bd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return bd[g]}})});var Wo=pre();Object.keys(Wo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wo[g]}})});var wd=gre();Object.keys(wd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===wd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return wd[g]}})});var $o=xre();Object.keys($o).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$o[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $o[g]}})});var $l=yre();Object.keys($l).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===$l[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return $l[g]}})});var Xa=vre();Object.keys(Xa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xa[g]}})});var si=bre();Object.keys(si).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===si[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return si[g]}})});var _d=wre();Object.keys(_d).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_d[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _d[g]}})});var ii=_re();Object.keys(ii).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ii[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ii[g]}})});var Er=Sy();Object.keys(Er).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Er[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Er[g]}})});var Hl=jre();Object.keys(Hl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Hl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Hl[g]}})});var Yl=Nre();Object.keys(Yl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yl[g]}})});var Gl=Sre();Object.keys(Gl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Gl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Gl[g]}})});var Ho=q5();Object.keys(Ho).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ho[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ho[g]}})});var Yo=F5();Object.keys(Yo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Yo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Yo[g]}})});var jd=i5();Object.keys(jd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===jd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return jd[g]}})});var Nd=Cre();Object.keys(Nd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Nd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Nd[g]}})});var Zl=Tre();Object.keys(Zl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zl[g]}})});var Sd=aC();Object.keys(Sd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Sd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Sd[g]}})});var Vr=kre();Object.keys(Vr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Vr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Vr[g]}})});var Os=Pre();Object.keys(Os).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Os[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Os[g]}})});var ma=L5();Object.keys(ma).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ma[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ma[g]}})});var gs=Mre();Object.keys(gs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===gs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return gs[g]}})});var Kl=Ere();Object.keys(Kl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Kl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Kl[g]}})});var ai=xy();Object.keys(ai).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ai[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ai[g]}})});var Jl=Dre();Object.keys(Jl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jl[g]}})});var Di=U5();Object.keys(Di).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Di[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Di[g]}})});var Go=Ol();Object.keys(Go).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Go[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Go[g]}})});var xs=Lm();Object.keys(xs).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===xs[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return xs[g]}})});var Cd=Q1();Object.keys(Cd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Cd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Cd[g]}})});var Is=_y();Object.keys(Is).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Is[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Is[g]}})});var eo=X1();Object.keys(eo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===eo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return eo[g]}})});var Ql=Y5();Object.keys(Ql).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ql[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ql[g]}})});var to=Ore();Object.keys(to).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===to[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return to[g]}})});var pa=Ire();Object.keys(pa).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===pa[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return pa[g]}})});var _r=Po();Object.keys(_r).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===_r[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return _r[g]}})});var Td=rC();Object.keys(Td).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Td[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Td[g]}})});var ys=tC();Object.keys(ys).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ys[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ys[g]}})});var kd=Are();Object.keys(kd).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===kd[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return kd[g]}})});var es=Rre();Object.keys(es).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===es[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return es[g]}})});var Oi=Lre();Object.keys(Oi).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Oi[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Oi[g]}})});var no=Cy();Object.keys(no).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===no[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return no[g]}})});var ro=Fre();Object.keys(ro).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ro[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ro[g]}})});var ga=p5();Object.keys(ga).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ga[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ga[g]}})});var so=qre();Object.keys(so).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===so[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return so[g]}})});var io=zre();Object.keys(io).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===io[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return io[g]}})});var Ii=J5();Object.keys(Ii).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ii[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ii[g]}})});var ao=Ure();Object.keys(ao).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ao[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ao[g]}})});var Zo=Bre();Object.keys(Zo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Zo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Zo[g]}})});var Xl=Vre();Object.keys(Xl).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Xl[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Xl[g]}})});var Wr=Wre();Object.keys(Wr).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Wr[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Wr[g]}})});var As=Fe();Object.keys(As).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===As[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return As[g]}})});var ec=A5();Object.keys(ec).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===ec[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return ec[g]}})});var Ko=$re();Object.keys(Ko).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Ko[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Ko[g]}})});var tc=Hre();Object.keys(tc).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===tc[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return tc[g]}})});var Jo=Yre();Object.keys(Jo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Jo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Jo[g]}})});var Qo=Gre();Object.keys(Qo).forEach(function(g){g==="default"||g==="__esModule"||g in n&&n[g]===Qo[g]||Object.defineProperty(n,g,{enumerable:!0,get:function(){return Qo[g]}})})})(Fb)),Fb}var sR;function Ty(){if(sR)return Hd;sR=1,Object.defineProperty(Hd,"__esModule",{value:!0}),Hd.rangeShape=Hd.default=void 0;var n=o(Ks()),e=s(El()),t=s(Nu()),r=Cu();function s(y){return y&&y.__esModule?y:{default:y}}function a(y){if(typeof WeakMap!="function")return null;var _=new WeakMap,w=new WeakMap;return(a=function(j){return j?w:_})(y)}function o(y,_){if(y&&y.__esModule)return y;if(y===null||typeof y!="object"&&typeof y!="function")return{default:y};var w=a(_);if(w&&w.has(y))return w.get(y);var j={__proto__:null},C=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var P in y)if(P!=="default"&&Object.prototype.hasOwnProperty.call(y,P)){var O=C?Object.getOwnPropertyDescriptor(y,P):null;O&&(O.get||O.set)?Object.defineProperty(j,P,O):j[P]=y[P]}return j.default=y,w&&w.set(y,j),j}function l(){return l=Object.assign?Object.assign.bind():function(y){for(var _=1;_<arguments.length;_++){var w=arguments[_];for(var j in w)Object.prototype.hasOwnProperty.call(w,j)&&(y[j]=w[j])}return y},l.apply(this,arguments)}function c(y,_,w){return _=d(_),_ in y?Object.defineProperty(y,_,{value:w,enumerable:!0,configurable:!0,writable:!0}):y[_]=w,y}function d(y){var _=h(y,"string");return typeof _=="symbol"?_:String(_)}function h(y,_){if(typeof y!="object"||!y)return y;var w=y[Symbol.toPrimitive];if(w!==void 0){var j=w.call(y,_);if(typeof j!="object")return j;throw new TypeError("@@toPrimitive must return a primitive value.")}return(_==="string"?String:Number)(y)}let p=class extends n.Component{constructor(_,w){super(_,w),c(this,"handleKeyEvent",j=>{const{day:C,onMouseDown:P,onMouseUp:O}=this.props;[13,32].includes(j.keyCode)&&(j.type==="keydown"?P(C):O(C))}),c(this,"handleMouseEvent",j=>{const{day:C,disabled:P,onPreviewChange:O,onMouseEnter:M,onMouseDown:D,onMouseUp:I}=this.props,F={};if(P){O();return}switch(j.type){case"mouseenter":M(C),O(C),F.hover=!0;break;case"blur":case"mouseleave":F.hover=!1;break;case"mousedown":F.active=!0,D(C);break;case"mouseup":j.stopPropagation(),F.active=!1,I(C);break;case"focus":O(C);break}Object.keys(F).length&&this.setState(F)}),c(this,"getClassNames",()=>{const{isPassive:j,isToday:C,isWeekend:P,isStartOfWeek:O,isEndOfWeek:M,isStartOfMonth:D,isEndOfMonth:I,disabled:F,styles:q}=this.props;return(0,t.default)(q.day,{[q.dayPassive]:j,[q.dayDisabled]:F,[q.dayToday]:C,[q.dayWeekend]:P,[q.dayStartOfWeek]:O,[q.dayEndOfWeek]:M,[q.dayStartOfMonth]:D,[q.dayEndOfMonth]:I,[q.dayHovered]:this.state.hover,[q.dayActive]:this.state.active})}),c(this,"renderPreviewPlaceholder",()=>{const{preview:j,day:C,styles:P}=this.props;if(!j)return null;const O=j.startDate?(0,r.endOfDay)(j.startDate):null,M=j.endDate?(0,r.startOfDay)(j.endDate):null,D=(!O||(0,r.isAfter)(C,O))&&(!M||(0,r.isBefore)(C,M)),I=!D&&(0,r.isSameDay)(C,O),F=!D&&(0,r.isSameDay)(C,M);return n.default.createElement("span",{className:(0,t.default)({[P.dayStartPreview]:I,[P.dayInPreview]:D,[P.dayEndPreview]:F}),style:{color:j.color}})}),c(this,"renderSelectionPlaceholders",()=>{const{styles:j,ranges:C,day:P}=this.props;return this.props.displayMode==="date"?(0,r.isSameDay)(this.props.day,this.props.date)?n.default.createElement("span",{className:j.selected,style:{color:this.props.color}}):null:C.reduce((M,D)=>{let I=D.startDate,F=D.endDate;I&&F&&(0,r.isBefore)(F,I)&&([I,F]=[F,I]),I=I?(0,r.endOfDay)(I):null,F=F?(0,r.startOfDay)(F):null;const q=(!I||(0,r.isAfter)(P,I))&&(!F||(0,r.isBefore)(P,F)),B=!q&&(0,r.isSameDay)(P,I),U=!q&&(0,r.isSameDay)(P,F);return q||B||U?[...M,{isStartEdge:B,isEndEdge:U,isInRange:q,...D}]:M},[]).map((M,D)=>n.default.createElement("span",{key:D,className:(0,t.default)({[j.startEdge]:M.isStartEdge,[j.endEdge]:M.isEndEdge,[j.inRange]:M.isInRange}),style:{color:M.color||this.props.color}}))}),this.state={hover:!1,active:!1}}render(){const{dayContentRenderer:_}=this.props;return n.default.createElement("button",l({type:"button",onMouseEnter:this.handleMouseEvent,onMouseLeave:this.handleMouseEvent,onFocus:this.handleMouseEvent,onMouseDown:this.handleMouseEvent,onMouseUp:this.handleMouseEvent,onBlur:this.handleMouseEvent,onPauseCapture:this.handleMouseEvent,onKeyDown:this.handleKeyEvent,onKeyUp:this.handleKeyEvent,className:this.getClassNames(this.props.styles)},this.props.disabled||this.props.isPassive?{tabIndex:-1}:{},{style:{color:this.props.color}}),this.renderSelectionPlaceholders(),this.renderPreviewPlaceholder(),n.default.createElement("span",{className:this.props.styles.dayNumber},_?.(this.props.day)||n.default.createElement("span",null,(0,r.format)(this.props.day,this.props.dayDisplayFormat))))}};p.defaultProps={};const x=Hd.rangeShape=e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string,key:e.default.string,autoFocus:e.default.bool,disabled:e.default.bool,showDateDisplay:e.default.bool});return p.propTypes={day:e.default.object.isRequired,dayDisplayFormat:e.default.string,date:e.default.object,ranges:e.default.arrayOf(x),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),onPreviewChange:e.default.func,previewColor:e.default.string,disabled:e.default.bool,isPassive:e.default.bool,isToday:e.default.bool,isWeekend:e.default.bool,isStartOfWeek:e.default.bool,isEndOfWeek:e.default.bool,isStartOfMonth:e.default.bool,isEndOfMonth:e.default.bool,color:e.default.string,displayMode:e.default.oneOf(["dateRange","date"]),styles:e.default.object,onMouseDown:e.default.func,onMouseUp:e.default.func,onMouseEnter:e.default.func,dayContentRenderer:e.default.func},Hd.default=p,Hd}var Ph={},Yd={},iR;function ky(){if(iR)return Yd;iR=1,Object.defineProperty(Yd,"__esModule",{value:!0}),Yd.calcFocusDate=r,Yd.findNextRangeIndex=s,Yd.generateStyles=o,Yd.getMonthDisplayRange=a;var n=t(Nu()),e=Cu();function t(l){return l&&l.__esModule?l:{default:l}}function r(l,c){const{shownDate:d,date:h,months:p,ranges:x,focusedRange:y,displayMode:_}=c;let w;if(_==="dateRange"){const C=x[y[0]]||{};w={start:C.startDate,end:C.endDate}}else w={start:h,end:h};w.start=(0,e.startOfMonth)(w.start||new Date),w.end=(0,e.endOfMonth)(w.end||w.start);const j=w.start||w.end||d||new Date;return l?(0,e.differenceInCalendarMonths)(w.start,w.end)>p?l:j:d||j}function s(l){let c=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const d=l.findIndex((h,p)=>p>c&&h.autoFocus!==!1&&!h.disabled);return d!==-1?d:l.findIndex(h=>h.autoFocus!==!1&&!h.disabled)}function a(l,c,d){const h=(0,e.startOfMonth)(l,c),p=(0,e.endOfMonth)(l,c),x=(0,e.startOfWeek)(h,c);let y=(0,e.endOfWeek)(p,c);return d&&(0,e.differenceInCalendarDays)(y,x)<=34&&(y=(0,e.addDays)(y,7)),{start:x,end:y,startDateOfMonth:h,endDateOfMonth:p}}function o(l){return l.length?l.filter(d=>!!d).reduce((d,h)=>(Object.keys(h).forEach(p=>{d[p]=(0,n.default)(d[p],h[p])}),d),{}):{}}return Yd}var aR;function Zre(){if(aR)return Ph;aR=1,Object.defineProperty(Ph,"__esModule",{value:!0}),Ph.default=void 0;var n=l(Ks()),e=a(El()),t=l(Ty()),r=Cu(),s=ky();function a(p){return p&&p.__esModule?p:{default:p}}function o(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,y=new WeakMap;return(o=function(_){return _?y:x})(p)}function l(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var y=o(x);if(y&&y.has(p))return y.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=w?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(_,j,C):_[j]=p[j]}return _.default=p,y&&y.set(p,_),_}function c(){return c=Object.assign?Object.assign.bind():function(p){for(var x=1;x<arguments.length;x++){var y=arguments[x];for(var _ in y)Object.prototype.hasOwnProperty.call(y,_)&&(p[_]=y[_])}return p},c.apply(this,arguments)}function d(p,x,y){const _=new Date;return n.default.createElement("div",{className:p.weekDays},(0,r.eachDayOfInterval)({start:(0,r.startOfWeek)(_,x),end:(0,r.endOfWeek)(_,x)}).map((w,j)=>n.default.createElement("span",{className:p.weekDay,key:j},(0,r.format)(w,y,x))))}let h=class extends n.PureComponent{render(){const x=new Date,{displayMode:y,focusedRange:_,drag:w,styles:j,disabledDates:C,disabledDay:P}=this.props,O=this.props.minDate&&(0,r.startOfDay)(this.props.minDate),M=this.props.maxDate&&(0,r.endOfDay)(this.props.maxDate),D=(0,s.getMonthDisplayRange)(this.props.month,this.props.dateOptions,this.props.fixedHeight);let I=this.props.ranges;if(y==="dateRange"&&w.status){let{startDate:q,endDate:B}=w.range;I=I.map((U,W)=>W!==_[0]?U:{...U,startDate:q,endDate:B})}const F=this.props.showPreview&&!w.disablePreview;return n.default.createElement("div",{className:j.month,style:this.props.style},this.props.showMonthName?n.default.createElement("div",{className:j.monthName},(0,r.format)(this.props.month,this.props.monthDisplayFormat,this.props.dateOptions)):null,this.props.showWeekDays&&d(j,this.props.dateOptions,this.props.weekdayDisplayFormat),n.default.createElement("div",{className:j.days,onMouseLeave:this.props.onMouseLeave},(0,r.eachDayOfInterval)({start:D.start,end:D.end}).map((q,B)=>{const U=(0,r.isSameDay)(q,D.startDateOfMonth),W=(0,r.isSameDay)(q,D.endDateOfMonth),G=O&&(0,r.isBefore)(q,O)||M&&(0,r.isAfter)(q,M),Z=C.some(ae=>(0,r.isSameDay)(ae,q)),Y=P(q);return n.default.createElement(t.default,c({},this.props,{ranges:I,day:q,preview:F?this.props.preview:null,isWeekend:(0,r.isWeekend)(q,this.props.dateOptions),isToday:(0,r.isSameDay)(q,x),isStartOfWeek:(0,r.isSameDay)(q,(0,r.startOfWeek)(q,this.props.dateOptions)),isEndOfWeek:(0,r.isSameDay)(q,(0,r.endOfWeek)(q,this.props.dateOptions)),isStartOfMonth:U,isEndOfMonth:W,key:B,disabled:G||Z||Y,isPassive:!(0,r.isWithinInterval)(q,{start:D.startDateOfMonth,end:D.endDateOfMonth}),styles:j,onMouseDown:this.props.onDragSelectionStart,onMouseUp:this.props.onDragSelectionEnd,onMouseEnter:this.props.onDragSelectionMove,dragRange:w.range,drag:w.status}))})))}};return h.defaultProps={},h.propTypes={style:e.default.object,styles:e.default.object,month:e.default.object,drag:e.default.object,dateOptions:e.default.object,disabledDates:e.default.array,disabledDay:e.default.func,preview:e.default.shape({startDate:e.default.object,endDate:e.default.object}),showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),minDate:e.default.object,maxDate:e.default.object,ranges:e.default.arrayOf(t.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onDragSelectionStart:e.default.func,onDragSelectionEnd:e.default.func,onDragSelectionMove:e.default.func,onMouseLeave:e.default.func,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,dayDisplayFormat:e.default.string,showWeekDays:e.default.bool,showMonthName:e.default.bool,fixedHeight:e.default.bool},Ph.default=h,Ph}var Mh={},oR;function Kre(){if(oR)return Mh;oR=1,Object.defineProperty(Mh,"__esModule",{value:!0}),Mh.default=void 0;var n=o(Ks()),e=s(El()),t=s(Nu()),r=Cu();function s(p){return p&&p.__esModule?p:{default:p}}function a(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,y=new WeakMap;return(a=function(_){return _?y:x})(p)}function o(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var y=a(x);if(y&&y.has(p))return y.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=w?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(_,j,C):_[j]=p[j]}return _.default=p,y&&y.set(p,_),_}function l(p,x,y){return x=c(x),x in p?Object.defineProperty(p,x,{value:y,enumerable:!0,configurable:!0,writable:!0}):p[x]=y,p}function c(p){var x=d(p,"string");return typeof x=="symbol"?x:String(x)}function d(p,x){if(typeof p!="object"||!p)return p;var y=p[Symbol.toPrimitive];if(y!==void 0){var _=y.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}let h=class extends n.PureComponent{constructor(x,y){super(x,y),l(this,"onKeyDown",_=>{const{value:w}=this.state;_.key==="Enter"&&this.update(w)}),l(this,"onChange",_=>{this.setState({value:_.target.value,changed:!0,invalid:!1})}),l(this,"onBlur",()=>{const{value:_}=this.state;this.update(_)}),this.state={invalid:!1,changed:!1,value:this.formatDate(x)}}componentDidUpdate(x){const{value:y}=x;(0,r.isEqual)(y,this.props.value)||this.setState({value:this.formatDate(this.props)})}formatDate(x){let{value:y,dateDisplayFormat:_,dateOptions:w}=x;return y&&(0,r.isValid)(y)?(0,r.format)(y,_,w):""}update(x){const{invalid:y,changed:_}=this.state;if(y||!_||!x)return;const{onChange:w,dateDisplayFormat:j,dateOptions:C}=this.props,P=(0,r.parse)(x,j,new Date,C);(0,r.isValid)(P)?this.setState({changed:!1},()=>w(P)):this.setState({invalid:!0})}render(){const{className:x,readOnly:y,placeholder:_,ariaLabel:w,disabled:j,onFocus:C}=this.props,{value:P,invalid:O}=this.state;return n.default.createElement("span",{className:(0,t.default)("rdrDateInput",x)},n.default.createElement("input",{readOnly:y,disabled:j,value:P,placeholder:_,"aria-label":w,onKeyDown:this.onKeyDown,onChange:this.onChange,onBlur:this.onBlur,onFocus:C}),O&&n.default.createElement("span",{className:"rdrWarning"},""))}};return h.propTypes={value:e.default.object,placeholder:e.default.string,disabled:e.default.bool,readOnly:e.default.bool,dateOptions:e.default.object,dateDisplayFormat:e.default.string,ariaLabel:e.default.string,className:e.default.string,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={readOnly:!0,disabled:!1,dateDisplayFormat:"MMM D, YYYY"},Mh.default=h,Mh}var Lg={},lR;function Jre(){return lR||(lR=1,(function(n){(function(e,t){t(n,Ks(),e4())})(typeof globalThis<"u"?globalThis:typeof self<"u"?self:Lg,function(e,t,r){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;function s(se){"@babel/helpers - typeof";return s=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(ie){return typeof ie}:function(ie){return ie&&typeof Symbol=="function"&&ie.constructor===Symbol&&ie!==Symbol.prototype?"symbol":typeof ie},s(se)}function a(se,ie){if(!(se instanceof ie))throw new TypeError("Cannot call a class as a function")}function o(se,ie){for(var ce=0;ce<ie.length;ce++){var oe=ie[ce];oe.enumerable=oe.enumerable||!1,oe.configurable=!0,"value"in oe&&(oe.writable=!0),Object.defineProperty(se,P(oe.key),oe)}}function l(se,ie,ce){return ie&&o(se.prototype,ie),ce&&o(se,ce),Object.defineProperty(se,"prototype",{writable:!1}),se}function c(se,ie,ce){return ie=x(ie),d(se,p()?Reflect.construct(ie,ce||[],x(se).constructor):ie.apply(se,ce))}function d(se,ie){if(ie&&(s(ie)=="object"||typeof ie=="function"))return ie;if(ie!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return h(se)}function h(se){if(se===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return se}function p(){try{var se=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(p=function(){return!!se})()}function x(se){return x=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(ie){return ie.__proto__||Object.getPrototypeOf(ie)},x(se)}function y(se,ie){if(typeof ie!="function"&&ie!==null)throw new TypeError("Super expression must either be null or a function");se.prototype=Object.create(ie&&ie.prototype,{constructor:{value:se,writable:!0,configurable:!0}}),Object.defineProperty(se,"prototype",{writable:!1}),ie&&_(se,ie)}function _(se,ie){return _=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(ce,oe){return ce.__proto__=oe,ce},_(se,ie)}function w(se,ie){var ce=Object.keys(se);if(Object.getOwnPropertySymbols){var oe=Object.getOwnPropertySymbols(se);ie&&(oe=oe.filter(function(de){return Object.getOwnPropertyDescriptor(se,de).enumerable})),ce.push.apply(ce,oe)}return ce}function j(se){for(var ie=1;ie<arguments.length;ie++){var ce=arguments[ie]!=null?arguments[ie]:{};ie%2?w(Object(ce),!0).forEach(function(oe){C(se,oe,ce[oe])}):Object.getOwnPropertyDescriptors?Object.defineProperties(se,Object.getOwnPropertyDescriptors(ce)):w(Object(ce)).forEach(function(oe){Object.defineProperty(se,oe,Object.getOwnPropertyDescriptor(ce,oe))})}return se}function C(se,ie,ce){return(ie=P(ie))in se?Object.defineProperty(se,ie,{value:ce,enumerable:!0,configurable:!0,writable:!0}):se[ie]=ce,se}function P(se){var ie=O(se,"string");return s(ie)=="symbol"?ie:ie+""}function O(se,ie){if(s(se)!="object"||!se)return se;var ce=se[Symbol.toPrimitive];if(ce!==void 0){var oe=ce.call(se,ie);if(s(oe)!="object")return oe;throw new TypeError("@@toPrimitive must return a primitive value.")}return(ie==="string"?String:Number)(se)}var M={x:"clientWidth",y:"clientHeight"},D={x:"clientTop",y:"clientLeft"},I={x:"innerWidth",y:"innerHeight"},F={x:"offsetWidth",y:"offsetHeight"},q={x:"offsetLeft",y:"offsetTop"},B={x:"overflowX",y:"overflowY"},U={x:"scrollWidth",y:"scrollHeight"},W={x:"scrollLeft",y:"scrollTop"},G={x:"width",y:"height"},Z=function(){},Y=(function(){if(typeof window>"u")return!1;var se=!1;try{document.createElement("div").addEventListener("test",Z,{get passive(){return se=!0,!1}})}catch{}return se})()?{passive:!0}:!1,ae="ReactList failed to reach a stable state.",ee=40,me=function(ie,ce){for(var oe in ce)if(ie[oe]!==ce[oe])return!1;return!0},$=function(ie){for(var ce=ie.props.axis,oe=ie.getEl(),de=B[ce];oe=oe.parentElement;)switch(window.getComputedStyle(oe)[de]){case"auto":case"scroll":case"overlay":return oe}return window},K=function(ie){var ce=ie.props.axis,oe=ie.scrollParent;return oe===window?window[I[ce]]:oe[M[ce]]},re=function(ie,ce){var oe=ie.length,de=ie.minSize,te=ie.type,ye=ce.from,Ce=ce.size,Re=ce.itemsPerRow;Ce=Math.max(Ce,de);var Te=Ce%Re;return Te&&(Ce+=Re-Te),Ce>oe&&(Ce=oe),ye=te==="simple"||!ye?0:Math.max(Math.min(ye,oe-Ce),0),(Te=ye%Re)&&(ye-=Te,Ce+=Te),ye===ce.from&&Ce===ce.size?ce:j(j({},ce),{},{from:ye,size:Ce})},H=e.default=(function(se){function ie(ce){var oe;return a(this,ie),oe=c(this,ie,[ce]),oe.state=re(ce,{itemsPerRow:1,from:ce.initialIndex,size:0}),oe.cache={},oe.cachedScrollPosition=null,oe.prevPrevState={},oe.unstable=!1,oe.updateCounter=0,oe}return y(ie,se),l(ie,[{key:"componentDidMount",value:function(){this.updateFrameAndClearCache=this.updateFrameAndClearCache.bind(this),window.addEventListener("resize",this.updateFrameAndClearCache),this.updateFrame(this.scrollTo.bind(this,this.props.initialIndex))}},{key:"componentDidUpdate",value:function(oe){var de=this;if(this.props.axis!==oe.axis&&this.clearSizeCache(),!this.unstable){if(++this.updateCounter>ee)return this.unstable=!0,console.error(ae);this.updateCounterTimeoutId||(this.updateCounterTimeoutId=setTimeout(function(){de.updateCounter=0,delete de.updateCounterTimeoutId},0)),this.updateFrame()}}},{key:"maybeSetState",value:function(oe,de){if(me(this.state,oe))return de();this.setState(oe,de)}},{key:"componentWillUnmount",value:function(){window.removeEventListener("resize",this.updateFrameAndClearCache),this.scrollParent.removeEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.removeEventListener("mousewheel",Z,Y)}},{key:"getOffset",value:function(oe){var de=this.props.axis,te=oe[D[de]]||0,ye=q[de];do te+=oe[ye]||0;while(oe=oe.offsetParent);return te}},{key:"getEl",value:function(){return this.el||this.items}},{key:"getScrollPosition",value:function(){if(typeof this.cachedScrollPosition=="number")return this.cachedScrollPosition;var oe=this.scrollParent,de=this.props.axis,te=W[de],ye=oe===window?document.body[te]||document.documentElement[te]:oe[te],Ce=this.getScrollSize()-this.props.scrollParentViewportSizeGetter(this),Re=Math.max(0,Math.min(ye,Ce)),Te=this.getEl();return this.cachedScrollPosition=this.getOffset(oe)+Re-this.getOffset(Te),this.cachedScrollPosition}},{key:"setScroll",value:function(oe){var de=this.scrollParent,te=this.props.axis;if(oe+=this.getOffset(this.getEl()),de===window)return window.scrollTo(0,oe);oe-=this.getOffset(this.scrollParent),de[W[te]]=oe}},{key:"getScrollSize",value:function(){var oe=this.scrollParent,de=document,te=de.body,ye=de.documentElement,Ce=U[this.props.axis];return oe===window?Math.max(te[Ce],ye[Ce]):oe[Ce]}},{key:"hasDeterminateSize",value:function(){var oe=this.props,de=oe.itemSizeGetter,te=oe.type;return te==="uniform"||de}},{key:"getStartAndEnd",value:function(){var oe=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.threshold,de=this.getScrollPosition(),te=Math.max(0,de-oe),ye=de+this.props.scrollParentViewportSizeGetter(this)+oe;return this.hasDeterminateSize()&&(ye=Math.min(ye,this.getSpaceBefore(this.props.length))),{start:te,end:ye}}},{key:"getItemSizeAndItemsPerRow",value:function(){var oe=this.props,de=oe.axis,te=oe.useStaticSize,ye=this.state,Ce=ye.itemSize,Re=ye.itemsPerRow;if(te&&Ce&&Re)return{itemSize:Ce,itemsPerRow:Re};var Te=this.items.children;if(!Te.length)return{};var je=Te[0],ke=je[F[de]],Ue=Math.abs(ke-Ce);if((isNaN(Ue)||Ue>=1)&&(Ce=ke),!Ce)return{};var Ye=q[de],ve=je[Ye];Re=1;for(var Oe=Te[Re];Oe&&Oe[Ye]===ve;Oe=Te[Re])++Re;return{itemSize:Ce,itemsPerRow:Re}}},{key:"clearSizeCache",value:function(){this.cachedScrollPosition=null}},{key:"updateFrameAndClearCache",value:function(oe){return this.clearSizeCache(),this.updateFrame(oe)}},{key:"updateFrame",value:function(oe){switch(this.updateScrollParent(),typeof oe!="function"&&(oe=Z),this.props.type){case"simple":return this.updateSimpleFrame(oe);case"variable":return this.updateVariableFrame(oe);case"uniform":return this.updateUniformFrame(oe)}}},{key:"updateScrollParent",value:function(){var oe=this.scrollParent;this.scrollParent=this.props.scrollParentGetter(this),oe!==this.scrollParent&&(oe&&(oe.removeEventListener("scroll",this.updateFrameAndClearCache),oe.removeEventListener("mousewheel",Z)),this.clearSizeCache(),this.scrollParent.addEventListener("scroll",this.updateFrameAndClearCache,Y),this.scrollParent.addEventListener("mousewheel",Z,Y))}},{key:"updateSimpleFrame",value:function(oe){var de=this.getStartAndEnd(),te=de.end,ye=this.items.children,Ce=0;if(ye.length){var Re=this.props.axis,Te=ye[0],je=ye[ye.length-1];Ce=this.getOffset(je)+je[F[Re]]-this.getOffset(Te)}if(Ce>te)return oe();var ke=this.props,Ue=ke.pageSize,Ye=ke.length,ve=Math.min(this.state.size+Ue,Ye);this.maybeSetState({size:ve},oe)}},{key:"updateVariableFrame",value:function(oe){this.props.itemSizeGetter||this.cacheSizes();for(var de=this.getStartAndEnd(),te=de.start,ye=de.end,Ce=this.props,Re=Ce.length,Te=Ce.pageSize,je=0,ke=0,Ue=0,Ye=Re-1;ke<Ye;){var ve=this.getSizeOfItem(ke);if(ve==null||je+ve>te)break;je+=ve,++ke}for(var Oe=Re-ke;Ue<Oe&&je<ye;){var Ve=this.getSizeOfItem(ke+Ue);if(Ve==null){Ue=Math.min(Ue+Te,Oe);break}je+=Ve,++Ue}this.maybeSetState(re(this.props,{from:ke,itemsPerRow:1,size:Ue}),oe)}},{key:"updateUniformFrame",value:function(oe){var de=this.getItemSizeAndItemsPerRow(),te=de.itemSize,ye=de.itemsPerRow;if(!te||!ye)return oe();var Ce=this.getStartAndEnd(),Re=Ce.start,Te=Ce.end,je=re(this.props,{from:Math.floor(Re/te)*ye,size:(Math.ceil((Te-Re)/te)+1)*ye,itemsPerRow:ye}),ke=je.from,Ue=je.size;return this.maybeSetState({itemsPerRow:ye,from:ke,itemSize:te,size:Ue},oe)}},{key:"getSpaceBefore",value:function(oe){var de=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(de[oe]!=null)return de[oe];var te=this.state,ye=te.itemSize,Ce=te.itemsPerRow;if(ye)return de[oe]=Math.floor(oe/Ce)*ye;for(var Re=oe;Re>0&&de[--Re]==null;);for(var Te=de[Re]||0,je=Re;je<oe;++je){de[je]=Te;var ke=this.getSizeOfItem(je);if(ke==null)break;Te+=ke}return de[oe]=Te}},{key:"cacheSizes",value:function(){for(var oe=this.cache,de=this.state.from,te=this.items.children,ye=F[this.props.axis],Ce=0,Re=te.length;Ce<Re;++Ce)oe[de+Ce]=te[Ce][ye]}},{key:"getSizeOfItem",value:function(oe){var de=this.cache,te=this.items,ye=this.props,Ce=ye.axis,Re=ye.itemSizeGetter,Te=ye.itemSizeEstimator,je=ye.type,ke=this.state,Ue=ke.from,Ye=ke.itemSize,ve=ke.size;if(Ye)return Ye;if(Re)return Re(oe);if(oe in de)return de[oe];if(je==="simple"&&oe>=Ue&&oe<Ue+ve&&te){var Oe=te.children[oe-Ue];if(Oe)return Oe[F[Ce]]}if(Te)return Te(oe,de)}},{key:"scrollTo",value:function(oe){oe!=null&&this.setScroll(this.getSpaceBefore(oe))}},{key:"scrollAround",value:function(oe){var de=this.getScrollPosition(),te=this.getSpaceBefore(oe),ye=te-this.props.scrollParentViewportSizeGetter(this)+this.getSizeOfItem(oe),Ce=Math.min(ye,te),Re=Math.max(ye,te);if(de<=Ce)return this.setScroll(Ce);if(de>Re)return this.setScroll(Re)}},{key:"getVisibleRange",value:function(){for(var oe=this.state,de=oe.from,te=oe.size,ye=this.getStartAndEnd(0),Ce=ye.start,Re=ye.end,Te={},je,ke,Ue=de;Ue<de+te;++Ue){var Ye=this.getSpaceBefore(Ue,Te),ve=Ye+this.getSizeOfItem(Ue);je==null&&ve>Ce&&(je=Ue),je!=null&&Ye<Re&&(ke=Ue)}return[je,ke]}},{key:"renderItems",value:function(){for(var oe=this,de=this.props,te=de.itemRenderer,ye=de.itemsRenderer,Ce=this.state,Re=Ce.from,Te=Ce.size,je=[],ke=0;ke<Te;++ke)je.push(te(Re+ke,ke));return ye(je,function(Ue){return oe.items=Ue})}},{key:"render",value:function(){var oe=this,de=this.props,te=de.axis,ye=de.length,Ce=de.type,Re=de.useTranslate3d,Te=this.state,je=Te.from,ke=Te.itemsPerRow,Ue=this.renderItems();if(Ce==="simple")return Ue;var Ye={position:"relative"},ve={},Oe=Math.ceil(ye/ke)*ke,Ve=this.getSpaceBefore(Oe,ve);Ve&&(Ye[G[te]]=Ve,te==="x"&&(Ye.overflowX="hidden"));var qe=this.getSpaceBefore(je,ve),X=te==="x"?qe:0,le=te==="y"?qe:0,he=Re?"translate3d(".concat(X,"px, ").concat(le,"px, 0)"):"translate(".concat(X,"px, ").concat(le,"px)"),Le={msTransform:he,WebkitTransform:he,transform:he};return(0,r.jsx)("div",{style:Ye,ref:function(ze){return oe.el=ze},children:(0,r.jsx)("div",{style:Le,children:Ue})})}}],[{key:"getDerivedStateFromProps",value:function(oe,de){var te=re(oe,de);return te===de?null:te}}])})(t.Component);C(H,"displayName","ReactList"),C(H,"defaultProps",{axis:"y",itemRenderer:function(ie,ce){return(0,r.jsx)("div",{children:ie},ce)},itemsRenderer:function(ie,ce){return(0,r.jsx)("div",{ref:ce,children:ie})},length:0,minSize:1,pageSize:10,scrollParentGetter:$,scrollParentViewportSizeGetter:K,threshold:100,type:"simple",useStaticSize:!1,useTranslate3d:!1})})})(Lg)),Lg}function Qre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=Object.keys(n),r=Object.keys(e),s=t.length;if(r.length!==s)return!1;for(var a=0;a<s;a++){var o=t[a];if(n[o]!==e[o]||!Object.prototype.hasOwnProperty.call(e,o))return!1}return!0}function Xre(n,e){if(n===e)return!0;if(!n||!e)return!1;var t=n.length;if(e.length!==t)return!1;for(var r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}const ese=Object.freeze(Object.defineProperty({__proto__:null,shallowEqualArrays:Xre,shallowEqualObjects:Qre},Symbol.toStringTag,{value:"Module"})),tse=XL(ese);var Eh={},cR;function Py(){return cR||(cR=1,Object.defineProperty(Eh,"__esModule",{value:!0}),Eh.default=void 0,Eh.default={dateRangeWrapper:"rdrDateRangeWrapper",calendarWrapper:"rdrCalendarWrapper",dateDisplay:"rdrDateDisplay",dateDisplayItem:"rdrDateDisplayItem",dateDisplayItemActive:"rdrDateDisplayItemActive",monthAndYearWrapper:"rdrMonthAndYearWrapper",monthAndYearPickers:"rdrMonthAndYearPickers",nextPrevButton:"rdrNextPrevButton",month:"rdrMonth",weekDays:"rdrWeekDays",weekDay:"rdrWeekDay",days:"rdrDays",day:"rdrDay",dayNumber:"rdrDayNumber",dayPassive:"rdrDayPassive",dayToday:"rdrDayToday",dayStartOfWeek:"rdrDayStartOfWeek",dayEndOfWeek:"rdrDayEndOfWeek",daySelected:"rdrDaySelected",dayDisabled:"rdrDayDisabled",dayStartOfMonth:"rdrDayStartOfMonth",dayEndOfMonth:"rdrDayEndOfMonth",dayWeekend:"rdrDayWeekend",dayStartPreview:"rdrDayStartPreview",dayInPreview:"rdrDayInPreview",dayEndPreview:"rdrDayEndPreview",dayHovered:"rdrDayHovered",dayActive:"rdrDayActive",inRange:"rdrInRange",endEdge:"rdrEndEdge",startEdge:"rdrStartEdge",prevButton:"rdrPprevButton",nextButton:"rdrNextButton",selected:"rdrSelected",months:"rdrMonths",monthPicker:"rdrMonthPicker",yearPicker:"rdrYearPicker",dateDisplayWrapper:"rdrDateDisplayWrapper",definedRangesWrapper:"rdrDefinedRangesWrapper",staticRanges:"rdrStaticRanges",staticRange:"rdrStaticRange",inputRanges:"rdrInputRanges",inputRange:"rdrInputRange",inputRangeInput:"rdrInputRangeInput",dateRangePickerWrapper:"rdrDateRangePickerWrapper",staticRangeLabel:"rdrStaticRangeLabel",staticRangeSelected:"rdrStaticRangeSelected",monthName:"rdrMonthName",infiniteMonths:"rdrInfiniteMonths",monthsVertical:"rdrMonthsVertical",monthsHorizontal:"rdrMonthsHorizontal"}),Eh}var Dh={},dR;function nse(){if(dR)return Dh;dR=1,Object.defineProperty(Dh,"__esModule",{value:!0}),Dh.ariaLabelsShape=void 0;var n=e(El());function e(t){return t&&t.__esModule?t:{default:t}}return Dh.ariaLabelsShape=n.default.shape({dateInput:n.default.objectOf(n.default.shape({startDate:n.default.string,endDate:n.default.string})),monthPicker:n.default.string,yearPicker:n.default.string,prevButton:n.default.string,nextButton:n.default.string}),Dh}var uR;function Q5(){if(uR)return Th;uR=1,Object.defineProperty(Th,"__esModule",{value:!0}),Th.default=void 0;var n=w(Ks()),e=y(El()),t=Ty(),r=y(Zre()),s=y(Kre()),a=ky(),o=y(Nu()),l=y(Jre()),c=tse,d=Cu(),h=w5(),p=y(Py()),x=nse();function y(D){return D&&D.__esModule?D:{default:D}}function _(D){if(typeof WeakMap!="function")return null;var I=new WeakMap,F=new WeakMap;return(_=function(q){return q?F:I})(D)}function w(D,I){if(D&&D.__esModule)return D;if(D===null||typeof D!="object"&&typeof D!="function")return{default:D};var F=_(I);if(F&&F.has(D))return F.get(D);var q={__proto__:null},B=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var U in D)if(U!=="default"&&Object.prototype.hasOwnProperty.call(D,U)){var W=B?Object.getOwnPropertyDescriptor(D,U):null;W&&(W.get||W.set)?Object.defineProperty(q,U,W):q[U]=D[U]}return q.default=D,F&&F.set(D,q),q}function j(){return j=Object.assign?Object.assign.bind():function(D){for(var I=1;I<arguments.length;I++){var F=arguments[I];for(var q in F)Object.prototype.hasOwnProperty.call(F,q)&&(D[q]=F[q])}return D},j.apply(this,arguments)}function C(D,I,F){return I=P(I),I in D?Object.defineProperty(D,I,{value:F,enumerable:!0,configurable:!0,writable:!0}):D[I]=F,D}function P(D){var I=O(D,"string");return typeof I=="symbol"?I:String(I)}function O(D,I){if(typeof D!="object"||!D)return D;var F=D[Symbol.toPrimitive];if(F!==void 0){var q=F.call(D,I);if(typeof q!="object")return q;throw new TypeError("@@toPrimitive must return a primitive value.")}return(I==="string"?String:Number)(D)}let M=class WS extends n.PureComponent{constructor(I,F){var q;super(I,F),q=this,C(this,"focusToDate",function(B){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:q.props,W=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;if(!U.scroll.enabled){if(W&&U.preventSnapRefocus){const Y=(0,d.differenceInCalendarMonths)(B,q.state.focusedDate),ae=U.calendarFocus==="forwards"&&Y>=0,ee=U.calendarFocus==="backwards"&&Y<=0;if((ae||ee)&&Math.abs(Y)<U.months)return}q.setState({focusedDate:B});return}const G=(0,d.differenceInCalendarMonths)(B,U.minDate,q.dateOptions),Z=q.list.getVisibleRange();W&&Z.includes(G)||(q.isFirstRender=!0,q.list.scrollTo(G),q.setState({focusedDate:B}))}),C(this,"updateShownDate",function(){let B=arguments.length>0&&arguments[0]!==void 0?arguments[0]:q.props;const U=B.scroll.enabled?{...B,months:q.list.getVisibleRange().length}:B,W=(0,a.calcFocusDate)(q.state.focusedDate,U);q.focusToDate(W,U)}),C(this,"updatePreview",B=>{if(!B){this.setState({preview:null});return}const U={startDate:B,endDate:B,color:this.props.color};this.setState({preview:U})}),C(this,"changeShownDate",function(B){let U=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"set";const{focusedDate:W}=q.state,{onShownDateChange:G,minDate:Z,maxDate:Y}=q.props,ae={monthOffset:()=>(0,d.addMonths)(W,B),setMonth:()=>(0,d.setMonth)(W,B),setYear:()=>(0,d.setYear)(W,B),set:()=>B},ee=(0,d.min)([(0,d.max)([ae[U](),Z]),Y]);q.focusToDate(ee,q.props,!1),G&&G(ee)}),C(this,"handleRangeFocusChange",(B,U)=>{this.props.onRangeFocusChange&&this.props.onRangeFocusChange([B,U])}),C(this,"handleScroll",()=>{const{onShownDateChange:B,minDate:U}=this.props,{focusedDate:W}=this.state,{isFirstRender:G}=this,Z=this.list.getVisibleRange();if(Z[0]===void 0)return;const Y=(0,d.addMonths)(U,Z[0]||0);!(0,d.isSameMonth)(Y,W)&&!G&&(this.setState({focusedDate:Y}),B&&B(Y)),this.isFirstRender=!1}),C(this,"renderMonthAndYear",(B,U,W)=>{const{showMonthArrow:G,minDate:Z,maxDate:Y,showMonthAndYearPickers:ae,ariaLabels:ee}=W,me=(Y||WS.defaultProps.maxDate).getFullYear(),$=(Z||WS.defaultProps.minDate).getFullYear(),K=this.styles;return n.default.createElement("div",{onMouseUp:re=>re.stopPropagation(),className:K.monthAndYearWrapper},G?n.default.createElement("button",{type:"button",className:(0,o.default)(K.nextPrevButton,K.prevButton),onClick:()=>U(-1,"monthOffset"),"aria-label":ee.prevButton},n.default.createElement("i",null)):null,ae?n.default.createElement("span",{className:K.monthAndYearPickers},n.default.createElement("span",{className:K.monthPicker},n.default.createElement("select",{value:B.getMonth(),onChange:re=>U(re.target.value,"setMonth"),"aria-label":ee.monthPicker},this.state.monthNames.map((re,H)=>n.default.createElement("option",{key:H,value:H},re)))),n.default.createElement("span",{className:K.monthAndYearDivider}),n.default.createElement("span",{className:K.yearPicker},n.default.createElement("select",{value:B.getFullYear(),onChange:re=>U(re.target.value,"setYear"),"aria-label":ee.yearPicker},new Array(me-$+1).fill(me).map((re,H)=>{const se=re-H;return n.default.createElement("option",{key:se,value:se},se)})))):n.default.createElement("span",{className:K.monthAndYearPickers},this.state.monthNames[B.getMonth()]," ",B.getFullYear()),G?n.default.createElement("button",{type:"button",className:(0,o.default)(K.nextPrevButton,K.nextButton),onClick:()=>U(1,"monthOffset"),"aria-label":ee.nextButton},n.default.createElement("i",null)):null)}),C(this,"renderDateDisplay",()=>{const{focusedRange:B,color:U,ranges:W,rangeColors:G,dateDisplayFormat:Z,editableDateInputs:Y,startDatePlaceholder:ae,endDatePlaceholder:ee,ariaLabels:me}=this.props,$=G[B[0]]||U,K=this.styles;return n.default.createElement("div",{className:K.dateDisplayWrapper},W.map((re,H)=>re.showDateDisplay===!1||re.disabled&&!re.showDateDisplay?null:n.default.createElement("div",{className:K.dateDisplay,key:H,style:{color:re.color||$}},n.default.createElement(s.default,{className:(0,o.default)(K.dateDisplayItem,{[K.dateDisplayItemActive]:B[0]===H&&B[1]===0}),readOnly:!Y,disabled:re.disabled,value:re.startDate,placeholder:ae,dateOptions:this.dateOptions,dateDisplayFormat:Z,ariaLabel:me.dateInput&&me.dateInput[re.key]&&me.dateInput[re.key].startDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,0)}),n.default.createElement(s.default,{className:(0,o.default)(K.dateDisplayItem,{[K.dateDisplayItemActive]:B[0]===H&&B[1]===1}),readOnly:!Y,disabled:re.disabled,value:re.endDate,placeholder:ee,dateOptions:this.dateOptions,dateDisplayFormat:Z,ariaLabel:me.dateInput&&me.dateInput[re.key]&&me.dateInput[re.key].endDate,onChange:this.onDragSelectionEnd,onFocus:()=>this.handleRangeFocusChange(H,1)}))))}),C(this,"onDragSelectionStart",B=>{const{onChange:U,dragSelectionEnabled:W}=this.props;W?this.setState({drag:{status:!0,range:{startDate:B,endDate:B},disablePreview:!0}}):U&&U(B)}),C(this,"onDragSelectionEnd",B=>{const{updateRange:U,displayMode:W,onChange:G,dragSelectionEnabled:Z}=this.props;if(!Z)return;if(W==="date"||!this.state.drag.status){G&&G(B);return}const Y={startDate:this.state.drag.range.startDate,endDate:B};W!=="dateRange"||(0,d.isSameDay)(Y.startDate,B)?this.setState({drag:{status:!1,range:{}}},()=>G&&G(B)):this.setState({drag:{status:!1,range:{}}},()=>{U&&U(Y)})}),C(this,"onDragSelectionMove",B=>{const{drag:U}=this.state;!U.status||!this.props.dragSelectionEnabled||this.setState({drag:{status:U.status,range:{startDate:U.range.startDate,endDate:B},disablePreview:!0}})}),C(this,"estimateMonthSize",(B,U)=>{const{direction:W,minDate:G}=this.props,{scrollArea:Z}=this.state;if(U&&(this.listSizeCache=U,U[B]))return U[B];if(W==="horizontal")return Z.monthWidth;const Y=(0,d.addMonths)(G,B),{start:ae,end:ee}=(0,a.getMonthDisplayRange)(Y,this.dateOptions);return(0,d.differenceInDays)(ee,ae,this.dateOptions)+1>35?Z.longMonthHeight:Z.monthHeight}),this.dateOptions={locale:I.locale},I.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=I.weekStartsOn),this.styles=(0,a.generateStyles)([p.default,I.classNames]),this.listSizeCache={},this.isFirstRender=!0,this.state={monthNames:this.getMonthNames(),focusedDate:(0,a.calcFocusDate)(null,I),drag:{status:!1,range:{startDate:null,endDate:null},disablePreview:!1},scrollArea:this.calcScrollArea(I)}}getMonthNames(){return[...Array(12).keys()].map(I=>this.props.locale.localize.month(I))}calcScrollArea(I){const{direction:F,months:q,scroll:B}=I;if(!B.enabled)return{enabled:!1};const U=B.longMonthHeight||B.monthHeight;return F==="vertical"?{enabled:!0,monthHeight:B.monthHeight||220,longMonthHeight:U||260,calendarWidth:"auto",calendarHeight:(B.calendarHeight||U||240)*q}:{enabled:!0,monthWidth:B.monthWidth||332,calendarWidth:(B.calendarWidth||B.monthWidth||332)*q,monthHeight:U||300,calendarHeight:U||300}}componentDidMount(){this.props.scroll.enabled&&setTimeout(()=>this.focusToDate(this.state.focusedDate))}componentDidUpdate(I){const q={dateRange:"ranges",date:"date"}[this.props.displayMode];this.props[q]!==I[q]&&this.updateShownDate(this.props),(I.locale!==this.props.locale||I.weekStartsOn!==this.props.weekStartsOn)&&(this.dateOptions={locale:this.props.locale},this.props.weekStartsOn!==void 0&&(this.dateOptions.weekStartsOn=this.props.weekStartsOn),this.setState({monthNames:this.getMonthNames()})),(0,c.shallowEqualObjects)(I.scroll,this.props.scroll)||this.setState({scrollArea:this.calcScrollArea(this.props)})}renderWeekdays(){const I=new Date;return n.default.createElement("div",{className:this.styles.weekDays},(0,d.eachDayOfInterval)({start:(0,d.startOfWeek)(I,this.dateOptions),end:(0,d.endOfWeek)(I,this.dateOptions)}).map((F,q)=>n.default.createElement("span",{className:this.styles.weekDay,key:q},(0,d.format)(F,this.props.weekdayDisplayFormat,this.dateOptions))))}render(){const{showDateDisplay:I,onPreviewChange:F,scroll:q,direction:B,disabledDates:U,disabledDay:W,maxDate:G,minDate:Z,rangeColors:Y,color:ae,navigatorRenderer:ee,className:me,preview:$}=this.props,{scrollArea:K,focusedDate:re}=this.state,H=B==="vertical",se=ee||this.renderMonthAndYear,ie=this.props.ranges.map((ce,oe)=>({...ce,color:ce.color||Y[oe]||ae}));return n.default.createElement("div",{className:(0,o.default)(this.styles.calendarWrapper,me),onMouseUp:()=>this.setState({drag:{status:!1,range:{}}}),onMouseLeave:()=>{this.setState({drag:{status:!1,range:{}}})}},I&&this.renderDateDisplay(),se(re,this.changeShownDate,this.props),q.enabled?n.default.createElement("div",null,H&&this.renderWeekdays(this.dateOptions),n.default.createElement("div",{className:(0,o.default)(this.styles.infiniteMonths,H?this.styles.monthsVertical:this.styles.monthsHorizontal),onMouseLeave:()=>F&&F(),style:{width:K.calendarWidth+11,height:K.calendarHeight+11},onScroll:this.handleScroll},n.default.createElement(l.default,{length:(0,d.differenceInCalendarMonths)((0,d.endOfMonth)(G),(0,d.addDays)((0,d.startOfMonth)(Z),-1),this.dateOptions),treshold:500,type:"variable",ref:ce=>this.list=ce,itemSizeEstimator:this.estimateMonthSize,axis:H?"y":"x",itemRenderer:(ce,oe)=>{const de=(0,d.addMonths)(Z,ce);return n.default.createElement(r.default,j({},this.props,{onPreviewChange:F||this.updatePreview,preview:$||this.state.preview,ranges:ie,key:oe,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:de,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>F&&F(),styles:this.styles,style:H?{height:this.estimateMonthSize(ce)}:{height:K.monthHeight,width:this.estimateMonthSize(ce)},showMonthName:!0,showWeekDays:!H}))}}))):n.default.createElement("div",{className:(0,o.default)(this.styles.months,H?this.styles.monthsVertical:this.styles.monthsHorizontal)},new Array(this.props.months).fill(null).map((ce,oe)=>{let de=(0,d.addMonths)(this.state.focusedDate,oe);return this.props.calendarFocus==="backwards"&&(de=(0,d.subMonths)(this.state.focusedDate,this.props.months-1-oe)),n.default.createElement(r.default,j({},this.props,{onPreviewChange:F||this.updatePreview,preview:$||this.state.preview,ranges:ie,key:oe,drag:this.state.drag,dateOptions:this.dateOptions,disabledDates:U,disabledDay:W,month:de,onDragSelectionStart:this.onDragSelectionStart,onDragSelectionEnd:this.onDragSelectionEnd,onDragSelectionMove:this.onDragSelectionMove,onMouseLeave:()=>F&&F(),styles:this.styles,showWeekDays:!H||oe===0,showMonthName:!H||oe>0}))})))}};return M.defaultProps={showMonthArrow:!0,showMonthAndYearPickers:!0,disabledDates:[],disabledDay:()=>{},classNames:{},locale:h.enUS,ranges:[],focusedRange:[0,0],dateDisplayFormat:"MMM d, yyyy",monthDisplayFormat:"MMM yyyy",weekdayDisplayFormat:"E",dayDisplayFormat:"d",showDateDisplay:!0,showPreview:!0,displayMode:"date",months:1,color:"#3d91ff",scroll:{enabled:!1},direction:"vertical",maxDate:(0,d.addYears)(new Date,20),minDate:(0,d.addYears)(new Date,-100),rangeColors:["#3d91ff","#3ecf8e","#fed14c"],startDatePlaceholder:"Early",endDatePlaceholder:"Continuous",editableDateInputs:!1,dragSelectionEnabled:!0,fixedHeight:!1,calendarFocus:"forwards",preventSnapRefocus:!1,ariaLabels:{}},M.propTypes={showMonthArrow:e.default.bool,showMonthAndYearPickers:e.default.bool,disabledDates:e.default.array,disabledDay:e.default.func,minDate:e.default.object,maxDate:e.default.object,date:e.default.object,onChange:e.default.func,onPreviewChange:e.default.func,onRangeFocusChange:e.default.func,classNames:e.default.object,locale:e.default.object,shownDate:e.default.object,onShownDateChange:e.default.func,ranges:e.default.arrayOf(t.rangeShape),preview:e.default.shape({startDate:e.default.object,endDate:e.default.object,color:e.default.string}),dateDisplayFormat:e.default.string,monthDisplayFormat:e.default.string,weekdayDisplayFormat:e.default.string,weekStartsOn:e.default.number,dayDisplayFormat:e.default.string,focusedRange:e.default.arrayOf(e.default.number),initialFocusedRange:e.default.arrayOf(e.default.number),months:e.default.number,className:e.default.string,showDateDisplay:e.default.bool,showPreview:e.default.bool,displayMode:e.default.oneOf(["dateRange","date"]),color:e.default.string,updateRange:e.default.func,scroll:e.default.shape({enabled:e.default.bool,monthHeight:e.default.number,longMonthHeight:e.default.number,monthWidth:e.default.number,calendarWidth:e.default.number,calendarHeight:e.default.number}),direction:e.default.oneOf(["vertical","horizontal"]),startDatePlaceholder:e.default.string,endDatePlaceholder:e.default.string,navigatorRenderer:e.default.func,rangeColors:e.default.arrayOf(e.default.string),editableDateInputs:e.default.bool,dragSelectionEnabled:e.default.bool,fixedHeight:e.default.bool,calendarFocus:e.default.string,preventSnapRefocus:e.default.bool,ariaLabels:x.ariaLabelsShape},Th.default=M,Th}var fR;function X5(){if(fR)return Ch;fR=1,Object.defineProperty(Ch,"__esModule",{value:!0}),Ch.default=void 0;var n=h(Ks()),e=c(El()),t=c(Q5()),r=Ty(),s=ky(),a=Cu(),o=c(Nu()),l=c(Py());function c(j){return j&&j.__esModule?j:{default:j}}function d(j){if(typeof WeakMap!="function")return null;var C=new WeakMap,P=new WeakMap;return(d=function(O){return O?P:C})(j)}function h(j,C){if(j&&j.__esModule)return j;if(j===null||typeof j!="object"&&typeof j!="function")return{default:j};var P=d(C);if(P&&P.has(j))return P.get(j);var O={__proto__:null},M=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var D in j)if(D!=="default"&&Object.prototype.hasOwnProperty.call(j,D)){var I=M?Object.getOwnPropertyDescriptor(j,D):null;I&&(I.get||I.set)?Object.defineProperty(O,D,I):O[D]=j[D]}return O.default=j,P&&P.set(j,O),O}function p(){return p=Object.assign?Object.assign.bind():function(j){for(var C=1;C<arguments.length;C++){var P=arguments[C];for(var O in P)Object.prototype.hasOwnProperty.call(P,O)&&(j[O]=P[O])}return j},p.apply(this,arguments)}function x(j,C,P){return C=y(C),C in j?Object.defineProperty(j,C,{value:P,enumerable:!0,configurable:!0,writable:!0}):j[C]=P,j}function y(j){var C=_(j,"string");return typeof C=="symbol"?C:String(C)}function _(j,C){if(typeof j!="object"||!j)return j;var P=j[Symbol.toPrimitive];if(P!==void 0){var O=P.call(j,C);if(typeof O!="object")return O;throw new TypeError("@@toPrimitive must return a primitive value.")}return(C==="string"?String:Number)(j)}let w=class extends n.Component{constructor(C,P){var O;super(C,P),O=this,x(this,"calcNewSelection",function(M){let D=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const I=O.props.focusedRange||O.state.focusedRange,{ranges:F,onChange:q,maxDate:B,moveRangeOnFirstSelection:U,retainEndDateOnFirstSelection:W,disabledDates:G}=O.props,Z=I[0],Y=F[Z];if(!Y||!q)return{};let{startDate:ae,endDate:ee}=Y;const me=new Date;let $;if(!D)ae=M.startDate,ee=M.endDate;else if(I[1]===0){const H=(0,a.differenceInCalendarDays)(ee||me,ae),se=()=>U?(0,a.addDays)(M,H):W?!ee||(0,a.isBefore)(M,ee)?ee:M:M||me;ae=M,ee=se(),B&&(ee=(0,a.min)([ee,B])),$=[I[0],1]}else ee=M;let K=I[1]===0;(0,a.isBefore)(ee,ae)&&(K=!K,[ae,ee]=[ee,ae]);const re=G.filter(H=>(0,a.isWithinInterval)(H,{start:ae,end:ee}));return re.length>0&&(K?ae=(0,a.addDays)((0,a.max)(re),1):ee=(0,a.addDays)((0,a.min)(re),-1)),$||($=[(0,s.findNextRangeIndex)(O.props.ranges,I[0]),0]),{wasValid:!(re.length>0),range:{startDate:ae,endDate:ee},nextFocusRange:$}}),x(this,"setSelection",(M,D)=>{const{onChange:I,ranges:F,onRangeFocusChange:q}=this.props,U=(this.props.focusedRange||this.state.focusedRange)[0],W=F[U];if(!W)return;const G=this.calcNewSelection(M,D);I({[W.key||`range${U+1}`]:{...W,...G.range}}),this.setState({focusedRange:G.nextFocusRange,preview:null}),q&&q(G.nextFocusRange)}),x(this,"handleRangeFocusChange",M=>{this.setState({focusedRange:M}),this.props.onRangeFocusChange&&this.props.onRangeFocusChange(M)}),x(this,"updatePreview",M=>{if(!M){this.setState({preview:null});return}const{rangeColors:D,ranges:I}=this.props,F=this.props.focusedRange||this.state.focusedRange,q=I[F[0]]?.color||D[F[0]]||q;this.setState({preview:{...M.range,color:q}})}),this.state={focusedRange:C.initialFocusedRange||[(0,s.findNextRangeIndex)(C.ranges),0],preview:null},this.styles=(0,s.generateStyles)([l.default,C.classNames])}render(){return n.default.createElement(t.default,p({focusedRange:this.state.focusedRange,onRangeFocusChange:this.handleRangeFocusChange,preview:this.state.preview,onPreviewChange:C=>{this.updatePreview(C?this.calcNewSelection(C):null)}},this.props,{displayMode:"dateRange",className:(0,o.default)(this.styles.dateRangeWrapper,this.props.className),onChange:this.setSelection,updateRange:C=>this.setSelection(C,!1),ref:C=>{this.calendar=C}}))}};return w.defaultProps={classNames:{},ranges:[],moveRangeOnFirstSelection:!1,retainEndDateOnFirstSelection:!1,rangeColors:["#3d91ff","#3ecf8e","#fed14c"],disabledDates:[]},w.propTypes={...t.default.propTypes,onChange:e.default.func,onRangeFocusChange:e.default.func,className:e.default.string,ranges:e.default.arrayOf(r.rangeShape),moveRangeOnFirstSelection:e.default.bool,retainEndDateOnFirstSelection:e.default.bool},Ch.default=w,Ch}var Oh={},Ih={},kc={},hR;function e6(){if(hR)return kc;hR=1,Object.defineProperty(kc,"__esModule",{value:!0}),kc.createStaticRanges=r,kc.defaultStaticRanges=kc.defaultInputRanges=void 0;var n=Cu();const e={startOfWeek:(0,n.startOfWeek)(new Date),endOfWeek:(0,n.endOfWeek)(new Date),startOfLastWeek:(0,n.startOfWeek)((0,n.addDays)(new Date,-7)),endOfLastWeek:(0,n.endOfWeek)((0,n.addDays)(new Date,-7)),startOfToday:(0,n.startOfDay)(new Date),endOfToday:(0,n.endOfDay)(new Date),startOfYesterday:(0,n.startOfDay)((0,n.addDays)(new Date,-1)),endOfYesterday:(0,n.endOfDay)((0,n.addDays)(new Date,-1)),startOfMonth:(0,n.startOfMonth)(new Date),endOfMonth:(0,n.endOfMonth)(new Date),startOfLastMonth:(0,n.startOfMonth)((0,n.addMonths)(new Date,-1)),endOfLastMonth:(0,n.endOfMonth)((0,n.addMonths)(new Date,-1))},t={range:{},isSelected(s){const a=this.range();return(0,n.isSameDay)(s.startDate,a.startDate)&&(0,n.isSameDay)(s.endDate,a.endDate)}};function r(s){return s.map(a=>({...t,...a}))}return kc.defaultStaticRanges=r([{label:"Today",range:()=>({startDate:e.startOfToday,endDate:e.endOfToday})},{label:"Yesterday",range:()=>({startDate:e.startOfYesterday,endDate:e.endOfYesterday})},{label:"This Week",range:()=>({startDate:e.startOfWeek,endDate:e.endOfWeek})},{label:"Last Week",range:()=>({startDate:e.startOfLastWeek,endDate:e.endOfLastWeek})},{label:"This Month",range:()=>({startDate:e.startOfMonth,endDate:e.endOfMonth})},{label:"Last Month",range:()=>({startDate:e.startOfLastMonth,endDate:e.endOfLastMonth})}]),kc.defaultInputRanges=[{label:"days up to today",range(s){return{startDate:(0,n.addDays)(e.startOfToday,(Math.max(Number(s),1)-1)*-1),endDate:e.endOfToday}},getCurrentValue(s){return(0,n.isSameDay)(s.endDate,e.endOfToday)?s.startDate?(0,n.differenceInCalendarDays)(e.endOfToday,s.startDate)+1:"":"-"}},{label:"days starting today",range(s){const a=new Date;return{startDate:a,endDate:(0,n.addDays)(a,Math.max(Number(s),1)-1)}},getCurrentValue(s){return(0,n.isSameDay)(s.startDate,e.startOfToday)?s.endDate?(0,n.differenceInCalendarDays)(s.endDate,e.startOfToday)+1:"":"-"}}],kc}var Ah={},mR;function rse(){if(mR)return Ah;mR=1,Object.defineProperty(Ah,"__esModule",{value:!0}),Ah.default=void 0;var n=s(Ks()),e=t(El());function t(p){return p&&p.__esModule?p:{default:p}}function r(p){if(typeof WeakMap!="function")return null;var x=new WeakMap,y=new WeakMap;return(r=function(_){return _?y:x})(p)}function s(p,x){if(p&&p.__esModule)return p;if(p===null||typeof p!="object"&&typeof p!="function")return{default:p};var y=r(x);if(y&&y.has(p))return y.get(p);var _={__proto__:null},w=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var j in p)if(j!=="default"&&Object.prototype.hasOwnProperty.call(p,j)){var C=w?Object.getOwnPropertyDescriptor(p,j):null;C&&(C.get||C.set)?Object.defineProperty(_,j,C):_[j]=p[j]}return _.default=p,y&&y.set(p,_),_}function a(p,x,y){return x=o(x),x in p?Object.defineProperty(p,x,{value:y,enumerable:!0,configurable:!0,writable:!0}):p[x]=y,p}function o(p){var x=l(p,"string");return typeof x=="symbol"?x:String(x)}function l(p,x){if(typeof p!="object"||!p)return p;var y=p[Symbol.toPrimitive];if(y!==void 0){var _=y.call(p,x);if(typeof _!="object")return _;throw new TypeError("@@toPrimitive must return a primitive value.")}return(x==="string"?String:Number)(p)}const c=0,d=99999;let h=class extends n.Component{constructor(x,y){super(x,y),a(this,"onChange",_=>{const{onChange:w}=this.props;let j=parseInt(_.target.value,10);j=isNaN(j)?0:Math.max(Math.min(d,j),c),w(j)})}shouldComponentUpdate(x){const{value:y,label:_,placeholder:w}=this.props;return y!==x.value||_!==x.label||w!==x.placeholder}render(){const{label:x,placeholder:y,value:_,styles:w,onBlur:j,onFocus:C}=this.props;return n.default.createElement("div",{className:w.inputRange},n.default.createElement("input",{className:w.inputRangeInput,placeholder:y,value:_,min:c,max:d,onChange:this.onChange,onFocus:C,onBlur:j}),n.default.createElement("span",{className:w.inputRangeLabel},x))}};return h.propTypes={value:e.default.oneOfType([e.default.string,e.default.number]),label:e.default.oneOfType([e.default.element,e.default.node]).isRequired,placeholder:e.default.string,styles:e.default.shape({inputRange:e.default.string,inputRangeInput:e.default.string,inputRangeLabel:e.default.string}).isRequired,onBlur:e.default.func.isRequired,onFocus:e.default.func.isRequired,onChange:e.default.func.isRequired},h.defaultProps={value:"",placeholder:"-"},Ah.default=h,Ah}var pR;function t6(){if(pR)return Ih;pR=1,Object.defineProperty(Ih,"__esModule",{value:!0}),Ih.default=void 0;var n=d(Ks()),e=l(El()),t=l(Py()),r=e6(),s=Ty(),a=l(rse()),o=l(Nu());function l(_){return _&&_.__esModule?_:{default:_}}function c(_){if(typeof WeakMap!="function")return null;var w=new WeakMap,j=new WeakMap;return(c=function(C){return C?j:w})(_)}function d(_,w){if(_&&_.__esModule)return _;if(_===null||typeof _!="object"&&typeof _!="function")return{default:_};var j=c(w);if(j&&j.has(_))return j.get(_);var C={__proto__:null},P=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var O in _)if(O!=="default"&&Object.prototype.hasOwnProperty.call(_,O)){var M=P?Object.getOwnPropertyDescriptor(_,O):null;M&&(M.get||M.set)?Object.defineProperty(C,O,M):C[O]=_[O]}return C.default=_,j&&j.set(_,C),C}function h(_,w,j){return w=p(w),w in _?Object.defineProperty(_,w,{value:j,enumerable:!0,configurable:!0,writable:!0}):_[w]=j,_}function p(_){var w=x(_,"string");return typeof w=="symbol"?w:String(w)}function x(_,w){if(typeof _!="object"||!_)return _;var j=_[Symbol.toPrimitive];if(j!==void 0){var C=j.call(_,w);if(typeof C!="object")return C;throw new TypeError("@@toPrimitive must return a primitive value.")}return(w==="string"?String:Number)(_)}let y=class extends n.Component{constructor(w){super(w),h(this,"handleRangeChange",j=>{const{onChange:C,ranges:P,focusedRange:O}=this.props,M=P[O[0]];!C||!M||C({[M.key||`range${O[0]+1}`]:{...M,...j}})}),this.state={rangeOffset:0,focusedInput:-1}}getRangeOptionValue(w){const{ranges:j=[],focusedRange:C=[]}=this.props;if(typeof w.getCurrentValue!="function")return"";const P=j[C[0]]||{};return w.getCurrentValue(P)||""}getSelectedRange(w,j){const C=w.findIndex(O=>!O.startDate||!O.endDate||O.disabled?!1:j.isSelected(O));return{selectedRange:w[C],focusedRangeIndex:C}}render(){const{headerContent:w,footerContent:j,onPreviewChange:C,inputRanges:P,staticRanges:O,ranges:M,renderStaticRangeLabel:D,rangeColors:I,className:F}=this.props;return n.default.createElement("div",{className:(0,o.default)(t.default.definedRangesWrapper,F)},w,n.default.createElement("div",{className:t.default.staticRanges},O.map((q,B)=>{const{selectedRange:U,focusedRangeIndex:W}=this.getSelectedRange(M,q);let G;return q.hasCustomRendering?G=D(q):G=q.label,n.default.createElement("button",{type:"button",className:(0,o.default)(t.default.staticRange,{[t.default.staticRangeSelected]:!!U}),style:{color:U?U.color||I[W]:null},key:B,onClick:()=>this.handleRangeChange(q.range(this.props)),onFocus:()=>C&&C(q.range(this.props)),onMouseOver:()=>C&&C(q.range(this.props)),onMouseLeave:()=>{C&&C()}},n.default.createElement("span",{tabIndex:-1,className:t.default.staticRangeLabel},G))})),n.default.createElement("div",{className:t.default.inputRanges},P.map((q,B)=>n.default.createElement(a.default,{key:B,styles:t.default,label:q.label,onFocus:()=>this.setState({focusedInput:B,rangeOffset:0}),onBlur:()=>this.setState({rangeOffset:0}),onChange:U=>this.handleRangeChange(q.range(U,this.props)),value:this.getRangeOptionValue(q)}))),j)}};return y.propTypes={inputRanges:e.default.array,staticRanges:e.default.array,ranges:e.default.arrayOf(s.rangeShape),focusedRange:e.default.arrayOf(e.default.number),onPreviewChange:e.default.func,onChange:e.default.func,footerContent:e.default.any,headerContent:e.default.any,rangeColors:e.default.arrayOf(e.default.string),className:e.default.string,renderStaticRangeLabel:e.default.func},y.defaultProps={inputRanges:r.defaultInputRanges,staticRanges:r.defaultStaticRanges,ranges:[],rangeColors:["#3d91ff","#3ecf8e","#fed14c"],focusedRange:[0,0]},Ih.default=y,Ih}var gR;function sse(){if(gR)return Oh;gR=1,Object.defineProperty(Oh,"__esModule",{value:!0}),Oh.default=void 0;var n=d(Ks()),e=l(El()),t=l(X5()),r=l(t6()),s=ky(),a=l(Nu()),o=l(Py());function l(x){return x&&x.__esModule?x:{default:x}}function c(x){if(typeof WeakMap!="function")return null;var y=new WeakMap,_=new WeakMap;return(c=function(w){return w?_:y})(x)}function d(x,y){if(x&&x.__esModule)return x;if(x===null||typeof x!="object"&&typeof x!="function")return{default:x};var _=c(y);if(_&&_.has(x))return _.get(x);var w={__proto__:null},j=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var C in x)if(C!=="default"&&Object.prototype.hasOwnProperty.call(x,C)){var P=j?Object.getOwnPropertyDescriptor(x,C):null;P&&(P.get||P.set)?Object.defineProperty(w,C,P):w[C]=x[C]}return w.default=x,_&&_.set(x,w),w}function h(){return h=Object.assign?Object.assign.bind():function(x){for(var y=1;y<arguments.length;y++){var _=arguments[y];for(var w in _)Object.prototype.hasOwnProperty.call(_,w)&&(x[w]=_[w])}return x},h.apply(this,arguments)}let p=class extends n.Component{constructor(y){super(y),this.state={focusedRange:[(0,s.findNextRangeIndex)(y.ranges),0]},this.styles=(0,s.generateStyles)([o.default,y.classNames])}render(){const{focusedRange:y}=this.state;return n.default.createElement("div",{className:(0,a.default)(this.styles.dateRangePickerWrapper,this.props.className)},n.default.createElement(r.default,h({focusedRange:y,onPreviewChange:_=>this.dateRange.updatePreview(_?this.dateRange.calcNewSelection(_,typeof _=="string"):null)},this.props,{range:this.props.ranges[y[0]],className:void 0})),n.default.createElement(t.default,h({onRangeFocusChange:_=>this.setState({focusedRange:_}),focusedRange:y},this.props,{ref:_=>this.dateRange=_,className:void 0})))}};return p.defaultProps={},p.propTypes={...t.default.propTypes,...r.default.propTypes,className:e.default.string},Oh.default=p,Oh}var xR;function ise(){return xR||(xR=1,(function(n){Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"Calendar",{enumerable:!0,get:function(){return t.default}}),Object.defineProperty(n,"DateRange",{enumerable:!0,get:function(){return e.default}}),Object.defineProperty(n,"DateRangePicker",{enumerable:!0,get:function(){return r.default}}),Object.defineProperty(n,"DefinedRange",{enumerable:!0,get:function(){return s.default}}),Object.defineProperty(n,"createStaticRanges",{enumerable:!0,get:function(){return a.createStaticRanges}}),Object.defineProperty(n,"defaultInputRanges",{enumerable:!0,get:function(){return a.defaultInputRanges}}),Object.defineProperty(n,"defaultStaticRanges",{enumerable:!0,get:function(){return a.defaultStaticRanges}});var e=o(X5()),t=o(Q5()),r=o(sse()),s=o(t6()),a=e6();function o(l){return l&&l.__esModule?l:{default:l}}})(Ob)),Ob}var wm=ise();const En=({label:n,id:e,error:t,value:r,onChange:s,maxDate:a,minDate:o,...l})=>{const[c,d]=E.useState(!1),[h,p]=E.useState(!1),x=E.useRef(null),{theme:y}=ed(),_=y==="dark";E.useEffect(()=>{p(document.body.classList.contains("field-officer-dark-theme"))},[]);const w=I=>{s&&s(We(I,"yyyy-MM-dd")),d(!1)};E.useEffect(()=>{const I=F=>{x.current&&!x.current.contains(F.target)&&d(!1)};return document.addEventListener("mousedown",I),()=>document.removeEventListener("mousedown",I)},[]);const{className:j,...C}=l,M=`${h?"fo-input":"form-input"} ${t?h?"fo-input--error":"form-input--error":""} flex justify-between items-center cursor-pointer ${j||""}`,D=r?new Date(r+"T12:00:00"):new Date;return i.jsxs("div",{ref:x,children:[n&&i.jsx("label",{htmlFor:e,className:"block text-sm font-medium text-muted",children:n}),i.jsxs("div",{className:n?"mt-1 relative":"relative",children:[i.jsxs("div",{id:e,className:M,onClick:()=>d(!c),role:"button","aria-haspopup":"dialog","aria-expanded":c,"aria-label":`Date picker for ${n}`,children:[i.jsx("span",{className:r?"":"text-muted",children:r?We(D,"dd MMM, yyyy"):"Select date"}),i.jsx(Da,{className:"h-4 w-4 text-muted"})]}),c&&i.jsx("div",{className:`absolute z-50 mt-1 rounded-lg shadow-lg overflow-hidden ${_?"dark-calendar bg-[#041b0f] border border-[#1f3d2b]":"bg-white border border-gray-200"}`,children:i.jsx(wm.Calendar,{date:D,onChange:w,maxDate:a,minDate:o,color:_?"#10B981":"#005D22"})})]}),t&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:t})]})},n6=["Apartment","Villa","Vilament","Rowhouse","Combined","Commercial Office","Commercial Retail","Commercial","Public",""],ase=Pt({organizationId:xe().required(),location:xe().optional().nullable(),entityId:xe().optional(),billingName:xe().optional().nullable(),registeredAddress:xe().optional().nullable(),gstNumber:xe().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,{message:"Invalid GST Number format",excludeEmptyString:!0}),panNumber:xe().optional().nullable().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,{message:"Invalid PAN format",excludeEmptyString:!0}),email1:xe().email("Invalid email format").optional().nullable(),email2:xe().email("Invalid email format").optional().nullable(),email3:xe().email("Invalid email format").optional().nullable(),eShramNumber:xe().optional().nullable(),shopAndEstablishmentCode:xe().optional().nullable(),keyAccountManager:xe().optional(),siteAreaSqFt:cs().typeError("Must be a number").nullable().optional(),projectType:xe().oneOf(n6).optional(),apartmentCount:cs().typeError("Must be a number").nullable().optional(),agreementDetails:Pt({fromDate:xe().optional().nullable(),toDate:xe().optional().nullable().test("is-after-from","To Date must be after From Date",function(n){const{fromDate:e}=this.parent;return!e||!n?!0:new Date(n.replace(/-/g,"/"))>=new Date(e.replace(/-/g,"/"))}),renewalIntervalDays:cs().typeError("Must be a number").nullable().optional().min(0,"Cannot be negative"),softCopy:Wt().nullable().optional(),scannedCopy:Wt().nullable().optional(),agreementDate:xe().optional().nullable(),addendum1Date:xe().optional().nullable(),addendum2Date:xe().optional().nullable()}).optional(),siteOperations:Pt({form6Applicable:ls().default(!1),form6RenewalTaskCreation:ls().optional(),form6ValidityFrom:xe().nullable().when("form6Applicable",{is:!0,then:n=>n.required("From Date is required")}),form6ValidityTo:xe().nullable().when("form6Applicable",{is:!0,then:n=>n.required("To Date is required")}),form6Document:Wt().nullable().when("form6Applicable",{is:!0,then:n=>n.required("Document is required")}),minWageRevisionApplicable:ls().default(!1),minWageRevisionTaskCreation:ls().optional(),minWageRevisionValidityFrom:xe().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("From Date is required")}),minWageRevisionValidityTo:xe().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("To Date is required")}),minWageRevisionDocument:Wt().nullable().when("minWageRevisionApplicable",{is:!0,then:n=>n.required("Document is required")}),holidays:Pt({numberOfDays:cs().nullable().min(0),list:js().of(Pt({id:xe(),date:xe().required(),description:xe().required()})),salaryPayment:xe().oneOf(["Full Payment","Duty Payment","Nil Payment",""]),billing:xe().oneOf(["Full Payment","Duty Payment","Nil Payment",""])}).optional(),costingSheetLink:xe().url("Must be a valid URL").nullable().optional(),tools:Pt({dcCopy1:Wt().nullable().optional(),dcCopy2:Wt().nullable().optional(),list:js().of(Pt({id:xe(),name:xe().required(),brand:xe().optional(),size:xe().optional(),quantity:cs().nullable().min(0),issueDate:xe().required(),picture:Wt().nullable().optional()}))}).optional(),sims:Pt({issuedCount:cs().nullable().min(0),details:js().of(Pt({id:xe(),mobileNumber:xe().required().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),allocatedTo:xe().optional(),plan:xe().optional(),ownerName:xe().optional()}))}).optional(),equipment:Pt({issued:js().of(Pt({id:xe(),name:xe().required(),brand:xe().optional(),modelNumber:xe().optional(),serialNumber:xe().optional(),accessories:xe().optional(),condition:xe().oneOf(["New","Old",""]),issueDate:xe().required(),picture:Wt().nullable().optional()})),intermittent:Pt({billing:xe().oneOf(["To Be Billed","Not to be Billed",""]),frequency:xe().oneOf(["Monthly","Bi-Monthly","Quarterly","Half Yearly","Yearly",""]),taskCreation:ls().default(!1),durationDays:cs().nullable().min(0)}).optional()}).optional(),billingCycleFrom:xe().nullable().optional(),uniformDeductions:ls().default(!1)}).optional(),insuranceStatus:Pt({isCompliant:ls().required()}).optional().nullable(),assets:js().optional(),issuedTools:js().optional()}).defined(),yR=({title:n,children:e})=>{const[t,r]=E.useState(!1);return i.jsxs("div",{className:"border border-border rounded-lg bg-page",children:[i.jsxs("button",{type:"button",onClick:()=>r(!t),className:"w-full flex justify-between items-center p-3 font-medium text-left text-primary-text",children:[i.jsx("span",{children:n}),i.jsx(ju,{className:`h-5 w-5 transform transition-transform ${t?"rotate-180":""}`})]}),t&&i.jsx("div",{className:"p-4 border-t border-border bg-card",children:e})]})},r6=({isOpen:n,onClose:e,onSave:t,organization:r,allClients:s,initialData:a})=>{const[o,l]=E.useState("General"),c=Rt("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,watch:x,setValue:y,formState:{errors:_},reset:w}=tn({resolver:In(ase),defaultValues:{siteOperations:{form6Applicable:!1,minWageRevisionApplicable:!1,uniformDeductions:!1}}}),{fields:j,append:C,remove:P}=Ns({control:p,name:"siteOperations.holidays.list"});Ns({control:p,name:"siteOperations.tools.list"}),Ns({control:p,name:"siteOperations.sims.details"}),Ns({control:p,name:"siteOperations.equipment.issued"}),E.useEffect(()=>{n&&w(a||{organizationId:r.id})},[n,a,r.id,w]);const O=x("entityId"),M=x("siteOperations.form6Applicable"),D=x("siteOperations.minWageRevisionApplicable");E.useEffect(()=>{if(O){const q=s.find(B=>B.id===O);q&&(y("registeredAddress",q.registeredAddress||""),y("gstNumber",q.gstNumber||""),y("panNumber",q.panNumber||""),y("email1",q.email||""),y("eShramNumber",q.eShramNumber||""),y("shopAndEstablishmentCode",q.shopAndEstablishmentCode||""))}},[O,s,y]);const I=q=>{t(r.id,q)},F=({tabName:q})=>i.jsx("button",{type:"button",onClick:()=>l(q),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${o===q?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:q});return n?i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4 flex items-center justify-center",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale",onClick:q=>q.stopPropagation(),children:i.jsxs("form",{onSubmit:h(I),className:"p-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Site Configuration"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For: ",r.shortName]}),i.jsx("div",{className:"mb-6",children:c?i.jsxs(Ze,{label:"Configuration Section",id:"site-config-tabs",value:o,onChange:q=>l(q.target.value),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"General",children:"General"}),i.jsx("option",{value:"Compliance",children:"Compliance"}),i.jsx("option",{value:"Agreement",children:"Agreement"}),i.jsx("option",{value:"Site Operations",children:"Site Operations"})]}):i.jsx("div",{className:"border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(F,{tabName:"General"}),i.jsx(F,{tabName:"Compliance"}),i.jsx(F,{tabName:"Agreement"}),i.jsx(F,{tabName:"Site Operations"})]})})}),i.jsxs("div",{className:"max-h-[60vh] overflow-y-auto pr-2 space-y-4",children:[o==="General"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(we,{label:"Location",id:"location",registration:d("location"),error:_.location?.message}),i.jsx(we,{label:"Billing Name",id:"billingName",registration:d("billingName"),error:_.billingName?.message}),i.jsx(we,{label:"Key Account Manager",id:"keyAccountManager",registration:d("keyAccountManager"),error:_.keyAccountManager?.message}),i.jsx(we,{label:"Site Area (Sq.ft)",id:"siteAreaSqFt",type:"number",registration:d("siteAreaSqFt"),error:_.siteAreaSqFt?.message}),i.jsxs(Ze,{label:"Type of Project",id:"projectType",registration:d("projectType"),error:_.projectType?.message,children:[i.jsx("option",{value:"",children:"-- Select Type --"}),n6.filter(Boolean).map(q=>i.jsx("option",{value:q,children:q},q))]}),i.jsx(we,{label:"No of Apartments/Villas",id:"apartmentCount",type:"number",registration:d("apartmentCount"),error:_.apartmentCount?.message})]}),o==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"entityId",control:p,render:({field:q})=>i.jsxs(Ze,{label:"Link to Client (Prefills data)",id:"entityId",...q,error:_.entityId?.message,children:[i.jsx("option",{value:"",children:"-- Select Client --"}),s.map(B=>i.jsxs("option",{value:B.id,children:[B.name," (",B.companyName,")"]},B.id))]})})}),i.jsx(we,{label:"GST Number",id:"gstNumber",registration:d("gstNumber"),error:_.gstNumber?.message}),i.jsx(we,{label:"PAN Number",id:"panNumber",registration:d("panNumber"),error:_.panNumber?.message}),i.jsx(we,{label:"Email Address 1",id:"email1",registration:d("email1"),error:_.email1?.message}),i.jsx(we,{label:"Email Address 2",id:"email2",registration:d("email2"),error:_.email2?.message}),i.jsx(we,{label:"Email Address 3",id:"email3",registration:d("email3"),error:_.email3?.message}),i.jsx(we,{label:"E-Shram Number",id:"eShramNumber",registration:d("eShramNumber"),error:_.eShramNumber?.message}),i.jsx(we,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:d("shopAndEstablishmentCode"),error:_.shopAndEstablishmentCode?.message})]}),o==="Agreement"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(_e,{name:"agreementDetails.fromDate",control:p,render:({field:q})=>i.jsx(En,{label:"From Date",id:"agreementDetails.fromDate",value:q.value,onChange:q.onChange,error:_.agreementDetails?.fromDate?.message})}),i.jsx(_e,{name:"agreementDetails.toDate",control:p,render:({field:q})=>i.jsx(En,{label:"To Date",id:"agreementDetails.toDate",value:q.value,onChange:q.onChange,error:_.agreementDetails?.toDate?.message})}),i.jsx(we,{label:"Renewal Interval (Days)",id:"agreementDetails.renewalIntervalDays",type:"number",registration:d("agreementDetails.renewalIntervalDays"),error:_.agreementDetails?.renewalIntervalDays?.message}),i.jsxs("div",{className:"md:col-span-2 grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:"agreementDetails.softCopy",control:p,render:({field:q})=>i.jsx(vt,{label:"Soft Copy",file:q.value,onFileChange:q.onChange})}),i.jsx(_e,{name:"agreementDetails.scannedCopy",control:p,render:({field:q})=>i.jsx(vt,{label:"Scanned Copy",file:q.value,onFileChange:q.onChange})})]}),i.jsx(_e,{name:"agreementDetails.agreementDate",control:p,render:({field:q})=>i.jsx(En,{label:"Agreement Dated",id:"agreementDetails.agreementDate",value:q.value,onChange:q.onChange,error:_.agreementDetails?.agreementDate?.message})}),i.jsx(_e,{name:"agreementDetails.addendum1Date",control:p,render:({field:q})=>i.jsx(En,{label:"Addendum 1 Dated",id:"agreementDetails.addendum1Date",value:q.value,onChange:q.onChange,error:_.agreementDetails?.addendum1Date?.message})}),i.jsx(_e,{name:"agreementDetails.addendum2Date",control:p,render:({field:q})=>i.jsx(En,{label:"Addendum 2 Dated",id:"agreementDetails.addendum2Date",value:q.value,onChange:q.onChange,error:_.agreementDetails?.addendum2Date?.message})})]}),o==="Site Operations"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(yR,{title:"Compliance Forms",children:i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.form6Applicable",control:p,render:({field:q})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:q.value,onChange:q.onChange})," Form 6 Applicable"]})}),M&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.form6ValidityFrom",control:p,render:({field:q})=>i.jsx(En,{label:"Valid From",id:"form6from",value:q.value,onChange:q.onChange,error:_.siteOperations?.form6ValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.form6ValidityTo",control:p,render:({field:q})=>i.jsx(En,{label:"Valid To",id:"form6to",value:q.value,onChange:q.onChange,error:_.siteOperations?.form6ValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.form6Document",control:p,render:({field:q})=>i.jsx(vt,{label:"Form 6 Document",file:q.value,onFileChange:q.onChange,error:_.siteOperations?.form6Document?.message})})})]})]}),i.jsxs("div",{children:[i.jsx(_e,{name:"siteOperations.minWageRevisionApplicable",control:p,render:({field:q})=>i.jsxs("label",{className:"flex items-center gap-2",children:[i.jsx("input",{type:"checkbox",checked:q.value,onChange:q.onChange})," Min. Wage Revision Applicable"]})}),D&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-2 pl-6",children:[i.jsx(_e,{name:"siteOperations.minWageRevisionValidityFrom",control:p,render:({field:q})=>i.jsx(En,{label:"Valid From",id:"minwagefrom",value:q.value,onChange:q.onChange,error:_.siteOperations?.minWageRevisionValidityFrom?.message})}),i.jsx(_e,{name:"siteOperations.minWageRevisionValidityTo",control:p,render:({field:q})=>i.jsx(En,{label:"Valid To",id:"minwageto",value:q.value,onChange:q.onChange,error:_.siteOperations?.minWageRevisionValidityTo?.message})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(_e,{name:"siteOperations.minWageRevisionDocument",control:p,render:({field:q})=>i.jsx(vt,{label:"Min. Wage Document",file:q.value,onFileChange:q.onChange,error:_.siteOperations?.minWageRevisionDocument?.message})})})]})]})]})}),i.jsx(yR,{title:"Holidays",children:i.jsxs("div",{className:"space-y-4",children:[i.jsx(we,{label:"Number of National & Festival Holidays",id:"holiday-count",type:"number",registration:d("siteOperations.holidays.numberOfDays")}),i.jsxs(Ze,{label:"Salary Payment for Holiday",id:"holiday-salary",registration:d("siteOperations.holidays.salaryPayment"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsxs(Ze,{label:"Billing for Holiday",id:"holiday-billing",registration:d("siteOperations.holidays.billing"),children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Full Payment"}),i.jsx("option",{children:"Duty Payment"}),i.jsx("option",{children:"Nil Payment"})]}),i.jsx("h5",{className:"font-semibold pt-2 border-t",children:"Holiday List"}),j.map((q,B)=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-end",children:[i.jsx("div",{className:"col-span-6",children:i.jsx(we,{label:"Description",id:`holiday-desc-${B}`,...d(`siteOperations.holidays.list.${B}.description`)})}),i.jsx("div",{className:"col-span-5",children:i.jsx(_e,{name:`siteOperations.holidays.list.${B}.date`,control:p,render:({field:U})=>i.jsx(En,{label:"Date",id:`holiday-date-${B}`,value:U.value,onChange:U.onChange})})}),i.jsx("div",{className:"col-span-1",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>P(B),children:i.jsx(rn,{className:"h-4 text-red-500"})})})]},q.id)),i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>C({id:`hol_${Date.now()}`,date:"",description:""}),children:[i.jsx(Vt,{className:"h-4 mr-1"})," Add Holiday"]})]})})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Configuration"})]})]})})}):null},ose=({isOpen:n,onClose:e,siteName:t,details:r,isLoading:s,onSave:a,designations:o})=>{const[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useRef(null),[x,y]=E.useState(!1),_=E.useMemo(()=>{const I=new Set;return o.filter(F=>I.has(F.designation)?!1:(I.add(F.designation),!0)).sort((F,q)=>F.designation.localeCompare(q.designation))},[o]),w=()=>{const I=p.current;if(I){const F=I.scrollHeight>I.clientHeight,q=I.scrollHeight-I.scrollTop<=I.clientHeight+1;y(F&&!q)}else y(!1)};E.useEffect(()=>{if(n){c(JSON.parse(JSON.stringify(r)));const I=setTimeout(w,150);return()=>clearTimeout(I)}},[r,n,s]);const j=(I,F,q)=>{const B=[...l],U=B[I];if(F==="count"){const W=Number(q);U.count=isNaN(W)?0:W}else U.designation=String(q);c(B)},C=()=>{c([...l,{designation:"",count:0,tempId:`new_${Date.now()}`}]),setTimeout(w,50)},P=I=>{const F=l.filter((q,B)=>B!==I);c(F),setTimeout(w,50)},O=async()=>{h(!0);const I=l.filter(F=>F.designation.trim()!=="").map(({tempId:F,...q})=>q);await a(I),h(!1)},M=ot.useMemo(()=>l.reduce((I,F)=>I+(Number(F.count)||0),0),[l]),D=I=>{if(I.key!=="ArrowUp"&&I.key!=="ArrowDown")return;const F=I.target;if(F.tagName!=="INPUT"&&F.tagName!=="SELECT")return;const q=F.getAttribute("data-row-index"),B=F.getAttribute("data-col-index");if(!q||!B||F.type==="number")return;I.preventDefault();const U=I.currentTarget,W=parseInt(q,10),G=parseInt(B,10),Z=I.key==="ArrowUp"?W-1:W+1,Y=U.querySelector(`[data-row-index="${Z}"][data-col-index="${G}"]`);Y&&Y.focus()};return n?n4.createPortal(i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm sm:max-w-lg md:max-w-2xl m-4 animate-fade-in-scale flex flex-col",onClick:I=>I.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Allocate Manpower"}),i.jsxs("p",{className:"text-sm text-muted mb-4",children:["For site: ",t]}),i.jsxs("div",{className:"flex-grow relative overflow-hidden",children:[i.jsx("div",{ref:p,onScroll:w,onKeyDown:D,className:"overflow-y-auto pr-2 min-h-[300px] max-h-[60vh] h-full",children:s?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"grid grid-cols-12 gap-4 sticky top-0 bg-page p-2 rounded-t-lg z-10",children:[i.jsx("div",{className:"col-span-6 font-medium text-sm text-muted",children:"Designation"}),i.jsx("div",{className:"col-span-4 font-medium text-sm text-muted",children:"Count"}),i.jsx("div",{className:"col-span-2"})]}),l.length>0?l.map((I,F)=>i.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center",children:[i.jsx("div",{className:"col-span-6",children:i.jsxs(Ze,{id:`designation-${F}`,value:I.designation,onChange:q=>j(F,"designation",q.target.value),className:"py-1.5","data-row-index":F,"data-col-index":0,"aria-label":`Designation for row ${F+1}`,children:[i.jsx("option",{value:"",children:"Select Designation"}),_.map(q=>i.jsx("option",{value:q.designation,children:q.designation},q.id))]})}),i.jsx("div",{className:"col-span-4",children:i.jsx(we,{id:`count-${F}`,type:"number",value:I.count,onChange:q=>j(F,"count",q.target.value),min:"0",step:"0.01",className:"py-1.5","data-row-index":F,"data-col-index":1,"aria-label":`Count for row ${F+1}`})}),i.jsx("div",{className:"col-span-2 text-right",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>P(F),title:"Remove row","aria-label":`Remove row ${F+1}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.tempId||F)):i.jsx("p",{className:"text-center text-muted py-10",children:"No designations added yet. Click below to start."}),i.jsxs(ne,{variant:"outline",size:"sm",onClick:C,className:"mt-4",children:[i.jsx(Vt,{className:"h-4 w-4 mr-2"})," Add Designation"]})]})}),x&&i.jsx("div",{className:"absolute bottom-0 left-0 right-2 h-16 bg-gradient-to-t from-card to-transparent pointer-events-none"})]}),i.jsxs("div",{className:"mt-6 pt-4 border-t flex justify-between items-center",children:[i.jsxs("div",{className:"font-semibold",children:["Total Manpower: ",i.jsx("span",{className:"text-accent",children:M.toFixed(2)})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",disabled:d,children:"Cancel"}),i.jsx(ne,{onClick:O,isLoading:d,disabled:s,children:"Save Changes"})]})]})]})}),document.getElementById("modal-root")):null},_N=["id","shortName","fullName","address","manpowerApprovedCount","reportingManagerName","managerName","fieldOfficerNames","backendFieldOfficerNames"],lse=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{let o=s[a];return Array.isArray(o)&&(o=o.join(";")),o=o==null?"":String(o),o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},cse=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},dse=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(!0),[p,x]=E.useState(!1),[y,_]=E.useState(!1),[w,j]=E.useState(!1),[C,P]=E.useState(null),[O,M]=E.useState(null),[D,I]=E.useState(null),[F,q]=E.useState([]),[B,U]=E.useState(!1),W=E.useRef(null),G=Rt("(max-width: 767px)"),{siteManagement:Z}=yi(),Y=E.useCallback(async()=>{h(!0);try{const[ie,ce,oe,de]=await Promise.all([ue.getOrganizations().catch(ye=>(console.error("Failed to fetch organizations:",ye),[])),ue.getOrganizationStructure().catch(ye=>(console.error("Failed to fetch organization structure:",ye),[])),ue.getSiteConfigurations().catch(ye=>(console.error("Failed to fetch site configurations:",ye),[])),ue.getSiteStaffDesignations().catch(ye=>(console.error("Failed to fetch site staff designations:",ye),I({message:"Could not load designation list. Manpower editing may be affected.",type:"error"}),[]))]);t(ie),s(oe),c(de);const te=ce.flatMap(ye=>ye.companies.flatMap(Ce=>Ce.entities.map(Re=>({...Re,companyName:Ce.name}))));o(te)}catch{I({message:"An unexpected error occurred while fetching data.",type:"error"})}finally{h(!1)}},[]);E.useEffect(()=>{Y()},[Y]);const ae=ie=>{P(ie),x(!0)},ee=ie=>{M(ie),_(!0)},me=(ie,ce)=>{s(oe=>{const de=[...oe],te=de.findIndex(ye=>ye.organizationId===ie);return te>-1?de[te]=ce:de.push(ce),de}),I({message:"Site configuration saved.",type:"success"}),x(!1)},$=async()=>{O&&(t(ie=>ie.filter(ce=>ce.id!==O.id)),s(ie=>ie.filter(ce=>ce.organizationId!==O.id)),I({message:"Site deleted.",type:"success"}),_(!1))},K=async ie=>{M(ie),U(!0),j(!0);try{const ce=await ue.getManpowerDetails(ie.id);q(ce)}catch{I({message:"Could not load manpower details.",type:"error"})}finally{U(!1)}},re=async ie=>{if(O)try{await ue.updateManpowerDetails(O.id,ie);const ce=ie.reduce((oe,de)=>oe+(Number(de.count)||0),0);t(oe=>oe.map(de=>de.id===O.id?{...de,manpowerApprovedCount:ce}:de)),j(!1),I({message:"Manpower details updated successfully.",type:"success"})}catch{I({message:"Failed to save manpower details.",type:"error"})}},H=()=>{const ie=lse(e,_N),ce=new Blob([ie],{type:"text/csv;charset=utf-8;"}),oe=document.createElement("a");oe.href=URL.createObjectURL(ce),oe.setAttribute("download","sites_export.csv"),document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),I({message:"Sites exported successfully.",type:"success"})},se=ie=>{const ce=ie.target.files?.[0];if(!ce)return;const oe=new FileReader;oe.onload=async de=>{try{const te=de.target?.result;if(!te)throw new Error("File is empty or could not be read.");const ye=cse(te);if(ye.length===0)throw new Error("No data rows found in the CSV file.");const Ce=Object.keys(ye[0]);if(!_N.every(ke=>Ce.includes(ke)))throw new Error(`CSV is missing headers. Required: ${_N.join(", ")}`);const Te=ye.map(ke=>({id:ke.id,shortName:ke.shortName,fullName:ke.fullName,address:ke.address,manpowerApprovedCount:parseFloat(ke.manpowerApprovedCount)||0,reportingManagerName:ke.reportingManagerName||void 0,managerName:ke.managerName||void 0,fieldOfficerNames:ke.fieldOfficerNames?ke.fieldOfficerNames.split(";").map(Ue=>Ue.trim()).filter(Ue=>Ue):void 0,backendFieldOfficerNames:ke.backendFieldOfficerNames?ke.backendFieldOfficerNames.split(";").map(Ue=>Ue.trim()).filter(Ue=>Ue):void 0})),{count:je}=await ue.bulkUploadOrganizations(Te);I({message:`${je} sites imported/updated successfully.`,type:"success"}),Y()}catch(te){I({message:te.message||"Failed to import CSV.",type:"error"})}finally{ie.target&&(ie.target.value="")}},oe.readAsText(ce)};return i.jsxs("div",{className:"p-4 md:p-8",children:[D&&i.jsx(pt,{message:D.message,type:D.type,onDismiss:()=>I(null)}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:se}),i.jsx("input",{type:"file",ref:W,className:"hidden",accept:".csv",onChange:se}),p&&C&&i.jsx(r6,{isOpen:p,onClose:()=>x(!1),onSave:me,organization:C,allClients:a,initialData:r.find(ie=>ie.organizationId===C.id)}),O&&i.jsx(ose,{isOpen:w,onClose:()=>j(!1),siteName:O.shortName,details:F,isLoading:B,onSave:re,designations:l}),i.jsxs(Kr,{isOpen:y,onClose:()=>_(!1),onConfirm:$,title:"Confirm Deletion",children:['Are you sure you want to delete the site "',O?.shortName,'"? This action cannot be undone.']}),i.jsxs("div",{className:"bg-card p-4 rounded-2xl mb-4",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Site Management"}),!G&&i.jsxs("div",{className:"flex-shrink-0 flex items-center flex-wrap gap-2",children:[i.jsxs(ne,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Vt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs(ne,{onClick:()=>n("/admin/sites/add"),className:"mr-2 bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Vt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ne,{variant:"outline",onClick:()=>W.current?.click(),className:"mr-2 hover:bg-gray-100",children:[i.jsx(Hc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ne,{variant:"outline",onClick:H,className:"hover:bg-gray-100",children:[i.jsx(bi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]}),G&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ne,{onClick:()=>n("/admin/sites/add"),className:"w-full justify-center bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white shadow-lg hover:shadow-xl transition-all duration-300 transform hover:-translate-y-0.5",children:[i.jsx(Vt,{className:"w-5 h-5 mr-2"}),"Add Site"]}),i.jsxs(ne,{variant:"outline",onClick:()=>n("/admin/sites/quick-add"),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Vt,{className:"w-5 h-5 mr-2"}),"Quick Add Site"]}),i.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[i.jsxs(ne,{variant:"outline",onClick:()=>W.current?.click(),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(Hc,{className:"w-5 h-5 mr-2"}),"Import"]}),i.jsxs(ne,{variant:"outline",onClick:H,className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(bi,{className:"w-5 h-5 mr-2"}),"Export"]})]})]})]}),i.jsx("div",{className:"bg-card rounded-2xl shadow-sm border border-border overflow-hidden",children:d?i.jsx("div",{className:"overflow-x-auto",children:i.jsx("table",{className:"w-full",children:i.jsx("tbody",{className:"divide-y divide-border",children:i.jsx(Ra,{cols:5,rows:5})})})}):e.length===0?i.jsxs("div",{className:"p-8 text-center text-muted",children:[i.jsx(Zi,{className:"w-12 h-12 mx-auto mb-3 opacity-20"}),i.jsx("p",{children:"No sites found. Add a new site to get started."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"w-full",children:[i.jsx("thead",{className:"bg-muted/50",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Site Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Location"}),i.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-muted uppercase tracking-wider",children:"Manpower"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Key Staff"}),i.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:e.map(ie=>{r.find(de=>de.organizationId===ie.id);const ce=!!ie.provisionalCreationDate,oe=ce&&ie.provisionalCreationDate?90-ZV(new Date,new Date(ie.provisionalCreationDate)):0;return i.jsxs("tr",{className:"hover:bg-muted/5 transition-colors",children:[i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center",children:i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-primary-text",children:ie.shortName}),i.jsx("div",{className:"text-xs text-muted",children:ie.fullName}),ce&&i.jsxs("div",{className:`mt-1 text-xs px-2 py-0.5 rounded-full inline-flex items-center gap-1 ${oe>30?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[i.jsx(XF,{className:"w-3 h-3"}),oe>0?`${oe} days left`:"Expired"]})]})})}),i.jsx("td",{className:"px-6 py-4",children:i.jsx("div",{className:"text-sm text-primary-text max-w-xs truncate",title:ie.address,children:ie.address})}),i.jsx("td",{className:"px-6 py-4 text-center",children:i.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:ie.manpowerApprovedCount||0})}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs("div",{className:"text-xs space-y-1",children:[ie.reportingManagerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Reporting Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"RM:"})," ",ie.reportingManagerName]}),ie.managerName&&i.jsxs("div",{className:"flex items-center gap-1",title:"Site Manager",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:"SM:"})," ",ie.managerName]}),ie.fieldOfficerNames&&ie.fieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"FO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:ie.fieldOfficerNames.join(", ")})]}),ie.backendFieldOfficerNames&&ie.backendFieldOfficerNames.length>0&&i.jsxs("div",{className:"flex items-start gap-1",title:"Backend Field Officers",children:[i.jsx("span",{className:"font-semibold text-primary-text whitespace-nowrap",children:"BFO:"}),i.jsx("span",{className:"truncate max-w-[150px]",children:ie.backendFieldOfficerNames.join(", ")})]})]})}),i.jsx("td",{className:"px-6 py-4 text-right whitespace-nowrap",children:i.jsxs("div",{className:"flex items-center justify-end gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>K(ie),title:"Manpower Details",children:i.jsx(Ji,{className:"w-4 h-4 text-blue-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>ae(ie),title:"Configure Site",children:i.jsx(Om,{className:"w-4 h-4 text-gray-600"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>ee(ie),title:"Delete Site",children:i.jsx(rn,{className:"w-4 h-4 text-red-600"})})]})})]},ie.id)})})]})})})]})},use=({isOpen:n,onClose:e,onSave:t,title:r,initialName:s=""})=>{const[a,o]=E.useState(s),[l,c]=E.useState("");E.useEffect(()=>{n&&(o(s),c(""))},[n,s]);const d=()=>{if(!a.trim()){c("Role name cannot be empty.");return}t(a.trim()),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-sm m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:h=>{h.preventDefault(),d()},children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-4",children:r}),i.jsx(we,{label:"Role Display Name",id:"role-name",value:a,onChange:h=>o(h.target.value),error:l,autoFocus:!0}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save"})]})]})})}):null},_m=[{key:"apply_for_leave",name:"Apply for Leave",description:"Allows users to request time off."},{key:"create_enrollment",name:"Create Enrollment",description:"Access the multi-step form to onboard new employees."},{key:"view_developer_settings",name:"Developer Settings",description:"Access API settings and other developer tools."},{key:"download_attendance_report",name:"Download Attendance Report",description:"Generate and download attendance reports in CSV format."},{key:"manage_approval_workflow",name:"Manage Approval Workflow",description:"Set up reporting managers for leave approvals."},{key:"manage_attendance_rules",name:"Manage Attendance Rules",description:"Set work hours, holidays, and leave allocations."},{key:"manage_enrollment_rules",name:"Manage Enrollment Rules",description:"Set rules for ESI/GMC, manpower limits, and documents."},{key:"manage_insurance",name:"Manage Insurance",description:"Create and manage company insurance plans."},{key:"manage_leave_requests",name:"Manage Leave Requests",description:"Approve or reject leave requests for employees."},{key:"manage_modules",name:"Manage Modules",description:"Create, edit, and group permissions into modules."},{key:"manage_policies",name:"Manage Policies",description:"Create and manage company policies."},{key:"manage_roles_and_permissions",name:"Manage Roles & Permissions",description:"Access this page to edit role permissions."},{key:"manage_sites",name:"Manage Sites",description:"Create, edit, and delete organizations/sites."},{key:"manage_tasks",name:"Manage Tasks",description:"Create, assign, and manage all organizational tasks, including escalations."},{key:"manage_uniforms",name:"Manage Uniforms",description:"Manage uniform requests and site configurations."},{key:"manage_users",name:"Manage Users",description:"Create, edit, and delete user accounts."},{key:"view_operations_dashboard",name:"Operations Dashboard",description:"View the operations management dashboard."},{key:"view_site_dashboard",name:"Site Dashboard",description:"View the dashboard for a specific site/organization."},{key:"view_all_attendance",name:"View All Attendance",description:"Allows users to see attendance records for all employees."},{key:"view_all_submissions",name:"View All Submissions",description:"Access the main dashboard to view all employee submissions."},{key:"view_entity_management",name:"View Entity Management",description:"Access the HR dashboard for managing company entities."},{key:"view_field_officer_tracking",name:"View Field Officer Tracking",description:"Track user check-in/out locations and activity on a map."},{key:"view_invoice_summary",name:"View Invoice Summary",description:"View and generate monthly invoices for sites."},{key:"view_own_attendance",name:"View Own Attendance",description:"Allows users to see their own attendance records."},{key:"view_verification_costing",name:"View Verification Costing",description:"Analyze costs associated with third-party document verifications."}].sort((n,e)=>n.name.localeCompare(e.name)),fse=()=>{const n=St(),{permissions:e,setRolePermissions:t,addRolePermissionEntry:r,removeRolePermissionEntry:s,renameRolePermissionEntry:a}=ta(),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(!0),[x,y]=E.useState(null),[_,w]=E.useState(!1),[j,C]=E.useState(!1),[P,O]=E.useState(null),[M,D]=E.useState(!1),[I,F]=E.useState(null),q=E.useRef(null),B=Rt("(max-width: 767px)");E.useEffect(()=>{(async()=>{p(!0);try{const[me,$]=await Promise.all([ue.getRoles(),ue.getModules()]);l(me),d($.sort((K,re)=>K.name.localeCompare(re.name)))}catch(me){console.error("Failed to load data",me),y({message:"Failed to load page data.",type:"error"})}finally{p(!1)}})()},[]),E.useEffect(()=>{const ee=me=>{q.current&&!q.current.contains(me.target)&&F(null)};return document.addEventListener("mousedown",ee),()=>document.removeEventListener("mousedown",ee)},[]);const U=(ee,me,$)=>{const K=e[ee]||[],re=$?[...K,me]:K.filter(H=>H!==me);t(ee,re)},W=async ee=>{const me=ee.toLowerCase().replace(/\s+/g,"_");if(M&&P){if(P.id==="admin"){y({message:"The Admin role cannot be renamed.",type:"error"});return}if(o.some(K=>K.id===me&&K.id!==P.id)){y({message:`A role with ID '${me}' already exists.`,type:"error"});return}const $=o.map(K=>K.id===P.id?{...K,displayName:ee,id:me}:K);await ue.saveRoles($),l($),a(P.id,me),y({message:"Role renamed.",type:"success"})}else{if(o.some(re=>re.id===me)){y({message:`A role with ID '${me}' already exists.`,type:"error"});return}const $={id:me,displayName:ee},K=[...o,$];await ue.saveRoles(K),l(K),r($),y({message:"Role added successfully.",type:"success"})}},G=async()=>{if(!P||P.id==="admin"){y({message:"This role cannot be deleted.",type:"error"}),C(!1);return}const ee=o.filter(me=>me.id!==P.id);await ue.saveRoles(ee),l(ee),s(P.id),y({message:`Role '${P.displayName}' deleted.`,type:"success"}),C(!1)},Z=E.useMemo(()=>new Map(_m.map(ee=>[ee.key,ee])),[]),Y=E.useMemo(()=>{const ee=new Set(c.flatMap(me=>me.permissions));return _m.filter(me=>!ee.has(me.key))},[c]),ae=ee=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Permission",className:"px-4 py-4",children:i.jsxs("div",{className:"flex flex-col items-end text-right md:items-start md:text-left",children:[i.jsx("div",{className:"font-semibold text-primary-text",children:ee.name}),i.jsx("div",{className:"text-xs text-muted",children:ee.description})]})}),o.map(me=>{const $=e[me.id]?.includes(ee.key),K=me.id==="admin",re=K?"Admin role has all permissions by default and cannot be changed.":"";return i.jsx("td",{"data-label":me.displayName,className:"px-4 py-4 text-center align-middle",children:i.jsx("div",{className:"flex justify-center",children:i.jsxs("label",{className:`relative flex items-center justify-center w-5 h-5 ${K?"cursor-not-allowed":"cursor-pointer"}`,children:[i.jsx("input",{type:"checkbox",className:"sr-only peer",checked:$,onChange:H=>U(me.id,ee.key,H.target.checked),disabled:K,title:re}),i.jsx("span",{className:`w-5 h-5 bg-white border border-gray-300 rounded flex items-center justify-center peer-focus-visible:ring-2 peer-focus-visible:ring-offset-2 peer-focus-visible:ring-accent-dark peer-checked:border-accent ${K?"opacity-50":""}`,children:$?i.jsx(jl,{className:"w-4 h-4 text-accent"}):i.jsx(vi,{className:"w-4 h-4 text-red-500"})})]})})},me.id)})]},ee.key);return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)}),i.jsx(use,{isOpen:_,onClose:()=>w(!1),onSave:W,title:M?"Rename Role":"Add New Role",initialName:M?P?.displayName:""}),i.jsxs(Kr,{isOpen:j,onClose:()=>C(!1),onConfirm:G,title:"Confirm Deletion",children:['Are you sure you want to delete the role "',P?.displayName,'"? This action cannot be undone.']}),i.jsx(na,{title:"Role & Permission Management",children:i.jsxs("button",{onClick:()=>n("/admin/roles/add"),className:"btn btn-primary btn-md",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Role"]})}),i.jsx("p",{className:"text-muted text-sm -mt-4 mb-6",children:"Assign permissions to user roles. Changes are saved automatically."}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-4 py-3 text-left font-bold text-primary-text",children:"Permission"}),o.map(ee=>i.jsx("th",{scope:"col",className:"px-4 py-3 text-center font-bold text-primary-text w-40",children:i.jsxs("div",{className:"flex items-center justify-center gap-1",children:[i.jsx("span",{children:ee.displayName}),ee.id!=="admin"&&i.jsxs("div",{className:"relative",children:[i.jsx("button",{onClick:()=>F(ee.id===I?null:ee.id),children:i.jsx(pJ,{className:"h-4 w-4 text-muted"})}),I===ee.id&&i.jsxs("div",{ref:q,className:"absolute right-0 mt-2 w-32 bg-card border rounded-md shadow-lg z-10",children:[i.jsxs("button",{onClick:()=>{n(`/admin/roles/edit/${ee.id}`),F(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center",children:[i.jsx(dr,{className:"mr-2 h-4 w-4"}),"Edit"]}),i.jsxs("button",{onClick:()=>{O(ee),C(!0),F(null)},className:"w-full text-left px-3 py-2 text-sm hover:bg-page flex items-center text-red-600",children:[i.jsx(rn,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})]})},ee.id))]})}),h?i.jsx("tbody",{children:B?i.jsx("tr",{children:i.jsx("td",{colSpan:o.length+1||2,children:i.jsx(Ra,{rows:3,cols:2,isMobile:!0})})}):i.jsx(Ra,{rows:10,cols:o.length+1||5})}):i.jsxs(i.Fragment,{children:[c.map(ee=>i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:ee.name})}),ee.permissions.map(me=>{const $=Z.get(me);return $?ae($):null})]},ee.id)),Y.length>0&&i.jsxs("tbody",{className:"divide-y divide-border",children:[i.jsx("tr",{className:"bg-page/50",children:i.jsx("td",{colSpan:o.length+1,className:"p-2 font-bold text-primary-text",children:"Uncategorized"})}),Y.map(ae)]})]})]})})]})},hse=Pt({id:xe().required(),name:xe().required("Module name is required"),description:xe().required("Description is required"),permissions:js().of(xe().required()).min(1,"At least one permission must be selected")}).defined(),mse=({isOpen:n,onClose:e,onSave:t,initialData:r})=>{const{register:s,handleSubmit:a,control:o,reset:l,formState:{errors:c}}=tn({resolver:In(hse)});return E.useEffect(()=>{n&&l(r||{id:`mod_${Date.now()}`,name:"",description:"",permissions:[]})},[n,r,l]),n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card w-full max-w-2xl my-8 animate-fade-in-scale flex flex-col",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:a(t),children:[i.jsx("div",{className:"p-4 border-b",children:i.jsxs("h3",{className:"text-xl font-bold",children:[r?"Edit":"Add"," Module"]})}),i.jsxs("div",{className:"p-6 space-y-4 max-h-[60vh] overflow-y-auto",children:[i.jsx(we,{label:"Module Name",...s("name"),error:c.name?.message}),i.jsx(we,{label:"Description",...s("description"),error:c.description?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2 p-4 border rounded-lg h-64 overflow-y-auto bg-page",children:i.jsx(_e,{name:"permissions",control:o,render:({field:d})=>i.jsx(i.Fragment,{children:_m.map(h=>i.jsx(Dn,{id:`perm-${h.key}`,label:h.name,checked:d.value?.includes(h.key)||!1,onChange:p=>{const x=p?[...d.value||[],h.key]:(d.value||[]).filter(y=>y!==h.key);d.onChange(x)}},h.key))})})}),c.permissions&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:Array.isArray(c.permissions)?c.permissions[0]?.message:c.permissions.message})]})]}),i.jsxs("div",{className:"p-4 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Module"})]})]})})}):null},pse=({count:n=6})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col space-y-3",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Gr,{className:"h-5 w-5 rounded-full"}),i.jsx(Gr,{className:"h-5 w-1/2"})]}),i.jsx(Gr,{className:"h-4 w-full"}),i.jsx(Gr,{className:"h-4 w-3/4"}),i.jsx(Gr,{className:"h-3 w-1/4"})]},t))}),gse=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(null),[l,c]=E.useState(!1),[d,h]=E.useState(!1),[p,x]=E.useState(null);E.useEffect(()=>{(async()=>{s(!0);try{const j=await ue.getModules();t(j)}catch{o({message:"Failed to load modules.",type:"error"})}finally{s(!1)}})()},[]);const y=async w=>{const j=[...e],C=j.findIndex(P=>P.id===w.id);C>-1?j[C]=w:j.push(w);try{await ue.saveModules(j),t(j.sort((P,O)=>P.name.localeCompare(O.name))),o({message:`Module '${w.name}' saved.`,type:"success"}),c(!1)}catch{o({message:"Failed to save module.",type:"error"})}},_=async()=>{if(!p)return;const w=e.filter(j=>j.id!==p.id);try{await ue.saveModules(w),t(w),o({message:`Module '${p.name}' deleted.`,type:"success"}),h(!1)}catch{o({message:"Failed to delete module.",type:"error"})}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[a&&i.jsx(pt,{...a,onDismiss:()=>o(null)}),i.jsx(mse,{isOpen:l,onClose:()=>c(!1),onSave:y,initialData:p}),i.jsxs(Kr,{isOpen:d,onClose:()=>h(!1),onConfirm:_,title:"Confirm Deletion",children:['Are you sure you want to delete the module "',p?.name,'"?']}),i.jsx(na,{title:"Module Management",children:i.jsxs(ne,{onClick:()=>n("/admin/modules/add"),children:[i.jsx(Vt,{className:"mr-2 h-4"})," Add Module"]})}),r?i.jsx(pse,{count:6}):i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:e.map(w=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border border-border flex flex-col",children:[i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx(ym,{className:"h-5 w-5 text-accent"}),i.jsx("h4",{className:"font-bold text-primary-text",children:w.name})]}),i.jsx("p",{className:"text-sm text-muted mb-3",children:w.description}),i.jsxs("p",{className:"text-xs font-semibold text-muted",children:[w.permissions.length," permissions"]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border flex justify-end gap-2",children:[i.jsx(ne,{variant:"icon",onClick:()=>{x(w),c(!0)},title:`Edit ${w.name}`,className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(dr,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>{x(w),h(!0)},title:`Delete ${w.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},w.id))})]})},Fg="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",xse="https://fmyafuhxlorbafbacywa.supabase.co/storage/v1/object/sign/logo/Paradigm-Logo-3-1024x157.png?token=eyJraWQiOiJzdG9yYWdlLXVybC1zaWduaW5nLWtleV82MDgwNWUxZC0yMTk2LTQxMjktYjUwMC0yMGZiYzgwN2I3NjUiLCJhbGciOiJIUzI1NiJ9.eyJ1cmwiOiJsb2dvL1BhcmFkaWdtLUxvZ28tMy0xMDI0eDE1Ny5wbmciLCJpYXQiOjE3NjM2MTQwNzUsImV4cCI6MjA3ODk3NDA3NX0.TYFTGDrqZ3frG3wS6gbF5TQchyBX3kb2VV49Il4X-34",yse="/SouthWall-Logo.jpg",oC=n=>n==="blue"?yse:xse,vse=n=>n==="blue"?"SouthWall Security":"Paradigm Services",s6=Xi(_u(n=>({currentLogo:Fg,defaultLogo:Fg,setCurrentLogo:e=>n({currentLogo:e}),setDefaultLogo:()=>n(e=>({defaultLogo:e.currentLogo})),resetToDefault:()=>n(e=>({currentLogo:e.defaultLogo})),resetToOriginal:()=>n({currentLogo:Fg,defaultLogo:Fg})}),{name:"paradigm-app-logo",storage:Xc(()=>localStorage)})),jN=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-page p-4 rounded-lg",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 text-accent-dark mr-3"}),i.jsx("h4",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"space-y-4",children:t})]}),bse=({isOpen:n,onClose:e})=>{const{currentLogo:t,defaultLogo:r,setCurrentLogo:s,setDefaultLogo:a,resetToDefault:o,resetToOriginal:l}=s6(),{backgroundImages:c,addBackgroundImage:d,removeBackgroundImage:h}=_3(),p=v3(),[x,y]=E.useState(null),_=O=>{if(O){const M=new FileReader;M.readAsDataURL(O.file),M.onloadend=()=>{const D=M.result;s(D),y({message:"Active logo updated!",type:"success"})},M.onerror=()=>{y({message:"Failed to read logo file.",type:"error"})}}},w=()=>{a(),y({message:"Active logo has been set as the new default.",type:"success"})},j=()=>{o(),y({message:"Logo has been reset to your default.",type:"success"})},C=()=>{l(),y({message:"Logo has been reset to the system original.",type:"success"})},P=O=>{if(O&&!O.url){const M=new FileReader;M.readAsDataURL(O.file),M.onloadend=()=>{const D=M.result,I=d(D);y(I?{message:"Background image added.",type:"success"}:{message:"This image has already been added.",type:"error"})},M.onerror=()=>{y({message:"Failed to read image file.",type:"error"})}}};return n?i.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)}),i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl my-8 animate-fade-in-scale flex flex-col",onClick:O=>O.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Page Interface Settings"}),i.jsx(ne,{variant:"icon",onClick:e,children:i.jsx(vi,{className:"h-5 w-5"})})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[75vh]",children:[i.jsxs(jN,{title:"Branding & Logo",icon:a3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the active and default logos for your application."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8 pt-4 items-start",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Active Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:t,alt:"Current Active Logo",className:"max-h-24 w-auto"})}),i.jsx(vt,{label:"Change Active Logo",file:null,onFileChange:_,allowedTypes:["image/jpeg","image/png"]})]}),i.jsxs("div",{className:"flex flex-col h-full",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Default Logo"}),i.jsx("div",{className:"p-4 border rounded-lg bg-page flex justify-center items-center min-h-[120px]",children:i.jsx("img",{src:r,alt:"Default Logo",className:"max-h-24 w-auto"})})]}),i.jsx("div",{className:"flex-grow"}),i.jsxs("div",{className:"space-y-2 mt-4",children:[i.jsx(ne,{type:"button",className:"w-full",onClick:w,children:"Set Active Logo as Default"}),i.jsx(ne,{type:"button",className:"w-full",variant:"outline",onClick:j,children:"Use Default Logo"}),i.jsx("div",{className:"text-center pt-2",children:i.jsx("button",{type:"button",onClick:C,className:"text-xs text-muted hover:text-primary-text underline",children:"Reset to System Original"})})]})]})]})]}),i.jsxs(jN,{title:"Login Screen Background",icon:o3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage the background images for the login screen carousel."}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:c.map((O,M)=>i.jsxs("div",{className:"relative group aspect-video bg-page rounded-md overflow-hidden",children:[i.jsx("img",{src:O,className:"w-full h-full object-cover",alt:`Background ${M+1}`}),i.jsx("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity flex items-center justify-center",children:i.jsx(ne,{variant:"icon",onClick:()=>h(M),className:"!rounded-full !bg-white/20 hover:!bg-white/40",children:i.jsx(rn,{className:"h-5 w-5 text-white"})})})]},`${O.substring(0,30)}-${M}`))}),i.jsx("div",{className:"mt-4",children:i.jsx(vt,{label:"Add new background image",file:null,onFileChange:P,allowedTypes:["image/jpeg","image/png","image/webp"]})})]}),i.jsxs(jN,{title:"Interaction Settings",icon:PJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize hover and auto-scroll behaviors for easier navigation."}),i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsx(Dn,{id:"auto-click-hover-modal",label:"Enable Auto-Click on Hover",description:"Automatically switch tabs or pages by hovering over them.",checked:p.autoClickOnHover,onChange:p.setAutoClickOnHover}),i.jsx(Dn,{id:"auto-scroll-hover-modal",label:"Enable Auto-Scroll on Hover",description:"Automatically scroll the page by hovering over the up/down arrows.",checked:p.autoScrollOnHover,onChange:p.setAutoScrollOnHover})]})]})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ne,{variant:"primary",onClick:e,children:"Done"})})]})]}):null},Gd=({title:n,icon:e,children:t,className:r})=>i.jsxs("div",{className:`border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card ${r||""}`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(e,{className:"h-6 w-6 text-accent-dark"})}),i.jsx("div",{children:i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:n})})]}),i.jsx("div",{className:"space-y-4",children:t})]}),wse=()=>{const n=yi(),{colorScheme:e,setColorScheme:t}=an(),[r,s]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),d=async()=>{s(!0),o(null);try{const x=await ue.exportAllData(),y=`data:text/json;charset=utf-8,${encodeURIComponent(JSON.stringify(x,null,2))}`,_=document.createElement("a");_.href=y,_.download=`paradigm_backup_${new Date().toISOString()}.json`,document.body.appendChild(_),_.click(),document.body.removeChild(_),o({message:"Data exported successfully!",type:"success"})}catch{o({message:"Failed to export data.",type:"error"})}finally{s(!1)}},h={green:"Paradigm Green",purple:"Royal Purple",red:"Crimson Red",amber:"Amber Gold"},p=x=>{t(x),o({message:`Color scheme changed to ${h[x]}!`,type:"success"})};return i.jsxs("div",{className:"space-y-8 p-4 md:p-0",children:[a&&i.jsx(pt,{message:a.message,type:a.type,onDismiss:()=>o(null)}),i.jsx(bse,{isOpen:l,onClose:()=>c(!1)}),i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"System Settings"})}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Gd,{title:"Color Scheme",icon:OJ,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Choose the application's primary color scheme."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 pt-4",children:[i.jsxs("button",{type:"button",onClick:()=>p("green"),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${e==="green"?"border-green-500 bg-green-50 ring-2 ring-green-200":"border-border hover:border-green-300"}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-[#006B3F] flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"P"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:"Paradigm Green"}),i.jsx("p",{className:"text-xs text-muted",children:"Nature theme"})]})]}),i.jsxs("button",{type:"button",onClick:()=>p("purple"),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${e==="purple"?"border-purple-500 bg-purple-50 ring-2 ring-purple-200":"border-border hover:border-purple-300"}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-[#5B21B6] flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"R"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:"Royal Purple"}),i.jsx("p",{className:"text-xs text-muted",children:"Premium theme"})]})]}),i.jsxs("button",{type:"button",onClick:()=>p("red"),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${e==="red"?"border-red-500 bg-red-50 ring-2 ring-red-200":"border-border hover:border-red-300"}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-[#991B1B] flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"C"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:"Crimson Red"}),i.jsx("p",{className:"text-xs text-muted",children:"Bold theme"})]})]}),i.jsxs("button",{type:"button",onClick:()=>p("amber"),className:`flex items-center gap-3 p-4 rounded-xl border-2 transition-all ${e==="amber"?"border-orange-500 bg-orange-50 ring-2 ring-orange-200":"border-border hover:border-orange-300"}`,children:[i.jsx("div",{className:"w-10 h-10 rounded-full bg-[#B45309] flex items-center justify-center flex-shrink-0",children:i.jsx("span",{className:"text-white font-bold text-sm",children:"A"})}),i.jsxs("div",{className:"text-left",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:"Amber Gold"}),i.jsx("p",{className:"text-xs text-muted",children:"Warm theme"})]})]})]})]}),i.jsxs(Gd,{title:"Page Interface",icon:a3,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Customize the application's branding, login screen, and user interaction settings."}),i.jsx("div",{className:"pt-4",children:i.jsx(ne,{type:"button",onClick:()=>c(!0),children:"Open Interface Settings"})})]}),i.jsxs(Gd,{title:"Verification APIs",icon:ly,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure third-party services for employee verification."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:i.jsx(Dn,{id:"gemini-enabled",label:"Enable Gemini API OCR Verification",description:"Use Google's Gemini API for document data extraction. This is a powerful fallback or primary OCR. API key must be configured on the backend.",checked:n.geminiApi.enabled,onChange:x=>n.updateGeminiApiSettings({enabled:x.target.checked})})}),i.jsxs("div",{className:"p-4 border border-border rounded-lg api-setting-item-bg",children:[i.jsx(Dn,{id:"perfios-enabled",label:"Enable Perfios API Verification",description:"Use Perfios for Bank, Aadhaar, and UAN verification.",checked:n.perfiosApi.enabled,onChange:x=>n.updatePerfiosApiSettings({enabled:x.target.checked})}),i.jsxs("div",{className:`mt-4 space-y-4 transition-opacity ${n.perfiosApi.enabled?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsx(we,{label:"Perfios Client ID",value:n.perfiosApi.clientId,onChange:x=>n.updatePerfiosApiSettings({clientId:x.target.value})}),i.jsx(we,{label:"Perfios Client Secret",type:"password",value:n.perfiosApi.clientSecret,onChange:x=>n.updatePerfiosApiSettings({clientSecret:x.target.value})})]})]})]})]}),i.jsxs(Gd,{title:"Authentication Settings",icon:Af,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage how users sign in to the application."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Dn,{id:"otp-enabled",label:"Enable OTP Phone Sign-In",description:"Allow users to sign in using a one-time password sent via SMS.",checked:n.otp.enabled,onChange:x=>n.updateOtpSettings({enabled:x.target.checked})})})]})]}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs(Gd,{title:"Client & Site Management",icon:Zi,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Control workflows for site creation and management."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Dn,{id:"enable-provisional-sites",label:"Enable Provisional Site Creation",description:"Allows HR/Admins to create a site with just a name, providing a 90-day grace period to complete the full configuration for easier onboarding.",checked:n.siteManagement.enableProvisionalSites,onChange:x=>n.updateSiteManagementSettings({enableProvisionalSites:x.target.checked})})})]}),i.jsxs(Gd,{title:"System & Data",icon:Om,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Manage core system settings and data operations."}),i.jsxs("div",{className:"space-y-6 pt-4",children:[i.jsx(Dn,{id:"pincode-verification",label:"Enable Pincode API Verification",description:"Auto-fill City/State from pincode during onboarding.",checked:n.address.enablePincodeVerification,onChange:x=>n.updateAddressSettings({enablePincodeVerification:x.target.checked})}),i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:"Backup & Export"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Download all data from the active data source (Mock Data)."}),i.jsxs(ne,{type:"button",variant:"outline",onClick:d,isLoading:r,children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export All Data"]})]})]})]}),i.jsxs(Gd,{title:"Notification Settings",icon:Hf,children:[i.jsx("p",{className:"text-sm text-muted -mt-2",children:"Configure how the system sends notifications."}),i.jsx("div",{className:"space-y-6 pt-4",children:i.jsx(Dn,{id:"email-notif-enabled",label:"Enable Email Notifications",description:"Send emails for important events like task assignments. SMTP must be configured on the backend.",checked:n.notifications.email.enabled,onChange:x=>n.updateNotificationSettings({email:{enabled:x.target.checked}})})})]})]})]})]})},Pr=({title:n,subtitle:e})=>i.jsxs("div",{className:"mb-6",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text form-header-title",children:n}),i.jsx("p",{className:"mt-2 text-sm text-muted",children:e})]}),_se=({title:n,value:e,icon:t})=>{const{colorScheme:r}=an();return i.jsxs("div",{className:`p-4 rounded-2xl flex flex-col md:flex-row items-start md:items-center col-span-1 gap-3 md:gap-0 transition-colors ${r==="blue"?"!bg-blue-500 !text-white shadow-md":"bg-card shadow-sm"}`,children:[i.jsx("div",{className:`p-3 rounded-full md:mr-4 ${r==="blue"?"bg-white/20":"bg-accent-light"}`,children:i.jsx(t,{className:`h-6 w-6 ${r==="blue"?"!text-white":"text-accent-dark"}`})}),i.jsxs("div",{children:[i.jsx("p",{className:`text-sm font-medium ${r==="blue"?"!text-white":"text-muted"}`,children:n}),i.jsx("p",{className:`text-2xl font-bold ${r==="blue"?"!text-white":"text-primary-text"}`,children:e})]})]})},jo=ot.memo(_se),jse=()=>{const n=St(),{colorScheme:e}=an(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,y]=E.useState([{startDate:new Date(new Date().setMonth(new Date().getMonth()-1)),endDate:new Date,key:"selection"}]),[_,w]=E.useState(!1),[j,C]=E.useState(""),[P,O]=E.useState(""),[M,D]=E.useState(We(new Date,"yyyy-MM-dd"));E.useEffect(()=>{(async()=>{d(!0);try{const[W,G,Z]=await Promise.all([ue.getVerificationSubmissions(),ue.getFieldOfficers(),ue.getOrganizations()]);r(W),a(G),l(Z)}catch{p({message:"Failed to load dashboard data.",type:"error"})}finally{d(!1)}})()},[]);const I=E.useMemo(()=>{const U=x[0].startDate,W=x[0].endDate;if(!U||!W)return t;const G=new Date(W);return G.setHours(23,59,59,999),t.filter(Z=>{const Y=new Date(Z.enrollmentDate.replace(/-/g,"/"));return Y>=U&&Y<=G})},[t,x]),F=E.useMemo(()=>({total:I.length,verified:I.filter(U=>U.status==="verified").length,rejected:I.filter(U=>U.status==="rejected").length}),[I]),q=async U=>{if(U.preventDefault(),!j||!P||!M){p({message:"Please fill all fields for assignment.",type:"error"});return}try{await ue.createAssignment(j,P,M),p({message:"Assignment created successfully (mocked).",type:"success"})}catch{p({message:"Failed to create assignment.",type:"error"})}},B=x[0].startDate&&x[0].endDate?`${We(x[0].startDate,"MMM d, yyyy")} - ${We(x[0].endDate,"MMM d, yyyy")}`:"Select Date";return i.jsxs("div",{className:"p-4 space-y-8",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Operations Dashboard"}),i.jsxs("div",{className:"relative",children:[i.jsxs(ne,{variant:"outline",onClick:()=>w(!_),children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:B})]}),_&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(wm.DateRangePicker,{onChange:U=>{y([U.selection]),w(!1)},months:1,ranges:x,direction:"horizontal"})})]})]})}),i.jsx("div",{className:"bg-gradient-to-br from-accent/10 to-accent/5 border-2 border-accent/30 rounded-2xl p-6 cursor-pointer hover:border-accent hover:shadow-lg transition-all group",onClick:()=>n("/operations/team-activity"),children:i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[i.jsx("div",{className:"bg-accent rounded-xl p-3 group-hover:scale-110 transition-transform",children:i.jsx(Hh,{className:"h-6 w-6 text-white"})}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Team Activity Monitor"})]}),i.jsx("p",{className:"text-muted mb-4",children:"Track your field team in real-time. Monitor check-ins, working hours, locations, and communicate instantly with your team members."}),i.jsxs("div",{className:"flex flex-wrap gap-2",children:[i.jsx("span",{className:"px-3 py-1 bg-green-500/10 text-green-600 rounded-full text-xs font-medium",children:"Real-time tracking"}),i.jsx("span",{className:"px-3 py-1 bg-blue-500/10 text-blue-600 rounded-full text-xs font-medium",children:"Location monitoring"}),i.jsx("span",{className:"px-3 py-1 bg-purple-500/10 text-purple-600 rounded-full text-xs font-medium",children:"Quick communication"})]})]}),i.jsx("div",{className:"flex-shrink-0 ml-4",children:i.jsx(ne,{onClick:U=>{U.stopPropagation(),n("/operations/team-activity")},style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:"View Team Activity "})})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[i.jsx(jo,{title:"Total Submissions",value:F.total,icon:us}),i.jsx(jo,{title:"Verified Employees",value:F.verified,icon:xu}),i.jsx(jo,{title:"Rejected Applications",value:F.rejected,icon:Ox})]}),i.jsxs("div",{className:"bg-card p-6 rounded-2xl",children:[i.jsx(Pr,{title:"Assign Field Officer",subtitle:"Assign a field officer to an organization for a specific date."}),i.jsxs("form",{onSubmit:q,className:"grid grid-cols-1 md:grid-cols-4 gap-6 items-end",children:[i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ze,{label:"Field Officer",id:"officer",value:j,onChange:U=>C(U.target.value),children:[i.jsx("option",{value:"",children:"Select Officer"}),s.map(U=>i.jsx("option",{value:U.id,children:U.name},U.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(Ze,{label:"Organization/Site",id:"site",value:P,onChange:U=>O(U.target.value),children:[i.jsx("option",{value:"",children:"Select Site"}),o.map(U=>i.jsx("option",{value:U.id,children:U.shortName},U.id))]})}),i.jsx("div",{className:"md:col-span-1",children:i.jsx(En,{label:"Assignment Date",id:"assignmentDate",value:M,onChange:D})}),i.jsx("div",{className:"md:col-span-1",children:i.jsxs(ne,{type:"submit",className:"w-full",children:[i.jsx(M1,{className:"mr-2 h-4 w-4"}),"Assign"]})})]})]})]})},Nse=()=>{const{user:n}=jt(),{colorScheme:e}=an(),[t,r]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(null),c=Rt("(max-width: 767px)");E.useEffect(()=>{d();const w=setInterval(d,3e4);return()=>clearInterval(w)},[n]);const d=async()=>{if(n)try{a(!0);const w=await ue.getUsers();let j=[];n.role==="admin"||n.role==="developer"?j=w.filter(M=>M.role==="operation_manager"||M.role==="field_officer"):n.role==="operation_manager"&&(j=w.filter(M=>M.role==="field_officer"&&M.reportingManagerId===n.id));const C=new Date;C.setHours(0,0,0,0);const P=new Date;P.setHours(23,59,59,999);const O=await Promise.all(j.map(async M=>{try{const I=(await ue.getAttendanceEvents(M.id,C.toISOString(),P.toISOString())).sort((Z,Y)=>new Date(Y.timestamp).getTime()-new Date(Z.timestamp).getTime()),F=I.filter(Z=>Z.type.toLowerCase().replace(/[-_\s]/g,"")==="checkin"),q=I.filter(Z=>Z.type.toLowerCase().replace(/[-_\s]/g,"")==="checkout"),B=F[0],U=q[0];let W=0;for(let Z=0;Z<q.length;Z++){const Y=q[Z],ae=F.find(ee=>new Date(ee.timestamp)<new Date(Y.timestamp));if(ae){const ee=new Date(Y.timestamp).getTime()-new Date(ae.timestamp).getTime();W+=ee/(1e3*60*60)}}const G=B&&(!U||new Date(B.timestamp)>new Date(U.timestamp));if(G&&B){const Z=Date.now()-new Date(B.timestamp).getTime();W+=Z/(1e3*60*60)}return{...M,lastCheckIn:B?.timestamp,lastCheckOut:U?.timestamp,currentLocation:B?{latitude:B.latitude||0,longitude:B.longitude||0,address:B.address||void 0}:void 0,todayWorkingHours:W,todayTravelDistance:0,isCurrentlyWorking:G,isPresent:F.length>0}}catch(D){return console.error(`Error fetching data for ${M.name}:`,D),{...M,isPresent:!1,isCurrentlyWorking:!1}}}));r(O)}catch(w){console.error("Error fetching team members:",w)}finally{a(!1)}},h=w=>{if(!w)return;const j=w.replace(/\D/g,"").slice(-10);window.location.href=`tel:+91${j}`},p=w=>{if(!w)return;const j=w.replace(/\D/g,"").slice(-10);window.location.href=`sms:+91${j}`},x=w=>{if(!w)return"0h 0m";const j=Math.floor(w),C=Math.floor((w-j)*60);return`${j}h ${C}m`};if(s)return i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});const y=({member:w})=>i.jsx("div",{className:"bg-card border border-border rounded-xl p-4 hover:border-accent transition-all cursor-pointer",onClick:()=>l(w),children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Gi,{photoUrl:w.photoUrl,seed:w.id,className:"w-12 h-12 rounded-full"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ring-2 ring-white ${w.isCurrentlyWorking?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":w.isPresent?"bg-yellow-500 shadow-[0_0_10px_rgba(234,179,8,0.8)]":"bg-gray-400"}`})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-primary-text truncate",children:w.name}),i.jsx("p",{className:"text-xs text-muted",children:w.role.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())}),i.jsxs("div",{className:"mt-2 space-y-1",children:[i.jsx("div",{className:"flex items-center gap-2 text-xs",children:w.isCurrentlyWorking?i.jsxs(i.Fragment,{children:[i.jsx(Hh,{className:"h-3 w-3 text-green-500"}),i.jsx("span",{className:"text-green-500 font-medium",children:"Working"})]}):w.isPresent?i.jsxs(i.Fragment,{children:[i.jsx(LM,{className:"h-3 w-3 text-yellow-500"}),i.jsx("span",{className:"text-yellow-500",children:"Checked Out"})]}):i.jsxs(i.Fragment,{children:[i.jsx(gm,{className:"h-3 w-3 text-gray-400"}),i.jsx("span",{className:"text-gray-400",children:"Absent"})]})}),w.todayWorkingHours>0&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted",children:[i.jsx($c,{className:"h-3 w-3"}),i.jsx("span",{children:x(w.todayWorkingHours)})]})]})]}),i.jsxs("div",{className:"flex flex-col gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:j=>{j.stopPropagation(),h(w.phone)},className:"hover:bg-accent/10",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:i.jsx(Af,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:j=>{j.stopPropagation(),p(w.phone)},className:"hover:bg-accent/10",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:i.jsx(xm,{className:"h-4 w-4"})})]})]})}),_=({member:w})=>i.jsxs("div",{className:"bg-card border border-border rounded-xl p-6",children:[i.jsxs("div",{className:"flex items-start justify-between mb-6",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Gi,{photoUrl:w.photoUrl,seed:w.id,className:"w-16 h-16 rounded-full"}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:w.name}),i.jsx("p",{className:"text-sm text-muted",children:w.role.replace(/_/g," ").replace(/\b\w/g,j=>j.toUpperCase())})]})]}),c&&i.jsx(ne,{variant:"secondary",size:"sm",onClick:()=>l(null),children:"Close"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Dx,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check In"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:w.lastCheckIn?We(new Date(w.lastCheckIn),"hh:mm a"):"Not checked in"}),w.lastCheckIn&&i.jsx("p",{className:"text-xs text-muted mt-1",children:hu(new Date(w.lastCheckIn),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(_o,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Last Check Out"})]}),i.jsx("p",{className:"text-sm font-bold text-primary-text",children:w.lastCheckOut?We(new Date(w.lastCheckOut),"hh:mm a"):"Not checked out"}),w.lastCheckOut&&i.jsx("p",{className:"text-xs text-muted mt-1",children:hu(new Date(w.lastCheckOut),{addSuffix:!0})})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx($c,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Hours Today"})]}),i.jsx("p",{className:"text-lg font-bold text-primary-text",children:x(w.todayWorkingHours)})]}),i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Hh,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Status"})]}),i.jsx("p",{className:`text-lg font-bold ${w.isCurrentlyWorking?"text-green-500":w.isPresent?"text-yellow-500":"text-gray-400"}`,children:w.isCurrentlyWorking?"Working":w.isPresent?"Checked Out":"Absent"})]})]}),w.currentLocation&&i.jsxs("div",{className:"bg-accent/5 rounded-lg p-4 mb-6",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(kl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Current Location"})]}),i.jsx("p",{className:"text-sm text-primary-text",children:w.currentLocation.address||"Location not available"}),w.currentLocation.latitude!==0&&i.jsx("a",{href:`https://www.google.com/maps?q=${w.currentLocation.latitude},${w.currentLocation.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"text-xs text-accent hover:underline mt-2 inline-block",children:"View on map "})]}),i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ne,{onClick:()=>h(w.phone),className:"flex-1",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:[i.jsx(Af,{className:"h-4 w-4 mr-2"}),"Call"]}),i.jsxs(ne,{onClick:()=>p(w.phone),className:"flex-1",style:{backgroundColor:e==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF"},children:[i.jsx(xm,{className:"h-4 w-4 mr-2"}),"Message"]})]})]});return i.jsxs("div",{className:"p-4 lg:p-8 space-y-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Team Activity"}),i.jsx("p",{className:"text-sm text-muted mt-1",children:n?.role==="operation_manager"?"Monitor your field team in real-time":"Monitor all operation managers and field officers"})]}),i.jsxs(ne,{onClick:d,variant:"secondary",size:"sm",children:[i.jsx(Hh,{className:"h-4 w-4 mr-2"}),"Refresh"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Pl,{className:"h-4 w-4 text-accent"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Total Team"})]}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:t.length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(Hh,{className:"h-4 w-4 text-green-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Working Now"})]}),i.jsx("p",{className:"text-2xl font-bold text-green-500",children:t.filter(w=>w.isCurrentlyWorking).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(LM,{className:"h-4 w-4 text-yellow-500"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Present"})]}),i.jsx("p",{className:"text-2xl font-bold text-yellow-500",children:t.filter(w=>w.isPresent).length})]}),i.jsxs("div",{className:"bg-card border border-border rounded-xl p-4",children:[i.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[i.jsx(gm,{className:"h-4 w-4 text-gray-400"}),i.jsx("span",{className:"text-xs font-medium text-muted",children:"Absent"})]}),i.jsx("p",{className:"text-2xl font-bold text-gray-400",children:t.filter(w=>!w.isPresent).length})]})]}),c&&o?i.jsx(_,{member:o}):i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[i.jsx("div",{className:"lg:col-span-2 space-y-3",children:t.length===0?i.jsxs("div",{className:"bg-card border border-border rounded-xl p-12 text-center",children:[i.jsx(Pl,{className:"h-12 w-12 mx-auto text-muted mb-4 opacity-50"}),i.jsx("p",{className:"text-muted",children:"No team members found"})]}):t.map(w=>i.jsx(y,{member:w},w.id))}),!c&&o&&i.jsx("div",{className:"lg:col-span-1 sticky top-6 self-start",children:i.jsx(_,{member:o})})]})]})},Sse=({status:n})=>{if(!n)return i.jsx("span",{className:"text-sm font-medium text-muted",children:"-"});const e={pending_sync:"sync-chip--pending_sync",synced:"sync-chip--synced",failed:"sync-chip--failed"},t={pending_sync:"Pending Sync",synced:"Synced",failed:"Failed"},r=e[n];return i.jsx("span",{className:`sync-chip ${r}`,children:t[n]})},Cse=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState("all"),[o,l]=E.useState(""),[c,d]=E.useState(null),h=St(),{user:p}=jt(),x=Rt("(max-width: 767px)"),{colorScheme:y}=an(),[_,w]=E.useState([]),[j,C]=E.useState(p?.organizationId),P=p&&p.role==="admin";E.useEffect(()=>{P&&ue.getOrganizations().then(F=>{w(F),F.length>0&&!j&&C(F[0].id)})},[P,j]);const O=E.useCallback(async()=>{if(!j){p?.organizationId&&r(!1);return}r(!0);try{const F=await ue.getVerificationSubmissions(s==="all"?void 0:s,j);e(F)}catch(F){console.error("Failed to fetch submissions",F)}finally{r(!1)}},[s,j,p?.organizationId]);E.useEffect(()=>{O()},[O]);const M=E.useMemo(()=>n.filter(F=>F.personal.firstName.toLowerCase().includes(o.toLowerCase())||F.personal.lastName.toLowerCase().includes(o.toLowerCase())||F.personal.employeeId.toLowerCase().includes(o.toLowerCase())),[n,o]),D=_.find(F=>F.id===j)?.shortName||p?.organizationName,I=["all","pending","verified","rejected"];return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Site Dashboard"}),i.jsxs("p",{className:"text-muted",children:["Viewing submissions for site: ",i.jsx("span",{className:"font-semibold text-accent-dark",children:D||"N/A"})]})]}),!x&&i.jsxs("div",{className:"flex items-center gap-4",children:[P&&i.jsx("div",{className:"w-full sm:w-56",children:i.jsxs(Ze,{label:"",id:"org-selector",value:j||"",onChange:F=>C(F.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),_.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]})}),i.jsxs(ne,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:y==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:y==="blue"?"#0f264a":"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]})]}),x&&i.jsxs("div",{className:"flex flex-col gap-4 mt-6",children:[P&&i.jsxs(Ze,{label:"Select Site",id:"org-selector-mobile",value:j||"",onChange:F=>C(F.target.value),children:[i.jsx("option",{value:"",children:"Select a Site"}),_.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(ne,{onClick:()=>h("/onboarding/select-organization"),style:{backgroundColor:y==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:y==="blue"?"#0f264a":"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Yc,{className:"mr-2 h-4 w-4"}),"New Enrollment"]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center my-6 gap-4",children:[i.jsx("div",{className:"w-full sm:w-auto border-b border-border",children:i.jsx("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:I.map(F=>i.jsx("button",{onClick:()=>a(F),className:`${s===F?"border-emerald-500 text-emerald-700":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"} whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm capitalize transition-colors duration-200`,children:F},F))})}),i.jsxs("div",{className:"relative w-full sm:w-auto sm:max-w-xs",children:[i.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:i.jsx(Ia,{className:"h-5 w-5 text-gray-400"})}),i.jsx("input",{type:"text",placeholder:"Search by name or ID...",value:o,onChange:F=>l(F.target.value),className:"block w-full pl-10 pr-3 py-2 border border-border rounded-lg leading-5 bg-white placeholder-gray-500 focus:outline-none focus:placeholder-gray-400 focus:ring-1 focus:ring-accent focus:border-accent sm:text-sm"})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Portal Sync"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase tracking-wider",children:"Actions"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading submissions..."})}):j?M.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No submissions found for this site."})}):M.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4 whitespace-nowrap",children:[i.jsxs("div",{className:"text-sm font-medium text-primary-text",children:[F.personal.firstName," ",F.personal.lastName]}),i.jsx("div",{className:"text-sm text-muted",children:F.personal.employeeId})]}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(z1,{status:F.status})}),i.jsx("td",{"data-label":"Portal Sync",className:"px-6 py-4 whitespace-nowrap",children:i.jsx(Sse,{status:F.portalSyncStatus})}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/add/personal?id=${F.id}`),title:"View/Edit Details",children:i.jsx(Cl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>h(`/onboarding/pdf/${F.id}`),title:"Download Forms",children:i.jsx(us,{className:"h-4 w-4"})})]})})]},F.id)):i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Please select a site to view submissions."})})})]})})]})},$S=({file:n,onFileChange:e})=>{const[t,r]=E.useState(!1),[s,a]=E.useState(""),[o,l]=E.useState(!1),c=E.useCallback(async y=>{if(y&&y.type.startsWith("image/")){a("");const _={name:y.name,type:y.type,size:y.size,preview:URL.createObjectURL(y),file:y};e(_)}},[e]),d=async y=>{const _=y.target.files?.[0];_&&c(_)},h=E.useCallback(async(y,_)=>{const w=await(await fetch(`data:${_};base64,${y}`)).blob(),j=new File([w],`capture-${Date.now()}.jpg`,{type:_});c(j)},[c]),p=()=>{n&&URL.revokeObjectURL(n.preview),e(null),a("")},x="avatar-upload";return i.jsxs("div",{className:"flex flex-col items-center space-y-2",children:[o&&i.jsx(e5,{isOpen:o,onClose:()=>l(!1),onCapture:h,captureGuidance:"profile"}),i.jsxs("div",{className:"relative w-40 h-40",children:[i.jsx("div",{className:`w-full h-full rounded-full bg-page flex items-center justify-center overflow-hidden border-2 transition-colors ${s?"border-red-500":"border-border"}`,children:t?i.jsxs("div",{className:"flex flex-col items-center text-muted",children:[i.jsx(_t,{className:"h-8 w-8 animate-spin"}),i.jsx("span",{className:"text-xs mt-2",children:"Processing..."})]}):n?.preview?i.jsx("img",{src:n.preview,alt:"Profile preview",className:"w-full h-full object-cover"}):i.jsx(Gi,{})}),n&&!t&&i.jsx("button",{type:"button",onClick:p,id:"avatar-delete-button",className:"avatar-delete-btn btn-icon absolute top-2 right-2 p-1.5 rounded-full transition-colors !bg-white/90 !text-red-600 hover:!bg-red-100","aria-label":"Remove photo",children:i.jsx(rn,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsxs("label",{htmlFor:x,className:`cursor-pointer inline-flex items-center justify-center font-semibold focus:outline-none focus:ring-2 focus:ring-offset-2 transition-colors duration-200 rounded-full bg-accent text-white hover:bg-accent-dark focus:ring-accent px-4 py-2 text-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(dr,{className:"w-4 h-4 mr-2"}),n?"Change":"Upload"]}),i.jsx("input",{id:x,name:x,type:"file",className:"sr-only",onChange:d,accept:"image/*",disabled:t}),i.jsxs("button",{type:"button",onClick:()=>l(!0),disabled:t,className:`avatar-capture-btn inline-flex items-center justify-center px-4 py-2 font-semibold rounded-full transition-colors duration-200 text-sm border border-red-200 !text-red-600 hover:!bg-red-50 !bg-card/70 backdrop-blur-sm ${t?"opacity-50 cursor-not-allowed":""}`,children:[i.jsx(C1,{className:"w-4 h-4 mr-2"}),"Capture"]})]}),s&&i.jsxs("p",{className:"text-xs text-red-600 text-center max-w-[160px] flex items-center gap-1",children:[i.jsx(Aa,{className:"h-3 w-3 flex-shrink-0"})," ",s]})]})},Tse=Pt({name:xe().required("Name is required"),email:xe().email("Must be a valid email").required("Email is required"),phone:xe().matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number").optional().nullable()}).defined(),kse=()=>{const{user:n,updateUserProfile:e,isCheckedIn:t,isAttendanceLoading:r,toggleCheckInStatus:s,logout:a,lastCheckInTime:o,lastCheckOutTime:l,checkAttendanceStatus:c}=jt(),{permissions:d}=ta(),h=St(),{theme:p,setTheme:x,isAutomatic:y,setAutomatic:_}=ed(),{colorScheme:w}=an(),[j,C]=E.useState(!1),[P,O]=E.useState(!1),[M,D]=E.useState(null),[I,F]=E.useState("prompt"),B=Rt("(max-width: 767px)");E.useEffect(()=>{const ce=async()=>{if(!navigator.permissions?.query){F("prompt");return}try{const oe=await navigator.permissions.query({name:"camera"}),de=await navigator.permissions.query({name:"geolocation"});oe.state==="granted"&&de.state==="granted"?F("granted"):oe.state==="denied"||de.state==="denied"?F("denied"):F("prompt");const te=()=>ce();oe.onchange=te,de.onchange=te}catch(oe){console.warn("Permissions API not fully supported. Defaulting to 'prompt'.",oe),F("prompt")}};ce()},[]);const{register:U,handleSubmit:W,formState:{errors:G,isDirty:Z},getValues:Y,trigger:ae,reset:ee}=tn({resolver:In(Tse),defaultValues:{name:n?.name||"",email:n?.email||"",phone:n?.phone||""}});E.useEffect(()=>{n&&ee({name:n.name||"",email:n.email||"",phone:n.phone||""})},[n,ee]);const me=async ce=>{if(!n)return;const oe=n.photoUrl;e({photoUrl:ce?.preview});try{let de=null;ce&&ce.file&&(de=await new Promise((ye,Ce)=>{const Re=new FileReader;Re.onloadend=()=>ye(Re.result),Re.onerror=Ce,Re.readAsDataURL(ce.file)}));const te=await ue.updateUser(n.id,{photoUrl:de});e(te),D({message:`Profile photo ${de?"updated":"removed"}.`,type:"success"})}catch(de){console.error(de),D({message:"Failed to save photo.",type:"error"}),e({photoUrl:oe})}},$=async ce=>{if(n){C(!0);try{const oe=await ue.updateUser(n.id,ce);e(oe),ee(ce),D({message:"Profile updated successfully!",type:"success"})}catch{D({message:"Failed to update profile.",type:"error"})}finally{C(!1)}}},K=P,re=()=>{h("/auth/logout")},H=ce=>ce?We(new Date(ce),"hh:mm a"):"--:--";n&&d[n.role]?.includes("manage_tasks");const se=ce=>ce.replace(/_/g," ").replace(/\b\w/g,oe=>oe.toUpperCase());if(!n)return i.jsx("div",{children:"Loading user profile..."});const ie=n.photoUrl?{preview:n.photoUrl,name:"Profile Photo",type:"image/jpeg",size:0}:null;return B?i.jsxs("div",{className:`p-4 space-y-8 md:bg-transparent ${w!=="green"?"!bg-white":"bg-[#041b0f]"}`,children:[M&&i.jsx(pt,{message:M.message,type:M.type,onDismiss:()=>D(null)}),i.jsxs("div",{className:"flex flex-col items-center text-center gap-4",children:[i.jsx($S,{file:ie,onFileChange:me}),i.jsxs("div",{children:[i.jsx("h2",{className:`text-2xl font-bold ${w!=="green"?"text-gray-900":"text-white"}`,children:n.name}),i.jsx("p",{className:`${w!=="green"?"text-gray-500":"text-muted"}`,children:n.role.replace(/_/g," ").replace(/\b\w/g,ce=>ce.toUpperCase())})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h3",{className:`fo-section-title mb-4 ${w!=="green"?"text-gray-900 border-gray-200":""}`,children:"Profile Details"}),i.jsxs("form",{onSubmit:W($),className:"space-y-4",children:[i.jsx(we,{label:"Full Name",id:"name",error:G.name?.message,registration:U("name"),className:w!=="green"?"bg-gray-50 border-gray-200 text-gray-900":"",labelClassName:w!=="green"?"text-gray-700":""}),i.jsx(we,{label:"Email Address",id:"email",type:"email",error:G.email?.message,registration:U("email"),readOnly:!0,className:w!=="green"?"!bg-gray-100/50 text-gray-500 border-gray-200":"!bg-gray-700/50",labelClassName:w!=="green"?"text-gray-700":""}),i.jsx(we,{label:"Phone Number",id:"phone",type:"tel",error:G.phone?.message,registration:U("phone"),className:w!=="green"?"bg-gray-50 border-gray-200 text-gray-900":"",labelClassName:w!=="green"?"text-gray-700":""}),i.jsx("div",{className:"flex justify-end pt-2",children:i.jsx(ne,{type:"submit",isLoading:j,disabled:!Z,children:"Save Changes"})})]})]}),i.jsxs("section",{className:"hidden md:block",children:[i.jsx("h3",{className:`fo-section-title mb-4 ${w!=="green"?"text-gray-900":""}`,children:"Appearance"}),i.jsxs("div",{className:`p-4 rounded-lg border space-y-4 ${w!=="green"?"bg-gray-50 border-gray-200":"bg-[#041b0f] md:bg-[#243524] border-[#374151]"}`,children:[i.jsx(Dn,{id:"theme-automatic-mobile",label:"Automatic",description:"Switch themes based on screen size.",checked:y,onChange:ce=>_(ce.target.checked)}),i.jsx(Dn,{id:"theme-dark-mode-mobile",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ce=>x(ce.target.checked?"dark":"light"),disabled:y})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:`fo-section-title mb-4 ${w!=="green"?"text-gray-900 border-gray-200":""}`,children:"Work Hours Tracking"}),i.jsxs("div",{className:`fo-attendance-card space-y-4 ${w==="blue"?"!bg-blue-500 !text-white border-0 shadow-lg":w!=="green"?"bg-gray-50 border border-gray-200":""}`,children:[i.jsxs("div",{className:"flex justify-around",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:`fo-attendance-time ${w==="blue"?"!text-white":w!=="green"?"text-gray-500":""}`,children:"Last Check In"}),i.jsx("p",{className:`fo-attendance-time ${w==="blue"?"!text-white":w!=="green"?"text-gray-900":""}`,children:i.jsx("strong",{children:H(o)})})]}),i.jsxs("div",{className:"text-center",children:[i.jsx("p",{className:`fo-attendance-time ${w==="blue"?"!text-white":w!=="green"?"text-gray-500":""}`,children:"Last Check Out"}),i.jsx("p",{className:`fo-attendance-time ${w==="blue"?"!text-white":w!=="green"?"text-gray-900":""}`,children:i.jsx("strong",{children:H(l)})})]})]}),r?i.jsx("div",{className:"flex items-center justify-center text-muted h-[56px]",children:i.jsx(_t,{className:"h-6 w-6 animate-spin"})}):i.jsxs("div",{className:"flex gap-3",children:[i.jsxs(ne,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:t||K,children:[i.jsx(Dx,{className:"mr-3 h-6 w-6"})," Check In"]}),i.jsxs(ne,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-4 text-lg font-bold shadow-lg transition-all rounded-2xl",disabled:!t||K,children:[i.jsx(_o,{className:"mr-3 h-6 w-6"})," Check Out"]})]})]})]}),i.jsxs("section",{children:[i.jsx("h3",{className:`fo-section-title mb-4 ${w!=="green"?"text-gray-900 border-gray-200":""}`,children:"Account Actions"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(ne,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:`w-full justify-center !py-3 ${w!=="green"?"bg-gray-100 hover:bg-gray-200 text-gray-800":""}`,title:"View your leave history and balances",children:[i.jsx(MS,{className:"mr-2 h-5 w-5"})," Leave Tracker"]}),i.jsxs(ne,{onClick:re,variant:"danger",className:"w-full justify-center !py-3",children:[i.jsx(_o,{className:"mr-2 h-5 w-5"})," Log Out"]})]})]})]})]}):i.jsxs("div",{className:"w-full space-y-8",children:[M&&i.jsx(pt,{message:M.message,type:M.type,onDismiss:()=>D(null)}),i.jsxs("div",{className:"relative overflow-hidden md:bg-white md:p-6 md:rounded-2xl md:shadow-lg flex flex-col md:flex-row items-center gap-6 border border-gray-100",children:[i.jsx("div",{className:"absolute top-0 left-0 w-full h-32 border-b-4 shadow-lg",style:{backgroundColor:w!=="green"?"#1a3a6e":"#006b3f",borderColor:w!=="green"?"#0f264a":"#005632"}}),i.jsx("div",{className:"relative z-10",children:i.jsx($S,{file:ie,onFileChange:me})}),i.jsxs("div",{className:"text-center md:text-left relative z-10 flex-1 mt-16 md:mt-0",children:[i.jsx("h2",{className:"text-2xl md:text-3xl font-bold text-primary-text tracking-tight",children:n.name}),i.jsx("div",{className:"flex items-center justify-center md:justify-start gap-2 mt-1.5",children:i.jsx("span",{className:"px-2.5 py-0.5 rounded-full bg-emerald-100 text-emerald-800 border border-emerald-200 text-xs md:text-sm font-medium",children:se(n.role)})}),i.jsx("p",{className:"text-gray-500 mt-1.5 font-medium text-sm md:text-base",children:n.email})]})]}),i.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[i.jsxs("div",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-blue-50 rounded-lg",children:i.jsx(Pl,{className:"h-5 w-5 text-blue-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Profile Details"})]}),i.jsxs("form",{onSubmit:W($),className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[i.jsx(we,{label:"Full Name",id:"name",error:G.name?.message,registration:U("name"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx(we,{label:"Phone Number",id:"phone",type:"tel",error:G.phone?.message,registration:U("phone"),className:"bg-gray-50 border-gray-200 focus:bg-white transition-colors"}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{label:"Email Address",id:"email",type:"email",error:G.email?.message,registration:U("email"),readOnly:!0,className:"bg-gray-100/50 text-gray-500 cursor-not-allowed border-gray-200"})})]}),i.jsx("div",{className:"flex justify-end pt-3 border-t border-gray-100",children:i.jsx(ne,{type:"submit",isLoading:j,disabled:!Z,className:"px-6",children:"Save Changes"})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-purple-50 rounded-lg",children:i.jsx(t3,{className:"h-5 w-5 text-purple-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Work Hours Tracking"})]}),i.jsxs("div",{className:"space-y-5",children:[i.jsxs("div",{className:"grid grid-cols-2 gap-5",children:[i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check In"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-emerald-600",children:H(o)})]}),i.jsxs("div",{className:"text-center bg-gradient-to-br from-gray-50 to-gray-100 p-4 rounded-xl border border-gray-200",children:[i.jsx("p",{className:"text-xs md:text-sm font-medium text-gray-500 mb-1",children:"Last Check Out"}),i.jsx("p",{className:"text-2xl md:text-3xl font-bold text-rose-600",children:H(l)})]})]}),r?i.jsx("div",{className:"flex items-center justify-center h-[56px] bg-gray-50 rounded-xl",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-gray-400"})}):i.jsxs("div",{className:"flex gap-4",children:[i.jsxs(ne,{onClick:()=>h("/attendance/check-in"),variant:"primary",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-emerald-100 hover:shadow-emerald-200 transition-all",disabled:t||K,children:[i.jsx(Dx,{className:"mr-2 h-5 w-5"})," Check In"]}),i.jsxs(ne,{onClick:()=>h("/attendance/check-out"),variant:"danger",className:"flex-1 !py-3 text-base md:text-lg shadow-lg shadow-red-100 hover:shadow-red-200 transition-all",disabled:!t||K,children:[i.jsx(_o,{className:"mr-2 h-5 w-5"})," Check Out"]})]})]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Appearance"}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Dn,{id:"theme-automatic-desktop",label:"Automatic",description:"Switch themes based on screen size.",checked:y,onChange:ce=>_(ce.target.checked)})}),i.jsx("div",{className:"p-4 rounded-xl bg-gray-50 border border-gray-100",children:i.jsx(Dn,{id:"theme-dark-mode-desktop",label:"Dark Mode",description:"Manually enable or disable dark mode.",checked:p==="dark",onChange:ce=>x(ce.target.checked?"dark":"light"),disabled:y})})]})]}),i.jsxs("div",{className:"md:bg-white md:p-6 md:rounded-2xl md:shadow-lg border border-gray-100",children:[i.jsx("h3",{className:"text-lg font-bold mb-4 text-gray-900",children:"Account Actions"}),i.jsxs("div",{className:"space-y-3",children:[i.jsxs(ne,{onClick:()=>h("/leaves/dashboard"),variant:"secondary",className:"w-full justify-center py-3 bg-gray-50 hover:bg-gray-100 border-gray-200",title:"View your leave history and balances",children:[i.jsx(MS,{className:"mr-2 h-4 w-4"})," Leave Tracker"]}),i.jsxs(ne,{onClick:re,variant:"danger",className:"w-full justify-center py-3",isLoading:j,children:[i.jsx(_o,{className:"mr-2 h-4 w-4"})," Log Out"]})]})]})]})]})]})};function qm(n){return n+.5|0}const Rc=(n,e,t)=>Math.max(Math.min(n,t),e);function Yh(n){return Rc(qm(n*2.55),0,255)}function Bc(n){return Rc(qm(n*255),0,255)}function vl(n){return Rc(qm(n/2.55)/100,0,1)}function vR(n){return Rc(qm(n*100),0,100)}const Wi={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},HS=[..."0123456789ABCDEF"],Pse=n=>HS[n&15],Mse=n=>HS[(n&240)>>4]+HS[n&15],qg=n=>(n&240)>>4===(n&15),Ese=n=>qg(n.r)&&qg(n.g)&&qg(n.b)&&qg(n.a);function Dse(n){var e=n.length,t;return n[0]==="#"&&(e===4||e===5?t={r:255&Wi[n[1]]*17,g:255&Wi[n[2]]*17,b:255&Wi[n[3]]*17,a:e===5?Wi[n[4]]*17:255}:(e===7||e===9)&&(t={r:Wi[n[1]]<<4|Wi[n[2]],g:Wi[n[3]]<<4|Wi[n[4]],b:Wi[n[5]]<<4|Wi[n[6]],a:e===9?Wi[n[7]]<<4|Wi[n[8]]:255})),t}const Ose=(n,e)=>n<255?e(n):"";function Ise(n){var e=Ese(n)?Pse:Mse;return n?"#"+e(n.r)+e(n.g)+e(n.b)+Ose(n.a,e):void 0}const Ase=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function i6(n,e,t){const r=e*Math.min(t,1-t),s=(a,o=(a+n/30)%12)=>t-r*Math.max(Math.min(o-3,9-o,1),-1);return[s(0),s(8),s(4)]}function Rse(n,e,t){const r=(s,a=(s+n/60)%6)=>t-t*e*Math.max(Math.min(a,4-a,1),0);return[r(5),r(3),r(1)]}function Lse(n,e,t){const r=i6(n,1,.5);let s;for(e+t>1&&(s=1/(e+t),e*=s,t*=s),s=0;s<3;s++)r[s]*=1-e-t,r[s]+=e;return r}function Fse(n,e,t,r,s){return n===s?(e-t)/r+(e<t?6:0):e===s?(t-n)/r+2:(n-e)/r+4}function lC(n){const t=n.r/255,r=n.g/255,s=n.b/255,a=Math.max(t,r,s),o=Math.min(t,r,s),l=(a+o)/2;let c,d,h;return a!==o&&(h=a-o,d=l>.5?h/(2-a-o):h/(a+o),c=Fse(t,r,s,h,a),c=c*60+.5),[c|0,d||0,l]}function cC(n,e,t,r){return(Array.isArray(e)?n(e[0],e[1],e[2]):n(e,t,r)).map(Bc)}function dC(n,e,t){return cC(i6,n,e,t)}function qse(n,e,t){return cC(Lse,n,e,t)}function zse(n,e,t){return cC(Rse,n,e,t)}function a6(n){return(n%360+360)%360}function Use(n){const e=Ase.exec(n);let t=255,r;if(!e)return;e[5]!==r&&(t=e[6]?Yh(+e[5]):Bc(+e[5]));const s=a6(+e[2]),a=+e[3]/100,o=+e[4]/100;return e[1]==="hwb"?r=qse(s,a,o):e[1]==="hsv"?r=zse(s,a,o):r=dC(s,a,o),{r:r[0],g:r[1],b:r[2],a:t}}function Bse(n,e){var t=lC(n);t[0]=a6(t[0]+e),t=dC(t),n.r=t[0],n.g=t[1],n.b=t[2]}function Vse(n){if(!n)return;const e=lC(n),t=e[0],r=vR(e[1]),s=vR(e[2]);return n.a<255?`hsla(${t}, ${r}%, ${s}%, ${vl(n.a)})`:`hsl(${t}, ${r}%, ${s}%)`}const bR={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},wR={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function Wse(){const n={},e=Object.keys(wR),t=Object.keys(bR);let r,s,a,o,l;for(r=0;r<e.length;r++){for(o=l=e[r],s=0;s<t.length;s++)a=t[s],l=l.replace(a,bR[a]);a=parseInt(wR[o],16),n[l]=[a>>16&255,a>>8&255,a&255]}return n}let zg;function $se(n){zg||(zg=Wse(),zg.transparent=[0,0,0,0]);const e=zg[n.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const Hse=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function Yse(n){const e=Hse.exec(n);let t=255,r,s,a;if(e){if(e[7]!==r){const o=+e[7];t=e[8]?Yh(o):Rc(o*255,0,255)}return r=+e[1],s=+e[3],a=+e[5],r=255&(e[2]?Yh(r):Rc(r,0,255)),s=255&(e[4]?Yh(s):Rc(s,0,255)),a=255&(e[6]?Yh(a):Rc(a,0,255)),{r,g:s,b:a,a:t}}}function Gse(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${vl(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}const NN=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,nf=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function Zse(n,e,t){const r=nf(vl(n.r)),s=nf(vl(n.g)),a=nf(vl(n.b));return{r:Bc(NN(r+t*(nf(vl(e.r))-r))),g:Bc(NN(s+t*(nf(vl(e.g))-s))),b:Bc(NN(a+t*(nf(vl(e.b))-a))),a:n.a+t*(e.a-n.a)}}function Ug(n,e,t){if(n){let r=lC(n);r[e]=Math.max(0,Math.min(r[e]+r[e]*t,e===0?360:1)),r=dC(r),n.r=r[0],n.g=r[1],n.b=r[2]}}function o6(n,e){return n&&Object.assign(e||{},n)}function _R(n){var e={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(e={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(e.a=Bc(n[3]))):(e=o6(n,{r:0,g:0,b:0,a:1}),e.a=Bc(e.a)),e}function Kse(n){return n.charAt(0)==="r"?Yse(n):Use(n)}class jm{constructor(e){if(e instanceof jm)return e;const t=typeof e;let r;t==="object"?r=_R(e):t==="string"&&(r=Dse(e)||$se(e)||Kse(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=o6(this._rgb);return e&&(e.a=vl(e.a)),e}set rgb(e){this._rgb=_R(e)}rgbString(){return this._valid?Gse(this._rgb):void 0}hexString(){return this._valid?Ise(this._rgb):void 0}hslString(){return this._valid?Vse(this._rgb):void 0}mix(e,t){if(e){const r=this.rgb,s=e.rgb;let a;const o=t===a?.5:t,l=2*o-1,c=r.a-s.a,d=((l*c===-1?l:(l+c)/(1+l*c))+1)/2;a=1-d,r.r=255&d*r.r+a*s.r+.5,r.g=255&d*r.g+a*s.g+.5,r.b=255&d*r.b+a*s.b+.5,r.a=o*r.a+(1-o)*s.a,this.rgb=r}return this}interpolate(e,t){return e&&(this._rgb=Zse(this._rgb,e._rgb,t)),this}clone(){return new jm(this.rgb)}alpha(e){return this._rgb.a=Bc(e),this}clearer(e){const t=this._rgb;return t.a*=1-e,this}greyscale(){const e=this._rgb,t=qm(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=t,this}opaquer(e){const t=this._rgb;return t.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return Ug(this._rgb,2,e),this}darken(e){return Ug(this._rgb,2,-e),this}saturate(e){return Ug(this._rgb,1,e),this}desaturate(e){return Ug(this._rgb,1,-e),this}rotate(e){return Bse(this._rgb,e),this}}function hl(){}const Jse=(()=>{let n=0;return()=>n++})();function vn(n){return n==null}function Tr(n){if(Array.isArray&&Array.isArray(n))return!0;const e=Object.prototype.toString.call(n);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function nn(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function fs(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function mo(n,e){return fs(n)?n:e}function Yt(n,e){return typeof n>"u"?e:n}const Qse=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/e,l6=(n,e)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*e:+n;function Bn(n,e,t){if(n&&typeof n.call=="function")return n.apply(t,e)}function jn(n,e,t,r){let s,a,o;if(Tr(n))for(a=n.length,s=0;s<a;s++)e.call(t,n[s],s);else if(nn(n))for(o=Object.keys(n),a=o.length,s=0;s<a;s++)e.call(t,n[o[s]],o[s])}function zx(n,e){let t,r,s,a;if(!n||!e||n.length!==e.length)return!1;for(t=0,r=n.length;t<r;++t)if(s=n[t],a=e[t],s.datasetIndex!==a.datasetIndex||s.index!==a.index)return!1;return!0}function Ux(n){if(Tr(n))return n.map(Ux);if(nn(n)){const e=Object.create(null),t=Object.keys(n),r=t.length;let s=0;for(;s<r;++s)e[t[s]]=Ux(n[t[s]]);return e}return n}function c6(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function Xse(n,e,t,r){if(!c6(n))return;const s=e[n],a=t[n];nn(s)&&nn(a)?Nm(s,a,r):e[n]=Ux(a)}function Nm(n,e,t){const r=Tr(e)?e:[e],s=r.length;if(!nn(n))return n;t=t||{};const a=t.merger||Xse;let o;for(let l=0;l<s;++l){if(o=r[l],!nn(o))continue;const c=Object.keys(o);for(let d=0,h=c.length;d<h;++d)a(c[d],n,o,t)}return n}function nm(n,e){return Nm(n,e,{merger:eie})}function eie(n,e,t){if(!c6(n))return;const r=e[n],s=t[n];nn(r)&&nn(s)?nm(r,s):Object.prototype.hasOwnProperty.call(e,n)||(e[n]=Ux(s))}const jR={"":n=>n,x:n=>n.x,y:n=>n.y};function tie(n){const e=n.split("."),t=[];let r="";for(const s of e)r+=s,r.endsWith("\\")?r=r.slice(0,-1)+".":(t.push(r),r="");return t}function nie(n){const e=tie(n);return t=>{for(const r of e){if(r==="")break;t=t&&t[r]}return t}}function yu(n,e){return(jR[e]||(jR[e]=nie(e)))(n)}function uC(n){return n.charAt(0).toUpperCase()+n.slice(1)}const Sm=n=>typeof n<"u",Gc=n=>typeof n=="function",NR=(n,e)=>{if(n.size!==e.size)return!1;for(const t of n)if(!e.has(t))return!1;return!0};function rie(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}const On=Math.PI,er=2*On,sie=er+On,Bx=Number.POSITIVE_INFINITY,iie=On/180,kr=On/2,Zd=On/4,SR=On*2/3,d6=Math.log10,So=Math.sign;function rm(n,e,t){return Math.abs(n-e)<t}function CR(n){const e=Math.round(n);n=rm(n,e,n/1e3)?e:n;const t=Math.pow(10,Math.floor(d6(n))),r=n/t;return(r<=1?1:r<=2?2:r<=5?5:10)*t}function aie(n){const e=[],t=Math.sqrt(n);let r;for(r=1;r<t;r++)n%r===0&&(e.push(r),e.push(n/r));return t===(t|0)&&e.push(t),e.sort((s,a)=>s-a).pop(),e}function oie(n){return typeof n=="symbol"||typeof n=="object"&&n!==null&&!(Symbol.toPrimitive in n||"toString"in n||"valueOf"in n)}function Cm(n){return!oie(n)&&!isNaN(parseFloat(n))&&isFinite(n)}function lie(n,e){const t=Math.round(n);return t-e<=n&&t+e>=n}function cie(n,e,t){let r,s,a;for(r=0,s=n.length;r<s;r++)a=n[r][t],isNaN(a)||(e.min=Math.min(e.min,a),e.max=Math.max(e.max,a))}function wl(n){return n*(On/180)}function die(n){return n*(180/On)}function TR(n){if(!fs(n))return;let e=1,t=0;for(;Math.round(n*e)/e!==n;)e*=10,t++;return t}function u6(n,e){const t=e.x-n.x,r=e.y-n.y,s=Math.sqrt(t*t+r*r);let a=Math.atan2(r,t);return a<-.5*On&&(a+=er),{angle:a,distance:s}}function YS(n,e){return Math.sqrt(Math.pow(e.x-n.x,2)+Math.pow(e.y-n.y,2))}function uie(n,e){return(n-e+sie)%er-On}function hi(n){return(n%er+er)%er}function Tm(n,e,t,r){const s=hi(n),a=hi(e),o=hi(t),l=hi(a-s),c=hi(o-s),d=hi(s-a),h=hi(s-o);return s===a||s===o||r&&a===o||l>c&&d<h}function ds(n,e,t){return Math.max(e,Math.min(t,n))}function fie(n){return ds(n,-32768,32767)}function _l(n,e,t,r=1e-6){return n>=Math.min(e,t)-r&&n<=Math.max(e,t)+r}function fC(n,e,t){t=t||(o=>n[o]<e);let r=n.length-1,s=0,a;for(;r-s>1;)a=s+r>>1,t(a)?s=a:r=a;return{lo:s,hi:r}}const lu=(n,e,t,r)=>fC(n,t,r?s=>{const a=n[s][e];return a<t||a===t&&n[s+1][e]===t}:s=>n[s][e]<t),hie=(n,e,t)=>fC(n,t,r=>n[r][e]>=t);function mie(n,e,t){let r=0,s=n.length;for(;r<s&&n[r]<e;)r++;for(;s>r&&n[s-1]>t;)s--;return r>0||s<n.length?n.slice(r,s):n}const f6=["push","pop","shift","splice","unshift"];function pie(n,e){if(n._chartjs){n._chartjs.listeners.push(e);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),f6.forEach(t=>{const r="_onData"+uC(t),s=n[t];Object.defineProperty(n,t,{configurable:!0,enumerable:!1,value(...a){const o=s.apply(this,a);return n._chartjs.listeners.forEach(l=>{typeof l[r]=="function"&&l[r](...a)}),o}})})}function kR(n,e){const t=n._chartjs;if(!t)return;const r=t.listeners,s=r.indexOf(e);s!==-1&&r.splice(s,1),!(r.length>0)&&(f6.forEach(a=>{delete n[a]}),delete n._chartjs)}function h6(n){const e=new Set(n);return e.size===n.length?n:Array.from(e)}const m6=(function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame})();function p6(n,e){let t=[],r=!1;return function(...s){t=s,r||(r=!0,m6.call(window,()=>{r=!1,n.apply(e,t)}))}}function gie(n,e){let t;return function(...r){return e?(clearTimeout(t),t=setTimeout(n,e,r)):n.apply(this,r),e}}const g6=n=>n==="start"?"left":n==="end"?"right":"center",ui=(n,e,t)=>n==="start"?e:n==="end"?t:(e+t)/2,xie=(n,e,t,r)=>n===(r?"left":"right")?t:n==="center"?(e+t)/2:e;function yie(n,e,t){const r=e.length;let s=0,a=r;if(n._sorted){const{iScale:o,vScale:l,_parsed:c}=n,d=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null,h=o.axis,{min:p,max:x,minDefined:y,maxDefined:_}=o.getUserBounds();if(y){if(s=Math.min(lu(c,h,p).lo,t?r:lu(e,h,o.getPixelForValue(p)).lo),d){const w=c.slice(0,s+1).reverse().findIndex(j=>!vn(j[l.axis]));s-=Math.max(0,w)}s=ds(s,0,r-1)}if(_){let w=Math.max(lu(c,o.axis,x,!0).hi+1,t?0:lu(e,h,o.getPixelForValue(x),!0).hi+1);if(d){const j=c.slice(w-1).findIndex(C=>!vn(C[l.axis]));w+=Math.max(0,j)}a=ds(w,s,r)-s}else a=r-s}return{start:s,count:a}}function vie(n){const{xScale:e,yScale:t,_scaleRanges:r}=n,s={xmin:e.min,xmax:e.max,ymin:t.min,ymax:t.max};if(!r)return n._scaleRanges=s,!0;const a=r.xmin!==e.min||r.xmax!==e.max||r.ymin!==t.min||r.ymax!==t.max;return Object.assign(r,s),a}const Bg=n=>n===0||n===1,PR=(n,e,t)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-e)*er/t)),MR=(n,e,t)=>Math.pow(2,-10*n)*Math.sin((n-e)*er/t)+1,sm={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*kr)+1,easeOutSine:n=>Math.sin(n*kr),easeInOutSine:n=>-.5*(Math.cos(On*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>Bg(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>Bg(n)?n:PR(n,.075,.3),easeOutElastic:n=>Bg(n)?n:MR(n,.075,.3),easeInOutElastic(n){return Bg(n)?n:n<.5?.5*PR(n*2,.1125,.45):.5+.5*MR(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let e=1.70158;return(n/=.5)<1?.5*(n*n*(((e*=1.525)+1)*n-e)):.5*((n-=2)*n*(((e*=1.525)+1)*n+e)+2)},easeInBounce:n=>1-sm.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?sm.easeInBounce(n*2)*.5:sm.easeOutBounce(n*2-1)*.5+.5};function hC(n){if(n&&typeof n=="object"){const e=n.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function ER(n){return hC(n)?n:new jm(n)}function SN(n){return hC(n)?n:new jm(n).saturate(.5).darken(.1).hexString()}const bie=["x","y","borderWidth","radius","tension"],wie=["color","borderColor","backgroundColor"];function _ie(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),n.set("animations",{colors:{type:"color",properties:wie},numbers:{type:"number",properties:bie}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function jie(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const DR=new Map;function Nie(n,e){e=e||{};const t=n+JSON.stringify(e);let r=DR.get(t);return r||(r=new Intl.NumberFormat(n,e),DR.set(t,r)),r}function mC(n,e,t){return Nie(e,t).format(n)}const Sie={values(n){return Tr(n)?n:""+n},numeric(n,e,t){if(n===0)return"0";const r=this.chart.options.locale;let s,a=n;if(t.length>1){const d=Math.max(Math.abs(t[0].value),Math.abs(t[t.length-1].value));(d<1e-4||d>1e15)&&(s="scientific"),a=Cie(n,t)}const o=d6(Math.abs(a)),l=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:s,minimumFractionDigits:l,maximumFractionDigits:l};return Object.assign(c,this.options.ticks.format),mC(n,r,c)}};function Cie(n,e){let t=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(t)>=1&&n!==Math.floor(n)&&(t=n-Math.floor(n)),t}var x6={formatters:Sie};function Tie(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,t)=>t.lineWidth,tickColor:(e,t)=>t.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:x6.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const vu=Object.create(null),GS=Object.create(null);function im(n,e){if(!e)return n;const t=e.split(".");for(let r=0,s=t.length;r<s;++r){const a=t[r];n=n[a]||(n[a]=Object.create(null))}return n}function CN(n,e,t){return typeof e=="string"?Nm(im(n,e),t):Nm(im(n,""),e)}class kie{constructor(e,t){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,s)=>SN(s.backgroundColor),this.hoverBorderColor=(r,s)=>SN(s.borderColor),this.hoverColor=(r,s)=>SN(s.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(t)}set(e,t){return CN(this,e,t)}get(e){return im(this,e)}describe(e,t){return CN(GS,e,t)}override(e,t){return CN(vu,e,t)}route(e,t,r,s){const a=im(this,e),o=im(this,r),l="_"+t;Object.defineProperties(a,{[l]:{value:a[t],writable:!0},[t]:{enumerable:!0,get(){const c=this[l],d=o[s];return nn(c)?Object.assign({},d,c):Yt(c,d)},set(c){this[l]=c}}})}apply(e){e.forEach(t=>t(this))}}var cr=new kie({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[_ie,jie,Tie]);function Pie(n){return!n||vn(n.size)||vn(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function OR(n,e,t,r,s){let a=e[s];return a||(a=e[s]=n.measureText(s).width,t.push(s)),a>r&&(r=a),r}function Kd(n,e,t){const r=n.currentDevicePixelRatio,s=t!==0?Math.max(t/2,.5):0;return Math.round((e-s)*r)/r+s}function IR(n,e){!e&&!n||(e=e||n.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,n.width,n.height),e.restore())}function ZS(n,e,t,r){y6(n,e,t,r,null)}function y6(n,e,t,r,s){let a,o,l,c,d,h,p,x;const y=e.pointStyle,_=e.rotation,w=e.radius;let j=(_||0)*iie;if(y&&typeof y=="object"&&(a=y.toString(),a==="[object HTMLImageElement]"||a==="[object HTMLCanvasElement]")){n.save(),n.translate(t,r),n.rotate(j),n.drawImage(y,-y.width/2,-y.height/2,y.width,y.height),n.restore();return}if(!(isNaN(w)||w<=0)){switch(n.beginPath(),y){default:s?n.ellipse(t,r,s/2,w,0,0,er):n.arc(t,r,w,0,er),n.closePath();break;case"triangle":h=s?s/2:w,n.moveTo(t+Math.sin(j)*h,r-Math.cos(j)*w),j+=SR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*w),j+=SR,n.lineTo(t+Math.sin(j)*h,r-Math.cos(j)*w),n.closePath();break;case"rectRounded":d=w*.516,c=w-d,o=Math.cos(j+Zd)*c,p=Math.cos(j+Zd)*(s?s/2-d:c),l=Math.sin(j+Zd)*c,x=Math.sin(j+Zd)*(s?s/2-d:c),n.arc(t-p,r-l,d,j-On,j-kr),n.arc(t+x,r-o,d,j-kr,j),n.arc(t+p,r+l,d,j,j+kr),n.arc(t-x,r+o,d,j+kr,j+On),n.closePath();break;case"rect":if(!_){c=Math.SQRT1_2*w,h=s?s/2:c,n.rect(t-h,r-c,2*h,2*c);break}j+=Zd;case"rectRot":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+x,r-o),n.lineTo(t+p,r+l),n.lineTo(t-x,r+o),n.closePath();break;case"crossRot":j+=Zd;case"cross":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"star":p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o),j+=Zd,p=Math.cos(j)*(s?s/2:w),o=Math.cos(j)*w,l=Math.sin(j)*w,x=Math.sin(j)*(s?s/2:w),n.moveTo(t-p,r-l),n.lineTo(t+p,r+l),n.moveTo(t+x,r-o),n.lineTo(t-x,r+o);break;case"line":o=s?s/2:Math.cos(j)*w,l=Math.sin(j)*w,n.moveTo(t-o,r-l),n.lineTo(t+o,r+l);break;case"dash":n.moveTo(t,r),n.lineTo(t+Math.cos(j)*(s?s/2:w),r+Math.sin(j)*w);break;case!1:n.closePath();break}n.fill(),e.borderWidth>0&&n.stroke()}}function km(n,e,t){return t=t||.5,!e||n&&n.x>e.left-t&&n.x<e.right+t&&n.y>e.top-t&&n.y<e.bottom+t}function My(n,e){n.save(),n.beginPath(),n.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),n.clip()}function Ey(n){n.restore()}function Mie(n,e,t,r,s){if(!e)return n.lineTo(t.x,t.y);if(s==="middle"){const a=(e.x+t.x)/2;n.lineTo(a,e.y),n.lineTo(a,t.y)}else s==="after"!=!!r?n.lineTo(e.x,t.y):n.lineTo(t.x,e.y);n.lineTo(t.x,t.y)}function Eie(n,e,t,r){if(!e)return n.lineTo(t.x,t.y);n.bezierCurveTo(r?e.cp1x:e.cp2x,r?e.cp1y:e.cp2y,r?t.cp2x:t.cp1x,r?t.cp2y:t.cp1y,t.x,t.y)}function Die(n,e){e.translation&&n.translate(e.translation[0],e.translation[1]),vn(e.rotation)||n.rotate(e.rotation),e.color&&(n.fillStyle=e.color),e.textAlign&&(n.textAlign=e.textAlign),e.textBaseline&&(n.textBaseline=e.textBaseline)}function Oie(n,e,t,r,s){if(s.strikethrough||s.underline){const a=n.measureText(r),o=e-a.actualBoundingBoxLeft,l=e+a.actualBoundingBoxRight,c=t-a.actualBoundingBoxAscent,d=t+a.actualBoundingBoxDescent,h=s.strikethrough?(c+d)/2:d;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=s.decorationWidth||2,n.moveTo(o,h),n.lineTo(l,h),n.stroke()}}function Iie(n,e){const t=n.fillStyle;n.fillStyle=e.color,n.fillRect(e.left,e.top,e.width,e.height),n.fillStyle=t}function Vx(n,e,t,r,s,a={}){const o=Tr(e)?e:[e],l=a.strokeWidth>0&&a.strokeColor!=="";let c,d;for(n.save(),n.font=s.string,Die(n,a),c=0;c<o.length;++c)d=o[c],a.backdrop&&Iie(n,a.backdrop),l&&(a.strokeColor&&(n.strokeStyle=a.strokeColor),vn(a.strokeWidth)||(n.lineWidth=a.strokeWidth),n.strokeText(d,t,r,a.maxWidth)),n.fillText(d,t,r,a.maxWidth),Oie(n,t,r,d,a),r+=Number(s.lineHeight);n.restore()}function Wx(n,e){const{x:t,y:r,w:s,h:a,radius:o}=e;n.arc(t+o.topLeft,r+o.topLeft,o.topLeft,1.5*On,On,!0),n.lineTo(t,r+a-o.bottomLeft),n.arc(t+o.bottomLeft,r+a-o.bottomLeft,o.bottomLeft,On,kr,!0),n.lineTo(t+s-o.bottomRight,r+a),n.arc(t+s-o.bottomRight,r+a-o.bottomRight,o.bottomRight,kr,0,!0),n.lineTo(t+s,r+o.topRight),n.arc(t+s-o.topRight,r+o.topRight,o.topRight,0,-kr,!0),n.lineTo(t+o.topLeft,r)}const Aie=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Rie=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function Lie(n,e){const t=(""+n).match(Aie);if(!t||t[1]==="normal")return e*1.2;switch(n=+t[2],t[3]){case"px":return n;case"%":n/=100;break}return e*n}const Fie=n=>+n||0;function pC(n,e){const t={},r=nn(e),s=r?Object.keys(e):e,a=nn(n)?r?o=>Yt(n[o],n[e[o]]):o=>n[o]:()=>n;for(const o of s)t[o]=Fie(a(o));return t}function v6(n){return pC(n,{top:"y",right:"x",bottom:"y",left:"x"})}function vf(n){return pC(n,["topLeft","topRight","bottomLeft","bottomRight"])}function La(n){const e=v6(n);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Gs(n,e){n=n||{},e=e||cr.font;let t=Yt(n.size,e.size);typeof t=="string"&&(t=parseInt(t,10));let r=Yt(n.style,e.style);r&&!(""+r).match(Rie)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const s={family:Yt(n.family,e.family),lineHeight:Lie(Yt(n.lineHeight,e.lineHeight),t),size:t,style:r,weight:Yt(n.weight,e.weight),string:""};return s.string=Pie(s),s}function Vg(n,e,t,r){let s,a,o;for(s=0,a=n.length;s<a;++s)if(o=n[s],o!==void 0&&o!==void 0)return o}function qie(n,e,t){const{min:r,max:s}=n,a=l6(e,(s-r)/2),o=(l,c)=>t&&l===0?0:l+c;return{min:o(r,-Math.abs(a)),max:o(s,a)}}function Tu(n,e){return Object.assign(Object.create(n),e)}function gC(n,e=[""],t,r,s=()=>n[0]){const a=t||n;typeof r>"u"&&(r=j6("_fallback",n));const o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:a,_fallback:r,_getTarget:s,override:l=>gC([l,...n],e,a,r)};return new Proxy(o,{deleteProperty(l,c){return delete l[c],delete l._keys,delete n[0][c],!0},get(l,c){return w6(l,c,()=>Yie(c,e,n,l))},getOwnPropertyDescriptor(l,c){return Reflect.getOwnPropertyDescriptor(l._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(l,c){return RR(l).includes(c)},ownKeys(l){return RR(l)},set(l,c,d){const h=l._storage||(l._storage=s());return l[c]=h[c]=d,delete l._keys,!0}})}function qf(n,e,t,r){const s={_cacheable:!1,_proxy:n,_context:e,_subProxy:t,_stack:new Set,_descriptors:b6(n,r),setContext:a=>qf(n,a,t,r),override:a=>qf(n.override(a),e,t,r)};return new Proxy(s,{deleteProperty(a,o){return delete a[o],delete n[o],!0},get(a,o,l){return w6(a,o,()=>Uie(a,o,l))},getOwnPropertyDescriptor(a,o){return a._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(a,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(a,o,l){return n[o]=l,delete a[o],!0}})}function b6(n,e={scriptable:!0,indexable:!0}){const{_scriptable:t=e.scriptable,_indexable:r=e.indexable,_allKeys:s=e.allKeys}=n;return{allKeys:s,scriptable:t,indexable:r,isScriptable:Gc(t)?t:()=>t,isIndexable:Gc(r)?r:()=>r}}const zie=(n,e)=>n?n+uC(e):e,xC=(n,e)=>nn(e)&&n!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function w6(n,e,t){if(Object.prototype.hasOwnProperty.call(n,e)||e==="constructor")return n[e];const r=t();return n[e]=r,r}function Uie(n,e,t){const{_proxy:r,_context:s,_subProxy:a,_descriptors:o}=n;let l=r[e];return Gc(l)&&o.isScriptable(e)&&(l=Bie(e,l,n,t)),Tr(l)&&l.length&&(l=Vie(e,l,n,o.isIndexable)),xC(e,l)&&(l=qf(l,s,a&&a[e],o)),l}function Bie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_stack:l}=t;if(l.has(n))throw new Error("Recursion detected: "+Array.from(l).join("->")+"->"+n);l.add(n);let c=e(a,o||r);return l.delete(n),xC(n,c)&&(c=yC(s._scopes,s,n,c)),c}function Vie(n,e,t,r){const{_proxy:s,_context:a,_subProxy:o,_descriptors:l}=t;if(typeof a.index<"u"&&r(n))return e[a.index%e.length];if(nn(e[0])){const c=e,d=s._scopes.filter(h=>h!==c);e=[];for(const h of c){const p=yC(d,s,n,h);e.push(qf(p,a,o&&o[n],l))}}return e}function _6(n,e,t){return Gc(n)?n(e,t):n}const Wie=(n,e)=>n===!0?e:typeof n=="string"?yu(e,n):void 0;function $ie(n,e,t,r,s){for(const a of e){const o=Wie(t,a);if(o){n.add(o);const l=_6(o._fallback,t,s);if(typeof l<"u"&&l!==t&&l!==r)return l}else if(o===!1&&typeof r<"u"&&t!==r)return null}return!1}function yC(n,e,t,r){const s=e._rootScopes,a=_6(e._fallback,t,r),o=[...n,...s],l=new Set;l.add(r);let c=AR(l,o,t,a||t,r);return c===null||typeof a<"u"&&a!==t&&(c=AR(l,o,a,c,r),c===null)?!1:gC(Array.from(l),[""],s,a,()=>Hie(e,t,r))}function AR(n,e,t,r,s){for(;t;)t=$ie(n,e,t,r,s);return t}function Hie(n,e,t){const r=n._getTarget();e in r||(r[e]={});const s=r[e];return Tr(s)&&nn(t)?t:s||{}}function Yie(n,e,t,r){let s;for(const a of e)if(s=j6(zie(a,n),t),typeof s<"u")return xC(n,s)?yC(t,r,n,s):s}function j6(n,e){for(const t of e){if(!t)continue;const r=t[n];if(typeof r<"u")return r}}function RR(n){let e=n._keys;return e||(e=n._keys=Gie(n._scopes)),e}function Gie(n){const e=new Set;for(const t of n)for(const r of Object.keys(t).filter(s=>!s.startsWith("_")))e.add(r);return Array.from(e)}const Zie=Number.EPSILON||1e-14,zf=(n,e)=>e<n.length&&!n[e].skip&&n[e],N6=n=>n==="x"?"y":"x";function Kie(n,e,t,r){const s=n.skip?e:n,a=e,o=t.skip?e:t,l=YS(a,s),c=YS(o,a);let d=l/(l+c),h=c/(l+c);d=isNaN(d)?0:d,h=isNaN(h)?0:h;const p=r*d,x=r*h;return{previous:{x:a.x-p*(o.x-s.x),y:a.y-p*(o.y-s.y)},next:{x:a.x+x*(o.x-s.x),y:a.y+x*(o.y-s.y)}}}function Jie(n,e,t){const r=n.length;let s,a,o,l,c,d=zf(n,0);for(let h=0;h<r-1;++h)if(c=d,d=zf(n,h+1),!(!c||!d)){if(rm(e[h],0,Zie)){t[h]=t[h+1]=0;continue}s=t[h]/e[h],a=t[h+1]/e[h],l=Math.pow(s,2)+Math.pow(a,2),!(l<=9)&&(o=3/Math.sqrt(l),t[h]=s*o*e[h],t[h+1]=a*o*e[h])}}function Qie(n,e,t="x"){const r=N6(t),s=n.length;let a,o,l,c=zf(n,0);for(let d=0;d<s;++d){if(o=l,l=c,c=zf(n,d+1),!l)continue;const h=l[t],p=l[r];o&&(a=(h-o[t])/3,l[`cp1${t}`]=h-a,l[`cp1${r}`]=p-a*e[d]),c&&(a=(c[t]-h)/3,l[`cp2${t}`]=h+a,l[`cp2${r}`]=p+a*e[d])}}function Xie(n,e="x"){const t=N6(e),r=n.length,s=Array(r).fill(0),a=Array(r);let o,l,c,d=zf(n,0);for(o=0;o<r;++o)if(l=c,c=d,d=zf(n,o+1),!!c){if(d){const h=d[e]-c[e];s[o]=h!==0?(d[t]-c[t])/h:0}a[o]=l?d?So(s[o-1])!==So(s[o])?0:(s[o-1]+s[o])/2:s[o-1]:s[o]}Jie(n,s,a),Qie(n,a,e)}function Wg(n,e,t){return Math.max(Math.min(n,t),e)}function eae(n,e){let t,r,s,a,o,l=km(n[0],e);for(t=0,r=n.length;t<r;++t)o=a,a=l,l=t<r-1&&km(n[t+1],e),a&&(s=n[t],o&&(s.cp1x=Wg(s.cp1x,e.left,e.right),s.cp1y=Wg(s.cp1y,e.top,e.bottom)),l&&(s.cp2x=Wg(s.cp2x,e.left,e.right),s.cp2y=Wg(s.cp2y,e.top,e.bottom)))}function tae(n,e,t,r,s){let a,o,l,c;if(e.spanGaps&&(n=n.filter(d=>!d.skip)),e.cubicInterpolationMode==="monotone")Xie(n,s);else{let d=r?n[n.length-1]:n[0];for(a=0,o=n.length;a<o;++a)l=n[a],c=Kie(d,l,n[Math.min(a+1,o-(r?0:1))%o],e.tension),l.cp1x=c.previous.x,l.cp1y=c.previous.y,l.cp2x=c.next.x,l.cp2y=c.next.y,d=l}e.capBezierPoints&&eae(n,t)}function vC(){return typeof window<"u"&&typeof document<"u"}function bC(n){let e=n.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function $x(n,e,t){let r;return typeof n=="string"?(r=parseInt(n,10),n.indexOf("%")!==-1&&(r=r/100*e.parentNode[t])):r=n,r}const Dy=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function nae(n,e){return Dy(n).getPropertyValue(e)}const rae=["top","right","bottom","left"];function fu(n,e,t){const r={};t=t?"-"+t:"";for(let s=0;s<4;s++){const a=rae[s];r[a]=parseFloat(n[e+"-"+a+t])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const sae=(n,e,t)=>(n>0||e>0)&&(!t||!t.shadowRoot);function iae(n,e){const t=n.touches,r=t&&t.length?t[0]:n,{offsetX:s,offsetY:a}=r;let o=!1,l,c;if(sae(s,a,n.target))l=s,c=a;else{const d=e.getBoundingClientRect();l=r.clientX-d.left,c=r.clientY-d.top,o=!0}return{x:l,y:c,box:o}}function tu(n,e){if("native"in n)return n;const{canvas:t,currentDevicePixelRatio:r}=e,s=Dy(t),a=s.boxSizing==="border-box",o=fu(s,"padding"),l=fu(s,"border","width"),{x:c,y:d,box:h}=iae(n,t),p=o.left+(h&&l.left),x=o.top+(h&&l.top);let{width:y,height:_}=e;return a&&(y-=o.width+l.width,_-=o.height+l.height),{x:Math.round((c-p)/y*t.width/r),y:Math.round((d-x)/_*t.height/r)}}function aae(n,e,t){let r,s;if(e===void 0||t===void 0){const a=n&&bC(n);if(!a)e=n.clientWidth,t=n.clientHeight;else{const o=a.getBoundingClientRect(),l=Dy(a),c=fu(l,"border","width"),d=fu(l,"padding");e=o.width-d.width-c.width,t=o.height-d.height-c.height,r=$x(l.maxWidth,a,"clientWidth"),s=$x(l.maxHeight,a,"clientHeight")}}return{width:e,height:t,maxWidth:r||Bx,maxHeight:s||Bx}}const Lc=n=>Math.round(n*10)/10;function oae(n,e,t,r){const s=Dy(n),a=fu(s,"margin"),o=$x(s.maxWidth,n,"clientWidth")||Bx,l=$x(s.maxHeight,n,"clientHeight")||Bx,c=aae(n,e,t);let{width:d,height:h}=c;if(s.boxSizing==="content-box"){const x=fu(s,"border","width"),y=fu(s,"padding");d-=y.width+x.width,h-=y.height+x.height}return d=Math.max(0,d-a.width),h=Math.max(0,r?d/r:h-a.height),d=Lc(Math.min(d,o,c.maxWidth)),h=Lc(Math.min(h,l,c.maxHeight)),d&&!h&&(h=Lc(d/2)),(e!==void 0||t!==void 0)&&r&&c.height&&h>c.height&&(h=c.height,d=Lc(Math.floor(h*r))),{width:d,height:h}}function LR(n,e,t){const r=e||1,s=Lc(n.height*r),a=Lc(n.width*r);n.height=Lc(n.height),n.width=Lc(n.width);const o=n.canvas;return o.style&&(t||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==r||o.height!==s||o.width!==a?(n.currentDevicePixelRatio=r,o.height=s,o.width=a,n.ctx.setTransform(r,0,0,r,0,0),!0):!1}const lae=(function(){let n=!1;try{const e={get passive(){return n=!0,!1}};vC()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return n})();function FR(n,e){const t=nae(n,e),r=t&&t.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}function nu(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:n.y+t*(e.y-n.y)}}function cae(n,e,t,r){return{x:n.x+t*(e.x-n.x),y:r==="middle"?t<.5?n.y:e.y:r==="after"?t<1?n.y:e.y:t>0?e.y:n.y}}function dae(n,e,t,r){const s={x:n.cp2x,y:n.cp2y},a={x:e.cp1x,y:e.cp1y},o=nu(n,s,t),l=nu(s,a,t),c=nu(a,e,t),d=nu(o,l,t),h=nu(l,c,t);return nu(d,h,t)}const uae=function(n,e){return{x(t){return n+n+e-t},setWidth(t){e=t},textAlign(t){return t==="center"?t:t==="right"?"left":"right"},xPlus(t,r){return t-r},leftForLtr(t,r){return t-r}}},fae=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,e){return n+e},leftForLtr(n,e){return n}}};function bf(n,e,t){return n?uae(e,t):fae()}function S6(n,e){let t,r;(e==="ltr"||e==="rtl")&&(t=n.canvas.style,r=[t.getPropertyValue("direction"),t.getPropertyPriority("direction")],t.setProperty("direction",e,"important"),n.prevTextDirection=r)}function C6(n,e){e!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",e[0],e[1]))}function T6(n){return n==="angle"?{between:Tm,compare:uie,normalize:hi}:{between:_l,compare:(e,t)=>e-t,normalize:e=>e}}function qR({start:n,end:e,count:t,loop:r,style:s}){return{start:n%t,end:e%t,loop:r&&(e-n+1)%t===0,style:s}}function hae(n,e,t){const{property:r,start:s,end:a}=t,{between:o,normalize:l}=T6(r),c=e.length;let{start:d,end:h,loop:p}=n,x,y;if(p){for(d+=c,h+=c,x=0,y=c;x<y&&o(l(e[d%c][r]),s,a);++x)d--,h--;d%=c,h%=c}return h<d&&(h+=c),{start:d,end:h,loop:p,style:n.style}}function k6(n,e,t){if(!t)return[n];const{property:r,start:s,end:a}=t,o=e.length,{compare:l,between:c,normalize:d}=T6(r),{start:h,end:p,loop:x,style:y}=hae(n,e,t),_=[];let w=!1,j=null,C,P,O;const M=()=>c(s,O,C)&&l(s,O)!==0,D=()=>l(a,C)===0||c(a,O,C),I=()=>w||M(),F=()=>!w||D();for(let q=h,B=h;q<=p;++q)P=e[q%o],!P.skip&&(C=d(P[r]),C!==O&&(w=c(C,s,a),j===null&&I()&&(j=l(C,s)===0?q:B),j!==null&&F()&&(_.push(qR({start:j,end:q,loop:x,count:o,style:y})),j=null),B=q,O=C));return j!==null&&_.push(qR({start:j,end:p,loop:x,count:o,style:y})),_}function P6(n,e){const t=[],r=n.segments;for(let s=0;s<r.length;s++){const a=k6(r[s],n.points,e);a.length&&t.push(...a)}return t}function mae(n,e,t,r){let s=0,a=e-1;if(t&&!r)for(;s<e&&!n[s].skip;)s++;for(;s<e&&n[s].skip;)s++;for(s%=e,t&&(a+=s);a>s&&n[a%e].skip;)a--;return a%=e,{start:s,end:a}}function pae(n,e,t,r){const s=n.length,a=[];let o=e,l=n[e],c;for(c=e+1;c<=t;++c){const d=n[c%s];d.skip||d.stop?l.skip||(r=!1,a.push({start:e%s,end:(c-1)%s,loop:r}),e=o=d.stop?c:null):(o=c,l.skip&&(e=c)),l=d}return o!==null&&a.push({start:e%s,end:o%s,loop:r}),a}function gae(n,e){const t=n.points,r=n.options.spanGaps,s=t.length;if(!s)return[];const a=!!n._loop,{start:o,end:l}=mae(t,s,a,r);if(r===!0)return zR(n,[{start:o,end:l,loop:a}],t,e);const c=l<o?l+s:l,d=!!n._fullLoop&&o===0&&l===s-1;return zR(n,pae(t,o,c,d),t,e)}function zR(n,e,t,r){return!r||!r.setContext||!t?e:xae(n,e,t,r)}function xae(n,e,t,r){const s=n._chart.getContext(),a=UR(n.options),{_datasetIndex:o,options:{spanGaps:l}}=n,c=t.length,d=[];let h=a,p=e[0].start,x=p;function y(_,w,j,C){const P=l?-1:1;if(_!==w){for(_+=c;t[_%c].skip;)_-=P;for(;t[w%c].skip;)w+=P;_%c!==w%c&&(d.push({start:_%c,end:w%c,loop:j,style:C}),h=C,p=w%c)}}for(const _ of e){p=l?p:_.start;let w=t[p%c],j;for(x=p+1;x<=_.end;x++){const C=t[x%c];j=UR(r.setContext(Tu(s,{type:"segment",p0:w,p1:C,p0DataIndex:(x-1)%c,p1DataIndex:x%c,datasetIndex:o}))),yae(j,h)&&y(p,x-1,_.loop,h),w=C,h=j}p<x-1&&y(p,x-1,_.loop,h)}return d}function UR(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function yae(n,e){if(!e)return!1;const t=[],r=function(s,a){return hC(a)?(t.includes(a)||t.push(a),t.indexOf(a)):a};return JSON.stringify(n,r)!==JSON.stringify(e,r)}function $g(n,e,t){return n.options.clip?n[t]:e[t]}function vae(n,e){const{xScale:t,yScale:r}=n;return t&&r?{left:$g(t,e,"left"),right:$g(t,e,"right"),top:$g(r,e,"top"),bottom:$g(r,e,"bottom")}:e}function M6(n,e){const t=e._clip;if(t.disabled)return!1;const r=vae(e,n.chartArea);return{left:t.left===!1?0:r.left-(t.left===!0?0:t.left),right:t.right===!1?n.width:r.right+(t.right===!0?0:t.right),top:t.top===!1?0:r.top-(t.top===!0?0:t.top),bottom:t.bottom===!1?n.height:r.bottom+(t.bottom===!0?0:t.bottom)}}class bae{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,t,r,s){const a=t.listeners[s],o=t.duration;a.forEach(l=>l({chart:e,initial:t.initial,numSteps:o,currentStep:Math.min(r-t.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=m6.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let t=0;this._charts.forEach((r,s)=>{if(!r.running||!r.items.length)return;const a=r.items;let o=a.length-1,l=!1,c;for(;o>=0;--o)c=a[o],c._active?(c._total>r.duration&&(r.duration=c._total),c.tick(e),l=!0):(a[o]=a[a.length-1],a.pop());l&&(s.draw(),this._notify(s,r,e,"progress")),a.length||(r.running=!1,this._notify(s,r,e,"complete"),r.initial=!1),t+=a.length}),this._lastDate=e,t===0&&(this._running=!1)}_getAnims(e){const t=this._charts;let r=t.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},t.set(e,r)),r}listen(e,t,r){this._getAnims(e).listeners[t].push(r)}add(e,t){!t||!t.length||this._getAnims(e).items.push(...t)}has(e){return this._getAnims(e).items.length>0}start(e){const t=this._charts.get(e);t&&(t.running=!0,t.start=Date.now(),t.duration=t.items.reduce((r,s)=>Math.max(r,s._duration),0),this._refresh())}running(e){if(!this._running)return!1;const t=this._charts.get(e);return!(!t||!t.running||!t.items.length)}stop(e){const t=this._charts.get(e);if(!t||!t.items.length)return;const r=t.items;let s=r.length-1;for(;s>=0;--s)r[s].cancel();t.items=[],this._notify(e,t,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var pl=new bae;const BR="transparent",wae={boolean(n,e,t){return t>.5?e:n},color(n,e,t){const r=ER(n||BR),s=r.valid&&ER(e||BR);return s&&s.valid?s.mix(r,t).hexString():e},number(n,e,t){return n+(e-n)*t}};class _ae{constructor(e,t,r,s){const a=t[r];s=Vg([e.to,s,a,e.from]);const o=Vg([e.from,a,s]);this._active=!0,this._fn=e.fn||wae[e.type||typeof o],this._easing=sm[e.easing]||sm.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=t,this._prop=r,this._from=o,this._to=s,this._promises=void 0}active(){return this._active}update(e,t,r){if(this._active){this._notify(!1);const s=this._target[this._prop],a=r-this._start,o=this._duration-a;this._start=r,this._duration=Math.floor(Math.max(o,e.duration)),this._total+=a,this._loop=!!e.loop,this._to=Vg([e.to,t,s,e.from]),this._from=Vg([e.from,s,t])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const t=e-this._start,r=this._duration,s=this._prop,a=this._from,o=this._loop,l=this._to;let c;if(this._active=a!==l&&(o||t<r),!this._active){this._target[s]=l,this._notify(!0);return}if(t<0){this._target[s]=a;return}c=t/r%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[s]=this._fn(a,l,c)}wait(){const e=this._promises||(this._promises=[]);return new Promise((t,r)=>{e.push({res:t,rej:r})})}_notify(e){const t=e?"res":"rej",r=this._promises||[];for(let s=0;s<r.length;s++)r[s][t]()}}class E6{constructor(e,t){this._chart=e,this._properties=new Map,this.configure(t)}configure(e){if(!nn(e))return;const t=Object.keys(cr.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(s=>{const a=e[s];if(!nn(a))return;const o={};for(const l of t)o[l]=a[l];(Tr(a.properties)&&a.properties||[s]).forEach(l=>{(l===s||!r.has(l))&&r.set(l,o)})})}_animateOptions(e,t){const r=t.options,s=Nae(e,r);if(!s)return[];const a=this._createAnimations(s,r);return r.$shared&&jae(e.options.$animations,r).then(()=>{e.options=r},()=>{}),a}_createAnimations(e,t){const r=this._properties,s=[],a=e.$animations||(e.$animations={}),o=Object.keys(t),l=Date.now();let c;for(c=o.length-1;c>=0;--c){const d=o[c];if(d.charAt(0)==="$")continue;if(d==="options"){s.push(...this._animateOptions(e,t));continue}const h=t[d];let p=a[d];const x=r.get(d);if(p)if(x&&p.active()){p.update(x,h,l);continue}else p.cancel();if(!x||!x.duration){e[d]=h;continue}a[d]=p=new _ae(x,e,d,h),s.push(p)}return s}update(e,t){if(this._properties.size===0){Object.assign(e,t);return}const r=this._createAnimations(e,t);if(r.length)return pl.add(this._chart,r),!0}}function jae(n,e){const t=[],r=Object.keys(e);for(let s=0;s<r.length;s++){const a=n[r[s]];a&&a.active()&&t.push(a.wait())}return Promise.all(t)}function Nae(n,e){if(!e)return;let t=n.options;if(!t){n.options=e;return}return t.$shared&&(n.options=t=Object.assign({},t,{$shared:!1,$animations:{}})),t}function VR(n,e){const t=n&&n.options||{},r=t.reverse,s=t.min===void 0?e:0,a=t.max===void 0?e:0;return{start:r?a:s,end:r?s:a}}function Sae(n,e,t){if(t===!1)return!1;const r=VR(n,t),s=VR(e,t);return{top:s.end,right:r.end,bottom:s.start,left:r.start}}function Cae(n){let e,t,r,s;return nn(n)?(e=n.top,t=n.right,r=n.bottom,s=n.left):e=t=r=s=n,{top:e,right:t,bottom:r,left:s,disabled:n===!1}}function D6(n,e){const t=[],r=n._getSortedDatasetMetas(e);let s,a;for(s=0,a=r.length;s<a;++s)t.push(r[s].index);return t}function WR(n,e,t,r={}){const s=n.keys,a=r.mode==="single";let o,l,c,d;if(e===null)return;let h=!1;for(o=0,l=s.length;o<l;++o){if(c=+s[o],c===t){if(h=!0,r.all)continue;break}d=n.values[c],fs(d)&&(a||e===0||So(e)===So(d))&&(e+=d)}return!h&&!r.all?0:e}function Tae(n,e){const{iScale:t,vScale:r}=e,s=t.axis==="x"?"x":"y",a=r.axis==="x"?"x":"y",o=Object.keys(n),l=new Array(o.length);let c,d,h;for(c=0,d=o.length;c<d;++c)h=o[c],l[c]={[s]:h,[a]:n[h]};return l}function TN(n,e){const t=n&&n.options.stacked;return t||t===void 0&&e.stack!==void 0}function kae(n,e,t){return`${n.id}.${e.id}.${t.stack||t.type}`}function Pae(n){const{min:e,max:t,minDefined:r,maxDefined:s}=n.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:s?t:Number.POSITIVE_INFINITY}}function Mae(n,e,t){const r=n[e]||(n[e]={});return r[t]||(r[t]={})}function $R(n,e,t,r){for(const s of e.getMatchingVisibleMetas(r).reverse()){const a=n[s.index];if(t&&a>0||!t&&a<0)return s.index}return null}function HR(n,e){const{chart:t,_cachedMeta:r}=n,s=t._stacks||(t._stacks={}),{iScale:a,vScale:o,index:l}=r,c=a.axis,d=o.axis,h=kae(a,o,r),p=e.length;let x;for(let y=0;y<p;++y){const _=e[y],{[c]:w,[d]:j}=_,C=_._stacks||(_._stacks={});x=C[d]=Mae(s,h,w),x[l]=j,x._top=$R(x,o,!0,r.type),x._bottom=$R(x,o,!1,r.type);const P=x._visualValues||(x._visualValues={});P[l]=j}}function kN(n,e){const t=n.scales;return Object.keys(t).filter(r=>t[r].axis===e).shift()}function Eae(n,e){return Tu(n,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Dae(n,e,t){return Tu(n,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:t,index:e,mode:"default",type:"data"})}function Rh(n,e){const t=n.controller.index,r=n.vScale&&n.vScale.axis;if(r){e=e||n._parsed;for(const s of e){const a=s._stacks;if(!a||a[r]===void 0||a[r][t]===void 0)return;delete a[r][t],a[r]._visualValues!==void 0&&a[r]._visualValues[t]!==void 0&&delete a[r]._visualValues[t]}}}const PN=n=>n==="reset"||n==="none",YR=(n,e)=>e?n:Object.assign({},n),Oae=(n,e,t)=>n&&!e.hidden&&e._stacked&&{keys:D6(t,!0),values:null};class Oy{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,t){this.chart=e,this._ctx=e.ctx,this.index=t,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=TN(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Rh(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,t=this._cachedMeta,r=this.getDataset(),s=(p,x,y,_)=>p==="x"?x:p==="r"?_:y,a=t.xAxisID=Yt(r.xAxisID,kN(e,"x")),o=t.yAxisID=Yt(r.yAxisID,kN(e,"y")),l=t.rAxisID=Yt(r.rAxisID,kN(e,"r")),c=t.indexAxis,d=t.iAxisID=s(c,a,o,l),h=t.vAxisID=s(c,o,a,l);t.xScale=this.getScaleForId(a),t.yScale=this.getScaleForId(o),t.rScale=this.getScaleForId(l),t.iScale=this.getScaleForId(d),t.vScale=this.getScaleForId(h)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const t=this._cachedMeta;return e===t.iScale?t.vScale:t.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&kR(this._data,this),e._stacked&&Rh(e)}_dataCheck(){const e=this.getDataset(),t=e.data||(e.data=[]),r=this._data;if(nn(t)){const s=this._cachedMeta;this._data=Tae(t,s)}else if(r!==t){if(r){kR(r,this);const s=this._cachedMeta;Rh(s),s._parsed=[]}t&&Object.isExtensible(t)&&pie(t,this),this._syncList=[],this._data=t}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const t=this._cachedMeta,r=this.getDataset();let s=!1;this._dataCheck();const a=t._stacked;t._stacked=TN(t.vScale,t),t.stack!==r.stack&&(s=!0,Rh(t),t.stack=r.stack),this._resyncElements(e),(s||a!==t._stacked)&&(HR(this,t._parsed),t._stacked=TN(t.vScale,t))}configure(){const e=this.chart.config,t=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),t,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,t){const{_cachedMeta:r,_data:s}=this,{iScale:a,_stacked:o}=r,l=a.axis;let c=e===0&&t===s.length?!0:r._sorted,d=e>0&&r._parsed[e-1],h,p,x;if(this._parsing===!1)r._parsed=s,r._sorted=!0,x=s;else{Tr(s[e])?x=this.parseArrayData(r,s,e,t):nn(s[e])?x=this.parseObjectData(r,s,e,t):x=this.parsePrimitiveData(r,s,e,t);const y=()=>p[l]===null||d&&p[l]<d[l];for(h=0;h<t;++h)r._parsed[h+e]=p=x[h],c&&(y()&&(c=!1),d=p);r._sorted=c}o&&HR(this,x)}parsePrimitiveData(e,t,r,s){const{iScale:a,vScale:o}=e,l=a.axis,c=o.axis,d=a.getLabels(),h=a===o,p=new Array(s);let x,y,_;for(x=0,y=s;x<y;++x)_=x+r,p[x]={[l]:h||a.parse(d[_],_),[c]:o.parse(t[_],_)};return p}parseArrayData(e,t,r,s){const{xScale:a,yScale:o}=e,l=new Array(s);let c,d,h,p;for(c=0,d=s;c<d;++c)h=c+r,p=t[h],l[c]={x:a.parse(p[0],h),y:o.parse(p[1],h)};return l}parseObjectData(e,t,r,s){const{xScale:a,yScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=new Array(s);let h,p,x,y;for(h=0,p=s;h<p;++h)x=h+r,y=t[x],d[h]={x:a.parse(yu(y,l),x),y:o.parse(yu(y,c),x)};return d}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,t,r){const s=this.chart,a=this._cachedMeta,o=t[e.axis],l={keys:D6(s,!0),values:t._stacks[e.axis]._visualValues};return WR(l,o,a.index,{mode:r})}updateRangeFromParsed(e,t,r,s){const a=r[t.axis];let o=a===null?NaN:a;const l=s&&r._stacks[t.axis];s&&l&&(s.values=l,o=WR(s,a,this._cachedMeta.index)),e.min=Math.min(e.min,o),e.max=Math.max(e.max,o)}getMinMax(e,t){const r=this._cachedMeta,s=r._parsed,a=r._sorted&&e===r.iScale,o=s.length,l=this._getOtherScale(e),c=Oae(t,r,this.chart),d={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:h,max:p}=Pae(l);let x,y;function _(){y=s[x];const w=y[l.axis];return!fs(y[e.axis])||h>w||p<w}for(x=0;x<o&&!(!_()&&(this.updateRangeFromParsed(d,e,y,c),a));++x);if(a){for(x=o-1;x>=0;--x)if(!_()){this.updateRangeFromParsed(d,e,y,c);break}}return d}getAllParsedValues(e){const t=this._cachedMeta._parsed,r=[];let s,a,o;for(s=0,a=t.length;s<a;++s)o=t[s][e.axis],fs(o)&&r.push(o);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const t=this._cachedMeta,r=t.iScale,s=t.vScale,a=this.getParsed(e);return{label:r?""+r.getLabelForValue(a[r.axis]):"",value:s?""+s.getLabelForValue(a[s.axis]):""}}_update(e){const t=this._cachedMeta;this.update(e||"default"),t._clip=Cae(Yt(this.options.clip,Sae(t.xScale,t.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,t=this.chart,r=this._cachedMeta,s=r.data||[],a=t.chartArea,o=[],l=this._drawStart||0,c=this._drawCount||s.length-l,d=this.options.drawActiveElementsOnTop;let h;for(r.dataset&&r.dataset.draw(e,a,l,c),h=l;h<l+c;++h){const p=s[h];p.hidden||(p.active&&d?o.push(p):p.draw(e,a))}for(h=0;h<o.length;++h)o[h].draw(e,a)}getStyle(e,t){const r=t?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,t,r){const s=this.getDataset();let a;if(e>=0&&e<this._cachedMeta.data.length){const o=this._cachedMeta.data[e];a=o.$context||(o.$context=Dae(this.getContext(),e,o)),a.parsed=this.getParsed(e),a.raw=s.data[e],a.index=a.dataIndex=e}else a=this.$context||(this.$context=Eae(this.chart.getContext(),this.index)),a.dataset=s,a.index=a.datasetIndex=this.index;return a.active=!!t,a.mode=r,a}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,t){return this._resolveElementOptions(this.dataElementType.id,t,e)}_resolveElementOptions(e,t="default",r){const s=t==="active",a=this._cachedDataOpts,o=e+"-"+t,l=a[o],c=this.enableOptionSharing&&Sm(r);if(l)return YR(l,c);const d=this.chart.config,h=d.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],x=d.getOptionScopes(this.getDataset(),h),y=Object.keys(cr.elements[e]),_=()=>this.getContext(r,s,t),w=d.resolveNamedOptions(x,y,_,p);return w.$shared&&(w.$shared=c,a[o]=Object.freeze(YR(w,c))),w}_resolveAnimations(e,t,r){const s=this.chart,a=this._cachedDataOpts,o=`animation-${t}`,l=a[o];if(l)return l;let c;if(s.options.animation!==!1){const h=this.chart.config,p=h.datasetAnimationScopeKeys(this._type,t),x=h.getOptionScopes(this.getDataset(),p);c=h.createResolver(x,this.getContext(e,r,t))}const d=new E6(s,c&&c.animations);return c&&c._cacheable&&(a[o]=Object.freeze(d)),d}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,t){return!t||PN(e)||this.chart._animationsDisabled}_getSharedOptions(e,t){const r=this.resolveDataElementOptions(e,t),s=this._sharedOptions,a=this.getSharedOptions(r),o=this.includeOptions(t,a)||a!==s;return this.updateSharedOptions(a,t,r),{sharedOptions:a,includeOptions:o}}updateElement(e,t,r,s){PN(s)?Object.assign(e,r):this._resolveAnimations(t,s).update(e,r)}updateSharedOptions(e,t,r){e&&!PN(t)&&this._resolveAnimations(void 0,t).update(e,r)}_setStyle(e,t,r,s){e.active=s;const a=this.getStyle(t,s);this._resolveAnimations(t,r,s).update(e,{options:!s&&this.getSharedOptions(a)||a})}removeHoverStyle(e,t,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,t,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const t=this._data,r=this._cachedMeta.data;for(const[l,c,d]of this._syncList)this[l](c,d);this._syncList=[];const s=r.length,a=t.length,o=Math.min(a,s);o&&this.parse(0,o),a>s?this._insertElements(s,a-s,e):a<s&&this._removeElements(a,s-a)}_insertElements(e,t,r=!0){const s=this._cachedMeta,a=s.data,o=e+t;let l;const c=d=>{for(d.length+=t,l=d.length-1;l>=o;l--)d[l]=d[l-t]};for(c(a),l=e;l<o;++l)a[l]=new this.dataElementType;this._parsing&&c(s._parsed),this.parse(e,t),r&&this.updateElements(a,e,t,"reset")}updateElements(e,t,r,s){}_removeElements(e,t){const r=this._cachedMeta;if(this._parsing){const s=r._parsed.splice(e,t);r._stacked&&Rh(r,s)}r.data.splice(e,t)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[t,r,s]=e;this[t](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,t){t&&this._sync(["_removeElements",e,t]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}function Iae(n,e){if(!n._cache.$bar){const t=n.getMatchingVisibleMetas(e);let r=[];for(let s=0,a=t.length;s<a;s++)r=r.concat(t[s].controller.getAllParsedValues(n));n._cache.$bar=h6(r.sort((s,a)=>s-a))}return n._cache.$bar}function Aae(n){const e=n.iScale,t=Iae(e,n.type);let r=e._length,s,a,o,l;const c=()=>{o===32767||o===-32768||(Sm(l)&&(r=Math.min(r,Math.abs(o-l)||r)),l=o)};for(s=0,a=t.length;s<a;++s)o=e.getPixelForValue(t[s]),c();for(l=void 0,s=0,a=e.ticks.length;s<a;++s)o=e.getPixelForTick(s),c();return r}function Rae(n,e,t,r){const s=t.barThickness;let a,o;return vn(s)?(a=e.min*t.categoryPercentage,o=t.barPercentage):(a=s*r,o=1),{chunk:a/r,ratio:o,start:e.pixels[n]-a/2}}function Lae(n,e,t,r){const s=e.pixels,a=s[n];let o=n>0?s[n-1]:null,l=n<s.length-1?s[n+1]:null;const c=t.categoryPercentage;o===null&&(o=a-(l===null?e.end-e.start:l-a)),l===null&&(l=a+a-o);const d=a-(a-Math.min(o,l))/2*c;return{chunk:Math.abs(l-o)/2*c/r,ratio:t.barPercentage,start:d}}function Fae(n,e,t,r){const s=t.parse(n[0],r),a=t.parse(n[1],r),o=Math.min(s,a),l=Math.max(s,a);let c=o,d=l;Math.abs(o)>Math.abs(l)&&(c=l,d=o),e[t.axis]=d,e._custom={barStart:c,barEnd:d,start:s,end:a,min:o,max:l}}function O6(n,e,t,r){return Tr(n)?Fae(n,e,t,r):e[t.axis]=t.parse(n,r),e}function GR(n,e,t,r){const s=n.iScale,a=n.vScale,o=s.getLabels(),l=s===a,c=[];let d,h,p,x;for(d=t,h=t+r;d<h;++d)x=e[d],p={},p[s.axis]=l||s.parse(o[d],d),c.push(O6(x,p,a,d));return c}function MN(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function qae(n,e,t){return n!==0?So(n):(e.isHorizontal()?1:-1)*(e.min>=t?1:-1)}function zae(n){let e,t,r,s,a;return n.horizontal?(e=n.base>n.x,t="left",r="right"):(e=n.base<n.y,t="bottom",r="top"),e?(s="end",a="start"):(s="start",a="end"),{start:t,end:r,reverse:e,top:s,bottom:a}}function Uae(n,e,t,r){let s=e.borderSkipped;const a={};if(!s){n.borderSkipped=a;return}if(s===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:o,end:l,reverse:c,top:d,bottom:h}=zae(n);s==="middle"&&t&&(n.enableBorderRadius=!0,(t._top||0)===r?s=d:(t._bottom||0)===r?s=h:(a[ZR(h,o,l,c)]=!0,s=d)),a[ZR(s,o,l,c)]=!0,n.borderSkipped=a}function ZR(n,e,t,r){return r?(n=Bae(n,e,t),n=KR(n,t,e)):n=KR(n,e,t),n}function Bae(n,e,t){return n===e?t:n===t?e:n}function KR(n,e,t){return n==="start"?e:n==="end"?t:n}function Vae(n,{inflateAmount:e},t){n.inflateAmount=e==="auto"?t===1?.33:0:e}class Wae extends Oy{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,t,r,s){return GR(e,t,r,s)}parseArrayData(e,t,r,s){return GR(e,t,r,s)}parseObjectData(e,t,r,s){const{iScale:a,vScale:o}=e,{xAxisKey:l="x",yAxisKey:c="y"}=this._parsing,d=a.axis==="x"?l:c,h=o.axis==="x"?l:c,p=[];let x,y,_,w;for(x=r,y=r+s;x<y;++x)w=t[x],_={},_[a.axis]=a.parse(yu(w,d),x),p.push(O6(yu(w,h),_,o,x));return p}updateRangeFromParsed(e,t,r,s){super.updateRangeFromParsed(e,t,r,s);const a=r._custom;a&&t===this._cachedMeta.vScale&&(e.min=Math.min(e.min,a.min),e.max=Math.max(e.max,a.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const t=this._cachedMeta,{iScale:r,vScale:s}=t,a=this.getParsed(e),o=a._custom,l=MN(o)?"["+o.start+", "+o.end+"]":""+s.getLabelForValue(a[s.axis]);return{label:""+r.getLabelForValue(a[r.axis]),value:l}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const t=this._cachedMeta;this.updateElements(t.data,0,t.data.length,e)}updateElements(e,t,r,s){const a=s==="reset",{index:o,_cachedMeta:{vScale:l}}=this,c=l.getBasePixel(),d=l.isHorizontal(),h=this._getRuler(),{sharedOptions:p,includeOptions:x}=this._getSharedOptions(t,s);for(let y=t;y<t+r;y++){const _=this.getParsed(y),w=a||vn(_[l.axis])?{base:c,head:c}:this._calculateBarValuePixels(y),j=this._calculateBarIndexPixels(y,h),C=(_._stacks||{})[l.axis],P={horizontal:d,base:w.base,enableBorderRadius:!C||MN(_._custom)||o===C._top||o===C._bottom,x:d?w.head:j.center,y:d?j.center:w.head,height:d?j.size:Math.abs(w.size),width:d?Math.abs(w.size):j.size};x&&(P.options=p||this.resolveDataElementOptions(y,e[y].active?"active":s));const O=P.options||e[y].options;Uae(P,O,C,o),Vae(P,O,h.ratio),this.updateElement(e[y],y,P,s)}}_getStacks(e,t){const{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(h=>h.controller.options.grouped),a=r.options.stacked,o=[],l=this._cachedMeta.controller.getParsed(t),c=l&&l[r.axis],d=h=>{const p=h._parsed.find(y=>y[r.axis]===c),x=p&&p[h.vScale.axis];if(vn(x)||isNaN(x))return!0};for(const h of s)if(!(t!==void 0&&d(h))&&((a===!1||o.indexOf(h.stack)===-1||a===void 0&&h.stack===void 0)&&o.push(h.stack),h.index===e))break;return o.length||o.push(void 0),o}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,t=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===t).shift()}_getAxis(){const e={},t=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[Yt(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,t)]=!0;return Object.keys(e)}_getStackIndex(e,t,r){const s=this._getStacks(e,r),a=t!==void 0?s.indexOf(t):-1;return a===-1?s.length-1:a}_getRuler(){const e=this.options,t=this._cachedMeta,r=t.iScale,s=[];let a,o;for(a=0,o=t.data.length;a<o;++a)s.push(r.getPixelForValue(this.getParsed(a)[r.axis],a));const l=e.barThickness;return{min:l||Aae(t),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:l?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:t,_stacked:r,index:s},options:{base:a,minBarLength:o}}=this,l=a||0,c=this.getParsed(e),d=c._custom,h=MN(d);let p=c[t.axis],x=0,y=r?this.applyStack(t,c,r):p,_,w;y!==p&&(x=y-p,y=p),h&&(p=d.barStart,y=d.barEnd-d.barStart,p!==0&&So(p)!==So(d.barEnd)&&(x=0),x+=p);const j=!vn(a)&&!h?a:x;let C=t.getPixelForValue(j);if(this.chart.getDataVisibility(e)?_=t.getPixelForValue(x+y):_=C,w=_-C,Math.abs(w)<o){w=qae(w,t,l)*o,p===l&&(C-=w/2);const P=t.getPixelForDecimal(0),O=t.getPixelForDecimal(1),M=Math.min(P,O),D=Math.max(P,O);C=Math.max(Math.min(C,D),M),_=C+w,r&&!h&&(c._stacks[t.axis]._visualValues[s]=t.getValueForPixel(_)-t.getValueForPixel(C))}if(C===t.getPixelForValue(l)){const P=So(w)*t.getLineWidthForValue(l)/2;C+=P,w-=P}return{size:w,base:C,head:_,center:_+w/2}}_calculateBarIndexPixels(e,t){const r=t.scale,s=this.options,a=s.skipNull,o=Yt(s.maxBarThickness,1/0);let l,c;const d=this._getAxisCount();if(t.grouped){const h=a?this._getStackCount(e):t.stackCount,p=s.barThickness==="flex"?Lae(e,t,s,h*d):Rae(e,t,s,h*d),x=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,y=this._getAxis().indexOf(Yt(x,this.getFirstScaleIdForIndexAxis())),_=this._getStackIndex(this.index,this._cachedMeta.stack,a?e:void 0)+y;l=p.start+p.chunk*_+p.chunk/2,c=Math.min(o,p.chunk*p.ratio)}else l=r.getPixelForValue(this.getParsed(e)[r.axis],e),c=Math.min(o,t.min*t.ratio);return{base:l-c/2,head:l+c/2,center:l,size:c}}draw(){const e=this._cachedMeta,t=e.vScale,r=e.data,s=r.length;let a=0;for(;a<s;++a)this.getParsed(a)[t.axis]!==null&&!r[a].hidden&&r[a].draw(this._ctx)}}function $ae(n,e,t){let r=1,s=1,a=0,o=0;if(e<er){const l=n,c=l+e,d=Math.cos(l),h=Math.sin(l),p=Math.cos(c),x=Math.sin(c),y=(O,M,D)=>Tm(O,l,c,!0)?1:Math.max(M,M*t,D,D*t),_=(O,M,D)=>Tm(O,l,c,!0)?-1:Math.min(M,M*t,D,D*t),w=y(0,d,p),j=y(kr,h,x),C=_(On,d,p),P=_(On+kr,h,x);r=(w-C)/2,s=(j-P)/2,a=-(w+C)/2,o=-(j+P)/2}return{ratioX:r,ratioY:s,offsetX:a,offsetY:o}}class Hae extends Oy{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const t=e.data,{labels:{pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=e.legend.options;return t.labels.length&&t.datasets.length?t.labels.map((c,d)=>{const p=e.getDatasetMeta(0).controller.getStyle(d);return{text:c,fillStyle:p.backgroundColor,fontColor:a,hidden:!e.getDataVisibility(d),lineDash:p.borderDash,lineDashOffset:p.borderDashOffset,lineJoin:p.borderJoinStyle,lineWidth:p.borderWidth,strokeStyle:p.borderColor,textAlign:s,pointStyle:r,borderRadius:o&&(l||p.borderRadius),index:d}}):[]}},onClick(e,t,r){r.chart.toggleDataVisibility(t.index),r.chart.update()}}}};constructor(e,t){super(e,t),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,t){const r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let a=c=>+r[c];if(nn(r[e])){const{key:c="value"}=this._parsing;a=d=>+yu(r[d],c)}let o,l;for(o=e,l=e+t;o<l;++o)s._parsed[o]=a(o)}}_getRotation(){return wl(this.options.rotation-90)}_getCircumference(){return wl(this.options.circumference)}_getRotationExtents(){let e=er,t=-er;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const s=this.chart.getDatasetMeta(r).controller,a=s._getRotation(),o=s._getCircumference();e=Math.min(e,a),t=Math.max(t,a+o)}return{rotation:e,circumference:t-e}}update(e){const t=this.chart,{chartArea:r}=t,s=this._cachedMeta,a=s.data,o=this.getMaxBorderWidth()+this.getMaxOffset(a)+this.options.spacing,l=Math.max((Math.min(r.width,r.height)-o)/2,0),c=Math.min(Qse(this.options.cutout,l),1),d=this._getRingWeight(this.index),{circumference:h,rotation:p}=this._getRotationExtents(),{ratioX:x,ratioY:y,offsetX:_,offsetY:w}=$ae(p,h,c),j=(r.width-o)/x,C=(r.height-o)/y,P=Math.max(Math.min(j,C)/2,0),O=l6(this.options.radius,P),M=Math.max(O*c,0),D=(O-M)/this._getVisibleDatasetWeightTotal();this.offsetX=_*O,this.offsetY=w*O,s.total=this.calculateTotal(),this.outerRadius=O-D*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-D*d,0),this.updateElements(a,0,a.length,e)}_circumference(e,t){const r=this.options,s=this._cachedMeta,a=this._getCircumference();return t&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*a/er)}updateElements(e,t,r,s){const a=s==="reset",o=this.chart,l=o.chartArea,d=o.options.animation,h=(l.left+l.right)/2,p=(l.top+l.bottom)/2,x=a&&d.animateScale,y=x?0:this.innerRadius,_=x?0:this.outerRadius,{sharedOptions:w,includeOptions:j}=this._getSharedOptions(t,s);let C=this._getRotation(),P;for(P=0;P<t;++P)C+=this._circumference(P,a);for(P=t;P<t+r;++P){const O=this._circumference(P,a),M=e[P],D={x:h+this.offsetX,y:p+this.offsetY,startAngle:C,endAngle:C+O,circumference:O,outerRadius:_,innerRadius:y};j&&(D.options=w||this.resolveDataElementOptions(P,M.active?"active":s)),C+=O,this.updateElement(M,P,D,s)}}calculateTotal(){const e=this._cachedMeta,t=e.data;let r=0,s;for(s=0;s<t.length;s++){const a=e._parsed[s];a!==null&&!isNaN(a)&&this.chart.getDataVisibility(s)&&!t[s].hidden&&(r+=Math.abs(a))}return r}calculateCircumference(e){const t=this._cachedMeta.total;return t>0&&!isNaN(e)?er*(Math.abs(e)/t):0}getLabelAndValue(e){const t=this._cachedMeta,r=this.chart,s=r.data.labels||[],a=mC(t._parsed[e],r.options.locale);return{label:s[e]||"",value:a}}getMaxBorderWidth(e){let t=0;const r=this.chart;let s,a,o,l,c;if(!e){for(s=0,a=r.data.datasets.length;s<a;++s)if(r.isDatasetVisible(s)){o=r.getDatasetMeta(s),e=o.data,l=o.controller;break}}if(!e)return 0;for(s=0,a=e.length;s<a;++s)c=l.resolveDataElementOptions(s),c.borderAlign!=="inner"&&(t=Math.max(t,c.borderWidth||0,c.hoverBorderWidth||0));return t}getMaxOffset(e){let t=0;for(let r=0,s=e.length;r<s;++r){const a=this.resolveDataElementOptions(r);t=Math.max(t,a.offset||0,a.hoverOffset||0)}return t}_getRingWeightOffset(e){let t=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(t+=this._getRingWeight(r));return t}_getRingWeight(e){return Math.max(Yt(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}class Yae extends Oy{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){const t=this._cachedMeta,{dataset:r,data:s=[],_dataset:a}=t,o=this.chart._animationsDisabled;let{start:l,count:c}=yie(t,s,o);this._drawStart=l,this._drawCount=c,vie(t)&&(l=0,c=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!a._decimated,r.points=s;const d=this.resolveDatasetElementOptions(e);this.options.showLine||(d.borderWidth=0),d.segment=this.options.segment,this.updateElement(r,void 0,{animated:!o,options:d},e),this.updateElements(s,l,c,e)}updateElements(e,t,r,s){const a=s==="reset",{iScale:o,vScale:l,_stacked:c,_dataset:d}=this._cachedMeta,{sharedOptions:h,includeOptions:p}=this._getSharedOptions(t,s),x=o.axis,y=l.axis,{spanGaps:_,segment:w}=this.options,j=Cm(_)?_:Number.POSITIVE_INFINITY,C=this.chart._animationsDisabled||a||s==="none",P=t+r,O=e.length;let M=t>0&&this.getParsed(t-1);for(let D=0;D<O;++D){const I=e[D],F=C?I:{};if(D<t||D>=P){F.skip=!0;continue}const q=this.getParsed(D),B=vn(q[y]),U=F[x]=o.getPixelForValue(q[x],D),W=F[y]=a||B?l.getBasePixel():l.getPixelForValue(c?this.applyStack(l,q,c):q[y],D);F.skip=isNaN(U)||isNaN(W)||B,F.stop=D>0&&Math.abs(q[x]-M[x])>j,w&&(F.parsed=q,F.raw=d.data[D]),p&&(F.options=h||this.resolveDataElementOptions(D,I.active?"active":s)),C||this.updateElement(I,D,F,s),M=q}}getMaxOverflow(){const e=this._cachedMeta,t=e.dataset,r=t.options&&t.options.borderWidth||0,s=e.data||[];if(!s.length)return r;const a=s[0].size(this.resolveDataElementOptions(0)),o=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,a,o)/2}draw(){const e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}function Jd(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class wC{static override(e){Object.assign(wC.prototype,e)}options;constructor(e){this.options=e||{}}init(){}formats(){return Jd()}parse(){return Jd()}format(){return Jd()}add(){return Jd()}diff(){return Jd()}startOf(){return Jd()}endOf(){return Jd()}}var Gae={_date:wC};function Zae(n,e,t,r){const{controller:s,data:a,_sorted:o}=n,l=s._cachedMeta.iScale,c=n.dataset&&n.dataset.options?n.dataset.options.spanGaps:null;if(l&&e===l.axis&&e!=="r"&&o&&a.length){const d=l._reversePixels?hie:lu;if(r){if(s._sharedOptions){const h=a[0],p=typeof h.getRange=="function"&&h.getRange(e);if(p){const x=d(a,e,t-p),y=d(a,e,t+p);return{lo:x.lo,hi:y.hi}}}}else{const h=d(a,e,t);if(c){const{vScale:p}=s._cachedMeta,{_parsed:x}=n,y=x.slice(0,h.lo+1).reverse().findIndex(w=>!vn(w[p.axis]));h.lo-=Math.max(0,y);const _=x.slice(h.hi).findIndex(w=>!vn(w[p.axis]));h.hi+=Math.max(0,_)}return h}}return{lo:0,hi:a.length-1}}function Iy(n,e,t,r,s){const a=n.getSortedVisibleDatasetMetas(),o=t[e];for(let l=0,c=a.length;l<c;++l){const{index:d,data:h}=a[l],{lo:p,hi:x}=Zae(a[l],e,o,s);for(let y=p;y<=x;++y){const _=h[y];_.skip||r(_,d,y)}}}function Kae(n){const e=n.indexOf("x")!==-1,t=n.indexOf("y")!==-1;return function(r,s){const a=e?Math.abs(r.x-s.x):0,o=t?Math.abs(r.y-s.y):0;return Math.sqrt(Math.pow(a,2)+Math.pow(o,2))}}function EN(n,e,t,r,s){const a=[];return!s&&!n.isPointInArea(e)||Iy(n,t,e,function(l,c,d){!s&&!km(l,n.chartArea,0)||l.inRange(e.x,e.y,r)&&a.push({element:l,datasetIndex:c,index:d})},!0),a}function Jae(n,e,t,r){let s=[];function a(o,l,c){const{startAngle:d,endAngle:h}=o.getProps(["startAngle","endAngle"],r),{angle:p}=u6(o,{x:e.x,y:e.y});Tm(p,d,h)&&s.push({element:o,datasetIndex:l,index:c})}return Iy(n,t,e,a),s}function Qae(n,e,t,r,s,a){let o=[];const l=Kae(t);let c=Number.POSITIVE_INFINITY;function d(h,p,x){const y=h.inRange(e.x,e.y,s);if(r&&!y)return;const _=h.getCenterPoint(s);if(!(!!a||n.isPointInArea(_))&&!y)return;const j=l(e,_);j<c?(o=[{element:h,datasetIndex:p,index:x}],c=j):j===c&&o.push({element:h,datasetIndex:p,index:x})}return Iy(n,t,e,d),o}function DN(n,e,t,r,s,a){return!a&&!n.isPointInArea(e)?[]:t==="r"&&!r?Jae(n,e,t,s):Qae(n,e,t,r,s,a)}function JR(n,e,t,r,s){const a=[],o=t==="x"?"inXRange":"inYRange";let l=!1;return Iy(n,t,e,(c,d,h)=>{c[o]&&c[o](e[t],s)&&(a.push({element:c,datasetIndex:d,index:h}),l=l||c.inRange(e.x,e.y,s))}),r&&!l?[]:a}var Xae={modes:{index(n,e,t,r){const s=tu(e,n),a=t.axis||"x",o=t.includeInvisible||!1,l=t.intersect?EN(n,s,a,r,o):DN(n,s,a,!1,r,o),c=[];return l.length?(n.getSortedVisibleDatasetMetas().forEach(d=>{const h=l[0].index,p=d.data[h];p&&!p.skip&&c.push({element:p,datasetIndex:d.index,index:h})}),c):[]},dataset(n,e,t,r){const s=tu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;let l=t.intersect?EN(n,s,a,r,o):DN(n,s,a,!1,r,o);if(l.length>0){const c=l[0].datasetIndex,d=n.getDatasetMeta(c).data;l=[];for(let h=0;h<d.length;++h)l.push({element:d[h],datasetIndex:c,index:h})}return l},point(n,e,t,r){const s=tu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return EN(n,s,a,r,o)},nearest(n,e,t,r){const s=tu(e,n),a=t.axis||"xy",o=t.includeInvisible||!1;return DN(n,s,a,t.intersect,r,o)},x(n,e,t,r){const s=tu(e,n);return JR(n,s,"x",t.intersect,r)},y(n,e,t,r){const s=tu(e,n);return JR(n,s,"y",t.intersect,r)}}};const I6=["left","top","right","bottom"];function Lh(n,e){return n.filter(t=>t.pos===e)}function QR(n,e){return n.filter(t=>I6.indexOf(t.pos)===-1&&t.box.axis===e)}function Fh(n,e){return n.sort((t,r)=>{const s=e?r:t,a=e?t:r;return s.weight===a.weight?s.index-a.index:s.weight-a.weight})}function eoe(n){const e=[];let t,r,s,a,o,l;for(t=0,r=(n||[]).length;t<r;++t)s=n[t],{position:a,options:{stack:o,stackWeight:l=1}}=s,e.push({index:t,box:s,pos:a,horizontal:s.isHorizontal(),weight:s.weight,stack:o&&a+o,stackWeight:l});return e}function toe(n){const e={};for(const t of n){const{stack:r,pos:s,stackWeight:a}=t;if(!r||!I6.includes(s))continue;const o=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=a}return e}function noe(n,e){const t=toe(n),{vBoxMaxWidth:r,hBoxMaxHeight:s}=e;let a,o,l;for(a=0,o=n.length;a<o;++a){l=n[a];const{fullSize:c}=l.box,d=t[l.stack],h=d&&l.stackWeight/d.weight;l.horizontal?(l.width=h?h*r:c&&e.availableWidth,l.height=s):(l.width=r,l.height=h?h*s:c&&e.availableHeight)}return t}function roe(n){const e=eoe(n),t=Fh(e.filter(d=>d.box.fullSize),!0),r=Fh(Lh(e,"left"),!0),s=Fh(Lh(e,"right")),a=Fh(Lh(e,"top"),!0),o=Fh(Lh(e,"bottom")),l=QR(e,"x"),c=QR(e,"y");return{fullSize:t,leftAndTop:r.concat(a),rightAndBottom:s.concat(c).concat(o).concat(l),chartArea:Lh(e,"chartArea"),vertical:r.concat(s).concat(c),horizontal:a.concat(o).concat(l)}}function XR(n,e,t,r){return Math.max(n[t],e[t])+Math.max(n[r],e[r])}function A6(n,e){n.top=Math.max(n.top,e.top),n.left=Math.max(n.left,e.left),n.bottom=Math.max(n.bottom,e.bottom),n.right=Math.max(n.right,e.right)}function soe(n,e,t,r){const{pos:s,box:a}=t,o=n.maxPadding;if(!nn(s)){t.size&&(n[s]-=t.size);const p=r[t.stack]||{size:0,count:1};p.size=Math.max(p.size,t.horizontal?a.height:a.width),t.size=p.size/p.count,n[s]+=t.size}a.getPadding&&A6(o,a.getPadding());const l=Math.max(0,e.outerWidth-XR(o,n,"left","right")),c=Math.max(0,e.outerHeight-XR(o,n,"top","bottom")),d=l!==n.w,h=c!==n.h;return n.w=l,n.h=c,t.horizontal?{same:d,other:h}:{same:h,other:d}}function ioe(n){const e=n.maxPadding;function t(r){const s=Math.max(e[r]-n[r],0);return n[r]+=s,s}n.y+=t("top"),n.x+=t("left"),t("right"),t("bottom")}function aoe(n,e){const t=e.maxPadding;function r(s){const a={left:0,top:0,right:0,bottom:0};return s.forEach(o=>{a[o]=Math.max(e[o],t[o])}),a}return r(n?["left","right"]:["top","bottom"])}function Gh(n,e,t,r){const s=[];let a,o,l,c,d,h;for(a=0,o=n.length,d=0;a<o;++a){l=n[a],c=l.box,c.update(l.width||e.w,l.height||e.h,aoe(l.horizontal,e));const{same:p,other:x}=soe(e,t,l,r);d|=p&&s.length,h=h||x,c.fullSize||s.push(l)}return d&&Gh(s,e,t,r)||h}function Hg(n,e,t,r,s){n.top=t,n.left=e,n.right=e+r,n.bottom=t+s,n.width=r,n.height=s}function eL(n,e,t,r){const s=t.padding;let{x:a,y:o}=e;for(const l of n){const c=l.box,d=r[l.stack]||{placed:0,weight:1},h=l.stackWeight/d.weight||1;if(l.horizontal){const p=e.w*h,x=d.size||c.height;Sm(d.start)&&(o=d.start),c.fullSize?Hg(c,s.left,o,t.outerWidth-s.right-s.left,x):Hg(c,e.left+d.placed,o,p,x),d.start=o,d.placed+=p,o=c.bottom}else{const p=e.h*h,x=d.size||c.width;Sm(d.start)&&(a=d.start),c.fullSize?Hg(c,a,s.top,x,t.outerHeight-s.bottom-s.top):Hg(c,a,e.top+d.placed,x,p),d.start=a,d.placed+=p,a=c.right}}e.x=a,e.y=o}var Fc={addBox(n,e){n.boxes||(n.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(t){e.draw(t)}}]},n.boxes.push(e)},removeBox(n,e){const t=n.boxes?n.boxes.indexOf(e):-1;t!==-1&&n.boxes.splice(t,1)},configure(n,e,t){e.fullSize=t.fullSize,e.position=t.position,e.weight=t.weight},update(n,e,t,r){if(!n)return;const s=La(n.options.layout.padding),a=Math.max(e-s.width,0),o=Math.max(t-s.height,0),l=roe(n.boxes),c=l.vertical,d=l.horizontal;jn(n.boxes,w=>{typeof w.beforeLayout=="function"&&w.beforeLayout()});const h=c.reduce((w,j)=>j.box.options&&j.box.options.display===!1?w:w+1,0)||1,p=Object.freeze({outerWidth:e,outerHeight:t,padding:s,availableWidth:a,availableHeight:o,vBoxMaxWidth:a/2/h,hBoxMaxHeight:o/2}),x=Object.assign({},s);A6(x,La(r));const y=Object.assign({maxPadding:x,w:a,h:o,x:s.left,y:s.top},s),_=noe(c.concat(d),p);Gh(l.fullSize,y,p,_),Gh(c,y,p,_),Gh(d,y,p,_)&&Gh(c,y,p,_),ioe(y),eL(l.leftAndTop,y,p,_),y.x+=y.w,y.y+=y.h,eL(l.rightAndBottom,y,p,_),n.chartArea={left:y.left,top:y.top,right:y.left+y.w,bottom:y.top+y.h,height:y.h,width:y.w},jn(l.chartArea,w=>{const j=w.box;Object.assign(j,n.chartArea),j.update(y.w,y.h,{left:0,top:0,right:0,bottom:0})})}};class R6{acquireContext(e,t){}releaseContext(e){return!1}addEventListener(e,t,r){}removeEventListener(e,t,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,t,r,s){return t=Math.max(0,t||e.width),r=r||e.height,{width:t,height:Math.max(0,s?Math.floor(t/s):r)}}isAttached(e){return!0}updateConfig(e){}}class ooe extends R6{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const hx="$chartjs",loe={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},tL=n=>n===null||n==="";function coe(n,e){const t=n.style,r=n.getAttribute("height"),s=n.getAttribute("width");if(n[hx]={initial:{height:r,width:s,style:{display:t.display,height:t.height,width:t.width}}},t.display=t.display||"block",t.boxSizing=t.boxSizing||"border-box",tL(s)){const a=FR(n,"width");a!==void 0&&(n.width=a)}if(tL(r))if(n.style.height==="")n.height=n.width/(e||2);else{const a=FR(n,"height");a!==void 0&&(n.height=a)}return n}const L6=lae?{passive:!0}:!1;function doe(n,e,t){n&&n.addEventListener(e,t,L6)}function uoe(n,e,t){n&&n.canvas&&n.canvas.removeEventListener(e,t,L6)}function foe(n,e){const t=loe[n.type]||n.type,{x:r,y:s}=tu(n,e);return{type:t,chart:e,native:n,x:r!==void 0?r:null,y:s!==void 0?s:null}}function Hx(n,e){for(const t of n)if(t===e||t.contains(e))return!0}function hoe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Hx(l.addedNodes,r),o=o&&!Hx(l.removedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}function moe(n,e,t){const r=n.canvas,s=new MutationObserver(a=>{let o=!1;for(const l of a)o=o||Hx(l.removedNodes,r),o=o&&!Hx(l.addedNodes,r);o&&t()});return s.observe(document,{childList:!0,subtree:!0}),s}const Pm=new Map;let nL=0;function F6(){const n=window.devicePixelRatio;n!==nL&&(nL=n,Pm.forEach((e,t)=>{t.currentDevicePixelRatio!==n&&e()}))}function poe(n,e){Pm.size||window.addEventListener("resize",F6),Pm.set(n,e)}function goe(n){Pm.delete(n),Pm.size||window.removeEventListener("resize",F6)}function xoe(n,e,t){const r=n.canvas,s=r&&bC(r);if(!s)return;const a=p6((l,c)=>{const d=s.clientWidth;t(l,c),d<s.clientWidth&&t()},window),o=new ResizeObserver(l=>{const c=l[0],d=c.contentRect.width,h=c.contentRect.height;d===0&&h===0||a(d,h)});return o.observe(s),poe(n,a),o}function ON(n,e,t){t&&t.disconnect(),e==="resize"&&goe(n)}function yoe(n,e,t){const r=n.canvas,s=p6(a=>{n.ctx!==null&&t(foe(a,n))},n);return doe(r,e,s),s}class voe extends R6{acquireContext(e,t){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(coe(e,t),r):null}releaseContext(e){const t=e.canvas;if(!t[hx])return!1;const r=t[hx].initial;["height","width"].forEach(a=>{const o=r[a];vn(o)?t.removeAttribute(a):t.setAttribute(a,o)});const s=r.style||{};return Object.keys(s).forEach(a=>{t.style[a]=s[a]}),t.width=t.width,delete t[hx],!0}addEventListener(e,t,r){this.removeEventListener(e,t);const s=e.$proxies||(e.$proxies={}),o={attach:hoe,detach:moe,resize:xoe}[t]||yoe;s[t]=o(e,t,r)}removeEventListener(e,t){const r=e.$proxies||(e.$proxies={}),s=r[t];if(!s)return;({attach:ON,detach:ON,resize:ON}[t]||uoe)(e,t,s),r[t]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,t,r,s){return oae(e,t,r,s)}isAttached(e){const t=e&&bC(e);return!!(t&&t.isConnected)}}function boe(n){return!vC()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?ooe:voe}let dd=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}hasValue(){return Cm(this.x)&&Cm(this.y)}getProps(e,t){const r=this.$animations;if(!t||!r)return this;const s={};return e.forEach(a=>{s[a]=r[a]&&r[a].active()?r[a]._to:this[a]}),s}};function woe(n,e){const t=n.options.ticks,r=_oe(n),s=Math.min(t.maxTicksLimit||r,r),a=t.major.enabled?Noe(e):[],o=a.length,l=a[0],c=a[o-1],d=[];if(o>s)return Soe(e,d,a,o/s),d;const h=joe(a,e,s);if(o>0){let p,x;const y=o>1?Math.round((c-l)/(o-1)):null;for(Yg(e,d,h,vn(y)?0:l-y,l),p=0,x=o-1;p<x;p++)Yg(e,d,h,a[p],a[p+1]);return Yg(e,d,h,c,vn(y)?e.length:c+y),d}return Yg(e,d,h),d}function _oe(n){const e=n.options.offset,t=n._tickSize(),r=n._length/t+(e?0:1),s=n._maxLength/t;return Math.floor(Math.min(r,s))}function joe(n,e,t){const r=Coe(n),s=e.length/t;if(!r)return Math.max(s,1);const a=aie(r);for(let o=0,l=a.length-1;o<l;o++){const c=a[o];if(c>s)return c}return Math.max(s,1)}function Noe(n){const e=[];let t,r;for(t=0,r=n.length;t<r;t++)n[t].major&&e.push(t);return e}function Soe(n,e,t,r){let s=0,a=t[0],o;for(r=Math.ceil(r),o=0;o<n.length;o++)o===a&&(e.push(n[o]),s++,a=t[s*r])}function Yg(n,e,t,r,s){const a=Yt(r,0),o=Math.min(Yt(s,n.length),n.length);let l=0,c,d,h;for(t=Math.ceil(t),s&&(c=s-r,t=c/Math.floor(c/t)),h=a;h<0;)l++,h=Math.round(a+l*t);for(d=Math.max(a,0);d<o;d++)d===h&&(e.push(n[d]),l++,h=Math.round(a+l*t))}function Coe(n){const e=n.length;let t,r;if(e<2)return!1;for(r=n[0],t=1;t<e;++t)if(n[t]-n[t-1]!==r)return!1;return r}const Toe=n=>n==="left"?"right":n==="right"?"left":n,rL=(n,e,t)=>e==="top"||e==="left"?n[e]+t:n[e]-t,sL=(n,e)=>Math.min(e||n,n);function iL(n,e){const t=[],r=n.length/e,s=n.length;let a=0;for(;a<s;a+=r)t.push(n[Math.floor(a)]);return t}function koe(n,e,t){const r=n.ticks.length,s=Math.min(e,r-1),a=n._startPixel,o=n._endPixel,l=1e-6;let c=n.getPixelForTick(s),d;if(!(t&&(r===1?d=Math.max(c-a,o-c):e===0?d=(n.getPixelForTick(1)-c)/2:d=(c-n.getPixelForTick(s-1))/2,c+=s<e?d:-d,c<a-l||c>o+l)))return c}function Poe(n,e){jn(n,t=>{const r=t.gc,s=r.length/2;let a;if(s>e){for(a=0;a<s;++a)delete t.data[r[a]];r.splice(0,s)}})}function qh(n){return n.drawTicks?n.tickLength:0}function aL(n,e){if(!n.display)return 0;const t=Gs(n.font,e),r=La(n.padding);return(Tr(n.text)?n.text.length:1)*t.lineHeight+r.height}function Moe(n,e){return Tu(n,{scale:e,type:"scale"})}function Eoe(n,e,t){return Tu(n,{tick:t,index:e,type:"tick"})}function Doe(n,e,t){let r=g6(n);return(t&&e!=="right"||!t&&e==="right")&&(r=Toe(r)),r}function Ooe(n,e,t,r){const{top:s,left:a,bottom:o,right:l,chart:c}=n,{chartArea:d,scales:h}=c;let p=0,x,y,_;const w=o-s,j=l-a;if(n.isHorizontal()){if(y=ui(r,a,l),nn(t)){const C=Object.keys(t)[0],P=t[C];_=h[C].getPixelForValue(P)+w-e}else t==="center"?_=(d.bottom+d.top)/2+w-e:_=rL(n,t,e);x=l-a}else{if(nn(t)){const C=Object.keys(t)[0],P=t[C];y=h[C].getPixelForValue(P)-j+e}else t==="center"?y=(d.left+d.right)/2-j+e:y=rL(n,t,e);_=ui(r,o,s),p=t==="left"?-kr:kr}return{titleX:y,titleY:_,maxWidth:x,rotation:p}}class Kf extends dd{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,t){return e}getUserBounds(){let{_userMin:e,_userMax:t,_suggestedMin:r,_suggestedMax:s}=this;return e=mo(e,Number.POSITIVE_INFINITY),t=mo(t,Number.NEGATIVE_INFINITY),r=mo(r,Number.POSITIVE_INFINITY),s=mo(s,Number.NEGATIVE_INFINITY),{min:mo(e,r),max:mo(t,s),minDefined:fs(e),maxDefined:fs(t)}}getMinMax(e){let{min:t,max:r,minDefined:s,maxDefined:a}=this.getUserBounds(),o;if(s&&a)return{min:t,max:r};const l=this.getMatchingVisibleMetas();for(let c=0,d=l.length;c<d;++c)o=l[c].controller.getMinMax(this,e),s||(t=Math.min(t,o.min)),a||(r=Math.max(r,o.max));return t=a&&t>r?r:t,r=s&&t>r?t:r,{min:mo(t,mo(r,t)),max:mo(r,mo(t,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){Bn(this.options.beforeUpdate,[this])}update(e,t,r){const{beginAtZero:s,grace:a,ticks:o}=this.options,l=o.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=t,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=qie(this,a,s),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const c=l<this.ticks.length;this._convertTicksToLabels(c?iL(this.ticks,l):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=woe(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,t,r;this.isHorizontal()?(t=this.left,r=this.right):(t=this.top,r=this.bottom,e=!e),this._startPixel=t,this._endPixel=r,this._reversePixels=e,this._length=r-t,this._alignToPixels=this.options.alignToPixels}afterUpdate(){Bn(this.options.afterUpdate,[this])}beforeSetDimensions(){Bn(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){Bn(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),Bn(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){Bn(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const t=this.options.ticks;let r,s,a;for(r=0,s=e.length;r<s;r++)a=e[r],a.label=Bn(t.callback,[a.value,r,e],this)}afterTickToLabelConversion(){Bn(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){Bn(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,t=e.ticks,r=sL(this.ticks.length,e.ticks.maxTicksLimit),s=t.minRotation||0,a=t.maxRotation;let o=s,l,c,d;if(!this._isVisible()||!t.display||s>=a||r<=1||!this.isHorizontal()){this.labelRotation=s;return}const h=this._getLabelSizes(),p=h.widest.width,x=h.highest.height,y=ds(this.chart.width-p,0,this.maxWidth);l=e.offset?this.maxWidth/r:y/(r-1),p+6>l&&(l=y/(r-(e.offset?.5:1)),c=this.maxHeight-qh(e.grid)-t.padding-aL(e.title,this.chart.options.font),d=Math.sqrt(p*p+x*x),o=die(Math.min(Math.asin(ds((h.highest.height+6)/l,-1,1)),Math.asin(ds(c/d,-1,1))-Math.asin(ds(x/d,-1,1)))),o=Math.max(s,Math.min(a,o))),this.labelRotation=o}afterCalculateLabelRotation(){Bn(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){Bn(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:t,options:{ticks:r,title:s,grid:a}}=this,o=this._isVisible(),l=this.isHorizontal();if(o){const c=aL(s,t.options.font);if(l?(e.width=this.maxWidth,e.height=qh(a)+c):(e.height=this.maxHeight,e.width=qh(a)+c),r.display&&this.ticks.length){const{first:d,last:h,widest:p,highest:x}=this._getLabelSizes(),y=r.padding*2,_=wl(this.labelRotation),w=Math.cos(_),j=Math.sin(_);if(l){const C=r.mirror?0:j*p.width+w*x.height;e.height=Math.min(this.maxHeight,e.height+C+y)}else{const C=r.mirror?0:w*p.width+j*x.height;e.width=Math.min(this.maxWidth,e.width+C+y)}this._calculatePadding(d,h,j,w)}}this._handleMargins(),l?(this.width=this._length=t.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=t.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,t,r,s){const{ticks:{align:a,padding:o},position:l}=this.options,c=this.labelRotation!==0,d=l!=="top"&&this.axis==="x";if(this.isHorizontal()){const h=this.getPixelForTick(0)-this.left,p=this.right-this.getPixelForTick(this.ticks.length-1);let x=0,y=0;c?d?(x=s*e.width,y=r*t.height):(x=r*e.height,y=s*t.width):a==="start"?y=t.width:a==="end"?x=e.width:a!=="inner"&&(x=e.width/2,y=t.width/2),this.paddingLeft=Math.max((x-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((y-p+o)*this.width/(this.width-p),0)}else{let h=t.height/2,p=e.height/2;a==="start"?(h=0,p=e.height):a==="end"&&(h=t.height,p=0),this.paddingTop=h+o,this.paddingBottom=p+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){Bn(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:t}=this.options;return t==="top"||t==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let t,r;for(t=0,r=e.length;t<r;t++)vn(e[t].label)&&(e.splice(t,1),r--,t--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const t=this.options.ticks.sampleSize;let r=this.ticks;t<r.length&&(r=iL(r,t)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,t,r){const{ctx:s,_longestTextCache:a}=this,o=[],l=[],c=Math.floor(t/sL(t,r));let d=0,h=0,p,x,y,_,w,j,C,P,O,M,D;for(p=0;p<t;p+=c){if(_=e[p].label,w=this._resolveTickFontOptions(p),s.font=j=w.string,C=a[j]=a[j]||{data:{},gc:[]},P=w.lineHeight,O=M=0,!vn(_)&&!Tr(_))O=OR(s,C.data,C.gc,O,_),M=P;else if(Tr(_))for(x=0,y=_.length;x<y;++x)D=_[x],!vn(D)&&!Tr(D)&&(O=OR(s,C.data,C.gc,O,D),M+=P);o.push(O),l.push(M),d=Math.max(O,d),h=Math.max(M,h)}Poe(a,t);const I=o.indexOf(d),F=l.indexOf(h),q=B=>({width:o[B]||0,height:l[B]||0});return{first:q(0),last:q(t-1),widest:q(I),highest:q(F),widths:o,heights:l}}getLabelForValue(e){return e}getPixelForValue(e,t){return NaN}getValueForPixel(e){}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const t=this._startPixel+e*this._length;return fie(this._alignToPixels?Kd(this.chart,t,0):t)}getDecimalForPixel(e){const t=(e-this._startPixel)/this._length;return this._reversePixels?1-t:t}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:t}=this;return e<0&&t<0?t:e>0&&t>0?e:0}getContext(e){const t=this.ticks||[];if(e>=0&&e<t.length){const r=t[e];return r.$context||(r.$context=Eoe(this.getContext(),e,r))}return this.$context||(this.$context=Moe(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,t=wl(this.labelRotation),r=Math.abs(Math.cos(t)),s=Math.abs(Math.sin(t)),a=this._getLabelSizes(),o=e.autoSkipPadding||0,l=a?a.widest.width+o:0,c=a?a.highest.height+o:0;return this.isHorizontal()?c*r>l*s?l/r:c/s:c*s<l*r?c/r:l/s}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const t=this.axis,r=this.chart,s=this.options,{grid:a,position:o,border:l}=s,c=a.offset,d=this.isHorizontal(),p=this.ticks.length+(c?1:0),x=qh(a),y=[],_=l.setContext(this.getContext()),w=_.display?_.width:0,j=w/2,C=function(ee){return Kd(r,ee,w)};let P,O,M,D,I,F,q,B,U,W,G,Z;if(o==="top")P=C(this.bottom),F=this.bottom-x,B=P-j,W=C(e.top)+j,Z=e.bottom;else if(o==="bottom")P=C(this.top),W=e.top,Z=C(e.bottom)-j,F=P+j,B=this.top+x;else if(o==="left")P=C(this.right),I=this.right-x,q=P-j,U=C(e.left)+j,G=e.right;else if(o==="right")P=C(this.left),U=e.left,G=C(e.right)-j,I=P+j,q=this.left+x;else if(t==="x"){if(o==="center")P=C((e.top+e.bottom)/2+.5);else if(nn(o)){const ee=Object.keys(o)[0],me=o[ee];P=C(this.chart.scales[ee].getPixelForValue(me))}W=e.top,Z=e.bottom,F=P+j,B=F+x}else if(t==="y"){if(o==="center")P=C((e.left+e.right)/2);else if(nn(o)){const ee=Object.keys(o)[0],me=o[ee];P=C(this.chart.scales[ee].getPixelForValue(me))}I=P-j,q=I-x,U=e.left,G=e.right}const Y=Yt(s.ticks.maxTicksLimit,p),ae=Math.max(1,Math.ceil(p/Y));for(O=0;O<p;O+=ae){const ee=this.getContext(O),me=a.setContext(ee),$=l.setContext(ee),K=me.lineWidth,re=me.color,H=$.dash||[],se=$.dashOffset,ie=me.tickWidth,ce=me.tickColor,oe=me.tickBorderDash||[],de=me.tickBorderDashOffset;M=koe(this,O,c),M!==void 0&&(D=Kd(r,M,K),d?I=q=U=G=D:F=B=W=Z=D,y.push({tx1:I,ty1:F,tx2:q,ty2:B,x1:U,y1:W,x2:G,y2:Z,width:K,color:re,borderDash:H,borderDashOffset:se,tickWidth:ie,tickColor:ce,tickBorderDash:oe,tickBorderDashOffset:de}))}return this._ticksLength=p,this._borderValue=P,y}_computeLabelItems(e){const t=this.axis,r=this.options,{position:s,ticks:a}=r,o=this.isHorizontal(),l=this.ticks,{align:c,crossAlign:d,padding:h,mirror:p}=a,x=qh(r.grid),y=x+h,_=p?-h:y,w=-wl(this.labelRotation),j=[];let C,P,O,M,D,I,F,q,B,U,W,G,Z="middle";if(s==="top")I=this.bottom-_,F=this._getXAxisLabelAlignment();else if(s==="bottom")I=this.top+_,F=this._getXAxisLabelAlignment();else if(s==="left"){const ae=this._getYAxisLabelAlignment(x);F=ae.textAlign,D=ae.x}else if(s==="right"){const ae=this._getYAxisLabelAlignment(x);F=ae.textAlign,D=ae.x}else if(t==="x"){if(s==="center")I=(e.top+e.bottom)/2+y;else if(nn(s)){const ae=Object.keys(s)[0],ee=s[ae];I=this.chart.scales[ae].getPixelForValue(ee)+y}F=this._getXAxisLabelAlignment()}else if(t==="y"){if(s==="center")D=(e.left+e.right)/2-y;else if(nn(s)){const ae=Object.keys(s)[0],ee=s[ae];D=this.chart.scales[ae].getPixelForValue(ee)}F=this._getYAxisLabelAlignment(x).textAlign}t==="y"&&(c==="start"?Z="top":c==="end"&&(Z="bottom"));const Y=this._getLabelSizes();for(C=0,P=l.length;C<P;++C){O=l[C],M=O.label;const ae=a.setContext(this.getContext(C));q=this.getPixelForTick(C)+a.labelOffset,B=this._resolveTickFontOptions(C),U=B.lineHeight,W=Tr(M)?M.length:1;const ee=W/2,me=ae.color,$=ae.textStrokeColor,K=ae.textStrokeWidth;let re=F;o?(D=q,F==="inner"&&(C===P-1?re=this.options.reverse?"left":"right":C===0?re=this.options.reverse?"right":"left":re="center"),s==="top"?d==="near"||w!==0?G=-W*U+U/2:d==="center"?G=-Y.highest.height/2-ee*U+U:G=-Y.highest.height+U/2:d==="near"||w!==0?G=U/2:d==="center"?G=Y.highest.height/2-ee*U:G=Y.highest.height-W*U,p&&(G*=-1),w!==0&&!ae.showLabelBackdrop&&(D+=U/2*Math.sin(w))):(I=q,G=(1-W)*U/2);let H;if(ae.showLabelBackdrop){const se=La(ae.backdropPadding),ie=Y.heights[C],ce=Y.widths[C];let oe=G-se.top,de=0-se.left;switch(Z){case"middle":oe-=ie/2;break;case"bottom":oe-=ie;break}switch(F){case"center":de-=ce/2;break;case"right":de-=ce;break;case"inner":C===P-1?de-=ce:C>0&&(de-=ce/2);break}H={left:de,top:oe,width:ce+se.width,height:ie+se.height,color:ae.backdropColor}}j.push({label:M,font:B,textOffset:G,options:{rotation:w,color:me,strokeColor:$,strokeWidth:K,textAlign:re,textBaseline:Z,translation:[D,I],backdrop:H}})}return j}_getXAxisLabelAlignment(){const{position:e,ticks:t}=this.options;if(-wl(this.labelRotation))return e==="top"?"left":"right";let s="center";return t.align==="start"?s="left":t.align==="end"?s="right":t.align==="inner"&&(s="inner"),s}_getYAxisLabelAlignment(e){const{position:t,ticks:{crossAlign:r,mirror:s,padding:a}}=this.options,o=this._getLabelSizes(),l=e+a,c=o.widest.width;let d,h;return t==="left"?s?(h=this.right+a,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h+=c)):(h=this.right-l,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h=this.left)):t==="right"?s?(h=this.left+a,r==="near"?d="right":r==="center"?(d="center",h-=c/2):(d="left",h-=c)):(h=this.left+l,r==="near"?d="left":r==="center"?(d="center",h+=c/2):(d="right",h=this.right)):d="right",{textAlign:d,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,t=this.options.position;if(t==="left"||t==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(t==="top"||t==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:t},left:r,top:s,width:a,height:o}=this;t&&(e.save(),e.fillStyle=t,e.fillRect(r,s,a,o),e.restore())}getLineWidthForValue(e){const t=this.options.grid;if(!this._isVisible()||!t.display)return 0;const s=this.ticks.findIndex(a=>a.value===e);return s>=0?t.setContext(this.getContext(s)).lineWidth:0}drawGrid(e){const t=this.options.grid,r=this.ctx,s=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let a,o;const l=(c,d,h)=>{!h.width||!h.color||(r.save(),r.lineWidth=h.width,r.strokeStyle=h.color,r.setLineDash(h.borderDash||[]),r.lineDashOffset=h.borderDashOffset,r.beginPath(),r.moveTo(c.x,c.y),r.lineTo(d.x,d.y),r.stroke(),r.restore())};if(t.display)for(a=0,o=s.length;a<o;++a){const c=s[a];t.drawOnChartArea&&l({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),t.drawTicks&&l({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:t,options:{border:r,grid:s}}=this,a=r.setContext(this.getContext()),o=r.display?a.width:0;if(!o)return;const l=s.setContext(this.getContext(0)).lineWidth,c=this._borderValue;let d,h,p,x;this.isHorizontal()?(d=Kd(e,this.left,o)-o/2,h=Kd(e,this.right,l)+l/2,p=x=c):(p=Kd(e,this.top,o)-o/2,x=Kd(e,this.bottom,l)+l/2,d=h=c),t.save(),t.lineWidth=a.width,t.strokeStyle=a.color,t.beginPath(),t.moveTo(d,p),t.lineTo(h,x),t.stroke(),t.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,s=this._computeLabelArea();s&&My(r,s);const a=this.getLabelItems(e);for(const o of a){const l=o.options,c=o.font,d=o.label,h=o.textOffset;Vx(r,d,0,h,c,l)}s&&Ey(r)}drawTitle(){const{ctx:e,options:{position:t,title:r,reverse:s}}=this;if(!r.display)return;const a=Gs(r.font),o=La(r.padding),l=r.align;let c=a.lineHeight/2;t==="bottom"||t==="center"||nn(t)?(c+=o.bottom,Tr(r.text)&&(c+=a.lineHeight*(r.text.length-1))):c+=o.top;const{titleX:d,titleY:h,maxWidth:p,rotation:x}=Ooe(this,c,t,l);Vx(e,r.text,0,0,a,{color:r.color,maxWidth:p,rotation:x,textAlign:Doe(l,t,s),textBaseline:"middle",translation:[d,h]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,t=e.ticks&&e.ticks.z||0,r=Yt(e.grid&&e.grid.z,-1),s=Yt(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==Kf.prototype.draw?[{z:t,draw:a=>{this.draw(a)}}]:[{z:r,draw:a=>{this.drawBackground(),this.drawGrid(a),this.drawTitle()}},{z:s,draw:()=>{this.drawBorder()}},{z:t,draw:a=>{this.drawLabels(a)}}]}getMatchingVisibleMetas(e){const t=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",s=[];let a,o;for(a=0,o=t.length;a<o;++a){const l=t[a];l[r]===this.id&&(!e||l.type===e)&&s.push(l)}return s}_resolveTickFontOptions(e){const t=this.options.ticks.setContext(this.getContext(e));return Gs(t.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class Gg{constructor(e,t,r){this.type=e,this.scope=t,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const t=Object.getPrototypeOf(e);let r;Roe(t)&&(r=this.register(t));const s=this.items,a=e.id,o=this.scope+"."+a;if(!a)throw new Error("class does not have id: "+e);return a in s||(s[a]=e,Ioe(e,o,r),this.override&&cr.override(e.id,e.overrides)),o}get(e){return this.items[e]}unregister(e){const t=this.items,r=e.id,s=this.scope;r in t&&delete t[r],s&&r in cr[s]&&(delete cr[s][r],this.override&&delete vu[r])}}function Ioe(n,e,t){const r=Nm(Object.create(null),[t?cr.get(t):{},cr.get(e),n.defaults]);cr.set(e,r),n.defaultRoutes&&Aoe(e,n.defaultRoutes),n.descriptors&&cr.describe(e,n.descriptors)}function Aoe(n,e){Object.keys(e).forEach(t=>{const r=t.split("."),s=r.pop(),a=[n].concat(r).join("."),o=e[t].split("."),l=o.pop(),c=o.join(".");cr.route(a,s,c,l)})}function Roe(n){return"id"in n&&"defaults"in n}class Loe{constructor(){this.controllers=new Gg(Oy,"datasets",!0),this.elements=new Gg(dd,"elements"),this.plugins=new Gg(Object,"plugins"),this.scales=new Gg(Kf,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,t,r){[...t].forEach(s=>{const a=r||this._getRegistryForType(s);r||a.isForType(s)||a===this.plugins&&s.id?this._exec(e,a,s):jn(s,o=>{const l=r||this._getRegistryForType(o);this._exec(e,l,o)})})}_exec(e,t,r){const s=uC(e);Bn(r["before"+s],[],r),t[e](r),Bn(r["after"+s],[],r)}_getRegistryForType(e){for(let t=0;t<this._typedRegistries.length;t++){const r=this._typedRegistries[t];if(r.isForType(e))return r}return this.plugins}_get(e,t,r){const s=t.get(e);if(s===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return s}}var go=new Loe;class Foe{constructor(){this._init=void 0}notify(e,t,r,s){if(t==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install")),this._init===void 0)return;const a=s?this._descriptors(e).filter(s):this._descriptors(e),o=this._notify(a,e,t,r);return t==="afterDestroy"&&(this._notify(a,e,"stop"),this._notify(this._init,e,"uninstall"),this._init=void 0),o}_notify(e,t,r,s){s=s||{};for(const a of e){const o=a.plugin,l=o[r],c=[t,s,a.options];if(Bn(l,c,o)===!1&&s.cancelable)return!1}return!0}invalidate(){vn(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const t=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),t}_createDescriptors(e,t){const r=e&&e.config,s=Yt(r.options&&r.options.plugins,{}),a=qoe(r);return s===!1&&!t?[]:Uoe(e,a,s,t)}_notifyStateChanges(e){const t=this._oldCache||[],r=this._cache,s=(a,o)=>a.filter(l=>!o.some(c=>l.plugin.id===c.plugin.id));this._notify(s(t,r),e,"stop"),this._notify(s(r,t),e,"start")}}function qoe(n){const e={},t=[],r=Object.keys(go.plugins.items);for(let a=0;a<r.length;a++)t.push(go.getPlugin(r[a]));const s=n.plugins||[];for(let a=0;a<s.length;a++){const o=s[a];t.indexOf(o)===-1&&(t.push(o),e[o.id]=!0)}return{plugins:t,localIds:e}}function zoe(n,e){return!e&&n===!1?null:n===!0?{}:n}function Uoe(n,{plugins:e,localIds:t},r,s){const a=[],o=n.getContext();for(const l of e){const c=l.id,d=zoe(r[c],s);d!==null&&a.push({plugin:l,options:Boe(n.config,{plugin:l,local:t[c]},d,o)})}return a}function Boe(n,{plugin:e,local:t},r,s){const a=n.pluginScopeKeys(e),o=n.getOptionScopes(r,a);return t&&e.defaults&&o.push(e.defaults),n.createResolver(o,s,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function KS(n,e){const t=cr.datasets[n]||{};return((e.datasets||{})[n]||{}).indexAxis||e.indexAxis||t.indexAxis||"x"}function Voe(n,e){let t=n;return n==="_index_"?t=e:n==="_value_"&&(t=e==="x"?"y":"x"),t}function Woe(n,e){return n===e?"_index_":"_value_"}function oL(n){if(n==="x"||n==="y"||n==="r")return n}function $oe(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function JS(n,...e){if(oL(n))return n;for(const t of e){const r=t.axis||$oe(t.position)||n.length>1&&oL(n[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function lL(n,e,t){if(t[e+"AxisID"]===n)return{axis:e}}function Hoe(n,e){if(e.data&&e.data.datasets){const t=e.data.datasets.filter(r=>r.xAxisID===n||r.yAxisID===n);if(t.length)return lL(n,"x",t[0])||lL(n,"y",t[0])}return{}}function Yoe(n,e){const t=vu[n.type]||{scales:{}},r=e.scales||{},s=KS(n.type,e),a=Object.create(null);return Object.keys(r).forEach(o=>{const l=r[o];if(!nn(l))return console.error(`Invalid scale configuration for scale: ${o}`);if(l._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);const c=JS(o,l,Hoe(o,n),cr.scales[l.type]),d=Woe(c,s),h=t.scales||{};a[o]=nm(Object.create(null),[{axis:c},l,h[c],h[d]])}),n.data.datasets.forEach(o=>{const l=o.type||n.type,c=o.indexAxis||KS(l,e),h=(vu[l]||{}).scales||{};Object.keys(h).forEach(p=>{const x=Voe(p,c),y=o[x+"AxisID"]||x;a[y]=a[y]||Object.create(null),nm(a[y],[{axis:x},r[y],h[p]])})}),Object.keys(a).forEach(o=>{const l=a[o];nm(l,[cr.scales[l.type],cr.scale])}),a}function q6(n){const e=n.options||(n.options={});e.plugins=Yt(e.plugins,{}),e.scales=Yoe(n,e)}function z6(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Goe(n){return n=n||{},n.data=z6(n.data),q6(n),n}const cL=new Map,U6=new Set;function Zg(n,e){let t=cL.get(n);return t||(t=e(),cL.set(n,t),U6.add(t)),t}const zh=(n,e,t)=>{const r=yu(e,t);r!==void 0&&n.add(r)};class Zoe{constructor(e){this._config=Goe(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=z6(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),q6(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return Zg(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,t){return Zg(`${e}.transition.${t}`,()=>[[`datasets.${e}.transitions.${t}`,`transitions.${t}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,t){return Zg(`${e}-${t}`,()=>[[`datasets.${e}.elements.${t}`,`datasets.${e}`,`elements.${t}`,""]])}pluginScopeKeys(e){const t=e.id,r=this.type;return Zg(`${r}-plugin-${t}`,()=>[[`plugins.${t}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,t){const r=this._scopeCache;let s=r.get(e);return(!s||t)&&(s=new Map,r.set(e,s)),s}getOptionScopes(e,t,r){const{options:s,type:a}=this,o=this._cachedScopes(e,r),l=o.get(t);if(l)return l;const c=new Set;t.forEach(h=>{e&&(c.add(e),h.forEach(p=>zh(c,e,p))),h.forEach(p=>zh(c,s,p)),h.forEach(p=>zh(c,vu[a]||{},p)),h.forEach(p=>zh(c,cr,p)),h.forEach(p=>zh(c,GS,p))});const d=Array.from(c);return d.length===0&&d.push(Object.create(null)),U6.has(t)&&o.set(t,d),d}chartOptionScopes(){const{options:e,type:t}=this;return[e,vu[t]||{},cr.datasets[t]||{},{type:t},cr,GS]}resolveNamedOptions(e,t,r,s=[""]){const a={$shared:!0},{resolver:o,subPrefixes:l}=dL(this._resolverCache,e,s);let c=o;if(Joe(o,t)){a.$shared=!1,r=Gc(r)?r():r;const d=this.createResolver(e,r,l);c=qf(o,r,d)}for(const d of t)a[d]=c[d];return a}createResolver(e,t,r=[""],s){const{resolver:a}=dL(this._resolverCache,e,r);return nn(t)?qf(a,t,void 0,s):a}}function dL(n,e,t){let r=n.get(e);r||(r=new Map,n.set(e,r));const s=t.join();let a=r.get(s);return a||(a={resolver:gC(e,t),subPrefixes:t.filter(l=>!l.toLowerCase().includes("hover"))},r.set(s,a)),a}const Koe=n=>nn(n)&&Object.getOwnPropertyNames(n).some(e=>Gc(n[e]));function Joe(n,e){const{isScriptable:t,isIndexable:r}=b6(n);for(const s of e){const a=t(s),o=r(s),l=(o||a)&&n[s];if(a&&(Gc(l)||Koe(l))||o&&Tr(l))return!0}return!1}var Qoe="4.5.1";const Xoe=["top","bottom","left","right","chartArea"];function uL(n,e){return n==="top"||n==="bottom"||Xoe.indexOf(n)===-1&&e==="x"}function fL(n,e){return function(t,r){return t[n]===r[n]?t[e]-r[e]:t[n]-r[n]}}function hL(n){const e=n.chart,t=e.options.animation;e.notifyPlugins("afterRender"),Bn(t&&t.onComplete,[n],e)}function ele(n){const e=n.chart,t=e.options.animation;Bn(t&&t.onProgress,[n],e)}function B6(n){return vC()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}const mx={},mL=n=>{const e=B6(n);return Object.values(mx).filter(t=>t.canvas===e).pop()};function tle(n,e,t){const r=Object.keys(n);for(const s of r){const a=+s;if(a>=e){const o=n[s];delete n[s],(t>0||a>e)&&(n[a+t]=o)}}}function nle(n,e,t,r){return!t||n.type==="mouseout"?null:r?e:n}class Ay{static defaults=cr;static instances=mx;static overrides=vu;static registry=go;static version=Qoe;static getChart=mL;static register(...e){go.add(...e),pL()}static unregister(...e){go.remove(...e),pL()}constructor(e,t){const r=this.config=new Zoe(t),s=B6(e),a=mL(s);if(a)throw new Error("Canvas is already in use. Chart with ID '"+a.id+"' must be destroyed before the canvas with ID '"+a.canvas.id+"' can be reused.");const o=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||boe(s)),this.platform.updateConfig(r);const l=this.platform.acquireContext(s,o.aspectRatio),c=l&&l.canvas,d=c&&c.height,h=c&&c.width;if(this.id=Jse(),this.ctx=l,this.canvas=c,this.width=h,this.height=d,this._options=o,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Foe,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=gie(p=>this.update(p),o.resizeDelay||0),this._dataChanges=[],mx[this.id]=this,!l||!c){console.error("Failed to create chart: can't acquire context from the given item");return}pl.listen(this,"complete",hL),pl.listen(this,"progress",ele),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:t},width:r,height:s,_aspectRatio:a}=this;return vn(e)?t&&a?a:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return go}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():LR(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return IR(this.canvas,this.ctx),this}stop(){return pl.stop(this),this}resize(e,t){pl.running(this)?this._resizeBeforeDraw={width:e,height:t}:this._resize(e,t)}_resize(e,t){const r=this.options,s=this.canvas,a=r.maintainAspectRatio&&this.aspectRatio,o=this.platform.getMaximumSize(s,e,t,a),l=r.devicePixelRatio||this.platform.getDevicePixelRatio(),c=this.width?"resize":"attach";this.width=o.width,this.height=o.height,this._aspectRatio=this.aspectRatio,LR(this,l,!0)&&(this.notifyPlugins("resize",{size:o}),Bn(r.onResize,[this,o],this),this.attached&&this._doResize(c)&&this.render())}ensureScalesHaveIDs(){const t=this.options.scales||{};jn(t,(r,s)=>{r.id=s})}buildOrUpdateScales(){const e=this.options,t=e.scales,r=this.scales,s=Object.keys(r).reduce((o,l)=>(o[l]=!1,o),{});let a=[];t&&(a=a.concat(Object.keys(t).map(o=>{const l=t[o],c=JS(o,l),d=c==="r",h=c==="x";return{options:l,dposition:d?"chartArea":h?"bottom":"left",dtype:d?"radialLinear":h?"category":"linear"}}))),jn(a,o=>{const l=o.options,c=l.id,d=JS(c,l),h=Yt(l.type,o.dtype);(l.position===void 0||uL(l.position,d)!==uL(o.dposition))&&(l.position=o.dposition),s[c]=!0;let p=null;if(c in r&&r[c].type===h)p=r[c];else{const x=go.getScale(h);p=new x({id:c,type:h,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(l,e)}),jn(s,(o,l)=>{o||delete r[l]}),jn(r,o=>{Fc.configure(this,o,o.options),Fc.addBox(this,o)})}_updateMetasets(){const e=this._metasets,t=this.data.datasets.length,r=e.length;if(e.sort((s,a)=>s.index-a.index),r>t){for(let s=t;s<r;++s)this._destroyDatasetMeta(s);e.splice(t,r-t)}this._sortedMetasets=e.slice(0).sort(fL("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:t}}=this;e.length>t.length&&delete this._stacks,e.forEach((r,s)=>{t.filter(a=>a===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){const e=[],t=this.data.datasets;let r,s;for(this._removeUnreferencedMetasets(),r=0,s=t.length;r<s;r++){const a=t[r];let o=this.getDatasetMeta(r);const l=a.type||this.config.type;if(o.type&&o.type!==l&&(this._destroyDatasetMeta(r),o=this.getDatasetMeta(r)),o.type=l,o.indexAxis=a.indexAxis||KS(l,this.options),o.order=a.order||0,o.index=r,o.label=""+a.label,o.visible=this.isDatasetVisible(r),o.controller)o.controller.updateIndex(r),o.controller.linkScales();else{const c=go.getController(l),{datasetElementType:d,dataElementType:h}=cr.datasets[l];Object.assign(c,{dataElementType:go.getElement(h),datasetElementType:d&&go.getElement(d)}),o.controller=new c(this,r),e.push(o.controller)}}return this._updateMetasets(),e}_resetElements(){jn(this.data.datasets,(e,t)=>{this.getDatasetMeta(t).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const t=this.config;t.update();const r=this._options=t.createResolver(t.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const a=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let o=0;for(let d=0,h=this.data.datasets.length;d<h;d++){const{controller:p}=this.getDatasetMeta(d),x=!s&&a.indexOf(p)===-1;p.buildOrUpdateElements(x),o=Math.max(+p.getMaxOverflow(),o)}o=this._minPadding=r.layout.autoPadding?o:0,this._updateLayout(o),s||jn(a,d=>{d.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(fL("z","_idx"));const{_active:l,_lastEvent:c}=this;c?this._eventHandler(c,!0):l.length&&this._updateHoverStyles(l,l,!0),this.render()}_updateScales(){jn(this.scales,e=>{Fc.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,t=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!NR(t,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,t=this._getUniformDataChanges()||[];for(const{method:r,start:s,count:a}of t){const o=r==="_removeElements"?-a:a;tle(e,s,o)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const t=this.data.datasets.length,r=a=>new Set(e.filter(o=>o[0]===a).map((o,l)=>l+","+o.splice(1).join(","))),s=r(0);for(let a=1;a<t;a++)if(!NR(s,r(a)))return;return Array.from(s).map(a=>a.split(",")).map(a=>({method:a[1],start:+a[2],count:+a[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Fc.update(this,this.width,this.height,e);const t=this.chartArea,r=t.width<=0||t.height<=0;this._layers=[],jn(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,a)=>{s._idx=a}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let t=0,r=this.data.datasets.length;t<r;++t)this.getDatasetMeta(t).controller.configure();for(let t=0,r=this.data.datasets.length;t<r;++t)this._updateDataset(t,Gc(e)?e({datasetIndex:t}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,t){const r=this.getDatasetMeta(e),s={meta:r,index:e,mode:t,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(t),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(pl.has(this)?this.attached&&!pl.running(this)&&pl.start(this):(this.draw(),hL({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const t=this._layers;for(e=0;e<t.length&&t[e].z<=0;++e)t[e].draw(this.chartArea);for(this._drawDatasets();e<t.length;++e)t[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const t=this._sortedMetasets,r=[];let s,a;for(s=0,a=t.length;s<a;++s){const o=t[s];(!e||o.visible)&&r.push(o)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let t=e.length-1;t>=0;--t)this._drawDataset(e[t]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const t=this.ctx,r={meta:e,index:e.index,cancelable:!0},s=M6(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(s&&My(t,s),e.controller.draw(),s&&Ey(t),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return km(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,t,r,s){const a=Xae.modes[t];return typeof a=="function"?a(this,e,r,s):[]}getDatasetMeta(e){const t=this.data.datasets[e],r=this._metasets;let s=r.filter(a=>a&&a._dataset===t).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:t&&t.order||0,index:e,_dataset:t,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=Tu(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const t=this.data.datasets[e];if(!t)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!t.hidden}setDatasetVisibility(e,t){const r=this.getDatasetMeta(e);r.hidden=!t}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,t,r){const s=r?"show":"hide",a=this.getDatasetMeta(e),o=a.controller._resolveAnimations(void 0,s);Sm(t)?(a.data[t].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),o.update(a,{visible:r}),this.update(l=>l.datasetIndex===e?s:void 0))}hide(e,t){this._updateVisibility(e,t,!1)}show(e,t){this._updateVisibility(e,t,!0)}_destroyDatasetMeta(e){const t=this._metasets[e];t&&t.controller&&t.controller._destroy(),delete this._metasets[e]}_stop(){let e,t;for(this.stop(),pl.remove(this),e=0,t=this.data.datasets.length;e<t;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:t}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),IR(e,t),this.platform.releaseContext(t),this.canvas=null,this.ctx=null),delete mx[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,t=this.platform,r=(a,o)=>{t.addEventListener(this,a,o),e[a]=o},s=(a,o,l)=>{a.offsetX=o,a.offsetY=l,this._eventHandler(a)};jn(this.options.events,a=>r(a,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,t=this.platform,r=(c,d)=>{t.addEventListener(this,c,d),e[c]=d},s=(c,d)=>{e[c]&&(t.removeEventListener(this,c,d),delete e[c])},a=(c,d)=>{this.canvas&&this.resize(c,d)};let o;const l=()=>{s("attach",l),this.attached=!0,this.resize(),r("resize",a),r("detach",o)};o=()=>{this.attached=!1,s("resize",a),this._stop(),this._resize(0,0),r("attach",l)},t.isAttached(this.canvas)?l():o()}unbindEvents(){jn(this._listeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._listeners={},jn(this._responsiveListeners,(e,t)=>{this.platform.removeEventListener(this,t,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,t,r){const s=r?"set":"remove";let a,o,l,c;for(t==="dataset"&&(a=this.getDatasetMeta(e[0].datasetIndex),a.controller["_"+s+"DatasetHoverStyle"]()),l=0,c=e.length;l<c;++l){o=e[l];const d=o&&this.getDatasetMeta(o.datasetIndex).controller;d&&d[s+"HoverStyle"](o.element,o.datasetIndex,o.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const t=this._active||[],r=e.map(({datasetIndex:a,index:o})=>{const l=this.getDatasetMeta(a);if(!l)throw new Error("No dataset found at index "+a);return{datasetIndex:a,element:l.data[o],index:o}});!zx(r,t)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,t))}notifyPlugins(e,t,r){return this._plugins.notify(this,e,t,r)}isPluginEnabled(e){return this._plugins._cache.filter(t=>t.plugin.id===e).length===1}_updateHoverStyles(e,t,r){const s=this.options.hover,a=(c,d)=>c.filter(h=>!d.some(p=>h.datasetIndex===p.datasetIndex&&h.index===p.index)),o=a(t,e),l=r?e:a(e,t);o.length&&this.updateHoverStyle(o,s.mode,!1),l.length&&s.mode&&this.updateHoverStyle(l,s.mode,!0)}_eventHandler(e,t){const r={event:e,replay:t,cancelable:!0,inChartArea:this.isPointInArea(e)},s=o=>(o.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;const a=this._handleEvent(e,t,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(a||r.changed)&&this.render(),this}_handleEvent(e,t,r){const{_active:s=[],options:a}=this,o=t,l=this._getActiveElements(e,s,r,o),c=rie(e),d=nle(e,this._lastEvent,r,c);r&&(this._lastEvent=null,Bn(a.onHover,[e,l,this],this),c&&Bn(a.onClick,[e,l,this],this));const h=!zx(l,s);return(h||t)&&(this._active=l,this._updateHoverStyles(l,s,t)),this._lastEvent=d,h}_getActiveElements(e,t,r,s){if(e.type==="mouseout")return[];if(!r)return t;const a=this.options.hover;return this.getElementsAtEventForMode(e,a.mode,a,s)}}function pL(){return jn(Ay.instances,n=>n._plugins.invalidate())}function rle(n,e,t){const{startAngle:r,x:s,y:a,outerRadius:o,innerRadius:l,options:c}=e,{borderWidth:d,borderJoinStyle:h}=c,p=Math.min(d/o,hi(r-t));if(n.beginPath(),n.arc(s,a,o-d/2,r+p/2,t-p/2),l>0){const x=Math.min(d/l,hi(r-t));n.arc(s,a,l+d/2,t-x/2,r+x/2,!0)}else{const x=Math.min(d/2,o*hi(r-t));if(h==="round")n.arc(s,a,x,t-On/2,r+On/2,!0);else if(h==="bevel"){const y=2*x*x,_=-y*Math.cos(t+On/2)+s,w=-y*Math.sin(t+On/2)+a,j=y*Math.cos(r+On/2)+s,C=y*Math.sin(r+On/2)+a;n.lineTo(_,w),n.lineTo(j,C)}}n.closePath(),n.moveTo(0,0),n.rect(0,0,n.canvas.width,n.canvas.height),n.clip("evenodd")}function sle(n,e,t){const{startAngle:r,pixelMargin:s,x:a,y:o,outerRadius:l,innerRadius:c}=e;let d=s/l;n.beginPath(),n.arc(a,o,l,r-d,t+d),c>s?(d=s/c,n.arc(a,o,c,t+d,r-d,!0)):n.arc(a,o,s,t+kr,r-kr),n.closePath(),n.clip()}function ile(n){return pC(n,["outerStart","outerEnd","innerStart","innerEnd"])}function ale(n,e,t,r){const s=ile(n.options.borderRadius),a=(t-e)/2,o=Math.min(a,r*e/2),l=c=>{const d=(t-Math.min(a,c))*r/2;return ds(c,0,Math.min(a,d))};return{outerStart:l(s.outerStart),outerEnd:l(s.outerEnd),innerStart:ds(s.innerStart,0,o),innerEnd:ds(s.innerEnd,0,o)}}function rf(n,e,t,r){return{x:t+n*Math.cos(e),y:r+n*Math.sin(e)}}function Yx(n,e,t,r,s,a){const{x:o,y:l,startAngle:c,pixelMargin:d,innerRadius:h}=e,p=Math.max(e.outerRadius+r+t-d,0),x=h>0?h+r+t+d:0;let y=0;const _=s-c;if(r){const ae=h>0?h-r:0,ee=p>0?p-r:0,me=(ae+ee)/2,$=me!==0?_*me/(me+r):_;y=(_-$)/2}const w=Math.max(.001,_*p-t/On)/p,j=(_-w)/2,C=c+j+y,P=s-j-y,{outerStart:O,outerEnd:M,innerStart:D,innerEnd:I}=ale(e,x,p,P-C),F=p-O,q=p-M,B=C+O/F,U=P-M/q,W=x+D,G=x+I,Z=C+D/W,Y=P-I/G;if(n.beginPath(),a){const ae=(B+U)/2;if(n.arc(o,l,p,B,ae),n.arc(o,l,p,ae,U),M>0){const K=rf(q,U,o,l);n.arc(K.x,K.y,M,U,P+kr)}const ee=rf(G,P,o,l);if(n.lineTo(ee.x,ee.y),I>0){const K=rf(G,Y,o,l);n.arc(K.x,K.y,I,P+kr,Y+Math.PI)}const me=(P-I/x+(C+D/x))/2;if(n.arc(o,l,x,P-I/x,me,!0),n.arc(o,l,x,me,C+D/x,!0),D>0){const K=rf(W,Z,o,l);n.arc(K.x,K.y,D,Z+Math.PI,C-kr)}const $=rf(F,C,o,l);if(n.lineTo($.x,$.y),O>0){const K=rf(F,B,o,l);n.arc(K.x,K.y,O,C-kr,B)}}else{n.moveTo(o,l);const ae=Math.cos(B)*p+o,ee=Math.sin(B)*p+l;n.lineTo(ae,ee);const me=Math.cos(U)*p+o,$=Math.sin(U)*p+l;n.lineTo(me,$)}n.closePath()}function ole(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l}=e;let c=e.endAngle;if(a){Yx(n,e,t,r,c,s);for(let d=0;d<a;++d)n.fill();isNaN(l)||(c=o+(l%er||er))}return Yx(n,e,t,r,c,s),n.fill(),c}function lle(n,e,t,r,s){const{fullCircles:a,startAngle:o,circumference:l,options:c}=e,{borderWidth:d,borderJoinStyle:h,borderDash:p,borderDashOffset:x,borderRadius:y}=c,_=c.borderAlign==="inner";if(!d)return;n.setLineDash(p||[]),n.lineDashOffset=x,_?(n.lineWidth=d*2,n.lineJoin=h||"round"):(n.lineWidth=d,n.lineJoin=h||"bevel");let w=e.endAngle;if(a){Yx(n,e,t,r,w,s);for(let j=0;j<a;++j)n.stroke();isNaN(l)||(w=o+(l%er||er))}_&&sle(n,e,w),c.selfJoin&&w-o>=On&&y===0&&h!=="miter"&&rle(n,e,w),a||(Yx(n,e,t,r,w,s),n.stroke())}class cle extends dd{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(e){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.getProps(["x","y"],r),{angle:a,distance:o}=u6(s,{x:e,y:t}),{startAngle:l,endAngle:c,innerRadius:d,outerRadius:h,circumference:p}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],r),x=(this.options.spacing+this.options.borderWidth)/2,y=Yt(p,c-l),_=Tm(a,l,c)&&l!==c,w=y>=er||_,j=_l(o,d+x,h+x);return w&&j}getCenterPoint(e){const{x:t,y:r,startAngle:s,endAngle:a,innerRadius:o,outerRadius:l}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],e),{offset:c,spacing:d}=this.options,h=(s+a)/2,p=(o+l+d+c)/2;return{x:t+Math.cos(h)*p,y:r+Math.sin(h)*p}}tooltipPosition(e){return this.getCenterPoint(e)}draw(e){const{options:t,circumference:r}=this,s=(t.offset||0)/4,a=(t.spacing||0)/2,o=t.circular;if(this.pixelMargin=t.borderAlign==="inner"?.33:0,this.fullCircles=r>er?Math.floor(r/er):0,r===0||this.innerRadius<0||this.outerRadius<0)return;e.save();const l=(this.startAngle+this.endAngle)/2;e.translate(Math.cos(l)*s,Math.sin(l)*s);const c=1-Math.sin(Math.min(On,r||0)),d=s*c;e.fillStyle=t.backgroundColor,e.strokeStyle=t.borderColor,ole(e,this,d,a,o),lle(e,this,d,a,o),e.restore()}}function V6(n,e,t=e){n.lineCap=Yt(t.borderCapStyle,e.borderCapStyle),n.setLineDash(Yt(t.borderDash,e.borderDash)),n.lineDashOffset=Yt(t.borderDashOffset,e.borderDashOffset),n.lineJoin=Yt(t.borderJoinStyle,e.borderJoinStyle),n.lineWidth=Yt(t.borderWidth,e.borderWidth),n.strokeStyle=Yt(t.borderColor,e.borderColor)}function dle(n,e,t){n.lineTo(t.x,t.y)}function ule(n){return n.stepped?Mie:n.tension||n.cubicInterpolationMode==="monotone"?Eie:dle}function W6(n,e,t={}){const r=n.length,{start:s=0,end:a=r-1}=t,{start:o,end:l}=e,c=Math.max(s,o),d=Math.min(a,l),h=s<o&&a<o||s>l&&a>l;return{count:r,start:c,loop:e.loop,ilen:d<c&&!h?r+d-c:d-c}}function fle(n,e,t,r){const{points:s,options:a}=e,{count:o,start:l,loop:c,ilen:d}=W6(s,t,r),h=ule(a);let{move:p=!0,reverse:x}=r||{},y,_,w;for(y=0;y<=d;++y)_=s[(l+(x?d-y:y))%o],!_.skip&&(p?(n.moveTo(_.x,_.y),p=!1):h(n,w,_,x,a.stepped),w=_);return c&&(_=s[(l+(x?d:0))%o],h(n,w,_,x,a.stepped)),!!c}function hle(n,e,t,r){const s=e.points,{count:a,start:o,ilen:l}=W6(s,t,r),{move:c=!0,reverse:d}=r||{};let h=0,p=0,x,y,_,w,j,C;const P=M=>(o+(d?l-M:M))%a,O=()=>{w!==j&&(n.lineTo(h,j),n.lineTo(h,w),n.lineTo(h,C))};for(c&&(y=s[P(0)],n.moveTo(y.x,y.y)),x=0;x<=l;++x){if(y=s[P(x)],y.skip)continue;const M=y.x,D=y.y,I=M|0;I===_?(D<w?w=D:D>j&&(j=D),h=(p*h+M)/++p):(O(),n.lineTo(M,D),_=I,p=0,w=j=D),C=D}O()}function QS(n){const e=n.options,t=e.borderDash&&e.borderDash.length;return!n._decimated&&!n._loop&&!e.tension&&e.cubicInterpolationMode!=="monotone"&&!e.stepped&&!t?hle:fle}function mle(n){return n.stepped?cae:n.tension||n.cubicInterpolationMode==="monotone"?dae:nu}function ple(n,e,t,r){let s=e._path;s||(s=e._path=new Path2D,e.path(s,t,r)&&s.closePath()),V6(n,e.options),n.stroke(s)}function gle(n,e,t,r){const{segments:s,options:a}=e,o=QS(e);for(const l of s)V6(n,a,l.style),n.beginPath(),o(n,e,l,{start:t,end:t+r-1})&&n.closePath(),n.stroke()}const xle=typeof Path2D=="function";function yle(n,e,t,r){xle&&!e.options.segment?ple(n,e,t,r):gle(n,e,t,r)}class Ry extends dd{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,t){const r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){const s=r.spanGaps?this._loop:this._fullLoop;tae(this._points,r,e,s,t),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=gae(this,this.options.segment))}first(){const e=this.segments,t=this.points;return e.length&&t[e[0].start]}last(){const e=this.segments,t=this.points,r=e.length;return r&&t[e[r-1].end]}interpolate(e,t){const r=this.options,s=e[t],a=this.points,o=P6(this,{property:t,start:s,end:s});if(!o.length)return;const l=[],c=mle(r);let d,h;for(d=0,h=o.length;d<h;++d){const{start:p,end:x}=o[d],y=a[p],_=a[x];if(y===_){l.push(y);continue}const w=Math.abs((s-y[t])/(_[t]-y[t])),j=c(y,_,w,r.stepped);j[t]=e[t],l.push(j)}return l.length===1?l[0]:l}pathSegment(e,t,r){return QS(this)(e,this,t,r)}path(e,t,r){const s=this.segments,a=QS(this);let o=this._loop;t=t||0,r=r||this.points.length-t;for(const l of s)o&=a(e,this,l,{start:t,end:t+r-1});return!!o}draw(e,t,r,s){const a=this.options||{};(this.points||[]).length&&a.borderWidth&&(e.save(),yle(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}function gL(n,e,t,r){const s=n.options,{[t]:a}=n.getProps([t],r);return Math.abs(e-a)<s.radius+s.hitRadius}class vle extends dd{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,t,r){const s=this.options,{x:a,y:o}=this.getProps(["x","y"],r);return Math.pow(e-a,2)+Math.pow(t-o,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,t){return gL(this,e,"x",t)}inYRange(e,t){return gL(this,e,"y",t)}getCenterPoint(e){const{x:t,y:r}=this.getProps(["x","y"],e);return{x:t,y:r}}size(e){e=e||this.options||{};let t=e.radius||0;t=Math.max(t,t&&e.hoverRadius||0);const r=t&&e.borderWidth||0;return(t+r)*2}draw(e,t){const r=this.options;this.skip||r.radius<.1||!km(this,t,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,ZS(e,r,this.x,this.y))}getRange(){const e=this.options||{};return e.radius+e.hitRadius}}function $6(n,e){const{x:t,y:r,base:s,width:a,height:o}=n.getProps(["x","y","base","width","height"],e);let l,c,d,h,p;return n.horizontal?(p=o/2,l=Math.min(t,s),c=Math.max(t,s),d=r-p,h=r+p):(p=a/2,l=t-p,c=t+p,d=Math.min(r,s),h=Math.max(r,s)),{left:l,top:d,right:c,bottom:h}}function qc(n,e,t,r){return n?0:ds(e,t,r)}function ble(n,e,t){const r=n.options.borderWidth,s=n.borderSkipped,a=v6(r);return{t:qc(s.top,a.top,0,t),r:qc(s.right,a.right,0,e),b:qc(s.bottom,a.bottom,0,t),l:qc(s.left,a.left,0,e)}}function wle(n,e,t){const{enableBorderRadius:r}=n.getProps(["enableBorderRadius"]),s=n.options.borderRadius,a=vf(s),o=Math.min(e,t),l=n.borderSkipped,c=r||nn(s);return{topLeft:qc(!c||l.top||l.left,a.topLeft,0,o),topRight:qc(!c||l.top||l.right,a.topRight,0,o),bottomLeft:qc(!c||l.bottom||l.left,a.bottomLeft,0,o),bottomRight:qc(!c||l.bottom||l.right,a.bottomRight,0,o)}}function _le(n){const e=$6(n),t=e.right-e.left,r=e.bottom-e.top,s=ble(n,t/2,r/2),a=wle(n,t/2,r/2);return{outer:{x:e.left,y:e.top,w:t,h:r,radius:a},inner:{x:e.left+s.l,y:e.top+s.t,w:t-s.l-s.r,h:r-s.t-s.b,radius:{topLeft:Math.max(0,a.topLeft-Math.max(s.t,s.l)),topRight:Math.max(0,a.topRight-Math.max(s.t,s.r)),bottomLeft:Math.max(0,a.bottomLeft-Math.max(s.b,s.l)),bottomRight:Math.max(0,a.bottomRight-Math.max(s.b,s.r))}}}}function IN(n,e,t,r){const s=e===null,a=t===null,l=n&&!(s&&a)&&$6(n,r);return l&&(s||_l(e,l.left,l.right))&&(a||_l(t,l.top,l.bottom))}function jle(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function Nle(n,e){n.rect(e.x,e.y,e.w,e.h)}function AN(n,e,t={}){const r=n.x!==t.x?-e:0,s=n.y!==t.y?-e:0,a=(n.x+n.w!==t.x+t.w?e:0)-r,o=(n.y+n.h!==t.y+t.h?e:0)-s;return{x:n.x+r,y:n.y+s,w:n.w+a,h:n.h+o,radius:n.radius}}class Sle extends dd{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:t,options:{borderColor:r,backgroundColor:s}}=this,{inner:a,outer:o}=_le(this),l=jle(o.radius)?Wx:Nle;e.save(),(o.w!==a.w||o.h!==a.h)&&(e.beginPath(),l(e,AN(o,t,a)),e.clip(),l(e,AN(a,-t,o)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),l(e,AN(a,t)),e.fillStyle=s,e.fill(),e.restore()}inRange(e,t,r){return IN(this,e,t,r)}inXRange(e,t){return IN(this,e,null,t)}inYRange(e,t){return IN(this,null,e,t)}getCenterPoint(e){const{x:t,y:r,base:s,horizontal:a}=this.getProps(["x","y","base","horizontal"],e);return{x:a?(t+s)/2:t,y:a?r:(r+s)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}function Cle(n,e,t){const r=n.segments,s=n.points,a=e.points,o=[];for(const l of r){let{start:c,end:d}=l;d=Ly(c,d,s);const h=XS(t,s[c],s[d],l.loop);if(!e.segments){o.push({source:l,target:h,start:s[c],end:s[d]});continue}const p=P6(e,h);for(const x of p){const y=XS(t,a[x.start],a[x.end],x.loop),_=k6(l,s,y);for(const w of _)o.push({source:w,target:x,start:{[t]:xL(h,y,"start",Math.max)},end:{[t]:xL(h,y,"end",Math.min)}})}}return o}function XS(n,e,t,r){if(r)return;let s=e[n],a=t[n];return n==="angle"&&(s=hi(s),a=hi(a)),{property:n,start:s,end:a}}function Tle(n,e){const{x:t=null,y:r=null}=n||{},s=e.points,a=[];return e.segments.forEach(({start:o,end:l})=>{l=Ly(o,l,s);const c=s[o],d=s[l];r!==null?(a.push({x:c.x,y:r}),a.push({x:d.x,y:r})):t!==null&&(a.push({x:t,y:c.y}),a.push({x:t,y:d.y}))}),a}function Ly(n,e,t){for(;e>n;e--){const r=t[e];if(!isNaN(r.x)&&!isNaN(r.y))break}return e}function xL(n,e,t,r){return n&&e?r(n[t],e[t]):n?n[t]:e?e[t]:0}function H6(n,e){let t=[],r=!1;return Tr(n)?(r=!0,t=n):t=Tle(n,e),t.length?new Ry({points:t,options:{tension:0},_loop:r,_fullLoop:r}):null}function yL(n){return n&&n.fill!==!1}function kle(n,e,t){let s=n[e].fill;const a=[e];let o;if(!t)return s;for(;s!==!1&&a.indexOf(s)===-1;){if(!fs(s))return s;if(o=n[s],!o)return!1;if(o.visible)return s;a.push(s),s=o.fill}return!1}function Ple(n,e,t){const r=Ole(n);if(nn(r))return isNaN(r.value)?!1:r;let s=parseFloat(r);return fs(s)&&Math.floor(s)===s?Mle(r[0],e,s,t):["origin","start","end","stack","shape"].indexOf(r)>=0&&r}function Mle(n,e,t,r){return(n==="-"||n==="+")&&(t=e+t),t===e||t<0||t>=r?!1:t}function Ele(n,e){let t=null;return n==="start"?t=e.bottom:n==="end"?t=e.top:nn(n)?t=e.getPixelForValue(n.value):e.getBasePixel&&(t=e.getBasePixel()),t}function Dle(n,e,t){let r;return n==="start"?r=t:n==="end"?r=e.options.reverse?e.min:e.max:nn(n)?r=n.value:r=e.getBaseValue(),r}function Ole(n){const e=n.options,t=e.fill;let r=Yt(t&&t.target,t);return r===void 0&&(r=!!e.backgroundColor),r===!1||r===null?!1:r===!0?"origin":r}function Ile(n){const{scale:e,index:t,line:r}=n,s=[],a=r.segments,o=r.points,l=Ale(e,t);l.push(H6({x:null,y:e.bottom},r));for(let c=0;c<a.length;c++){const d=a[c];for(let h=d.start;h<=d.end;h++)Rle(s,o[h],l)}return new Ry({points:s,options:{}})}function Ale(n,e){const t=[],r=n.getMatchingVisibleMetas("line");for(let s=0;s<r.length;s++){const a=r[s];if(a.index===e)break;a.hidden||t.unshift(a.dataset)}return t}function Rle(n,e,t){const r=[];for(let s=0;s<t.length;s++){const a=t[s],{first:o,last:l,point:c}=Lle(a,e,"x");if(!(!c||o&&l)){if(o)r.unshift(c);else if(n.push(c),!l)break}}n.push(...r)}function Lle(n,e,t){const r=n.interpolate(e,t);if(!r)return{};const s=r[t],a=n.segments,o=n.points;let l=!1,c=!1;for(let d=0;d<a.length;d++){const h=a[d],p=o[h.start][t],x=o[h.end][t];if(_l(s,p,x)){l=s===p,c=s===x;break}}return{first:l,last:c,point:r}}class Y6{constructor(e){this.x=e.x,this.y=e.y,this.radius=e.radius}pathSegment(e,t,r){const{x:s,y:a,radius:o}=this;return t=t||{start:0,end:er},e.arc(s,a,o,t.end,t.start,!0),!r.bounds}interpolate(e){const{x:t,y:r,radius:s}=this,a=e.angle;return{x:t+Math.cos(a)*s,y:r+Math.sin(a)*s,angle:a}}}function Fle(n){const{chart:e,fill:t,line:r}=n;if(fs(t))return qle(e,t);if(t==="stack")return Ile(n);if(t==="shape")return!0;const s=zle(n);return s instanceof Y6?s:H6(s,r)}function qle(n,e){const t=n.getDatasetMeta(e);return t&&n.isDatasetVisible(e)?t.dataset:null}function zle(n){return(n.scale||{}).getPointPositionForValue?Ble(n):Ule(n)}function Ule(n){const{scale:e={},fill:t}=n,r=Ele(t,e);if(fs(r)){const s=e.isHorizontal();return{x:s?r:null,y:s?null:r}}return null}function Ble(n){const{scale:e,fill:t}=n,r=e.options,s=e.getLabels().length,a=r.reverse?e.max:e.min,o=Dle(t,e,a),l=[];if(r.grid.circular){const c=e.getPointPositionForValue(0,a);return new Y6({x:c.x,y:c.y,radius:e.getDistanceFromCenterForValue(o)})}for(let c=0;c<s;++c)l.push(e.getPointPositionForValue(c,o));return l}function RN(n,e,t){const r=Fle(e),{chart:s,index:a,line:o,scale:l,axis:c}=e,d=o.options,h=d.fill,p=d.backgroundColor,{above:x=p,below:y=p}=h||{},_=s.getDatasetMeta(a),w=M6(s,_);r&&o.points.length&&(My(n,t),Vle(n,{line:o,target:r,above:x,below:y,area:t,scale:l,axis:c,clip:w}),Ey(n))}function Vle(n,e){const{line:t,target:r,above:s,below:a,area:o,scale:l,clip:c}=e,d=t._loop?"angle":e.axis;n.save();let h=a;a!==s&&(d==="x"?(vL(n,r,o.top),LN(n,{line:t,target:r,color:s,scale:l,property:d,clip:c}),n.restore(),n.save(),vL(n,r,o.bottom)):d==="y"&&(bL(n,r,o.left),LN(n,{line:t,target:r,color:a,scale:l,property:d,clip:c}),n.restore(),n.save(),bL(n,r,o.right),h=s)),LN(n,{line:t,target:r,color:h,scale:l,property:d,clip:c}),n.restore()}function vL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[Ly(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(h.x,t),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(p.x,t)}n.lineTo(e.first().x,t),n.closePath(),n.clip()}function bL(n,e,t){const{segments:r,points:s}=e;let a=!0,o=!1;n.beginPath();for(const l of r){const{start:c,end:d}=l,h=s[c],p=s[Ly(c,d,s)];a?(n.moveTo(h.x,h.y),a=!1):(n.lineTo(t,h.y),n.lineTo(h.x,h.y)),o=!!e.pathSegment(n,l,{move:o}),o?n.closePath():n.lineTo(t,p.y)}n.lineTo(t,e.first().y),n.closePath(),n.clip()}function LN(n,e){const{line:t,target:r,property:s,color:a,scale:o,clip:l}=e,c=Cle(t,r,s);for(const{source:d,target:h,start:p,end:x}of c){const{style:{backgroundColor:y=a}={}}=d,_=r!==!0;n.save(),n.fillStyle=y,Wle(n,o,l,_&&XS(s,p,x)),n.beginPath();const w=!!t.pathSegment(n,d);let j;if(_){w?n.closePath():wL(n,r,x,s);const C=!!r.pathSegment(n,h,{move:w,reverse:!0});j=w&&C,j||wL(n,r,p,s)}n.closePath(),n.fill(j?"evenodd":"nonzero"),n.restore()}}function Wle(n,e,t,r){const s=e.chart.chartArea,{property:a,start:o,end:l}=r||{};if(a==="x"||a==="y"){let c,d,h,p;a==="x"?(c=o,d=s.top,h=l,p=s.bottom):(c=s.left,d=o,h=s.right,p=l),n.beginPath(),t&&(c=Math.max(c,t.left),h=Math.min(h,t.right),d=Math.max(d,t.top),p=Math.min(p,t.bottom)),n.rect(c,d,h-c,p-d),n.clip()}}function wL(n,e,t,r){const s=e.interpolate(t,r);s&&n.lineTo(s.x,s.y)}var $le={id:"filler",afterDatasetsUpdate(n,e,t){const r=(n.data.datasets||[]).length,s=[];let a,o,l,c;for(o=0;o<r;++o)a=n.getDatasetMeta(o),l=a.dataset,c=null,l&&l.options&&l instanceof Ry&&(c={visible:n.isDatasetVisible(o),index:o,fill:Ple(l,o,r),chart:n,axis:a.controller.options.indexAxis,scale:a.vScale,line:l}),a.$filler=c,s.push(c);for(o=0;o<r;++o)c=s[o],!(!c||c.fill===!1)&&(c.fill=kle(s,o,t.propagate))},beforeDraw(n,e,t){const r=t.drawTime==="beforeDraw",s=n.getSortedVisibleDatasetMetas(),a=n.chartArea;for(let o=s.length-1;o>=0;--o){const l=s[o].$filler;l&&(l.line.updateControlPoints(a,l.axis),r&&l.fill&&RN(n.ctx,l,a))}},beforeDatasetsDraw(n,e,t){if(t.drawTime!=="beforeDatasetsDraw")return;const r=n.getSortedVisibleDatasetMetas();for(let s=r.length-1;s>=0;--s){const a=r[s].$filler;yL(a)&&RN(n.ctx,a,n.chartArea)}},beforeDatasetDraw(n,e,t){const r=e.meta.$filler;!yL(r)||t.drawTime!=="beforeDatasetDraw"||RN(n.ctx,r,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}};const _L=(n,e)=>{let{boxHeight:t=e,boxWidth:r=e}=n;return n.usePointStyle&&(t=Math.min(t,e),r=n.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:t,itemHeight:Math.max(e,t)}},Hle=(n,e)=>n!==null&&e!==null&&n.datasetIndex===e.datasetIndex&&n.index===e.index;class jL extends dd{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,t,r){this.maxWidth=e,this.maxHeight=t,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let t=Bn(e.generateLabels,[this.chart],this)||[];e.filter&&(t=t.filter(r=>e.filter(r,this.chart.data))),e.sort&&(t=t.sort((r,s)=>e.sort(r,s,this.chart.data))),this.options.reverse&&t.reverse(),this.legendItems=t}fit(){const{options:e,ctx:t}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,s=Gs(r.font),a=s.size,o=this._computeTitleHeight(),{boxWidth:l,itemHeight:c}=_L(r,a);let d,h;t.font=s.string,this.isHorizontal()?(d=this.maxWidth,h=this._fitRows(o,a,l,c)+10):(h=this.maxHeight,d=this._fitCols(o,s,l,c)+10),this.width=Math.min(d,e.maxWidth||this.maxWidth),this.height=Math.min(h,e.maxHeight||this.maxHeight)}_fitRows(e,t,r,s){const{ctx:a,maxWidth:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.lineWidths=[0],h=s+l;let p=e;a.textAlign="left",a.textBaseline="middle";let x=-1,y=-h;return this.legendItems.forEach((_,w)=>{const j=r+t/2+a.measureText(_.text).width;(w===0||d[d.length-1]+j+2*l>o)&&(p+=h,d[d.length-(w>0?0:1)]=0,y+=h,x++),c[w]={left:0,top:y,row:x,width:j,height:s},d[d.length-1]+=j+l}),p}_fitCols(e,t,r,s){const{ctx:a,maxHeight:o,options:{labels:{padding:l}}}=this,c=this.legendHitBoxes=[],d=this.columnSizes=[],h=o-e;let p=l,x=0,y=0,_=0,w=0;return this.legendItems.forEach((j,C)=>{const{itemWidth:P,itemHeight:O}=Yle(r,t,a,j,s);C>0&&y+O+2*l>h&&(p+=x+l,d.push({width:x,height:y}),_+=x+l,w++,x=y=0),c[C]={left:_,top:y,col:w,width:P,height:O},x=Math.max(x,P),y+=O+l}),p+=x,d.push({width:x,height:y}),p}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:t,options:{align:r,labels:{padding:s},rtl:a}}=this,o=bf(a,this.left,this.width);if(this.isHorizontal()){let l=0,c=ui(r,this.left+s,this.right-this.lineWidths[l]);for(const d of t)l!==d.row&&(l=d.row,c=ui(r,this.left+s,this.right-this.lineWidths[l])),d.top+=this.top+e+s,d.left=o.leftForLtr(o.x(c),d.width),c+=d.width+s}else{let l=0,c=ui(r,this.top+e+s,this.bottom-this.columnSizes[l].height);for(const d of t)d.col!==l&&(l=d.col,c=ui(r,this.top+e+s,this.bottom-this.columnSizes[l].height)),d.top=c,d.left+=this.left+s,d.left=o.leftForLtr(o.x(d.left),d.width),c+=d.height+s}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;My(e,this),this._draw(),Ey(e)}}_draw(){const{options:e,columnSizes:t,lineWidths:r,ctx:s}=this,{align:a,labels:o}=e,l=cr.color,c=bf(e.rtl,this.left,this.width),d=Gs(o.font),{padding:h}=o,p=d.size,x=p/2;let y;this.drawTitle(),s.textAlign=c.textAlign("left"),s.textBaseline="middle",s.lineWidth=.5,s.font=d.string;const{boxWidth:_,boxHeight:w,itemHeight:j}=_L(o,p),C=function(I,F,q){if(isNaN(_)||_<=0||isNaN(w)||w<0)return;s.save();const B=Yt(q.lineWidth,1);if(s.fillStyle=Yt(q.fillStyle,l),s.lineCap=Yt(q.lineCap,"butt"),s.lineDashOffset=Yt(q.lineDashOffset,0),s.lineJoin=Yt(q.lineJoin,"miter"),s.lineWidth=B,s.strokeStyle=Yt(q.strokeStyle,l),s.setLineDash(Yt(q.lineDash,[])),o.usePointStyle){const U={radius:w*Math.SQRT2/2,pointStyle:q.pointStyle,rotation:q.rotation,borderWidth:B},W=c.xPlus(I,_/2),G=F+x;y6(s,U,W,G,o.pointStyleWidth&&_)}else{const U=F+Math.max((p-w)/2,0),W=c.leftForLtr(I,_),G=vf(q.borderRadius);s.beginPath(),Object.values(G).some(Z=>Z!==0)?Wx(s,{x:W,y:U,w:_,h:w,radius:G}):s.rect(W,U,_,w),s.fill(),B!==0&&s.stroke()}s.restore()},P=function(I,F,q){Vx(s,q.text,I,F+j/2,d,{strikethrough:q.hidden,textAlign:c.textAlign(q.textAlign)})},O=this.isHorizontal(),M=this._computeTitleHeight();O?y={x:ui(a,this.left+h,this.right-r[0]),y:this.top+h+M,line:0}:y={x:this.left+h,y:ui(a,this.top+M+h,this.bottom-t[0].height),line:0},S6(this.ctx,e.textDirection);const D=j+h;this.legendItems.forEach((I,F)=>{s.strokeStyle=I.fontColor,s.fillStyle=I.fontColor;const q=s.measureText(I.text).width,B=c.textAlign(I.textAlign||(I.textAlign=o.textAlign)),U=_+x+q;let W=y.x,G=y.y;c.setWidth(this.width),O?F>0&&W+U+h>this.right&&(G=y.y+=D,y.line++,W=y.x=ui(a,this.left+h,this.right-r[y.line])):F>0&&G+D>this.bottom&&(W=y.x=W+t[y.line].width+h,y.line++,G=y.y=ui(a,this.top+M+h,this.bottom-t[y.line].height));const Z=c.x(W);if(C(Z,G,I),W=xie(B,W+_+x,O?W+U:this.right,e.rtl),P(c.x(W),G,I),O)y.x+=U+h;else if(typeof I.text!="string"){const Y=d.lineHeight;y.y+=G6(I,Y)+h}else y.y+=D}),C6(this.ctx,e.textDirection)}drawTitle(){const e=this.options,t=e.title,r=Gs(t.font),s=La(t.padding);if(!t.display)return;const a=bf(e.rtl,this.left,this.width),o=this.ctx,l=t.position,c=r.size/2,d=s.top+c;let h,p=this.left,x=this.width;if(this.isHorizontal())x=Math.max(...this.lineWidths),h=this.top+d,p=ui(e.align,p,this.right-x);else{const _=this.columnSizes.reduce((w,j)=>Math.max(w,j.height),0);h=d+ui(e.align,this.top,this.bottom-_-e.labels.padding-this._computeTitleHeight())}const y=ui(l,p,p+x);o.textAlign=a.textAlign(g6(l)),o.textBaseline="middle",o.strokeStyle=t.color,o.fillStyle=t.color,o.font=r.string,Vx(o,t.text,y,h,r)}_computeTitleHeight(){const e=this.options.title,t=Gs(e.font),r=La(e.padding);return e.display?t.lineHeight+r.height:0}_getLegendItemAt(e,t){let r,s,a;if(_l(e,this.left,this.right)&&_l(t,this.top,this.bottom)){for(a=this.legendHitBoxes,r=0;r<a.length;++r)if(s=a[r],_l(e,s.left,s.left+s.width)&&_l(t,s.top,s.top+s.height))return this.legendItems[r]}return null}handleEvent(e){const t=this.options;if(!Kle(e.type,t))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const s=this._hoveredItem,a=Hle(s,r);s&&!a&&Bn(t.onLeave,[e,s,this],this),this._hoveredItem=r,r&&!a&&Bn(t.onHover,[e,r,this],this)}else r&&Bn(t.onClick,[e,r,this],this)}}function Yle(n,e,t,r,s){const a=Gle(r,n,e,t),o=Zle(s,r,e.lineHeight);return{itemWidth:a,itemHeight:o}}function Gle(n,e,t,r){let s=n.text;return s&&typeof s!="string"&&(s=s.reduce((a,o)=>a.length>o.length?a:o)),e+t.size/2+r.measureText(s).width}function Zle(n,e,t){let r=n;return typeof e.text!="string"&&(r=G6(e,t)),r}function G6(n,e){const t=n.text?n.text.length:0;return e*t}function Kle(n,e){return!!((n==="mousemove"||n==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(n==="click"||n==="mouseup"))}var Jle={id:"legend",_element:jL,start(n,e,t){const r=n.legend=new jL({ctx:n.ctx,options:t,chart:n});Fc.configure(n,r,t),Fc.addBox(n,r)},stop(n){Fc.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,e,t){const r=n.legend;Fc.configure(n,r,t),r.options=t},afterUpdate(n){const e=n.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(n,e){e.replay||n.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,e,t){const r=e.datasetIndex,s=t.chart;s.isDatasetVisible(r)?(s.hide(r),e.hidden=!0):(s.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){const e=n.data.datasets,{labels:{usePointStyle:t,pointStyle:r,textAlign:s,color:a,useBorderRadius:o,borderRadius:l}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{const d=c.controller.getStyle(t?0:void 0),h=La(d.borderWidth);return{text:e[c.index].label,fillStyle:d.backgroundColor,fontColor:a,hidden:!c.visible,lineCap:d.borderCapStyle,lineDash:d.borderDash,lineDashOffset:d.borderDashOffset,lineJoin:d.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:d.borderColor,pointStyle:r||d.pointStyle,rotation:d.rotation,textAlign:s||d.textAlign,borderRadius:o&&(l||d.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}};const Zh={average(n){if(!n.length)return!1;let e,t,r=new Set,s=0,a=0;for(e=0,t=n.length;e<t;++e){const l=n[e].element;if(l&&l.hasValue()){const c=l.tooltipPosition();r.add(c.x),s+=c.y,++a}}return a===0||r.size===0?!1:{x:[...r].reduce((l,c)=>l+c)/r.size,y:s/a}},nearest(n,e){if(!n.length)return!1;let t=e.x,r=e.y,s=Number.POSITIVE_INFINITY,a,o,l;for(a=0,o=n.length;a<o;++a){const c=n[a].element;if(c&&c.hasValue()){const d=c.getCenterPoint(),h=YS(e,d);h<s&&(s=h,l=c)}}if(l){const c=l.tooltipPosition();t=c.x,r=c.y}return{x:t,y:r}}};function po(n,e){return e&&(Tr(e)?Array.prototype.push.apply(n,e):n.push(e)),n}function gl(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function Qle(n,e){const{element:t,datasetIndex:r,index:s}=e,a=n.getDatasetMeta(r).controller,{label:o,value:l}=a.getLabelAndValue(s);return{chart:n,label:o,parsed:a.getParsed(s),raw:n.data.datasets[r].data[s],formattedValue:l,dataset:a.getDataset(),dataIndex:s,datasetIndex:r,element:t}}function NL(n,e){const t=n.chart.ctx,{body:r,footer:s,title:a}=n,{boxWidth:o,boxHeight:l}=e,c=Gs(e.bodyFont),d=Gs(e.titleFont),h=Gs(e.footerFont),p=a.length,x=s.length,y=r.length,_=La(e.padding);let w=_.height,j=0,C=r.reduce((M,D)=>M+D.before.length+D.lines.length+D.after.length,0);if(C+=n.beforeBody.length+n.afterBody.length,p&&(w+=p*d.lineHeight+(p-1)*e.titleSpacing+e.titleMarginBottom),C){const M=e.displayColors?Math.max(l,c.lineHeight):c.lineHeight;w+=y*M+(C-y)*c.lineHeight+(C-1)*e.bodySpacing}x&&(w+=e.footerMarginTop+x*h.lineHeight+(x-1)*e.footerSpacing);let P=0;const O=function(M){j=Math.max(j,t.measureText(M).width+P)};return t.save(),t.font=d.string,jn(n.title,O),t.font=c.string,jn(n.beforeBody.concat(n.afterBody),O),P=e.displayColors?o+2+e.boxPadding:0,jn(r,M=>{jn(M.before,O),jn(M.lines,O),jn(M.after,O)}),P=0,t.font=h.string,jn(n.footer,O),t.restore(),j+=_.width,{width:j,height:w}}function Xle(n,e){const{y:t,height:r}=e;return t<r/2?"top":t>n.height-r/2?"bottom":"center"}function ece(n,e,t,r){const{x:s,width:a}=r,o=t.caretSize+t.caretPadding;if(n==="left"&&s+a+o>e.width||n==="right"&&s-a-o<0)return!0}function tce(n,e,t,r){const{x:s,width:a}=t,{width:o,chartArea:{left:l,right:c}}=n;let d="center";return r==="center"?d=s<=(l+c)/2?"left":"right":s<=a/2?d="left":s>=o-a/2&&(d="right"),ece(d,n,e,t)&&(d="center"),d}function SL(n,e,t){const r=t.yAlign||e.yAlign||Xle(n,t);return{xAlign:t.xAlign||e.xAlign||tce(n,e,t,r),yAlign:r}}function nce(n,e){let{x:t,width:r}=n;return e==="right"?t-=r:e==="center"&&(t-=r/2),t}function rce(n,e,t){let{y:r,height:s}=n;return e==="top"?r+=t:e==="bottom"?r-=s+t:r-=s/2,r}function CL(n,e,t,r){const{caretSize:s,caretPadding:a,cornerRadius:o}=n,{xAlign:l,yAlign:c}=t,d=s+a,{topLeft:h,topRight:p,bottomLeft:x,bottomRight:y}=vf(o);let _=nce(e,l);const w=rce(e,c,d);return c==="center"?l==="left"?_+=d:l==="right"&&(_-=d):l==="left"?_-=Math.max(h,x)+s:l==="right"&&(_+=Math.max(p,y)+s),{x:ds(_,0,r.width-e.width),y:ds(w,0,r.height-e.height)}}function Kg(n,e,t){const r=La(t.padding);return e==="center"?n.x+n.width/2:e==="right"?n.x+n.width-r.right:n.x+r.left}function TL(n){return po([],gl(n))}function sce(n,e,t){return Tu(n,{tooltip:e,tooltipItems:t,type:"tooltip"})}function kL(n,e){const t=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return t?n.override(t):n}const Z6={beforeTitle:hl,title(n){if(n.length>0){const e=n[0],t=e.chart.data.labels,r=t?t.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return t[e.dataIndex]}return""},afterTitle:hl,beforeBody:hl,beforeLabel:hl,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let e=n.dataset.label||"";e&&(e+=": ");const t=n.formattedValue;return vn(t)||(e+=t),e},labelColor(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:t.borderColor,backgroundColor:t.backgroundColor,borderWidth:t.borderWidth,borderDash:t.borderDash,borderDashOffset:t.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){const t=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:t.pointStyle,rotation:t.rotation}},afterLabel:hl,afterBody:hl,beforeFooter:hl,footer:hl,afterFooter:hl};function Bs(n,e,t,r){const s=n[e].call(t,r);return typeof s>"u"?Z6[e].call(t,r):s}class PL extends dd{static positioners=Zh;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const t=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&t.options.animation&&r.animations,a=new E6(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(a)),a}getContext(){return this.$context||(this.$context=sce(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,t){const{callbacks:r}=t,s=Bs(r,"beforeTitle",this,e),a=Bs(r,"title",this,e),o=Bs(r,"afterTitle",this,e);let l=[];return l=po(l,gl(s)),l=po(l,gl(a)),l=po(l,gl(o)),l}getBeforeBody(e,t){return TL(Bs(t.callbacks,"beforeBody",this,e))}getBody(e,t){const{callbacks:r}=t,s=[];return jn(e,a=>{const o={before:[],lines:[],after:[]},l=kL(r,a);po(o.before,gl(Bs(l,"beforeLabel",this,a))),po(o.lines,Bs(l,"label",this,a)),po(o.after,gl(Bs(l,"afterLabel",this,a))),s.push(o)}),s}getAfterBody(e,t){return TL(Bs(t.callbacks,"afterBody",this,e))}getFooter(e,t){const{callbacks:r}=t,s=Bs(r,"beforeFooter",this,e),a=Bs(r,"footer",this,e),o=Bs(r,"afterFooter",this,e);let l=[];return l=po(l,gl(s)),l=po(l,gl(a)),l=po(l,gl(o)),l}_createItems(e){const t=this._active,r=this.chart.data,s=[],a=[],o=[];let l=[],c,d;for(c=0,d=t.length;c<d;++c)l.push(Qle(this.chart,t[c]));return e.filter&&(l=l.filter((h,p,x)=>e.filter(h,p,x,r))),e.itemSort&&(l=l.sort((h,p)=>e.itemSort(h,p,r))),jn(l,h=>{const p=kL(e.callbacks,h);s.push(Bs(p,"labelColor",this,h)),a.push(Bs(p,"labelPointStyle",this,h)),o.push(Bs(p,"labelTextColor",this,h))}),this.labelColors=s,this.labelPointStyles=a,this.labelTextColors=o,this.dataPoints=l,l}update(e,t){const r=this.options.setContext(this.getContext()),s=this._active;let a,o=[];if(!s.length)this.opacity!==0&&(a={opacity:0});else{const l=Zh[r.position].call(this,s,this._eventPosition);o=this._createItems(r),this.title=this.getTitle(o,r),this.beforeBody=this.getBeforeBody(o,r),this.body=this.getBody(o,r),this.afterBody=this.getAfterBody(o,r),this.footer=this.getFooter(o,r);const c=this._size=NL(this,r),d=Object.assign({},l,c),h=SL(this.chart,r,d),p=CL(r,d,h,this.chart);this.xAlign=h.xAlign,this.yAlign=h.yAlign,a={opacity:1,x:p.x,y:p.y,width:c.width,height:c.height,caretX:l.x,caretY:l.y}}this._tooltipItems=o,this.$context=void 0,a&&this._resolveAnimations().update(this,a),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:t})}drawCaret(e,t,r,s){const a=this.getCaretPosition(e,r,s);t.lineTo(a.x1,a.y1),t.lineTo(a.x2,a.y2),t.lineTo(a.x3,a.y3)}getCaretPosition(e,t,r){const{xAlign:s,yAlign:a}=this,{caretSize:o,cornerRadius:l}=r,{topLeft:c,topRight:d,bottomLeft:h,bottomRight:p}=vf(l),{x,y}=e,{width:_,height:w}=t;let j,C,P,O,M,D;return a==="center"?(M=y+w/2,s==="left"?(j=x,C=j-o,O=M+o,D=M-o):(j=x+_,C=j+o,O=M-o,D=M+o),P=j):(s==="left"?C=x+Math.max(c,h)+o:s==="right"?C=x+_-Math.max(d,p)-o:C=this.caretX,a==="top"?(O=y,M=O-o,j=C-o,P=C+o):(O=y+w,M=O+o,j=C+o,P=C-o),D=O),{x1:j,x2:C,x3:P,y1:O,y2:M,y3:D}}drawTitle(e,t,r){const s=this.title,a=s.length;let o,l,c;if(a){const d=bf(r.rtl,this.x,this.width);for(e.x=Kg(this,r.titleAlign,r),t.textAlign=d.textAlign(r.titleAlign),t.textBaseline="middle",o=Gs(r.titleFont),l=r.titleSpacing,t.fillStyle=r.titleColor,t.font=o.string,c=0;c<a;++c)t.fillText(s[c],d.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+l,c+1===a&&(e.y+=r.titleMarginBottom-l)}}_drawColorBox(e,t,r,s,a){const o=this.labelColors[r],l=this.labelPointStyles[r],{boxHeight:c,boxWidth:d}=a,h=Gs(a.bodyFont),p=Kg(this,"left",a),x=s.x(p),y=c<h.lineHeight?(h.lineHeight-c)/2:0,_=t.y+y;if(a.usePointStyle){const w={radius:Math.min(d,c)/2,pointStyle:l.pointStyle,rotation:l.rotation,borderWidth:1},j=s.leftForLtr(x,d)+d/2,C=_+c/2;e.strokeStyle=a.multiKeyBackground,e.fillStyle=a.multiKeyBackground,ZS(e,w,j,C),e.strokeStyle=o.borderColor,e.fillStyle=o.backgroundColor,ZS(e,w,j,C)}else{e.lineWidth=nn(o.borderWidth)?Math.max(...Object.values(o.borderWidth)):o.borderWidth||1,e.strokeStyle=o.borderColor,e.setLineDash(o.borderDash||[]),e.lineDashOffset=o.borderDashOffset||0;const w=s.leftForLtr(x,d),j=s.leftForLtr(s.xPlus(x,1),d-2),C=vf(o.borderRadius);Object.values(C).some(P=>P!==0)?(e.beginPath(),e.fillStyle=a.multiKeyBackground,Wx(e,{x:w,y:_,w:d,h:c,radius:C}),e.fill(),e.stroke(),e.fillStyle=o.backgroundColor,e.beginPath(),Wx(e,{x:j,y:_+1,w:d-2,h:c-2,radius:C}),e.fill()):(e.fillStyle=a.multiKeyBackground,e.fillRect(w,_,d,c),e.strokeRect(w,_,d,c),e.fillStyle=o.backgroundColor,e.fillRect(j,_+1,d-2,c-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,t,r){const{body:s}=this,{bodySpacing:a,bodyAlign:o,displayColors:l,boxHeight:c,boxWidth:d,boxPadding:h}=r,p=Gs(r.bodyFont);let x=p.lineHeight,y=0;const _=bf(r.rtl,this.x,this.width),w=function(q){t.fillText(q,_.x(e.x+y),e.y+x/2),e.y+=x+a},j=_.textAlign(o);let C,P,O,M,D,I,F;for(t.textAlign=o,t.textBaseline="middle",t.font=p.string,e.x=Kg(this,j,r),t.fillStyle=r.bodyColor,jn(this.beforeBody,w),y=l&&j!=="right"?o==="center"?d/2+h:d+2+h:0,M=0,I=s.length;M<I;++M){for(C=s[M],P=this.labelTextColors[M],t.fillStyle=P,jn(C.before,w),O=C.lines,l&&O.length&&(this._drawColorBox(t,e,M,_,r),x=Math.max(p.lineHeight,c)),D=0,F=O.length;D<F;++D)w(O[D]),x=p.lineHeight;jn(C.after,w)}y=0,x=p.lineHeight,jn(this.afterBody,w),e.y-=a}drawFooter(e,t,r){const s=this.footer,a=s.length;let o,l;if(a){const c=bf(r.rtl,this.x,this.width);for(e.x=Kg(this,r.footerAlign,r),e.y+=r.footerMarginTop,t.textAlign=c.textAlign(r.footerAlign),t.textBaseline="middle",o=Gs(r.footerFont),t.fillStyle=r.footerColor,t.font=o.string,l=0;l<a;++l)t.fillText(s[l],c.x(e.x),e.y+o.lineHeight/2),e.y+=o.lineHeight+r.footerSpacing}}drawBackground(e,t,r,s){const{xAlign:a,yAlign:o}=this,{x:l,y:c}=e,{width:d,height:h}=r,{topLeft:p,topRight:x,bottomLeft:y,bottomRight:_}=vf(s.cornerRadius);t.fillStyle=s.backgroundColor,t.strokeStyle=s.borderColor,t.lineWidth=s.borderWidth,t.beginPath(),t.moveTo(l+p,c),o==="top"&&this.drawCaret(e,t,r,s),t.lineTo(l+d-x,c),t.quadraticCurveTo(l+d,c,l+d,c+x),o==="center"&&a==="right"&&this.drawCaret(e,t,r,s),t.lineTo(l+d,c+h-_),t.quadraticCurveTo(l+d,c+h,l+d-_,c+h),o==="bottom"&&this.drawCaret(e,t,r,s),t.lineTo(l+y,c+h),t.quadraticCurveTo(l,c+h,l,c+h-y),o==="center"&&a==="left"&&this.drawCaret(e,t,r,s),t.lineTo(l,c+p),t.quadraticCurveTo(l,c,l+p,c),t.closePath(),t.fill(),s.borderWidth>0&&t.stroke()}_updateAnimationTarget(e){const t=this.chart,r=this.$animations,s=r&&r.x,a=r&&r.y;if(s||a){const o=Zh[e.position].call(this,this._active,this._eventPosition);if(!o)return;const l=this._size=NL(this,e),c=Object.assign({},o,this._size),d=SL(t,e,c),h=CL(e,c,d,t);(s._to!==h.x||a._to!==h.y)&&(this.xAlign=d.xAlign,this.yAlign=d.yAlign,this.width=l.width,this.height=l.height,this.caretX=o.x,this.caretY=o.y,this._resolveAnimations().update(this,h))}}_willRender(){return!!this.opacity}draw(e){const t=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(t);const s={width:this.width,height:this.height},a={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const o=La(t.padding),l=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;t.enabled&&l&&(e.save(),e.globalAlpha=r,this.drawBackground(a,e,s,t),S6(e,t.textDirection),a.y+=o.top,this.drawTitle(a,e,t),this.drawBody(a,e,t),this.drawFooter(a,e,t),C6(e,t.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,t){const r=this._active,s=e.map(({datasetIndex:l,index:c})=>{const d=this.chart.getDatasetMeta(l);if(!d)throw new Error("Cannot find a dataset at index "+l);return{datasetIndex:l,element:d.data[c],index:c}}),a=!zx(r,s),o=this._positionChanged(s,t);(a||o)&&(this._active=s,this._eventPosition=t,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,t,r=!0){if(t&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const s=this.options,a=this._active||[],o=this._getActiveElements(e,a,t,r),l=this._positionChanged(o,e),c=t||!zx(o,a)||l;return c&&(this._active=o,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,t))),c}_getActiveElements(e,t,r,s){const a=this.options;if(e.type==="mouseout")return[];if(!s)return t.filter(l=>this.chart.data.datasets[l.datasetIndex]&&this.chart.getDatasetMeta(l.datasetIndex).controller.getParsed(l.index)!==void 0);const o=this.chart.getElementsAtEventForMode(e,a.mode,a,r);return a.reverse&&o.reverse(),o}_positionChanged(e,t){const{caretX:r,caretY:s,options:a}=this,o=Zh[a.position].call(this,e,t);return o!==!1&&(r!==o.x||s!==o.y)}}var ice={id:"tooltip",_element:PL,positioners:Zh,afterInit(n,e,t){t&&(n.tooltip=new PL({chart:n,options:t}))},beforeUpdate(n,e,t){n.tooltip&&n.tooltip.initialize(t)},reset(n,e,t){n.tooltip&&n.tooltip.initialize(t)},afterDraw(n){const e=n.tooltip;if(e&&e._willRender()){const t={tooltip:e};if(n.notifyPlugins("beforeTooltipDraw",{...t,cancelable:!0})===!1)return;e.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",t)}},afterEvent(n,e){if(n.tooltip){const t=e.replay;n.tooltip.handleEvent(e.event,t,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,e)=>e.bodyFont.size,boxWidth:(n,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Z6},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const ace=(n,e,t,r)=>(typeof e=="string"?(t=n.push(e)-1,r.unshift({index:t,label:e})):isNaN(e)&&(t=null),t);function oce(n,e,t,r){const s=n.indexOf(e);if(s===-1)return ace(n,e,t,r);const a=n.lastIndexOf(e);return s!==a?t:s}const lce=(n,e)=>n===null?null:ds(Math.round(n),0,e);function ML(n){const e=this.getLabels();return n>=0&&n<e.length?e[n]:n}class cce extends Kf{static id="category";static defaults={ticks:{callback:ML}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const t=this._addedLabels;if(t.length){const r=this.getLabels();for(const{index:s,label:a}of t)r[s]===a&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,t){if(vn(e))return null;const r=this.getLabels();return t=isFinite(t)&&r[t]===e?t:oce(r,e,Yt(t,e),this._addedLabels),lce(t,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:t}=this.getUserBounds();let{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),t||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){const e=this.min,t=this.max,r=this.options.offset,s=[];let a=this.getLabels();a=e===0&&t===a.length-1?a:a.slice(e,t+1),this._valueRange=Math.max(a.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let o=e;o<=t;o++)s.push({value:o});return s}getLabelForValue(e){return ML.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const t=this.ticks;return e<0||e>t.length-1?null:this.getPixelForValue(t[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}function dce(n,e){const t=[],{bounds:s,step:a,min:o,max:l,precision:c,count:d,maxTicks:h,maxDigits:p,includeBounds:x}=n,y=a||1,_=h-1,{min:w,max:j}=e,C=!vn(o),P=!vn(l),O=!vn(d),M=(j-w)/(p+1);let D=CR((j-w)/_/y)*y,I,F,q,B;if(D<1e-14&&!C&&!P)return[{value:w},{value:j}];B=Math.ceil(j/D)-Math.floor(w/D),B>_&&(D=CR(B*D/_/y)*y),vn(c)||(I=Math.pow(10,c),D=Math.ceil(D*I)/I),s==="ticks"?(F=Math.floor(w/D)*D,q=Math.ceil(j/D)*D):(F=w,q=j),C&&P&&a&&lie((l-o)/a,D/1e3)?(B=Math.round(Math.min((l-o)/D,h)),D=(l-o)/B,F=o,q=l):O?(F=C?o:F,q=P?l:q,B=d-1,D=(q-F)/B):(B=(q-F)/D,rm(B,Math.round(B),D/1e3)?B=Math.round(B):B=Math.ceil(B));const U=Math.max(TR(D),TR(F));I=Math.pow(10,vn(c)?U:c),F=Math.round(F*I)/I,q=Math.round(q*I)/I;let W=0;for(C&&(x&&F!==o?(t.push({value:o}),F<o&&W++,rm(Math.round((F+W*D)*I)/I,o,EL(o,M,n))&&W++):F<o&&W++);W<B;++W){const G=Math.round((F+W*D)*I)/I;if(P&&G>l)break;t.push({value:G})}return P&&x&&q!==l?t.length&&rm(t[t.length-1].value,l,EL(l,M,n))?t[t.length-1].value=l:t.push({value:l}):(!P||q===l)&&t.push({value:q}),t}function EL(n,e,{horizontal:t,minRotation:r}){const s=wl(r),a=(t?Math.sin(s):Math.cos(s))||.001,o=.75*e*(""+n).length;return Math.min(e/a,o)}class uce extends Kf{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,t){return vn(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:t,maxDefined:r}=this.getUserBounds();let{min:s,max:a}=this;const o=c=>s=t?s:c,l=c=>a=r?a:c;if(e){const c=So(s),d=So(a);c<0&&d<0?l(0):c>0&&d>0&&o(0)}if(s===a){let c=a===0?1:Math.abs(a*.05);l(a+c),e||o(s-c)}this.min=s,this.max=a}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:t,stepSize:r}=e,s;return r?(s=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,s>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${s} ticks. Limiting to 1000.`),s=1e3)):(s=this.computeTickLimit(),t=t||11),t&&(s=Math.min(t,s)),s}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,t=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const s={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:t.precision,step:t.stepSize,count:t.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:t.minRotation||0,includeBounds:t.includeBounds!==!1},a=this._range||this,o=dce(s,a);return e.bounds==="ticks"&&cie(o,this,"value"),e.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){const e=this.ticks;let t=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const s=(r-t)/Math.max(e.length-1,1)/2;t-=s,r+=s}this._startValue=t,this._endValue=r,this._valueRange=r-t}getLabelForValue(e){return mC(e,this.chart.options.locale,this.options.ticks.format)}}class fce extends uce{static id="linear";static defaults={ticks:{callback:x6.formatters.numeric}};determineDataLimits(){const{min:e,max:t}=this.getMinMax(!0);this.min=fs(e)?e:0,this.max=fs(t)?t:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),t=e?this.width:this.height,r=wl(this.options.ticks.minRotation),s=(e?Math.sin(r):Math.cos(r))||.001,a=this._resolveTickFontOptions(0);return Math.ceil(t/Math.min(40,a.lineHeight/s))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}const Fy={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},$s=Object.keys(Fy);function DL(n,e){return n-e}function OL(n,e){if(vn(e))return null;const t=n._adapter,{parser:r,round:s,isoWeekday:a}=n._parseOpts;let o=e;return typeof r=="function"&&(o=r(o)),fs(o)||(o=typeof r=="string"?t.parse(o,r):t.parse(o)),o===null?null:(s&&(o=s==="week"&&(Cm(a)||a===!0)?t.startOf(o,"isoWeek",a):t.startOf(o,s)),+o)}function IL(n,e,t,r){const s=$s.length;for(let a=$s.indexOf(n);a<s-1;++a){const o=Fy[$s[a]],l=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((t-e)/(l*o.size))<=r)return $s[a]}return $s[s-1]}function hce(n,e,t,r,s){for(let a=$s.length-1;a>=$s.indexOf(t);a--){const o=$s[a];if(Fy[o].common&&n._adapter.diff(s,r,o)>=e-1)return o}return $s[t?$s.indexOf(t):0]}function mce(n){for(let e=$s.indexOf(n)+1,t=$s.length;e<t;++e)if(Fy[$s[e]].common)return $s[e]}function AL(n,e,t){if(!t)n[e]=!0;else if(t.length){const{lo:r,hi:s}=fC(t,e),a=t[r]>=e?t[r]:t[s];n[a]=!0}}function pce(n,e,t,r){const s=n._adapter,a=+s.startOf(e[0].value,r),o=e[e.length-1].value;let l,c;for(l=a;l<=o;l=+s.add(l,1,r))c=t[l],c>=0&&(e[c].major=!0);return e}function RL(n,e,t){const r=[],s={},a=e.length;let o,l;for(o=0;o<a;++o)l=e[o],s[l]=o,r.push({value:l,major:!1});return a===0||!t?r:pce(n,r,s,t)}class LL extends Kf{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,t={}){const r=e.time||(e.time={}),s=this._adapter=new Gae._date(e.adapters.date);s.init(t),nm(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=t.normalized}parse(e,t){return e===void 0?null:OL(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,t=this._adapter,r=e.time.unit||"day";let{min:s,max:a,minDefined:o,maxDefined:l}=this.getUserBounds();function c(d){!o&&!isNaN(d.min)&&(s=Math.min(s,d.min)),!l&&!isNaN(d.max)&&(a=Math.max(a,d.max))}(!o||!l)&&(c(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&c(this.getMinMax(!1))),s=fs(s)&&!isNaN(s)?s:+t.startOf(Date.now(),r),a=fs(a)&&!isNaN(a)?a:+t.endOf(Date.now(),r)+1,this.min=Math.min(s,a-1),this.max=Math.max(s+1,a)}_getLabelBounds(){const e=this.getLabelTimestamps();let t=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(t=e[0],r=e[e.length-1]),{min:t,max:r}}buildTicks(){const e=this.options,t=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);const a=this.min,o=this.max,l=mie(s,a,o);return this._unit=t.unit||(r.autoSkip?IL(t.minUnit,this.min,this.max,this._getLabelCapacity(a)):hce(this,l.length,t.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:mce(this._unit),this.initOffsets(s),e.reverse&&l.reverse(),RL(this,l,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let t=0,r=0,s,a;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?t=1-s:t=(this.getDecimalForValue(e[1])-s)/2,a=this.getDecimalForValue(e[e.length-1]),e.length===1?r=a:r=(a-this.getDecimalForValue(e[e.length-2]))/2);const o=e.length<3?.5:.25;t=ds(t,0,o),r=ds(r,0,o),this._offsets={start:t,end:r,factor:1/(t+1+r)}}_generate(){const e=this._adapter,t=this.min,r=this.max,s=this.options,a=s.time,o=a.unit||IL(a.minUnit,t,r,this._getLabelCapacity(t)),l=Yt(s.ticks.stepSize,1),c=o==="week"?a.isoWeekday:!1,d=Cm(c)||c===!0,h={};let p=t,x,y;if(d&&(p=+e.startOf(p,"isoWeek",c)),p=+e.startOf(p,d?"day":o),e.diff(r,t,o)>1e5*l)throw new Error(t+" and "+r+" are too far apart with stepSize of "+l+" "+o);const _=s.ticks.source==="data"&&this.getDataTimestamps();for(x=p,y=0;x<r;x=+e.add(x,l,o),y++)AL(h,x,_);return(x===r||s.bounds==="ticks"||y===1)&&AL(h,x,_),Object.keys(h).sort(DL).map(w=>+w)}getLabelForValue(e){const t=this._adapter,r=this.options.time;return r.tooltipFormat?t.format(e,r.tooltipFormat):t.format(e,r.displayFormats.datetime)}format(e,t){const s=this.options.time.displayFormats,a=this._unit,o=t||s[a];return this._adapter.format(e,o)}_tickFormatFunction(e,t,r,s){const a=this.options,o=a.ticks.callback;if(o)return Bn(o,[e,t,r],this);const l=a.time.displayFormats,c=this._unit,d=this._majorUnit,h=c&&l[c],p=d&&l[d],x=r[t],y=d&&p&&x&&x.major;return this._adapter.format(e,s||(y?p:h))}generateTickLabels(e){let t,r,s;for(t=0,r=e.length;t<r;++t)s=e[t],s.label=this._tickFormatFunction(s.value,t,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const t=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((t.start+r)*t.factor)}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const t=this.options.ticks,r=this.ctx.measureText(e).width,s=wl(this.isHorizontal()?t.maxRotation:t.minRotation),a=Math.cos(s),o=Math.sin(s),l=this._resolveTickFontOptions(0).size;return{w:r*a+l*o,h:r*o+l*a}}_getLabelCapacity(e){const t=this.options.time,r=t.displayFormats,s=r[t.unit]||r.millisecond,a=this._tickFormatFunction(e,0,RL(this,[e],this._majorUnit),s),o=this._getLabelSize(a),l=Math.floor(this.isHorizontal()?this.width/o.w:this.height/o.h)-1;return l>0?l:1}getDataTimestamps(){let e=this._cache.data||[],t,r;if(e.length)return e;const s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(t=0,r=s.length;t<r;++t)e=e.concat(s[t].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let t,r;if(e.length)return e;const s=this.getLabels();for(t=0,r=s.length;t<r;++t)e.push(OL(this,s[t]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return h6(e.sort(DL))}}function Jg(n,e,t){let r=0,s=n.length-1,a,o,l,c;t?(e>=n[r].pos&&e<=n[s].pos&&({lo:r,hi:s}=lu(n,"pos",e)),{pos:a,time:l}=n[r],{pos:o,time:c}=n[s]):(e>=n[r].time&&e<=n[s].time&&({lo:r,hi:s}=lu(n,"time",e)),{time:a,pos:l}=n[r],{time:o,pos:c}=n[s]);const d=o-a;return d?l+(c-l)*(e-a)/d:l}class Ghe extends LL{static id="timeseries";static defaults=LL.defaults;constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),t=this._table=this.buildLookupTable(e);this._minPos=Jg(t,this.min),this._tableRange=Jg(t,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:t,max:r}=this,s=[],a=[];let o,l,c,d,h;for(o=0,l=e.length;o<l;++o)d=e[o],d>=t&&d<=r&&s.push(d);if(s.length<2)return[{time:t,pos:0},{time:r,pos:1}];for(o=0,l=s.length;o<l;++o)h=s[o+1],c=s[o-1],d=s[o],Math.round((h+c)/2)!==d&&a.push({time:d,pos:o/(l-1)});return a}_generate(){const e=this.min,t=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(t)||r.length===1)&&r.push(t),r.sort((s,a)=>s-a)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const t=this.getDataTimestamps(),r=this.getLabelTimestamps();return t.length&&r.length?e=this.normalize(t.concat(r)):e=t.length?t:r,e=this._cache.all=e,e}getDecimalForValue(e){return(Jg(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const t=this._offsets,r=this.getDecimalForPixel(e)/t.factor-t.end;return Jg(this._table,r*this._tableRange+this._minPos,!0)}}Ay.register(Wae,Sle,cce,fce,Yae,Ry,vle,Hae,cle,ice,Jle,$le);const FL=({title:n,icon:e,children:t})=>i.jsxs("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card col-span-1",children:[i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx(e,{className:"h-5 w-5 mr-3 text-muted"}),i.jsx("h3",{className:"font-semibold text-primary-text",children:n})]}),i.jsx("div",{className:"h-64 md:h-80 relative",children:t})]}),gce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null),{colorScheme:r}=an();return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s){const a=r==="blue"?"#1a3a6e":"#005D22",o=r==="blue"?"#0f264a":"#004218";t.current=new Ay(s,{type:"bar",data:{labels:n.labels,datasets:[{label:"Present",data:n.present,backgroundColor:a,borderColor:o,borderWidth:1,borderRadius:4},{label:"Absent",data:n.absent,backgroundColor:"#EF4444",borderColor:"#DC2626",borderWidth:1,borderRadius:4}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n,r]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},xce=({data:n})=>{const e=E.useRef(null),t=E.useRef(null),{colorScheme:r}=an();return E.useEffect(()=>{if(e.current){t.current&&t.current.destroy();const s=e.current.getContext("2d");if(s){const a=r==="blue"?"26, 58, 110":"0, 93, 34",o=r==="blue"?"#1a3a6e":"#005D22",l=s.createLinearGradient(0,0,0,200);l.addColorStop(0,`rgba(${a}, 0.4)`),l.addColorStop(1,`rgba(${a}, 0)`),t.current=new Ay(s,{type:"line",data:{labels:n.labels,datasets:[{label:"Average Hours Worked",data:n.hours,borderColor:o,backgroundColor:l,fill:!0,tension:.4,pointBackgroundColor:o,pointRadius:0,pointHoverRadius:5}]},options:{responsive:!0,maintainAspectRatio:!1,scales:{y:{beginAtZero:!0,grid:{color:"rgba(128,128,128,0.1)"},ticks:{stepSize:1,precision:0,callback:c=>{const d=typeof c=="string"?parseFloat(c):c;return Math.round(d)}}},x:{grid:{display:!1},ticks:{maxRotation:0,minRotation:0,autoSkip:!0,maxTicksLimit:7}}},plugins:{legend:{display:!0,position:"bottom",align:"center",labels:{usePointStyle:!0,pointStyle:"rectRounded",boxWidth:12,padding:20,font:{family:"'Manrope', sans-serif",size:12}}},tooltip:{backgroundColor:"#0F172A",titleFont:{family:"'Manrope', sans-serif"},bodyFont:{family:"'Manrope', sans-serif"},cornerRadius:8,padding:10,displayColors:!0,boxPadding:4}}}})}}return()=>{t.current&&t.current.destroy()}},[n,r]),i.jsx("div",{className:"h-full w-full flex flex-col",children:i.jsx("div",{className:"flex-grow relative",children:i.jsx("canvas",{ref:e})})})},yce=({data:n,dateRange:e,colorScheme:t})=>i.jsxs("div",{className:"p-8 font-sans text-sm text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-6",children:[i.jsx(Qi,{className:"h-10",localPath:oC(t)}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-xl font-bold",children:"Attendance Log"}),i.jsxs("p",{className:"text-gray-600",children:[We(e.startDate,"dd MMM yyyy")," to ",We(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full mt-6 text-left border-collapse",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-100",children:[i.jsx("th",{className:"p-2 border border-gray-300",children:"User"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Date"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Time"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Event"}),i.jsx("th",{className:"p-2 border border-gray-300",children:"Location"})]})}),i.jsx("tbody",{children:n.map((r,s)=>i.jsxs("tr",{className:"border-b",children:[i.jsx("td",{className:"p-2 border border-gray-300",children:r.userName}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.date}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.time}),i.jsx("td",{className:"p-2 border border-gray-300 capitalize",children:r.type.replace("-"," ")}),i.jsx("td",{className:"p-2 border border-gray-300",children:r.locationName||(r.latitude?`${r.latitude?.toFixed(4)}, ${r.longitude?.toFixed(4)}`:"N/A")})]},`${r.userName}-${r.date}-${r.time}-${s}`))})]})]}),vce=({data:n,dateRange:e,colorScheme:t})=>{const s=[];for(let a=0;a<n.length;a+=15)s.push(n.slice(a,a+15));return s.length===0?null:i.jsx("div",{children:s.map((a,o)=>{const l=15-a.length,c=o===s.length-1;return i.jsxs("div",{style:{padding:o===0?"40px":"0px 40px 40px 40px",paddingTop:o===0?"40px":"0px",marginTop:o===0?"0px":"-40px",fontFamily:'"Courier New", Courier, monospace',fontSize:"14px",color:"#000",backgroundColor:"#fff",width:"1123px",height:"794px",boxSizing:"border-box",letterSpacing:"0.5px",pageBreakAfter:c?"auto":"always",position:"relative",display:"flex",flexDirection:"column"},children:[i.jsx("table",{style:{width:"100%",borderBottom:"2px solid #000",marginBottom:"16px",paddingBottom:"8px"},children:i.jsx("tbody",{children:i.jsxs("tr",{children:[i.jsx("td",{style:{width:"50%",verticalAlign:"top",textAlign:"left"},children:i.jsx(Qi,{className:"h-14",localPath:oC(t)})}),i.jsxs("td",{style:{width:"50%",verticalAlign:"top",textAlign:"right"},children:[i.jsx("div",{style:{fontSize:"18px",fontWeight:"bold",marginBottom:"6px",textTransform:"uppercase",letterSpacing:"1px"},children:"Basic Attendance Report"}),i.jsxs("div",{style:{fontSize:"12px",color:"#333",marginBottom:"4px"},children:[We(e.startDate,"dd MMM yyyy")," -"," ",We(e.endDate,"dd MMM yyyy")]}),i.jsxs("div",{style:{fontSize:"10px",color:"#666"},children:["Generated: ",We(new Date,"dd MMM yyyy HH:mm")]})]})]})})}),i.jsx("div",{style:{flexGrow:1},children:i.jsxs("table",{style:{width:"100%",borderCollapse:"collapse",border:"1px solid #000",tableLayout:"fixed"},children:[i.jsx("thead",{style:{display:"table-header-group"},children:i.jsxs("tr",{style:{backgroundColor:"#f2f2f2"},children:[i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"28%",fontSize:"11px",fontWeight:"bold"},children:"Employee Name"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Date"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"14%",fontSize:"11px",fontWeight:"bold"},children:"Status"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check In"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"12%",fontSize:"11px",fontWeight:"bold"},children:"Check Out"}),i.jsx("th",{style:{border:"1px solid #000",padding:"10px 5px",textAlign:"center",width:"15%",fontSize:"11px",fontWeight:"bold"},children:"Hours"})]})}),i.jsxs("tbody",{children:[a.map((d,h)=>i.jsxs("tr",{style:{backgroundColor:h%2===0?"#fff":"#fafafa"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle",wordWrap:"break-word",whiteSpace:"normal",lineHeight:"1.4"},children:d.userName}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:We(new Date(String(d.date).replace(/-/g,"/")),"dd MMM yyyy")}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.status}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.checkIn||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.checkOut||"-"}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",textAlign:"center",verticalAlign:"middle"},children:d.duration||"-"})]},`${d.userName}-${d.date}-${h}`)),Array.from({length:l}).map((d,h)=>i.jsxs("tr",{style:{backgroundColor:"#fff"},children:[i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px",height:"33px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""}),i.jsx("td",{style:{border:"1px solid #ccc",padding:"8px 5px"},children:""})]},`empty-${h}`))]})]})}),i.jsxs("div",{style:{marginTop:"10px",borderTop:"1px solid #ccc",paddingTop:"8px",textAlign:"center",fontSize:"10px",color:"#888"},children:[vse(t)," - Confidential Report - Page ",o+1," of ",s.length]})]},o)})})},bce=({data:n,dateRange:e,colorScheme:t})=>{const r=yo({start:e.startDate,end:e.endDate});return i.jsxs("div",{className:"p-8 font-sans text-[9px] text-black bg-white",children:[i.jsxs("div",{className:"flex justify-between items-center border-b pb-4 mb-4",children:[i.jsx(Qi,{className:"h-8",localPath:oC(t)}),i.jsxs("div",{className:"text-right",children:[i.jsx("h1",{className:"text-lg font-bold",children:"Monthly Attendance Report"}),i.jsxs("p",{className:"text-gray-600",children:[We(e.startDate,"dd MMM yyyy")," to ",We(e.endDate,"dd MMM yyyy")]})]})]}),i.jsxs("table",{className:"w-full border-collapse border border-gray-400 text-center",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"bg-gray-200 font-bold",children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:"Employee Name"}),r.map((s,a)=>i.jsx("td",{className:"border p-1 border-gray-400",children:We(s,"d")},a)),i.jsx("td",{className:"border p-1 border-gray-400",children:"P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"1/2P"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"A"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WO"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"H"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"WOP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"HP"}),i.jsx("td",{className:"border p-1 border-gray-400",children:"Total"})]})}),i.jsx("tbody",{children:n.map((s,a)=>i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-gray-400 text-left",children:s.userName}),s.statuses.map((o,l)=>i.jsx("td",{className:"border p-1 border-gray-400",children:o},l)),i.jsx("td",{className:"border p-1 border-gray-400",children:s.presentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.halfDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.absentDays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.weekOffs}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.holidays}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.weekendPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.holidayPresents}),i.jsx("td",{className:"border p-1 border-gray-400",children:s.totalPayableDays})]},a))})]})]})},wce=()=>{const n=Rt("(max-width: 639px)"),{user:e}=jt(),{permissions:t}=ta(),{recurringHolidays:r}=yi(),{colorScheme:s}=an(),[a,o]=E.useState([]),[l,c]=E.useState([]),[d,h]=E.useState(null),[p,x]=E.useState(!0),[y,_]=E.useState({startDate:ix(),endDate:db(),key:"selection"}),w=E.useMemo(()=>[y],[y]),[j,C]=E.useState("Today"),[P,O]=E.useState(!1),M=E.useRef(null),[D,I]=E.useState("all"),[F,q]=E.useState("all"),[B,U]=E.useState("all"),[W,G]=E.useState("basic"),[Z,Y]=E.useState(!1),[ae,ee]=E.useState(null),[me,$]=E.useState({}),K=E.useRef(null),re=e&&t[e.role]?.includes("download_attendance_report"),se=!(e&&t[e.role]?.includes("view_all_attendance")),[ie,ce]=E.useState({present:0,absent:0,ot:0,compOff:0}),[oe,de]=E.useState([]);E.useEffect(()=>{const ve=Oe=>{M.current&&!M.current.contains(Oe.target)&&O(!1)};return document.addEventListener("mousedown",ve),()=>document.removeEventListener("mousedown",ve)},[]),E.useEffect(()=>{re&&ue.getUsers().then(o)},[re]),E.useEffect(()=>{(async()=>{if(!(!se||!e||!y.startDate||!y.endDate)){x(!0);try{const Oe=gf(y.startDate,7),Ve=Oe.toISOString(),qe=y.endDate.toISOString(),[X,le]=await Promise.all([ue.getAttendanceEvents(e.id,Ve,qe),ue.getCompOffLogs(e.id)]);let Le=yo({start:Oe,end:y.endDate}).map(ht=>{const Et=We(ht,"yyyy-MM-dd"),Mt=X.filter(bn=>We(new Date(bn.timestamp),"yyyy-MM-dd")===Et);let en="Absent",Jt="-",Zt="-",on=0;const zt=We(ht,"EEEE"),Sn=zt==="Sunday";if(r.some(bn=>{if(bn.day.toLowerCase()!==zt.toLowerCase())return!1;const nr=Math.ceil(ht.getDate()/7),st=e.role==="field_officer"?"field":"office";return bn.n===nr&&(bn.type||"office")===st})?en="Holiday":Sn&&(en="Weekend"),Mt.length>0){en="Present",Mt.sort((st,Cn)=>new Date(st.timestamp).getTime()-new Date(Cn.timestamp).getTime());const bn=Mt.find(st=>st.type==="check-in"),nr=[...Mt].reverse().find(st=>st.type==="check-out");if(bn&&(Jt=We(new Date(bn.timestamp),"hh:mm a")),nr&&(Zt=We(new Date(nr.timestamp),"hh:mm a"),bn)){const Cn=pf(new Date(nr.timestamp),new Date(bn.timestamp))/60;Cn>8&&(on=Math.round((Cn-8)*10)/10)}}return{rawDate:ht,date:We(ht,"dd MMM, yyyy"),day:zt,checkIn:Jt,checkOut:Zt,status:en,ot:on}});Le.forEach((ht,Et)=>{if(ht.status==="Weekend"&&ht.day==="Sunday"){let Mt=0;const en=Math.max(0,Et-6);for(let Jt=Et-1;Jt>=en;Jt--)Le[Jt].status==="Absent"&&Mt++;Mt>=4&&(ht.status="Absent")}});const Ie=Le.filter(ht=>ht.rawDate>=y.startDate),ze=Ie.filter(ht=>ht.status==="Present").length,et=Ie.filter(ht=>ht.status==="Absent"&&ht.rawDate<=new Date).length,tt=Ie.reduce((ht,Et)=>ht+Et.ot,0),ct=le.filter(ht=>{const Et=new Date(ht.dateEarned);return Et>=y.startDate&&Et<=y.endDate&&ht.status==="earned"}).length;ce({present:ze,absent:et,ot:Math.round(tt*10)/10,compOff:ct}),de(Ie.reverse())}catch(Oe){console.error("Failed to fetch employee attendance",Oe)}finally{x(!1)}}})()},[se,e,y,r]);const te=E.useCallback(async(ve,Oe)=>{x(!0);try{let Ve=a;Ve.length===0&&(Ve=await ue.getUsers(),o(Ve));const qe=new Date,X=ve<qe?ve:ix(),le=Oe>qe?Oe:db(),[he,Le]=await Promise.all([ue.getAllAttendanceEvents(X.toISOString(),le.toISOString()),ue.getLeaveRequests({startDate:X.toISOString(),endDate:le.toISOString(),status:"approved"})]);c(he);const Ie=We(qe,"yyyy-MM-dd"),ze=he.filter(zt=>We(new Date(zt.timestamp),"yyyy-MM-dd")===Ie),et=new Set(ze.map(zt=>zt.userId)).size,tt=Le.filter(zt=>{const Sn=new Date(zt.startDate),qn=new Date(zt.endDate);return qe>=Sn&&qe<=qn}),ct=new Set(tt.map(zt=>zt.userId)).size,ht=Ve.length,Et=Math.max(0,ht-et-ct),Mt=yo({start:ve,end:Oe}),en=Mt.map(zt=>We(zt,"dd MMM")),Jt=[],Zt=[],on=[];Mt.forEach(zt=>{const Sn=We(zt,"yyyy-MM-dd"),qn=he.filter(kn=>We(new Date(kn.timestamp),"yyyy-MM-dd")===Sn),bn=new Set(qn.map(kn=>kn.userId)).size,nr=Le.filter(kn=>{const Ps=new Date(kn.startDate),Qs=new Date(kn.endDate);return zt>=Ps&&zt<=Qs}),st=new Set(nr.map(kn=>kn.userId)).size,Cn=Math.max(0,ht-bn-st);Jt.push(bn),Zt.push(Cn);let Rr=0;const Jr={};qn.forEach(kn=>{Jr[kn.userId]||(Jr[kn.userId]=[]),Jr[kn.userId].push(kn)}),Object.values(Jr).forEach(kn=>{kn.sort((Lr,_i)=>new Date(Lr.timestamp).getTime()-new Date(_i.timestamp).getTime());const Ps=kn.find(Lr=>Lr.type==="check-in"),Qs=[...kn].reverse().find(Lr=>Lr.type==="check-out");if(Ps&&Qs){const Lr=pf(new Date(Qs.timestamp),new Date(Ps.timestamp));Rr+=Lr/60}}),on.push(bn>0?parseFloat((Rr/bn).toFixed(1)):0)}),h({totalEmployees:ht,presentToday:et,absentToday:Et,onLeaveToday:ct,attendanceTrend:{labels:en,present:Jt,absent:Zt},productivityTrend:{labels:en,hours:on}})}catch(Ve){console.error("Failed to load dashboard data",Ve)}finally{x(!1)}},[a]);E.useEffect(()=>{y.startDate&&y.endDate&&te(y.startDate,y.endDate)},[y,te]),E.useEffect(()=>{if(W!=="log"||!y.startDate||!y.endDate)return;const ve=Ve=>parseFloat(Ve.toFixed(6));(async()=>{const Ve=D==="all"?a:a.filter(he=>he.id===D),qe=new Set(Ve.map(he=>he.id)),X=l.filter(he=>{if(!qe.has(he.userId)||new Date(he.timestamp)<y.startDate||new Date(he.timestamp)>y.endDate||he.locationName||!he.latitude||!he.longitude)return!1;const Le=`${ve(he.latitude)},${ve(he.longitude)}`;return!me[Le]});if(console.log("Geocoding: Events to process:",X.length),X.length===0)return;const le=X.map(he=>({lat:he.latitude,lon:he.longitude}));console.log("Geocoding: Fetching addresses for",le.length,"unique coordinates");try{const he=await ue.batchResolveAddresses(le);console.log("Geocoding: Resolved addresses:",Object.keys(he).length),$(Le=>({...Le,...he}))}catch(he){console.error("Batch geocoding failed:",he)}})()},[l,y,D,W,a]);const ye=ve=>{C(ve);const Oe=new Date;let Ve=ix(),qe=db();ve==="This Month"?(Ve=xi(Oe),qe=Ma(Oe)):ve==="This Year"?(Ve=gF(Oe),qe=XV(Oe)):ve==="Last 7 Days"?Ve=gf(Oe,6):ve==="Last 30 Days"&&(Ve=gf(Oe,29)),qe>Oe&&(qe=Oe),_({startDate:Ve,endDate:qe,key:"selection"})},Ce=ve=>{_(ve.selection),C("Custom"),O(!1)},Re=E.useMemo(()=>{const ve=y.endDate,Oe=new Date;return We(ve,"yyyy-MM-dd")===We(Oe,"yyyy-MM-dd")?"Today":`on ${We(ve,"MMM d")}`},[y]),Te=E.useMemo(()=>{if(!y.startDate||!y.endDate)return[];const ve=[],Oe=yo({start:y.startDate,end:y.endDate});(D==="all"?a:a.filter(X=>X.id===D)).forEach(X=>{Oe.forEach(le=>{const he=We(le,"yyyy-MM-dd"),Le=l.filter(Mt=>Mt.userId===X.id&&We(new Date(Mt.timestamp),"yyyy-MM-dd")===he);let Ie="Absent",ze="",et="",tt="";const ct=We(le,"EEEE"),ht=ct==="Sunday";if(r.some(Mt=>{if(Mt.day.toLowerCase()!==ct.toLowerCase())return!1;const en=le.getDate(),Jt=Math.ceil(en/7),Zt=X.role==="field_staff"?"field":"office",on=Mt.type||"office";return Mt.n===Jt&&on===Zt})?Ie="Holiday":ht&&(Ie="Weekend"),Le.length>0){const Mt=[...Le].sort((Zt,on)=>new Date(Zt.timestamp).getTime()-new Date(on.timestamp).getTime()),en=Mt.find(Zt=>Zt.type==="check-in"),Jt=[...Mt].reverse().find(Zt=>Zt.type==="check-out");if(en&&(Ie="Present",ze=We(new Date(en.timestamp),"HH:mm")),Jt&&(et=We(new Date(Jt.timestamp),"HH:mm")),en&&Jt){const Zt=new Date(en.timestamp),on=new Date(Jt.timestamp),zt=pf(on,Zt),Sn=Math.floor(zt/60),qn=zt%60;tt=`${Sn}h ${qn}m`}}ve.push({userName:X.name,date:he,status:Ie,checkIn:ze,checkOut:et,duration:tt})})});let qe=F==="all"?ve:ve.filter(X=>X.status===F);return B!=="all"&&(qe=qe.filter(X=>{const le=X.checkIn&&X.checkIn!=="-"&&X.checkIn!=="",he=X.checkOut&&X.checkOut!=="-"&&X.checkOut!=="";switch(B){case"complete":return le&&he;case"missing_checkout":return le&&!he;case"missing_checkin":return!le&&he;case"incomplete":return!le||!he;default:return!0}})),qe},[a,l,y,D,F,B,r]),je=E.useMemo(()=>{if(!y.startDate||!y.endDate)return[];const ve=qe=>parseFloat(qe.toFixed(6)),Oe=D==="all"?a:a.filter(qe=>qe.id===D),Ve=new Set(Oe.map(qe=>qe.id));return l.filter(qe=>Ve.has(qe.userId)).map(qe=>{const X=a.find(Le=>Le.id===qe.userId),le=qe.latitude&&qe.longitude?`${ve(qe.latitude)},${ve(qe.longitude)}`:"",he=me[le];return{userName:X?.name||"Unknown",date:We(new Date(qe.timestamp),"yyyy-MM-dd"),time:We(new Date(qe.timestamp),"HH:mm:ss"),type:qe.type,locationName:qe.locationName||he||(qe.latitude?`${qe.latitude.toFixed(4)}, ${qe.longitude.toFixed(4)}`:"N/A"),latitude:qe.latitude,longitude:qe.longitude}}).sort((qe,X)=>qe.date!==X.date?qe.date.localeCompare(X.date):qe.time.localeCompare(X.time))},[a,l,y,D,me]),ke=E.useMemo(()=>{if(!y.startDate||!y.endDate)return[];const ve=yo({start:y.startDate,end:y.endDate});return(D==="all"?a:a.filter(Ve=>Ve.id===D)).map(Ve=>{const qe=[];let X=0,le=0,he=0,Le=0,Ie=0,ze=0,et=0;ve.forEach(ct=>{const ht=We(ct,"yyyy-MM-dd"),Mt=l.filter(zt=>zt.userId===Ve.id&&We(new Date(zt.timestamp),"yyyy-MM-dd")===ht).some(zt=>zt.type==="check-in"),en=We(ct,"EEEE"),Jt=en==="Sunday",Zt=r.some(zt=>{if(zt.day.toLowerCase()!==en.toLowerCase())return!1;const Sn=ct.getDate(),qn=Math.ceil(Sn/7),bn=Ve.role==="field_staff"?"field":"office",nr=zt.type||"office";return zt.n===qn&&nr===bn});let on="";Mt?Zt?(on="HP",et++):Jt?(on="WOP",ze++):(on="P",X++):Zt?(on="H",Ie++):Jt?(on="WO",Le++):(on="A",le++),qe.push(on)});const tt=X+Le+Ie+ze+et+he*.5;return{userName:Ve.name,statuses:qe,presentDays:X,absentDays:le,halfDays:he,weekOffs:Le,holidays:Ie,weekendPresents:ze,holidayPresents:et,totalPayableDays:tt}})},[a,l,y,D,r]),Ue=E.useMemo(()=>W==="basic"?i.jsx(vce,{data:Te,dateRange:y,colorScheme:s}):W==="log"?i.jsx(yce,{data:je,dateRange:y,colorScheme:s}):W==="monthly"?i.jsx(bce,{data:ke,dateRange:y,colorScheme:s}):null,[W,Te,je,ke,y,s]),Ye=()=>{Y(!0);try{let ve="data:text/csv;charset=utf-8,",Oe=`Attendance_Report_${We(new Date,"yyyy-MM-dd")}.csv`;if(W==="basic")ve+=`Employee Name,Date,Status,Check In,Check Out,Hours
`,Te.forEach(X=>{ve+=`"${X.userName}","${X.date}","${X.status}","${X.checkIn}","${X.checkOut}","${X.duration}"
`});else if(W==="log")ve+=`User,Date,Time,Event,Location,Latitude,Longitude
`,je.forEach(X=>{ve+=`"${X.userName}","${X.date}","${X.time}","${X.type}","${X.locationName||""}","${X.latitude||""}","${X.longitude||""}"
`});else if(W==="monthly"){const le=yo({start:y.startDate,end:y.endDate}).map(he=>We(he,"dd MMM")).join(",");ve+=`Employee Name,${le},Present,Absent,Half Days,Week Offs,Holidays,Weekend Presents,Holiday Presents,Total Payable Days
`,ke.forEach(he=>{const Le=he.statuses.join(",");ve+=`"${he.userName}",${Le},"${he.presentDays}","${he.absentDays}","${he.halfDays}","${he.weekOffs}","${he.holidays}","${he.weekendPresents}","${he.holidayPresents}","${he.totalPayableDays}"
`})}const Ve=encodeURI(ve),qe=document.createElement("a");qe.setAttribute("href",Ve),qe.setAttribute("download",Oe),document.body.appendChild(qe),qe.click(),document.body.removeChild(qe),ee({message:"CSV downloaded successfully.",type:"success"})}catch(ve){console.error("CSV generation failed:",ve),ee({message:"Failed to generate CSV.",type:"error"})}finally{Y(!1)}};return p&&!d&&!se?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):se?i.jsxs("div",{className:`p-4 space-y-6 pb-24 md:bg-transparent ${s==="blue"?"!bg-transparent":"bg-[#041b0f]"}`,children:[i.jsxs("div",{className:"flex flex-col gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Attendance"}),i.jsxs("div",{className:"bg-card p-3 rounded-xl shadow-sm border border-border flex flex-wrap items-center gap-2",children:[["Today","This Month","Last 30 Days"].map(ve=>i.jsx(ne,{type:"button",variant:j===ve?"primary":"outline",onClick:()=>ye(ve),className:j===ve?"!text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:j===ve?{backgroundColor:s==="blue"?"#1a3a6e":"#006B3F",borderColor:s==="blue"?"#0f264a":"#005632"}:{},children:ve},ve)),i.jsxs("div",{className:"relative",ref:M,children:[i.jsxs(ne,{type:"button",variant:j==="Custom"?"primary":"outline",onClick:()=>O(!P),className:j==="Custom"?"!text-white shadow-md border":"bg-card text-primary-text border border-border hover:bg-accent-light",style:j==="Custom"?{backgroundColor:s==="blue"?"#1a3a6e":"#006B3F",borderColor:s==="blue"?"#0f264a":"#005632"}:{},children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:j==="Custom"?`${We(y.startDate,"dd MMM")} - ${We(y.endDate,"dd MMM")}`:"Custom"})]}),P&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-50 bg-white dark:bg-gray-950 border border-border rounded-lg shadow-xl w-[300px] sm:w-auto overflow-hidden",children:i.jsx("div",{className:"text-gray-900",children:i.jsx(wm.DateRangePicker,{onChange:Ce,months:1,ranges:w,direction:"horizontal",maxDate:new Date})})})]})]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:s==="blue"?"#1a3a6e":s==="purple"?"#5B21B6":s==="red"?"#991B1B":s==="amber"?"#B45309":"#006B3F"},children:i.jsx(xu,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Present"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ie.present})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:s==="blue"?"#1a3a6e":s==="purple"?"#5B21B6":s==="red"?"#991B1B":s==="amber"?"#B45309":"#006B3F"},children:i.jsx(Ox,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Absent"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ie.absent})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:s==="blue"?"#1a3a6e":s==="purple"?"#5B21B6":s==="red"?"#991B1B":s==="amber"?"#B45309":"#006B3F"},children:i.jsx($c,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Overtime"}),i.jsxs("p",{className:"text-2xl font-bold text-primary-text",children:[ie.ot,"h"]})]}),i.jsxs("div",{className:"p-6 rounded-xl shadow-sm border border-border flex flex-col items-center justify-center text-center hover:shadow-md transition-shadow bg-card",children:[i.jsx("div",{className:"p-4 rounded-full mb-3 shadow-lg text-white",style:{backgroundColor:s==="blue"?"#1a3a6e":s==="purple"?"#5B21B6":s==="red"?"#991B1B":s==="amber"?"#B45309":"#006B3F"},children:i.jsx(UM,{className:"h-8 w-8"})}),i.jsx("p",{className:"text-sm font-medium mb-1 text-muted",children:"Comp Offs"}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:ie.compOff})]})]}),i.jsxs("div",{className:"bg-card rounded-xl shadow-sm border border-border overflow-hidden",children:[i.jsx("div",{className:"p-4 border-b border-border font-semibold text-primary-text",children:"Attendance Logs"}),i.jsx("div",{className:"divide-y divide-border",children:p?i.jsx("div",{className:"p-8 text-center text-muted",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})}):oe.length===0?i.jsx("div",{className:"p-8 text-center text-muted",children:"No records found for this period."}):oe.map((ve,Oe)=>i.jsxs("div",{className:"p-4 flex items-center justify-between hover:bg-gray-50 dark:hover:bg-gray-900/50 transition-colors",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-medium text-primary-text",children:ve.date}),i.jsx("p",{className:"text-xs text-muted",children:ve.day})]}),i.jsxs("div",{className:"flex flex-col items-end gap-1.5",children:[i.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider shadow-sm
                                            ${ve.status==="Present"?"bg-emerald-500 text-white dark:bg-emerald-600":ve.status==="Absent"?"bg-rose-500 text-white dark:bg-rose-600":ve.status==="Holiday"?"bg-amber-500 text-white dark:bg-amber-600":ve.status==="Weekend"?"bg-indigo-500 text-white dark:bg-indigo-600":"bg-gray-500 text-white dark:bg-gray-600"}`,children:ve.status}),(ve.checkIn!=="-"||ve.checkOut!=="-")&&i.jsxs("div",{className:"text-xs text-muted font-medium",children:[ve.checkIn," - ",ve.checkOut]}),ve.ot>0&&i.jsxs("span",{className:"text-[10px] text-blue-600 dark:text-blue-400 font-bold",children:["+",ve.ot,"h OT"]})]})]},Oe))})]})]}):i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Attendance Dashboard"})}),i.jsxs("div",{className:"hidden md:flex bg-white p-4 rounded-xl shadow-sm border border-gray-100 flex-wrap items-end gap-4",children:[i.jsxs("div",{className:"flex flex-wrap items-center gap-2",children:[["Today","Last 7 Days","This Month"].map(ve=>i.jsx(ne,{type:"button",onClick:()=>ye(ve),className:j===ve?"!text-white shadow-md border":"bg-white text-gray-700 border border-gray-300 hover:bg-gray-50",style:j===ve?{backgroundColor:s==="blue"?"#1a3a6e":"#006B3F",borderColor:s==="blue"?"#0f264a":"#005632"}:{},children:ve},ve)),i.jsxs("div",{className:"relative",ref:M,children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>O(!P),className:"hover:bg-gray-100",children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:j==="Custom"?`${We(y.startDate,"dd MMM, yyyy")} - ${We(y.endDate,"dd MMM, yyyy")}`:"Custom Range"})]}),P&&i.jsxs("div",{className:"absolute top-full left-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:[i.jsxs("div",{className:"flex items-center gap-2 p-3",children:[i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:We(y.startDate,"yyyy-MM-dd"),max:We(new Date,"yyyy-MM-dd"),onChange:ve=>{const Oe=new Date(ve.target.value);let Ve=y.endDate;Oe>Ve&&(Ve=Oe),_({startDate:Oe,endDate:Ve,key:"selection"}),C("Custom")}}),i.jsx("span",{className:"text-sm",children:"to"}),i.jsx("input",{type:"date",className:"border rounded px-2 py-1 text-sm",value:We(y.endDate,"yyyy-MM-dd"),max:We(new Date,"yyyy-MM-dd"),onChange:ve=>{const Oe=new Date(ve.target.value);let Ve=y.startDate;Oe<Ve&&(Ve=Oe),_({startDate:Ve,endDate:Oe,key:"selection"}),C("Custom")}})]}),i.jsx(wm.DateRangePicker,{onChange:Ce,months:n?1:2,ranges:w,direction:"horizontal",maxDate:new Date})]})]})]}),i.jsxs("div",{className:"flex flex-wrap items-center gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Report Type"}),i.jsxs("select",{className:`border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 ${s==="blue"?"focus:ring-[#1a3a6e]":"focus:ring-green-500"} outline-none`,value:W,onChange:ve=>G(ve.target.value),children:[i.jsx("option",{value:"basic",children:"Basic Report"}),i.jsx("option",{value:"log",children:"Attendance Log"}),i.jsx("option",{value:"monthly",children:"Monthly Report"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Employee"}),i.jsxs("select",{className:`border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 ${s==="blue"?"focus:ring-[#1a3a6e]":"focus:ring-green-500"} outline-none max-w-[200px]`,value:D,onChange:ve=>I(ve.target.value),children:[i.jsx("option",{value:"all",children:"All Employees"}),a.map(ve=>i.jsx("option",{value:ve.id,children:ve.name},ve.id))]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Status"}),i.jsxs("select",{className:`border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 ${s==="blue"?"focus:ring-[#1a3a6e]":"focus:ring-green-500"} outline-none max-w-[200px]`,value:F,onChange:ve=>q(ve.target.value),children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"Present",children:"Present"}),i.jsx("option",{value:"Half Day",children:"Half Day"}),i.jsx("option",{value:"Absent",children:"Absent"}),i.jsx("option",{value:"On Leave (Full)",children:"On Leave (Full)"}),i.jsx("option",{value:"On Leave (Half)",children:"On Leave (Half)"}),i.jsx("option",{value:"Holiday",children:"Holiday"}),i.jsx("option",{value:"Weekend",children:"Weekend"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Record Type"}),i.jsxs("select",{className:`border rounded-md px-3 py-1.5 text-sm bg-white focus:ring-2 ${s==="blue"?"focus:ring-[#1a3a6e]":"focus:ring-green-500"} outline-none max-w-[200px]`,value:B,onChange:ve=>U(ve.target.value),children:[i.jsx("option",{value:"all",children:"All Records"}),i.jsx("option",{value:"complete",children:"Complete (Check-in & Check-out)"}),i.jsx("option",{value:"missing_checkout",children:"Missing Check-out"}),i.jsx("option",{value:"missing_checkin",children:"Missing Check-in"}),i.jsx("option",{value:"incomplete",children:"Incomplete (Any Missing)"})]})]})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[i.jsx(jo,{title:"Total Employees",value:d?.totalEmployees||0,icon:Ji}),i.jsx(jo,{title:`Present ${Re}`,value:d?.presentToday||0,icon:xu}),i.jsx(jo,{title:`Absent ${Re}`,value:d?.absentToday||0,icon:Ox}),i.jsx(jo,{title:`On Leave ${Re}`,value:d?.onLeaveToday||0,icon:$c})]}),i.jsxs("div",{className:"hidden md:grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsx(FL,{title:"Attendance Trend",icon:eJ,children:d?i.jsx(gce,{data:d.attendanceTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})}),i.jsx(FL,{title:"Productivity Trend (Avg. Hours)",icon:UM,children:d?i.jsx(xce,{data:d.productivityTrend}):i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto mt-20"})})]}),i.jsx("div",{style:{position:"fixed",top:"0",left:"0",width:"1123px",zIndex:-1e3,opacity:0,pointerEvents:"none"},children:i.jsx("div",{ref:K,className:"w-full bg-white",children:Ue})}),i.jsxs("div",{className:"hidden md:block bg-white p-6 rounded-xl shadow-sm border border-gray-100 overflow-auto max-h-[600px]",children:[i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsx("h2",{className:"text-lg font-semibold",children:"Report Preview"}),re&&i.jsxs(ne,{type:"button",onClick:Ye,disabled:Z,style:{backgroundColor:s==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:s==="blue"?"#0f264a":"#005632"},className:"border hover:opacity-90 !text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[Z?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(r3,{className:"mr-2 h-4 w-4"}),Z?"Generating...":"Download CSV"]})]}),i.jsx("div",{className:"border p-4 rounded bg-gray-50",children:Ue})]}),ae&&i.jsx(pt,{message:ae.message,type:ae.type,onDismiss:()=>ee(null)})]})},_ce=n=>n.toLowerCase().split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1)).join(" "),jce=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},Nce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState([]),[a,o]=E.useState(!0),[l,c]=E.useState(!1),[d,h]=E.useState(null),[p,x]=E.useState(""),[y,_]=E.useState(""),[w,j]=E.useState(""),[C,P]=E.useState(""),[O,M]=E.useState(null),[D,I]=E.useState([]),[F,q]=E.useState(!1),[B,U]=E.useState(""),W=n&&["admin","hr"].includes(n.role);E.useEffect(()=>{(async()=>{if(n)try{const[se,ie]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(se),s(ie)}catch(se){console.error(se),h({message:"Failed to load locations.",type:"error"})}finally{o(!1)}})()},[n]);const G=H=>{const se=H.target.value,ie=_ce(se);x(ie)},Z=async()=>{c(!0);try{const H=await ay().catch(()=>null);let se,ie;if(H&&H.coords&&(se=H.coords.latitude,ie=H.coords.longitude),se===void 0||ie===void 0){const ce=await new Promise(oe=>{navigator.geolocation.getCurrentPosition(de=>oe(de),()=>oe(null),{enableHighAccuracy:!0,timeout:1e4,maximumAge:0})});ce&&ce.coords&&(se=ce.coords.latitude,ie=ce.coords.longitude)}if(se===void 0||ie===void 0)throw new Error("Unable to retrieve current location.");_(se.toString()),j(ie.toString());try{const ce=await mm(se,ie);P(ce)}catch(ce){console.warn("Reverse geocode failed:",ce)}h({message:"Coordinates and address filled. Please enter a location name.",type:"success"})}catch(H){console.error(H),h({message:H.message||"Failed to get current location.",type:"error"})}finally{c(!1)}},Y=async()=>{if(!n||D.length===0){h({message:"Please select at least one location.",type:"error"});return}q(!0);try{await Promise.all(D.map(se=>ue.assignLocationToUser(n.id,se))),h({message:"Locations assigned successfully!",type:"success"}),I([]);const H=await ue.getUserLocations(n.id);t(H)}catch(H){console.error(H),h({message:H.message||"Failed to assign locations.",type:"error"})}finally{q(!1)}},ae=H=>{I(se=>se.includes(H)?se.filter(ie=>ie!==H):[...se,H])},ee=async()=>{if(!n)return;if(!O&&!W){h({message:"You do not have permission to add locations.",type:"error"});return}if(!p.trim()){h({message:"Please enter a location name.",type:"error"});return}const H=parseFloat(y),se=parseFloat(w);if(isNaN(H)||isNaN(se)){h({message:"Please provide valid coordinates.",type:"error"});return}if(r.find(ce=>ce.id!==O&&ce.name?.toLowerCase()===p.toLowerCase())){h({message:`Location "${p}" already exists. Please use a different name.`,type:"error"});return}if(!O&&r.find(oe=>jce(H,se,oe.latitude,oe.longitude)<10)){h({message:"A location already exists at these coordinates.",type:"error"});return}c(!0);try{if(O)await ue.updateLocation(O,{name:p,latitude:H,longitude:se,radius:100,address:C||null}),h({message:"Location updated successfully.",type:"success"});else{const te=await ue.createLocation({name:p,latitude:H,longitude:se,radius:100,address:C||null,createdBy:n.id});await ue.assignLocationToUser(n.id,te.id),h({message:"Location added successfully.",type:"success"})}const[oe,de]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(oe),s(de),K()}catch(ce){console.error(ce),h({message:ce.message||"Failed to save location.",type:"error"})}finally{c(!1)}},me=H=>{M(H.id),x(H.name||""),_(H.latitude.toString()),j(H.longitude.toString()),P(H.address||""),window.scrollTo({top:0,behavior:"smooth"})},$=async H=>{if(!n||!W){h({message:"You do not have permission to delete locations.",type:"error"});return}if(window.confirm("Are you sure you want to delete this location? It will be removed from all users."))try{await ue.deleteLocation(H),h({message:"Location deleted successfully.",type:"success"});const[se,ie]=await Promise.all([ue.getUserLocations(n.id),ue.getLocations()]);t(se),s(ie)}catch(se){console.error(se),h({message:se.message||"Failed to delete location.",type:"error"})}},K=()=>{x(""),_(""),j(""),P(""),M(null)},re=e.filter((H,se,ie)=>H.address?se===ie.findIndex(ce=>ce.address===H.address):!0);return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("h2",{className:"text-2xl font-bold mb-4 flex items-center",children:[i.jsx(kl,{className:"h-6 w-6 mr-2"})," My Locations"]}),i.jsxs("p",{className:"text-muted mb-6",children:["These are the geofenced locations assigned to you. You may check in/out only when within one of these locations. ",W?"Use the form below to add a new location.":"You can edit location names by clicking the edit button."]}),(W||O)&&i.jsxs("div",{className:"bg-gray-50 border border-border rounded-lg p-4 mb-6",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4",children:O?"Edit Location":"Add New Location"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[i.jsx(we,{label:"Location Name (required) *",id:"locationName",value:p,onChange:G,placeholder:"e.g. Office HQ",required:!0}),i.jsx(we,{label:"Latitude",id:"latitude",type:"number",value:y,onChange:H=>_(H.target.value),placeholder:"12.9716",step:"any",disabled:O&&!W}),i.jsx(we,{label:"Longitude",id:"longitude",type:"number",value:w,onChange:H=>j(H.target.value),placeholder:"77.5946",step:"any",disabled:O&&!W}),i.jsx(we,{label:"Address (optional)",id:"address",value:C,onChange:H=>P(H.target.value),placeholder:"Street, City, State",disabled:O&&!W})]}),i.jsxs("div",{className:"flex gap-4 flex-wrap",children:[W&&i.jsxs(ne,{onClick:Z,variant:"secondary",isLoading:l,disabled:l,children:[i.jsx(d3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),i.jsx(ne,{onClick:ee,isLoading:l,disabled:l||!p.trim(),children:O?"Save Changes":"Add Location"}),O&&i.jsx(ne,{onClick:K,variant:"secondary",children:"Cancel"})]})]})]}),i.jsx("div",{className:"mt-6",children:a?i.jsx("p",{children:"Loading locations..."}):e.length===0?i.jsx("div",{children:W?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations assigned. Use the form above to add one."}):i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[i.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"Select Your Locations"}),i.jsx("p",{className:"text-sm text-blue-800 mb-4",children:"You don't have any locations assigned yet. Please select the locations where you'll be working from the list below."})]}),r.length===0?i.jsx("p",{className:"text-muted text-center",children:"No locations available. Contact your administrator."}):i.jsxs("div",{children:[i.jsx("div",{className:"mb-4",children:i.jsx(we,{type:"text",placeholder:"Search by name or address...",value:B,onChange:H=>U(H.target.value)})}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3 mb-4",children:r.filter(H=>B===""||H.name?.toLowerCase().includes(B.toLowerCase())||H.address?.toLowerCase().includes(B.toLowerCase())).map(H=>i.jsx("div",{onClick:()=>ae(H.id),className:`border rounded-lg p-4 cursor-pointer transition-all ${D.includes(H.id)?"border-accent bg-accent/10 shadow-md":"border-border hover:border-accent/50 hover:bg-gray-50"}`,children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("input",{type:"checkbox",checked:D.includes(H.id),onChange:()=>{},className:"mt-1 mr-3 h-5 w-5 text-accent rounded focus:ring-accent"}),i.jsxs("div",{className:"flex-1",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:H.name||"Unnamed Location"}),i.jsx("button",{type:"button",onClick:se=>{se.stopPropagation(),me(H)},className:"text-blue-600 hover:text-blue-800 p-1",title:"Edit Name",children:i.jsx(dr,{className:"h-4 w-4"})})]}),i.jsx("p",{className:"text-sm text-muted mt-1",children:H.address||"No address"}),i.jsxs("p",{className:"text-xs text-muted mt-2",children:["Coordinates: ",H.latitude.toFixed(4),", ",H.longitude.toFixed(4),"  Radius: ",H.radius,"m"]})]})]})},H.id))}),i.jsx("div",{className:"flex justify-center",children:i.jsx(ne,{onClick:Y,isLoading:F,disabled:F||D.length===0,children:D.length===0?"Select Locations Above":`Assign ${D.length} Location${D.length>1?"s":""}`})})]})]})}):i.jsxs("div",{className:"space-y-4 md:space-y-0 md:grid md:grid-cols-1 md:gap-4",children:[i.jsx("div",{className:"md:hidden space-y-4",children:re.map(H=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"font-bold text-primary-text",children:H.name||H.address||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:H.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-500 hover:text-blue-700 p-1",title:W?"Edit Location":"Edit Name",onClick:()=>me(H),children:i.jsx(dr,{className:"h-5 w-5"})}),W&&i.jsx("button",{type:"button",className:"text-red-500 hover:text-red-700 p-1",title:"Delete Location",onClick:()=>$(H.id),children:i.jsx(rn,{className:"h-5 w-5"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[H.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]})]})]})]},H.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:re.map(H=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:H.name||"-"}),i.jsx("td",{className:"p-3",children:H.radius}),i.jsxs("td",{className:"p-3",children:[H.latitude?.toFixed(4),", ",H.longitude?.toFixed(4)]}),i.jsx("td",{className:"p-3",children:H.address||"-"}),i.jsxs("td",{className:"p-3 flex gap-2",children:[i.jsx("button",{type:"button",className:"text-blue-600 hover:text-blue-800",title:W?"Edit Location":"Edit Name",onClick:()=>me(H),children:i.jsx(dr,{className:"h-4 w-4"})}),W&&i.jsx("button",{type:"button",className:"text-red-600 hover:text-red-800",title:"Delete Location",onClick:()=>$(H.id),children:i.jsx(rn,{className:"h-4 w-4"})})]})]},H.id))})]})})]})})]})},qL=()=>{const n=St(),e=Zr(),{toggleCheckInStatus:t,isCheckedIn:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=e.pathname.includes("check-in"),d=c?"Check In":"Check Out",h=c?Dx:_o,p=c?"bg-emerald-100":"bg-red-100",x=c?"text-emerald-600":"text-red-600",y=async()=>{a(!0);const{success:w,message:j}=await t();l({message:j,type:w?"success":"error"}),a(!1),w&&setTimeout(()=>{n("/profile",{replace:!0})},1500)},_=()=>{n(-1)};return i.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center p-4 relative",children:[o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)}),i.jsxs("div",{className:"w-full max-w-md bg-card rounded-2xl shadow-card p-8 text-center relative z-10",children:[i.jsx("div",{className:"flex justify-center mb-6",children:i.jsx("div",{className:`p-4 rounded-full ${p}`,children:i.jsx(h,{className:`h-10 w-10 ${x}`})})}),i.jsx("h1",{className:"text-2xl font-bold text-primary-text mb-2",children:d}),i.jsxs("p",{className:"text-muted mb-8",children:["Are you sure you want to ",d.toLowerCase(),"?"]}),i.jsxs("div",{className:"flex flex-col gap-3",children:[i.jsxs(ne,{onClick:y,variant:c?"primary":"danger",className:"w-full !py-3 !text-lg shadow-lg",isLoading:s,children:["Yes, ",d]}),i.jsx(ne,{onClick:_,variant:"secondary",className:"w-full !py-3",disabled:s,children:"Cancel"})]})]})]})},Sce=()=>{const{attendance:n,officeHolidays:e,fieldHolidays:t,recurringHolidays:r,addHoliday:s,removeHoliday:a,addRecurringHoliday:o,removeRecurringHoliday:l,updateAttendanceSettings:c}=yi(),d={minimumHoursFullDay:8,minimumHoursHalfDay:4,annualEarnedLeaves:5,annualSickLeaves:12,monthlyFloatingLeaves:1,annualCompOffLeaves:5,enableAttendanceNotifications:!1,sickLeaveCertificateThreshold:2},h={office:{...d,...n?.office},field:{...d,...n?.field}},[p,x]=E.useState(h),[y,_]=E.useState(!1),[w,j]=E.useState(!1),[C,P]=E.useState("office"),[O,M]=E.useState(""),[D,I]=E.useState(""),[F,q]=E.useState(3),[B,U]=E.useState("Saturday"),[W,G]=E.useState(null);E.useEffect(()=>{x({office:{...d,...n?.office},field:{...d,...n?.field}})},[n]),E.useEffect(()=>{_(JSON.stringify(p)!==JSON.stringify(n))},[p,n]);const Z=p[C],Y=C==="office"?e:t,ae=async $=>{if($.preventDefault(),O&&D){if(Y.some(K=>K.date===D)){G({message:"A holiday for this date already exists.",type:"error"});return}try{await s(C,{name:O,date:D}),M(""),I(""),G({message:"Holiday added successfully.",type:"success"})}catch{G({message:"Failed to add holiday.",type:"error"})}}else G({message:"Please provide both a name and a date.",type:"error"})},ee=($,K)=>{x(re=>({...re,[C]:{...re[C],[$]:K}}))},me=async()=>{j(!0);try{await ue.saveAttendanceSettings(p),c(p),G({message:"Attendance rules saved successfully!",type:"success"})}catch{G({message:"Failed to save attendance rules.",type:"error"})}finally{j(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full pb-40",children:[W&&i.jsx(pt,{message:W.message,type:W.type,onDismiss:()=>G(null)}),i.jsx(na,{title:"Attendance & Leave Rules",children:i.jsxs(ne,{onClick:me,isLoading:w,disabled:!y,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Set company-wide rules for attendance and leave calculation."}),i.jsx("div",{className:"mb-6 border-b border-border",children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsx("button",{onClick:()=>P("office"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${C==="office"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Office Staff"}),i.jsx("button",{onClick:()=>P("field"),className:`whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${C==="field"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-accent-dark hover:border-accent"}`,children:"Field Staff"})]})}),C==="office"&&i.jsx("p",{className:"text-sm text-white -mt-4 mb-4",children:"These rules apply to Admin, HR, and Finance roles."}),C==="field"&&i.jsx("p",{className:"text-sm text-white -mt-4 mb-4",children:"These rules apply to all other roles (e.g., Field Officers, Managers)."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx($c,{className:"mr-2 h-5 w-5 text-muted"}),"Work Hours"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(we,{label:"Minimum Hours for Full Day",id:"minHoursFull",type:"number",value:Z.minimumHoursFullDay,onChange:$=>ee("minimumHoursFullDay",parseFloat($.target.value)||0)}),i.jsx(we,{label:"Minimum Hours for Half Day",id:"minHoursHalf",type:"number",value:Z.minimumHoursHalfDay,onChange:$=>ee("minimumHoursHalfDay",parseFloat($.target.value)||0)})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Ex,{className:"mr-2 h-5 w-5 text-muted"}),"Leave Allocation"]}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(we,{label:"Annual Earned Leaves",id:"annualEarnedLeaves",type:"number",value:Z.annualEarnedLeaves,onChange:$=>ee("annualEarnedLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Annual Sick Leaves",id:"annualSickLeaves",type:"number",value:Z.annualSickLeaves,onChange:$=>ee("annualSickLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Monthly Floating Holidays",id:"monthlyFloatingLeaves",type:"number",value:Z.monthlyFloatingLeaves,onChange:$=>ee("monthlyFloatingLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Annual Compensatory Off",id:"annualCompOffLeaves",type:"number",value:Z.annualCompOffLeaves,onChange:$=>ee("annualCompOffLeaves",parseInt($.target.value,10)||0)}),i.jsx(we,{label:"Sick Leave Cert. After (Days)",id:"sickLeaveCertThreshold",type:"number",value:Z.sickLeaveCertificateThreshold,onChange:$=>ee("sickLeaveCertificateThreshold",parseInt($.target.value,10)||0),title:"Require a doctor's certificate if total sick leave taken exceeds this number of days."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Of,{className:"mr-2 h-5 w-5 text-muted"}),"Notifications"]}),i.jsx(Dn,{id:"attendance-notifications",label:"Enable Check-in/Check-out Notifications",description:"Send a notification to Site Managers, Ops Managers, and HR when a Field Officer checks in or out.",checked:Z.enableAttendanceNotifications,onChange:$=>ee("enableAttendanceNotifications",$.target.checked)})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Da,{className:"mr-2 h-5 w-5 text-muted"}),"Recurring Holidays"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add Recurring Holiday"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsxs(Ze,{label:"Occurrence",value:F,onChange:$=>q(parseInt($.target.value)),children:[i.jsx("option",{value:1,children:"1st"}),i.jsx("option",{value:2,children:"2nd"}),i.jsx("option",{value:3,children:"3rd"}),i.jsx("option",{value:4,children:"4th"}),i.jsx("option",{value:5,children:"5th"})]}),i.jsxs(Ze,{label:"Day",value:B,onChange:$=>U($.target.value),children:[i.jsx("option",{value:"Monday",children:"Monday"}),i.jsx("option",{value:"Tuesday",children:"Tuesday"}),i.jsx("option",{value:"Wednesday",children:"Wednesday"}),i.jsx("option",{value:"Thursday",children:"Thursday"}),i.jsx("option",{value:"Friday",children:"Friday"}),i.jsx("option",{value:"Saturday",children:"Saturday"}),i.jsx("option",{value:"Sunday",children:"Sunday"})]}),i.jsxs(ne,{type:"button",onClick:async()=>{try{await o({day:B,n:F,type:C}),G({message:"Recurring holiday added successfully.",type:"success"})}catch{G({message:"Failed to add recurring holiday.",type:"error"})}},size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Rule"]})]})]}),i.jsxs("div",{className:"mt-4 space-y-2",children:[r.filter($=>($.type||"office")===C).map(($,K)=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsxs("p",{className:"font-medium text-primary-text truncate",children:[$.n===1?"1st":$.n===2?"2nd":$.n===3?"3rd":$.n+"th"," ",$.day]}),i.jsx("p",{className:"text-sm text-muted",children:"Repeats every month"})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ne,{variant:"icon",onClick:async()=>{if($.id)try{await l($.id),G({message:"Recurring holiday removed successfully.",type:"success"})}catch{G({message:"Failed to remove recurring holiday.",type:"error"})}},className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},$.id||K)),r.filter($=>($.type||"office")===C).length===0&&i.jsx("p",{className:"text-center text-muted py-4",children:"No recurring holidays configured."})]})]}),i.jsxs("section",{className:"pt-6 border-t border-border",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Da,{className:"mr-2 h-5 w-5 text-muted"}),"Holiday List"]}),i.jsxs("div",{className:"p-4 bg-page rounded-lg",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Add New Holiday"}),i.jsxs("form",{onSubmit:ae,className:"grid grid-cols-1 sm:grid-cols-3 gap-4 items-end",children:[i.jsx(we,{label:"Holiday Name",id:"holidayName",value:O,onChange:$=>M($.target.value)}),i.jsx(En,{label:"Date",id:"holidayDate",value:D,onChange:I}),i.jsxs(ne,{type:"submit",size:"sm",className:"w-full sm:w-auto",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add"]})]})]}),i.jsx("div",{className:"mt-4 space-y-2",children:Y.length>0?Y.map($=>i.jsxs("div",{className:"flex justify-between items-start p-4 pr-6 border border-white/10 rounded-lg bg-white/5 mb-2",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("p",{className:"font-medium text-primary-text truncate",children:$.name}),i.jsx("p",{className:"text-sm text-muted",children:new Date($.date.replace(/-/g,"/")).toLocaleDateString("en-GB",{day:"numeric",month:"long",year:"numeric"})})]}),i.jsx("div",{className:"ml-4 shrink-0",children:i.jsx(ne,{variant:"icon",onClick:()=>a(C,$.id),"aria-label":`Remove ${$.name}`,className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})})]},$.id)):i.jsxs("p",{className:"text-center text-muted py-4",children:["No holidays added yet for ",C," staff."]})})]})]})]})},Cce=()=>{const{user:n}=jt(),{officeHolidays:e,fieldHolidays:t,attendance:r,recurringHolidays:s}=yi(),[a,o]=E.useState(new Date),[l,c]=E.useState([]),[d,h]=E.useState(!1),p=E.useMemo(()=>n?.role==="field_officer"?t:e,[n,t,e]),x=E.useMemo(()=>{const O=n?.role==="field_officer"?"field":"office";return s.filter(M=>(M.type||"office")===O)},[n,s]);E.useEffect(()=>{console.log("Active Recurring Rules:",x)},[x]);const y=E.useMemo(()=>{const O=[],M=xi(a),D=Ma(a),I=yo({start:M,end:D}),F=(n?.role==="field_officer"?r?.field?.monthlyFloatingLeaves:r?.office?.monthlyFloatingLeaves)??0;let q=0;return x.forEach(B=>{if(q>=F)return;let U=0;for(const W of I)if(We(W,"EEEE").toLowerCase()===B.day.toLowerCase()&&(U++,U===B.n)){O.push(W),q++;break}}),O},[a,x,r,n]);E.useEffect(()=>{console.log("Calculated Recurring Holiday Dates:",y)},[y]),E.useEffect(()=>{const O=async()=>{if(n){h(!0);try{const I=xi(a).toISOString(),F=Ma(a).toISOString(),q=await ue.getAttendanceEvents(n.id,I,F);c(q)}catch(I){console.error("Failed to fetch attendance events",I)}finally{h(!1)}}},M=async()=>{try{console.log("Fetching attendance settings...");const I=await ue.getAttendanceSettings();console.log("Fetched settings:",I),yi.getState().updateAttendanceSettings(I)}catch(I){console.error("Failed to fetch attendance settings",I)}},D=async()=>{try{console.log("Fetching recurring holidays...");const I=await ue.getRecurringHolidays();console.log("Fetched recurring holidays:",I),yi.setState({recurringHolidays:I})}catch(I){console.error("Failed to fetch recurring holidays",I)}};O(),M(),D()},[n,a]);const _=E.useMemo(()=>yo({start:xi(a),end:Ma(a)}),[a]),w=O=>{const M=l.some(q=>mf(new Date(q.timestamp),O)&&(q.type.toLowerCase().includes("check")||q.type.toLowerCase().includes("in"))),D=y.some(q=>mf(q,O)),I=p.some(q=>mf(new Date(q.date),O));return(D||I)&&M?"holiday-present":D?"floating-holiday":I?"holiday":M?"present":GW(Vc(new Date),Vc(O))?"absent":"neutral"},j=O=>{switch(O){case"present":return"bg-emerald-500 text-white border-emerald-600 shadow-sm";case"absent":return"bg-rose-500 text-white border-rose-600 shadow-sm";case"holiday":return"bg-red-600 text-white border-red-700 shadow-sm";case"floating-holiday":return"bg-amber-500 text-white border-amber-600 shadow-sm";case"holiday-present":return"bg-violet-600 text-white border-violet-700 shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},C=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],P=y1(xi(a));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Attendance Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(w1(a)),children:i.jsx(oy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:We(a,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>o(ty(a,1)),children:i.jsx(If,{className:"h-3 w-3"})})]})]}),d?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[C.map(O=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:O},O)),Array.from({length:P}).map((O,M)=>i.jsx("div",{className:"aspect-square"},`empty-${M}`)),_.map(O=>{const M=w(O),D=j(M);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${D} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:We(O,"d")})},O.toISOString())})]}),i.jsxs("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center flex-wrap",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-emerald-500 border border-emerald-600 rounded-sm"})," Present"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-rose-500 border border-rose-600 rounded-sm"})," Absent"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-red-600 border border-red-700 rounded-sm"})," Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-amber-500 border border-amber-600 rounded-sm"})," Floating Holiday"]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:"w-2 h-2 bg-violet-600 border border-violet-700 rounded-sm"})," Holiday Present"]})]})]})},Tce=({logs:n,isLoading:e=!1})=>{const{colorScheme:t}=an(),[r,s]=E.useState(new Date),a=E.useMemo(()=>yo({start:xi(r),end:Ma(r)}),[r]),o=h=>n.some(x=>{const y=new Date(x.dateEarned.replace(/-/g,"/"));return mf(y,h)})?"earned":"neutral",l=h=>{switch(h){case"earned":return t==="blue"?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-[#006B3F] text-white border-[#005632] shadow-sm";default:return"bg-gray-50 text-gray-400 border-gray-100"}},c=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],d=y1(xi(r));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-none bg-transparent p-3 rounded-xl shadow-none w-full md:w-full md:max-w-[320px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"Comp Off Tracker"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>s(w1(r)),children:i.jsx(oy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-sm",children:We(r,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"btn-icon !p-1 h-6 w-6",onClick:()=>s(ty(r,1)),children:i.jsx(If,{className:"h-3 w-3"})})]})]}),e?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[c.map(h=>i.jsx("div",{className:"text-center text-xs font-medium text-muted py-1",children:h},h)),Array.from({length:d}).map((h,p)=>i.jsx("div",{className:"aspect-square"},`empty-${p}`)),a.map(h=>{const p=o(h),x=l(p);return i.jsx("div",{className:`aspect-square rounded border flex flex-col items-center justify-center ${x} transition-colors`,children:i.jsx("span",{className:"text-sm font-semibold",children:We(h,"d")})},h.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-xs text-muted justify-center",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:`w-2 h-2 ${t==="blue"?"bg-blue-600 border-blue-700":"bg-[#006B3F] border-[#005632]"} border rounded-sm`})," Comp Off Earned"]})})]})},kce=()=>{const{colorScheme:n}=an(),{user:e}=jt(),[t,r]=E.useState(new Date),[s,a]=E.useState([]),[o,l]=E.useState(!1);E.useEffect(()=>{(async()=>{if(e){l(!0);try{const y=xi(t).toISOString(),_=Ma(t).toISOString(),w=await ue.getAttendanceEvents(e.id,y,_);a(w)}catch(y){console.error("Failed to fetch attendance events",y)}finally{l(!1)}}})()},[e,t]);const c=E.useMemo(()=>yo({start:xi(t),end:Ma(t)}),[t]),d=x=>{const y=s.filter(O=>mf(new Date(O.timestamp),x));if(y.length===0)return 0;const _=[...y].sort((O,M)=>new Date(O.timestamp).getTime()-new Date(M.timestamp).getTime());let w=0,j=null;_.forEach(O=>{const M=new Date(O.timestamp);O.type==="check-in"?j=M:O.type==="check-out"&&j&&(w+=pf(M,j),j=null)});const C=w/60,P=Math.max(0,C-8);return parseFloat(P.toFixed(1))},h=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],p=y1(xi(t));return i.jsxs("div",{className:"md:bg-card md:p-3 md:rounded-xl md:shadow-card border-0 bg-transparent p-3 rounded-xl shadow-none w-full",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsx("h3",{className:"text-sm font-semibold text-primary-text",children:"OT Calendar"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>r(w1(t)),children:i.jsx(oy,{className:"h-3 w-3"})}),i.jsx("span",{className:"font-medium min-w-[80px] text-center text-xs",children:We(t,"MMMM yyyy")}),i.jsx(ne,{variant:"secondary",size:"sm",className:"!p-1 h-6 w-6",onClick:()=>r(ty(t,1)),children:i.jsx(If,{className:"h-3 w-3"})})]})]}),o?i.jsx("div",{className:"flex justify-center py-5",children:i.jsx(_t,{className:"h-5 w-5 animate-spin text-muted"})}):i.jsxs("div",{className:"grid grid-cols-7 gap-1",children:[h.map(x=>i.jsx("div",{className:"text-center text-[10px] font-medium text-muted py-1",children:x},x)),Array.from({length:p}).map((x,y)=>i.jsx("div",{className:"aspect-square"},`empty-${y}`)),c.map(x=>{const y=d(x),_=y>0;return i.jsxs("div",{className:`aspect-square rounded border flex flex-col items-center justify-center transition-colors ${_?n==="blue"?"bg-blue-600 text-white border-blue-700 shadow-sm":"bg-[#006B3F] text-white border-[#005632] shadow-sm":"bg-gray-50 text-gray-400 border-gray-100"}`,children:[i.jsx("span",{className:"text-xs font-semibold",children:We(x,"d")}),_&&i.jsxs("span",{className:"text-[8px] font-bold",children:["+",y,"h"]})]},x.toISOString())})]}),i.jsx("div",{className:"mt-3 flex gap-3 text-[10px] text-muted justify-center flex-wrap",children:i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("div",{className:`w-2 h-2 ${n==="blue"?"bg-blue-600 border-blue-700":"bg-[#006B3F] border-[#005632]"} border rounded-sm`})," Overtime (>8h)"]})})]})},Pce=()=>{const{user:n}=jt(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("day"),[l,c]=E.useState(new Date),[d,h]=E.useState({});Rt("(max-width: 767px)");const p=async()=>{if(n){s(!0);try{let C,P;switch(a){case"day":C=Vc(l),P=p1(l);break;case"week":C=Co(l,{weekStartsOn:1}),P=nP(l,{weekStartsOn:1});break;case"month":C=xi(l),P=Ma(l);break}const O=await ue.getAttendanceEvents(n.id,C.toISOString(),P.toISOString());t(O);const M=O.filter(D=>D.latitude&&D.longitude).map(D=>({lat:D.latitude,lon:D.longitude}));if(M.length>0)try{const D=await ue.batchResolveAddresses(M);h(D)}catch(D){console.error("Failed to fetch location addresses:",D)}}catch(C){console.error("Failed to fetch attendance events:",C)}finally{s(!1)}}};E.useEffect(()=>{p()},[n,a,l]);const x=E.useMemo(()=>{const C={};return e.forEach(P=>{const O=We(new Date(P.timestamp),"yyyy-MM-dd");C[O]||(C[O]={date:O,events:[],checkIns:[],checkOuts:[],totalMinutes:0}),C[O].events.push(P),P.type==="check-in"?C[O].checkIns.push(P):P.type==="check-out"&&C[O].checkOuts.push(P)}),Object.values(C).forEach(P=>{const O=[...P.events].sort((I,F)=>new Date(I.timestamp).getTime()-new Date(F.timestamp).getTime());let M=0,D=null;O.forEach(I=>{const F=new Date(I.timestamp);I.type==="check-in"?D=F:I.type==="check-out"&&D&&(M+=pf(F,D),D=null)}),P.totalMinutes=M}),Object.values(C).sort((P,O)=>O.date.localeCompare(P.date))},[e]),y=C=>{const P=Math.floor(C/60),O=C%60;return`${P}h ${O}m`},_=C=>{o(C)},w=C=>{const P=new Date(l);switch(a){case"day":P.setDate(P.getDate()+(C==="next"?1:-1));break;case"week":P.setDate(P.getDate()+(C==="next"?7:-7));break;case"month":P.setMonth(P.getMonth()+(C==="next"?1:-1));break}c(P)},j=()=>{switch(a){case"day":return We(l,"dd MMM, yyyy");case"week":const C=Co(l,{weekStartsOn:1}),P=nP(l,{weekStartsOn:1});return`${We(C,"dd MMM")} - ${We(P,"dd MMM, yyyy")}`;case"month":return We(l,"MMMM yyyy")}};return n?i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full",children:[i.jsxs("div",{className:"flex items-center gap-3 mb-5",children:[i.jsx("div",{className:"p-1.5 bg-indigo-50 rounded-lg",children:i.jsx($c,{className:"h-5 w-5 text-indigo-600"})}),i.jsx("h3",{className:"text-lg md:text-xl font-bold text-gray-900",children:"Employee Log"})]}),i.jsxs("div",{className:"mb-6 space-y-4",children:[i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{onClick:()=>_("day"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="day"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Day"}),i.jsx("button",{onClick:()=>_("week"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="week"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Week"}),i.jsx("button",{onClick:()=>_("month"),className:`flex-1 px-4 py-2 rounded-lg font-medium transition-all ${a==="month"?"bg-indigo-600 text-white shadow-md":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"Month"})]}),i.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-lg p-3",children:[i.jsx("button",{onClick:()=>w("prev"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""}),i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-gray-900",children:[i.jsx(Da,{className:"h-4 w-4"}),i.jsx("span",{children:j()})]}),i.jsx("button",{onClick:()=>w("next"),className:"px-3 py-1 bg-white rounded-md shadow-sm hover:bg-gray-100 transition-colors",children:""})]})]}),i.jsx("div",{className:"space-y-4",children:r?i.jsx("div",{className:"flex items-center justify-center py-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-indigo-600"})}):x.length===0?i.jsxs("div",{className:"text-center py-10 text-gray-500",children:[i.jsx(Da,{className:"h-12 w-12 mx-auto mb-3 text-gray-300"}),i.jsx("p",{className:"font-medium",children:"No attendance records found"}),i.jsx("p",{className:"text-sm mt-1",children:"Check-in to start tracking your attendance"})]}):x.map(C=>i.jsxs("div",{className:"bg-gradient-to-br from-white to-gray-50 rounded-xl border border-gray-200 overflow-hidden",children:[i.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-500 px-4 py-3 flex justify-between items-center",children:[i.jsxs("div",{className:"flex items-center gap-2 text-white",children:[i.jsx(Da,{className:"h-4 w-4"}),i.jsx("span",{className:"font-semibold",children:We(new Date(C.date),"EEEE, dd MMMM yyyy")})]}),i.jsx("div",{className:"text-white text-sm font-medium bg-white/20 px-3 py-1 rounded-full",children:y(C.totalMinutes)})]}),i.jsx("div",{className:"p-4 space-y-3",children:C.events.sort((P,O)=>new Date(P.timestamp).getTime()-new Date(O.timestamp).getTime()).map((P,O)=>i.jsx("div",{className:`p-3 rounded-lg border-l-4 ${P.type==="check-in"?"bg-emerald-50 border-emerald-500":"bg-rose-50 border-rose-500"}`,children:i.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-2",children:[i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:`p-2 rounded-lg ${P.type==="check-in"?"bg-emerald-100 text-emerald-700":"bg-rose-100 text-rose-700"}`,children:i.jsx($c,{className:"h-4 w-4"})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-semibold text-gray-900 capitalize",children:P.type.replace("-"," ")}),i.jsx("div",{className:"text-sm text-gray-600",children:We(new Date(P.timestamp),"hh:mm a")})]})]}),P.latitude&&P.longitude&&i.jsxs("div",{className:"flex items-start gap-2 text-sm text-gray-600 bg-white px-3 py-1.5 rounded-lg border border-gray-200 max-w-md",children:[i.jsx(kl,{className:"h-4 w-4 text-indigo-600 flex-shrink-0 mt-0.5"}),i.jsx("span",{className:"text-xs break-words",children:d[`${P.latitude.toFixed(6)},${P.longitude.toFixed(6)}`]||`${P.latitude.toFixed(4)}, ${P.longitude.toFixed(4)}`})]})]})},`${P.timestamp}-${O}`))}),i.jsx("div",{className:"bg-gray-50 px-4 py-3 border-t border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-ins:"}),i.jsx("span",{className:"ml-2 font-semibold text-emerald-600",children:C.checkIns.length})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500",children:"Check-outs:"}),i.jsx("span",{className:"ml-2 font-semibold text-rose-600",children:C.checkOuts.length})]})]})})]},C.date))})]}):null},zL=({title:n,value:e,icon:t})=>i.jsxs("div",{className:"bg-card p-3 md:p-4 rounded-xl flex flex-col md:flex-row items-center md:items-center gap-2 md:gap-4 border border-border text-center md:text-left w-full",children:[i.jsx("div",{className:"bg-accent-light p-2 md:p-3 rounded-full flex-shrink-0",children:i.jsx(t,{className:"h-5 w-5 md:h-6 md:w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"text-xs md:text-sm text-muted font-medium",children:n}),i.jsx("p",{className:"text-lg md:text-2xl font-bold text-primary-text",children:e})]})]}),Mce=({status:n})=>{const e={pending_manager_approval:"leave-status-chip--pending_manager_approval",pending_hr_confirmation:"leave-status-chip--pending_hr_confirmation",approved:"leave-status-chip--approved",rejected:"leave-status-chip--rejected"},t=n.replace(/_/g," ");return i.jsx("span",{className:`leave-status-chip ${e[n]}`,children:t})},Ece=n=>Pt({leaveType:xe().oneOf(["Earned","Sick","Floating","Comp Off"]).required("Leave type is required"),startDate:xe().required("Start date is required"),endDate:xe().required("End date is required").test("is-after-start","End date must be on or after start date",function(e){const{startDate:t}=this.parent;return!t||!e?!0:new Date(e.replace(/-/g,"/"))>=new Date(t.replace(/-/g,"/"))}),reason:xe().required("A reason for the leave is required").min(10,"Please provide a more detailed reason."),dayOption:xe().oneOf(["full","half"]).optional(),doctorCertificate:Wt().when(["leaveType","startDate","endDate"],{is:(e,t,r)=>e!=="Sick"||!t||!r?!1:Em(new Date(r.replace(/-/g,"/")),new Date(t.replace(/-/g,"/")))+1>n,then:e=>e.required(`A doctor's certificate is required for sick leave longer than ${n} days.`),otherwise:e=>e.nullable().optional()})}),Dce=({isOpen:n,onClose:e,onSuccess:t,user:r,isMobile:s,setToast:a})=>{const{attendance:{office:{sickLeaveCertificateThreshold:o}}}=yi(),l=E.useMemo(()=>Ece(o),[o]),{register:c,control:d,handleSubmit:h,watch:p,formState:{errors:x},reset:y}=tn({resolver:In(l),defaultValues:{leaveType:"Earned",startDate:We(new Date,"yyyy-MM-dd"),endDate:We(new Date,"yyyy-MM-dd"),dayOption:"full"}}),_=p("startDate"),w=p("endDate"),j=p("leaveType"),P=E.useMemo(()=>!_||!w?!1:mf(new Date(_.replace(/-/g,"/")),new Date(w.replace(/-/g,"/"))),[_,w])&&j==="Earned",O=E.useMemo(()=>j!=="Sick"||!_||!w?!1:Em(new Date(w.replace(/-/g,"/")),new Date(_.replace(/-/g,"/")))+1>o,[j,_,w,o]),M=async D=>{try{await ue.submitLeaveRequest({...D,userId:r.id,userName:r.name}),t()}catch{a({message:"Failed to submit leave request.",type:"error"})}};return n?i.jsx("div",{className:`fixed inset-0 z-40 bg-card ${s?"flex flex-col":"flex items-center justify-center bg-black/50 p-4"}`,children:i.jsxs("div",{className:`w-full ${s?"flex flex-col h-full":"max-w-2xl bg-card rounded-xl shadow-lg"}`,children:[i.jsxs("header",{className:`p-4 flex-shrink-0 flex items-center gap-4 ${s?"fo-mobile-header":"border-b"}`,children:[i.jsx(ne,{variant:"icon",onClick:e,"aria-label":"Go back",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:s?"New Leave Request":"Submit a New Leave Request"})]}),i.jsxs("form",{id:"leave-form",onSubmit:h(M),className:"flex-grow overflow-y-auto p-4 space-y-4",children:[i.jsx(_e,{name:"leaveType",control:d,render:({field:D})=>i.jsxs(Ze,{label:"Leave Type",...D,error:x.leaveType?.message,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{children:"Earned"}),i.jsx("option",{children:"Sick"}),i.jsx("option",{children:"Floating"}),i.jsx("option",{children:"Comp Off"})]})}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"startDate",control:d,render:({field:D})=>i.jsx(En,{label:"Start Date",id:"startDate",value:D.value,onChange:D.onChange,error:x.startDate?.message})}),i.jsx(_e,{name:"endDate",control:d,render:({field:D})=>i.jsx(En,{label:"End Date",id:"endDate",value:D.value,onChange:D.onChange,error:x.endDate?.message})})]}),P&&i.jsx(_e,{name:"dayOption",control:d,render:({field:D})=>i.jsxs(Ze,{label:"Day Option",...D,className:s?"pro-select pro-select-arrow":"",children:[i.jsx("option",{value:"full",children:"Full Day"}),i.jsx("option",{value:"half",children:"Half Day"})]})}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Reason"}),i.jsx("textarea",{...c("reason"),rows:4,className:`mt-1 form-input ${x.reason?"form-input--error":""}`}),x.reason&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.reason.message})]}),O&&i.jsx(_e,{name:"doctorCertificate",control:d,render:({field:D,fieldState:I})=>i.jsx(vt,{label:"Doctor's Certificate (Required)",file:D.value,onFileChange:D.onChange,error:I.error?.message,allowCapture:!0})})]}),i.jsxs("footer",{className:`p-4 flex-shrink-0 flex items-center justify-end gap-2 ${s?"":"border-t"}`,children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",form:"leave-form",children:"Submit Request"})]})]})}):null},Oce=()=>{const{user:n}=jt(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(!1),[p,x]=E.useState("all"),[y,_]=E.useState(null),w=Rt("(max-width: 767px)"),[j,C]=E.useState(!1),[P,O]=E.useState(0),M=E.useCallback(async()=>{if(n){c(!0),h(!1);try{const[B,U,W]=await Promise.all([ue.getLeaveBalancesForUser(n.id),ue.getLeaveRequests({userId:n.id,status:p==="all"?void 0:p}),ue.getCompOffLogs(n.id).catch(G=>{if(G&&G.message&&(G.message.includes("comp_off_logs")||G.message.includes('relation "public.comp_off_logs" does not exist')))return h(!0),[];throw G})]);if(t(B),s(U),o(W),n.role==="field_officer"){const G=new Date,Z=xi(G).toISOString(),Y=Ma(G).toISOString(),ae=await ue.getAttendanceEvents(n.id,Z,Y),ee={};ae.forEach($=>{const K=We(new Date($.timestamp),"yyyy-MM-dd");ee[K]||(ee[K]=[]),ee[K].push($)});let me=0;Object.values(ee).forEach($=>{const K=[...$].sort((ie,ce)=>new Date(ie.timestamp).getTime()-new Date(ce.timestamp).getTime());let re=0,H=null;K.forEach(ie=>{const ce=new Date(ie.timestamp);ie.type==="check-in"?H=ce:ie.type==="check-out"&&H&&(re+=pf(ce,H),H=null)});const se=re/60;se>8&&(me+=se-8)}),O(parseFloat(me.toFixed(1)))}}catch(B){let U="Failed to load leave data.";B&&typeof B.message=="string"&&B.message.includes('relation "leave_requests" does not exist')&&(U='Database setup error: The "leave_requests" table is missing.'),console.error("Failed to load leave data",B),d||_({message:U,type:"error"})}finally{c(!1)}}},[n,p]);E.useEffect(()=>{M()},[M]);const D=()=>{_({message:"Leave request submitted successfully!",type:"success"}),C(!1),M()},I=B=>B.replace(/_/g," ").replace(/\b\w/g,U=>U.toUpperCase()),F=["all","pending_manager_approval","pending_hr_confirmation","approved","rejected"],q=e?[{title:"Earned Leave",value:`${e.earnedTotal-e.earnedUsed} / ${e.earnedTotal}`,icon:QF},{title:"Sick Leave",value:`${e.sickTotal-e.sickUsed} / ${e.sickTotal}`,icon:T1},{title:"Floating Holiday",value:`${e.floatingTotal-e.floatingUsed} / ${e.floatingTotal}`,icon:AJ},{title:"Compensatory Off",value:`${e.compOffTotal-e.compOffUsed} / ${e.compOffTotal}`,icon:aJ}]:[];return i.jsxs("div",{className:"p-4 space-y-6",children:[y&&i.jsx(pt,{message:y.message,type:y.type,onDismiss:()=>_(null)}),n&&i.jsx(Dce,{isOpen:j,onClose:()=>C(!1),onSuccess:D,user:n,isMobile:w,setToast:_}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"My Leave Requests"}),!w&&i.jsxs(ne,{onClick:()=>C(!0),children:[i.jsx(Vt,{className:"mr-2 h-4"})," New Request"]})]}),i.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-2 lg:grid-cols-4 gap-6 justify-items-center md:justify-items-start",children:[q.map(B=>i.jsx(zL,{...B},B.title)),n?.role==="field_officer"&&i.jsx(zL,{title:"Overtime Hours",value:`${P} hrs`,icon:$c})]}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-6 items-start",children:[i.jsx(Cce,{}),i.jsx(Tce,{logs:a,isLoading:l}),n?.role==="field_officer"&&i.jsx(kce,{})]}),w&&i.jsx("div",{className:"my-4 w-full",children:i.jsxs(ne,{onClick:()=>C(!0),size:"lg",className:"w-full justify-center text-lg",children:[i.jsx(Vt,{className:"mr-2 h-5"})," New Request"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 space-y-2 md:space-y-0","aria-label":"Tabs",children:F.map(B=>i.jsx("button",{onClick:()=>x(B),className:`whitespace-nowrap font-medium text-base rounded-lg md:rounded-none w-full md:w-auto text-left px-4 py-2 md:px-1 md:py-3 md:bg-transparent md:border-b-2
                                    ${p===B?"bg-accent-light text-accent-dark md:border-accent":"text-muted hover:bg-accent-light hover:text-accent-dark md:border-transparent md:hover:border-accent"}`,children:I(B)},B))})})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-sm font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No requests found."})}):r.map(B=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 font-medium text-base",children:[B.leaveType," ",B.dayOption&&`(${B.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted text-base",children:[We(new Date(B.startDate.replace(/-/g,"/")),"dd MMM")," - ",We(new Date(B.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate text-base",children:B.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3 text-base",children:i.jsx(Mce,{status:B.status})})]},B.id))})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card w-full md:w-full",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Compensatory Off Tracker"}),d?i.jsxs("div",{className:"text-center py-10 text-muted bg-page rounded-lg",children:[i.jsx(Aa,{className:"h-8 w-8 mx-auto mb-2 text-yellow-500"}),i.jsx("p",{className:"font-semibold",children:"Feature Unavailable"}),i.jsx("p",{className:"text-sm",children:"The Compensatory Off feature is disabled because the required 'comp_off_logs' table is missing in the database."})]}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date Earned"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason for Comp-Off"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Granted By"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"Loading..."})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted text-lg",children:"No comp-off history found."})}):a.map(B=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Date Earned",className:"px-4 py-3 font-medium",children:We(new Date(B.dateEarned.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted",children:B.reason}),i.jsx("td",{"data-label":"Granted By",className:"px-4 py-3 text-muted",children:B.grantedByName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full capitalize ${B.status==="earned"?"bg-blue-100 text-blue-800":"bg-gray-200 text-gray-800"}`,children:B.status})})]},B.id))})]})})]}),i.jsx(Pce,{})]})},Ice=({isOpen:n,onClose:e,onConfirm:t,isConfirming:r})=>{const[s,a]=E.useState(""),[o,l]=E.useState(""),c=()=>{if(!s.trim()){l("A reason for rejection is required.");return}t(s)},d=()=>{a(""),l(""),e()};return n?i.jsx(Kr,{isOpen:n,onClose:d,onConfirm:c,title:"Reject Claim",confirmButtonText:"Confirm Rejection",isConfirming:r,children:i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{children:"Please provide a reason for rejecting this claim. This will be visible to the employee."}),i.jsxs("div",{children:[i.jsx("textarea",{value:s,onChange:h=>{a(h.target.value),o&&l("")},rows:3,className:`mt-1 form-input ${o?"form-input--error":""}`,placeholder:"e.g., Overtime was not pre-approved."}),o&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:o})]})]})}):null},Ace=({status:n})=>{const e={pending_manager_approval:"bg-yellow-100 text-yellow-800",pending_hr_confirmation:"bg-blue-100 text-blue-800",approved:"bg-green-100 text-green-800",rejected:"bg-red-100 text-red-800"},t=n.replace(/_/g," ");return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:t})},Rce=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},Lce=()=>{const n=St(),{user:e}=jt(),{colorScheme:t}=an(),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState("pending_manager_approval"),[p,x]=E.useState(null),[y,_]=E.useState(null),w=Rt("(max-width: 767px)"),[j,C]=E.useState(!0),[P,O]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{(async()=>{try{await ue.checkCompOffTableExists(),C(!0)}catch{C(!1)}})()},[]);const I=E.useCallback(async()=>{if(e){c(!0);try{const Z=["admin","hr","operation_manager","site_manager"].includes(e.role),[Y,ae]=await Promise.all([ue.getLeaveRequests({forApproverId:e.id,status:d!=="all"&&d!=="claims"?d:void 0}),Z?ue.getExtraWorkLogs():Promise.resolve([])]);s(Y),o(ae)}catch{x({message:"Failed to load approval data.",type:"error"})}finally{c(!1)}}},[e,d]);E.useEffect(()=>{I()},[I]);const F=async(Z,Y)=>{if(e){_(Z);try{switch(Y){case"approve":await ue.approveLeaveRequest(Z,e.id);break;case"reject":await ue.rejectLeaveRequest(Z,e.id);break;case"confirm":await ue.confirmLeaveByHR(Z,e.id);break}x({message:"Request actioned successfully.",type:"success"}),I()}catch{x({message:"Failed to update request.",type:"error"})}finally{_(null)}}},q=async Z=>{if(e){_(Z);try{await ue.approveExtraWorkClaim(Z,e.id),x({message:"Claim approved successfully.",type:"success"}),I()}catch{x({message:"Failed to approve claim.",type:"error"})}finally{_(null)}}},B=async Z=>{if(!(!e||!M)){_(M.id);try{await ue.rejectExtraWorkClaim(M.id,e.id,Z),x({message:"Claim rejected successfully.",type:"success"}),I()}catch{x({message:"Failed to reject claim.",type:"error"})}finally{_(null),O(!1),D(null)}}},U=["pending_manager_approval","claims","pending_hr_confirmation","approved","rejected","all"],W=({request:Z})=>{if(!e||Z.status==="approved"||Z.status==="rejected")return null;if(Z.currentApproverId===e.id){if(Z.status==="pending_manager_approval")return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(Z.id,"approve"),disabled:y===Z.id,title:"Approve","aria-label":"Approve request",children:i.jsx(jl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(Z.id,"reject"),disabled:y===Z.id,title:"Reject","aria-label":"Reject request",children:i.jsx(vi,{className:"h-4 w-4 text-red-600"})})]});if(Z.status==="pending_hr_confirmation"&&(e.role==="hr"||e.role==="admin"))return i.jsxs("div",{className:"flex gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(Z.id,"confirm"),disabled:y===Z.id,title:"Confirm & Finalize","aria-label":"Confirm and finalize request",children:i.jsx(jl,{className:"h-4 w-4 text-blue-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>F(Z.id,"reject"),disabled:y===Z.id,title:"Reject","aria-label":"Reject request",children:i.jsx(vi,{className:"h-4 w-4 text-red-600"})})]})}return null},G=Z=>Z.replace(/_/g," ").replace(/\b\w/g,Y=>Y.toUpperCase());return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Ice,{isOpen:P,onClose:()=>{O(!1),D(null)},onConfirm:B,isConfirming:!!y}),i.jsxs("div",{className:"flex justify-between items-center mb-6",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Leave Approval Inbox"}),!w&&i.jsxs(ne,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})]}),w&&i.jsx("div",{className:"mb-6",children:i.jsxs(ne,{onClick:()=>n("/hr/leave-management/grant-comp-off"),disabled:!j,title:j?"Grant a compensatory off day":"Feature disabled: 'comp_off_logs' table missing in database.",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Grant Comp Off"]})}),i.jsx("div",{className:"mb-6",children:i.jsx("div",{className:"w-full sm:w-auto md:border-b border-border",children:i.jsx("nav",{className:"flex flex-col md:flex-row md:space-x-6 md:overflow-x-auto space-y-1 md:space-y-0","aria-label":"Tabs",children:U.map(Z=>i.jsx("button",{onClick:()=>h(Z),className:`whitespace-nowrap font-medium text-sm rounded-lg md:rounded-none w-full md:w-auto text-left md:text-center px-4 py-3 md:px-1 md:py-3 md:bg-transparent md:border-b-2 transition-colors duration-200
                                ${d===Z?"bg-emerald-50 text-emerald-700 md:border-emerald-500 md:bg-transparent":"text-muted hover:bg-emerald-50 hover:text-emerald-700 md:border-transparent md:hover:border-emerald-500"}`,children:G(Z)},Z))})})}),d==="claims"?i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Date & Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Claim"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin mx-auto"})})}):a.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No pending claims found."})}):a.map(Z=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:Z.userName}),i.jsxs("td",{"data-label":"Date & Type",className:"px-4 py-3 text-muted",children:[We(new Date(Z.workDate),"dd MMM, yyyy")," (",Z.workType,")"]}),i.jsxs("td",{"data-label":"Claim",className:"px-4 py-3 text-muted",children:[Z.claimType,Z.claimType==="OT"?` (${Z.hoursWorked} hrs)`:""]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:Z.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Rce,{status:Z.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex md:justify-start justify-end gap-2",children:[i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>q(Z.id),disabled:y===Z.id,title:"Approve Claim",children:i.jsx(jl,{className:"h-4 w-4 text-green-600"})}),i.jsx(ne,{size:"sm",variant:"icon",onClick:()=>{D(Z),O(!0)},disabled:y===Z.id,title:"Reject Claim",children:i.jsx(vi,{className:"h-4 w-4 text-red-600"})})]})})]},Z.id))})]})}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Dates"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Reason"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:l?w?i.jsx("tr",{children:i.jsx("td",{colSpan:6,children:i.jsx(Ra,{rows:3,cols:6,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:6}):r.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:6,className:"text-center py-10 text-muted",children:"No requests found for this filter."})}):r.map(Z=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Employee",className:"px-4 py-3 font-medium",children:Z.userName}),i.jsxs("td",{"data-label":"Type",className:"px-4 py-3 text-muted",children:[Z.leaveType," ",Z.dayOption&&`(${Z.dayOption})`]}),i.jsxs("td",{"data-label":"Dates",className:"px-4 py-3 text-muted",children:[We(new Date(Z.startDate.replace(/-/g,"/")),"dd MMM")," - ",We(new Date(Z.endDate.replace(/-/g,"/")),"dd MMM")]}),i.jsx("td",{"data-label":"Reason",className:"px-4 py-3 text-muted max-w-xs truncate",children:Z.reason}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Ace,{status:Z.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsx("div",{className:"flex md:justify-start justify-end",children:y===Z.id?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(W,{request:Z})})})]},Z.id))})]})})]})},K6=({users:n,externalSearchQuery:e,externalZoom:t,showControls:r=!0})=>{const s=E.useRef(null),a=E.useRef(null),[o,l]=E.useState(null),[c,d]=E.useState(null),[h,p]=E.useState({x:0,y:0}),[x,y]=E.useState(""),[_,w]=E.useState(1),[j,C]=E.useState({x:0,y:0}),P=e!==void 0?e:x,O=t!==void 0?t:_,M=y,D=w,I=E.useRef(null),F=E.useRef(!1),q=E.useRef({x:0,y:0}),B=E.useRef(!1),U=E.useRef({x:0,y:0}),W=E.useRef(0),G=E.useRef(new Map),Z=E.useRef(window.devicePixelRatio||1);E.useEffect(()=>{n.forEach(te=>{if(te.photoUrl&&!G.current.has(te.id)){const ye=new Image;ye.crossOrigin="anonymous",ye.src=te.photoUrl,ye.onload=()=>{G.current.set(te.id,ye)}}})},[n]);const Y=()=>{const te=new Map;n.forEach(Ce=>{te.set(Ce.id,{...Ce,children:[]})});const ye=[];return n.forEach(Ce=>{const Re=te.get(Ce.id);if(Ce.reportingManagerId){const Te=te.get(Ce.reportingManagerId);Te?Te.children.push(Re):ye.push(Re)}else ye.push(Re)}),ye},ae=(te,ye=50,Ce=50,Re=0)=>{let Ye=ye;const ve=[];let Oe=1/0,Ve=-1/0,qe=1/0,X=-1/0;te.forEach(he=>{if(he.level=Re,he.children&&he.children.length>0){const Le=ae(he.children,Ye,Ce+120+120,Re+1),Ie=Le.width,ze=Ye+Ie/2-180/2;he.x=ze,he.y=Ce,ve.push(he),ve.push(...Le.nodes),Oe=Math.min(Oe,ze,Le.bounds.minX),Ve=Math.max(Ve,ze+180,Le.bounds.maxX),qe=Math.min(qe,Ce,Le.bounds.minY),X=Math.max(X,Ce+120,Le.bounds.maxY),Ye+=Ie+20}else he.x=Ye,he.y=Ce,ve.push(he),Oe=Math.min(Oe,Ye),Ve=Math.max(Ve,Ye+180),qe=Math.min(qe,Ce),X=Math.max(X,Ce+120),Ye+=200});const le=Math.max(0,Ye-ye-20);return{width:Math.max(le,180),nodes:ve,bounds:{minX:isFinite(Oe)?Oe:0,maxX:isFinite(Ve)?Ve:180,minY:isFinite(qe)?qe:0,maxY:isFinite(X)?X:300}}},ee=(te,ye,Ce,Re)=>{if(ye.x===void 0||ye.y===void 0||Ce.x===void 0||Ce.y===void 0)return;const Te=(ye.x+90)*O+j.x,je=(ye.y+120)*O+j.y,ke=(Ce.x+90)*O+j.x,Ue=Ce.y*O+j.y,Ye=te.createLinearGradient(Te,je,ke,Ue),ve=Re*5e-4%1;Ye.addColorStop(0,"#E0E7FF"),Ye.addColorStop(ve,"#818CF8"),Ye.addColorStop(1,"#E0E7FF"),te.save(),te.strokeStyle=Ye,te.lineWidth=2*O,te.lineCap="round",te.shadowColor="rgba(99, 102, 241, 0.2)",te.shadowBlur=4,te.beginPath(),te.moveTo(Te,je);const Oe=(je+Ue)/2;te.bezierCurveTo(Te,Oe,ke,Oe,ke,Ue),te.stroke(),te.restore();const qe=(Re*5e-4+ye.id.charCodeAt(0)*.1)%1,X={x:Te,y:je},le={x:Te,y:(je+Ue)/2},he={x:ke,y:(je+Ue)/2},Le={x:ke,y:Ue},Ie=3*(le.x-X.x),ze=3*(he.x-le.x)-Ie,et=Le.x-X.x-Ie-ze,tt=3*(le.y-X.y),ct=3*(he.y-le.y)-tt,ht=Le.y-X.y-tt-ct,Et=et*qe*qe*qe+ze*qe*qe+Ie*qe+X.x,Mt=ht*qe*qe*qe+ct*qe*qe+tt*qe+X.y;te.save(),te.fillStyle="#6366F1",te.shadowColor="#6366F1",te.shadowBlur=8,te.beginPath(),te.arc(Et,Mt,3*O,0,Math.PI*2),te.fill(),te.restore()},me=(te,ye,Ce,Re,Te)=>{if(ye.x===void 0||ye.y===void 0)return null;const je=ye.x*O+j.x,ke=ye.y*O+j.y,Ue=180*O,Ye=120*O,ve=48*O,Oe=!!P&&ye.name.toLowerCase().includes(P.toLowerCase());te.save(),te.shadowColor=Re?"rgba(99, 102, 241, 0.4)":"rgba(0, 0, 0, 0.08)",te.shadowBlur=(Re?24:12)*O,te.shadowOffsetY=(Re?8:4)*O;const Ve=te.createLinearGradient(je,ke,je,ke+Ye);Ve.addColorStop(0,"#FFFFFF"),Ve.addColorStop(1,"#FAFAFA"),te.fillStyle=Ve;const qe=16*O;te.beginPath(),te.roundRect?te.roundRect(je,ke,Ue,Ye,qe):(te.moveTo(je+qe,ke),te.lineTo(je+Ue-qe,ke),te.quadraticCurveTo(je+Ue,ke,je+Ue,ke+qe),te.lineTo(je+Ue,ke+Ye-qe),te.quadraticCurveTo(je+Ue,ke+Ye,je+Ue-qe,ke+Ye),te.lineTo(je+qe,ke+Ye),te.quadraticCurveTo(je,ke+Ye,je,ke+Ye-qe),te.lineTo(je,ke+qe),te.quadraticCurveTo(je,ke,je+qe,ke)),te.fill(),te.lineWidth=(Re?2:1)*O,te.strokeStyle=Re?"#6366F1":Ce?"#A5B4FC":Oe?"#22C55E":"#E5E7EB",te.stroke(),te.restore(),(Re||Oe)&&(te.save(),te.globalAlpha=.05,te.fillStyle=Re?"#6366F1":"#22C55E",te.beginPath(),te.roundRect&&te.roundRect(je,ke,Ue,Ye,qe),te.fill(),te.restore());const X=je+(Ue-ve)/2,le=ke+16*O;te.save(),te.beginPath(),te.arc(X+ve/2,le+ve/2,ve/2,0,Math.PI*2),te.clip();const he=G.current.get(ye.id);if(he&&he.complete)te.drawImage(he,X,le,ve,ve);else{const ct=te.createLinearGradient(X,le,X+ve,le+ve);ct.addColorStop(0,"#818CF8"),ct.addColorStop(1,"#4F46E5"),te.fillStyle=ct,te.fillRect(X,le,ve,ve),te.fillStyle="#FFF",te.font=`600 ${Math.max(12,16*O)}px "Inter", sans-serif`,te.textAlign="center",te.textBaseline="middle";const ht=ye.name.split(" ").map(Et=>Et[0]).join("").substring(0,2).toUpperCase();te.fillText(ht,X+ve/2,le+ve/2+1*O)}if(te.restore(),te.save(),te.strokeStyle=Re?"#6366F1":"#FFF",te.lineWidth=2*O,te.beginPath(),te.arc(X+ve/2,le+ve/2,ve/2,0,Math.PI*2),te.stroke(),te.restore(),ye.level!==void 0&&ye.level>0){const ct=18*O,ht=X+ve-ct/2,Et=le+ve-ct/2;te.save(),te.fillStyle="#10B981",te.shadowColor="rgba(16, 185, 129, 0.4)",te.shadowBlur=4*O,te.beginPath(),te.arc(ht,Et,ct/2,0,Math.PI*2),te.fill(),te.fillStyle="#FFF",te.font=`700 ${Math.max(8,9*O)}px "Inter", sans-serif`,te.textAlign="center",te.textBaseline="middle",te.fillText(`L${ye.level}`,ht,Et+1*O),te.restore()}te.save(),te.fillStyle="#111827",te.font=`600 ${Math.max(11,13*O)}px "Inter", sans-serif`,te.textAlign="center",te.textBaseline="top";const Le=le+ve+12*O;let Ie=ye.name;const ze=Ue-24*O;if(te.measureText(Ie).width>ze){for(;te.measureText(Ie+"...").width>ze&&Ie.length>0;)Ie=Ie.substring(0,Ie.length-1);Ie+="..."}te.fillText(Ie,je+Ue/2,Le),te.fillStyle="#6B7280",te.font=`500 ${Math.max(9,11*O)}px "Inter", sans-serif`;const et=Le+18*O;let tt=(ye.role||"").replace(/_/g," ");if(tt=tt?tt.charAt(0).toUpperCase()+tt.slice(1).toLowerCase():"",te.measureText(tt).width>ze){for(;te.measureText(tt+"...").width>ze&&tt.length>0;)tt=tt.substring(0,tt.length-1);tt+="..."}return te.fillText(tt,je+Ue/2,et),te.restore(),{x:je,y:ke,width:Ue,height:Ye}},$=(te,ye)=>{const Ce=Y(),Re=ae(Ce),Te=new Map;return Re.nodes.forEach(je=>{je.children&&je.children.forEach(ke=>{ee(te,je,ke,ye)})}),Re.nodes.forEach(je=>{const ke=o?.id===je.id,Ue=c?.id===je.id,Ye=me(te,je,ke,Ue);Ye&&Te.set(je.id,Ye)}),{nodePositions:Te,layout:Re}},K=te=>{const ye=te??s.current;if(!ye)return;const Ce=ye.getBoundingClientRect(),Re=Y(),je=ae(Re).bounds,ke=180,Ue=120,Ye=Math.max(1,je.maxX-je.minX+ke),ve=Math.max(1,je.maxY-je.minY+Ue),Oe=je.minX+Ye/2,Ve=je.minY+ve/2,qe=.98,X=Ce.width*qe/Ye,le=Ce.height*qe/ve;let he=Math.min(X,le);he=Math.max(.3,Math.min(he,1.5));const Le=t!==void 0?t:he,Ie=Ce.width/2-Oe*Le,ze=Ce.height/2-Ve*Le;t===void 0&&D(he),C({x:Ie,y:ze})};E.useEffect(()=>{if(n.length>0){const te=setTimeout(()=>K(),100);return()=>clearTimeout(te)}},[n.length]),E.useEffect(()=>{t!==void 0&&n.length>0&&K()},[t]),E.useEffect(()=>{const te=()=>{const ye=s.current,Ce=a.current;if(!ye||!Ce)return;const Re=window.devicePixelRatio||1;Z.current=Re;const Te=Ce.getBoundingClientRect(),je=Math.max(1,Te.width),ke=Math.max(1,Te.height);ye.width=Math.round(je*Re),ye.height=Math.round(ke*Re),ye.style.width=`${je}px`,ye.style.height=`${ke}px`;const Ue=ye.getContext("2d");Ue&&(Ue.setTransform(Re,0,0,Re,0,0),K(ye))};return te(),window.addEventListener("resize",te),()=>window.removeEventListener("resize",te)},[n]),E.useEffect(()=>{const te=s.current,ye=te?.getContext("2d");if(!te||!ye)return;const Ce=Z.current;let Re=0;const Te=()=>{W.current+=16,ye.clearRect(0,0,te.width/Ce,te.height/Ce);const je=te.width/Ce,ke=te.height/Ce,Ue=ye.createLinearGradient(0,0,je,ke);Ue.addColorStop(0,"#FAFAFA"),Ue.addColorStop(1,"#F3F4F6"),ye.fillStyle=Ue,ye.fillRect(0,0,je,ke);const{nodePositions:Ye}=$(ye,W.current);let ve=!1;for(const[Oe,Ve]of Ye.entries())if(h.x>=Ve.x&&h.x<=Ve.x+Ve.width&&h.y>=Ve.y&&h.y<=Ve.y+Ve.height){const qe=n.find(X=>X.id===Oe);if(qe){l(qe),ve=!0;break}}!ve&&o&&l(null),Re=requestAnimationFrame(Te),I.current=Re};return I.current=requestAnimationFrame(Te),()=>{I.current&&cancelAnimationFrame(I.current)}},[n,o,c,h,O,j,P]);const re=te=>{F.current=!0,B.current=!1;const ye=te.nativeEvent.offsetX,Ce=te.nativeEvent.offsetY;U.current={x:ye,y:Ce},q.current={x:ye,y:Ce}},H=te=>{const ye=te.nativeEvent.offsetX,Ce=te.nativeEvent.offsetY;if(p({x:ye,y:Ce}),F.current){const Re=(ye-U.current.x)*1.3,Te=(Ce-U.current.y)*1.3;Math.sqrt(Math.pow(ye-q.current.x,2)+Math.pow(Ce-q.current.y,2))>5&&(B.current=!0),C(ke=>({x:ke.x+Re,y:ke.y+Te})),U.current={x:ye,y:Ce}}},se=()=>{F.current=!1},ie=()=>{o&&!B.current&&d(c?.id===o.id?null:o),B.current=!1},ce=()=>D(te=>Math.min(te+.2,2.5)),oe=()=>D(te=>Math.max(te-.2,.4)),de=()=>{K(),d(null),M("")};return i.jsxs("div",{className:"relative w-full h-full bg-gradient-to-br from-slate-50 to-slate-100",ref:a,children:[r&&i.jsxs("div",{className:"absolute top-4 left-4 z-20 flex flex-col gap-3",children:[i.jsxs("div",{className:"bg-white/90 backdrop-blur-md border border-slate-200 rounded-xl shadow-xl p-3 min-w-[280px]",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:P,onChange:te=>M(te.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),P&&i.jsxs("p",{className:"mt-2 text-xs text-slate-500",children:[n.filter(te=>te.name.toLowerCase().includes(P.toLowerCase())).length," results"]})]}),i.jsxs("div",{className:"bg-white/80 backdrop-blur-md border border-white/20 rounded-2xl shadow-lg p-3 flex flex-col gap-3 min-w-[240px]",children:[i.jsxs("div",{className:"flex gap-2 items-center",children:[i.jsx("button",{onClick:oe,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom Out",children:i.jsx(D1,{className:"w-5 h-5"})}),i.jsx("div",{className:"flex-1 px-2",children:i.jsx("input",{type:"range",min:"40",max:"250",value:Math.round(O*100),onChange:te=>D(parseInt(te.target.value)/100),className:"w-full h-2 bg-slate-200 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-indigo-500 [&::-webkit-slider-thumb]:cursor-pointer [&::-webkit-slider-thumb]:shadow-md [&::-webkit-slider-thumb]:transition-transform [&::-webkit-slider-thumb]:hover:scale-110 [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-indigo-500 [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0 [&::-moz-range-thumb]:shadow-md",title:"Zoom Slider"})}),i.jsx("button",{onClick:ce,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Zoom In",children:i.jsx(E1,{className:"w-5 h-5"})})]}),i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"px-2 min-w-[60px] text-center font-semibold text-slate-700 text-sm tabular-nums bg-slate-100 rounded-lg py-1",children:[Math.round(O*100),"%"]}),i.jsx("div",{className:"w-px h-6 bg-slate-200"}),i.jsx("button",{onClick:de,className:"p-2 hover:bg-slate-100/80 rounded-xl transition-all duration-200 text-slate-600 hover:text-slate-900 active:scale-95",title:"Reset View",children:i.jsx(OS,{className:"w-5 h-5"})})]})]})]}),i.jsx("canvas",{ref:s,className:"w-full h-full cursor-grab active:cursor-grabbing",onMouseDown:re,onMouseMove:H,onMouseUp:se,onMouseLeave:se,onClick:ie}),o&&o.x!==void 0&&o.y!==void 0&&i.jsx("div",{className:"absolute pointer-events-none z-10 transform -translate-x-1/2 transition-all duration-200",style:{left:`${o.x*O+j.x+90*O}px`,top:`${Math.max(10,o.y*O+j.y-10)}px`},children:i.jsx("div",{className:"bg-white/95 backdrop-blur-xl border border-indigo-200 rounded-2xl shadow-2xl p-5 min-w-[320px] animate-fade-in-scale",children:i.jsxs("div",{className:"flex items-start gap-4",children:[i.jsxs("div",{className:"flex-shrink-0 relative",children:[o.photoUrl?i.jsx("img",{src:o.photoUrl,alt:o.name,className:"w-20 h-20 rounded-2xl object-cover border-3 border-indigo-500 shadow-lg"}):i.jsx("div",{className:"w-20 h-20 rounded-2xl bg-gradient-to-br from-indigo-500 via-purple-500 to-indigo-600 flex items-center justify-center text-white font-bold text-2xl border-3 border-white shadow-lg",children:o.name.split(" ").map(te=>te[0]).join("").substring(0,2).toUpperCase()}),o.level!==void 0&&o.level>0&&i.jsxs("div",{className:"absolute -bottom-2 -right-2 bg-emerald-500 text-white text-xs font-bold px-2 py-1 rounded-full shadow-lg",children:["L",o.level]})]}),i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"font-bold text-slate-900 text-xl mb-1 truncate",children:o.name}),i.jsx("p",{className:"text-sm text-indigo-600 font-medium capitalize mb-3 truncate",children:o.role.replace(/_/g," ")}),i.jsxs("div",{className:"space-y-2",children:[o.email&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Hf,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{className:"truncate",children:o.email})]}),o.phone&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Af,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsx("span",{children:o.phone})]}),o.managerName&&i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx(Ji,{className:"w-4 h-4 flex-shrink-0 text-indigo-500"}),i.jsxs("span",{className:"truncate",children:["Reports to: ",i.jsx("strong",{children:o.managerName})]})]})]}),i.jsx("div",{className:"mt-3 pt-3 border-t border-slate-200",children:i.jsxs("p",{className:"text-xs text-slate-500 italic",children:["Click to ",c?.id===o.id?"deselect":"select and focus"]})})]})]})})}),r&&i.jsx("div",{className:"absolute bottom-6 left-1/2 transform -translate-x-1/2 bg-white/90 backdrop-blur-md px-6 py-3 rounded-full border border-slate-200 shadow-xl",children:i.jsxs("p",{className:"text-sm text-slate-700 font-medium flex items-center gap-3",children:[i.jsxs("span",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"w-2 h-2 bg-indigo-500 rounded-full animate-pulse"}),"Drag to pan"]}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Hover for details"}),i.jsx("span",{className:"text-slate-300",children:""}),i.jsx("span",{children:"Click to select"})]})}),r&&i.jsxs("div",{className:"absolute top-4 right-4 bg-white/90 backdrop-blur-md border border-slate-200 rounded-2xl shadow-xl p-4 max-w-[200px]",children:[i.jsxs("h4",{className:"text-sm font-bold text-slate-900 mb-3 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Org Hierarchy"]}),i.jsxs("div",{className:"space-y-2.5",children:[i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border-2 border-white shadow-md flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-8 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-600",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]}),c&&i.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200",children:[i.jsx("p",{className:"text-xs font-semibold text-indigo-600 mb-1",children:"Selected:"}),i.jsx("p",{className:"text-xs text-slate-700 font-medium truncate",children:c.name})]})]}),i.jsxs("div",{className:"absolute bottom-6 right-6 bg-slate-900/80 backdrop-blur-sm text-white text-xs px-3 py-2 rounded-full font-mono",children:[n.length," employees"]})]})},Fce=({users:n})=>{const[e,t]=E.useState(!1),[r,s]=E.useState(""),[a,o]=E.useState(null),[l,c]=E.useState(!0),d=()=>{s(""),o(null),setTimeout(()=>{},100)},h=()=>o(y=>Math.min((y??80)+10,250)),p=()=>o(y=>Math.max((y??80)-10,40)),x=i.jsxs("div",{className:`flex flex-col ${e?"h-screen":"h-[75vh] min-h-[500px]"}`,children:[i.jsx("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 px-4 py-3",children:i.jsxs("div",{className:"flex flex-col md:flex-row items-stretch md:items-center gap-3",children:[i.jsxs("div",{className:"relative flex-shrink-0 w-full md:w-64",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-slate-400"}),i.jsx("input",{type:"text",placeholder:"Search employees...",value:r,onChange:y=>s(y.target.value),className:"w-full pl-10 pr-3 py-2 bg-slate-50 border border-slate-200 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent"})]}),i.jsx("div",{className:"flex-1"}),i.jsxs("div",{className:"flex items-center gap-2 bg-slate-50 rounded-lg px-3 py-2 border border-slate-200",children:[i.jsx("button",{onClick:p,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom Out",children:i.jsx(D1,{className:"w-4 h-4"})}),i.jsx("input",{type:"range",min:"40",max:"250",value:a??80,disabled:a===null,onChange:y=>o(parseInt(y.target.value)),className:"w-24 h-1.5 bg-slate-200 rounded-lg appearance-none cursor-pointer disabled:opacity-50 disabled:cursor-not-allowed [&::-webkit-slider-thumb]:appearance-none [&::-webkit-slider-thumb]:w-3 [&::-webkit-slider-thumb]:h-3 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:bg-primary [&::-webkit-slider-thumb]:cursor-pointer [&::-moz-range-thumb]:w-3 [&::-moz-range-thumb]:h-3 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:bg-primary [&::-moz-range-thumb]:cursor-pointer [&::-moz-range-thumb]:border-0"}),i.jsx("span",{className:"text-xs font-semibold text-slate-700 min-w-[45px] text-center",children:a?`${a}%`:"Auto"}),i.jsx("button",{onClick:h,className:"p-1.5 hover:bg-slate-200/60 rounded-md transition-colors text-slate-600 hover:text-slate-900",title:"Zoom In",children:i.jsx(E1,{className:"w-4 h-4"})})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("button",{onClick:d,className:"px-3 py-2 text-sm font-medium text-slate-700 hover:text-slate-900 bg-slate-50 hover:bg-slate-100 border border-slate-200 rounded-lg transition-colors flex items-center gap-2",children:[i.jsx(OS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:"Reset"})]}),i.jsxs("button",{onClick:()=>t(!e),className:"px-3 py-2 text-sm font-medium text-white bg-primary hover:bg-primary/90 rounded-lg transition-colors flex items-center gap-2",children:[e?i.jsx(kJ,{className:"w-4 h-4"}):i.jsx(OS,{className:"w-4 h-4"}),i.jsx("span",{className:"hidden sm:inline",children:e?"Exit":"Full Screen"})]})]})]})}),i.jsxs("div",{className:"flex-1 bg-slate-50 relative overflow-hidden",children:[i.jsx(K6,{users:n,externalSearchQuery:r,externalZoom:a!==null?a/100:void 0,showControls:!1}),i.jsx("div",{className:`absolute bottom-4 right-4 z-20 ${l?"block":"hidden"} md:block`,children:i.jsxs("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-xl shadow-lg px-4 py-3 min-w-[200px]",children:[i.jsxs("div",{className:"flex items-center justify-between mb-3",children:[i.jsxs("h4",{className:"text-xs font-bold text-slate-900 flex items-center gap-2",children:[i.jsx("div",{className:"w-2 h-2 bg-gradient-to-r from-indigo-500 to-purple-500 rounded-full"}),"Legend"]}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden text-slate-400 hover:text-slate-600",children:i.jsx(cu,{className:"w-3 h-3"})})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-purple-500 to-indigo-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Team Member"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded bg-gradient-to-br from-emerald-400 to-emerald-600 border border-white shadow-sm flex-shrink-0"}),i.jsx("span",{children:"Search Match"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-6 h-0.5 bg-gradient-to-r from-indigo-400 to-purple-500 flex-shrink-0 shadow-sm"}),i.jsx("span",{children:"Reports To"})]}),i.jsxs("div",{className:"flex items-center gap-2 text-xs text-slate-600",children:[i.jsx("div",{className:"w-4 h-4 rounded-full bg-emerald-500 text-white text-[8px] font-bold flex items-center justify-center flex-shrink-0",children:"L2"}),i.jsx("span",{children:"Level Badge"})]})]})]})}),i.jsx("button",{onClick:()=>c(!l),className:"md:hidden absolute bottom-4 right-4 z-30 bg-white border border-slate-200 rounded-full p-2 shadow-lg",children:i.jsx(cu,{className:"w-5 h-5 text-slate-600"})})]}),r&&i.jsx("div",{className:"flex-shrink-0 bg-white border-t border-slate-200 px-4 py-2",children:i.jsxs("p",{className:"text-xs text-slate-600",children:[n.filter(y=>y.name.toLowerCase().includes(r.toLowerCase())).length," results found"]})})]});return e?i.jsx("div",{className:"fixed inset-0 z-50 bg-white",children:x}):i.jsx("div",{className:"bg-white border border-slate-200 rounded-xl shadow-sm overflow-hidden",children:x})},qce=()=>{St();const[n,e]=E.useState([]),[t,r]=E.useState([]),[s,a]=E.useState("hr"),[o,l]=E.useState(!0),[c,d]=E.useState(!1),[h,p]=E.useState(null),[x,y]=E.useState("table"),_=E.useCallback(async()=>{l(!0);try{const[C,P,O]=await Promise.all([ue.getUsersWithManagers(),ue.getApprovalWorkflowSettings(),ue.getRoles()]);e(C),a(P.finalConfirmationRole),r(O.filter(M=>["admin","hr","operation_manager"].includes(M.id)))}catch{p({message:"Failed to load workflow data.",type:"error"})}finally{l(!1)}},[]);E.useEffect(()=>{_()},[_]);const w=(C,P)=>{e(O=>O.map(M=>M.id===C?{...M,reportingManagerId:P||void 0}:M))},j=async()=>{d(!0);try{await Promise.all(n.map(C=>ue.updateUserReportingManager(C.id,C.reportingManagerId||null))),await ue.updateApprovalWorkflowSettings(s),p({message:"Workflow saved successfully!",type:"success"}),_()}catch{p({message:"Failed to save workflow.",type:"error"})}finally{d(!1)}};return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(na,{title:"Leave Approval Settings",children:i.jsxs(ne,{onClick:j,isLoading:c,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Workflow"]})}),i.jsxs("section",{className:"mb-8",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text mb-2",children:"Final Confirmation Step"}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Select the role responsible for the final confirmation of a leave request after it has been approved by the reporting manager chain."}),i.jsx("div",{className:"max-w-xs",children:i.jsx(Ze,{label:"Final Confirmation Role",id:"final-approver",value:s,onChange:C=>a(C.target.value),children:t.map(C=>i.jsx("option",{value:C.id,children:C.displayName},C.id))})})]}),i.jsxs("section",{children:[i.jsx("div",{className:"flex items-center justify-between mb-4",children:i.jsxs("div",{children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-1",children:"Reporting Structure"}),i.jsx("p",{className:"text-sm text-muted",children:"View and manage organizational hierarchy"})]})}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("div",{className:"flex gap-1 overflow-x-auto",children:[i.jsxs("button",{onClick:()=>y("table"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="table"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(qJ,{className:"w-4 h-4"}),"Table View"]}),i.jsxs("button",{onClick:()=>y("2d"),className:`flex items-center gap-2 px-4 py-3 text-sm font-medium transition-colors whitespace-nowrap border-b-2 ${x==="2d"?"border-primary text-primary":"border-transparent text-muted hover:text-primary-text hover:border-border"}`,children:[i.jsx(EJ,{className:"w-4 h-4"}),"2D Workflow Chart"]})]})}),o?i.jsx("div",{className:"flex justify-center items-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):i.jsxs(i.Fragment,{children:[x==="table"&&i.jsxs(i.Fragment,{children:[i.jsx("p",{className:"text-sm text-muted mb-4",children:"For each employee, assign a reporting manager. Leave requests will be sent to this manager for first-level approval."}),i.jsx("div",{className:"overflow-x-auto hidden md:block border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Role"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase w-1/2",children:"Reporting Manager"})]})}),i.jsx("tbody",{className:"bg-card divide-y divide-border",children:n.map(C=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-6 py-4 font-medium text-primary-text",children:C.name}),i.jsx("td",{className:"px-6 py-4 text-sm text-muted capitalize",children:t.find(P=>P.id===C.role)?.displayName||C.role.replace(/_/g," ")}),i.jsx("td",{className:"px-6 py-4",children:i.jsxs(Ze,{label:"",id:`manager-for-desktop-${C.id}`,value:C.reportingManagerId||"",onChange:P=>w(C.id,P.target.value),className:"w-full",children:[i.jsx("option",{value:"",children:"None (Reports to Final Approver)"}),n.filter(P=>P.id!==C.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})})]},C.id))})]})}),i.jsx("div",{className:"space-y-3 md:hidden",children:n.map(C=>i.jsxs("div",{className:"bg-card rounded-lg border border-border overflow-hidden",children:[i.jsxs("div",{className:"p-3",children:[i.jsx("p",{className:"font-semibold text-primary-text",children:C.name}),i.jsx("p",{className:"text-sm text-muted capitalize",children:t.find(P=>P.id===C.role)?.displayName||C.role.replace(/_/g," ")})]}),i.jsxs("div",{className:"p-3 border-t border-border",children:[i.jsx("label",{className:"text-sm text-muted block mb-1",children:"Manager"}),i.jsxs(Ze,{id:`manager-for-mobile-${C.id}`,value:C.reportingManagerId||"",onChange:P=>w(C.id,P.target.value),children:[i.jsx("option",{value:"",children:"None"}),n.filter(P=>P.id!==C.id).map(P=>i.jsx("option",{value:P.id,children:P.name},P.id))]})]})]},C.id))})]}),x==="2d"&&i.jsx(Fce,{users:n})]})]})]})},zce=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0);E.useEffect(()=>{(async()=>{try{const l=await ue.getUsersWithManagers();t(l)}catch(l){console.error("Failed to load users",l)}finally{s(!1)}})()},[]);const a=()=>{n("/admin/approval-workflow")};return r?i.jsx("div",{className:"w-screen h-screen flex items-center justify-center bg-slate-50",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-primary"})}):i.jsxs("div",{className:"w-screen h-screen relative bg-slate-50 overflow-hidden",children:[i.jsx("button",{onClick:a,className:"absolute top-4 right-4 z-50 p-3 bg-white rounded-full shadow-xl hover:bg-gray-50 transition-all duration-200 border border-gray-200 group",title:"Close Full Screen",children:i.jsx(vi,{className:"h-6 w-6 text-gray-600 group-hover:text-red-500 transition-colors"})}),i.jsx(K6,{users:e})]})},_C=Xi(n=>({tasks:[],isLoading:!1,error:null,fetchTasks:async()=>{n({isLoading:!0,error:null});try{const e=await ue.getTasks();n({tasks:e,isLoading:!1})}catch{n({error:"Failed to fetch tasks.",isLoading:!1})}},createTask:async e=>{try{const t=await ue.createTask(e);n(r=>({tasks:[t,...r.tasks]}))}catch(t){throw console.error("Failed to create task",t),new Error("Failed to create task.")}},updateTask:async(e,t)=>{try{const r=await ue.updateTask(e,t);n(s=>({tasks:s.tasks.map(a=>a.id===e?r:a)}))}catch(r){throw console.error("Failed to update task",r),new Error("Failed to update task.")}},deleteTask:async e=>{try{await ue.deleteTask(e),n(t=>({tasks:t.tasks.filter(r=>r.id!==e)}))}catch(t){throw console.error("Failed to delete task",t),new Error("Failed to delete task.")}},runAutomaticEscalations:async()=>{try{const{updatedTasks:e,newNotifications:t}=await ue.runAutomaticEscalations();if(e.length>0&&n(r=>({tasks:r.tasks.map(s=>e.find(a=>a.id===s.id)||s)})),t.length>0){const r=t.map(s=>ue.createNotification(s));await Promise.all(r),cy.getState().fetchNotifications()}}catch(e){console.error("Failed to run automatic escalations",e)}}})),Uce=Pt({completionNotes:xe().required("Completion notes are required").min(10,"Please provide more detail."),completionPhoto:Wt().required("A photo proof of completion is required.").nullable()}).defined(),Bce=({isOpen:n,onClose:e,task:t,setToast:r})=>{const{updateTask:s}=_C(),[a,o]=ot.useState(!1),{handleSubmit:l,formState:{errors:c},reset:d,control:h}=tn({resolver:In(Uce),defaultValues:{completionNotes:"",completionPhoto:null}}),p=async x=>{o(!0);try{await s(t.id,{...x,status:"Done"}),r({message:"Task completed successfully!",type:"success"}),e()}catch{r({message:"Failed to complete task.",type:"error"})}finally{o(!1)}};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:x=>x.stopPropagation(),children:i.jsxs("form",{onSubmit:l(p),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Complete Task: ",t.name]}),i.jsx("p",{className:"text-sm text-muted mb-4",children:"Provide a summary and photo proof of your work."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"completionNotes",className:"block text-sm font-medium text-muted",children:"Completion Notes"}),i.jsx("textarea",{id:"completionNotes",rows:4,...h.register("completionNotes"),className:`mt-1 bg-card border ${c.completionNotes?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`}),c.completionNotes&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionNotes.message})]}),i.jsx(_e,{name:"completionPhoto",control:h,render:({field:x})=>i.jsx(vt,{label:"Upload Photo Proof",file:x.value,onFileChange:x.onChange,allowedTypes:["image/jpeg","image/png"]})}),c.completionPhoto&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.completionPhoto.message})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:a,children:"Mark as Done"})]})]})})}):null},Vce=n=>{const e=new Date;e.setHours(0,0,0,0);const t=o=>o?new Date(o):null;if(n.status==="Done"||!n.dueDate)return{date:n.dueDate?We(t(n.dueDate),"dd MMM, yyyy"):"-",isOverdue:!1};let r=null;const s=t(n.dueDate);switch(n.escalationStatus){case"None":r=n.escalationLevel1DurationDays?yl(s,n.escalationLevel1DurationDays):s;break;case"Level 1":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays){const o=yl(s,n.escalationLevel1DurationDays);r=yl(o,n.escalationLevel2DurationDays)}break;case"Level 2":if(n.escalationLevel1DurationDays&&n.escalationLevel2DurationDays&&n.escalationEmailDurationDays){const o=yl(s,n.escalationLevel1DurationDays),l=yl(o,n.escalationLevel2DurationDays);r=yl(l,n.escalationEmailDurationDays)}break}r||(r=s);const a=r?r<e:!1;return{date:We(r,"dd MMM, yyyy"),isOverdue:a}},Wce=()=>{const n=St(),{user:e}=jt(),{tasks:t,isLoading:r,error:s,fetchTasks:a,deleteTask:o,runAutomaticEscalations:l}=_C(),{theme:c}=ed(),{colorScheme:d}=an(),h=d!=="green",p=c==="dark",x=h?"!bg-blue-600 hover:!bg-blue-700 text-white":"!bg-[#32CD32] hover:!bg-[#28a428] !text-[#0D1A0D]",y=h?"bg-[#1a3a6e] hover:bg-[#152b1b] text-white":"bg-emerald-600 text-white hover:bg-emerald-700",[_,w]=E.useState(!1),[j,C]=E.useState(!1),[P,O]=E.useState(null),[M,D]=E.useState(null),[I,F]=E.useState([]),[q,B]=E.useState("all"),[U,W]=E.useState("all"),[G,Z]=E.useState("all"),Y=Rt("(max-width: 767px)");E.useEffect(()=>{(async()=>{ue.getUsers().then(F),await a(),await l()})()},[a,l]);const ae=()=>{n("/tasks/add")},ee=de=>{n(`/tasks/edit/${de.id}`)},me=de=>{O(de),w(!0)},$=de=>{O(de),C(!0)},K=async()=>{if(P)try{await o(P.id),D({message:"Task deleted.",type:"success"}),C(!1)}catch{D({message:"Failed to delete task.",type:"error"})}},re=E.useMemo(()=>t.filter(de=>{if(q!=="all"&&de.status!==q||U!=="all"&&de.priority!==U)return!1;if(G==="unassigned"){if(de.assignedToId)return!1}else if(G!=="all"&&de.assignedToId!==G)return!1;return!0}),[t,q,U,G]),H=()=>{B("all"),W("all"),Z("all")},se=q!=="all"||U!=="all"||G!=="all",ie=de=>{const te={High:p?"bg-red-500/20 text-red-400":"bg-red-100 text-red-800",Medium:p?"bg-yellow-500/20 text-yellow-400":"bg-yellow-100 text-yellow-800",Low:p?"bg-blue-500/20 text-blue-400":"bg-blue-100 text-blue-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${te[de]}`,children:de})},ce=de=>{const te={"To Do":p?"bg-gray-500/20 text-gray-300":"bg-gray-100 text-gray-800","In Progress":p?"bg-indigo-500/20 text-indigo-300":"bg-indigo-100 text-indigo-800",Done:p?"bg-green-500/20 text-green-300":"bg-green-100 text-green-800"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${te[de]}`,children:de})},oe=de=>{if(de==="None")return null;const te={None:"","Level 1":p?"bg-orange-500/20 text-orange-400":"bg-orange-100 text-orange-800","Level 2":p?"bg-amber-500/20 text-amber-400":"bg-amber-100 text-amber-800","Email Sent":p?"bg-purple-500/20 text-purple-400":"bg-purple-100 text-purple-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full ${te[de]}`,children:de})};return i.jsxs("div",{className:`min-h-screen ${Y?`${h?"!bg-white !text-gray-900":"bg-[#041b0f] text-white"} p-4 pb-24`:`p-4 ${p?(h?"bg-[#0a1628]":"bg-[#041b0f]")+" border border-white/10":"md:bg-card"} md:p-6 md:rounded-xl md:shadow-card`}`,children:[M&&i.jsx(pt,{message:M.message,type:M.type,onDismiss:()=>D(null)}),_&&P&&i.jsx(Bce,{isOpen:_,onClose:()=>w(!1),task:P,setToast:D}),i.jsxs(Kr,{isOpen:j,onClose:()=>C(!1),onConfirm:K,title:"Confirm Deletion",children:['Are you sure you want to delete the task "',P?.name,'"?']}),i.jsx("div",{className:"mb-6",children:i.jsx("h1",{className:`text-2xl font-bold ${Y?h?"!text-gray-900":"text-white":p?h?"text-gray-900":"text-white":"text-gray-900"}`,children:"Task Management"})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-6 md:items-end justify-between",children:[i.jsxs("div",{className:"flex-1 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${Y?h?"!text-gray-900":"text-gray-300":p?h?"text-gray-600":"text-gray-300":"text-gray-700"}`,children:"Filter by Status"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${Y?`${h?"!bg-gray-50 !border-gray-200 !text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:p?`${h?"bg-gray-50 border-gray-200 text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:"bg-white border-gray-300 text-gray-900"}`,value:q,onChange:de=>B(de.target.value),children:[i.jsx("option",{value:"all",className:Y||p?h?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"All Statuses"}),i.jsx("option",{value:"To Do",className:Y||p?h?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"To Do"}),i.jsx("option",{value:"In Progress",className:Y||p?h?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"In Progress"}),i.jsx("option",{value:"Done",className:Y||p?h?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"Done"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${Y?h?"!text-gray-900":"text-gray-300":p?d==="blue"?"text-gray-600":"text-gray-300":"text-gray-700"}`,children:"Filter by Priority"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${Y?`${h?"!bg-gray-50 !border-gray-200 !text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:p?`${d==="blue"?"bg-gray-50 border-gray-200 text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:"bg-white border-gray-300 text-gray-900"}`,value:U,onChange:de=>W(de.target.value),children:[i.jsx("option",{value:"all",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"All Priorities"}),i.jsx("option",{value:"Low",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"space-y-1",children:[i.jsx("label",{className:`text-sm font-medium ${Y?h?"!text-gray-900":"text-gray-300":p?d==="blue"?"text-gray-600":"text-gray-300":"text-gray-700"}`,children:"Filter by Assignee"}),i.jsxs("select",{className:`w-full rounded-lg border px-3 py-2 outline-none focus:ring-2 focus:ring-emerald-500 ${Y?`${h?"!bg-gray-50 !border-gray-200 !text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:p?`${d==="blue"?"bg-gray-50 border-gray-200 text-gray-900":"bg-[#152b1b] border-white/10 text-white"}`:"bg-white border-gray-300 text-gray-900"}`,value:G,onChange:de=>Z(de.target.value),children:[i.jsx("option",{value:"all",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"All Users"}),i.jsx("option",{value:"unassigned",className:Y||p?d==="blue"?"bg-white text-gray-900":"bg-[#041b0f]":"",children:"Unassigned"}),I.map(de=>i.jsx("option",{value:de.id,className:Y||p?d==="blue"?"bg-white":"bg-[#041b0f]":"",children:de.name},de.id))]})]})]}),i.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0 mt-4 md:mt-0",children:[se&&i.jsxs(ne,{variant:"secondary",onClick:H,className:Y?h?"!bg-gray-100 !text-gray-700 !border-gray-200":"!bg-[#152b1b] !text-white !border-white/10":p?`${d==="blue"?"!bg-gray-100 !text-gray-700 !border-gray-200":"!bg-[#152b1b]"} !text-white !border-white/10`:"",children:[i.jsx(vi,{className:"mr-2 h-4 w-4"})," Clear Filters"]}),i.jsxs("button",{onClick:ae,className:`flex items-center justify-center transition-colors ${Y?x+" !font-bold !border-none shadow-none text-sm py-3 px-6 rounded-xl":y+" rounded-lg px-6 py-2.5 font-medium"}`,children:[i.jsx(Vt,{className:"mr-2 h-5 w-5"})," Add Task"]})]})]}),s&&i.jsx("p",{className:"text-red-500 mb-4",children:s}),i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:Y?"hidden":p?"bg-white/5 text-white":"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Task Name"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Priority"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Next Due Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Assigned To"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Status"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Escalation"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:`divide-y md:divide-y-0 ${Y?"divide-white/10 space-y-4 block":p?`divide-white/10 ${h?"bg-[#0a1628]":"bg-[#041b0f]"}`:"divide-border md:bg-card"}`,children:r?Y?i.jsx("tr",{children:i.jsx("td",{colSpan:7,children:i.jsx(Ra,{rows:3,cols:7,isMobile:!0})})}):i.jsx(Ra,{rows:5,cols:7}):re.map(de=>{const{date:te,isOverdue:ye}=Vce(de);return Y?i.jsxs("div",{className:`${d==="blue"?"bg-white border-gray-200 shadow-sm":"bg-[#152b1b] border-white/5"} p-4 rounded-xl border mb-4`,children:[i.jsxs("div",{className:"flex justify-between items-start mb-3",children:[i.jsxs("div",{children:[i.jsx("h3",{className:`font-semibold text-lg ${d==="blue"?"text-gray-900":"text-white"}`,children:de.name}),i.jsxs("p",{className:`text-sm mt-1 ${d==="blue"?"text-gray-500":"text-gray-400"}`,children:["Due: ",i.jsx("span",{className:ye?"text-red-400 font-bold":"",children:te||"-"})]})]}),ie(de.priority)]}),i.jsxs("div",{className:"grid grid-cols-2 gap-2 text-sm mb-4",children:[i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Assigned To"}),i.jsx("span",{className:`${d==="blue"?"text-gray-700":"text-gray-300"}`,children:de.assignedToName||"-"})]}),i.jsxs("div",{children:[i.jsx("span",{className:"text-gray-500 block text-xs",children:"Status"}),i.jsx("span",{className:`${d==="blue"?"text-gray-700":"text-gray-300"}`,children:de.status})]})]}),i.jsxs("div",{className:`flex justify-end gap-2 border-t pt-3 ${d==="blue"?"border-gray-200":"border-white/10"}`,children:[i.jsx("button",{onClick:()=>ee(de),className:`p-2 rounded-lg ${d==="blue"?"text-gray-500 hover:text-gray-700 hover:bg-gray-100 bg-gray-50":"text-gray-400 hover:text-white bg-white/5"}`,children:i.jsx(dr,{className:"h-4 w-4"})}),i.jsx("button",{onClick:()=>$(de),className:`p-2 rounded-lg ${h?"text-red-600 hover:text-red-700 hover:bg-red-50 bg-red-50":"text-red-400 hover:text-red-300 bg-red-500/10"}`,children:i.jsx(rn,{className:"h-4 w-4"})}),de.assignedToId===e?.id&&de.status!=="Done"&&i.jsxs("button",{onClick:()=>me(de),className:`flex items-center px-3 py-2 rounded-lg text-sm font-medium ${h?"bg-emerald-50 text-emerald-600":"bg-emerald-500/10 text-emerald-400"}`,children:[i.jsx(Ki,{className:"h-4 w-4 mr-1.5"})," Complete"]})]})]},de.id):i.jsxs("tr",{className:ye?"bg-red-50":p?"text-gray-300 hover:bg-white/5":"",children:[i.jsx("td",{"data-label":"Task Name",className:"px-6 py-4 font-medium",children:de.name}),i.jsx("td",{"data-label":"Priority",className:"px-6 py-4",children:ie(de.priority)}),i.jsx("td",{"data-label":"Next Due Date",className:`px-6 py-4 text-sm ${ye?"font-bold text-red-600":"text-muted"}`,children:te||"-"}),i.jsx("td",{"data-label":"Assigned To",className:"px-6 py-4 text-sm text-muted",children:de.assignedToName||"-"}),i.jsx("td",{"data-label":"Status",className:"px-6 py-4 text-sm text-muted",children:ce(de.status)}),i.jsx("td",{"data-label":"Escalation",className:"px-6 py-4 text-sm text-muted",children:oe(de.escalationStatus)}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>ee(de),title:"Edit Task",children:i.jsx(dr,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>$(de),title:"Delete Task",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})}),de.assignedToId===e?.id&&de.status!=="Done"&&i.jsxs(ne,{variant:"outline",size:"sm",onClick:()=>me(de),children:[i.jsx(Ki,{className:"h-4 w-4 mr-2"})," Complete"]})]})})]},de.id)})})]}),!r&&re.length===0&&i.jsxs("div",{className:"text-center py-10 text-muted",children:[i.jsx("p",{className:Y||p?"text-gray-400":"",children:"No tasks found matching your criteria."}),se&&i.jsx(ne,{variant:"secondary",size:"sm",className:"mt-2",onClick:H,children:"Clear filters"})]})]})]})},$ce=Pt({id:xe().required(),name:xe().required("Client name is required"),organizationId:xe().optional(),location:xe().optional(),registeredAddress:xe().optional(),registrationType:xe().oneOf(["CIN","ROC","ROF","Society","Trust",""]).optional(),registrationNumber:xe().optional(),gstNumber:xe().optional().nullable().matches(/^[0-9]{2}[A-Z]{5}[0-9]{4}[A-Z]{1}[1-9A-Z]{1}Z[0-9A-Z]{1}$/,"Invalid GST Number format").optional(),panNumber:xe().transform(n=>n?.toUpperCase()||"").matches(/^[A-Z]{5}[0-9]{4}[A-Z]{1}$/,"Invalid PAN format").optional(),email:xe().email("Invalid email format").optional(),eShramNumber:xe().optional(),shopAndEstablishmentCode:xe().optional(),epfoCode:xe().optional(),esicCode:xe().optional(),psaraLicenseNumber:xe().optional(),psaraValidTill:xe().optional().nullable(),insuranceIds:js().of(xe().required()).optional(),policyIds:js().of(xe().required()).optional()}).defined(),Hce=({isOpen:n,onClose:e,onSave:t,initialData:r,companyName:s})=>{const[a,o]=E.useState("General"),[l,c]=E.useState([]),[d,h]=E.useState([]),[p,x]=E.useState(!0),{register:y,handleSubmit:_,formState:{errors:w},reset:j,control:C}=tn({resolver:In($ce)}),P=!!r;E.useEffect(()=>{n&&(x(!0),Promise.all([ue.getPolicies(),ue.getInsurances()]).then(([D,I])=>{c(D),h(I),x(!1)}),j(r||{id:`new_${Date.now()}`,name:"",location:"",registeredAddress:"",registrationType:"",registrationNumber:"",gstNumber:"",panNumber:"",email:"",eShramNumber:"",shopAndEstablishmentCode:"",epfoCode:"",esicCode:"",psaraLicenseNumber:"",psaraValidTill:"",insuranceIds:[],policyIds:[]}))},[r,j,n]);const O=D=>{t(D)};if(!n)return null;const M=({tabName:D})=>i.jsx("button",{type:"button",onClick:()=>o(D),className:`px-4 py-2 text-sm font-medium rounded-t-lg border-b-2 ${a===D?"border-accent text-accent":"border-transparent text-muted hover:text-primary-text"}`,children:D});return i.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto bg-black bg-opacity-50 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-3xl my-8 mx-auto animate-fade-in-scale",onClick:D=>D.stopPropagation(),children:i.jsxs("form",{onSubmit:_(O),children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:P?"Edit Client":"Add New Client"}),i.jsxs("p",{className:"text-sm text-muted",children:["for ",s]})]}),i.jsx("div",{className:"border-b border-border mb-6",children:i.jsxs("nav",{className:"-mb-px flex space-x-4",children:[i.jsx(M,{tabName:"General"}),i.jsx(M,{tabName:"Registration"}),i.jsx(M,{tabName:"Compliance"}),i.jsx(M,{tabName:"Policies & Insurance"})]})}),i.jsxs("div",{className:"space-y-6 min-h-[300px]",children:[a==="General"&&i.jsxs("div",{className:"space-y-4",children:[i.jsx(we,{label:"Client Name (as per document)",id:"name",registration:y("name"),error:w.name?.message}),i.jsx(we,{label:"Location / City",id:"location",registration:y("location"),error:w.location?.message}),i.jsx(we,{label:"Registered Address",id:"registeredAddress",registration:y("registeredAddress"),error:w.registeredAddress?.message})]}),a==="Registration"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsxs(Ze,{label:"Registration Type",id:"registrationType",registration:y("registrationType"),error:w.registrationType?.message,children:[i.jsx("option",{value:"",children:"Select Type"}),i.jsx("option",{value:"CIN",children:"CIN"}),i.jsx("option",{value:"ROC",children:"ROC"}),i.jsx("option",{value:"ROF",children:"ROF"}),i.jsx("option",{value:"Society",children:"Society"}),i.jsx("option",{value:"Trust",children:"Trust"})]}),i.jsx(we,{label:"Registration Number",id:"registrationNumber",registration:y("registrationNumber"),error:w.registrationNumber?.message}),i.jsx(we,{label:"GST Number",id:"gstNumber",registration:y("gstNumber"),error:w.gstNumber?.message}),i.jsx(we,{label:"PAN Number",id:"panNumber",registration:y("panNumber"),error:w.panNumber?.message}),i.jsx(we,{label:"Email Address",id:"email",type:"email",registration:y("email"),error:w.email?.message})]}),a==="Compliance"&&i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[i.jsx(we,{label:"E-Shram Number",id:"eShramNumber",registration:y("eShramNumber"),error:w.eShramNumber?.message}),i.jsx(we,{label:"Shop & Establishment Code",id:"shopAndEstablishmentCode",registration:y("shopAndEstablishmentCode"),error:w.shopAndEstablishmentCode?.message}),i.jsx(we,{label:"EPFO Code",id:"epfoCode",registration:y("epfoCode"),error:w.epfoCode?.message}),i.jsx(we,{label:"ESIC Code",id:"esicCode",registration:y("esicCode"),error:w.esicCode?.message}),i.jsx(we,{label:"PSARA License Number",id:"psaraLicenseNumber",registration:y("psaraLicenseNumber"),error:w.psaraLicenseNumber?.message}),i.jsx(_e,{name:"psaraValidTill",control:C,render:({field:D})=>i.jsx(En,{label:"PSARA Valid Till",id:"psaraValidTill",value:D.value,onChange:D.onChange,error:w.psaraValidTill?.message})})]}),a==="Policies & Insurance"&&(p?i.jsx(_t,{className:"mx-auto h-6 w-6 animate-spin text-muted"}):i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsx(_e,{name:"policyIds",control:C,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Policies"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:l.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(I.id),onChange:F=>{const q=F.target.checked?[...D.value||[],I.id]:(D.value||[]).filter(B=>B!==I.id);D.onChange(q)}}),i.jsx("span",{className:"ml-3 text-sm",children:I.name})]},I.id))})]})}),i.jsx(_e,{name:"insuranceIds",control:C,render:({field:D})=>i.jsxs("div",{children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Insurance"}),i.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto p-3 border rounded-lg bg-page",children:d.map(I=>i.jsxs("label",{className:"flex items-center p-2 rounded-md hover:bg-card transition-colors",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",checked:D.value?.includes(I.id),onChange:F=>{const q=F.target.checked?[...D.value||[],I.id]:(D.value||[]).filter(B=>B!==I.id);D.onChange(q)}}),i.jsxs("span",{className:"ml-3 text-sm",children:[I.type," - ",I.provider]})]},I.id))})]})})]}))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t border-border flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{type:"submit",children:P?"Save Changes":"Add Client"})]})]})})})},Qg=({number:n,title:e,children:t})=>i.jsxs("div",{children:[i.jsxs("h4",{className:"font-bold text-lg text-primary-text mb-2",children:["Step ",n,": ",e]}),i.jsx("div",{className:"text-sm text-muted space-y-2",children:t})]}),Yce=({isOpen:n,onClose:e})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-3xl my-8 animate-fade-in-scale flex flex-col",onClick:t=>t.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex items-center gap-3",children:[i.jsx(us,{className:"h-6 w-6 text-accent"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"How to Use Import Templates"})]}),i.jsxs("div",{className:"flex-grow overflow-y-auto p-6 space-y-6 max-h-[70vh]",children:[i.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx(Aa,{className:"h-5 w-5 text-red-500 mr-3 flex-shrink-0 mt-0.5"}),i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-red-800",children:"The Golden Rule: Do Not Modify the Template Structure"}),i.jsx("p",{className:"text-sm text-red-700 mt-1",children:"You must **NEVER** add, delete, rename, or reorder columns. Any changes to the header row will cause the import to fail. This rule ensures data integrity."})]})]})}),i.jsxs(Qg,{number:1,title:"Get the Template",children:[i.jsx("p",{children:"You have two options for getting a file to work with:"}),i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(us,{className:"h-4 w-4"})," Download Template:"]}),i.jsx("span",{children:"Provides a blank CSV file with only the correct header row. Use this for adding **new** records in bulk."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(r3,{className:"h-4 w-4"})," Export Data:"]}),i.jsx("span",{children:"Provides a CSV file filled with all the current data from the system. Use this for **updating existing** records in bulk."})]})]})]}),i.jsx(Qg,{number:2,title:"Edit Your Data",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(dr,{className:"h-4 w-4"})," To Update Existing Data:"]}),i.jsx("span",{children:"Use the file from **Export Data**. Find the row you want to change and edit its values. Do **NOT** edit the ID columns (e.g., `GroupId`, `EntityId`). These are used by the system to identify records."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(Vt,{className:"h-4 w-4"})," To Add New Data:"]}),i.jsx("span",{children:"Add a new row at the bottom of the file. Leave the ID columns blank; the system will generate them automatically. Fill in all other required information."})]}),i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Complex Data (JSON):"}),i.jsx("span",{children:"For Site Configuration, some columns like `agreementDetails` contain complex data. This is exported as a JSON text string. Only edit this text if you are familiar with JSON, as incorrect formatting will cause the import to fail."})]})]})}),i.jsx(Qg,{number:3,title:"Save and Import",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsx("strong",{className:"text-primary-text",children:"Save as CSV:"}),i.jsx("span",{children:"After making your changes, save your file. If you are using Excel or Google Sheets, make sure to **Save As** or **Download As** a **CSV (Comma-Separated Values)** file."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-primary-text flex items-center gap-2",children:[i.jsx(yJ,{className:"h-4 w-4"})," Import:"]}),i.jsx("span",{children:"Go back to the application, click **Import**, and select the CSV file you just saved."})]})]})}),i.jsx(Qg,{number:4,title:"Review Feedback",children:i.jsxs("ul",{className:"list-disc list-inside pl-4 space-y-2",children:[i.jsxs("li",{children:[i.jsxs("strong",{className:"text-green-600 flex items-center gap-2",children:[i.jsx(Ki,{className:"h-4 w-4"})," Success:"]}),i.jsx("span",{children:"You will see a success message indicating how many records were imported."})]}),i.jsxs("li",{children:[i.jsxs("strong",{className:"text-red-600 flex items-center gap-2",children:[i.jsx(Aa,{className:"h-4 w-4"})," Error:"]}),i.jsx("span",{children:'If the import fails, a specific error message will appear. The most common error is a "Header mismatch," which means you have violated the Golden Rule. If this happens, download a fresh template and carefully copy your data into it.'})]})]})})]}),i.jsx("div",{className:"p-4 border-t flex justify-end",children:i.jsx(ne,{onClick:e,children:"Close"})})]})}):null,ud=({title:n})=>i.jsxs("div",{className:"flex flex-col items-center justify-center h-full text-center p-8 bg-page rounded-lg min-h-[400px]",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text mb-2",children:n}),i.jsx("p",{className:"text-muted max-w-sm",children:"Configuration for this section will be available here. The form details will be provided in a future update."})]}),UL=["Site Name","Designation","Quantity","Billing Rate","Billing Model","Holiday Billing Policy","Holiday Payment Policy","Uniform Deduction"],Gce=n=>{if(n.length===0)return"";const e=Object.keys(n[0]);return[e.join(","),...n.map(r=>e.map(s=>{const a=String(r[s]??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","))].join(`
`)},Zce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim()),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'""')),a[l]=d}),r.push(a)}return r},Kce=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState({}),[c,d]=E.useState(null),h=E.useRef(null),{register:p,control:x,handleSubmit:y,watch:_,setValue:w}=tn({defaultValues:{resources:[],serviceChargePercentage:10}}),{fields:j,append:C,remove:P,replace:O}=Ns({control:x,name:"resources"});E.useEffect(()=>{ue.getOrganizations().then(e).finally(()=>r(!1))},[]);const M=async ae=>{if(!ae){O([]);return}a(!0);try{const ee=await ue.getManpowerDetails(ae),me=ee.filter($=>$.count>0).map($=>({id:`res_${$.designation.replace(/\s/g,"_")}_${Date.now()}`,siteId:ae,designation:$.designation,quantity:$.count,billingRate:null,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"}));if(!o[ae]){const $=ee.map(K=>K.designation);l(K=>({...K,[ae]:$}))}O(me)}catch(ee){console.error("Failed to load manpower",ee),d({message:"Failed to load manpower details.",type:"error"})}finally{a(!1)}},D=async(ae,ee)=>{if(w(`resources.${ee}.designation`,""),ae&&!o[ae])try{const $=(await ue.getManpowerDetails(ae)).map(K=>K.designation);l(K=>({...K,[ae]:$}))}catch(me){console.error(`Failed to load designations for site ${ae}`,me)}},I=_("resources"),F=_("serviceChargePercentage"),q=()=>{C({id:`res_${Date.now()}`,siteId:"",designation:"",quantity:1,billingRate:0,billingModel:"Per Month",holidayBillingPolicy:"",holidayPaymentPolicy:"",uniformDeduction:"Yes"})},{subTotal:B,serviceCharge:U,grandTotal:W}=ot.useMemo(()=>{const ee=(Array.isArray(I)?I:[]).reduce((re,H)=>{const se=Number(H.quantity)||0,ie=Number(H.billingRate)||0;return re+se*ie},0),me=Number(F)||0,$=ee*(me/100),K=ee+$;return{subTotal:ee,serviceCharge:$,grandTotal:K}},[I,F]),G=()=>{const ae=[Object.fromEntries(UL.map(K=>[K,""]))],ee=Gce(ae),me=new Blob([ee],{type:"text/csv;charset=utf-8;"}),$=document.createElement("a");$.href=URL.createObjectURL(me),$.setAttribute("download","costing_resource_template.csv"),document.body.appendChild($),$.click(),document.body.removeChild($)},Z=ae=>{const ee=ae.target.files?.[0];if(!ee)return;const me=new FileReader;me.onload=async $=>{try{const K=$.target?.result;if(!K)throw new Error("File is empty.");const re=Zce(K);if(re.length===0)throw new Error("No data rows found in CSV.");const H=Object.keys(re[0]);if(!UL.every(te=>H.includes(te)))throw new Error("CSV file is missing required headers.");const ie=new Map(n.map(te=>[te.shortName.toLowerCase(),te.id])),ce=new Set;for(const te of re){const ye=te["Site Name"]?.trim().toLowerCase();if(ye){const Ce=ie.get(ye);typeof Ce=="string"&&ce.add(Ce)}}const oe=[...ce].filter(te=>!o[te]);if(oe.length>0){const te=oe.map(Ce=>ue.getManpowerDetails(Ce).then(Re=>({siteId:Ce,designations:Re.map(Te=>Te.designation)}))),ye=await Promise.all(te);l(Ce=>{const Re={...Ce};return ye.forEach(Te=>{Re[Te.siteId]=Te.designations}),Re})}const de=re.map(te=>{const ye=te["Site Name"]?.trim().toLowerCase(),Ce=ye?ie.get(ye):void 0;return Ce?{id:`res_imported_${Date.now()}_${Math.random()}`,siteId:Ce,designation:te.Designation||"",quantity:parseFloat(te.Quantity)||0,billingRate:parseFloat(te["Billing Rate"])||0,billingModel:te["Billing Model"]||"Per Month",holidayBillingPolicy:te["Holiday Billing Policy"]||"",holidayPaymentPolicy:te["Holiday Payment Policy"]||"",uniformDeduction:te["Uniform Deduction"]||"Yes"}:null}).filter(te=>te!==null);O(de),d({message:`Successfully imported ${de.length} resources.`,type:"success"})}catch(K){d({message:K.message||"Failed to import CSV.",type:"error"})}finally{ae.target&&(ae.target.value="")}},me.readAsText(ee)},Y=ae=>{console.log("Saving Costing & Resource Data:",ae),d({message:"Configuration saved successfully (mocked).",type:"success"})};return i.jsxs("form",{onSubmit:y(Y),className:"space-y-6",children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),i.jsx("input",{type:"file",ref:h,className:"hidden",accept:".csv",onChange:Z}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Costing & Resource Configuration"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsxs(Ze,{label:"Load Manpower from Site",id:"site-selector",onChange:ae=>M(ae.target.value),disabled:t||s,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),n.map(ae=>i.jsx("option",{value:ae.id,children:ae.shortName},ae.id))]}),s&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]})]}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 md:flex md:flex-wrap md:justify-end md:gap-2",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:G,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Download Template",children:[i.jsx(bi,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Template"})]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>h.current?.click(),className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Import",children:[i.jsx(Hc,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Import"})]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:q,className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Add Resource",children:[i.jsx(Vt,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Add Resource"})]}),i.jsxs(ne,{type:"submit",className:"!p-2 justify-center md:!px-4 md:!py-2",title:"Save",children:[i.jsx(Cs,{className:"h-5 w-5 md:mr-2"}),i.jsx("span",{className:"hidden md:inline",children:"Save"})]})]}),i.jsx("div",{className:"space-y-4",children:j.map((ae,ee)=>{const me=_(`resources.${ee}.siteId`);return i.jsxs("div",{className:"p-4 border border-border rounded-xl relative bg-page/50",children:[i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>P(ee),className:"absolute top-2 right-2","aria-label":"Remove Resource",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[i.jsx(_e,{control:x,name:`resources.${ee}.siteId`,render:({field:$})=>i.jsxs(Ze,{label:"Site",id:`res-site-${ee}`,...$,onChange:K=>{$.onChange(K),D(K.target.value,ee)},children:[i.jsx("option",{value:"",children:"Select Site"}),n.map(K=>i.jsx("option",{value:K.id,children:K.shortName},K.id))]})}),i.jsxs(Ze,{label:"Designation",id:`res-desig-${ee}`,...p(`resources.${ee}.designation`),disabled:!me,children:[i.jsx("option",{value:"",children:"Select Designation"}),(o[me]||[]).map($=>i.jsx("option",{value:$,children:$},$))]}),i.jsx(we,{label:"Quantity",id:`res-qty-${ee}`,type:"number",step:"0.01",...p(`resources.${ee}.quantity`)}),i.jsx(we,{label:"Billing Rate",id:`res-rate-${ee}`,type:"number",step:"0.01",...p(`resources.${ee}.billingRate`)}),i.jsxs(Ze,{label:"Billing Model",id:`res-billing-${ee}`,...p(`resources.${ee}.billingModel`),children:[i.jsx("option",{children:"Per Month"}),i.jsx("option",{children:"Per Day"}),i.jsx("option",{children:"Per Hour"}),i.jsx("option",{children:"Lumpsum"})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-bill-${ee}`,className:"block text-sm font-medium text-muted",children:"Holiday Billing Policy"}),i.jsx("textarea",{id:`res-hol-bill-${ee}`,...p(`resources.${ee}.holidayBillingPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:`res-hol-pay-${ee}`,className:"block text-sm font-medium text-muted",children:"Holiday Payment Policy"}),i.jsx("textarea",{id:`res-hol-pay-${ee}`,...p(`resources.${ee}.holidayPaymentPolicy`),rows:3,className:"mt-1 form-input"})]}),i.jsxs(Ze,{label:"Uniform Deduction",id:`res-uniform-${ee}`,...p(`resources.${ee}.uniformDeduction`),children:[i.jsx("option",{children:"Yes"}),i.jsx("option",{children:"No"})]})]})]},ae.id)})}),j.length>0&&i.jsx("div",{className:"flex justify-end pt-4 border-t border-border",children:i.jsxs("div",{className:"w-full max-w-sm space-y-3",children:[i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsx("span",{className:"text-muted font-medium",children:"Sub Total"}),i.jsx("span",{className:"font-semibold text-primary-text",children:B.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center text-sm",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("span",{className:"text-muted font-medium",children:"Service Charges"}),i.jsx("div",{className:"w-20",children:i.jsx(we,{"aria-label":"Service charge percentage",id:"service-charge-perc",type:"number",...p("serviceChargePercentage")})}),i.jsx("span",{className:"text-muted font-medium",children:"%"})]}),i.jsx("span",{className:"font-semibold text-primary-text",children:U.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]}),i.jsxs("div",{className:"flex justify-between items-center pt-2 mt-2 border-t-2 border-primary-text",children:[i.jsx("span",{className:"font-bold text-lg",children:"Grand Total"}),i.jsx("span",{className:"font-bold text-lg",children:W.toLocaleString("en-IN",{style:"currency",currency:"INR"})})]})]})}),j.length===0&&i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:t?i.jsx(_t,{className:"h-5 w-5 animate-spin mx-auto"}):'Select a site to load manpower or click "Add Resource" to begin.'})]})},J6=["Department","Designation","PermanentId","TemporaryId"],Jce=n=>{const e=J6.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId].map(s=>{const a=String(s??"");return a.includes(",")?`"${a}"`:a}).join(","));return[e,...t].join(`
`)},Qce=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim());if(!["Department","Designation","PermanentId","TemporaryId"].every(s=>t.includes(s)))throw new Error("CSV is missing required headers.");return e.slice(1).map(s=>{const a=s.split(","),o={};return t.forEach((l,c)=>{l==="Department"&&(o.department=a[c]),l==="Designation"&&(o.designation=a[c]),l==="PermanentId"&&(o.permanentId=a[c]),l==="TemporaryId"&&(o.temporaryId=a[c])}),o})},Xce=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{series:[]}}),{append:h,remove:p,replace:x}=Ns({control:o,name:"series"});E.useEffect(()=>{e(!0),ue.getBackOfficeIdSeries().then(M=>c({series:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const y=d("series"),_=E.useMemo(()=>Array.isArray(y)?y.reduce((M,D,I)=>{const F=D.department||"Uncategorized";return M[F]||(M[F]=[]),M[F].push({...D,originalIndex:I}),M},{}):{},[y]),w=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:""})},j=async M=>{try{await ue.updateBackOfficeIdSeries(M.series),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},C=()=>{if(!Array.isArray(y)||y.length===0){r({message:"No data to export.",type:"error"});return}const M=Jce(y),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","back_office_id_series.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=J6.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","id_series_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},O=M=>{const D=M.target.files?.[0];if(!D)return;const I=new FileReader;I.onload=F=>{try{const q=F.target?.result,U=Qce(q).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||""}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(q){r({message:q.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:O}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Back Office Department & Emp ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:P,children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Hc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:C,children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No ID series defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(we,{"aria-label":`Department for ${M}`,id:`series.${D[0].originalIndex}.department`,...a(`series.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-10 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`series.${I.originalIndex}.designation`,...a(`series.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`series.${I.originalIndex}.permanentId`,...a(`series.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`series.${I.originalIndex}.temporaryId`,...a(`series.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(ne,{type:"button",onClick:w,variant:"outline",className:"mt-6",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},Gx=["Department","Designation","PermanentId","TemporaryId","MonthlySalary"],ede=n=>{const e=Gx.join(","),t=n.map(r=>[r.department,r.designation,r.permanentId,r.temporaryId,r.monthlySalary].map(s=>{const a=String(s??"");return a.includes(",")||a.includes('"')||a.includes(`
`)?`"${a.replace(/"/g,'""')}"`:a}).join(","));return[e,...t].join(`
`)},tde=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,""));if(!Gx.every(s=>t.includes(s)))throw new Error(`CSV is missing required headers: ${Gx.join(", ")}`);const r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((c,d)=>{let h=(o[d]||"").trim();h.startsWith('"')&&h.endsWith('"')&&(h=h.substring(1,h.length-1).replace(/""/g,'""')),a[c]=h});const l=parseFloat(a.MonthlySalary);r.push({department:a.Department,designation:a.Designation,permanentId:a.PermanentId,temporaryId:a.TemporaryId,monthlySalary:isNaN(l)?null:l})}return r},nde=()=>{const[n,e]=E.useState(!0),[t,r]=E.useState(null),s=E.useRef(null),{register:a,control:o,handleSubmit:l,reset:c,watch:d}=tn({defaultValues:{designations:[]}}),{append:h,remove:p,replace:x}=Ns({control:o,name:"designations"});E.useEffect(()=>{e(!0),ue.getSiteStaffDesignations().then(M=>c({designations:M})).catch(()=>r({message:"Failed to load data.",type:"error"})).finally(()=>e(!1))},[c]);const y=d("designations"),_=E.useMemo(()=>Array.isArray(y)?y.reduce((M,D,I)=>{const F=D.department||"Uncategorized";return M[F]||(M[F]=[]),M[F].push({...D,originalIndex:I}),M},{}):{},[y]),w=()=>{h({id:`new_${Date.now()}`,department:"",designation:"",permanentId:"",temporaryId:"",monthlySalary:null})},j=async M=>{try{await ue.updateSiteStaffDesignations(M.designations),r({message:"Configuration saved successfully.",type:"success"})}catch{r({message:"Failed to save configuration.",type:"error"})}},C=()=>{if(!Array.isArray(y)||y.length===0){r({message:"No data to export.",type:"error"});return}const M=ede(y),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","site_staff_designations.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},P=()=>{const M=Gx.join(","),D=new Blob([M],{type:"text/csv;charset=utf-8;"}),I=document.createElement("a");I.href=URL.createObjectURL(D),I.setAttribute("download","site_staff_template.csv"),document.body.appendChild(I),I.click(),document.body.removeChild(I)},O=M=>{const D=M.target.files?.[0];if(!D)return;const I=new FileReader;I.onload=F=>{try{const q=F.target?.result,U=tde(q).map(W=>({id:`imported_${Date.now()}_${Math.random()}`,department:W.department||"",designation:W.designation||"",permanentId:W.permanentId||"",temporaryId:W.temporaryId||"",monthlySalary:W.monthlySalary||null}));x(U),r({message:`Imported ${U.length} records.`,type:"success"})}catch(q){r({message:q.message||"Failed to import CSV.",type:"error"})}finally{M.target&&(M.target.value="")}},I.readAsText(D)};return i.jsxs("form",{onSubmit:l(j),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:O}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Staff Designation & ID Series"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:P,children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Hc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:C,children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsx("div",{className:"space-y-6",children:n?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):Object.keys(_).length===0?i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No designations defined. Click "Add Designation" to begin.'}):Object.entries(_).map(([M,D])=>i.jsxs("div",{className:"border border-border rounded-xl",children:[i.jsx("div",{className:"p-4 bg-page rounded-t-xl",children:i.jsx(we,{"aria-label":`Department for ${M}`,id:`designations.${D[0].originalIndex}.department`,...a(`designations.${D[0].originalIndex}.department`),className:"font-semibold text-lg !border-0 !p-0 !bg-transparent focus:!ring-0"})}),i.jsx("div",{className:"space-y-3 p-4",children:Array.isArray(D)&&D.map(I=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Designation","aria-label":`Designation for ${M}`,id:`designations.${I.originalIndex}.designation`,...a(`designations.${I.originalIndex}.designation`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Permanent ID","aria-label":`Permanent ID for ${I.designation}`,id:`designations.${I.originalIndex}.permanentId`,...a(`designations.${I.originalIndex}.permanentId`)})}),i.jsx("div",{className:"md:col-span-2",children:i.jsx(we,{placeholder:"Temporary ID","aria-label":`Temporary ID for ${I.designation}`,id:`designations.${I.originalIndex}.temporaryId`,...a(`designations.${I.originalIndex}.temporaryId`)})}),i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{placeholder:"Monthly Salary (Gross)","aria-label":`Salary for ${I.designation}`,id:`designations.${I.originalIndex}.monthlySalary`,type:"number",...a(`designations.${I.originalIndex}.monthlySalary`,{valueAsNumber:!0})})}),i.jsx("div",{className:"md:col-span-1 text-right",children:i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>p(I.originalIndex),"aria-label":`Remove ${I.designation}`,title:`Remove ${I.designation}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},I.id))})]},M))}),i.jsxs(ne,{type:"button",onClick:w,variant:"outline",className:"mt-4",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Designation"]})]})},rde=({id:n,label:e,checked:t,onChange:r,description:s,disabled:a})=>i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("span",{className:"flex-grow flex flex-col",children:[i.jsx("span",{className:"text-sm font-medium text-primary-text",children:e}),s&&i.jsx("span",{className:"text-sm text-muted",children:s})]}),i.jsxs("div",{className:"relative inline-flex items-center cursor-pointer",children:[i.jsx("input",{type:"checkbox",id:n,className:"sr-only peer",checked:t,onChange:o=>r(o.target.checked),disabled:a}),i.jsx("div",{className:"w-11 h-6 bg-gray-200 rounded-full peer peer-focus:ring-2 peer-focus:ring-accent-dark peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-0.5 after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-accent"})]})]}),e1=["Applicability","OptInDisclaimer","CoverageDetails","OptOutDisclaimer","RequireAlternateInsurance","CollectProvider","CollectStartDate","CollectEndDate","CollectExtentOfCover"],sde={applicability:"Optional - Opt-in Default",optInDisclaimer:"",coverageDetails:"",optOutDisclaimer:"",requireAlternateInsurance:!1,collectProvider:!1,collectStartDate:!1,collectEndDate:!1,collectExtentOfCover:!1},ide=n=>{const e=e1.join(","),t=e1.map(r=>{const s=r.charAt(0).toLowerCase()+r.slice(1);let a=n[s];return typeof a=="string"&&(a.includes(",")||a.includes(`
`)||a.includes('"'))?`"${a.replace(/"/g,'""')}"`:a});return[e,t.join(",")].join(`
`)},ade=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)throw new Error("CSV file must have a header and at least one data row.");const t=e[0].split(",").map(a=>a.trim()),r=e[1].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[],s={};return t.forEach((a,o)=>{const l=a.charAt(0).toLowerCase()+a.slice(1);let c=(r[o]||"").trim();c.startsWith('"')&&c.endsWith('"')&&(c=c.substring(1,c.length-1).replace(/""/g,'""')),l==="applicability"?s[l]=c:typeof sde[l]=="boolean"?s[l]=c.toLowerCase()==="true":s[l]=c}),s},Xg=({label:n,...e})=>i.jsxs("label",{className:"flex items-center gap-2 text-sm text-muted",children:[i.jsx("input",{type:"checkbox",className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent",...e}),n]}),ode=()=>{const{gmcPolicy:n,updateGmcPolicySettings:e}=yi(),[t,r]=E.useState(null),s=E.useRef(null),{register:a,handleSubmit:o,control:l,watch:c,reset:d,formState:{isDirty:h}}=tn({defaultValues:n});E.useEffect(()=>{d(n)},[n,d]);const p=c("requireAlternateInsurance"),x=c("applicability")==="Mandatory",y=C=>{e(C),r({message:"GMC policy settings saved.",type:"success"})},_=()=>{const C=ide(n),P=new Blob([C],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(P),O.setAttribute("download","gmc_policy_settings.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},w=()=>{const C=e1.join(","),P=new Blob([C],{type:"text/csv;charset=utf-8;"}),O=document.createElement("a");O.href=URL.createObjectURL(P),O.setAttribute("download","gmc_policy_template.csv"),document.body.appendChild(O),O.click(),document.body.removeChild(O)},j=C=>{const P=C.target.files?.[0];if(!P)return;const O=new FileReader;O.onload=M=>{try{const D=M.target?.result,I=ade(D);d(I),r({message:"Settings imported from CSV. Review and save.",type:"success"})}catch(D){r({message:D.message||"Failed to import CSV.",type:"error"})}finally{C.target&&(C.target.value="")}},O.readAsText(P)};return i.jsxs("form",{onSubmit:o(y),className:"bg-card p-6 rounded-xl shadow-card",children:[t&&i.jsx(pt,{message:t.message,type:t.type,onDismiss:()=>r(null)}),i.jsx("input",{type:"file",ref:s,className:"hidden",accept:".csv",onChange:j}),i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"GMC Policy Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:w,children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>s.current?.click(),children:[i.jsx(Hc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:_,children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export"]}),i.jsxs(ne,{type:"submit",disabled:!h,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save"]})]})]}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("div",{children:i.jsx(_e,{name:"applicability",control:l,render:({field:C})=>i.jsxs(Ze,{label:"Applicability",...C,children:[i.jsx("option",{children:"Mandatory"}),i.jsx("option",{children:"Optional - Opt-in Default"}),i.jsx("option",{children:"Optional - Opt-out Default"})]})})}),i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-In Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-In Disclaimer"}),i.jsx("textarea",{...a("optInDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Coverage Details"}),i.jsx("textarea",{...a("coverageDetails"),rows:2,className:"form-input mt-1"})]})]}),!x&&i.jsxs("div",{className:"space-y-4 pt-4 border-t",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:"Opt-Out Details"}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Opt-Out Disclaimer"}),i.jsx("textarea",{...a("optOutDisclaimer"),rows:3,className:"form-input mt-1"})]}),i.jsx(_e,{name:"requireAlternateInsurance",control:l,render:({field:C})=>i.jsx(rde,{id:"require-alt-ins",label:"Require proof of alternate insurance on opt-out",checked:C.value,onChange:C.onChange})}),p&&i.jsxs("div",{className:"p-4 bg-page rounded-lg space-y-3",children:[i.jsx("p",{className:"text-sm text-muted",children:"Collect the following from employees who opt out:"}),i.jsx(_e,{name:"collectProvider",control:l,render:({field:C})=>i.jsx(Xg,{label:"Provider Name",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectStartDate",control:l,render:({field:C})=>i.jsx(Xg,{label:"Policy Start Date",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectEndDate",control:l,render:({field:C})=>i.jsx(Xg,{label:"Policy End Date",checked:C.value,onChange:C.onChange})}),i.jsx(_e,{name:"collectExtentOfCover",control:l,render:({field:C})=>i.jsx(Xg,{label:"Extent of Cover (Sum Assured)",checked:C.value,onChange:C.onChange})})]})]})]})]})},Q6=[{key:"Phone",label:"Phone",icon:FJ},{key:"Computer",label:"Computer / Laptop",icon:SJ},{key:"Vehicle",label:"Vehicle",icon:lJ},{key:"Sim",label:"SIM Card",icon:hJ},{key:"IdCard",label:"Identity Card",icon:fJ},{key:"Petrocard",label:"Petrocard",icon:n3},{key:"Tools",label:"Tools",icon:jJ},{key:"Other",label:"Other Asset",icon:ym}],lde=({assetType:n,...e})=>{switch(n){case"Phone":return i.jsx(cde,{...e});case"Computer":return i.jsx(ude,{...e});case"Vehicle":return i.jsx(mde,{...e});case"Sim":return i.jsx(dde,{...e});case"IdCard":return i.jsx(fde,{...e});case"Petrocard":return i.jsx(hde,{...e});case"Tools":return i.jsx(pde,{...e});case"Other":return i.jsx(gde,{...e});default:return null}},cde=({index:n,control:e})=>i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 pt-4",children:[i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.imei`,control:e,render:({field:t})=>i.jsx(we,{label:"IMEI Number",...t})}),i.jsx(_e,{name:`assets.${n}.color`,control:e,render:({field:t})=>i.jsx(we,{label:"Colour",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),dde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(we,{label:"SIM Number",...t})})}),ude=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.computerType`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Laptop"}),i.jsx("option",{children:"Desktop"}),i.jsx("option",{children:"Tab"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Serial Number",...t})}),i.jsx(_e,{name:`assets.${n}.windowsKey`,control:e,render:({field:t})=>i.jsx(we,{label:"Windows Key",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.chargerStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Charger",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Charger"}),i.jsx("option",{children:"Without Charger"})]})}),i.jsx(_e,{name:`assets.${n}.bagStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Bag",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Bag"}),i.jsx("option",{children:"Without Bag"})]})}),i.jsx(_e,{name:`assets.${n}.mouseStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Mouse",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Mouse"}),i.jsx("option",{children:"Without Mouse"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.displayStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Display Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.bodyStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Body Condition",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Damages"}),i.jsx("option",{children:"Without Damages"})]})}),i.jsx(_e,{name:`assets.${n}.officeStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"MS Office",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Office"}),i.jsx("option",{children:"Without Office"})]})}),i.jsx(_e,{name:`assets.${n}.antivirusStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Antivirus",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"With Antivirus"}),i.jsx("option",{children:"Without Antivirus"})]})})]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture",file:t.value,onFileChange:t.onChange})})]}),fde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.issueDate`,control:e,render:({field:t})=>i.jsx(En,{label:"Date Issued",id:t.name,value:t.value,onChange:t.onChange})})}),hde=({index:n,control:e})=>i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 pt-4",children:i.jsx(_e,{name:`assets.${n}.number`,control:e,render:({field:t})=>i.jsx(we,{label:"Petrocard Number",...t})})}),mde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.vehicleType`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Vehicle Type",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Bicycle"}),i.jsx("option",{children:"Two Wheeler"}),i.jsx("option",{children:"Three Wheeler"}),i.jsx("option",{children:"Four Wheeler"})]})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.vehicleNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Vehicle Number",...t})}),i.jsx(_e,{name:`assets.${n}.chassisNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Chassis Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"DL Number of User",...t})}),i.jsx(_e,{name:`assets.${n}.kmsAtIssue`,control:e,render:({field:t})=>i.jsx(we,{label:"Kms at issue",type:"number",...t})}),i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.finesStatus`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"Violations / Fines",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Existing"}),i.jsx("option",{children:"Nil"})]})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.insuranceValidity`,control:e,render:({field:t})=>i.jsx(En,{label:"Insurance Validity",id:t.name,value:t.value,onChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.pollutionCertValidity`,control:e,render:({field:t})=>i.jsx(En,{label:"Pollution Cert. Validity",id:t.name,value:t.value,onChange:t.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`assets.${n}.dlFrontPic`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of DL (Front)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.dlBackPic`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of DL (Back)",file:t.value,onFileChange:t.onChange})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of Vehicle",file:t.value,onFileChange:t.onChange})})]})]}),pde=({index:n,control:e})=>{const{fields:t,append:r,remove:s}=Ns({control:e,name:`assets.${n}.toolList`});return i.jsxs("div",{className:"space-y-4 pt-4",children:[t.map((a,o)=>i.jsxs("div",{className:"flex items-end gap-2",children:[i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.name`,control:e,render:({field:l})=>i.jsx(we,{label:"Tool Name",...l})})}),i.jsx("div",{className:"flex-1",children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.description`,control:e,render:({field:l})=>i.jsx(we,{label:"Description",...l})})}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.toolList.${o}.quantity`,control:e,render:({field:l})=>i.jsx(we,{label:"Quantity",type:"number",...l})})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>s(o),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},a.id)),i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:()=>r({id:`tool_${Date.now()}`,name:"",description:"",quantity:1}),children:[i.jsx(Vt,{className:"mr-1 h-4 w-4"})," Add Tool"]}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:a})=>i.jsx(vt,{label:"Picture of Tools",file:a.value,onFileChange:a.onChange})})]})},gde=({index:n,control:e})=>i.jsxs("div",{className:"space-y-4 pt-4",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[i.jsx(_e,{name:`assets.${n}.name`,control:e,render:({field:t})=>i.jsx(we,{label:"Asset Name",placeholder:"e.g. Printer",...t})}),i.jsx(_e,{name:`assets.${n}.brand`,control:e,render:({field:t})=>i.jsx(we,{label:"Brand",...t})}),i.jsx(_e,{name:`assets.${n}.model`,control:e,render:({field:t})=>i.jsx(we,{label:"Model No.",...t})}),i.jsx(_e,{name:`assets.${n}.serialNumber`,control:e,render:({field:t})=>i.jsx(we,{label:"Serial Number",...t})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`assets.${n}.condition`,control:e,render:({field:t})=>i.jsxs(Ze,{label:"New / Used",...t,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"New"}),i.jsx("option",{children:"Used"})]})}),i.jsx(_e,{name:`assets.${n}.issueCondition`,control:e,render:({field:t})=>i.jsx(we,{label:"Condition at time of issue",...t})})]}),i.jsx("div",{children:i.jsx(_e,{name:`assets.${n}.accessories`,control:e,render:({field:t})=>i.jsxs(i.Fragment,{children:[i.jsx("label",{className:"block text-sm font-medium text-muted",children:"Accessories List"}),i.jsx("textarea",{...t,rows:3,className:"form-input mt-1"})]})})}),i.jsx(_e,{name:`assets.${n}.picture`,control:e,render:({field:t})=>i.jsx(vt,{label:"Picture of Asset",file:t.value,onFileChange:t.onChange})})]}),xde=({item:n,index:e,control:t,errors:r,remove:s})=>{const[a,o]=E.useState(()=>n.id.startsWith("new_")),l=Q6.find(p=>p.key===n.type),c=l?.icon||ym,h=(p=>"brand"in p&&p.brand?`${p.brand} ${p.type}`:"number"in p&&p.number?`${p.type} - ${p.number}`:"name"in p&&p.name?p.name:"vehicleNumber"in p&&p.vehicleNumber?p.vehicleNumber:l?.label||"Asset")(n);return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>o(!a),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(c,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsx("span",{className:"font-semibold text-primary-text",children:h})]}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>s(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>o(!a),children:i.jsx(ju,{className:`h-5 w-5 transform transition-transform ${a?"rotate-180":""}`})})]}),a&&i.jsx("div",{className:"p-4 border-t border-border",children:i.jsx(lde,{assetType:n.type,index:e,control:t,errors:r})})]})},yde=({site:n,initialAssets:e,onSave:t,onBack:r,setToast:s})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(!1),d=E.useRef(null),{control:h,handleSubmit:p,reset:x,formState:{errors:y}}=tn(),{fields:_,append:w,remove:j}=Ns({control:h,name:"assets"});E.useEffect(()=>{x({assets:e})},[e,x]),E.useEffect(()=>{const O=M=>{d.current&&!d.current.contains(M.target)&&c(!1)};return document.addEventListener("mousedown",O),()=>document.removeEventListener("mousedown",O)},[]);const C=O=>{const M={id:`new_${O}_${Date.now()}`,type:O};let D;switch(O){case"Phone":D={...M,type:"Phone",brand:"",condition:"",chargerStatus:"",displayStatus:"",bodyStatus:"",imei:"",color:""};break;case"Sim":D={...M,type:"Sim",number:""};break;case"Computer":D={...M,type:"Computer",computerType:"",brand:"",condition:"",bagStatus:"",mouseStatus:"",chargerStatus:"",displayStatus:"",bodyStatus:"",serialNumber:"",windowsKey:"",officeStatus:"",antivirusStatus:""};break;case"IdCard":D={...M,type:"IdCard",issueDate:""};break;case"Petrocard":D={...M,type:"Petrocard",number:""};break;case"Vehicle":D={...M,type:"Vehicle",vehicleType:"",brand:"",dlNumber:"",condition:"",kmsAtIssue:null,vehicleNumber:"",chassisNumber:"",insuranceValidity:"",pollutionCertValidity:"",finesStatus:""};break;case"Tools":D={...M,type:"Tools",toolList:[]};break;case"Other":D={...M,type:"Other",name:"",brand:"",model:"",serialNumber:"",condition:"",issueCondition:"",accessories:""};break;default:return}w(D),c(!1)},P=async O=>{o(!0);try{await t(n.id,O.assets)}catch{}finally{o(!1)}};return i.jsxs("form",{onSubmit:p(P),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ne,{type:"button",onClick:r,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Assets for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs("div",{className:"relative",ref:d,children:[i.jsxs(ne,{type:"button",onClick:()=>c(!l),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Asset"]}),l&&i.jsx("div",{className:"absolute right-0 mt-2 w-56 bg-card border rounded-lg shadow-lg z-10",children:Q6.map(O=>i.jsxs("button",{type:"button",className:"w-full text-left px-4 py-2 text-sm hover:bg-page flex items-center gap-3",onClick:()=>C(O.key),children:[i.jsx(O.icon,{className:"h-4 w-4 text-muted"}),i.jsx("span",{children:O.label})]},O.key))})]}),i.jsxs(ne,{type:"submit",isLoading:a,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:_.length>0?_.map((O,M)=>i.jsx(xde,{item:O,index:M,control:h,errors:y,remove:j},O.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No assets found for this site. Click "Add Asset" to begin.'})})]})},vde=({sites:n,allAssets:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No assets assigned.";const l=o.reduce((c,d)=>(c[d.type]=(c[d.type]||0)+1,c),{});return Object.entries(l).map(([c,d])=>`${d} ${c}(s)`).join(", ")};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Asset Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(we,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Asset Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Cl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},bde=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState(null),[s,a]=E.useState([]),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,y]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteAssets()]).then(([C,P])=>{a(C.sort((O,M)=>O.shortName.localeCompare(M.shortName))),l(P)}).catch(()=>y({message:"Failed to load asset configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(C,P)=>{try{await ue.updateSiteAssets(C,P),l(O=>({...O,[C]:P})),y({message:"Assets saved successfully.",type:"success"})}catch(O){throw y({message:"Failed to save assets.",type:"error"}),O}},w=C=>{r(C),e("detail")},j=E.useMemo(()=>h?s.filter(C=>C.shortName.toLowerCase().includes(h.toLowerCase())):s,[s,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)}),n==="detail"&&t?i.jsx(yde,{site:s.find(C=>C.id===t),initialAssets:o[t]||[],onSave:_,onBack:()=>e("list"),setToast:y}):i.jsx(vde,{sites:j,allAssets:o,searchTerm:h,setSearchTerm:p,onViewDetails:w})]})},wde=({control:n,index:e,remove:t,masterTools:r})=>{const[s,a]=E.useState(!0),o=du({control:n,name:`tools.${e}.department`}),l=du({control:n,name:`tools.${e}.name`}),c=o?r[o]||[]:[],d=l||"New Tool",h=o||"Select a department";return i.jsxs("div",{className:"border border-border rounded-xl bg-card",children:[i.jsxs("div",{className:"flex items-center p-3",children:[i.jsxs("button",{type:"button",onClick:()=>a(!s),className:"flex items-center gap-3 flex-grow text-left",children:[i.jsx(y3,{className:"h-5 w-5 text-muted flex-shrink-0"}),i.jsxs("div",{children:[i.jsx("span",{className:"font-semibold text-primary-text",children:d}),i.jsx("p",{className:"text-sm text-muted",children:h})]})]}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>t(e),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>a(!s),children:i.jsx(ju,{className:`h-5 w-5 transform transition-transform ${s?"rotate-180":""}`})})]}),s&&i.jsxs("div",{className:"p-4 border-t border-border space-y-4 animate-fade-in-down",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.department`,control:n,render:({field:p})=>i.jsxs(Ze,{label:"Department",...p,children:[i.jsx("option",{value:"",children:"Select Department"}),Object.keys(r).map(x=>i.jsx("option",{value:x,children:x},x))]})}),i.jsx(_e,{name:`tools.${e}.name`,control:n,render:({field:p})=>i.jsxs(Ze,{label:"Tool Name",...p,disabled:!o,children:[i.jsx("option",{value:"",children:"Select Tool"}),c.map(x=>i.jsx("option",{value:x.name,children:x.name},x.id))]})}),i.jsx(_e,{name:`tools.${e}.quantity`,control:n,render:({field:p})=>i.jsx(we,{label:"Quantity",type:"number",...p})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`tools.${e}.picture`,control:n,render:({field:p})=>i.jsx(vt,{label:"Picture of Tool",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.inwardDcCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Inward DC Copy",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.deliveryCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Delivery Copy",file:p.value,onFileChange:p.onChange})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 items-end",children:[i.jsx(_e,{name:`tools.${e}.invoiceCopy`,control:n,render:({field:p})=>i.jsx(vt,{label:"Invoice",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.signedReceipt`,control:n,render:({field:p})=>i.jsx(vt,{label:"Signed Receipt",file:p.value,onFileChange:p.onChange})}),i.jsx(_e,{name:`tools.${e}.receiverName`,control:n,render:({field:p})=>i.jsx(we,{label:"Receiver's Name",...p})})]})]})]})},_de=({site:n,initialTools:e,masterTools:t,onSave:r,onBack:s})=>{const[a,o]=E.useState(!1),{control:l,handleSubmit:c,reset:d}=tn(),{fields:h,append:p,remove:x}=Ns({control:l,name:"tools"});E.useEffect(()=>{d({tools:e})},[e,d]);const y=()=>{p({id:`new_tool_${Date.now()}`,department:"",name:"",quantity:1})},_=async w=>{o(!0);try{await r(n.id,w.tools)}finally{o(!1)}};return i.jsxs("form",{onSubmit:c(_),children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsxs("div",{children:[i.jsxs(ne,{type:"button",onClick:s,variant:"outline",size:"sm",className:"mb-2",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back to List"]}),i.jsxs("h3",{className:"text-xl font-semibold text-primary-text",children:["Managing Tools for: ",n.shortName]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ne,{type:"button",onClick:y,children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Tool"]}),i.jsxs(ne,{type:"submit",isLoading:a,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Changes"]})]})]}),i.jsx("div",{className:"space-y-4",children:h.length>0?h.map((w,j)=>i.jsx(wde,{control:l,index:j,remove:x,masterTools:t},w.id)):i.jsx("div",{className:"text-center p-8 text-muted bg-page rounded-lg",children:'No tools found for this site. Click "Add Tool" to begin.'})})]})},jde=({sites:n,allIssuedTools:e,searchTerm:t,setSearchTerm:r,onViewDetails:s})=>{const a=(o=[])=>{if(!o||o.length===0)return"No tools issued.";const l=o.reduce((d,h)=>d+(h.quantity||0),0),c=new Set(o.map(d=>d.department)).size;return`${l} tools issued across ${c} department${c>1?"s":""}.`};return i.jsxs("div",{children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-6",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Site Tools Overview"}),i.jsxs("div",{className:"relative flex-1 md:max-w-xs",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx(we,{id:"site-search",placeholder:"Search sites...",className:"pl-10",value:t,onChange:o=>r(o.target.value)})]})]}),i.jsxs("div",{className:"overflow-x-auto border border-border rounded-lg",children:[i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Tools Summary"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:n.map(o=>i.jsxs("tr",{children:[i.jsx("td",{className:"px-4 py-3 font-medium",children:o.shortName}),i.jsx("td",{className:"px-4 py-3 text-muted",children:a(e[o.id])}),i.jsx("td",{className:"px-4 py-3",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>s(o.id),title:"View Details",children:i.jsx(Cl,{className:"h-4 w-4"})})})]},o.id))})]}),n.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No sites match your search."})]})]})},Nde=()=>{const[n,e]=E.useState(null),[t,r]=E.useState([]),[s,a]=E.useState({}),[o,l]=E.useState({}),[c,d]=E.useState(!0),[h,p]=E.useState(""),[x,y]=E.useState(null);E.useEffect(()=>{d(!0),Promise.all([ue.getOrganizations(),ue.getAllSiteIssuedTools(),ue.getToolsList()]).then(([j,C,P])=>{r(j.sort((O,M)=>O.shortName.localeCompare(M.shortName))),a(C),l(P)}).catch(()=>y({message:"Failed to load initial configuration.",type:"error"})).finally(()=>d(!1))},[]);const _=async(j,C)=>{try{await ue.updateSiteIssuedTools(j,C),a(P=>({...P,[j]:C})),y({message:"Tools list saved successfully.",type:"success"})}catch(P){throw y({message:"Failed to save tools list.",type:"error"}),P}},w=E.useMemo(()=>h?t.filter(j=>j.shortName.toLowerCase().includes(h.toLowerCase())):t,[t,h]);return c?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{children:[x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)}),n?i.jsx(_de,{site:t.find(j=>j.id===n),initialTools:s[n]||[],masterTools:o,onSave:_,onBack:()=>e(null)}):i.jsx(jde,{sites:w,allIssuedTools:s,searchTerm:h,setSearchTerm:p,onViewDetails:e})]})},Sde=()=>i.jsx(ud,{title:"Attendance Format"}),Cde=()=>i.jsx(ud,{title:"Attendance Overview"}),Tde=()=>i.jsx(ud,{title:"Daily Attendance Summary"}),kde=()=>i.jsx(ud,{title:"Notification & Mail Configuration"}),Pde=()=>i.jsx(ud,{title:"Onboarding Rejection Reasons"}),Mde=()=>i.jsx(ud,{title:"Salary Breakup"}),Ede=()=>i.jsx(ud,{title:"Salary Line Item"}),BL=(n,e)=>{const t=e.join(","),r=n.map(s=>e.map(a=>{const o=s[a]===null||s[a]===void 0?"":String(s[a]);return o.includes(",")||o.includes('"')||o.includes(`
`)?`"${o.replace(/"/g,'""')}"`:o}).join(","));return[t,...r].join(`
`)},VL=n=>{const e=n.trim().replace(/\r/g,"").split(`
`);if(e.length<2)return[];const t=e[0].split(",").map(s=>s.trim().replace(/"/g,"")),r=[];for(let s=1;s<e.length;s++){const a={},o=e[s].match(new RegExp('(?<=,|^)(?:"(?:[^"]|"")*"|[^,]*)',"g"))||[];t.forEach((l,c)=>{let d=(o[c]||"").trim();d.startsWith('"')&&d.endsWith('"')&&(d=d.substring(1,d.length-1).replace(/""/g,'"')),a[l]=d}),r.push(a)}return r},FN=["GroupId","GroupName","CompanyId","CompanyName","EntityId","EntityName","organizationId","Location","RegisteredAddress","RegistrationType","RegistrationNumber","GSTNumber","PANNumber","Email","EShramNumber","ShopAndEstablishmentCode","EPFOCode","ESICCode","PSARALicenseNumber","PSARAValidTill"],qN=["organizationId","organizationName","location","entityId","billingName","registeredAddress","gstNumber","panNumber","email1","email2","email3","eShramNumber","shopAndEstablishmentCode","keyAccountManager","siteAreaSqFt","projectType","apartmentCount","agreementDetails","siteOperations"],WL=(n,e)=>{const t=new Blob([n],{type:"text/csv;charset=utf-8;"}),r=document.createElement("a");r.href=URL.createObjectURL(t),r.setAttribute("download",e),document.body.appendChild(r),r.click(),document.body.removeChild(r)},Dde=({isOpen:n,onClose:e,onSave:t,title:r,label:s,initialName:a=""})=>{const[o,l]=E.useState(a),[c,d]=E.useState("");E.useEffect(()=>{n&&l(a)},[n,a]);const h=()=>{if(!o.trim()){d("Name cannot be empty.");return}t(o),e()};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4",onClick:p=>p.stopPropagation(),children:[i.jsx("h3",{className:"text-lg font-bold",children:r}),i.jsx("div",{className:"mt-4",children:i.jsx(we,{label:s,id:"name-input",value:o,onChange:p=>{l(p.target.value),d("")},error:c})}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{onClick:e,variant:"secondary",children:"Cancel"}),i.jsx(ne,{onClick:h,children:"Save"})]})]})}):null},zN=[{key:"client_structure",label:"Client Structure",icon:t3},{key:"site_configuration",label:"Site Configuration",icon:Om},{key:"costing_resource",label:"Costing & Resource",icon:rJ},{key:"backoffice_heads",label:"Back Office & ID Series",icon:Ji},{key:"staff_designation",label:"Staff Designation",icon:XK},{key:"gmc_policy",label:"GMC Policy",icon:T1},{key:"asset",label:"Asset Management",icon:KK},{key:"tools_list",label:"Tools List",icon:y3},{key:"attendance_format",label:"Attendance Format",icon:oJ},{key:"attendance_overview",label:"Attendance Overview",icon:tJ},{key:"notification_template",label:"Notification & Mail",icon:Hf},{key:"onboard_reject_reason",label:"Onboarding Rejection Reasons",icon:Ox},{key:"salary_template",label:"Salary Breakup",icon:Tl},{key:"salary_line_item",label:"Salary Line Item",icon:Tl}],Ode=()=>{const n=St(),{colorScheme:e}=an(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,y]=E.useState({}),[_,w]=E.useState("client_structure"),j=E.useRef(null),[C,P]=E.useState(""),[O,M]=E.useState(null),[D,I]=E.useState(!1),F=Rt("(max-width: 767px)"),[q,B]=E.useState({isOpen:!1,initialData:null,companyName:""}),[U,W]=E.useState({isOpen:!1,mode:"add",type:"group",title:"",label:""}),[G,Z]=E.useState({isOpen:!1,type:"group",id:"",name:""}),[Y,ae]=E.useState({isOpen:!1,org:null}),ee=E.useMemo(()=>t.flatMap(Te=>Te.companies.flatMap(je=>je.entities.map(ke=>({...ke,companyName:je.name})))),[t]);E.useEffect(()=>{(async()=>{d(!0);try{const[je,ke,Ue]=await Promise.all([ue.getOrganizationStructure(),ue.getOrganizations(),ue.getSiteConfigurations()]);r(je),a(ke),l(Ue)}catch{p({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[]);const me=E.useMemo(()=>{if(!C.trim())return t;const Te=C.toLowerCase();return t.map(je=>{if(je.name.toLowerCase().includes(Te))return je;const ke=je.companies.map(Ue=>{if(Ue.name.toLowerCase().includes(Te))return Ue;const Ye=Ue.entities.filter(ve=>ve.name.toLowerCase().includes(Te));return Ye.length>0?{...Ue,entities:Ye}:null}).filter(Boolean);return ke.length>0?{...je,companies:ke}:null}).filter(Boolean)},[t,C]),$=E.useMemo(()=>{if(!C.trim())return s;const Te=C.toLowerCase();return s.filter(je=>je.shortName.toLowerCase().includes(Te))},[s,C]),K=Te=>y(je=>({...je,[Te]:!je[Te]})),re=()=>{p({message:"All changes saved successfully (mocked).",type:"success"})},H=Te=>B({isOpen:!0,initialData:null,companyName:Te}),se=(Te,je)=>B({isOpen:!0,initialData:Te,companyName:je}),ie=Te=>{p({message:Te.id.startsWith("new_")?"Client added.":"Client updated.",type:"success"}),B({isOpen:!1,initialData:null,companyName:""})},ce=(Te,je,ke)=>Z({isOpen:!0,type:Te,id:je,name:ke}),oe=()=>{const{type:Te,id:je,name:ke}=G;Te==="group"?r(Ue=>Ue.filter(Ye=>Ye.id!==je)):Te==="company"?r(Ue=>Ue.map(Ye=>({...Ye,companies:Ye.companies.filter(ve=>ve.id!==je)}))):Te==="client"&&r(Ue=>Ue.map(Ye=>({...Ye,companies:Ye.companies.map(ve=>({...ve,entities:ve.entities.filter(Oe=>Oe.id!==je)}))}))),p({message:`${Te.charAt(0).toUpperCase()+Te.slice(1)} '${ke}' deleted.`,type:"success"}),Z({isOpen:!1,type:"group",id:"",name:""})},de=Te=>{const{mode:je,type:ke,id:Ue,groupId:Ye}=U;if(je==="add"){if(ke==="group"){const ve={id:`group_${Date.now()}`,name:Te,locations:[],companies:[]};r(Oe=>[...Oe,ve]),p({message:`Group '${Te}' added.`,type:"success"})}else if(ke==="company"&&Ye){const ve={id:`comp_${Date.now()}`,name:Te,entities:[]};r(Oe=>Oe.map(Ve=>Ve.id===Ye?{...Ve,companies:[...Ve.companies,ve]}:Ve)),p({message:`Company '${Te}' added.`,type:"success"})}}else ke==="group"&&Ue?(r(ve=>ve.map(Oe=>Oe.id===Ue?{...Oe,name:Te}:Oe)),p({message:"Group updated.",type:"success"})):ke==="company"&&Ue&&Ye&&(r(ve=>ve.map(Oe=>Oe.id===Ye?{...Oe,companies:Oe.companies.map(Ve=>Ve.id===Ue?{...Ve,name:Te}:Ve)}:Oe)),p({message:"Company updated.",type:"success"}));W({isOpen:!1,mode:"add",type:"group",title:"",label:""})},te=()=>{let Te,je,ke;if(_==="client_structure"){ke=FN;const Ue=t.flatMap(Ye=>Ye.companies.flatMap(ve=>ve.entities.map(Oe=>({GroupId:Ye.id,GroupName:Ye.name,CompanyId:ve.id,CompanyName:ve.name,EntityId:Oe.id,EntityName:Oe.name,organizationId:Oe.organizationId||"",Location:Oe.location||"",RegisteredAddress:Oe.registeredAddress||"",RegistrationType:Oe.registrationType||"",RegistrationNumber:Oe.registrationNumber||"",GSTNumber:Oe.gstNumber||"",PANNumber:Oe.panNumber||"",Email:Oe.email||"",EShramNumber:Oe.eShramNumber||"",ShopAndEstablishmentCode:Oe.shopAndEstablishmentCode||"",EPFOCode:Oe.epfoCode||"",ESICCode:Oe.esicCode||"",PSARALicenseNumber:Oe.psaraLicenseNumber||"",PSARAValidTill:Oe.psaraValidTill||""}))));Te=BL(Ue,ke),je="client_structure_export.csv"}else if(_==="site_configuration"){ke=qN;const Ue=s.map(Ye=>{const ve=o.find(Oe=>Oe.organizationId===Ye.id);return{organizationId:Ye.id,organizationName:Ye.shortName,...ve||{},agreementDetails:JSON.stringify(ve?.agreementDetails||{}),siteOperations:JSON.stringify(ve?.siteOperations||{})}});Te=BL(Ue,ke),je="site_configuration_export.csv"}else{p({message:"Export not implemented for this view.",type:"error"});return}WL(Te,je),p({message:"Data exported successfully.",type:"success"})},ye=()=>{let Te,je;if(_==="client_structure")Te=FN,je="client_structure_template.csv";else if(_==="site_configuration")Te=qN,je="site_configuration_template.csv";else{p({message:"Template not available for this view.",type:"error"});return}WL(Te.join(","),je)},Ce=Te=>{const je=Te.target.files?.[0];if(!je)return;const ke=new FileReader;ke.onload=Ue=>{try{const Ye=Ue.target?.result;if(!Ye)throw new Error("File is empty.");const ve=Ye.trim().replace(/\r/g,"").split(`
`);if(ve.length<1)throw new Error("CSV file is empty.");const Oe=ve[0].split(",").map(Ve=>Ve.trim().replace(/"/g,""));if(_==="client_structure"){if(Oe.join(",")!==FN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ve=VL(Ye);if(Ve.length===0)throw new Error("No data rows found.");const qe=new Map;for(const le of Ve){qe.has(le.GroupId)||qe.set(le.GroupId,{group:{id:le.GroupId,name:le.GroupName,locations:[],companies:[]},companiesMap:new Map});const he=qe.get(le.GroupId);he.companiesMap.has(le.CompanyId)||he.companiesMap.set(le.CompanyId,{id:le.CompanyId,name:le.CompanyName,entities:[]});const Le=he.companiesMap.get(le.CompanyId),Ie={id:le.EntityId,name:le.EntityName,organizationId:le.organizationId,location:le.Location,registeredAddress:le.RegisteredAddress,registrationType:le.RegistrationType||"",registrationNumber:le.RegistrationNumber,gstNumber:le.GSTNumber,panNumber:le.PANNumber,email:le.Email,eShramNumber:le.EShramNumber,shopAndEstablishmentCode:le.ShopAndEstablishmentCode,epfoCode:le.EPFOCode,esicCode:le.ESICCode,psaraLicenseNumber:le.PSARALicenseNumber,psaraValidTill:le.PSARAValidTill};Le.entities.push(Ie)}const X=Array.from(qe.values()).map(le=>(le.group.companies=Array.from(le.companiesMap.values()),le.group));r(X),p({message:`Successfully imported ${Ve.length} client records.`,type:"success"})}else if(_==="site_configuration"){if(Oe.join(",")!==qN.join(","))throw new Error("Header mismatch. Please use the downloaded template.");const Ve=VL(Ye);if(Ve.length===0)throw new Error("No data rows found.");const qe=Ve.map(X=>{const le={};for(const he of Object.keys(X))if(he==="agreementDetails"||he==="siteOperations")try{le[he]=JSON.parse(X[he])}catch{console.warn(`Could not parse JSON for ${he} in row for site ${X.organizationId}`),le[he]={}}else le[he]=X[he];return le});l(X=>{const le=[...X];return qe.forEach(he=>{const Le=le.findIndex(Ie=>Ie.organizationId===he.organizationId);Le>-1?le[Le]=he:le.push(he)}),le}),p({message:`Successfully imported ${qe.length} site configurations.`,type:"success"})}else p({message:"Import not implemented for this view.",type:"error"})}catch(Ye){p({message:Ye.message||"Failed to import CSV.",type:"error"})}finally{Te.target&&(Te.target.value="")}},ke.readAsText(je)},Re=()=>{switch(_){case"client_structure":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsxs(ne,{onClick:()=>n("/hr/entity-management/add-group"),style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Vt,{className:"mr-2 h-4"}),"Add Group"]}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:ye,className:"hover:bg-gray-100",children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>j.current?.click(),className:"hover:bg-gray-100",children:[i.jsx(Hc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:te,className:"hover:bg-gray-100",children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"space-y-2",children:me.map(je=>i.jsxs("div",{className:"border-b border-border",children:[i.jsxs("div",{className:"p-3 flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>K(je.id),children:i.jsx(If,{className:`h-5 w-5 transition-transform ${x[je.id]?"rotate-90":""}`})}),i.jsx(Zi,{className:"h-5 w-5 text-muted"}),i.jsx("span",{className:"font-semibold",children:je.name})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{size:"sm",className:"!p-1.5",onClick:()=>W({isOpen:!0,mode:"add",type:"company",groupId:je.id,title:`Add Company to ${je.name}`,label:"Company Name"}),title:"Add Company",children:i.jsx(Vt,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>W({isOpen:!0,mode:"edit",type:"group",id:je.id,initialName:je.name,title:"Edit Group Name",label:"Group Name"}),title:"Edit group name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(dr,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ce("group",je.id,je.name),title:"Delete group",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),x[je.id]&&i.jsx("div",{className:"pl-6 pr-3 pb-3 space-y-2",children:je.companies.map(ke=>i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsxs("div",{className:"p-2 flex items-center justify-between bg-card",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>K(ke.id),children:i.jsx(If,{className:`h-5 w-5 transition-transform ${x[ke.id]?"rotate-90":""}`})}),i.jsxs("span",{children:[ke.name," (",ke.entities.length," clients)"]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",title:`View ${ke.entities.length} clients`,onClick:()=>M({companyName:ke.name,clients:ke.entities}),children:i.jsx(Cl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>H(ke.name),title:"Add client",children:i.jsx(Vt,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",onClick:()=>W({isOpen:!0,mode:"edit",type:"company",id:ke.id,groupId:je.id,initialName:ke.name,title:"Edit Company Name",label:"Company Name"}),title:"Edit company name",className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(dr,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ce("company",ke.id,ke.name),title:"Delete company",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),x[ke.id]&&i.jsx("div",{className:"p-2",children:ke.entities.map(Ue=>i.jsxs("div",{className:"p-2 flex items-center justify-between hover:bg-page rounded",children:[i.jsx("span",{children:Ue.name}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",onClick:()=>se(Ue,ke.name),className:"p-2 hover:bg-blue-500/10 rounded-full transition-colors",children:i.jsx(dr,{className:"h-5 w-5"})}),i.jsx(ne,{variant:"icon",onClick:()=>ce("client",Ue.id,Ue.name),className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},Ue.id))})]},ke.id))})]},je.id))})]});case"site_configuration":return i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4 mb-4",children:[i.jsx("h4",{className:"text-lg font-semibold text-primary-text",children:"Sites Configuration"}),i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{type:"button",variant:"outline",onClick:ye,children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Template"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>j.current?.click(),children:[i.jsx(Hc,{className:"mr-2 h-4 w-4"})," Import"]}),i.jsxs(ne,{type:"button",variant:"outline",onClick:te,children:[i.jsx(bi,{className:"mr-2 h-4 w-4"})," Export"]})]})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Configuration Status"}),i.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:$.map(je=>{const ke=o.find(Ye=>Ye.organizationId===je.id),Ue=!!ke&&(!!ke.billingName||!!ke.keyAccountManager);return i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx(Zi,{className:"h-5 w-5 text-muted"}),i.jsx("span",{children:je.shortName})]})}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:Ue?i.jsxs("span",{className:"flex items-center text-green-600",children:[i.jsx(Ki,{className:"h-4 w-4 mr-1"})," Complete"]}):i.jsxs("span",{className:"flex items-center text-yellow-600",children:[i.jsx(XF,{className:"h-4 w-4 mr-1"})," Incomplete"]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs(ne,{size:"sm",variant:"outline",onClick:()=>ae({isOpen:!0,org:je}),children:[i.jsx(Cl,{className:"mr-2 h-4 w-4"})," View / Edit"]})})]},je.id)})})]})})]});case"costing_resource":return i.jsx(Kce,{});case"backoffice_heads":return i.jsx(Xce,{});case"staff_designation":return i.jsx(nde,{});case"gmc_policy":return i.jsx(ode,{});case"asset":return i.jsx(bde,{});case"tools_list":return i.jsx(Nde,{});case"attendance_format":return i.jsx(Sde,{});case"attendance_overview":return i.jsx(Cde,{});case"daily_attendance":return i.jsx(Tde,{});case"notification_template":return i.jsx(kde,{});case"onboard_reject_reason":return i.jsx(Pde,{});case"salary_template":return i.jsx(Mde,{});case"salary_line_item":return i.jsx(Ede,{});default:const Te=zN.find(je=>je.key===_);return i.jsx(ud,{title:Te?.label||"Configuration"})}};return i.jsxs("div",{className:"p-4 space-y-6",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Yce,{isOpen:D,onClose:()=>I(!1)}),q.isOpen&&i.jsx(Hce,{...q,onClose:()=>B(Te=>({...Te,isOpen:!1})),onSave:ie}),i.jsx(Dde,{isOpen:U.isOpen,onClose:()=>W({isOpen:!1,mode:"add",type:"group",title:"",label:""}),onSave:de,title:U.title,label:U.label,initialName:U.initialName}),i.jsxs(Kr,{isOpen:G.isOpen,onClose:()=>Z(Te=>({...Te,isOpen:!1})),onConfirm:oe,title:"Confirm Deletion",children:["Are you sure you want to delete the ",G.type,' "',G.name,'"? This action cannot be undone.']}),Y.isOpen&&Y.org&&i.jsx(r6,{isOpen:Y.isOpen,onClose:()=>ae({isOpen:!1,org:null}),onSave:()=>{},organization:Y.org,allClients:ee,initialData:o.find(Te=>Te.organizationId===Y.org?.id)}),O&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60",onClick:()=>M(null),children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 animate-fade-in-scale",onClick:Te=>Te.stopPropagation(),children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text mb-4",children:["Clients in ",O.companyName]}),O.clients.length>0?i.jsx("ul",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:O.clients.map(Te=>i.jsx("li",{className:"text-sm p-2 bg-page rounded-md",children:Te.name},Te.id))}):i.jsx("p",{className:"text-muted text-center py-4",children:"No clients found for this company."}),i.jsx("div",{className:"mt-6 text-right",children:i.jsx(ne,{onClick:()=>M(null),variant:"secondary",children:"Close"})})]})}),i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4 mb-6",children:[i.jsx("h2",{className:"text-2xl font-semibold text-primary-text",children:"Client Management"}),!F&&i.jsxs("div",{className:"flex items-center gap-2 flex-wrap",children:[i.jsxs(ne,{variant:"outline",onClick:()=>I(!0),className:"hover:bg-gray-100",children:[i.jsx(FM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:j,className:"hidden",accept:".csv",onChange:Ce}),i.jsxs(ne,{onClick:re,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save All Changes"]})]})]}),F&&i.jsxs("div",{className:"flex flex-col gap-3 mb-4",children:[i.jsxs(ne,{onClick:re,style:{backgroundColor:"#006B3F",color:"#FFFFFF",borderColor:"#005632"},className:"w-full justify-center border hover:opacity-90 text-white shadow-lg hover:shadow-xl transition-all duration-300",children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save All Changes"]}),i.jsxs(ne,{variant:"outline",onClick:()=>I(!0),className:"w-full justify-center hover:bg-gray-100",children:[i.jsx(FM,{className:"mr-2 h-4 w-4"})," Help"]}),i.jsx("input",{type:"file",ref:j,className:"hidden",accept:".csv",onChange:Ce})]}),i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-muted"}),i.jsx("input",{type:"text",placeholder:"Search across all clients and sites...",value:C,onChange:Te=>P(Te.target.value),className:"form-input pl-10 w-full"})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[i.jsx("nav",{className:"md:col-span-1",children:F?i.jsx(Ze,{label:"Configuration Section",id:"hr-config-select",value:_,onChange:Te=>w(Te.target.value),children:zN.map(Te=>i.jsx("option",{value:Te.key,children:Te.label},Te.key))}):i.jsx("div",{className:"space-y-1",children:zN.map(Te=>i.jsxs("button",{onClick:()=>w(Te.key),className:`w-full flex items-center gap-3 px-3 py-2 text-sm font-medium rounded-lg text-left transition-colors ${_===Te.key?"text-white":"text-slate-700 hover:bg-gray-100 hover:text-slate-900"}`,style:_===Te.key?{backgroundColor:"#006B3F"}:{},children:[i.jsx(Te.icon,{className:`h-5 w-5 ${_===Te.key?"text-white":"text-slate-500"}`}),i.jsx("span",{children:Te.label})]},Te.key))})}),i.jsx("main",{className:"md:col-span-3",children:c?i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent mx-auto mt-16"}):Re()})]})]})},Ide=({isOpen:n,onSave:e,onClose:t,initialData:r})=>{const[s,a]=E.useState(r?.name||""),[o,l]=E.useState(r?.description||""),[c,d]=E.useState(!1);E.useEffect(()=>{n&&(a(r?.name||""),l(r?.description||""),d(!1))},[n,r]);const h=async p=>{if(p&&p.preventDefault(),!!s.trim()){d(!0);try{await e({name:s.trim(),description:o.trim()})}catch(x){console.error("Error saving policy:",x),d(!1)}}};return i.jsx(Kr,{isOpen:n,onClose:t,onConfirm:h,title:`${r?"Edit":"Add"} Policy`,confirmButtonText:"Save Policy",isLoading:c,children:i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"policy-name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"policy-name",value:s,onChange:p=>a(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"policy-description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"policy-description",value:o,onChange:p=>l(p.target.value),placeholder:"Description",className:"form-input",rows:3,disabled:c})]})]})})},Ade=()=>{const n=St(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState(!1),[l,c]=E.useState(null),[d,h]=E.useState(null),p=E.useRef(!0);E.useEffect(()=>(p.current=!0,()=>{p.current=!1}),[]);const x=E.useCallback(async()=>{s(!0);try{const j=await ue.getPolicies();p.current&&t(j)}catch(j){console.error("Error fetching policies:",j),p.current&&h({message:"Failed to fetch policies.",type:"error"})}finally{p.current&&s(!1)}},[]);E.useEffect(()=>{x()},[x]);const y=async j=>{try{l?h({message:"Policy updated.",type:"success"}):(await ue.createPolicy(j),p.current&&h({message:"Policy created successfully!",type:"success"})),p.current&&(o(!1),c(null),x())}catch(C){throw console.error("Error saving policy:",C),p.current&&h({message:"Failed to save policy. Please try again.",type:"error"}),C}},_=()=>{n("/hr/policies/add")},w=j=>{c(j),o(!0)};return i.jsxs("div",{children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Ide,{isOpen:a,onSave:y,onClose:()=>{o(!1),c(null)},initialData:l}),i.jsx(na,{title:"Policy Management",children:i.jsxs(ne,{onClick:_,children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Policy"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Name"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Description"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:r?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):e.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:3,"data-label":"Status",className:"text-center py-10 text-muted",children:'No policies found. Click "Add Policy" to create one.'})}):e.map(j=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Policy Name",className:"px-6 py-4 font-medium",children:j.name}),i.jsx("td",{"data-label":"Description",className:"px-6 py-4 text-sm text-muted",children:j.description||""}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>w(j),children:i.jsx(dr,{className:"h-4 w-4"})})})})]},j.id))})]})})]})},Rde=Pt({type:xe().oneOf(["GMC","GPA","WCA","Other"]).required("Type is required"),provider:xe().required("Provider is required"),policyNumber:xe().required("Policy number is required"),validTill:xe().required("Valid till date is required")}).defined(),Lde=({onSave:n,onClose:e,initialData:t})=>{const{register:r,handleSubmit:s,control:a,formState:{errors:o},reset:l}=tn({resolver:In(Rde)});E.useEffect(()=>{l(t||{type:"GMC",provider:"",policyNumber:"",validTill:""})},[t,l]);const c=d=>{n(d)};return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4",onClick:d=>d.stopPropagation(),children:i.jsxs("form",{onSubmit:s(c),children:[i.jsxs("h3",{className:"text-lg font-bold mb-4",children:[t?"Edit":"Add"," Insurance"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs(Ze,{label:"Insurance Type",id:"type",registration:r("type"),error:o.type?.message,children:[i.jsx("option",{children:"GMC"}),i.jsx("option",{children:"GPA"}),i.jsx("option",{children:"WCA"}),i.jsx("option",{children:"Other"})]}),i.jsx(we,{label:"Provider",id:"provider",registration:r("provider"),error:o.provider?.message}),i.jsx(we,{label:"Policy Number",id:"policyNumber",registration:r("policyNumber"),error:o.policyNumber?.message}),i.jsx(_e,{name:"validTill",control:a,render:({field:d})=>i.jsx(En,{label:"Valid Till",id:"validTill",value:d.value,onChange:d.onChange,error:o.validTill?.message})})]}),i.jsxs("div",{className:"flex justify-end gap-2 mt-6",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsx(ne,{type:"submit",children:"Save Insurance"})]})]})})})},Fde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState(null),h=E.useCallback(async()=>{r(!0);try{const x=await ue.getInsurances();e(x)}catch{d({message:"Failed to fetch insurance policies.",type:"error"})}finally{r(!1)}},[]);E.useEffect(()=>{h()},[h]);const p=async x=>{try{o||(await ue.createInsurance(x),d({message:"Insurance created.",type:"success"})),a(!1),h()}catch{d({message:"Failed to save insurance.",type:"error"})}};return i.jsxs("div",{children:[c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)}),s&&i.jsx(Lde,{onSave:p,onClose:()=>a(!1),initialData:o}),i.jsx(na,{title:"Insurance Management",children:i.jsxs(ne,{onClick:()=>{l(null),a(!0)},children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Insurance"]})}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Type"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Provider"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Policy Number"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Valid Till"}),i.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Actions"})]})}),i.jsx("tbody",{className:"md:bg-card divide-y divide-border md:divide-y-0",children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:5,"data-label":"Status",className:"text-center py-10 text-muted",children:"Loading..."})}):n.map(x=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Type",className:"px-6 py-4 font-medium",children:x.type}),i.jsx("td",{"data-label":"Provider",className:"px-6 py-4 text-sm text-muted",children:x.provider}),i.jsx("td",{"data-label":"Policy Number",className:"px-6 py-4 text-sm text-muted",children:x.policyNumber}),i.jsx("td",{"data-label":"Valid Till",className:"px-6 py-4 text-sm text-muted",children:x.validTill}),i.jsx("td",{"data-label":"Actions",className:"px-6 py-4",children:i.jsx("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>{l(x),a(!0)},children:i.jsx(dr,{className:"h-4 w-4"})})})})]},x.id))})]})})]})},qde=()=>{const[n,e]=E.useState("policies");return i.jsxs("div",{className:"p-4 space-y-6",children:[i.jsx("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Policies & Insurance"})}),i.jsx("div",{children:i.jsxs("nav",{className:"-mb-px flex space-x-6","aria-label":"Tabs",children:[i.jsxs("button",{onClick:()=>e("policies"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="policies"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(us,{className:"h-5 w-5"}),i.jsx("span",{children:"Company Policies"})]}),i.jsxs("button",{onClick:()=>e("insurance"),className:`flex items-center gap-2 whitespace-nowrap py-3 px-1 border-b-2 font-medium text-sm ${n==="insurance"?"border-accent text-accent-dark":"border-transparent text-muted hover:text-primary-text hover:border-gray-300"}`,children:[i.jsx(f3,{className:"h-5 w-5"}),i.jsx("span",{children:"Insurance Plans"})]})]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[n==="policies"&&i.jsx(Ade,{}),n==="insurance"&&i.jsx(Fde,{})]})]})},ex={documents:{aadhaar:!1,pan:!1,bankProof:!1,educationCertificate:!1,salarySlip:!1,uanProof:!1,familyAadhaar:!1},verifications:{requireBengaluruAddress:!1,requireDobVerification:!1}},zde=()=>{const n=td(),[e,t]=E.useState(null),[r,s]=E.useState([]),[a,o]=E.useState("Administrator");E.useEffect(()=>{ue.getSiteStaffDesignations().then(P=>{const O=[...new Set(P.map(M=>M.designation))];O.includes("Administrator")||O.unshift("Administrator"),s(O.map((M,D)=>({id:`${D}`,designation:M,department:"",permanentId:"",temporaryId:""})))})},[]);const{register:l,handleSubmit:c,control:d,formState:{isDirty:h},watch:p,reset:x,setValue:y}=tn({defaultValues:n});E.useEffect(()=>{x(n)},[n,x]),E.useEffect(()=>{n.rulesByDesignation?.[a]||(Object.keys(ex.documents).forEach(O=>{y(`rulesByDesignation.${a}.documents.${O}`,!0,{shouldDirty:!0})}),Object.keys(ex.verifications).forEach(O=>{y(`rulesByDesignation.${a}.verifications.${O}`,!0,{shouldDirty:!0})}))},[a,n.rulesByDesignation,y]);const _=p("enforceManpowerLimit"),w=p("enableEsiRule"),j=p("enableGmcRule"),C=P=>{n.updateRules(P),t({message:"Enrollment rules saved successfully!",type:"success"}),x(P)};return i.jsxs("form",{onSubmit:c(C),className:"p-4 space-y-8 w-full",children:[e&&i.jsx(pt,{message:e.message,type:e.type,onDismiss:()=>t(null)}),i.jsx(na,{title:"Enrollment Rules",children:i.jsxs(ne,{type:"submit",disabled:!h,children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Rules"]})}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(us,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"Designation-Specific Rules"}),i.jsx("p",{className:"text-muted",children:"Set mandatory documents and verifications for specific roles."})]})]}),i.jsx("div",{className:"mb-4",children:i.jsx(Ze,{label:"Configure rules for designation",value:a,onChange:P=>o(P.target.value),children:r.map(P=>i.jsx("option",{value:P.designation,children:P.designation},P.id))})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Mandatory Documents"}),i.jsx("div",{className:"space-y-3",children:Object.keys(ex.documents).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.documents.${P}`,control:d,defaultValue:!0,render:({field:O})=>i.jsx(Dn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:O.value,onChange:O.onChange})},P))})]}),i.jsxs("section",{children:[i.jsx("h3",{className:"font-semibold mb-2",children:"Data Verifications"}),i.jsx("div",{className:"space-y-3",children:Object.keys(ex.verifications).map(P=>i.jsx(_e,{name:`rulesByDesignation.${a}.verifications.${P}`,control:d,defaultValue:!0,render:({field:O})=>i.jsx(Dn,{id:`${a}-${P}`,label:P.replace(/([A-Z])/g," $1").replace(/^./,M=>M.toUpperCase()),checked:O.value,onChange:O.onChange})},P))})]})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Tl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"ESI Eligibility"}),i.jsx("p",{className:"text-muted",children:"Define salary threshold for statutory insurance."})]}),i.jsx(_e,{name:"enableEsiRule",control:d,render:({field:P})=>i.jsx(Dn,{id:"enableEsiRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsx("div",{className:`transition-opacity ${w?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs("div",{className:"max-w-sm",children:[i.jsx(we,{label:"ESI Eligibility Gross Salary Threshold",id:"esiCtcThreshold",type:"number",registration:l("esiCtcThreshold",{valueAsNumber:!0}),disabled:!w}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees at or below this amount are eligible for ESI. Those above are eligible for GMC."})]})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Tl,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("h2",{className:"text-xl font-bold",children:"GMC/Insurance Policy Rules"}),i.jsx("p",{className:"text-muted",children:"Set default GMC policies."})]}),i.jsx(_e,{name:"enableGmcRule",control:d,render:({field:P})=>i.jsx(Dn,{id:"enableGmcRule",label:"Enable Rule",checked:P.value,onChange:P.onChange})})]}),i.jsxs("div",{className:`transition-opacity ${j?"opacity-100":"opacity-50 pointer-events-none"}`,children:[i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(we,{label:"GMC Salary Threshold",id:"salaryThreshold",type:"number",registration:l("salaryThreshold",{valueAsNumber:!0}),disabled:!j}),i.jsx(_e,{name:"defaultPolicySingle",control:d,render:({field:P})=>i.jsxs(Ze,{label:"Policy (Single)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})}),i.jsx(_e,{name:"defaultPolicyMarried",control:d,render:({field:P})=>i.jsxs(Ze,{label:"Policy (Married)",...P,disabled:!j,children:[i.jsx("option",{value:"1L",children:"1 Lakh"}),i.jsx("option",{value:"2L",children:"2 Lakh"})]})})]}),i.jsx("p",{className:"text-xs text-muted mt-2",children:"Employees with a salary *above* this threshold will be eligible for GMC."})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(Ji,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Manpower Allocation"}),i.jsx("p",{className:"text-muted",children:"Set rules for enrolling based on approved manpower."})]})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(_e,{name:"enforceManpowerLimit",control:d,render:({field:P})=>i.jsx(Dn,{id:"enforceManpowerLimit",label:"Enforce Manpower Allocation Limits",description:"Check new enrollments against the approved manpower count for the site.",checked:P.value,onChange:P.onChange})}),i.jsx("div",{className:`max-w-sm transition-opacity ${_?"opacity-100":"opacity-50 pointer-events-none"}`,children:i.jsxs(Ze,{label:"Action When Limit is Reached",id:"manpowerLimitRule",registration:l("manpowerLimitRule"),disabled:!_,children:[i.jsx("option",{value:"warn",children:"Warn field officer but allow enrollment"}),i.jsx("option",{value:"block",children:"Block enrollment and require approval"})]})})]})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(dr,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Field Officer Permissions"}),i.jsx("p",{className:"text-muted",children:"Control what field officers can do during enrollment."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"allowSalaryEdit",control:d,render:({field:P})=>i.jsx(Dn,{id:"allowSalaryEdit",label:"Allow Salary Editing",description:"Permit field officers to edit default salary, triggering an approval workflow.",checked:P.value??!1,onChange:P.onChange})})})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-8 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"flex items-start mb-6",children:[i.jsx("div",{className:"p-3 rounded-full bg-accent-light mr-4",children:i.jsx(xu,{className:"h-6 w-6 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl font-bold",children:"Family Details Validation"}),i.jsx("p",{className:"text-muted",children:"Set rules for validating family member details."})]})]}),i.jsx("div",{className:"space-y-4",children:i.jsx(_e,{name:"enforceFamilyValidation",control:d,render:({field:P})=>i.jsx(Dn,{id:"enforceFamilyValidation",label:"Enforce Strict Family Validation",description:"Enable checks for duplicates, age, and gender based on relationship.",checked:P.value??!1,onChange:P.onChange})})})]})]})},Ude=()=>{const{id:n}=Bf(),e=St(),[t,r]=E.useState(null),[s,a]=E.useState(!0),[o,l]=E.useState(!1),c=E.useRef(null),{data:d,setFormsGenerated:h}=Yn(),p=s6(D=>D.currentLogo),[x,y]=E.useState(!1);E.useEffect(()=>{(async()=>{if(n&&!n.startsWith("draft_")){a(!0);const I=await ue.getOnboardingDataById(n);r(I||null),a(!1)}else r(d),a(!1)})()},[n,d]);const _=async()=>{const D=c.current;if(D&&t){y(!0);try{const I=D.outerHTML,F={margin:0,filename:`Onboarding_Forms_${t?.personal.employeeId}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(I,F)}catch(I){console.error("PDF generation failed:",I)}finally{y(!1)}}},w=()=>{h(!0),e(`/onboarding/add/review?id=${n}`)};if(s||x)return i.jsx("div",{className:"text-center p-10",children:i.jsx(_t,{className:"h-8 w-8 animate-spin mx-auto"})});if(!t)return i.jsx("div",{className:"text-center p-10 text-red-500",children:"Could not find employee data."});const j=t,C=`${j.personal.firstName} ${j.personal.middleName||""} ${j.personal.lastName}`.replace(/\s+/g," ").trim(),P=j.family.find(D=>D.relation==="Father")?.name||"",O=j.family.find(D=>D.relation==="Spouse")?.name||"",M=j.family.find(D=>D.relation==="Mother")?.name||"";return i.jsx("div",{className:"bg-page",children:i.jsxs("div",{className:"max-w-4xl p-4 sm:p-6 lg:p-8",children:[i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card no-print mb-8 sticky top-4 z-10",children:i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-center gap-4",children:[i.jsxs(ne,{type:"button",onClick:()=>e(-1),variant:"secondary",children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Go Back"]}),i.jsxs("div",{className:"text-center",children:[i.jsx("h2",{className:"font-bold text-lg",children:"Review Official Forms"}),i.jsx("p",{className:"text-sm text-muted",children:"Please confirm these details before submitting."})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsxs(ne,{type:"button",onClick:_,variant:"outline",disabled:x,children:[x?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(bi,{className:"mr-2 h-4 w-4"}),x?"Generating...":"Download"]}),i.jsx(ne,{type:"button",onClick:w,children:"Confirm & Continue"})]})]})}),i.jsxs("div",{ref:c,className:"bg-white rounded-xl border border-border shadow-lg",children:[i.jsx("div",{className:"pdf-page p-8 font-serif text-sm text-black",children:i.jsxs("div",{className:"border-4 border-black p-6 h-full flex flex-col",children:[i.jsx("h1",{className:"text-center text-xl font-bold tracking-widest mb-8",children:"EMPLOYEE PERSONAL DATA"}),i.jsx("div",{className:"w-64 mx-auto border-2 border-black p-2 my-8",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"mt-auto space-y-8 text-lg",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S NAME"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:C})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"SITE"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.organizationName})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"DESIGNATION"})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.organization.designation})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"EMPLOYEE'S ID NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.personal.employeeId})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"PF No."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.uan.pfNumber||j.uan.uanNumber})]}),i.jsxs("div",{className:"flex items-center",children:[i.jsx("span",{className:"w-48 font-bold",children:"ESI NO."})," : ",i.jsx("span",{className:"border-b border-black flex-1 ml-2",children:j.esi.esiNumber})]})]})]})}),i.jsx("div",{className:"page-break"}),i.jsx("div",{className:"pdf-page p-8 font-serif text-xs text-black",children:i.jsxs("div",{className:"border-2 border-black p-4 h-full relative",children:[i.jsx("div",{className:"absolute top-4 right-4 w-48",children:i.jsx("img",{src:p,alt:"Paradigm Logo",className:"w-full"})}),i.jsxs("div",{className:"flex justify-between items-center mb-4",children:[i.jsxs("h2",{className:"font-bold",children:["EMPLOYEE ID No. : ",i.jsx("span",{className:"font-normal underline",children:j.personal.employeeId})]}),i.jsx("h1",{className:"text-center font-bold text-base tracking-wider",children:"PERSONAL DATA"})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsxs("p",{children:["1. Name: ",i.jsx("span",{className:"underline",children:C})]}),i.jsxs("p",{children:["2. Father's Name: ",i.jsx("span",{className:"underline",children:P})]}),i.jsxs("p",{children:["3. Mother's Name: ",i.jsx("span",{className:"underline",children:M})]}),i.jsxs("p",{children:["4. Reference by: ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["5. Date of Birth: ",i.jsx("span",{className:"underline",children:j.personal.dob})]}),i.jsxs("p",{children:["6. Age: ",i.jsx("span",{className:"underline",children:j.personal.dob?new Date().getFullYear()-new Date(j.personal.dob).getFullYear():""})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["7. Qualification: ",i.jsx("span",{className:"underline",children:j.education[0]?.degree||""})]}),i.jsxs("p",{children:["8. Experience: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["9. Designation: ",i.jsx("span",{className:"underline",children:j.organization.designation})]}),i.jsxs("p",{children:["10. Net Salary Offered: ",i.jsx("span",{className:"underline",children:j.personal.salary?.toLocaleString("en-IN")})]})]}),i.jsxs("p",{children:["11. Present Address: ",i.jsx("span",{className:"underline",children:`${j.address.present.line1}, ${j.address.present.city}, ${j.address.present.state} - ${j.address.present.pincode}`})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["12. Permanent Address: ",i.jsx("span",{className:"underline",children:j.address.sameAsPresent?"Same as Present":`${j.address.permanent.line1}, ${j.address.permanent.city}`})]}),i.jsxs("p",{children:["Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.mobile})," Alternate Ph. No.: ",i.jsx("span",{className:"underline",children:j.personal.alternateMobile||""})]})]}),i.jsx("p",{children:"13. Left hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsx("p",{children:"14. Right hand thumb impression"}),i.jsxs("div",{className:"grid grid-cols-4 gap-2 h-12 border border-black my-1",children:[i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{className:"border-r border-black"}),i.jsx("div",{})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["15. Marital Status: ",i.jsx("span",{className:"underline",children:j.personal.maritalStatus})]}),i.jsxs("p",{children:["16. Name of the Spouse: ",i.jsx("span",{className:"underline",children:O})," Contact No.: ",i.jsx("span",{className:"underline"})]})]}),i.jsxs("p",{children:["17. Languages Known: to Speak ",i.jsx("span",{className:"underline"})," to Write ",i.jsx("span",{className:"underline"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["18. Date of Joining: ",i.jsx("span",{className:"underline",children:j.organization.joiningDate})]}),i.jsx("p",{children:"19. ID Card:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["20. ESI Number: ",i.jsx("span",{className:"underline",children:j.esi.esiNumber})]}),i.jsxs("p",{children:["21. PF Number: ",i.jsx("span",{className:"underline",children:j.uan.pfNumber||j.uan.uanNumber})]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"22. Uniform Details: "}),i.jsx("p",{children:"23. Shoe Details: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("p",{children:["24. Name of the Site: ",i.jsx("span",{className:"underline",children:j.organization.organizationName})]}),i.jsx("p",{children:"25. Site / Estate Manager: "})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"26. Record enclosed: "}),i.jsx("p",{children:"28. Reference Name:"})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("p",{children:"27. Hirer: "}),i.jsx("p",{className:"ml-24",children:"Reference Ph.:"})]}),i.jsxs("p",{children:["29. Emergency Contact Name: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactName})," Ph.: ",i.jsx("span",{className:"underline",children:j.personal.emergencyContactNumber})," Blood Group: ",i.jsx("span",{className:"underline",children:j.personal.bloodGroup})]})]}),i.jsxs("div",{className:"absolute bottom-4 left-4 right-4 flex justify-between",children:[i.jsx("p",{children:"Employee Signature:"}),i.jsx("p",{children:"Documented by:"})]})]})})]})]})})},Bde=({status:n})=>{const e={Pending:"bg-yellow-100 text-yellow-800",Approved:"bg-blue-100 text-blue-800",Issued:"bg-green-100 text-green-800",Rejected:"bg-red-100 text-red-800"};return i.jsx("span",{className:`px-2 py-0.5 text-xs font-medium rounded-full capitalize ${e[n]}`,children:n})},tx=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden",children:[i.jsx("h4",{className:"p-3 font-semibold bg-page border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(y=>y.size===d&&y.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(y=>e.some(_=>_.size===d&&_.fit===y)).length,className:"px-2 py-2 align-middle font-semibold border-r",children:d}),t.map(y=>i.jsx("td",{className:"px-2 py-2",children:x[y.key]},String(y.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:y})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...y,value:y.value||"",onChange:_=>y.onChange(parseInt(_.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},Vde=({request:n,onClose:e,masterUniforms:t})=>{if(!n)return null;const{pantsQuantities:r,shirtsQuantities:s}=E.useMemo(()=>{const o={},l={};return n.items.forEach(c=>{c.category==="Pants"?o[c.sizeId]=c.quantity:l[c.sizeId]=c.quantity}),{pantsQuantities:o,shirtsQuantities:l}},[n.items]),a=n.gender==="Gents"?t.gents:t.ladies;return i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-6xl my-4 animate-fade-in-scale flex flex-col max-h-[90vh]",onClick:o=>o.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-start flex-shrink-0",children:[i.jsxs("div",{children:[i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Uniform Request Details"}),i.jsxs("p",{className:"text-sm text-muted",children:[n.siteName," - ",We(new Date(n.requestedDate),"dd MMM, yyyy")]})]}),i.jsx(ne,{variant:"icon",onClick:e,children:i.jsx(vi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-6",children:i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:n.gender==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(tx,{readOnly:!0,title:"Gents' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(tx,{readOnly:!0,title:"Gents' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],quantities:s})]}):i.jsxs(i.Fragment,{children:[i.jsx(tx,{readOnly:!0,title:"Ladies' Pants",sizes:a.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],quantities:r}),i.jsx(tx,{readOnly:!0,title:"Ladies' Shirts",sizes:a.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],quantities:s})]})})}),i.jsx("div",{className:"p-4 border-t flex justify-end flex-shrink-0",children:i.jsx(ne,{variant:"secondary",onClick:e,children:"Close"})})]})})},Wde=()=>{const n=St(),[e,t]=E.useState("list"),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(null),[d,h]=E.useState(!0),[p,x]=E.useState(null),[y,_]=E.useState(null),[w,j]=E.useState(null),[C,P]=E.useState(null),O=async()=>{h(!0);try{const[F,q,B,U]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);s(F),o(q),c({gents:B,ladies:U})}catch{x({message:"Failed to load uniform data.",type:"error"})}finally{h(!1)}};E.useEffect(()=>{O()},[]);const M=()=>{n("/uniforms/request/new")},D=F=>{n(`/uniforms/request/edit/${F.id}`)},I=async()=>{if(w)try{await ue.deleteUniformRequest(w.id),x({message:"Request deleted.",type:"success"}),j(null),O()}catch{x({message:"Failed to delete request.",type:"error"})}};return d?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 space-y-6",children:[p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)}),i.jsx(Kr,{isOpen:!!w,onClose:()=>j(null),onConfirm:I,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),l&&i.jsx(Vde,{request:C,onClose:()=>P(null),masterUniforms:l}),i.jsx("div",{className:"bg-card p-4 rounded-2xl",children:i.jsx(na,{title:"Uniform Management",children:e==="list"&&i.jsxs(ne,{onClick:M,children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," New Uniform Request"]})})}),e==="list"&&i.jsxs("div",{className:"overflow-x-auto",children:[i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site / Employee"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Gender"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Requested By"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Source"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{children:r.map(F=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Site",className:"px-4 py-3 font-medium",children:[i.jsx("p",{children:F.siteName}),F.source==="Individual"&&F.employeeDetails?.[0]?.employeeName&&i.jsxs("p",{className:"text-xs text-muted",children:["For: ",F.employeeDetails[0].employeeName]}),F.source==="Enrollment"&&i.jsxs("p",{className:"text-xs text-muted",children:["(",F.employeeDetails?.length||0," employees)"]})]}),i.jsx("td",{"data-label":"Gender",className:"px-4 py-3 text-muted",children:F.gender}),i.jsx("td",{"data-label":"Requested By",className:"px-4 py-3 text-muted",children:F.requestedByName||"System"}),i.jsx("td",{"data-label":"Source",className:"px-4 py-3 text-muted",children:F.source||"Bulk"}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:i.jsx(Bde,{status:F.status})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 md:justify-start justify-end",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>P(F),title:"View Request",children:i.jsx(Cl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>D(F),title:"Edit Request",disabled:F.source==="Enrollment",children:i.jsx(dr,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>j(F),title:"Delete Request",disabled:F.source==="Enrollment",children:i.jsx(rn,{className:"h-4 w-4 text-red-600"})})]})})]},F.id))})]}),r.length===0&&i.jsx("p",{className:"text-center p-8 text-muted",children:"No uniform requests found."})]})]})},$de=({item:n})=>{const[e,t]=E.useState(!1);return i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-primary-text",children:n.employeeName}),i.jsx("p",{className:"text-sm text-muted",children:n.employeeId}),i.jsx("p",{className:"text-xs text-muted mt-1",children:We(new Date(n.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")})]}),i.jsx("div",{className:"text-right",children:i.jsxs("p",{className:"text-lg font-bold text-accent",children:["",n.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),n.breakdown.length>0&&i.jsxs("div",{className:"mt-3 pt-3 border-t border-border",children:[i.jsxs("button",{onClick:()=>t(!e),className:"flex justify-between items-center w-full text-sm text-muted",children:[i.jsx("span",{children:"Details"}),i.jsx(ju,{className:`h-4 w-4 transition-transform ${e?"rotate-180":""}`})]}),e&&i.jsx("ul",{className:"list-disc list-inside space-y-1 mt-2 text-sm text-muted animate-fade-in-down",children:n.breakdown.map((r,s)=>i.jsxs("li",{children:[r.name,": ",(r.cost||0).toFixed(2)]},s))})]})]})},Hde=()=>i.jsx("div",{className:"space-y-4",children:[...Array(3)].map((n,e)=>i.jsxs("div",{className:"bg-card rounded-xl border border-border p-4 space-y-3 skeleton-pulse",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("div",{className:"h-5 w-32 bg-gray-300 rounded"}),i.jsx("div",{className:"h-4 w-24 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-6 w-20 bg-gray-300 rounded"})]}),i.jsx("div",{className:"h-4 w-1/4 bg-gray-300 rounded mt-2"})]},e))}),Yde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),{verificationCosts:s,updateVerificationCosts:a}=yi(),[o,l]=E.useState(s),[c,d]=E.useState(!1),[h,p]=E.useState([{startDate:gf(new Date,29),endDate:new Date,key:"selection"}]),[x,y]=E.useState("Last 30 Days"),[_,w]=E.useState(!1),j=E.useRef(null),[C,P]=E.useState(null),O=E.useRef(null),M=Rt("(max-width: 767px)"),D=E.useCallback(async()=>{const K=h[0]?.startDate,re=h[0]?.endDate;if(!(!K||!re)){r(!0);try{const H=await ue.getVerificationCostBreakdown(We(K,"yyyy-MM-dd"),We(re,"yyyy-MM-dd"));e(H)}catch(H){console.error("Failed to fetch cost breakdown",H),P({message:"Failed to load verification data.",type:"error"})}finally{r(!1)}}},[h]);E.useEffect(()=>{D()},[D]),E.useEffect(()=>{const K=re=>{j.current&&!j.current.contains(re.target)&&w(!1)};return document.addEventListener("mousedown",K),()=>document.removeEventListener("mousedown",K)},[]),E.useEffect(()=>{l(s)},[s]),E.useEffect(()=>{d(JSON.stringify(o)!==JSON.stringify(s))},[o,s]);const I=(K,re,H)=>{l(se=>se.map(ie=>ie.id===K?re==="cost"?{...ie,cost:parseFloat(H)||0}:{...ie,name:H}:ie))},F=()=>{l(K=>[...K,{id:`new_${Date.now()}`,name:"New Verification Type",cost:0}])},q=K=>{l(re=>re.filter(H=>H.id!==K))},B=()=>{a(o),P({message:"Costs updated successfully!",type:"success"})},U=E.useMemo(()=>{const K=new Map(s.map(re=>[re.name,re.cost]));return n.map(re=>{const H=re.breakdown.map(ie=>({...ie,cost:Number(K.get(ie.name))||0})),se=H.reduce((ie,ce)=>ie+(ce.cost||0)*ce.count,0);return{...re,breakdown:H,totalCost:se}})},[n,s]),W=E.useMemo(()=>{const K=U.length,re=U.reduce((se,ie)=>se+ie.totalCost,0),H=K>0?re/K:0;return{totalEmployees:K,totalCost:re,averageCost:H}},[U]),G=E.useMemo(()=>{const K={};return U.forEach(re=>{re.breakdown.forEach(H=>{K[H.name]||(K[H.name]={count:0,total:0}),K[H.name].count+=H.count,K[H.name].total+=(H.cost||0)*H.count})}),Object.entries(K).map(([re,H])=>({name:re,...H}))},[U]),[Z,Y]=E.useState(!1),ae=async K=>{{const re=O.current;if(!re){P({message:"Could not find report to export.",type:"error"});return}Y(!0);try{const H=re.outerHTML,se={margin:.5,filename:`Cost_Analysis_Report_${We(h[0].startDate,"yyyy-MM-dd")}_to_${We(h[0].endDate,"yyyy-MM-dd")}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(H,se)}catch(H){console.error("PDF generation failed:",H),P({message:"Failed to generate PDF.",type:"error"})}finally{Y(!1)}}},ee=[{label:"Today",value:"Today"},{label:"Last 7 Days",value:"Last 7 Days"},{label:"Last 30 Days",value:"Last 30 Days"}],me=K=>{const re=new Date;let H=new Date;K==="Today"?H=ix():K==="Last 7 Days"?H=gf(re,6):K==="Last 30 Days"&&(H=gf(re,29)),y(K),p([{startDate:H,endDate:re,key:"selection"}]),w(!1)},$=K=>{p([K.selection])};return i.jsxs("div",{className:"p-4 space-y-6",children:[C&&i.jsx(pt,{message:C.message,type:C.type,onDismiss:()=>P(null)}),i.jsx(na,{title:"Verification Costing",children:i.jsx("div",{className:"w-full sm:w-auto",children:i.jsxs("div",{className:"grid grid-cols-2 gap-2 sm:flex sm:items-center sm:flex-wrap",children:[i.jsxs(ne,{onClick:()=>ae(),variant:"outline",size:"sm",disabled:Z||t||U.length===0,children:[Z?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(bi,{className:"mr-2 h-4 w-4"}),Z?"Generating PDF...":"Download PDF"]}),ee.map(K=>i.jsx(ne,{variant:x===K.value?"outline":"secondary",size:"sm",onClick:()=>me(K.value),className:"justify-center",children:K.label},K.value)),i.jsxs("div",{className:"relative",ref:j,children:[i.jsxs(ne,{variant:x==="Custom"?"outline":"secondary",size:"sm",onClick:()=>{w(K=>!K),y("Custom")},className:"w-full justify-center",children:[i.jsx(Da,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Custom Range"})]}),_&&i.jsx("div",{className:"absolute top-full right-0 mt-2 z-10 bg-card border rounded-lg shadow-lg",children:i.jsx(wm.DateRangePicker,{onChange:$,ranges:h,maxDate:new Date,direction:"horizontal"})})]})]})})}),i.jsx("div",{className:"bg-card p-4 md:p-6 rounded-xl shadow-card",children:i.jsxs("details",{className:"group",children:[i.jsxs("summary",{className:"cursor-pointer flex justify-between items-center list-none",children:[i.jsxs("h3",{className:"text-lg font-semibold flex items-center gap-2 text-primary-text",children:[i.jsx(Om,{className:"h-5 w-5 text-muted"})," Cost Configuration"]}),i.jsx(ju,{className:"transition-transform group-open:rotate-180"})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t",children:[i.jsx("div",{className:"space-y-2",children:o.map(K=>i.jsxs("div",{className:"grid grid-cols-12 gap-2 items-center",children:[i.jsx("div",{className:"col-span-12 sm:col-span-6",children:i.jsx(we,{"aria-label":"Cost Item Name",value:K.name,onChange:re=>I(K.id,"name",re.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-8 sm:col-span-4",children:i.jsx(we,{"aria-label":"Cost Value",type:"number",step:"0.01",value:K.cost||0,onChange:re=>I(K.id,"cost",re.target.value),className:"!py-2"})}),i.jsx("div",{className:"col-span-4 sm:col-span-2 text-right",children:i.jsx(ne,{variant:"icon",onClick:()=>q(K.id),"aria-label":`Remove ${K.name}`,children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})})]},K.id))}),i.jsxs("div",{className:"mt-6 flex justify-between items-center",children:[i.jsxs(ne,{type:"button",variant:"outline",size:"sm",onClick:F,children:[i.jsx(Vt,{className:"mr-2 h-4"})," Add Cost Item"]}),i.jsxs(ne,{onClick:B,disabled:!c,children:[i.jsx(Cs,{className:"mr-2 h-4"})," Save Costs"]})]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsx(jo,{title:"Total Verification Cost",value:`${W.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Tl}),i.jsx(jo,{title:"Total Verified Employees",value:W.totalEmployees,icon:Ji}),i.jsx(jo,{title:"Avg. Cost Per Employee",value:`${W.averageCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})}`,icon:Tl})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("h3",{className:"text-lg font-semibold mb-4 text-primary-text",children:"Verification Usage Breakdown"}),t?i.jsx("div",{className:"flex justify-center items-center h-24",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted"})}):G.length>0?i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:G.map(K=>i.jsxs("div",{className:"bg-page p-4 rounded-lg border",children:[i.jsx("p",{className:"text-sm font-medium text-muted",children:K.name}),i.jsx("p",{className:"text-2xl font-bold text-primary-text",children:K.count}),i.jsxs("p",{className:"text-sm font-semibold text-accent-dark",children:["Total: ",K.total.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},K.name))}):i.jsx("p",{className:"text-center text-muted py-8",children:"No verification data for this period."})]}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx("div",{className:"flex justify-between items-center",children:i.jsx("h3",{className:"text-lg font-semibold text-primary-text",children:"Detailed Report"})}),i.jsx("div",{ref:O,className:"mt-4 pt-4 border-t border-border",children:M?t?i.jsx(Hde,{}):U.length===0?i.jsx("p",{className:"text-center text-muted py-8",children:"No report data for this period."}):i.jsx("div",{className:"space-y-4",children:U.map(K=>i.jsx($de,{item:K},K.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Employee"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Enrollment Date"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Cost Breakdown"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-right text-xs font-medium text-muted uppercase",children:"Total Cost"})]})}),i.jsx("tbody",{children:t?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10",children:i.jsx(_t,{className:"h-6 w-6 animate-spin text-muted mx-auto"})})}):U.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No report data for this period."})}):U.map(K=>i.jsxs("tr",{children:[i.jsxs("td",{"data-label":"Employee",className:"px-6 py-4",children:[i.jsx("div",{className:"font-medium text-primary-text",children:K.employeeName}),i.jsx("div",{className:"text-sm text-muted",children:K.employeeId})]}),i.jsx("td",{"data-label":"Enrollment Date",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:We(new Date(K.enrollmentDate.replace(/-/g,"/")),"dd MMM, yyyy")}),i.jsx("td",{"data-label":"Cost Breakdown",className:"px-6 py-4 text-sm text-muted",children:i.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[K.breakdown.map((re,H)=>i.jsxs("li",{children:[re.name,": ",(re.cost||0).toFixed(2)]},H)),K.breakdown.length===0&&i.jsx("li",{children:"No verifications performed"})]})}),i.jsxs("td",{"data-label":"Total Cost",className:"px-6 py-4 whitespace-nowrap text-right font-semibold text-primary-text",children:["",K.totalCost.toLocaleString("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2})]})]},K.id))})]})})})]})]})},Gde=({status:n})=>{if(!n)return i.jsx("span",{className:"text-xs text-muted",children:"-"});const e={"Not Generated":"bg-slate-700 text-white dark:bg-slate-600 dark:text-slate-200",Generated:"bg-sky-100 text-sky-800 dark:bg-sky-500/20 dark:text-sky-300",Sent:"bg-amber-100 text-amber-800 dark:bg-amber-500/20 dark:text-amber-300",Paid:"bg-emerald-100 text-emerald-800 dark:bg-emerald-500/20 dark:text-emerald-300"};return i.jsx("span",{className:`px-2.5 py-0.5 inline-flex text-xs leading-5 font-semibold rounded-full ${e[n]}`,children:n})},Zde=({invoiceData:n,discount:e,setDiscount:t,roundOff:r,setRoundOff:s})=>{const a=l=>new Intl.NumberFormat("en-IN",{minimumFractionDigits:2,maximumFractionDigits:2}).format(l),o=E.useMemo(()=>{if(!n)return null;const l=n.lineItems.reduce((x,y)=>{const _=y.deployment*y.ratePerMonth;return y.description.toLowerCase().includes("deduction")?x-_:x+_},0),c=l*.1,d=l+c-e,h=d*.09,p=d+h+h+r;return{subTotal:l,serviceCharge:c,grandTotal:d,gst:h,finalTotal:p}},[n,e,r]);return o?i.jsxs("div",{className:"p-4 bg-white text-black text-[10px] printable-area",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsxs("div",{children:[i.jsxs("p",{children:["Name : ",n.siteName]}),i.jsxs("p",{children:["Address : ",n.siteAddress]}),i.jsxs("p",{children:["City : ",n.siteAddress.split(",").pop()?.trim()]})]}),i.jsxs("div",{className:"border border-black",children:[i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Invoice No"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceNumber})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Date"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.invoiceDate})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-b border-black",children:"Month"}),i.jsx("div",{className:"p-1 border-b border-black",children:n.statementMonth.split("-")[0]})]}),i.jsxs("div",{className:"grid grid-cols-2",children:[i.jsx("div",{className:"p-1 border-r border-black",children:"Due Date"}),i.jsx("div",{className:"p-1",children:"January 15, 2023"})]})]})]}),i.jsx("div",{className:"my-4 flex justify-center",children:i.jsx(Qi,{className:"h-10"})}),i.jsxs("h2",{className:"text-center font-bold text-sm underline mb-2",children:[n.siteName," Summary Statement for the month of ",n.statementMonth]}),i.jsxs("table",{className:"w-full border-collapse border border-black",children:[i.jsx("thead",{children:i.jsxs("tr",{className:"font-bold bg-gray-200",children:[i.jsx("td",{className:"border p-1 border-black",children:"Sl.No"}),i.jsx("td",{className:"border p-1 border-black",children:"Description"}),i.jsx("td",{className:"border p-1 border-black",children:"Deployment"}),i.jsx("td",{className:"border p-1 border-black",children:"No of Days"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Day"}),i.jsx("td",{className:"border p-1 border-black",children:"Rate/Month"}),i.jsx("td",{className:"border p-1 border-black",children:"Amount(Rs)"})]})}),i.jsxs("tbody",{children:[i.jsx("tr",{children:i.jsxs("td",{className:"border p-1 border-black font-bold",colSpan:7,children:["SERVICES (01/",We(new Date(n.statementMonth),"MM/yyyy")," to ",We(new Date(n.invoiceDate),"dd/MM/yyyy"),")"]})}),n.lineItems.map((l,c)=>{const d=l.deployment*l.ratePerMonth,h=l.description.toLowerCase().includes("deduction"),p=l.deployment===0;return i.jsxs("tr",{children:[i.jsx("td",{className:"border p-1 border-black text-center",children:c+1}),i.jsx("td",{className:`border p-1 border-black ${h?"text-red-600":""}`,children:l.description}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.deployment}),i.jsx("td",{className:"border p-1 border-black text-center",children:p?"-":l.noOfDays}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerDay)}),i.jsx("td",{className:"border p-1 border-black text-right",children:p?"-":a(l.ratePerMonth)}),i.jsx("td",{className:`border p-1 border-black text-right ${h?"text-red-600":""}`,children:a(d)})]},l.id)}),Array.from({length:Math.max(0,10-n.lineItems.length)}).map((l,c)=>i.jsx("tr",{children:i.jsx("td",{className:"border p-1 border-black h-6",colSpan:7})},`spacer-${c}`))]}),i.jsxs("tfoot",{children:[i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.subTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Admin,Overheads and Service Charges 10% on Sub Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.serviceCharge)})]}),i.jsxs("tr",{className:"no-print",children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold text-red-600",children:"Discount"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:i.jsx(we,{type:"number",value:e,onChange:l=>t(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black font-bold",children:"Grand Total"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right font-bold",children:a(o.grandTotal)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"Central GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:3,className:"border p-1 border-black",children:"State GST"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-center",children:"9.00%"}),i.jsx("td",{colSpan:2,className:"border p-1 border-black text-right",children:a(o.gst)})]}),i.jsxs("tr",{children:[i.jsx("td",{colSpan:5,className:"border p-1 border-black",children:"Round off"}),i.jsxs("td",{colSpan:2,className:"border p-1 border-black text-right",children:[i.jsx("span",{className:"print-only",children:a(r)}),i.jsx("span",{className:"no-print",children:i.jsx(we,{type:"number",step:"0.01",value:r,onChange:l=>s(parseFloat(l.target.value)||0),className:"text-right !p-1"})})]})]}),i.jsxs("tr",{className:"bg-gray-200 font-bold text-base",children:[i.jsx("td",{colSpan:5,className:"border p-2 border-black",children:"Payable for Services rendered"}),i.jsx("td",{colSpan:2,className:"border p-2 border-black text-right",children:a(o.finalTotal)})]})]})]})]}):null},Kde=()=>{const[n,e]=E.useState([]),[t,r]=E.useState(!0),[s,a]=E.useState(!1),[o,l]=E.useState(We(new Date,"yyyy-MM")),[c,d]=E.useState({}),[h,p]=E.useState({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),[x,y]=E.useState(0),[_,w]=E.useState(.2),[j,C]=E.useState(null),P=E.useRef(null),[O,M]=E.useState(!1);E.useEffect(()=>{ue.getOrganizations().then(B=>e(B.sort((U,W)=>U.shortName.localeCompare(W.shortName)))).catch(()=>C({message:"Failed to load sites.",type:"error"})).finally(()=>r(!1))},[]);const D=E.useCallback(async B=>{a(!0);try{const U=new Date(B+"-02"),W=await ue.getInvoiceStatuses(U);d(W)}catch{C({message:"Failed to fetch invoice statuses.",type:"error"})}finally{a(!1)}},[]);E.useEffect(()=>{o&&D(o)},[o,D]);const I=async B=>{p({isOpen:!0,site:B,invoiceData:null,isLoading:!0});try{const U=new Date(o+"-02"),W=await ue.getInvoiceSummaryData(B.id,U);p({isOpen:!0,site:B,invoiceData:W,isLoading:!1})}catch{C({message:"Failed to fetch invoice data.",type:"error"}),p({isOpen:!1,site:null,invoiceData:null,isLoading:!1})}},F=async()=>{const B=P.current;if(!B||!h.invoiceData){C({message:"Could not find invoice to export.",type:"error"});return}M(!0);try{const U=B.outerHTML,W={margin:.25,filename:`Invoice_${h.invoiceData.siteName.replace(" ","_")}_${h.invoiceData.statementMonth}.pdf`,image:{type:"jpeg",quality:.98},html2canvas:{scale:2,useCORS:!0},jsPDF:{unit:"in",format:"a4",orientation:"portrait"}};await ue.generatePdf(U,W)}catch(U){console.error("PDF generation failed:",U),C({message:"Failed to generate PDF.",type:"error"})}finally{M(!1)}},q=()=>{p({isOpen:!1,site:null,invoiceData:null,isLoading:!1}),y(0),w(.2)};return t?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("div",{className:"p-4 md:p-0",children:[j&&i.jsx(pt,{message:j.message,type:j.type,onDismiss:()=>C(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(na,{title:"Invoice Summary"}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex flex-col md:flex-row justify-between md:items-center gap-4",children:[i.jsx("h3",{className:"text-xl font-semibold text-primary-text",children:"Monthly Invoice Status"}),i.jsx("div",{className:"md:w-56",children:i.jsx(we,{label:"",id:"month-select",type:"month",value:o,onChange:B=>l(B.target.value)})})]}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Site Name"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Invoice Status"}),i.jsx("th",{className:"px-4 py-3 text-left font-medium text-muted",children:"Actions"})]})}),i.jsx("tbody",{className:"divide-y divide-border md:bg-card md:divide-y-0",children:n.map(B=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"Site Name",className:"px-4 py-3 font-medium",children:B.shortName}),i.jsx("td",{"data-label":"Status",className:"px-4 py-3",children:s?i.jsx(_t,{className:"h-4 w-4 animate-spin"}):i.jsx(Gde,{status:c[B.id]})}),i.jsx("td",{"data-label":"Actions",className:"px-4 py-3",children:i.jsxs("div",{className:"flex items-center gap-2 justify-end md:justify-start",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(B),disabled:c[B.id]==="Not Generated"||s,title:"View Invoice",children:i.jsx(Cl,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(B),disabled:c[B.id]==="Not Generated"||s,title:"Download Invoice",children:i.jsx(bi,{className:"h-4 w-4"})})]})})]},B.id))})]})})]})]}),h.isOpen&&i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:q,children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card w-full max-w-4xl m-4 animate-fade-in-scale flex flex-col",onClick:B=>B.stopPropagation(),children:[i.jsxs("div",{className:"p-4 border-b flex justify-between items-center no-print",children:[i.jsxs("h3",{className:"text-lg font-bold text-primary-text",children:["Invoice for ",h.site?.shortName]}),i.jsx(ne,{variant:"icon",onClick:q,children:i.jsx(vi,{className:"h-5 w-5"})})]}),i.jsx("div",{className:"flex-grow overflow-y-auto p-4 max-h-[70vh]",children:h.isLoading?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):h.invoiceData?i.jsx("div",{ref:P,children:i.jsx(Zde,{invoiceData:h.invoiceData,discount:x,setDiscount:y,roundOff:_,setRoundOff:w})}):i.jsx("p",{className:"text-center text-muted",children:"No data to display."})}),i.jsx("div",{className:"p-4 border-t flex justify-end no-print",children:i.jsxs(ne,{onClick:F,disabled:!h.invoiceData||O,children:[O?i.jsx(_t,{className:"mr-2 h-4 w-4 animate-spin"}):i.jsx(bi,{className:"mr-2 h-4 w-4"}),O?"Generating...":"Download PDF"]})})]})})]})};var Kh={exports:{}};var Jde=Kh.exports,$L;function Qde(){return $L||($L=1,(function(n,e){(function(t,r){r(e)})(Jde,(function(t){var r="1.9.4";function s(f){var v,T,A,V;for(T=1,A=arguments.length;T<A;T++){V=arguments[T];for(v in V)f[v]=V[v]}return f}var a=Object.create||(function(){function f(){}return function(v){return f.prototype=v,new f}})();function o(f,v){var T=Array.prototype.slice;if(f.bind)return f.bind.apply(f,T.call(arguments,1));var A=T.call(arguments,2);return function(){return f.apply(v,A.length?A.concat(T.call(arguments)):arguments)}}var l=0;function c(f){return"_leaflet_id"in f||(f._leaflet_id=++l),f._leaflet_id}function d(f,v,T){var A,V,Q,pe;return pe=function(){A=!1,V&&(Q.apply(T,V),V=!1)},Q=function(){A?V=arguments:(f.apply(T,arguments),setTimeout(pe,v),A=!0)},Q}function h(f,v,T){var A=v[1],V=v[0],Q=A-V;return f===A&&T?f:((f-V)%Q+Q)%Q+V}function p(){return!1}function x(f,v){if(v===!1)return f;var T=Math.pow(10,v===void 0?6:v);return Math.round(f*T)/T}function y(f){return f.trim?f.trim():f.replace(/^\s+|\s+$/g,"")}function _(f){return y(f).split(/\s+/)}function w(f,v){Object.prototype.hasOwnProperty.call(f,"options")||(f.options=f.options?a(f.options):{});for(var T in v)f.options[T]=v[T];return f.options}function j(f,v,T){var A=[];for(var V in f)A.push(encodeURIComponent(T?V.toUpperCase():V)+"="+encodeURIComponent(f[V]));return(!v||v.indexOf("?")===-1?"?":"&")+A.join("&")}var C=/\{ *([\w_ -]+) *\}/g;function P(f,v){return f.replace(C,function(T,A){var V=v[A];if(V===void 0)throw new Error("No value provided for variable "+T);return typeof V=="function"&&(V=V(v)),V})}var O=Array.isArray||function(f){return Object.prototype.toString.call(f)==="[object Array]"};function M(f,v){for(var T=0;T<f.length;T++)if(f[T]===v)return T;return-1}var D="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=";function I(f){return window["webkit"+f]||window["moz"+f]||window["ms"+f]}var F=0;function q(f){var v=+new Date,T=Math.max(0,16-(v-F));return F=v+T,window.setTimeout(f,T)}var B=window.requestAnimationFrame||I("RequestAnimationFrame")||q,U=window.cancelAnimationFrame||I("CancelAnimationFrame")||I("CancelRequestAnimationFrame")||function(f){window.clearTimeout(f)};function W(f,v,T){if(T&&B===q)f.call(v);else return B.call(window,o(f,v))}function G(f){f&&U.call(window,f)}var Z={__proto__:null,extend:s,create:a,bind:o,get lastId(){return l},stamp:c,throttle:d,wrapNum:h,falseFn:p,formatNum:x,trim:y,splitWords:_,setOptions:w,getParamString:j,template:P,isArray:O,indexOf:M,emptyImageUrl:D,requestFn:B,cancelFn:U,requestAnimFrame:W,cancelAnimFrame:G};function Y(){}Y.extend=function(f){var v=function(){w(this),this.initialize&&this.initialize.apply(this,arguments),this.callInitHooks()},T=v.__super__=this.prototype,A=a(T);A.constructor=v,v.prototype=A;for(var V in this)Object.prototype.hasOwnProperty.call(this,V)&&V!=="prototype"&&V!=="__super__"&&(v[V]=this[V]);return f.statics&&s(v,f.statics),f.includes&&(ae(f.includes),s.apply(null,[A].concat(f.includes))),s(A,f),delete A.statics,delete A.includes,A.options&&(A.options=T.options?a(T.options):{},s(A.options,f.options)),A._initHooks=[],A.callInitHooks=function(){if(!this._initHooksCalled){T.callInitHooks&&T.callInitHooks.call(this),this._initHooksCalled=!0;for(var Q=0,pe=A._initHooks.length;Q<pe;Q++)A._initHooks[Q].call(this)}},v},Y.include=function(f){var v=this.prototype.options;return s(this.prototype,f),f.options&&(this.prototype.options=v,this.mergeOptions(f.options)),this},Y.mergeOptions=function(f){return s(this.prototype.options,f),this},Y.addInitHook=function(f){var v=Array.prototype.slice.call(arguments,1),T=typeof f=="function"?f:function(){this[f].apply(this,v)};return this.prototype._initHooks=this.prototype._initHooks||[],this.prototype._initHooks.push(T),this};function ae(f){if(!(typeof L>"u"||!L||!L.Mixin)){f=O(f)?f:[f];for(var v=0;v<f.length;v++)f[v]===L.Mixin.Events&&console.warn("Deprecated include of L.Mixin.Events: this property will be removed in future releases, please inherit from L.Evented instead.",new Error().stack)}}var ee={on:function(f,v,T){if(typeof f=="object")for(var A in f)this._on(A,f[A],v);else{f=_(f);for(var V=0,Q=f.length;V<Q;V++)this._on(f[V],v,T)}return this},off:function(f,v,T){if(!arguments.length)delete this._events;else if(typeof f=="object")for(var A in f)this._off(A,f[A],v);else{f=_(f);for(var V=arguments.length===1,Q=0,pe=f.length;Q<pe;Q++)V?this._off(f[Q]):this._off(f[Q],v,T)}return this},_on:function(f,v,T,A){if(typeof v!="function"){console.warn("wrong listener type: "+typeof v);return}if(this._listens(f,v,T)===!1){T===this&&(T=void 0);var V={fn:v,ctx:T};A&&(V.once=!0),this._events=this._events||{},this._events[f]=this._events[f]||[],this._events[f].push(V)}},_off:function(f,v,T){var A,V,Q;if(this._events&&(A=this._events[f],!!A)){if(arguments.length===1){if(this._firingCount)for(V=0,Q=A.length;V<Q;V++)A[V].fn=p;delete this._events[f];return}if(typeof v!="function"){console.warn("wrong listener type: "+typeof v);return}var pe=this._listens(f,v,T);if(pe!==!1){var Ne=A[pe];this._firingCount&&(Ne.fn=p,this._events[f]=A=A.slice()),A.splice(pe,1)}}},fire:function(f,v,T){if(!this.listens(f,T))return this;var A=s({},v,{type:f,target:this,sourceTarget:v&&v.sourceTarget||this});if(this._events){var V=this._events[f];if(V){this._firingCount=this._firingCount+1||1;for(var Q=0,pe=V.length;Q<pe;Q++){var Ne=V[Q],Ee=Ne.fn;Ne.once&&this.off(f,Ee,Ne.ctx),Ee.call(Ne.ctx||this,A)}this._firingCount--}}return T&&this._propagateEvent(A),this},listens:function(f,v,T,A){typeof f!="string"&&console.warn('"string" type argument expected');var V=v;typeof v!="function"&&(A=!!v,V=void 0,T=void 0);var Q=this._events&&this._events[f];if(Q&&Q.length&&this._listens(f,V,T)!==!1)return!0;if(A){for(var pe in this._eventParents)if(this._eventParents[pe].listens(f,v,T,A))return!0}return!1},_listens:function(f,v,T){if(!this._events)return!1;var A=this._events[f]||[];if(!v)return!!A.length;T===this&&(T=void 0);for(var V=0,Q=A.length;V<Q;V++)if(A[V].fn===v&&A[V].ctx===T)return V;return!1},once:function(f,v,T){if(typeof f=="object")for(var A in f)this._on(A,f[A],v,!0);else{f=_(f);for(var V=0,Q=f.length;V<Q;V++)this._on(f[V],v,T,!0)}return this},addEventParent:function(f){return this._eventParents=this._eventParents||{},this._eventParents[c(f)]=f,this},removeEventParent:function(f){return this._eventParents&&delete this._eventParents[c(f)],this},_propagateEvent:function(f){for(var v in this._eventParents)this._eventParents[v].fire(f.type,s({layer:f.target,propagatedFrom:f.target},f),!0)}};ee.addEventListener=ee.on,ee.removeEventListener=ee.clearAllEventListeners=ee.off,ee.addOneTimeEventListener=ee.once,ee.fireEvent=ee.fire,ee.hasEventListeners=ee.listens;var me=Y.extend(ee);function $(f,v,T){this.x=T?Math.round(f):f,this.y=T?Math.round(v):v}var K=Math.trunc||function(f){return f>0?Math.floor(f):Math.ceil(f)};$.prototype={clone:function(){return new $(this.x,this.y)},add:function(f){return this.clone()._add(re(f))},_add:function(f){return this.x+=f.x,this.y+=f.y,this},subtract:function(f){return this.clone()._subtract(re(f))},_subtract:function(f){return this.x-=f.x,this.y-=f.y,this},divideBy:function(f){return this.clone()._divideBy(f)},_divideBy:function(f){return this.x/=f,this.y/=f,this},multiplyBy:function(f){return this.clone()._multiplyBy(f)},_multiplyBy:function(f){return this.x*=f,this.y*=f,this},scaleBy:function(f){return new $(this.x*f.x,this.y*f.y)},unscaleBy:function(f){return new $(this.x/f.x,this.y/f.y)},round:function(){return this.clone()._round()},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},floor:function(){return this.clone()._floor()},_floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.clone()._ceil()},_ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},trunc:function(){return this.clone()._trunc()},_trunc:function(){return this.x=K(this.x),this.y=K(this.y),this},distanceTo:function(f){f=re(f);var v=f.x-this.x,T=f.y-this.y;return Math.sqrt(v*v+T*T)},equals:function(f){return f=re(f),f.x===this.x&&f.y===this.y},contains:function(f){return f=re(f),Math.abs(f.x)<=Math.abs(this.x)&&Math.abs(f.y)<=Math.abs(this.y)},toString:function(){return"Point("+x(this.x)+", "+x(this.y)+")"}};function re(f,v,T){return f instanceof $?f:O(f)?new $(f[0],f[1]):f==null?f:typeof f=="object"&&"x"in f&&"y"in f?new $(f.x,f.y):new $(f,v,T)}function H(f,v){if(f)for(var T=v?[f,v]:f,A=0,V=T.length;A<V;A++)this.extend(T[A])}H.prototype={extend:function(f){var v,T;if(!f)return this;if(f instanceof $||typeof f[0]=="number"||"x"in f)v=T=re(f);else if(f=se(f),v=f.min,T=f.max,!v||!T)return this;return!this.min&&!this.max?(this.min=v.clone(),this.max=T.clone()):(this.min.x=Math.min(v.x,this.min.x),this.max.x=Math.max(T.x,this.max.x),this.min.y=Math.min(v.y,this.min.y),this.max.y=Math.max(T.y,this.max.y)),this},getCenter:function(f){return re((this.min.x+this.max.x)/2,(this.min.y+this.max.y)/2,f)},getBottomLeft:function(){return re(this.min.x,this.max.y)},getTopRight:function(){return re(this.max.x,this.min.y)},getTopLeft:function(){return this.min},getBottomRight:function(){return this.max},getSize:function(){return this.max.subtract(this.min)},contains:function(f){var v,T;return typeof f[0]=="number"||f instanceof $?f=re(f):f=se(f),f instanceof H?(v=f.min,T=f.max):v=T=f,v.x>=this.min.x&&T.x<=this.max.x&&v.y>=this.min.y&&T.y<=this.max.y},intersects:function(f){f=se(f);var v=this.min,T=this.max,A=f.min,V=f.max,Q=V.x>=v.x&&A.x<=T.x,pe=V.y>=v.y&&A.y<=T.y;return Q&&pe},overlaps:function(f){f=se(f);var v=this.min,T=this.max,A=f.min,V=f.max,Q=V.x>v.x&&A.x<T.x,pe=V.y>v.y&&A.y<T.y;return Q&&pe},isValid:function(){return!!(this.min&&this.max)},pad:function(f){var v=this.min,T=this.max,A=Math.abs(v.x-T.x)*f,V=Math.abs(v.y-T.y)*f;return se(re(v.x-A,v.y-V),re(T.x+A,T.y+V))},equals:function(f){return f?(f=se(f),this.min.equals(f.getTopLeft())&&this.max.equals(f.getBottomRight())):!1}};function se(f,v){return!f||f instanceof H?f:new H(f,v)}function ie(f,v){if(f)for(var T=v?[f,v]:f,A=0,V=T.length;A<V;A++)this.extend(T[A])}ie.prototype={extend:function(f){var v=this._southWest,T=this._northEast,A,V;if(f instanceof oe)A=f,V=f;else if(f instanceof ie){if(A=f._southWest,V=f._northEast,!A||!V)return this}else return f?this.extend(de(f)||ce(f)):this;return!v&&!T?(this._southWest=new oe(A.lat,A.lng),this._northEast=new oe(V.lat,V.lng)):(v.lat=Math.min(A.lat,v.lat),v.lng=Math.min(A.lng,v.lng),T.lat=Math.max(V.lat,T.lat),T.lng=Math.max(V.lng,T.lng)),this},pad:function(f){var v=this._southWest,T=this._northEast,A=Math.abs(v.lat-T.lat)*f,V=Math.abs(v.lng-T.lng)*f;return new ie(new oe(v.lat-A,v.lng-V),new oe(T.lat+A,T.lng+V))},getCenter:function(){return new oe((this._southWest.lat+this._northEast.lat)/2,(this._southWest.lng+this._northEast.lng)/2)},getSouthWest:function(){return this._southWest},getNorthEast:function(){return this._northEast},getNorthWest:function(){return new oe(this.getNorth(),this.getWest())},getSouthEast:function(){return new oe(this.getSouth(),this.getEast())},getWest:function(){return this._southWest.lng},getSouth:function(){return this._southWest.lat},getEast:function(){return this._northEast.lng},getNorth:function(){return this._northEast.lat},contains:function(f){typeof f[0]=="number"||f instanceof oe||"lat"in f?f=de(f):f=ce(f);var v=this._southWest,T=this._northEast,A,V;return f instanceof ie?(A=f.getSouthWest(),V=f.getNorthEast()):A=V=f,A.lat>=v.lat&&V.lat<=T.lat&&A.lng>=v.lng&&V.lng<=T.lng},intersects:function(f){f=ce(f);var v=this._southWest,T=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),Q=V.lat>=v.lat&&A.lat<=T.lat,pe=V.lng>=v.lng&&A.lng<=T.lng;return Q&&pe},overlaps:function(f){f=ce(f);var v=this._southWest,T=this._northEast,A=f.getSouthWest(),V=f.getNorthEast(),Q=V.lat>v.lat&&A.lat<T.lat,pe=V.lng>v.lng&&A.lng<T.lng;return Q&&pe},toBBoxString:function(){return[this.getWest(),this.getSouth(),this.getEast(),this.getNorth()].join(",")},equals:function(f,v){return f?(f=ce(f),this._southWest.equals(f.getSouthWest(),v)&&this._northEast.equals(f.getNorthEast(),v)):!1},isValid:function(){return!!(this._southWest&&this._northEast)}};function ce(f,v){return f instanceof ie?f:new ie(f,v)}function oe(f,v,T){if(isNaN(f)||isNaN(v))throw new Error("Invalid LatLng object: ("+f+", "+v+")");this.lat=+f,this.lng=+v,T!==void 0&&(this.alt=+T)}oe.prototype={equals:function(f,v){if(!f)return!1;f=de(f);var T=Math.max(Math.abs(this.lat-f.lat),Math.abs(this.lng-f.lng));return T<=(v===void 0?1e-9:v)},toString:function(f){return"LatLng("+x(this.lat,f)+", "+x(this.lng,f)+")"},distanceTo:function(f){return ye.distance(this,de(f))},wrap:function(){return ye.wrapLatLng(this)},toBounds:function(f){var v=180*f/40075017,T=v/Math.cos(Math.PI/180*this.lat);return ce([this.lat-v,this.lng-T],[this.lat+v,this.lng+T])},clone:function(){return new oe(this.lat,this.lng,this.alt)}};function de(f,v,T){return f instanceof oe?f:O(f)&&typeof f[0]!="object"?f.length===3?new oe(f[0],f[1],f[2]):f.length===2?new oe(f[0],f[1]):null:f==null?f:typeof f=="object"&&"lat"in f?new oe(f.lat,"lng"in f?f.lng:f.lon,f.alt):v===void 0?null:new oe(f,v,T)}var te={latLngToPoint:function(f,v){var T=this.projection.project(f),A=this.scale(v);return this.transformation._transform(T,A)},pointToLatLng:function(f,v){var T=this.scale(v),A=this.transformation.untransform(f,T);return this.projection.unproject(A)},project:function(f){return this.projection.project(f)},unproject:function(f){return this.projection.unproject(f)},scale:function(f){return 256*Math.pow(2,f)},zoom:function(f){return Math.log(f/256)/Math.LN2},getProjectedBounds:function(f){if(this.infinite)return null;var v=this.projection.bounds,T=this.scale(f),A=this.transformation.transform(v.min,T),V=this.transformation.transform(v.max,T);return new H(A,V)},infinite:!1,wrapLatLng:function(f){var v=this.wrapLng?h(f.lng,this.wrapLng,!0):f.lng,T=this.wrapLat?h(f.lat,this.wrapLat,!0):f.lat,A=f.alt;return new oe(T,v,A)},wrapLatLngBounds:function(f){var v=f.getCenter(),T=this.wrapLatLng(v),A=v.lat-T.lat,V=v.lng-T.lng;if(A===0&&V===0)return f;var Q=f.getSouthWest(),pe=f.getNorthEast(),Ne=new oe(Q.lat-A,Q.lng-V),Ee=new oe(pe.lat-A,pe.lng-V);return new ie(Ne,Ee)}},ye=s({},te,{wrapLng:[-180,180],R:6371e3,distance:function(f,v){var T=Math.PI/180,A=f.lat*T,V=v.lat*T,Q=Math.sin((v.lat-f.lat)*T/2),pe=Math.sin((v.lng-f.lng)*T/2),Ne=Q*Q+Math.cos(A)*Math.cos(V)*pe*pe,Ee=2*Math.atan2(Math.sqrt(Ne),Math.sqrt(1-Ne));return this.R*Ee}}),Ce=6378137,Re={R:Ce,MAX_LATITUDE:85.0511287798,project:function(f){var v=Math.PI/180,T=this.MAX_LATITUDE,A=Math.max(Math.min(T,f.lat),-T),V=Math.sin(A*v);return new $(this.R*f.lng*v,this.R*Math.log((1+V)/(1-V))/2)},unproject:function(f){var v=180/Math.PI;return new oe((2*Math.atan(Math.exp(f.y/this.R))-Math.PI/2)*v,f.x*v/this.R)},bounds:(function(){var f=Ce*Math.PI;return new H([-f,-f],[f,f])})()};function Te(f,v,T,A){if(O(f)){this._a=f[0],this._b=f[1],this._c=f[2],this._d=f[3];return}this._a=f,this._b=v,this._c=T,this._d=A}Te.prototype={transform:function(f,v){return this._transform(f.clone(),v)},_transform:function(f,v){return v=v||1,f.x=v*(this._a*f.x+this._b),f.y=v*(this._c*f.y+this._d),f},untransform:function(f,v){return v=v||1,new $((f.x/v-this._b)/this._a,(f.y/v-this._d)/this._c)}};function je(f,v,T,A){return new Te(f,v,T,A)}var ke=s({},ye,{code:"EPSG:3857",projection:Re,transformation:(function(){var f=.5/(Math.PI*Re.R);return je(f,.5,-f,.5)})()}),Ue=s({},ke,{code:"EPSG:900913"});function Ye(f){return document.createElementNS("http://www.w3.org/2000/svg",f)}function ve(f,v){var T="",A,V,Q,pe,Ne,Ee;for(A=0,Q=f.length;A<Q;A++){for(Ne=f[A],V=0,pe=Ne.length;V<pe;V++)Ee=Ne[V],T+=(V?"L":"M")+Ee.x+" "+Ee.y;T+=v?dt.svg?"z":"x":""}return T||"M0 0"}var Oe=document.documentElement.style,Ve="ActiveXObject"in window,qe=Ve&&!document.addEventListener,X="msLaunchUri"in navigator&&!("documentMode"in document),le=ur("webkit"),he=ur("android"),Le=ur("android 2")||ur("android 3"),Ie=parseInt(/WebKit\/([0-9]+)|$/.exec(navigator.userAgent)[1],10),ze=he&&ur("Google")&&Ie<537&&!("AudioNode"in window),et=!!window.opera,tt=!X&&ur("chrome"),ct=ur("gecko")&&!le&&!et&&!Ve,ht=!tt&&ur("safari"),Et=ur("phantom"),Mt="OTransition"in Oe,en=navigator.platform.indexOf("Win")===0,Jt=Ve&&"transition"in Oe,Zt="WebKitCSSMatrix"in window&&"m11"in new window.WebKitCSSMatrix&&!Le,on="MozPerspective"in Oe,zt=!window.L_DISABLE_3D&&(Jt||Zt||on)&&!Mt&&!Et,Sn=typeof orientation<"u"||ur("mobile"),qn=Sn&&le,bn=Sn&&Zt,nr=!window.PointerEvent&&window.MSPointerEvent,st=!!(window.PointerEvent||nr),Cn="ontouchstart"in window||!!window.TouchEvent,Rr=!window.L_NO_TOUCH&&(Cn||st),Jr=Sn&&et,kn=Sn&&ct,Ps=(window.devicePixelRatio||window.screen.deviceXDPI/window.screen.logicalXDPI)>1,Qs=(function(){var f=!1;try{var v=Object.defineProperty({},"passive",{get:function(){f=!0}});window.addEventListener("testPassiveEventSupport",p,v),window.removeEventListener("testPassiveEventSupport",p,v)}catch{}return f})(),Lr=(function(){return!!document.createElement("canvas").getContext})(),_i=!!(document.createElementNS&&Ye("svg").createSVGRect),ra=!!_i&&(function(){var f=document.createElement("div");return f.innerHTML="<svg/>",(f.firstChild&&f.firstChild.namespaceURI)==="http://www.w3.org/2000/svg"})(),Mo=!_i&&(function(){try{var f=document.createElement("div");f.innerHTML='<v:shape adj="1"/>';var v=f.firstChild;return v.style.behavior="url(#default#VML)",v&&typeof v.adj=="object"}catch{return!1}})(),sa=navigator.platform.indexOf("Mac")===0,fd=navigator.platform.indexOf("Linux")===0;function ur(f){return navigator.userAgent.toLowerCase().indexOf(f)>=0}var dt={ie:Ve,ielt9:qe,edge:X,webkit:le,android:he,android23:Le,androidStock:ze,opera:et,chrome:tt,gecko:ct,safari:ht,phantom:Et,opera12:Mt,win:en,ie3d:Jt,webkit3d:Zt,gecko3d:on,any3d:zt,mobile:Sn,mobileWebkit:qn,mobileWebkit3d:bn,msPointer:nr,pointer:st,touch:Rr,touchNative:Cn,mobileOpera:Jr,mobileGecko:kn,retina:Ps,passiveEvents:Qs,canvas:Lr,svg:_i,vml:Mo,inlineSvg:ra,mac:sa,linux:fd},ia=dt.msPointer?"MSPointerDown":"pointerdown",qa=dt.msPointer?"MSPointerMove":"pointermove",Il=dt.msPointer?"MSPointerUp":"pointerup",Al=dt.msPointer?"MSPointerCancel":"pointercancel",Eo={touchstart:ia,touchmove:qa,touchend:Il,touchcancel:Al},Ms={touchstart:Pn,touchmove:za,touchend:za,touchcancel:za},Xs={},Do=!1;function hd(f,v,T){return v==="touchstart"&&md(),Ms[v]?(T=Ms[v].bind(this,T),f.addEventListener(Eo[v],T,!1),T):(console.warn("wrong event specified:",v),p)}function Rl(f,v,T){if(!Eo[v]){console.warn("wrong event specified:",v);return}f.removeEventListener(Eo[v],T,!1)}function Ll(f){Xs[f.pointerId]=f}function Fl(f){Xs[f.pointerId]&&(Xs[f.pointerId]=f)}function Oo(f){delete Xs[f.pointerId]}function md(){Do||(document.addEventListener(ia,Ll,!0),document.addEventListener(qa,Fl,!0),document.addEventListener(Il,Oo,!0),document.addEventListener(Al,Oo,!0),Do=!0)}function za(f,v){if(v.pointerType!==(v.MSPOINTER_TYPE_MOUSE||"mouse")){v.touches=[];for(var T in Xs)v.touches.push(Xs[T]);v.changedTouches=[v],f(v)}}function Pn(f,v){v.MSPOINTER_TYPE_TOUCH&&v.pointerType===v.MSPOINTER_TYPE_TOUCH&&Mn(v),za(f,v)}function pd(f){var v={},T,A;for(A in f)T=f[A],v[A]=T&&T.bind?T.bind(f):T;return f=v,v.type="dblclick",v.detail=2,v.isTrusted=!1,v._simulated=!0,v}var Io=200;function ql(f,v){f.addEventListener("dblclick",v);var T=0,A;function V(Q){if(Q.detail!==1){A=Q.detail;return}if(!(Q.pointerType==="mouse"||Q.sourceCapabilities&&!Q.sourceCapabilities.firesTouchEvents)){var pe=ni(Q);if(!(pe.some(function(Ee){return Ee instanceof HTMLLabelElement&&Ee.attributes.for})&&!pe.some(function(Ee){return Ee instanceof HTMLInputElement||Ee instanceof HTMLSelectElement}))){var Ne=Date.now();Ne-T<=Io?(A++,A===2&&v(pd(Q))):A=1,T=Ne}}}return f.addEventListener("click",V),{dblclick:v,simDblclick:V}}function Ua(f,v){f.removeEventListener("dblclick",v.dblclick),f.removeEventListener("click",v.simDblclick)}var Ao=Ci(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),ji=Ci(["webkitTransition","transition","OTransition","MozTransition","msTransition"]),aa=ji==="webkitTransition"||ji==="OTransition"?ji+"End":"transitionend";function Fr(f){return typeof f=="string"?document.getElementById(f):f}function oa(f,v){var T=f.style[v]||f.currentStyle&&f.currentStyle[v];if((!T||T==="auto")&&document.defaultView){var A=document.defaultView.getComputedStyle(f,null);T=A?A[v]:null}return T==="auto"?null:T}function Ot(f,v,T){var A=document.createElement(f);return A.className=v||"",T&&T.appendChild(A),A}function wn(f){var v=f.parentNode;v&&v.removeChild(f)}function Ba(f){for(;f.firstChild;)f.removeChild(f.firstChild)}function Ni(f){var v=f.parentNode;v&&v.lastChild!==f&&v.appendChild(f)}function hs(f){var v=f.parentNode;v&&v.firstChild!==f&&v.insertBefore(f,v.firstChild)}function Si(f,v){if(f.classList!==void 0)return f.classList.contains(v);var T=Va(f);return T.length>0&&new RegExp("(^|\\s)"+v+"(\\s|$)").test(T)}function Dt(f,v){if(f.classList!==void 0)for(var T=_(v),A=0,V=T.length;A<V;A++)f.classList.add(T[A]);else if(!Si(f,v)){var Q=Va(f);Ro(f,(Q?Q+" ":"")+v)}}function xn(f,v){f.classList!==void 0?f.classList.remove(v):Ro(f,y((" "+Va(f)+" ").replace(" "+v+" "," ")))}function Ro(f,v){f.className.baseVal===void 0?f.className=v:f.className.baseVal=v}function Va(f){return f.correspondingElement&&(f=f.correspondingElement),f.className.baseVal===void 0?f.className:f.className.baseVal}function fr(f,v){"opacity"in f.style?f.style.opacity=v:"filter"in f.style&&zl(f,v)}function zl(f,v){var T=!1,A="DXImageTransform.Microsoft.Alpha";try{T=f.filters.item(A)}catch{if(v===1)return}v=Math.round(v*100),T?(T.Enabled=v!==100,T.Opacity=v):f.style.filter+=" progid:"+A+"(opacity="+v+")"}function Ci(f){for(var v=document.documentElement.style,T=0;T<f.length;T++)if(f[T]in v)return f[T];return!1}function qr(f,v,T){var A=v||new $(0,0);f.style[Ao]=(dt.ie3d?"translate("+A.x+"px,"+A.y+"px)":"translate3d("+A.x+"px,"+A.y+"px,0)")+(T?" scale("+T+")":"")}function An(f,v){f._leaflet_pos=v,dt.any3d?qr(f,v):(f.style.left=v.x+"px",f.style.top=v.y+"px")}function ms(f){return f._leaflet_pos||new $(0,0)}var Kt,Ti,Wa;if("onselectstart"in document)Kt=function(){Ct(window,"selectstart",Mn)},Ti=function(){cn(window,"selectstart",Mn)};else{var ei=Ci(["userSelect","WebkitUserSelect","OUserSelect","MozUserSelect","msUserSelect"]);Kt=function(){if(ei){var f=document.documentElement.style;Wa=f[ei],f[ei]="none"}},Ti=function(){ei&&(document.documentElement.style[ei]=Wa,Wa=void 0)}}function $a(){Ct(window,"dragstart",Mn)}function Ha(){cn(window,"dragstart",Mn)}var la,ca;function ki(f){for(;f.tabIndex===-1;)f=f.parentNode;f.style&&(zr(),la=f,ca=f.style.outlineStyle,f.style.outlineStyle="none",Ct(window,"keydown",zr))}function zr(){la&&(la.style.outlineStyle=ca,la=void 0,ca=void 0,cn(window,"keydown",zr))}function ps(f){do f=f.parentNode;while((!f.offsetWidth||!f.offsetHeight)&&f!==document.body);return f}function Qr(f){var v=f.getBoundingClientRect();return{x:v.width/f.offsetWidth||1,y:v.height/f.offsetHeight||1,boundingClientRect:v}}var da={__proto__:null,TRANSFORM:Ao,TRANSITION:ji,TRANSITION_END:aa,get:Fr,getStyle:oa,create:Ot,remove:wn,empty:Ba,toFront:Ni,toBack:hs,hasClass:Si,addClass:Dt,removeClass:xn,setClass:Ro,getClass:Va,setOpacity:fr,testProp:Ci,setTransform:qr,setPosition:An,getPosition:ms,get disableTextSelection(){return Kt},get enableTextSelection(){return Ti},disableImageDrag:$a,enableImageDrag:Ha,preventOutline:ki,restoreOutline:zr,getSizedParentNode:ps,getScale:Qr};function Ct(f,v,T,A){if(v&&typeof v=="object")for(var V in v)Fo(f,V,v[V],T);else{v=_(v);for(var Q=0,pe=v.length;Q<pe;Q++)Fo(f,v[Q],T,A)}return this}var Gn="_leaflet_events";function cn(f,v,T,A){if(arguments.length===1)Lo(f),delete f[Gn];else if(v&&typeof v=="object")for(var V in v)Ya(f,V,v[V],T);else if(v=_(v),arguments.length===2)Lo(f,function(Ne){return M(v,Ne)!==-1});else for(var Q=0,pe=v.length;Q<pe;Q++)Ya(f,v[Q],T,A);return this}function Lo(f,v){for(var T in f[Gn]){var A=T.split(/\d/)[0];(!v||v(A))&&Ya(f,A,null,null,T)}}var ti={mouseenter:"mouseover",mouseleave:"mouseout",wheel:!("onwheel"in window)&&"mousewheel"};function Fo(f,v,T,A){var V=v+c(T)+(A?"_"+c(A):"");if(f[Gn]&&f[Gn][V])return this;var Q=function(Ne){return T.call(A||f,Ne||window.event)},pe=Q;!dt.touchNative&&dt.pointer&&v.indexOf("touch")===0?Q=hd(f,v,Q):dt.touch&&v==="dblclick"?Q=ql(f,Q):"addEventListener"in f?v==="touchstart"||v==="touchmove"||v==="wheel"||v==="mousewheel"?f.addEventListener(ti[v]||v,Q,dt.passiveEvents?{passive:!1}:!1):v==="mouseenter"||v==="mouseleave"?(Q=function(Ne){Ne=Ne||window.event,ha(f,Ne)&&pe(Ne)},f.addEventListener(ti[v],Q,!1)):f.addEventListener(v,pe,!1):f.attachEvent("on"+v,Q),f[Gn]=f[Gn]||{},f[Gn][V]=Q}function Ya(f,v,T,A,V){V=V||v+c(T)+(A?"_"+c(A):"");var Q=f[Gn]&&f[Gn][V];if(!Q)return this;!dt.touchNative&&dt.pointer&&v.indexOf("touch")===0?Rl(f,v,Q):dt.touch&&v==="dblclick"?Ua(f,Q):"removeEventListener"in f?f.removeEventListener(ti[v]||v,Q,!1):f.detachEvent("on"+v,Q),f[Gn][V]=null}function Xr(f){return f.stopPropagation?f.stopPropagation():f.originalEvent?f.originalEvent._stopped=!0:f.cancelBubble=!0,this}function Ga(f){return Fo(f,"wheel",Xr),this}function ua(f){return Ct(f,"mousedown touchstart dblclick contextmenu",Xr),f._leaflet_disable_click=!0,this}function Mn(f){return f.preventDefault?f.preventDefault():f.returnValue=!1,this}function Ur(f){return Mn(f),Xr(f),this}function ni(f){if(f.composedPath)return f.composedPath();for(var v=[],T=f.target;T;)v.push(T),T=T.parentNode;return v}function fa(f,v){if(!v)return new $(f.clientX,f.clientY);var T=Qr(v),A=T.boundingClientRect;return new $((f.clientX-A.left)/T.x-v.clientLeft,(f.clientY-A.top)/T.y-v.clientTop)}var gd=dt.linux&&dt.chrome?window.devicePixelRatio:dt.mac?window.devicePixelRatio*3:window.devicePixelRatio>0?2*window.devicePixelRatio:1;function Ul(f){return dt.edge?f.wheelDeltaY/2:f.deltaY&&f.deltaMode===0?-f.deltaY/gd:f.deltaY&&f.deltaMode===1?-f.deltaY*20:f.deltaY&&f.deltaMode===2?-f.deltaY*60:f.deltaX||f.deltaZ?0:f.wheelDelta?(f.wheelDeltaY||f.wheelDelta)/2:f.detail&&Math.abs(f.detail)<32765?-f.detail*20:f.detail?f.detail/-32765*60:0}function ha(f,v){var T=v.relatedTarget;if(!T)return!0;try{for(;T&&T!==f;)T=T.parentNode}catch{return!1}return T!==f}var Za={__proto__:null,on:Ct,off:cn,stopPropagation:Xr,disableScrollPropagation:Ga,disableClickPropagation:ua,preventDefault:Mn,stop:Ur,getPropagationPath:ni,getMousePosition:fa,getWheelDelta:Ul,isExternalTarget:ha,addListener:Ct,removeListener:cn},Ka=me.extend({run:function(f,v,T,A){this.stop(),this._el=f,this._inProgress=!0,this._duration=T||.25,this._easeOutPower=1/Math.max(A||.5,.2),this._startPos=ms(f),this._offset=v.subtract(this._startPos),this._startTime=+new Date,this.fire("start"),this._animate()},stop:function(){this._inProgress&&(this._step(!0),this._complete())},_animate:function(){this._animId=W(this._animate,this),this._step()},_step:function(f){var v=+new Date-this._startTime,T=this._duration*1e3;v<T?this._runFrame(this._easeOut(v/T),f):(this._runFrame(1),this._complete())},_runFrame:function(f,v){var T=this._startPos.add(this._offset.multiplyBy(f));v&&T._round(),An(this._el,T),this.fire("step")},_complete:function(){G(this._animId),this._inProgress=!1,this.fire("end")},_easeOut:function(f){return 1-Math.pow(1-f,this._easeOutPower)}}),Ht=me.extend({options:{crs:ke,center:void 0,zoom:void 0,minZoom:void 0,maxZoom:void 0,layers:[],maxBounds:void 0,renderer:void 0,zoomAnimation:!0,zoomAnimationThreshold:4,fadeAnimation:!0,markerZoomAnimation:!0,transform3DLimit:8388608,zoomSnap:1,zoomDelta:1,trackResize:!0},initialize:function(f,v){v=w(this,v),this._handlers=[],this._layers={},this._zoomBoundLayers={},this._sizeChanged=!0,this._initContainer(f),this._initLayout(),this._onResize=o(this._onResize,this),this._initEvents(),v.maxBounds&&this.setMaxBounds(v.maxBounds),v.zoom!==void 0&&(this._zoom=this._limitZoom(v.zoom)),v.center&&v.zoom!==void 0&&this.setView(de(v.center),v.zoom,{reset:!0}),this.callInitHooks(),this._zoomAnimated=ji&&dt.any3d&&!dt.mobileOpera&&this.options.zoomAnimation,this._zoomAnimated&&(this._createAnimProxy(),Ct(this._proxy,aa,this._catchTransitionEnd,this)),this._addLayers(this.options.layers)},setView:function(f,v,T){if(v=v===void 0?this._zoom:this._limitZoom(v),f=this._limitCenter(de(f),v,this.options.maxBounds),T=T||{},this._stop(),this._loaded&&!T.reset&&T!==!0){T.animate!==void 0&&(T.zoom=s({animate:T.animate},T.zoom),T.pan=s({animate:T.animate,duration:T.duration},T.pan));var A=this._zoom!==v?this._tryAnimatedZoom&&this._tryAnimatedZoom(f,v,T.zoom):this._tryAnimatedPan(f,T.pan);if(A)return clearTimeout(this._sizeTimer),this}return this._resetView(f,v,T.pan&&T.pan.noMoveStart),this},setZoom:function(f,v){return this._loaded?this.setView(this.getCenter(),f,{zoom:v}):(this._zoom=f,this)},zoomIn:function(f,v){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom+f,v)},zoomOut:function(f,v){return f=f||(dt.any3d?this.options.zoomDelta:1),this.setZoom(this._zoom-f,v)},setZoomAround:function(f,v,T){var A=this.getZoomScale(v),V=this.getSize().divideBy(2),Q=f instanceof $?f:this.latLngToContainerPoint(f),pe=Q.subtract(V).multiplyBy(1-1/A),Ne=this.containerPointToLatLng(V.add(pe));return this.setView(Ne,v,{zoom:T})},_getBoundsCenterZoom:function(f,v){v=v||{},f=f.getBounds?f.getBounds():ce(f);var T=re(v.paddingTopLeft||v.padding||[0,0]),A=re(v.paddingBottomRight||v.padding||[0,0]),V=this.getBoundsZoom(f,!1,T.add(A));if(V=typeof v.maxZoom=="number"?Math.min(v.maxZoom,V):V,V===1/0)return{center:f.getCenter(),zoom:V};var Q=A.subtract(T).divideBy(2),pe=this.project(f.getSouthWest(),V),Ne=this.project(f.getNorthEast(),V),Ee=this.unproject(pe.add(Ne).divideBy(2).add(Q),V);return{center:Ee,zoom:V}},fitBounds:function(f,v){if(f=ce(f),!f.isValid())throw new Error("Bounds are not valid.");var T=this._getBoundsCenterZoom(f,v);return this.setView(T.center,T.zoom,v)},fitWorld:function(f){return this.fitBounds([[-90,-180],[90,180]],f)},panTo:function(f,v){return this.setView(f,this._zoom,{pan:v})},panBy:function(f,v){if(f=re(f).round(),v=v||{},!f.x&&!f.y)return this.fire("moveend");if(v.animate!==!0&&!this.getSize().contains(f))return this._resetView(this.unproject(this.project(this.getCenter()).add(f)),this.getZoom()),this;if(this._panAnim||(this._panAnim=new Ka,this._panAnim.on({step:this._onPanTransitionStep,end:this._onPanTransitionEnd},this)),v.noMoveStart||this.fire("movestart"),v.animate!==!1){Dt(this._mapPane,"leaflet-pan-anim");var T=this._getMapPanePos().subtract(f).round();this._panAnim.run(this._mapPane,T,v.duration||.25,v.easeLinearity)}else this._rawPanBy(f),this.fire("move").fire("moveend");return this},flyTo:function(f,v,T){if(T=T||{},T.animate===!1||!dt.any3d)return this.setView(f,v,T);this._stop();var A=this.project(this.getCenter()),V=this.project(f),Q=this.getSize(),pe=this._zoom;f=de(f),v=v===void 0?pe:v;var Ne=Math.max(Q.x,Q.y),Ee=Ne*this.getZoomScale(pe,v),Be=V.distanceTo(A)||1,rt=1.42,Nt=rt*rt;function $t(yn){var dc=yn?-1:1,zy=yn?Ee:Ne,Uy=Ee*Ee-Ne*Ne+dc*Nt*Nt*Be*Be,tl=2*zy*Nt*Be,nl=Uy/tl,rl=Math.sqrt(nl*nl+1)-nl,Eu=rl<1e-9?-18:Math.log(rl);return Eu}function jr(yn){return(Math.exp(yn)-Math.exp(-yn))/2}function mr(yn){return(Math.exp(yn)+Math.exp(-yn))/2}function vs(yn){return jr(yn)/mr(yn)}var ts=$t(0);function lc(yn){return Ne*(mr(ts)/mr(ts+rt*yn))}function rh(yn){return Ne*(mr(ts)*vs(ts+rt*yn)-jr(ts))/Nt}function co(yn){return 1-Math.pow(1-yn,1.5)}var Hm=Date.now(),el=($t(1)-ts)/rt,Ri=T.duration?1e3*T.duration:1e3*el*.8;function cc(){var yn=(Date.now()-Hm)/Ri,dc=co(yn)*el;yn<=1?(this._flyToFrame=W(cc,this),this._move(this.unproject(A.add(V.subtract(A).multiplyBy(rh(dc)/Be)),pe),this.getScaleZoom(Ne/lc(dc),pe),{flyTo:!0})):this._move(f,v)._moveEnd(!0)}return this._moveStart(!0,T.noMoveStart),cc.call(this),this},flyToBounds:function(f,v){var T=this._getBoundsCenterZoom(f,v);return this.flyTo(T.center,T.zoom,v)},setMaxBounds:function(f){return f=ce(f),this.listens("moveend",this._panInsideMaxBounds)&&this.off("moveend",this._panInsideMaxBounds),f.isValid()?(this.options.maxBounds=f,this._loaded&&this._panInsideMaxBounds(),this.on("moveend",this._panInsideMaxBounds)):(this.options.maxBounds=null,this)},setMinZoom:function(f){var v=this.options.minZoom;return this.options.minZoom=f,this._loaded&&v!==f&&(this.fire("zoomlevelschange"),this.getZoom()<this.options.minZoom)?this.setZoom(f):this},setMaxZoom:function(f){var v=this.options.maxZoom;return this.options.maxZoom=f,this._loaded&&v!==f&&(this.fire("zoomlevelschange"),this.getZoom()>this.options.maxZoom)?this.setZoom(f):this},panInsideBounds:function(f,v){this._enforcingBounds=!0;var T=this.getCenter(),A=this._limitCenter(T,this._zoom,ce(f));return T.equals(A)||this.panTo(A,v),this._enforcingBounds=!1,this},panInside:function(f,v){v=v||{};var T=re(v.paddingTopLeft||v.padding||[0,0]),A=re(v.paddingBottomRight||v.padding||[0,0]),V=this.project(this.getCenter()),Q=this.project(f),pe=this.getPixelBounds(),Ne=se([pe.min.add(T),pe.max.subtract(A)]),Ee=Ne.getSize();if(!Ne.contains(Q)){this._enforcingBounds=!0;var Be=Q.subtract(Ne.getCenter()),rt=Ne.extend(Q).getSize().subtract(Ee);V.x+=Be.x<0?-rt.x:rt.x,V.y+=Be.y<0?-rt.y:rt.y,this.panTo(this.unproject(V),v),this._enforcingBounds=!1}return this},invalidateSize:function(f){if(!this._loaded)return this;f=s({animate:!1,pan:!0},f===!0?{animate:!0}:f);var v=this.getSize();this._sizeChanged=!0,this._lastCenter=null;var T=this.getSize(),A=v.divideBy(2).round(),V=T.divideBy(2).round(),Q=A.subtract(V);return!Q.x&&!Q.y?this:(f.animate&&f.pan?this.panBy(Q):(f.pan&&this._rawPanBy(Q),this.fire("move"),f.debounceMoveend?(clearTimeout(this._sizeTimer),this._sizeTimer=setTimeout(o(this.fire,this,"moveend"),200)):this.fire("moveend")),this.fire("resize",{oldSize:v,newSize:T}))},stop:function(){return this.setZoom(this._limitZoom(this._zoom)),this.options.zoomSnap||this.fire("viewreset"),this._stop()},locate:function(f){if(f=this._locateOptions=s({timeout:1e4,watch:!1},f),!("geolocation"in navigator))return this._handleGeolocationError({code:0,message:"Geolocation not supported."}),this;var v=o(this._handleGeolocationResponse,this),T=o(this._handleGeolocationError,this);return f.watch?this._locationWatchId=navigator.geolocation.watchPosition(v,T,f):navigator.geolocation.getCurrentPosition(v,T,f),this},stopLocate:function(){return navigator.geolocation&&navigator.geolocation.clearWatch&&navigator.geolocation.clearWatch(this._locationWatchId),this._locateOptions&&(this._locateOptions.setView=!1),this},_handleGeolocationError:function(f){if(this._container._leaflet_id){var v=f.code,T=f.message||(v===1?"permission denied":v===2?"position unavailable":"timeout");this._locateOptions.setView&&!this._loaded&&this.fitWorld(),this.fire("locationerror",{code:v,message:"Geolocation error: "+T+"."})}},_handleGeolocationResponse:function(f){if(this._container._leaflet_id){var v=f.coords.latitude,T=f.coords.longitude,A=new oe(v,T),V=A.toBounds(f.coords.accuracy*2),Q=this._locateOptions;if(Q.setView){var pe=this.getBoundsZoom(V);this.setView(A,Q.maxZoom?Math.min(pe,Q.maxZoom):pe)}var Ne={latlng:A,bounds:V,timestamp:f.timestamp};for(var Ee in f.coords)typeof f.coords[Ee]=="number"&&(Ne[Ee]=f.coords[Ee]);this.fire("locationfound",Ne)}},addHandler:function(f,v){if(!v)return this;var T=this[f]=new v(this);return this._handlers.push(T),this.options[f]&&T.enable(),this},remove:function(){if(this._initEvents(!0),this.options.maxBounds&&this.off("moveend",this._panInsideMaxBounds),this._containerId!==this._container._leaflet_id)throw new Error("Map container is being reused by another instance");try{delete this._container._leaflet_id,delete this._containerId}catch{this._container._leaflet_id=void 0,this._containerId=void 0}this._locationWatchId!==void 0&&this.stopLocate(),this._stop(),wn(this._mapPane),this._clearControlPos&&this._clearControlPos(),this._resizeRequest&&(G(this._resizeRequest),this._resizeRequest=null),this._clearHandlers(),this._loaded&&this.fire("unload");var f;for(f in this._layers)this._layers[f].remove();for(f in this._panes)wn(this._panes[f]);return this._layers=[],this._panes=[],delete this._mapPane,delete this._renderer,this},createPane:function(f,v){var T="leaflet-pane"+(f?" leaflet-"+f.replace("Pane","")+"-pane":""),A=Ot("div",T,v||this._mapPane);return f&&(this._panes[f]=A),A},getCenter:function(){return this._checkIfLoaded(),this._lastCenter&&!this._moved()?this._lastCenter.clone():this.layerPointToLatLng(this._getCenterLayerPoint())},getZoom:function(){return this._zoom},getBounds:function(){var f=this.getPixelBounds(),v=this.unproject(f.getBottomLeft()),T=this.unproject(f.getTopRight());return new ie(v,T)},getMinZoom:function(){return this.options.minZoom===void 0?this._layersMinZoom||0:this.options.minZoom},getMaxZoom:function(){return this.options.maxZoom===void 0?this._layersMaxZoom===void 0?1/0:this._layersMaxZoom:this.options.maxZoom},getBoundsZoom:function(f,v,T){f=ce(f),T=re(T||[0,0]);var A=this.getZoom()||0,V=this.getMinZoom(),Q=this.getMaxZoom(),pe=f.getNorthWest(),Ne=f.getSouthEast(),Ee=this.getSize().subtract(T),Be=se(this.project(Ne,A),this.project(pe,A)).getSize(),rt=dt.any3d?this.options.zoomSnap:1,Nt=Ee.x/Be.x,$t=Ee.y/Be.y,jr=v?Math.max(Nt,$t):Math.min(Nt,$t);return A=this.getScaleZoom(jr,A),rt&&(A=Math.round(A/(rt/100))*(rt/100),A=v?Math.ceil(A/rt)*rt:Math.floor(A/rt)*rt),Math.max(V,Math.min(Q,A))},getSize:function(){return(!this._size||this._sizeChanged)&&(this._size=new $(this._container.clientWidth||0,this._container.clientHeight||0),this._sizeChanged=!1),this._size.clone()},getPixelBounds:function(f,v){var T=this._getTopLeftPoint(f,v);return new H(T,T.add(this.getSize()))},getPixelOrigin:function(){return this._checkIfLoaded(),this._pixelOrigin},getPixelWorldBounds:function(f){return this.options.crs.getProjectedBounds(f===void 0?this.getZoom():f)},getPane:function(f){return typeof f=="string"?this._panes[f]:f},getPanes:function(){return this._panes},getContainer:function(){return this._container},getZoomScale:function(f,v){var T=this.options.crs;return v=v===void 0?this._zoom:v,T.scale(f)/T.scale(v)},getScaleZoom:function(f,v){var T=this.options.crs;v=v===void 0?this._zoom:v;var A=T.zoom(f*T.scale(v));return isNaN(A)?1/0:A},project:function(f,v){return v=v===void 0?this._zoom:v,this.options.crs.latLngToPoint(de(f),v)},unproject:function(f,v){return v=v===void 0?this._zoom:v,this.options.crs.pointToLatLng(re(f),v)},layerPointToLatLng:function(f){var v=re(f).add(this.getPixelOrigin());return this.unproject(v)},latLngToLayerPoint:function(f){var v=this.project(de(f))._round();return v._subtract(this.getPixelOrigin())},wrapLatLng:function(f){return this.options.crs.wrapLatLng(de(f))},wrapLatLngBounds:function(f){return this.options.crs.wrapLatLngBounds(ce(f))},distance:function(f,v){return this.options.crs.distance(de(f),de(v))},containerPointToLayerPoint:function(f){return re(f).subtract(this._getMapPanePos())},layerPointToContainerPoint:function(f){return re(f).add(this._getMapPanePos())},containerPointToLatLng:function(f){var v=this.containerPointToLayerPoint(re(f));return this.layerPointToLatLng(v)},latLngToContainerPoint:function(f){return this.layerPointToContainerPoint(this.latLngToLayerPoint(de(f)))},mouseEventToContainerPoint:function(f){return fa(f,this._container)},mouseEventToLayerPoint:function(f){return this.containerPointToLayerPoint(this.mouseEventToContainerPoint(f))},mouseEventToLatLng:function(f){return this.layerPointToLatLng(this.mouseEventToLayerPoint(f))},_initContainer:function(f){var v=this._container=Fr(f);if(v){if(v._leaflet_id)throw new Error("Map container is already initialized.")}else throw new Error("Map container not found.");Ct(v,"scroll",this._onScroll,this),this._containerId=c(v)},_initLayout:function(){var f=this._container;this._fadeAnimated=this.options.fadeAnimation&&dt.any3d,Dt(f,"leaflet-container"+(dt.touch?" leaflet-touch":"")+(dt.retina?" leaflet-retina":"")+(dt.ielt9?" leaflet-oldie":"")+(dt.safari?" leaflet-safari":"")+(this._fadeAnimated?" leaflet-fade-anim":""));var v=oa(f,"position");v!=="absolute"&&v!=="relative"&&v!=="fixed"&&v!=="sticky"&&(f.style.position="relative"),this._initPanes(),this._initControlPos&&this._initControlPos()},_initPanes:function(){var f=this._panes={};this._paneRenderers={},this._mapPane=this.createPane("mapPane",this._container),An(this._mapPane,new $(0,0)),this.createPane("tilePane"),this.createPane("overlayPane"),this.createPane("shadowPane"),this.createPane("markerPane"),this.createPane("tooltipPane"),this.createPane("popupPane"),this.options.markerZoomAnimation||(Dt(f.markerPane,"leaflet-zoom-hide"),Dt(f.shadowPane,"leaflet-zoom-hide"))},_resetView:function(f,v,T){An(this._mapPane,new $(0,0));var A=!this._loaded;this._loaded=!0,v=this._limitZoom(v),this.fire("viewprereset");var V=this._zoom!==v;this._moveStart(V,T)._move(f,v)._moveEnd(V),this.fire("viewreset"),A&&this.fire("load")},_moveStart:function(f,v){return f&&this.fire("zoomstart"),v||this.fire("movestart"),this},_move:function(f,v,T,A){v===void 0&&(v=this._zoom);var V=this._zoom!==v;return this._zoom=v,this._lastCenter=f,this._pixelOrigin=this._getNewPixelOrigin(f),A?T&&T.pinch&&this.fire("zoom",T):((V||T&&T.pinch)&&this.fire("zoom",T),this.fire("move",T)),this},_moveEnd:function(f){return f&&this.fire("zoomend"),this.fire("moveend")},_stop:function(){return G(this._flyToFrame),this._panAnim&&this._panAnim.stop(),this},_rawPanBy:function(f){An(this._mapPane,this._getMapPanePos().subtract(f))},_getZoomSpan:function(){return this.getMaxZoom()-this.getMinZoom()},_panInsideMaxBounds:function(){this._enforcingBounds||this.panInsideBounds(this.options.maxBounds)},_checkIfLoaded:function(){if(!this._loaded)throw new Error("Set map center and zoom first.")},_initEvents:function(f){this._targets={},this._targets[c(this._container)]=this;var v=f?cn:Ct;v(this._container,"click dblclick mousedown mouseup mouseover mouseout mousemove contextmenu keypress keydown keyup",this._handleDOMEvent,this),this.options.trackResize&&v(window,"resize",this._onResize,this),dt.any3d&&this.options.transform3DLimit&&(f?this.off:this.on).call(this,"moveend",this._onMoveEnd)},_onResize:function(){G(this._resizeRequest),this._resizeRequest=W(function(){this.invalidateSize({debounceMoveend:!0})},this)},_onScroll:function(){this._container.scrollTop=0,this._container.scrollLeft=0},_onMoveEnd:function(){var f=this._getMapPanePos();Math.max(Math.abs(f.x),Math.abs(f.y))>=this.options.transform3DLimit&&this._resetView(this.getCenter(),this.getZoom())},_findEventTargets:function(f,v){for(var T=[],A,V=v==="mouseout"||v==="mouseover",Q=f.target||f.srcElement,pe=!1;Q;){if(A=this._targets[c(Q)],A&&(v==="click"||v==="preclick")&&this._draggableMoved(A)){pe=!0;break}if(A&&A.listens(v,!0)&&(V&&!ha(Q,f)||(T.push(A),V))||Q===this._container)break;Q=Q.parentNode}return!T.length&&!pe&&!V&&this.listens(v,!0)&&(T=[this]),T},_isClickDisabled:function(f){for(;f&&f!==this._container;){if(f._leaflet_disable_click)return!0;f=f.parentNode}},_handleDOMEvent:function(f){var v=f.target||f.srcElement;if(!(!this._loaded||v._leaflet_disable_events||f.type==="click"&&this._isClickDisabled(v))){var T=f.type;T==="mousedown"&&ki(v),this._fireDOMEvent(f,T)}},_mouseEvents:["click","dblclick","mouseover","mouseout","contextmenu"],_fireDOMEvent:function(f,v,T){if(f.type==="click"){var A=s({},f);A.type="preclick",this._fireDOMEvent(A,A.type,T)}var V=this._findEventTargets(f,v);if(T){for(var Q=[],pe=0;pe<T.length;pe++)T[pe].listens(v,!0)&&Q.push(T[pe]);V=Q.concat(V)}if(V.length){v==="contextmenu"&&Mn(f);var Ne=V[0],Ee={originalEvent:f};if(f.type!=="keypress"&&f.type!=="keydown"&&f.type!=="keyup"){var Be=Ne.getLatLng&&(!Ne._radius||Ne._radius<=10);Ee.containerPoint=Be?this.latLngToContainerPoint(Ne.getLatLng()):this.mouseEventToContainerPoint(f),Ee.layerPoint=this.containerPointToLayerPoint(Ee.containerPoint),Ee.latlng=Be?Ne.getLatLng():this.layerPointToLatLng(Ee.layerPoint)}for(pe=0;pe<V.length;pe++)if(V[pe].fire(v,Ee,!0),Ee.originalEvent._stopped||V[pe].options.bubblingMouseEvents===!1&&M(this._mouseEvents,v)!==-1)return}},_draggableMoved:function(f){return f=f.dragging&&f.dragging.enabled()?f:this,f.dragging&&f.dragging.moved()||this.boxZoom&&this.boxZoom.moved()},_clearHandlers:function(){for(var f=0,v=this._handlers.length;f<v;f++)this._handlers[f].disable()},whenReady:function(f,v){return this._loaded?f.call(v||this,{target:this}):this.on("load",f,v),this},_getMapPanePos:function(){return ms(this._mapPane)||new $(0,0)},_moved:function(){var f=this._getMapPanePos();return f&&!f.equals([0,0])},_getTopLeftPoint:function(f,v){var T=f&&v!==void 0?this._getNewPixelOrigin(f,v):this.getPixelOrigin();return T.subtract(this._getMapPanePos())},_getNewPixelOrigin:function(f,v){var T=this.getSize()._divideBy(2);return this.project(f,v)._subtract(T)._add(this._getMapPanePos())._round()},_latLngToNewLayerPoint:function(f,v,T){var A=this._getNewPixelOrigin(T,v);return this.project(f,v)._subtract(A)},_latLngBoundsToNewLayerBounds:function(f,v,T){var A=this._getNewPixelOrigin(T,v);return se([this.project(f.getSouthWest(),v)._subtract(A),this.project(f.getNorthWest(),v)._subtract(A),this.project(f.getSouthEast(),v)._subtract(A),this.project(f.getNorthEast(),v)._subtract(A)])},_getCenterLayerPoint:function(){return this.containerPointToLayerPoint(this.getSize()._divideBy(2))},_getCenterOffset:function(f){return this.latLngToLayerPoint(f).subtract(this._getCenterLayerPoint())},_limitCenter:function(f,v,T){if(!T)return f;var A=this.project(f,v),V=this.getSize().divideBy(2),Q=new H(A.subtract(V),A.add(V)),pe=this._getBoundsOffset(Q,T,v);return Math.abs(pe.x)<=1&&Math.abs(pe.y)<=1?f:this.unproject(A.add(pe),v)},_limitOffset:function(f,v){if(!v)return f;var T=this.getPixelBounds(),A=new H(T.min.add(f),T.max.add(f));return f.add(this._getBoundsOffset(A,v))},_getBoundsOffset:function(f,v,T){var A=se(this.project(v.getNorthEast(),T),this.project(v.getSouthWest(),T)),V=A.min.subtract(f.min),Q=A.max.subtract(f.max),pe=this._rebound(V.x,-Q.x),Ne=this._rebound(V.y,-Q.y);return new $(pe,Ne)},_rebound:function(f,v){return f+v>0?Math.round(f-v)/2:Math.max(0,Math.ceil(f))-Math.max(0,Math.floor(v))},_limitZoom:function(f){var v=this.getMinZoom(),T=this.getMaxZoom(),A=dt.any3d?this.options.zoomSnap:1;return A&&(f=Math.round(f/A)*A),Math.max(v,Math.min(T,f))},_onPanTransitionStep:function(){this.fire("move")},_onPanTransitionEnd:function(){xn(this._mapPane,"leaflet-pan-anim"),this.fire("moveend")},_tryAnimatedPan:function(f,v){var T=this._getCenterOffset(f)._trunc();return(v&&v.animate)!==!0&&!this.getSize().contains(T)?!1:(this.panBy(T,v),!0)},_createAnimProxy:function(){var f=this._proxy=Ot("div","leaflet-proxy leaflet-zoom-animated");this._panes.mapPane.appendChild(f),this.on("zoomanim",function(v){var T=Ao,A=this._proxy.style[T];qr(this._proxy,this.project(v.center,v.zoom),this.getZoomScale(v.zoom,1)),A===this._proxy.style[T]&&this._animatingZoom&&this._onZoomTransitionEnd()},this),this.on("load moveend",this._animMoveEnd,this),this._on("unload",this._destroyAnimProxy,this)},_destroyAnimProxy:function(){wn(this._proxy),this.off("load moveend",this._animMoveEnd,this),delete this._proxy},_animMoveEnd:function(){var f=this.getCenter(),v=this.getZoom();qr(this._proxy,this.project(f,v),this.getZoomScale(v,1))},_catchTransitionEnd:function(f){this._animatingZoom&&f.propertyName.indexOf("transform")>=0&&this._onZoomTransitionEnd()},_nothingToAnimate:function(){return!this._container.getElementsByClassName("leaflet-zoom-animated").length},_tryAnimatedZoom:function(f,v,T){if(this._animatingZoom)return!0;if(T=T||{},!this._zoomAnimated||T.animate===!1||this._nothingToAnimate()||Math.abs(v-this._zoom)>this.options.zoomAnimationThreshold)return!1;var A=this.getZoomScale(v),V=this._getCenterOffset(f)._divideBy(1-1/A);return T.animate!==!0&&!this.getSize().contains(V)?!1:(W(function(){this._moveStart(!0,T.noMoveStart||!1)._animateZoom(f,v,!0)},this),!0)},_animateZoom:function(f,v,T,A){this._mapPane&&(T&&(this._animatingZoom=!0,this._animateToCenter=f,this._animateToZoom=v,Dt(this._mapPane,"leaflet-zoom-anim")),this.fire("zoomanim",{center:f,zoom:v,noUpdate:A}),this._tempFireZoomEvent||(this._tempFireZoomEvent=this._zoom!==this._animateToZoom),this._move(this._animateToCenter,this._animateToZoom,void 0,!0),setTimeout(o(this._onZoomTransitionEnd,this),250))},_onZoomTransitionEnd:function(){this._animatingZoom&&(this._mapPane&&xn(this._mapPane,"leaflet-zoom-anim"),this._animatingZoom=!1,this._move(this._animateToCenter,this._animateToZoom,void 0,!0),this._tempFireZoomEvent&&this.fire("zoom"),delete this._tempFireZoomEvent,this.fire("move"),this._moveEnd(!0))}});function Es(f,v){return new Ht(f,v)}var wr=Y.extend({options:{position:"topright"},initialize:function(f){w(this,f)},getPosition:function(){return this.options.position},setPosition:function(f){var v=this._map;return v&&v.removeControl(this),this.options.position=f,v&&v.addControl(this),this},getContainer:function(){return this._container},addTo:function(f){this.remove(),this._map=f;var v=this._container=this.onAdd(f),T=this.getPosition(),A=f._controlCorners[T];return Dt(v,"leaflet-control"),T.indexOf("bottom")!==-1?A.insertBefore(v,A.firstChild):A.appendChild(v),this._map.on("unload",this.remove,this),this},remove:function(){return this._map?(wn(this._container),this.onRemove&&this.onRemove(this._map),this._map.off("unload",this.remove,this),this._map=null,this):this},_refocusOnMap:function(f){this._map&&f&&f.screenX>0&&f.screenY>0&&this._map.getContainer().focus()}}),Ds=function(f){return new wr(f)};Ht.include({addControl:function(f){return f.addTo(this),this},removeControl:function(f){return f.remove(),this},_initControlPos:function(){var f=this._controlCorners={},v="leaflet-",T=this._controlContainer=Ot("div",v+"control-container",this._container);function A(V,Q){var pe=v+V+" "+v+Q;f[V+Q]=Ot("div",pe,T)}A("top","left"),A("top","right"),A("bottom","left"),A("bottom","right")},_clearControlPos:function(){for(var f in this._controlCorners)wn(this._controlCorners[f]);wn(this._controlContainer),delete this._controlCorners,delete this._controlContainer}});var qo=wr.extend({options:{collapsed:!0,position:"topright",autoZIndex:!0,hideSingleBase:!1,sortLayers:!1,sortFunction:function(f,v,T,A){return T<A?-1:A<T?1:0}},initialize:function(f,v,T){w(this,T),this._layerControlInputs=[],this._layers=[],this._lastZIndex=0,this._handlingClick=!1,this._preventClick=!1;for(var A in f)this._addLayer(f[A],A);for(A in v)this._addLayer(v[A],A,!0)},onAdd:function(f){this._initLayout(),this._update(),this._map=f,f.on("zoomend",this._checkDisabledLayers,this);for(var v=0;v<this._layers.length;v++)this._layers[v].layer.on("add remove",this._onLayerChange,this);return this._container},addTo:function(f){return wr.prototype.addTo.call(this,f),this._expandIfNotCollapsed()},onRemove:function(){this._map.off("zoomend",this._checkDisabledLayers,this);for(var f=0;f<this._layers.length;f++)this._layers[f].layer.off("add remove",this._onLayerChange,this)},addBaseLayer:function(f,v){return this._addLayer(f,v),this._map?this._update():this},addOverlay:function(f,v){return this._addLayer(f,v,!0),this._map?this._update():this},removeLayer:function(f){f.off("add remove",this._onLayerChange,this);var v=this._getLayer(c(f));return v&&this._layers.splice(this._layers.indexOf(v),1),this._map?this._update():this},expand:function(){Dt(this._container,"leaflet-control-layers-expanded"),this._section.style.height=null;var f=this._map.getSize().y-(this._container.offsetTop+50);return f<this._section.clientHeight?(Dt(this._section,"leaflet-control-layers-scrollbar"),this._section.style.height=f+"px"):xn(this._section,"leaflet-control-layers-scrollbar"),this._checkDisabledLayers(),this},collapse:function(){return xn(this._container,"leaflet-control-layers-expanded"),this},_initLayout:function(){var f="leaflet-control-layers",v=this._container=Ot("div",f),T=this.options.collapsed;v.setAttribute("aria-haspopup",!0),ua(v),Ga(v);var A=this._section=Ot("section",f+"-list");T&&(this._map.on("click",this.collapse,this),Ct(v,{mouseenter:this._expandSafely,mouseleave:this.collapse},this));var V=this._layersLink=Ot("a",f+"-toggle",v);V.href="#",V.title="Layers",V.setAttribute("role","button"),Ct(V,{keydown:function(Q){Q.keyCode===13&&this._expandSafely()},click:function(Q){Mn(Q),this._expandSafely()}},this),T||this.expand(),this._baseLayersList=Ot("div",f+"-base",A),this._separator=Ot("div",f+"-separator",A),this._overlaysList=Ot("div",f+"-overlays",A),v.appendChild(A)},_getLayer:function(f){for(var v=0;v<this._layers.length;v++)if(this._layers[v]&&c(this._layers[v].layer)===f)return this._layers[v]},_addLayer:function(f,v,T){this._map&&f.on("add remove",this._onLayerChange,this),this._layers.push({layer:f,name:v,overlay:T}),this.options.sortLayers&&this._layers.sort(o(function(A,V){return this.options.sortFunction(A.layer,V.layer,A.name,V.name)},this)),this.options.autoZIndex&&f.setZIndex&&(this._lastZIndex++,f.setZIndex(this._lastZIndex)),this._expandIfNotCollapsed()},_update:function(){if(!this._container)return this;Ba(this._baseLayersList),Ba(this._overlaysList),this._layerControlInputs=[];var f,v,T,A,V=0;for(T=0;T<this._layers.length;T++)A=this._layers[T],this._addItem(A),v=v||A.overlay,f=f||!A.overlay,V+=A.overlay?0:1;return this.options.hideSingleBase&&(f=f&&V>1,this._baseLayersList.style.display=f?"":"none"),this._separator.style.display=v&&f?"":"none",this},_onLayerChange:function(f){this._handlingClick||this._update();var v=this._getLayer(c(f.target)),T=v.overlay?f.type==="add"?"overlayadd":"overlayremove":f.type==="add"?"baselayerchange":null;T&&this._map.fire(T,v)},_createRadioElement:function(f,v){var T='<input type="radio" class="leaflet-control-layers-selector" name="'+f+'"'+(v?' checked="checked"':"")+"/>",A=document.createElement("div");return A.innerHTML=T,A.firstChild},_addItem:function(f){var v=document.createElement("label"),T=this._map.hasLayer(f.layer),A;f.overlay?(A=document.createElement("input"),A.type="checkbox",A.className="leaflet-control-layers-selector",A.defaultChecked=T):A=this._createRadioElement("leaflet-base-layers_"+c(this),T),this._layerControlInputs.push(A),A.layerId=c(f.layer),Ct(A,"click",this._onInputClick,this);var V=document.createElement("span");V.innerHTML=" "+f.name;var Q=document.createElement("span");v.appendChild(Q),Q.appendChild(A),Q.appendChild(V);var pe=f.overlay?this._overlaysList:this._baseLayersList;return pe.appendChild(v),this._checkDisabledLayers(),v},_onInputClick:function(){if(!this._preventClick){var f=this._layerControlInputs,v,T,A=[],V=[];this._handlingClick=!0;for(var Q=f.length-1;Q>=0;Q--)v=f[Q],T=this._getLayer(v.layerId).layer,v.checked?A.push(T):v.checked||V.push(T);for(Q=0;Q<V.length;Q++)this._map.hasLayer(V[Q])&&this._map.removeLayer(V[Q]);for(Q=0;Q<A.length;Q++)this._map.hasLayer(A[Q])||this._map.addLayer(A[Q]);this._handlingClick=!1,this._refocusOnMap()}},_checkDisabledLayers:function(){for(var f=this._layerControlInputs,v,T,A=this._map.getZoom(),V=f.length-1;V>=0;V--)v=f[V],T=this._getLayer(v.layerId).layer,v.disabled=T.options.minZoom!==void 0&&A<T.options.minZoom||T.options.maxZoom!==void 0&&A>T.options.maxZoom},_expandIfNotCollapsed:function(){return this._map&&!this.options.collapsed&&this.expand(),this},_expandSafely:function(){var f=this._section;this._preventClick=!0,Ct(f,"click",Mn),this.expand();var v=this;setTimeout(function(){cn(f,"click",Mn),v._preventClick=!1})}}),Ja=function(f,v,T){return new qo(f,v,T)},Pi=wr.extend({options:{position:"topleft",zoomInText:'<span aria-hidden="true">+</span>',zoomInTitle:"Zoom in",zoomOutText:'<span aria-hidden="true">&#x2212;</span>',zoomOutTitle:"Zoom out"},onAdd:function(f){var v="leaflet-control-zoom",T=Ot("div",v+" leaflet-bar"),A=this.options;return this._zoomInButton=this._createButton(A.zoomInText,A.zoomInTitle,v+"-in",T,this._zoomIn),this._zoomOutButton=this._createButton(A.zoomOutText,A.zoomOutTitle,v+"-out",T,this._zoomOut),this._updateDisabled(),f.on("zoomend zoomlevelschange",this._updateDisabled,this),T},onRemove:function(f){f.off("zoomend zoomlevelschange",this._updateDisabled,this)},disable:function(){return this._disabled=!0,this._updateDisabled(),this},enable:function(){return this._disabled=!1,this._updateDisabled(),this},_zoomIn:function(f){!this._disabled&&this._map._zoom<this._map.getMaxZoom()&&this._map.zoomIn(this._map.options.zoomDelta*(f.shiftKey?3:1))},_zoomOut:function(f){!this._disabled&&this._map._zoom>this._map.getMinZoom()&&this._map.zoomOut(this._map.options.zoomDelta*(f.shiftKey?3:1))},_createButton:function(f,v,T,A,V){var Q=Ot("a",T,A);return Q.innerHTML=f,Q.href="#",Q.title=v,Q.setAttribute("role","button"),Q.setAttribute("aria-label",v),ua(Q),Ct(Q,"click",Ur),Ct(Q,"click",V,this),Ct(Q,"click",this._refocusOnMap,this),Q},_updateDisabled:function(){var f=this._map,v="leaflet-disabled";xn(this._zoomInButton,v),xn(this._zoomOutButton,v),this._zoomInButton.setAttribute("aria-disabled","false"),this._zoomOutButton.setAttribute("aria-disabled","false"),(this._disabled||f._zoom===f.getMinZoom())&&(Dt(this._zoomOutButton,v),this._zoomOutButton.setAttribute("aria-disabled","true")),(this._disabled||f._zoom===f.getMaxZoom())&&(Dt(this._zoomInButton,v),this._zoomInButton.setAttribute("aria-disabled","true"))}});Ht.mergeOptions({zoomControl:!0}),Ht.addInitHook(function(){this.options.zoomControl&&(this.zoomControl=new Pi,this.addControl(this.zoomControl))});var Bl=function(f){return new Pi(f)},hr=wr.extend({options:{position:"bottomleft",maxWidth:100,metric:!0,imperial:!0},onAdd:function(f){var v="leaflet-control-scale",T=Ot("div",v),A=this.options;return this._addScales(A,v+"-line",T),f.on(A.updateWhenIdle?"moveend":"move",this._update,this),f.whenReady(this._update,this),T},onRemove:function(f){f.off(this.options.updateWhenIdle?"moveend":"move",this._update,this)},_addScales:function(f,v,T){f.metric&&(this._mScale=Ot("div",v,T)),f.imperial&&(this._iScale=Ot("div",v,T))},_update:function(){var f=this._map,v=f.getSize().y/2,T=f.distance(f.containerPointToLatLng([0,v]),f.containerPointToLatLng([this.options.maxWidth,v]));this._updateScales(T)},_updateScales:function(f){this.options.metric&&f&&this._updateMetric(f),this.options.imperial&&f&&this._updateImperial(f)},_updateMetric:function(f){var v=this._getRoundNum(f),T=v<1e3?v+" m":v/1e3+" km";this._updateScale(this._mScale,T,v/f)},_updateImperial:function(f){var v=f*3.2808399,T,A,V;v>5280?(T=v/5280,A=this._getRoundNum(T),this._updateScale(this._iScale,A+" mi",A/T)):(V=this._getRoundNum(v),this._updateScale(this._iScale,V+" ft",V/v))},_updateScale:function(f,v,T){f.style.width=Math.round(this.options.maxWidth*T)+"px",f.innerHTML=v},_getRoundNum:function(f){var v=Math.pow(10,(Math.floor(f)+"").length-1),T=f/v;return T=T>=10?10:T>=5?5:T>=3?3:T>=2?2:1,v*T}}),Mi=function(f){return new hr(f)},zo='<svg aria-hidden="true" xmlns="http://www.w3.org/2000/svg" width="12" height="8" viewBox="0 0 12 8" class="leaflet-attribution-flag"><path fill="#4C7BE1" d="M0 0h12v4H0z"/><path fill="#FFD500" d="M0 4h12v3H0z"/><path fill="#E0BC00" d="M0 7h12v1H0z"/></svg>',ri=wr.extend({options:{position:"bottomright",prefix:'<a href="https://leafletjs.com" title="A JavaScript library for interactive maps">'+(dt.inlineSvg?zo+" ":"")+"Leaflet</a>"},initialize:function(f){w(this,f),this._attributions={}},onAdd:function(f){f.attributionControl=this,this._container=Ot("div","leaflet-control-attribution"),ua(this._container);for(var v in f._layers)f._layers[v].getAttribution&&this.addAttribution(f._layers[v].getAttribution());return this._update(),f.on("layeradd",this._addAttribution,this),this._container},onRemove:function(f){f.off("layeradd",this._addAttribution,this)},_addAttribution:function(f){f.layer.getAttribution&&(this.addAttribution(f.layer.getAttribution()),f.layer.once("remove",function(){this.removeAttribution(f.layer.getAttribution())},this))},setPrefix:function(f){return this.options.prefix=f,this._update(),this},addAttribution:function(f){return f?(this._attributions[f]||(this._attributions[f]=0),this._attributions[f]++,this._update(),this):this},removeAttribution:function(f){return f?(this._attributions[f]&&(this._attributions[f]--,this._update()),this):this},_update:function(){if(this._map){var f=[];for(var v in this._attributions)this._attributions[v]&&f.push(v);var T=[];this.options.prefix&&T.push(this.options.prefix),f.length&&T.push(f.join(", ")),this._container.innerHTML=T.join(' <span aria-hidden="true">|</span> ')}}});Ht.mergeOptions({attributionControl:!0}),Ht.addInitHook(function(){this.options.attributionControl&&new ri().addTo(this)});var xd=function(f){return new ri(f)};wr.Layers=qo,wr.Zoom=Pi,wr.Scale=hr,wr.Attribution=ri,Ds.layers=Ja,Ds.zoom=Bl,Ds.scale=Mi,Ds.attribution=xd;var Mr=Y.extend({initialize:function(f){this._map=f},enable:function(){return this._enabled?this:(this._enabled=!0,this.addHooks(),this)},disable:function(){return this._enabled?(this._enabled=!1,this.removeHooks(),this):this},enabled:function(){return!!this._enabled}});Mr.addTo=function(f,v){return f.addHandler(v,this),this};var Uo={Events:ee},Ei=dt.touch?"touchstart mousedown":"mousedown",Br=me.extend({options:{clickTolerance:3},initialize:function(f,v,T,A){w(this,A),this._element=f,this._dragStartTarget=v||f,this._preventOutline=T},enable:function(){this._enabled||(Ct(this._dragStartTarget,Ei,this._onDown,this),this._enabled=!0)},disable:function(){this._enabled&&(Br._dragging===this&&this.finishDrag(!0),cn(this._dragStartTarget,Ei,this._onDown,this),this._enabled=!1,this._moved=!1)},_onDown:function(f){if(this._enabled&&(this._moved=!1,!Si(this._element,"leaflet-zoom-anim"))){if(f.touches&&f.touches.length!==1){Br._dragging===this&&this.finishDrag();return}if(!(Br._dragging||f.shiftKey||f.which!==1&&f.button!==1&&!f.touches)&&(Br._dragging=this,this._preventOutline&&ki(this._element),$a(),Kt(),!this._moving)){this.fire("down");var v=f.touches?f.touches[0]:f,T=ps(this._element);this._startPoint=new $(v.clientX,v.clientY),this._startPos=ms(this._element),this._parentScale=Qr(T);var A=f.type==="mousedown";Ct(document,A?"mousemove":"touchmove",this._onMove,this),Ct(document,A?"mouseup":"touchend touchcancel",this._onUp,this)}}},_onMove:function(f){if(this._enabled){if(f.touches&&f.touches.length>1){this._moved=!0;return}var v=f.touches&&f.touches.length===1?f.touches[0]:f,T=new $(v.clientX,v.clientY)._subtract(this._startPoint);!T.x&&!T.y||Math.abs(T.x)+Math.abs(T.y)<this.options.clickTolerance||(T.x/=this._parentScale.x,T.y/=this._parentScale.y,Mn(f),this._moved||(this.fire("dragstart"),this._moved=!0,Dt(document.body,"leaflet-dragging"),this._lastTarget=f.target||f.srcElement,window.SVGElementInstance&&this._lastTarget instanceof window.SVGElementInstance&&(this._lastTarget=this._lastTarget.correspondingUseElement),Dt(this._lastTarget,"leaflet-drag-target")),this._newPos=this._startPos.add(T),this._moving=!0,this._lastEvent=f,this._updatePosition())}},_updatePosition:function(){var f={originalEvent:this._lastEvent};this.fire("predrag",f),An(this._element,this._newPos),this.fire("drag",f)},_onUp:function(){this._enabled&&this.finishDrag()},finishDrag:function(f){xn(document.body,"leaflet-dragging"),this._lastTarget&&(xn(this._lastTarget,"leaflet-drag-target"),this._lastTarget=null),cn(document,"mousemove touchmove",this._onMove,this),cn(document,"mouseup touchend touchcancel",this._onUp,this),Ha(),Ti();var v=this._moved&&this._moving;this._moving=!1,Br._dragging=!1,v&&this.fire("dragend",{noInertia:f,distance:this._newPos.distanceTo(this._startPos)})}});function Bo(f,v,T){var A,V=[1,4,2,8],Q,pe,Ne,Ee,Be,rt,Nt,$t;for(Q=0,rt=f.length;Q<rt;Q++)f[Q]._code=si(f[Q],v);for(Ne=0;Ne<4;Ne++){for(Nt=V[Ne],A=[],Q=0,rt=f.length,pe=rt-1;Q<rt;pe=Q++)Ee=f[Q],Be=f[pe],Ee._code&Nt?Be._code&Nt||($t=Xa(Be,Ee,Nt,v,T),$t._code=si($t,v),A.push($t)):(Be._code&Nt&&($t=Xa(Be,Ee,Nt,v,T),$t._code=si($t,v),A.push($t)),A.push(Ee));f=A}return f}function Vl(f,v){var T,A,V,Q,pe,Ne,Ee,Be,rt;if(!f||f.length===0)throw new Error("latlngs not passed");Er(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var Nt=de([0,0]),$t=ce(f),jr=$t.getNorthWest().distanceTo($t.getSouthWest())*$t.getNorthEast().distanceTo($t.getNorthWest());jr<1700&&(Nt=Vo(f));var mr=f.length,vs=[];for(T=0;T<mr;T++){var ts=de(f[T]);vs.push(v.project(de([ts.lat-Nt.lat,ts.lng-Nt.lng])))}for(Ne=Ee=Be=0,T=0,A=mr-1;T<mr;A=T++)V=vs[T],Q=vs[A],pe=V.y*Q.x-Q.y*V.x,Ee+=(V.x+Q.x)*pe,Be+=(V.y+Q.y)*pe,Ne+=pe*3;Ne===0?rt=vs[0]:rt=[Ee/Ne,Be/Ne];var lc=v.unproject(re(rt));return de([lc.lat+Nt.lat,lc.lng+Nt.lng])}function Vo(f){for(var v=0,T=0,A=0,V=0;V<f.length;V++){var Q=de(f[V]);v+=Q.lat,T+=Q.lng,A++}return de([v/A,T/A])}var yd={__proto__:null,clipPolygon:Bo,polygonCenter:Vl,centroid:Vo};function Qa(f,v){if(!v||!f.length)return f.slice();var T=v*v;return f=wd(f,T),f=bd(f,T),f}function Wl(f,v,T){return Math.sqrt(ii(f,v,T,!0))}function vd(f,v,T){return ii(f,v,T)}function bd(f,v){var T=f.length,A=typeof Uint8Array<"u"?Uint8Array:Array,V=new A(T);V[0]=V[T-1]=1,Wo(f,V,v,0,T-1);var Q,pe=[];for(Q=0;Q<T;Q++)V[Q]&&pe.push(f[Q]);return pe}function Wo(f,v,T,A,V){var Q=0,pe,Ne,Ee;for(Ne=A+1;Ne<=V-1;Ne++)Ee=ii(f[Ne],f[A],f[V],!0),Ee>Q&&(pe=Ne,Q=Ee);Q>T&&(v[pe]=1,Wo(f,v,T,A,pe),Wo(f,v,T,pe,V))}function wd(f,v){for(var T=[f[0]],A=1,V=0,Q=f.length;A<Q;A++)_d(f[A],f[V])>v&&(T.push(f[A]),V=A);return V<Q-1&&T.push(f[Q-1]),T}var $o;function $l(f,v,T,A,V){var Q=A?$o:si(f,T),pe=si(v,T),Ne,Ee,Be;for($o=pe;;){if(!(Q|pe))return[f,v];if(Q&pe)return!1;Ne=Q||pe,Ee=Xa(f,v,Ne,T,V),Be=si(Ee,T),Ne===Q?(f=Ee,Q=Be):(v=Ee,pe=Be)}}function Xa(f,v,T,A,V){var Q=v.x-f.x,pe=v.y-f.y,Ne=A.min,Ee=A.max,Be,rt;return T&8?(Be=f.x+Q*(Ee.y-f.y)/pe,rt=Ee.y):T&4?(Be=f.x+Q*(Ne.y-f.y)/pe,rt=Ne.y):T&2?(Be=Ee.x,rt=f.y+pe*(Ee.x-f.x)/Q):T&1&&(Be=Ne.x,rt=f.y+pe*(Ne.x-f.x)/Q),new $(Be,rt,V)}function si(f,v){var T=0;return f.x<v.min.x?T|=1:f.x>v.max.x&&(T|=2),f.y<v.min.y?T|=4:f.y>v.max.y&&(T|=8),T}function _d(f,v){var T=v.x-f.x,A=v.y-f.y;return T*T+A*A}function ii(f,v,T,A){var V=v.x,Q=v.y,pe=T.x-V,Ne=T.y-Q,Ee=pe*pe+Ne*Ne,Be;return Ee>0&&(Be=((f.x-V)*pe+(f.y-Q)*Ne)/Ee,Be>1?(V=T.x,Q=T.y):Be>0&&(V+=pe*Be,Q+=Ne*Be)),pe=f.x-V,Ne=f.y-Q,A?pe*pe+Ne*Ne:new $(V,Q)}function Er(f){return!O(f[0])||typeof f[0][0]!="object"&&typeof f[0][0]<"u"}function Hl(f){return console.warn("Deprecated use of _flat, please use L.LineUtil.isFlat instead."),Er(f)}function Yl(f,v){var T,A,V,Q,pe,Ne,Ee,Be;if(!f||f.length===0)throw new Error("latlngs not passed");Er(f)||(console.warn("latlngs are not flat! Only the first ring will be used"),f=f[0]);var rt=de([0,0]),Nt=ce(f),$t=Nt.getNorthWest().distanceTo(Nt.getSouthWest())*Nt.getNorthEast().distanceTo(Nt.getNorthWest());$t<1700&&(rt=Vo(f));var jr=f.length,mr=[];for(T=0;T<jr;T++){var vs=de(f[T]);mr.push(v.project(de([vs.lat-rt.lat,vs.lng-rt.lng])))}for(T=0,A=0;T<jr-1;T++)A+=mr[T].distanceTo(mr[T+1])/2;if(A===0)Be=mr[0];else for(T=0,Q=0;T<jr-1;T++)if(pe=mr[T],Ne=mr[T+1],V=pe.distanceTo(Ne),Q+=V,Q>A){Ee=(Q-A)/V,Be=[Ne.x-Ee*(Ne.x-pe.x),Ne.y-Ee*(Ne.y-pe.y)];break}var ts=v.unproject(re(Be));return de([ts.lat+rt.lat,ts.lng+rt.lng])}var Gl={__proto__:null,simplify:Qa,pointToSegmentDistance:Wl,closestPointOnSegment:vd,clipSegment:$l,_getEdgeIntersection:Xa,_getBitCode:si,_sqClosestPointOnSegment:ii,isFlat:Er,_flat:Hl,polylineCenter:Yl},Ho={project:function(f){return new $(f.lng,f.lat)},unproject:function(f){return new oe(f.y,f.x)},bounds:new H([-180,-90],[180,90])},Yo={R:6378137,R_MINOR:6356752314245179e-9,bounds:new H([-2003750834279e-5,-1549657073972e-5],[2003750834279e-5,1876465623138e-5]),project:function(f){var v=Math.PI/180,T=this.R,A=f.lat*v,V=this.R_MINOR/T,Q=Math.sqrt(1-V*V),pe=Q*Math.sin(A),Ne=Math.tan(Math.PI/4-A/2)/Math.pow((1-pe)/(1+pe),Q/2);return A=-T*Math.log(Math.max(Ne,1e-10)),new $(f.lng*v*T,A)},unproject:function(f){for(var v=180/Math.PI,T=this.R,A=this.R_MINOR/T,V=Math.sqrt(1-A*A),Q=Math.exp(-f.y/T),pe=Math.PI/2-2*Math.atan(Q),Ne=0,Ee=.1,Be;Ne<15&&Math.abs(Ee)>1e-7;Ne++)Be=V*Math.sin(pe),Be=Math.pow((1-Be)/(1+Be),V/2),Ee=Math.PI/2-2*Math.atan(Q*Be)-pe,pe+=Ee;return new oe(pe*v,f.x*v/T)}},jd={__proto__:null,LonLat:Ho,Mercator:Yo,SphericalMercator:Re},Nd=s({},ye,{code:"EPSG:3395",projection:Yo,transformation:(function(){var f=.5/(Math.PI*Yo.R);return je(f,.5,-f,.5)})()}),Zl=s({},ye,{code:"EPSG:4326",projection:Ho,transformation:je(1/180,1,-1/180,.5)}),Sd=s({},te,{projection:Ho,transformation:je(1,0,-1,0),scale:function(f){return Math.pow(2,f)},zoom:function(f){return Math.log(f)/Math.LN2},distance:function(f,v){var T=v.lng-f.lng,A=v.lat-f.lat;return Math.sqrt(T*T+A*A)},infinite:!0});te.Earth=ye,te.EPSG3395=Nd,te.EPSG3857=ke,te.EPSG900913=Ue,te.EPSG4326=Zl,te.Simple=Sd;var Vr=me.extend({options:{pane:"overlayPane",attribution:null,bubblingMouseEvents:!0},addTo:function(f){return f.addLayer(this),this},remove:function(){return this.removeFrom(this._map||this._mapToAdd)},removeFrom:function(f){return f&&f.removeLayer(this),this},getPane:function(f){return this._map.getPane(f?this.options[f]||f:this.options.pane)},addInteractiveTarget:function(f){return this._map._targets[c(f)]=this,this},removeInteractiveTarget:function(f){return delete this._map._targets[c(f)],this},getAttribution:function(){return this.options.attribution},_layerAdd:function(f){var v=f.target;if(v.hasLayer(this)){if(this._map=v,this._zoomAnimated=v._zoomAnimated,this.getEvents){var T=this.getEvents();v.on(T,this),this.once("remove",function(){v.off(T,this)},this)}this.onAdd(v),this.fire("add"),v.fire("layeradd",{layer:this})}}});Ht.include({addLayer:function(f){if(!f._layerAdd)throw new Error("The provided object is not a Layer.");var v=c(f);return this._layers[v]?this:(this._layers[v]=f,f._mapToAdd=this,f.beforeAdd&&f.beforeAdd(this),this.whenReady(f._layerAdd,f),this)},removeLayer:function(f){var v=c(f);return this._layers[v]?(this._loaded&&f.onRemove(this),delete this._layers[v],this._loaded&&(this.fire("layerremove",{layer:f}),f.fire("remove")),f._map=f._mapToAdd=null,this):this},hasLayer:function(f){return c(f)in this._layers},eachLayer:function(f,v){for(var T in this._layers)f.call(v,this._layers[T]);return this},_addLayers:function(f){f=f?O(f)?f:[f]:[];for(var v=0,T=f.length;v<T;v++)this.addLayer(f[v])},_addZoomLimit:function(f){(!isNaN(f.options.maxZoom)||!isNaN(f.options.minZoom))&&(this._zoomBoundLayers[c(f)]=f,this._updateZoomLevels())},_removeZoomLimit:function(f){var v=c(f);this._zoomBoundLayers[v]&&(delete this._zoomBoundLayers[v],this._updateZoomLevels())},_updateZoomLevels:function(){var f=1/0,v=-1/0,T=this._getZoomSpan();for(var A in this._zoomBoundLayers){var V=this._zoomBoundLayers[A].options;f=V.minZoom===void 0?f:Math.min(f,V.minZoom),v=V.maxZoom===void 0?v:Math.max(v,V.maxZoom)}this._layersMaxZoom=v===-1/0?void 0:v,this._layersMinZoom=f===1/0?void 0:f,T!==this._getZoomSpan()&&this.fire("zoomlevelschange"),this.options.maxZoom===void 0&&this._layersMaxZoom&&this.getZoom()>this._layersMaxZoom&&this.setZoom(this._layersMaxZoom),this.options.minZoom===void 0&&this._layersMinZoom&&this.getZoom()<this._layersMinZoom&&this.setZoom(this._layersMinZoom)}});var Os=Vr.extend({initialize:function(f,v){w(this,v),this._layers={};var T,A;if(f)for(T=0,A=f.length;T<A;T++)this.addLayer(f[T])},addLayer:function(f){var v=this.getLayerId(f);return this._layers[v]=f,this._map&&this._map.addLayer(f),this},removeLayer:function(f){var v=f in this._layers?f:this.getLayerId(f);return this._map&&this._layers[v]&&this._map.removeLayer(this._layers[v]),delete this._layers[v],this},hasLayer:function(f){var v=typeof f=="number"?f:this.getLayerId(f);return v in this._layers},clearLayers:function(){return this.eachLayer(this.removeLayer,this)},invoke:function(f){var v=Array.prototype.slice.call(arguments,1),T,A;for(T in this._layers)A=this._layers[T],A[f]&&A[f].apply(A,v);return this},onAdd:function(f){this.eachLayer(f.addLayer,f)},onRemove:function(f){this.eachLayer(f.removeLayer,f)},eachLayer:function(f,v){for(var T in this._layers)f.call(v,this._layers[T]);return this},getLayer:function(f){return this._layers[f]},getLayers:function(){var f=[];return this.eachLayer(f.push,f),f},setZIndex:function(f){return this.invoke("setZIndex",f)},getLayerId:function(f){return c(f)}}),ma=function(f,v){return new Os(f,v)},gs=Os.extend({addLayer:function(f){return this.hasLayer(f)?this:(f.addEventParent(this),Os.prototype.addLayer.call(this,f),this.fire("layeradd",{layer:f}))},removeLayer:function(f){return this.hasLayer(f)?(f in this._layers&&(f=this._layers[f]),f.removeEventParent(this),Os.prototype.removeLayer.call(this,f),this.fire("layerremove",{layer:f})):this},setStyle:function(f){return this.invoke("setStyle",f)},bringToFront:function(){return this.invoke("bringToFront")},bringToBack:function(){return this.invoke("bringToBack")},getBounds:function(){var f=new ie;for(var v in this._layers){var T=this._layers[v];f.extend(T.getBounds?T.getBounds():T.getLatLng())}return f}}),Kl=function(f,v){return new gs(f,v)},ai=Y.extend({options:{popupAnchor:[0,0],tooltipAnchor:[0,0],crossOrigin:!1},initialize:function(f){w(this,f)},createIcon:function(f){return this._createIcon("icon",f)},createShadow:function(f){return this._createIcon("shadow",f)},_createIcon:function(f,v){var T=this._getIconUrl(f);if(!T){if(f==="icon")throw new Error("iconUrl not set in Icon options (see the docs).");return null}var A=this._createImg(T,v&&v.tagName==="IMG"?v:null);return this._setIconStyles(A,f),(this.options.crossOrigin||this.options.crossOrigin==="")&&(A.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),A},_setIconStyles:function(f,v){var T=this.options,A=T[v+"Size"];typeof A=="number"&&(A=[A,A]);var V=re(A),Q=re(v==="shadow"&&T.shadowAnchor||T.iconAnchor||V&&V.divideBy(2,!0));f.className="leaflet-marker-"+v+" "+(T.className||""),Q&&(f.style.marginLeft=-Q.x+"px",f.style.marginTop=-Q.y+"px"),V&&(f.style.width=V.x+"px",f.style.height=V.y+"px")},_createImg:function(f,v){return v=v||document.createElement("img"),v.src=f,v},_getIconUrl:function(f){return dt.retina&&this.options[f+"RetinaUrl"]||this.options[f+"Url"]}});function Jl(f){return new ai(f)}var Di=ai.extend({options:{iconUrl:"marker-icon.png",iconRetinaUrl:"marker-icon-2x.png",shadowUrl:"marker-shadow.png",iconSize:[25,41],iconAnchor:[12,41],popupAnchor:[1,-34],tooltipAnchor:[16,-28],shadowSize:[41,41]},_getIconUrl:function(f){return typeof Di.imagePath!="string"&&(Di.imagePath=this._detectIconPath()),(this.options.imagePath||Di.imagePath)+ai.prototype._getIconUrl.call(this,f)},_stripUrl:function(f){var v=function(T,A,V){var Q=A.exec(T);return Q&&Q[V]};return f=v(f,/^url\((['"])?(.+)\1\)$/,2),f&&v(f,/^(.*)marker-icon\.png$/,1)},_detectIconPath:function(){var f=Ot("div","leaflet-default-icon-path",document.body),v=oa(f,"background-image")||oa(f,"backgroundImage");if(document.body.removeChild(f),v=this._stripUrl(v),v)return v;var T=document.querySelector('link[href$="leaflet.css"]');return T?T.href.substring(0,T.href.length-11-1):""}}),Go=Mr.extend({initialize:function(f){this._marker=f},addHooks:function(){var f=this._marker._icon;this._draggable||(this._draggable=new Br(f,f,!0)),this._draggable.on({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).enable(),Dt(f,"leaflet-marker-draggable")},removeHooks:function(){this._draggable.off({dragstart:this._onDragStart,predrag:this._onPreDrag,drag:this._onDrag,dragend:this._onDragEnd},this).disable(),this._marker._icon&&xn(this._marker._icon,"leaflet-marker-draggable")},moved:function(){return this._draggable&&this._draggable._moved},_adjustPan:function(f){var v=this._marker,T=v._map,A=this._marker.options.autoPanSpeed,V=this._marker.options.autoPanPadding,Q=ms(v._icon),pe=T.getPixelBounds(),Ne=T.getPixelOrigin(),Ee=se(pe.min._subtract(Ne).add(V),pe.max._subtract(Ne).subtract(V));if(!Ee.contains(Q)){var Be=re((Math.max(Ee.max.x,Q.x)-Ee.max.x)/(pe.max.x-Ee.max.x)-(Math.min(Ee.min.x,Q.x)-Ee.min.x)/(pe.min.x-Ee.min.x),(Math.max(Ee.max.y,Q.y)-Ee.max.y)/(pe.max.y-Ee.max.y)-(Math.min(Ee.min.y,Q.y)-Ee.min.y)/(pe.min.y-Ee.min.y)).multiplyBy(A);T.panBy(Be,{animate:!1}),this._draggable._newPos._add(Be),this._draggable._startPos._add(Be),An(v._icon,this._draggable._newPos),this._onDrag(f),this._panRequest=W(this._adjustPan.bind(this,f))}},_onDragStart:function(){this._oldLatLng=this._marker.getLatLng(),this._marker.closePopup&&this._marker.closePopup(),this._marker.fire("movestart").fire("dragstart")},_onPreDrag:function(f){this._marker.options.autoPan&&(G(this._panRequest),this._panRequest=W(this._adjustPan.bind(this,f)))},_onDrag:function(f){var v=this._marker,T=v._shadow,A=ms(v._icon),V=v._map.layerPointToLatLng(A);T&&An(T,A),v._latlng=V,f.latlng=V,f.oldLatLng=this._oldLatLng,v.fire("move",f).fire("drag",f)},_onDragEnd:function(f){G(this._panRequest),delete this._oldLatLng,this._marker.fire("moveend").fire("dragend",f)}}),xs=Vr.extend({options:{icon:new Di,interactive:!0,keyboard:!0,title:"",alt:"Marker",zIndexOffset:0,opacity:1,riseOnHover:!1,riseOffset:250,pane:"markerPane",shadowPane:"shadowPane",bubblingMouseEvents:!1,autoPanOnFocus:!0,draggable:!1,autoPan:!1,autoPanPadding:[50,50],autoPanSpeed:10},initialize:function(f,v){w(this,v),this._latlng=de(f)},onAdd:function(f){this._zoomAnimated=this._zoomAnimated&&f.options.markerZoomAnimation,this._zoomAnimated&&f.on("zoomanim",this._animateZoom,this),this._initIcon(),this.update()},onRemove:function(f){this.dragging&&this.dragging.enabled()&&(this.options.draggable=!0,this.dragging.removeHooks()),delete this.dragging,this._zoomAnimated&&f.off("zoomanim",this._animateZoom,this),this._removeIcon(),this._removeShadow()},getEvents:function(){return{zoom:this.update,viewreset:this.update}},getLatLng:function(){return this._latlng},setLatLng:function(f){var v=this._latlng;return this._latlng=de(f),this.update(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},setZIndexOffset:function(f){return this.options.zIndexOffset=f,this.update()},getIcon:function(){return this.options.icon},setIcon:function(f){return this.options.icon=f,this._map&&(this._initIcon(),this.update()),this._popup&&this.bindPopup(this._popup,this._popup.options),this},getElement:function(){return this._icon},update:function(){if(this._icon&&this._map){var f=this._map.latLngToLayerPoint(this._latlng).round();this._setPos(f)}return this},_initIcon:function(){var f=this.options,v="leaflet-zoom-"+(this._zoomAnimated?"animated":"hide"),T=f.icon.createIcon(this._icon),A=!1;T!==this._icon&&(this._icon&&this._removeIcon(),A=!0,f.title&&(T.title=f.title),T.tagName==="IMG"&&(T.alt=f.alt||"")),Dt(T,v),f.keyboard&&(T.tabIndex="0",T.setAttribute("role","button")),this._icon=T,f.riseOnHover&&this.on({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&Ct(T,"focus",this._panOnFocus,this);var V=f.icon.createShadow(this._shadow),Q=!1;V!==this._shadow&&(this._removeShadow(),Q=!0),V&&(Dt(V,v),V.alt=""),this._shadow=V,f.opacity<1&&this._updateOpacity(),A&&this.getPane().appendChild(this._icon),this._initInteraction(),V&&Q&&this.getPane(f.shadowPane).appendChild(this._shadow)},_removeIcon:function(){this.options.riseOnHover&&this.off({mouseover:this._bringToFront,mouseout:this._resetZIndex}),this.options.autoPanOnFocus&&cn(this._icon,"focus",this._panOnFocus,this),wn(this._icon),this.removeInteractiveTarget(this._icon),this._icon=null},_removeShadow:function(){this._shadow&&wn(this._shadow),this._shadow=null},_setPos:function(f){this._icon&&An(this._icon,f),this._shadow&&An(this._shadow,f),this._zIndex=f.y+this.options.zIndexOffset,this._resetZIndex()},_updateZIndex:function(f){this._icon&&(this._icon.style.zIndex=this._zIndex+f)},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center).round();this._setPos(v)},_initInteraction:function(){if(this.options.interactive&&(Dt(this._icon,"leaflet-interactive"),this.addInteractiveTarget(this._icon),Go)){var f=this.options.draggable;this.dragging&&(f=this.dragging.enabled(),this.dragging.disable()),this.dragging=new Go(this),f&&this.dragging.enable()}},setOpacity:function(f){return this.options.opacity=f,this._map&&this._updateOpacity(),this},_updateOpacity:function(){var f=this.options.opacity;this._icon&&fr(this._icon,f),this._shadow&&fr(this._shadow,f)},_bringToFront:function(){this._updateZIndex(this.options.riseOffset)},_resetZIndex:function(){this._updateZIndex(0)},_panOnFocus:function(){var f=this._map;if(f){var v=this.options.icon.options,T=v.iconSize?re(v.iconSize):re(0,0),A=v.iconAnchor?re(v.iconAnchor):re(0,0);f.panInside(this._latlng,{paddingTopLeft:A,paddingBottomRight:T.subtract(A)})}},_getPopupAnchor:function(){return this.options.icon.options.popupAnchor},_getTooltipAnchor:function(){return this.options.icon.options.tooltipAnchor}});function Cd(f,v){return new xs(f,v)}var Is=Vr.extend({options:{stroke:!0,color:"#3388ff",weight:3,opacity:1,lineCap:"round",lineJoin:"round",dashArray:null,dashOffset:null,fill:!1,fillColor:null,fillOpacity:.2,fillRule:"evenodd",interactive:!0,bubblingMouseEvents:!0},beforeAdd:function(f){this._renderer=f.getRenderer(this)},onAdd:function(){this._renderer._initPath(this),this._reset(),this._renderer._addPath(this)},onRemove:function(){this._renderer._removePath(this)},redraw:function(){return this._map&&this._renderer._updatePath(this),this},setStyle:function(f){return w(this,f),this._renderer&&(this._renderer._updateStyle(this),this.options.stroke&&f&&Object.prototype.hasOwnProperty.call(f,"weight")&&this._updateBounds()),this},bringToFront:function(){return this._renderer&&this._renderer._bringToFront(this),this},bringToBack:function(){return this._renderer&&this._renderer._bringToBack(this),this},getElement:function(){return this._path},_reset:function(){this._project(),this._update()},_clickTolerance:function(){return(this.options.stroke?this.options.weight/2:0)+(this._renderer.options.tolerance||0)}}),eo=Is.extend({options:{fill:!0,radius:10},initialize:function(f,v){w(this,v),this._latlng=de(f),this._radius=this.options.radius},setLatLng:function(f){var v=this._latlng;return this._latlng=de(f),this.redraw(),this.fire("move",{oldLatLng:v,latlng:this._latlng})},getLatLng:function(){return this._latlng},setRadius:function(f){return this.options.radius=this._radius=f,this.redraw()},getRadius:function(){return this._radius},setStyle:function(f){var v=f&&f.radius||this._radius;return Is.prototype.setStyle.call(this,f),this.setRadius(v),this},_project:function(){this._point=this._map.latLngToLayerPoint(this._latlng),this._updateBounds()},_updateBounds:function(){var f=this._radius,v=this._radiusY||f,T=this._clickTolerance(),A=[f+T,v+T];this._pxBounds=new H(this._point.subtract(A),this._point.add(A))},_update:function(){this._map&&this._updatePath()},_updatePath:function(){this._renderer._updateCircle(this)},_empty:function(){return this._radius&&!this._renderer._bounds.intersects(this._pxBounds)},_containsPoint:function(f){return f.distanceTo(this._point)<=this._radius+this._clickTolerance()}});function Ql(f,v){return new eo(f,v)}var to=eo.extend({initialize:function(f,v,T){if(typeof v=="number"&&(v=s({},T,{radius:v})),w(this,v),this._latlng=de(f),isNaN(this.options.radius))throw new Error("Circle radius cannot be NaN");this._mRadius=this.options.radius},setRadius:function(f){return this._mRadius=f,this.redraw()},getRadius:function(){return this._mRadius},getBounds:function(){var f=[this._radius,this._radiusY||this._radius];return new ie(this._map.layerPointToLatLng(this._point.subtract(f)),this._map.layerPointToLatLng(this._point.add(f)))},setStyle:Is.prototype.setStyle,_project:function(){var f=this._latlng.lng,v=this._latlng.lat,T=this._map,A=T.options.crs;if(A.distance===ye.distance){var V=Math.PI/180,Q=this._mRadius/ye.R/V,pe=T.project([v+Q,f]),Ne=T.project([v-Q,f]),Ee=pe.add(Ne).divideBy(2),Be=T.unproject(Ee).lat,rt=Math.acos((Math.cos(Q*V)-Math.sin(v*V)*Math.sin(Be*V))/(Math.cos(v*V)*Math.cos(Be*V)))/V;(isNaN(rt)||rt===0)&&(rt=Q/Math.cos(Math.PI/180*v)),this._point=Ee.subtract(T.getPixelOrigin()),this._radius=isNaN(rt)?0:Ee.x-T.project([Be,f-rt]).x,this._radiusY=Ee.y-pe.y}else{var Nt=A.unproject(A.project(this._latlng).subtract([this._mRadius,0]));this._point=T.latLngToLayerPoint(this._latlng),this._radius=this._point.x-T.latLngToLayerPoint(Nt).x}this._updateBounds()}});function pa(f,v,T){return new to(f,v,T)}var _r=Is.extend({options:{smoothFactor:1,noClip:!1},initialize:function(f,v){w(this,v),this._setLatLngs(f)},getLatLngs:function(){return this._latlngs},setLatLngs:function(f){return this._setLatLngs(f),this.redraw()},isEmpty:function(){return!this._latlngs.length},closestLayerPoint:function(f){for(var v=1/0,T=null,A=ii,V,Q,pe=0,Ne=this._parts.length;pe<Ne;pe++)for(var Ee=this._parts[pe],Be=1,rt=Ee.length;Be<rt;Be++){V=Ee[Be-1],Q=Ee[Be];var Nt=A(f,V,Q,!0);Nt<v&&(v=Nt,T=A(f,V,Q))}return T&&(T.distance=Math.sqrt(v)),T},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Yl(this._defaultShape(),this._map.options.crs)},getBounds:function(){return this._bounds},addLatLng:function(f,v){return v=v||this._defaultShape(),f=de(f),v.push(f),this._bounds.extend(f),this.redraw()},_setLatLngs:function(f){this._bounds=new ie,this._latlngs=this._convertLatLngs(f)},_defaultShape:function(){return Er(this._latlngs)?this._latlngs:this._latlngs[0]},_convertLatLngs:function(f){for(var v=[],T=Er(f),A=0,V=f.length;A<V;A++)T?(v[A]=de(f[A]),this._bounds.extend(v[A])):v[A]=this._convertLatLngs(f[A]);return v},_project:function(){var f=new H;this._rings=[],this._projectLatlngs(this._latlngs,this._rings,f),this._bounds.isValid()&&f.isValid()&&(this._rawPxBounds=f,this._updateBounds())},_updateBounds:function(){var f=this._clickTolerance(),v=new $(f,f);this._rawPxBounds&&(this._pxBounds=new H([this._rawPxBounds.min.subtract(v),this._rawPxBounds.max.add(v)]))},_projectLatlngs:function(f,v,T){var A=f[0]instanceof oe,V=f.length,Q,pe;if(A){for(pe=[],Q=0;Q<V;Q++)pe[Q]=this._map.latLngToLayerPoint(f[Q]),T.extend(pe[Q]);v.push(pe)}else for(Q=0;Q<V;Q++)this._projectLatlngs(f[Q],v,T)},_clipPoints:function(){var f=this._renderer._bounds;if(this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}var v=this._parts,T,A,V,Q,pe,Ne,Ee;for(T=0,V=0,Q=this._rings.length;T<Q;T++)for(Ee=this._rings[T],A=0,pe=Ee.length;A<pe-1;A++)Ne=$l(Ee[A],Ee[A+1],f,A,!0),Ne&&(v[V]=v[V]||[],v[V].push(Ne[0]),(Ne[1]!==Ee[A+1]||A===pe-2)&&(v[V].push(Ne[1]),V++))}},_simplifyPoints:function(){for(var f=this._parts,v=this.options.smoothFactor,T=0,A=f.length;T<A;T++)f[T]=Qa(f[T],v)},_update:function(){this._map&&(this._clipPoints(),this._simplifyPoints(),this._updatePath())},_updatePath:function(){this._renderer._updatePoly(this)},_containsPoint:function(f,v){var T,A,V,Q,pe,Ne,Ee=this._clickTolerance();if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(T=0,Q=this._parts.length;T<Q;T++)for(Ne=this._parts[T],A=0,pe=Ne.length,V=pe-1;A<pe;V=A++)if(!(!v&&A===0)&&Wl(f,Ne[V],Ne[A])<=Ee)return!0;return!1}});function Td(f,v){return new _r(f,v)}_r._flat=Hl;var ys=_r.extend({options:{fill:!0},isEmpty:function(){return!this._latlngs.length||!this._latlngs[0].length},getCenter:function(){if(!this._map)throw new Error("Must add layer to map before using getCenter()");return Vl(this._defaultShape(),this._map.options.crs)},_convertLatLngs:function(f){var v=_r.prototype._convertLatLngs.call(this,f),T=v.length;return T>=2&&v[0]instanceof oe&&v[0].equals(v[T-1])&&v.pop(),v},_setLatLngs:function(f){_r.prototype._setLatLngs.call(this,f),Er(this._latlngs)&&(this._latlngs=[this._latlngs])},_defaultShape:function(){return Er(this._latlngs[0])?this._latlngs[0]:this._latlngs[0][0]},_clipPoints:function(){var f=this._renderer._bounds,v=this.options.weight,T=new $(v,v);if(f=new H(f.min.subtract(T),f.max.add(T)),this._parts=[],!(!this._pxBounds||!this._pxBounds.intersects(f))){if(this.options.noClip){this._parts=this._rings;return}for(var A=0,V=this._rings.length,Q;A<V;A++)Q=Bo(this._rings[A],f,!0),Q.length&&this._parts.push(Q)}},_updatePath:function(){this._renderer._updatePoly(this,!0)},_containsPoint:function(f){var v=!1,T,A,V,Q,pe,Ne,Ee,Be;if(!this._pxBounds||!this._pxBounds.contains(f))return!1;for(Q=0,Ee=this._parts.length;Q<Ee;Q++)for(T=this._parts[Q],pe=0,Be=T.length,Ne=Be-1;pe<Be;Ne=pe++)A=T[pe],V=T[Ne],A.y>f.y!=V.y>f.y&&f.x<(V.x-A.x)*(f.y-A.y)/(V.y-A.y)+A.x&&(v=!v);return v||_r.prototype._containsPoint.call(this,f,!0)}});function kd(f,v){return new ys(f,v)}var es=gs.extend({initialize:function(f,v){w(this,v),this._layers={},f&&this.addData(f)},addData:function(f){var v=O(f)?f:f.features,T,A,V;if(v){for(T=0,A=v.length;T<A;T++)V=v[T],(V.geometries||V.geometry||V.features||V.coordinates)&&this.addData(V);return this}var Q=this.options;if(Q.filter&&!Q.filter(f))return this;var pe=Oi(f,Q);return pe?(pe.feature=ao(f),pe.defaultOptions=pe.options,this.resetStyle(pe),Q.onEachFeature&&Q.onEachFeature(f,pe),this.addLayer(pe)):this},resetStyle:function(f){return f===void 0?this.eachLayer(this.resetStyle,this):(f.options=s({},f.defaultOptions),this._setLayerStyle(f,this.options.style),this)},setStyle:function(f){return this.eachLayer(function(v){this._setLayerStyle(v,f)},this)},_setLayerStyle:function(f,v){f.setStyle&&(typeof v=="function"&&(v=v(f.feature)),f.setStyle(v))}});function Oi(f,v){var T=f.type==="Feature"?f.geometry:f,A=T?T.coordinates:null,V=[],Q=v&&v.pointToLayer,pe=v&&v.coordsToLatLng||ro,Ne,Ee,Be,rt;if(!A&&!T)return null;switch(T.type){case"Point":return Ne=pe(A),no(Q,f,Ne,v);case"MultiPoint":for(Be=0,rt=A.length;Be<rt;Be++)Ne=pe(A[Be]),V.push(no(Q,f,Ne,v));return new gs(V);case"LineString":case"MultiLineString":return Ee=ga(A,T.type==="LineString"?0:1,pe),new _r(Ee,v);case"Polygon":case"MultiPolygon":return Ee=ga(A,T.type==="Polygon"?1:2,pe),new ys(Ee,v);case"GeometryCollection":for(Be=0,rt=T.geometries.length;Be<rt;Be++){var Nt=Oi({geometry:T.geometries[Be],type:"Feature",properties:f.properties},v);Nt&&V.push(Nt)}return new gs(V);case"FeatureCollection":for(Be=0,rt=T.features.length;Be<rt;Be++){var $t=Oi(T.features[Be],v);$t&&V.push($t)}return new gs(V);default:throw new Error("Invalid GeoJSON object.")}}function no(f,v,T,A){return f?f(v,T):new xs(T,A&&A.markersInheritOptions&&A)}function ro(f){return new oe(f[1],f[0],f[2])}function ga(f,v,T){for(var A=[],V=0,Q=f.length,pe;V<Q;V++)pe=v?ga(f[V],v-1,T):(T||ro)(f[V]),A.push(pe);return A}function so(f,v){return f=de(f),f.alt!==void 0?[x(f.lng,v),x(f.lat,v),x(f.alt,v)]:[x(f.lng,v),x(f.lat,v)]}function io(f,v,T,A){for(var V=[],Q=0,pe=f.length;Q<pe;Q++)V.push(v?io(f[Q],Er(f[Q])?0:v-1,T,A):so(f[Q],A));return!v&&T&&V.length>0&&V.push(V[0].slice()),V}function Ii(f,v){return f.feature?s({},f.feature,{geometry:v}):ao(v)}function ao(f){return f.type==="Feature"||f.type==="FeatureCollection"?f:{type:"Feature",properties:{},geometry:f}}var Zo={toGeoJSON:function(f){return Ii(this,{type:"Point",coordinates:so(this.getLatLng(),f)})}};xs.include(Zo),to.include(Zo),eo.include(Zo),_r.include({toGeoJSON:function(f){var v=!Er(this._latlngs),T=io(this._latlngs,v?1:0,!1,f);return Ii(this,{type:(v?"Multi":"")+"LineString",coordinates:T})}}),ys.include({toGeoJSON:function(f){var v=!Er(this._latlngs),T=v&&!Er(this._latlngs[0]),A=io(this._latlngs,T?2:v?1:0,!0,f);return v||(A=[A]),Ii(this,{type:(T?"Multi":"")+"Polygon",coordinates:A})}}),Os.include({toMultiPoint:function(f){var v=[];return this.eachLayer(function(T){v.push(T.toGeoJSON(f).geometry.coordinates)}),Ii(this,{type:"MultiPoint",coordinates:v})},toGeoJSON:function(f){var v=this.feature&&this.feature.geometry&&this.feature.geometry.type;if(v==="MultiPoint")return this.toMultiPoint(f);var T=v==="GeometryCollection",A=[];return this.eachLayer(function(V){if(V.toGeoJSON){var Q=V.toGeoJSON(f);if(T)A.push(Q.geometry);else{var pe=ao(Q);pe.type==="FeatureCollection"?A.push.apply(A,pe.features):A.push(pe)}}}),T?Ii(this,{geometries:A,type:"GeometryCollection"}):{type:"FeatureCollection",features:A}}});function Xl(f,v){return new es(f,v)}var Wr=Xl,As=Vr.extend({options:{opacity:1,alt:"",interactive:!1,crossOrigin:!1,errorOverlayUrl:"",zIndex:1,className:""},initialize:function(f,v,T){this._url=f,this._bounds=ce(v),w(this,T)},onAdd:function(){this._image||(this._initImage(),this.options.opacity<1&&this._updateOpacity()),this.options.interactive&&(Dt(this._image,"leaflet-interactive"),this.addInteractiveTarget(this._image)),this.getPane().appendChild(this._image),this._reset()},onRemove:function(){wn(this._image),this.options.interactive&&this.removeInteractiveTarget(this._image)},setOpacity:function(f){return this.options.opacity=f,this._image&&this._updateOpacity(),this},setStyle:function(f){return f.opacity&&this.setOpacity(f.opacity),this},bringToFront:function(){return this._map&&Ni(this._image),this},bringToBack:function(){return this._map&&hs(this._image),this},setUrl:function(f){return this._url=f,this._image&&(this._image.src=f),this},setBounds:function(f){return this._bounds=ce(f),this._map&&this._reset(),this},getEvents:function(){var f={zoom:this._reset,viewreset:this._reset};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},getBounds:function(){return this._bounds},getElement:function(){return this._image},_initImage:function(){var f=this._url.tagName==="IMG",v=this._image=f?this._url:Ot("img");if(Dt(v,"leaflet-image-layer"),this._zoomAnimated&&Dt(v,"leaflet-zoom-animated"),this.options.className&&Dt(v,this.options.className),v.onselectstart=p,v.onmousemove=p,v.onload=o(this.fire,this,"load"),v.onerror=o(this._overlayOnError,this,"error"),(this.options.crossOrigin||this.options.crossOrigin==="")&&(v.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),this.options.zIndex&&this._updateZIndex(),f){this._url=v.src;return}v.src=this._url,v.alt=this.options.alt},_animateZoom:function(f){var v=this._map.getZoomScale(f.zoom),T=this._map._latLngBoundsToNewLayerBounds(this._bounds,f.zoom,f.center).min;qr(this._image,T,v)},_reset:function(){var f=this._image,v=new H(this._map.latLngToLayerPoint(this._bounds.getNorthWest()),this._map.latLngToLayerPoint(this._bounds.getSouthEast())),T=v.getSize();An(f,v.min),f.style.width=T.x+"px",f.style.height=T.y+"px"},_updateOpacity:function(){fr(this._image,this.options.opacity)},_updateZIndex:function(){this._image&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._image.style.zIndex=this.options.zIndex)},_overlayOnError:function(){this.fire("error");var f=this.options.errorOverlayUrl;f&&this._url!==f&&(this._url=f,this._image.src=f)},getCenter:function(){return this._bounds.getCenter()}}),ec=function(f,v,T){return new As(f,v,T)},Ko=As.extend({options:{autoplay:!0,loop:!0,keepAspectRatio:!0,muted:!1,playsInline:!0},_initImage:function(){var f=this._url.tagName==="VIDEO",v=this._image=f?this._url:Ot("video");if(Dt(v,"leaflet-image-layer"),this._zoomAnimated&&Dt(v,"leaflet-zoom-animated"),this.options.className&&Dt(v,this.options.className),v.onselectstart=p,v.onmousemove=p,v.onloadeddata=o(this.fire,this,"load"),f){for(var T=v.getElementsByTagName("source"),A=[],V=0;V<T.length;V++)A.push(T[V].src);this._url=T.length>0?A:[v.src];return}O(this._url)||(this._url=[this._url]),!this.options.keepAspectRatio&&Object.prototype.hasOwnProperty.call(v.style,"objectFit")&&(v.style.objectFit="fill"),v.autoplay=!!this.options.autoplay,v.loop=!!this.options.loop,v.muted=!!this.options.muted,v.playsInline=!!this.options.playsInline;for(var Q=0;Q<this._url.length;Q++){var pe=Ot("source");pe.src=this._url[Q],v.appendChild(pe)}}});function tc(f,v,T){return new Ko(f,v,T)}var Jo=As.extend({_initImage:function(){var f=this._image=this._url;Dt(f,"leaflet-image-layer"),this._zoomAnimated&&Dt(f,"leaflet-zoom-animated"),this.options.className&&Dt(f,this.options.className),f.onselectstart=p,f.onmousemove=p}});function Qo(f,v,T){return new Jo(f,v,T)}var g=Vr.extend({options:{interactive:!1,offset:[0,0],className:"",pane:void 0,content:""},initialize:function(f,v){f&&(f instanceof oe||O(f))?(this._latlng=de(f),w(this,v)):(w(this,f),this._source=v),this.options.content&&(this._content=this.options.content)},openOn:function(f){return f=arguments.length?f:this._source._map,f.hasLayer(this)||f.addLayer(this),this},close:function(){return this._map&&this._map.removeLayer(this),this},toggle:function(f){return this._map?this.close():(arguments.length?this._source=f:f=this._source,this._prepareOpen(),this.openOn(f._map)),this},onAdd:function(f){this._zoomAnimated=f._zoomAnimated,this._container||this._initLayout(),f._fadeAnimated&&fr(this._container,0),clearTimeout(this._removeTimeout),this.getPane().appendChild(this._container),this.update(),f._fadeAnimated&&fr(this._container,1),this.bringToFront(),this.options.interactive&&(Dt(this._container,"leaflet-interactive"),this.addInteractiveTarget(this._container))},onRemove:function(f){f._fadeAnimated?(fr(this._container,0),this._removeTimeout=setTimeout(o(wn,void 0,this._container),200)):wn(this._container),this.options.interactive&&(xn(this._container,"leaflet-interactive"),this.removeInteractiveTarget(this._container))},getLatLng:function(){return this._latlng},setLatLng:function(f){return this._latlng=de(f),this._map&&(this._updatePosition(),this._adjustPan()),this},getContent:function(){return this._content},setContent:function(f){return this._content=f,this.update(),this},getElement:function(){return this._container},update:function(){this._map&&(this._container.style.visibility="hidden",this._updateContent(),this._updateLayout(),this._updatePosition(),this._container.style.visibility="",this._adjustPan())},getEvents:function(){var f={zoom:this._updatePosition,viewreset:this._updatePosition};return this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},isOpen:function(){return!!this._map&&this._map.hasLayer(this)},bringToFront:function(){return this._map&&Ni(this._container),this},bringToBack:function(){return this._map&&hs(this._container),this},_prepareOpen:function(f){var v=this._source;if(!v._map)return!1;if(v instanceof gs){v=null;var T=this._source._layers;for(var A in T)if(T[A]._map){v=T[A];break}if(!v)return!1;this._source=v}if(!f)if(v.getCenter)f=v.getCenter();else if(v.getLatLng)f=v.getLatLng();else if(v.getBounds)f=v.getBounds().getCenter();else throw new Error("Unable to get source layer LatLng.");return this.setLatLng(f),this._map&&this.update(),!0},_updateContent:function(){if(this._content){var f=this._contentNode,v=typeof this._content=="function"?this._content(this._source||this):this._content;if(typeof v=="string")f.innerHTML=v;else{for(;f.hasChildNodes();)f.removeChild(f.firstChild);f.appendChild(v)}this.fire("contentupdate")}},_updatePosition:function(){if(this._map){var f=this._map.latLngToLayerPoint(this._latlng),v=re(this.options.offset),T=this._getAnchor();this._zoomAnimated?An(this._container,f.add(T)):v=v.add(f).add(T);var A=this._containerBottom=-v.y,V=this._containerLeft=-Math.round(this._containerWidth/2)+v.x;this._container.style.bottom=A+"px",this._container.style.left=V+"px"}},_getAnchor:function(){return[0,0]}});Ht.include({_initOverlay:function(f,v,T,A){var V=v;return V instanceof f||(V=new f(A).setContent(v)),T&&V.setLatLng(T),V}}),Vr.include({_initOverlay:function(f,v,T,A){var V=T;return V instanceof f?(w(V,A),V._source=this):(V=v&&!A?v:new f(A,this),V.setContent(T)),V}});var ku=g.extend({options:{pane:"popupPane",offset:[0,7],maxWidth:300,minWidth:50,maxHeight:null,autoPan:!0,autoPanPaddingTopLeft:null,autoPanPaddingBottomRight:null,autoPanPadding:[5,5],keepInView:!1,closeButton:!0,autoClose:!0,closeOnEscapeKey:!0,className:""},openOn:function(f){return f=arguments.length?f:this._source._map,!f.hasLayer(this)&&f._popup&&f._popup.options.autoClose&&f.removeLayer(f._popup),f._popup=this,g.prototype.openOn.call(this,f)},onAdd:function(f){g.prototype.onAdd.call(this,f),f.fire("popupopen",{popup:this}),this._source&&(this._source.fire("popupopen",{popup:this},!0),this._source instanceof Is||this._source.on("preclick",Xr))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("popupclose",{popup:this}),this._source&&(this._source.fire("popupclose",{popup:this},!0),this._source instanceof Is||this._source.off("preclick",Xr))},getEvents:function(){var f=g.prototype.getEvents.call(this);return(this.options.closeOnClick!==void 0?this.options.closeOnClick:this._map.options.closePopupOnClick)&&(f.preclick=this.close),this.options.keepInView&&(f.moveend=this._adjustPan),f},_initLayout:function(){var f="leaflet-popup",v=this._container=Ot("div",f+" "+(this.options.className||"")+" leaflet-zoom-animated"),T=this._wrapper=Ot("div",f+"-content-wrapper",v);if(this._contentNode=Ot("div",f+"-content",T),ua(v),Ga(this._contentNode),Ct(v,"contextmenu",Xr),this._tipContainer=Ot("div",f+"-tip-container",v),this._tip=Ot("div",f+"-tip",this._tipContainer),this.options.closeButton){var A=this._closeButton=Ot("a",f+"-close-button",v);A.setAttribute("role","button"),A.setAttribute("aria-label","Close popup"),A.href="#close",A.innerHTML='<span aria-hidden="true">&#215;</span>',Ct(A,"click",function(V){Mn(V),this.close()},this)}},_updateLayout:function(){var f=this._contentNode,v=f.style;v.width="",v.whiteSpace="nowrap";var T=f.offsetWidth;T=Math.min(T,this.options.maxWidth),T=Math.max(T,this.options.minWidth),v.width=T+1+"px",v.whiteSpace="",v.height="";var A=f.offsetHeight,V=this.options.maxHeight,Q="leaflet-popup-scrolled";V&&A>V?(v.height=V+"px",Dt(f,Q)):xn(f,Q),this._containerWidth=this._container.offsetWidth},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center),T=this._getAnchor();An(this._container,v.add(T))},_adjustPan:function(){if(this.options.autoPan){if(this._map._panAnim&&this._map._panAnim.stop(),this._autopanning){this._autopanning=!1;return}var f=this._map,v=parseInt(oa(this._container,"marginBottom"),10)||0,T=this._container.offsetHeight+v,A=this._containerWidth,V=new $(this._containerLeft,-T-this._containerBottom);V._add(ms(this._container));var Q=f.layerPointToContainerPoint(V),pe=re(this.options.autoPanPadding),Ne=re(this.options.autoPanPaddingTopLeft||pe),Ee=re(this.options.autoPanPaddingBottomRight||pe),Be=f.getSize(),rt=0,Nt=0;Q.x+A+Ee.x>Be.x&&(rt=Q.x+A-Be.x+Ee.x),Q.x-rt-Ne.x<0&&(rt=Q.x-Ne.x),Q.y+T+Ee.y>Be.y&&(Nt=Q.y+T-Be.y+Ee.y),Q.y-Nt-Ne.y<0&&(Nt=Q.y-Ne.y),(rt||Nt)&&(this.options.keepInView&&(this._autopanning=!0),f.fire("autopanstart").panBy([rt,Nt]))}},_getAnchor:function(){return re(this._source&&this._source._getPopupAnchor?this._source._getPopupAnchor():[0,0])}}),nc=function(f,v){return new ku(f,v)};Ht.mergeOptions({closePopupOnClick:!0}),Ht.include({openPopup:function(f,v,T){return this._initOverlay(ku,f,v,T).openOn(this),this},closePopup:function(f){return f=arguments.length?f:this._popup,f&&f.close(),this}}),Vr.include({bindPopup:function(f,v){return this._popup=this._initOverlay(ku,this._popup,f,v),this._popupHandlersAdded||(this.on({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!0),this},unbindPopup:function(){return this._popup&&(this.off({click:this._openPopup,keypress:this._onKeyPress,remove:this.closePopup,move:this._movePopup}),this._popupHandlersAdded=!1,this._popup=null),this},openPopup:function(f){return this._popup&&(this instanceof gs||(this._popup._source=this),this._popup._prepareOpen(f||this._latlng)&&this._popup.openOn(this._map)),this},closePopup:function(){return this._popup&&this._popup.close(),this},togglePopup:function(){return this._popup&&this._popup.toggle(this),this},isPopupOpen:function(){return this._popup?this._popup.isOpen():!1},setPopupContent:function(f){return this._popup&&this._popup.setContent(f),this},getPopup:function(){return this._popup},_openPopup:function(f){if(!(!this._popup||!this._map)){Ur(f);var v=f.layer||f.target;if(this._popup._source===v&&!(v instanceof Is)){this._map.hasLayer(this._popup)?this.closePopup():this.openPopup(f.latlng);return}this._popup._source=v,this.openPopup(f.latlng)}},_movePopup:function(f){this._popup.setLatLng(f.latlng)},_onKeyPress:function(f){f.originalEvent.keyCode===13&&this._openPopup(f)}});var rc=g.extend({options:{pane:"tooltipPane",offset:[0,0],direction:"auto",permanent:!1,sticky:!1,opacity:.9},onAdd:function(f){g.prototype.onAdd.call(this,f),this.setOpacity(this.options.opacity),f.fire("tooltipopen",{tooltip:this}),this._source&&(this.addEventParent(this._source),this._source.fire("tooltipopen",{tooltip:this},!0))},onRemove:function(f){g.prototype.onRemove.call(this,f),f.fire("tooltipclose",{tooltip:this}),this._source&&(this.removeEventParent(this._source),this._source.fire("tooltipclose",{tooltip:this},!0))},getEvents:function(){var f=g.prototype.getEvents.call(this);return this.options.permanent||(f.preclick=this.close),f},_initLayout:function(){var f="leaflet-tooltip",v=f+" "+(this.options.className||"")+" leaflet-zoom-"+(this._zoomAnimated?"animated":"hide");this._contentNode=this._container=Ot("div",v),this._container.setAttribute("role","tooltip"),this._container.setAttribute("id","leaflet-tooltip-"+c(this))},_updateLayout:function(){},_adjustPan:function(){},_setPosition:function(f){var v,T,A=this._map,V=this._container,Q=A.latLngToContainerPoint(A.getCenter()),pe=A.layerPointToContainerPoint(f),Ne=this.options.direction,Ee=V.offsetWidth,Be=V.offsetHeight,rt=re(this.options.offset),Nt=this._getAnchor();Ne==="top"?(v=Ee/2,T=Be):Ne==="bottom"?(v=Ee/2,T=0):Ne==="center"?(v=Ee/2,T=Be/2):Ne==="right"?(v=0,T=Be/2):Ne==="left"?(v=Ee,T=Be/2):pe.x<Q.x?(Ne="right",v=0,T=Be/2):(Ne="left",v=Ee+(rt.x+Nt.x)*2,T=Be/2),f=f.subtract(re(v,T,!0)).add(rt).add(Nt),xn(V,"leaflet-tooltip-right"),xn(V,"leaflet-tooltip-left"),xn(V,"leaflet-tooltip-top"),xn(V,"leaflet-tooltip-bottom"),Dt(V,"leaflet-tooltip-"+Ne),An(V,f)},_updatePosition:function(){var f=this._map.latLngToLayerPoint(this._latlng);this._setPosition(f)},setOpacity:function(f){this.options.opacity=f,this._container&&fr(this._container,f)},_animateZoom:function(f){var v=this._map._latLngToNewLayerPoint(this._latlng,f.zoom,f.center);this._setPosition(v)},_getAnchor:function(){return re(this._source&&this._source._getTooltipAnchor&&!this.options.sticky?this._source._getTooltipAnchor():[0,0])}}),Pd=function(f,v){return new rc(f,v)};Ht.include({openTooltip:function(f,v,T){return this._initOverlay(rc,f,v,T).openOn(this),this},closeTooltip:function(f){return f.close(),this}}),Vr.include({bindTooltip:function(f,v){return this._tooltip&&this.isTooltipOpen()&&this.unbindTooltip(),this._tooltip=this._initOverlay(rc,this._tooltip,f,v),this._initTooltipInteractions(),this._tooltip.options.permanent&&this._map&&this._map.hasLayer(this)&&this.openTooltip(),this},unbindTooltip:function(){return this._tooltip&&(this._initTooltipInteractions(!0),this.closeTooltip(),this._tooltip=null),this},_initTooltipInteractions:function(f){if(!(!f&&this._tooltipHandlersAdded)){var v=f?"off":"on",T={remove:this.closeTooltip,move:this._moveTooltip};this._tooltip.options.permanent?T.add=this._openTooltip:(T.mouseover=this._openTooltip,T.mouseout=this.closeTooltip,T.click=this._openTooltip,this._map?this._addFocusListeners():T.add=this._addFocusListeners),this._tooltip.options.sticky&&(T.mousemove=this._moveTooltip),this[v](T),this._tooltipHandlersAdded=!f}},openTooltip:function(f){return this._tooltip&&(this instanceof gs||(this._tooltip._source=this),this._tooltip._prepareOpen(f)&&(this._tooltip.openOn(this._map),this.getElement?this._setAriaDescribedByOnLayer(this):this.eachLayer&&this.eachLayer(this._setAriaDescribedByOnLayer,this))),this},closeTooltip:function(){if(this._tooltip)return this._tooltip.close()},toggleTooltip:function(){return this._tooltip&&this._tooltip.toggle(this),this},isTooltipOpen:function(){return this._tooltip.isOpen()},setTooltipContent:function(f){return this._tooltip&&this._tooltip.setContent(f),this},getTooltip:function(){return this._tooltip},_addFocusListeners:function(){this.getElement?this._addFocusListenersOnLayer(this):this.eachLayer&&this.eachLayer(this._addFocusListenersOnLayer,this)},_addFocusListenersOnLayer:function(f){var v=typeof f.getElement=="function"&&f.getElement();v&&(Ct(v,"focus",function(){this._tooltip._source=f,this.openTooltip()},this),Ct(v,"blur",this.closeTooltip,this))},_setAriaDescribedByOnLayer:function(f){var v=typeof f.getElement=="function"&&f.getElement();v&&v.setAttribute("aria-describedby",this._tooltip._container.id)},_openTooltip:function(f){if(!(!this._tooltip||!this._map)){if(this._map.dragging&&this._map.dragging.moving()&&!this._openOnceFlag){this._openOnceFlag=!0;var v=this;this._map.once("moveend",function(){v._openOnceFlag=!1,v._openTooltip(f)});return}this._tooltip._source=f.layer||f.target,this.openTooltip(this._tooltip.options.sticky?f.latlng:void 0)}},_moveTooltip:function(f){var v=f.latlng,T,A;this._tooltip.options.sticky&&f.originalEvent&&(T=this._map.mouseEventToContainerPoint(f.originalEvent),A=this._map.containerPointToLayerPoint(T),v=this._map.layerPointToLatLng(A)),this._tooltip.setLatLng(v)}});var Pu=ai.extend({options:{iconSize:[12,12],html:!1,bgPos:null,className:"leaflet-div-icon"},createIcon:function(f){var v=f&&f.tagName==="DIV"?f:document.createElement("div"),T=this.options;if(T.html instanceof Element?(Ba(v),v.appendChild(T.html)):v.innerHTML=T.html!==!1?T.html:"",T.bgPos){var A=re(T.bgPos);v.style.backgroundPosition=-A.x+"px "+-A.y+"px"}return this._setIconStyles(v,"icon"),v},createShadow:function(){return null}});function zm(f){return new Pu(f)}ai.Default=Di;var oo=Vr.extend({options:{tileSize:256,opacity:1,updateWhenIdle:dt.mobile,updateWhenZooming:!0,updateInterval:200,zIndex:1,bounds:null,minZoom:0,maxZoom:void 0,maxNativeZoom:void 0,minNativeZoom:void 0,noWrap:!1,pane:"tilePane",className:"",keepBuffer:2},initialize:function(f){w(this,f)},onAdd:function(){this._initContainer(),this._levels={},this._tiles={},this._resetView()},beforeAdd:function(f){f._addZoomLimit(this)},onRemove:function(f){this._removeAllTiles(),wn(this._container),f._removeZoomLimit(this),this._container=null,this._tileZoom=void 0},bringToFront:function(){return this._map&&(Ni(this._container),this._setAutoZIndex(Math.max)),this},bringToBack:function(){return this._map&&(hs(this._container),this._setAutoZIndex(Math.min)),this},getContainer:function(){return this._container},setOpacity:function(f){return this.options.opacity=f,this._updateOpacity(),this},setZIndex:function(f){return this.options.zIndex=f,this._updateZIndex(),this},isLoading:function(){return this._loading},redraw:function(){if(this._map){this._removeAllTiles();var f=this._clampZoom(this._map.getZoom());f!==this._tileZoom&&(this._tileZoom=f,this._updateLevels()),this._update()}return this},getEvents:function(){var f={viewprereset:this._invalidateAll,viewreset:this._resetView,zoom:this._resetView,moveend:this._onMoveEnd};return this.options.updateWhenIdle||(this._onMove||(this._onMove=d(this._onMoveEnd,this.options.updateInterval,this)),f.move=this._onMove),this._zoomAnimated&&(f.zoomanim=this._animateZoom),f},createTile:function(){return document.createElement("div")},getTileSize:function(){var f=this.options.tileSize;return f instanceof $?f:new $(f,f)},_updateZIndex:function(){this._container&&this.options.zIndex!==void 0&&this.options.zIndex!==null&&(this._container.style.zIndex=this.options.zIndex)},_setAutoZIndex:function(f){for(var v=this.getPane().children,T=-f(-1/0,1/0),A=0,V=v.length,Q;A<V;A++)Q=v[A].style.zIndex,v[A]!==this._container&&Q&&(T=f(T,+Q));isFinite(T)&&(this.options.zIndex=T+f(-1,1),this._updateZIndex())},_updateOpacity:function(){if(this._map&&!dt.ielt9){fr(this._container,this.options.opacity);var f=+new Date,v=!1,T=!1;for(var A in this._tiles){var V=this._tiles[A];if(!(!V.current||!V.loaded)){var Q=Math.min(1,(f-V.loaded)/200);fr(V.el,Q),Q<1?v=!0:(V.active?T=!0:this._onOpaqueTile(V),V.active=!0)}}T&&!this._noPrune&&this._pruneTiles(),v&&(G(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this))}},_onOpaqueTile:p,_initContainer:function(){this._container||(this._container=Ot("div","leaflet-layer "+(this.options.className||"")),this._updateZIndex(),this.options.opacity<1&&this._updateOpacity(),this.getPane().appendChild(this._container))},_updateLevels:function(){var f=this._tileZoom,v=this.options.maxZoom;if(f!==void 0){for(var T in this._levels)T=Number(T),this._levels[T].el.children.length||T===f?(this._levels[T].el.style.zIndex=v-Math.abs(f-T),this._onUpdateLevel(T)):(wn(this._levels[T].el),this._removeTilesAtZoom(T),this._onRemoveLevel(T),delete this._levels[T]);var A=this._levels[f],V=this._map;return A||(A=this._levels[f]={},A.el=Ot("div","leaflet-tile-container leaflet-zoom-animated",this._container),A.el.style.zIndex=v,A.origin=V.project(V.unproject(V.getPixelOrigin()),f).round(),A.zoom=f,this._setZoomTransform(A,V.getCenter(),V.getZoom()),p(A.el.offsetWidth),this._onCreateLevel(A)),this._level=A,A}},_onUpdateLevel:p,_onRemoveLevel:p,_onCreateLevel:p,_pruneTiles:function(){if(this._map){var f,v,T=this._map.getZoom();if(T>this.options.maxZoom||T<this.options.minZoom){this._removeAllTiles();return}for(f in this._tiles)v=this._tiles[f],v.retain=v.current;for(f in this._tiles)if(v=this._tiles[f],v.current&&!v.active){var A=v.coords;this._retainParent(A.x,A.y,A.z,A.z-5)||this._retainChildren(A.x,A.y,A.z,A.z+2)}for(f in this._tiles)this._tiles[f].retain||this._removeTile(f)}},_removeTilesAtZoom:function(f){for(var v in this._tiles)this._tiles[v].coords.z===f&&this._removeTile(v)},_removeAllTiles:function(){for(var f in this._tiles)this._removeTile(f)},_invalidateAll:function(){for(var f in this._levels)wn(this._levels[f].el),this._onRemoveLevel(Number(f)),delete this._levels[f];this._removeAllTiles(),this._tileZoom=void 0},_retainParent:function(f,v,T,A){var V=Math.floor(f/2),Q=Math.floor(v/2),pe=T-1,Ne=new $(+V,+Q);Ne.z=+pe;var Ee=this._tileCoordsToKey(Ne),Be=this._tiles[Ee];return Be&&Be.active?(Be.retain=!0,!0):(Be&&Be.loaded&&(Be.retain=!0),pe>A?this._retainParent(V,Q,pe,A):!1)},_retainChildren:function(f,v,T,A){for(var V=2*f;V<2*f+2;V++)for(var Q=2*v;Q<2*v+2;Q++){var pe=new $(V,Q);pe.z=T+1;var Ne=this._tileCoordsToKey(pe),Ee=this._tiles[Ne];if(Ee&&Ee.active){Ee.retain=!0;continue}else Ee&&Ee.loaded&&(Ee.retain=!0);T+1<A&&this._retainChildren(V,Q,T+1,A)}},_resetView:function(f){var v=f&&(f.pinch||f.flyTo);this._setView(this._map.getCenter(),this._map.getZoom(),v,v)},_animateZoom:function(f){this._setView(f.center,f.zoom,!0,f.noUpdate)},_clampZoom:function(f){var v=this.options;return v.minNativeZoom!==void 0&&f<v.minNativeZoom?v.minNativeZoom:v.maxNativeZoom!==void 0&&v.maxNativeZoom<f?v.maxNativeZoom:f},_setView:function(f,v,T,A){var V=Math.round(v);this.options.maxZoom!==void 0&&V>this.options.maxZoom||this.options.minZoom!==void 0&&V<this.options.minZoom?V=void 0:V=this._clampZoom(V);var Q=this.options.updateWhenZooming&&V!==this._tileZoom;(!A||Q)&&(this._tileZoom=V,this._abortLoading&&this._abortLoading(),this._updateLevels(),this._resetGrid(),V!==void 0&&this._update(f),T||this._pruneTiles(),this._noPrune=!!T),this._setZoomTransforms(f,v)},_setZoomTransforms:function(f,v){for(var T in this._levels)this._setZoomTransform(this._levels[T],f,v)},_setZoomTransform:function(f,v,T){var A=this._map.getZoomScale(T,f.zoom),V=f.origin.multiplyBy(A).subtract(this._map._getNewPixelOrigin(v,T)).round();dt.any3d?qr(f.el,V,A):An(f.el,V)},_resetGrid:function(){var f=this._map,v=f.options.crs,T=this._tileSize=this.getTileSize(),A=this._tileZoom,V=this._map.getPixelWorldBounds(this._tileZoom);V&&(this._globalTileRange=this._pxBoundsToTileRange(V)),this._wrapX=v.wrapLng&&!this.options.noWrap&&[Math.floor(f.project([0,v.wrapLng[0]],A).x/T.x),Math.ceil(f.project([0,v.wrapLng[1]],A).x/T.y)],this._wrapY=v.wrapLat&&!this.options.noWrap&&[Math.floor(f.project([v.wrapLat[0],0],A).y/T.x),Math.ceil(f.project([v.wrapLat[1],0],A).y/T.y)]},_onMoveEnd:function(){!this._map||this._map._animatingZoom||this._update()},_getTiledPixelBounds:function(f){var v=this._map,T=v._animatingZoom?Math.max(v._animateToZoom,v.getZoom()):v.getZoom(),A=v.getZoomScale(T,this._tileZoom),V=v.project(f,this._tileZoom).floor(),Q=v.getSize().divideBy(A*2);return new H(V.subtract(Q),V.add(Q))},_update:function(f){var v=this._map;if(v){var T=this._clampZoom(v.getZoom());if(f===void 0&&(f=v.getCenter()),this._tileZoom!==void 0){var A=this._getTiledPixelBounds(f),V=this._pxBoundsToTileRange(A),Q=V.getCenter(),pe=[],Ne=this.options.keepBuffer,Ee=new H(V.getBottomLeft().subtract([Ne,-Ne]),V.getTopRight().add([Ne,-Ne]));if(!(isFinite(V.min.x)&&isFinite(V.min.y)&&isFinite(V.max.x)&&isFinite(V.max.y)))throw new Error("Attempted to load an infinite number of tiles");for(var Be in this._tiles){var rt=this._tiles[Be].coords;(rt.z!==this._tileZoom||!Ee.contains(new $(rt.x,rt.y)))&&(this._tiles[Be].current=!1)}if(Math.abs(T-this._tileZoom)>1){this._setView(f,T);return}for(var Nt=V.min.y;Nt<=V.max.y;Nt++)for(var $t=V.min.x;$t<=V.max.x;$t++){var jr=new $($t,Nt);if(jr.z=this._tileZoom,!!this._isValidTile(jr)){var mr=this._tiles[this._tileCoordsToKey(jr)];mr?mr.current=!0:pe.push(jr)}}if(pe.sort(function(ts,lc){return ts.distanceTo(Q)-lc.distanceTo(Q)}),pe.length!==0){this._loading||(this._loading=!0,this.fire("loading"));var vs=document.createDocumentFragment();for($t=0;$t<pe.length;$t++)this._addTile(pe[$t],vs);this._level.el.appendChild(vs)}}}},_isValidTile:function(f){var v=this._map.options.crs;if(!v.infinite){var T=this._globalTileRange;if(!v.wrapLng&&(f.x<T.min.x||f.x>T.max.x)||!v.wrapLat&&(f.y<T.min.y||f.y>T.max.y))return!1}if(!this.options.bounds)return!0;var A=this._tileCoordsToBounds(f);return ce(this.options.bounds).overlaps(A)},_keyToBounds:function(f){return this._tileCoordsToBounds(this._keyToTileCoords(f))},_tileCoordsToNwSe:function(f){var v=this._map,T=this.getTileSize(),A=f.scaleBy(T),V=A.add(T),Q=v.unproject(A,f.z),pe=v.unproject(V,f.z);return[Q,pe]},_tileCoordsToBounds:function(f){var v=this._tileCoordsToNwSe(f),T=new ie(v[0],v[1]);return this.options.noWrap||(T=this._map.wrapLatLngBounds(T)),T},_tileCoordsToKey:function(f){return f.x+":"+f.y+":"+f.z},_keyToTileCoords:function(f){var v=f.split(":"),T=new $(+v[0],+v[1]);return T.z=+v[2],T},_removeTile:function(f){var v=this._tiles[f];v&&(wn(v.el),delete this._tiles[f],this.fire("tileunload",{tile:v.el,coords:this._keyToTileCoords(f)}))},_initTile:function(f){Dt(f,"leaflet-tile");var v=this.getTileSize();f.style.width=v.x+"px",f.style.height=v.y+"px",f.onselectstart=p,f.onmousemove=p,dt.ielt9&&this.options.opacity<1&&fr(f,this.options.opacity)},_addTile:function(f,v){var T=this._getTilePos(f),A=this._tileCoordsToKey(f),V=this.createTile(this._wrapCoords(f),o(this._tileReady,this,f));this._initTile(V),this.createTile.length<2&&W(o(this._tileReady,this,f,null,V)),An(V,T),this._tiles[A]={el:V,coords:f,current:!0},v.appendChild(V),this.fire("tileloadstart",{tile:V,coords:f})},_tileReady:function(f,v,T){v&&this.fire("tileerror",{error:v,tile:T,coords:f});var A=this._tileCoordsToKey(f);T=this._tiles[A],T&&(T.loaded=+new Date,this._map._fadeAnimated?(fr(T.el,0),G(this._fadeFrame),this._fadeFrame=W(this._updateOpacity,this)):(T.active=!0,this._pruneTiles()),v||(Dt(T.el,"leaflet-tile-loaded"),this.fire("tileload",{tile:T.el,coords:f})),this._noTilesToLoad()&&(this._loading=!1,this.fire("load"),dt.ielt9||!this._map._fadeAnimated?W(this._pruneTiles,this):setTimeout(o(this._pruneTiles,this),250)))},_getTilePos:function(f){return f.scaleBy(this.getTileSize()).subtract(this._level.origin)},_wrapCoords:function(f){var v=new $(this._wrapX?h(f.x,this._wrapX):f.x,this._wrapY?h(f.y,this._wrapY):f.y);return v.z=f.z,v},_pxBoundsToTileRange:function(f){var v=this.getTileSize();return new H(f.min.unscaleBy(v).floor(),f.max.unscaleBy(v).ceil().subtract([1,1]))},_noTilesToLoad:function(){for(var f in this._tiles)if(!this._tiles[f].loaded)return!1;return!0}});function sc(f){return new oo(f)}var lo=oo.extend({options:{minZoom:0,maxZoom:18,subdomains:"abc",errorTileUrl:"",zoomOffset:0,tms:!1,zoomReverse:!1,detectRetina:!1,crossOrigin:!1,referrerPolicy:!1},initialize:function(f,v){this._url=f,v=w(this,v),v.detectRetina&&dt.retina&&v.maxZoom>0?(v.tileSize=Math.floor(v.tileSize/2),v.zoomReverse?(v.zoomOffset--,v.minZoom=Math.min(v.maxZoom,v.minZoom+1)):(v.zoomOffset++,v.maxZoom=Math.max(v.minZoom,v.maxZoom-1)),v.minZoom=Math.max(0,v.minZoom)):v.zoomReverse?v.minZoom=Math.min(v.maxZoom,v.minZoom):v.maxZoom=Math.max(v.minZoom,v.maxZoom),typeof v.subdomains=="string"&&(v.subdomains=v.subdomains.split("")),this.on("tileunload",this._onTileRemove)},setUrl:function(f,v){return this._url===f&&v===void 0&&(v=!0),this._url=f,v||this.redraw(),this},createTile:function(f,v){var T=document.createElement("img");return Ct(T,"load",o(this._tileOnLoad,this,v,T)),Ct(T,"error",o(this._tileOnError,this,v,T)),(this.options.crossOrigin||this.options.crossOrigin==="")&&(T.crossOrigin=this.options.crossOrigin===!0?"":this.options.crossOrigin),typeof this.options.referrerPolicy=="string"&&(T.referrerPolicy=this.options.referrerPolicy),T.alt="",T.src=this.getTileUrl(f),T},getTileUrl:function(f){var v={r:dt.retina?"@2x":"",s:this._getSubdomain(f),x:f.x,y:f.y,z:this._getZoomForUrl()};if(this._map&&!this._map.options.crs.infinite){var T=this._globalTileRange.max.y-f.y;this.options.tms&&(v.y=T),v["-y"]=T}return P(this._url,s(v,this.options))},_tileOnLoad:function(f,v){dt.ielt9?setTimeout(o(f,this,null,v),0):f(null,v)},_tileOnError:function(f,v,T){var A=this.options.errorTileUrl;A&&v.getAttribute("src")!==A&&(v.src=A),f(T,v)},_onTileRemove:function(f){f.tile.onload=null},_getZoomForUrl:function(){var f=this._tileZoom,v=this.options.maxZoom,T=this.options.zoomReverse,A=this.options.zoomOffset;return T&&(f=v-f),f+A},_getSubdomain:function(f){var v=Math.abs(f.x+f.y)%this.options.subdomains.length;return this.options.subdomains[v]},_abortLoading:function(){var f,v;for(f in this._tiles)if(this._tiles[f].coords.z!==this._tileZoom&&(v=this._tiles[f].el,v.onload=p,v.onerror=p,!v.complete)){v.src=D;var T=this._tiles[f].coords;wn(v),delete this._tiles[f],this.fire("tileabort",{tile:v,coords:T})}},_removeTile:function(f){var v=this._tiles[f];if(v)return v.el.setAttribute("src",D),oo.prototype._removeTile.call(this,f)},_tileReady:function(f,v,T){if(!(!this._map||T&&T.getAttribute("src")===D))return oo.prototype._tileReady.call(this,f,v,T)}});function Jf(f,v){return new lo(f,v)}var Md=lo.extend({defaultWmsParams:{service:"WMS",request:"GetMap",layers:"",styles:"",format:"image/jpeg",transparent:!1,version:"1.1.1"},options:{crs:null,uppercase:!1},initialize:function(f,v){this._url=f;var T=s({},this.defaultWmsParams);for(var A in v)A in this.options||(T[A]=v[A]);v=w(this,v);var V=v.detectRetina&&dt.retina?2:1,Q=this.getTileSize();T.width=Q.x*V,T.height=Q.y*V,this.wmsParams=T},onAdd:function(f){this._crs=this.options.crs||f.options.crs,this._wmsVersion=parseFloat(this.wmsParams.version);var v=this._wmsVersion>=1.3?"crs":"srs";this.wmsParams[v]=this._crs.code,lo.prototype.onAdd.call(this,f)},getTileUrl:function(f){var v=this._tileCoordsToNwSe(f),T=this._crs,A=se(T.project(v[0]),T.project(v[1])),V=A.min,Q=A.max,pe=(this._wmsVersion>=1.3&&this._crs===Zl?[V.y,V.x,Q.y,Q.x]:[V.x,V.y,Q.x,Q.y]).join(","),Ne=lo.prototype.getTileUrl.call(this,f);return Ne+j(this.wmsParams,Ne,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+pe},setParams:function(f,v){return s(this.wmsParams,f),v||this.redraw(),this}});function Um(f,v){return new Md(f,v)}lo.WMS=Md,Jf.wms=Um;var Ai=Vr.extend({options:{padding:.1},initialize:function(f){w(this,f),c(this),this._layers=this._layers||{}},onAdd:function(){this._container||(this._initContainer(),Dt(this._container,"leaflet-zoom-animated")),this.getPane().appendChild(this._container),this._update(),this.on("update",this._updatePaths,this)},onRemove:function(){this.off("update",this._updatePaths,this),this._destroyContainer()},getEvents:function(){var f={viewreset:this._reset,zoom:this._onZoom,moveend:this._update,zoomend:this._onZoomEnd};return this._zoomAnimated&&(f.zoomanim=this._onAnimZoom),f},_onAnimZoom:function(f){this._updateTransform(f.center,f.zoom)},_onZoom:function(){this._updateTransform(this._map.getCenter(),this._map.getZoom())},_updateTransform:function(f,v){var T=this._map.getZoomScale(v,this._zoom),A=this._map.getSize().multiplyBy(.5+this.options.padding),V=this._map.project(this._center,v),Q=A.multiplyBy(-T).add(V).subtract(this._map._getNewPixelOrigin(f,v));dt.any3d?qr(this._container,Q,T):An(this._container,Q)},_reset:function(){this._update(),this._updateTransform(this._center,this._zoom);for(var f in this._layers)this._layers[f]._reset()},_onZoomEnd:function(){for(var f in this._layers)this._layers[f]._project()},_updatePaths:function(){for(var f in this._layers)this._layers[f]._update()},_update:function(){var f=this.options.padding,v=this._map.getSize(),T=this._map.containerPointToLayerPoint(v.multiplyBy(-f)).round();this._bounds=new H(T,T.add(v.multiplyBy(1+f*2)).round()),this._center=this._map.getCenter(),this._zoom=this._map.getZoom()}}),Qf=Ai.extend({options:{tolerance:0},getEvents:function(){var f=Ai.prototype.getEvents.call(this);return f.viewprereset=this._onViewPreReset,f},_onViewPreReset:function(){this._postponeUpdatePaths=!0},onAdd:function(){Ai.prototype.onAdd.call(this),this._draw()},_initContainer:function(){var f=this._container=document.createElement("canvas");Ct(f,"mousemove",this._onMouseMove,this),Ct(f,"click dblclick mousedown mouseup contextmenu",this._onClick,this),Ct(f,"mouseout",this._handleMouseOut,this),f._leaflet_disable_events=!0,this._ctx=f.getContext("2d")},_destroyContainer:function(){G(this._redrawRequest),delete this._ctx,wn(this._container),cn(this._container),delete this._container},_updatePaths:function(){if(!this._postponeUpdatePaths){var f;this._redrawBounds=null;for(var v in this._layers)f=this._layers[v],f._update();this._redraw()}},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ai.prototype._update.call(this);var f=this._bounds,v=this._container,T=f.getSize(),A=dt.retina?2:1;An(v,f.min),v.width=A*T.x,v.height=A*T.y,v.style.width=T.x+"px",v.style.height=T.y+"px",dt.retina&&this._ctx.scale(2,2),this._ctx.translate(-f.min.x,-f.min.y),this.fire("update")}},_reset:function(){Ai.prototype._reset.call(this),this._postponeUpdatePaths&&(this._postponeUpdatePaths=!1,this._updatePaths())},_initPath:function(f){this._updateDashArray(f),this._layers[c(f)]=f;var v=f._order={layer:f,prev:this._drawLast,next:null};this._drawLast&&(this._drawLast.next=v),this._drawLast=v,this._drawFirst=this._drawFirst||this._drawLast},_addPath:function(f){this._requestRedraw(f)},_removePath:function(f){var v=f._order,T=v.next,A=v.prev;T?T.prev=A:this._drawLast=A,A?A.next=T:this._drawFirst=T,delete f._order,delete this._layers[c(f)],this._requestRedraw(f)},_updatePath:function(f){this._extendRedrawBounds(f),f._project(),f._update(),this._requestRedraw(f)},_updateStyle:function(f){this._updateDashArray(f),this._requestRedraw(f)},_updateDashArray:function(f){if(typeof f.options.dashArray=="string"){var v=f.options.dashArray.split(/[, ]+/),T=[],A,V;for(V=0;V<v.length;V++){if(A=Number(v[V]),isNaN(A))return;T.push(A)}f.options._dashArray=T}else f.options._dashArray=f.options.dashArray},_requestRedraw:function(f){this._map&&(this._extendRedrawBounds(f),this._redrawRequest=this._redrawRequest||W(this._redraw,this))},_extendRedrawBounds:function(f){if(f._pxBounds){var v=(f.options.weight||0)+1;this._redrawBounds=this._redrawBounds||new H,this._redrawBounds.extend(f._pxBounds.min.subtract([v,v])),this._redrawBounds.extend(f._pxBounds.max.add([v,v]))}},_redraw:function(){this._redrawRequest=null,this._redrawBounds&&(this._redrawBounds.min._floor(),this._redrawBounds.max._ceil()),this._clear(),this._draw(),this._redrawBounds=null},_clear:function(){var f=this._redrawBounds;if(f){var v=f.getSize();this._ctx.clearRect(f.min.x,f.min.y,v.x,v.y)}else this._ctx.save(),this._ctx.setTransform(1,0,0,1,0,0),this._ctx.clearRect(0,0,this._container.width,this._container.height),this._ctx.restore()},_draw:function(){var f,v=this._redrawBounds;if(this._ctx.save(),v){var T=v.getSize();this._ctx.beginPath(),this._ctx.rect(v.min.x,v.min.y,T.x,T.y),this._ctx.clip()}this._drawing=!0;for(var A=this._drawFirst;A;A=A.next)f=A.layer,(!v||f._pxBounds&&f._pxBounds.intersects(v))&&f._updatePath();this._drawing=!1,this._ctx.restore()},_updatePoly:function(f,v){if(this._drawing){var T,A,V,Q,pe=f._parts,Ne=pe.length,Ee=this._ctx;if(Ne){for(Ee.beginPath(),T=0;T<Ne;T++){for(A=0,V=pe[T].length;A<V;A++)Q=pe[T][A],Ee[A?"lineTo":"moveTo"](Q.x,Q.y);v&&Ee.closePath()}this._fillStroke(Ee,f)}}},_updateCircle:function(f){if(!(!this._drawing||f._empty())){var v=f._point,T=this._ctx,A=Math.max(Math.round(f._radius),1),V=(Math.max(Math.round(f._radiusY),1)||A)/A;V!==1&&(T.save(),T.scale(1,V)),T.beginPath(),T.arc(v.x,v.y/V,A,0,Math.PI*2,!1),V!==1&&T.restore(),this._fillStroke(T,f)}},_fillStroke:function(f,v){var T=v.options;T.fill&&(f.globalAlpha=T.fillOpacity,f.fillStyle=T.fillColor||T.color,f.fill(T.fillRule||"evenodd")),T.stroke&&T.weight!==0&&(f.setLineDash&&f.setLineDash(v.options&&v.options._dashArray||[]),f.globalAlpha=T.opacity,f.lineWidth=T.weight,f.strokeStyle=T.color,f.lineCap=T.lineCap,f.lineJoin=T.lineJoin,f.stroke())},_onClick:function(f){for(var v=this._map.mouseEventToLayerPoint(f),T,A,V=this._drawFirst;V;V=V.next)T=V.layer,T.options.interactive&&T._containsPoint(v)&&(!(f.type==="click"||f.type==="preclick")||!this._map._draggableMoved(T))&&(A=T);this._fireEvent(A?[A]:!1,f)},_onMouseMove:function(f){if(!(!this._map||this._map.dragging.moving()||this._map._animatingZoom)){var v=this._map.mouseEventToLayerPoint(f);this._handleMouseHover(f,v)}},_handleMouseOut:function(f){var v=this._hoveredLayer;v&&(xn(this._container,"leaflet-interactive"),this._fireEvent([v],f,"mouseout"),this._hoveredLayer=null,this._mouseHoverThrottled=!1)},_handleMouseHover:function(f,v){if(!this._mouseHoverThrottled){for(var T,A,V=this._drawFirst;V;V=V.next)T=V.layer,T.options.interactive&&T._containsPoint(v)&&(A=T);A!==this._hoveredLayer&&(this._handleMouseOut(f),A&&(Dt(this._container,"leaflet-interactive"),this._fireEvent([A],f,"mouseover"),this._hoveredLayer=A)),this._fireEvent(this._hoveredLayer?[this._hoveredLayer]:!1,f),this._mouseHoverThrottled=!0,setTimeout(o(function(){this._mouseHoverThrottled=!1},this),32)}},_fireEvent:function(f,v,T){this._map._fireDOMEvent(v,T||v.type,f)},_bringToFront:function(f){var v=f._order;if(v){var T=v.next,A=v.prev;if(T)T.prev=A;else return;A?A.next=T:T&&(this._drawFirst=T),v.prev=this._drawLast,this._drawLast.next=v,v.next=null,this._drawLast=v,this._requestRedraw(f)}},_bringToBack:function(f){var v=f._order;if(v){var T=v.next,A=v.prev;if(A)A.next=T;else return;T?T.prev=A:A&&(this._drawLast=A),v.prev=null,v.next=this._drawFirst,this._drawFirst.prev=v,this._drawFirst=v,this._requestRedraw(f)}}});function Xf(f){return dt.canvas?new Qf(f):null}var ic=(function(){try{return document.namespaces.add("lvml","urn:schemas-microsoft-com:vml"),function(f){return document.createElement("<lvml:"+f+' class="lvml">')}}catch{}return function(f){return document.createElement("<"+f+' xmlns="urn:schemas-microsoft.com:vml" class="lvml">')}})(),Bm={_initContainer:function(){this._container=Ot("div","leaflet-vml-container")},_update:function(){this._map._animatingZoom||(Ai.prototype._update.call(this),this.fire("update"))},_initPath:function(f){var v=f._container=ic("shape");Dt(v,"leaflet-vml-shape "+(this.options.className||"")),v.coordsize="1 1",f._path=ic("path"),v.appendChild(f._path),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){var v=f._container;this._container.appendChild(v),f.options.interactive&&f.addInteractiveTarget(v)},_removePath:function(f){var v=f._container;wn(v),f.removeInteractiveTarget(v),delete this._layers[c(f)]},_updateStyle:function(f){var v=f._stroke,T=f._fill,A=f.options,V=f._container;V.stroked=!!A.stroke,V.filled=!!A.fill,A.stroke?(v||(v=f._stroke=ic("stroke")),V.appendChild(v),v.weight=A.weight+"px",v.color=A.color,v.opacity=A.opacity,A.dashArray?v.dashStyle=O(A.dashArray)?A.dashArray.join(" "):A.dashArray.replace(/( *, *)/g," "):v.dashStyle="",v.endcap=A.lineCap.replace("butt","flat"),v.joinstyle=A.lineJoin):v&&(V.removeChild(v),f._stroke=null),A.fill?(T||(T=f._fill=ic("fill")),V.appendChild(T),T.color=A.fillColor||A.color,T.opacity=A.fillOpacity):T&&(V.removeChild(T),f._fill=null)},_updateCircle:function(f){var v=f._point.round(),T=Math.round(f._radius),A=Math.round(f._radiusY||T);this._setPath(f,f._empty()?"M0 0":"AL "+v.x+","+v.y+" "+T+","+A+" 0,"+65535*360)},_setPath:function(f,v){f._path.v=v},_bringToFront:function(f){Ni(f._container)},_bringToBack:function(f){hs(f._container)}},oi=dt.vml?ic:Ye,Xo=Ai.extend({_initContainer:function(){this._container=oi("svg"),this._container.setAttribute("pointer-events","none"),this._rootGroup=oi("g"),this._container.appendChild(this._rootGroup)},_destroyContainer:function(){wn(this._container),cn(this._container),delete this._container,delete this._rootGroup,delete this._svgSize},_update:function(){if(!(this._map._animatingZoom&&this._bounds)){Ai.prototype._update.call(this);var f=this._bounds,v=f.getSize(),T=this._container;(!this._svgSize||!this._svgSize.equals(v))&&(this._svgSize=v,T.setAttribute("width",v.x),T.setAttribute("height",v.y)),An(T,f.min),T.setAttribute("viewBox",[f.min.x,f.min.y,v.x,v.y].join(" ")),this.fire("update")}},_initPath:function(f){var v=f._path=oi("path");f.options.className&&Dt(v,f.options.className),f.options.interactive&&Dt(v,"leaflet-interactive"),this._updateStyle(f),this._layers[c(f)]=f},_addPath:function(f){this._rootGroup||this._initContainer(),this._rootGroup.appendChild(f._path),f.addInteractiveTarget(f._path)},_removePath:function(f){wn(f._path),f.removeInteractiveTarget(f._path),delete this._layers[c(f)]},_updatePath:function(f){f._project(),f._update()},_updateStyle:function(f){var v=f._path,T=f.options;v&&(T.stroke?(v.setAttribute("stroke",T.color),v.setAttribute("stroke-opacity",T.opacity),v.setAttribute("stroke-width",T.weight),v.setAttribute("stroke-linecap",T.lineCap),v.setAttribute("stroke-linejoin",T.lineJoin),T.dashArray?v.setAttribute("stroke-dasharray",T.dashArray):v.removeAttribute("stroke-dasharray"),T.dashOffset?v.setAttribute("stroke-dashoffset",T.dashOffset):v.removeAttribute("stroke-dashoffset")):v.setAttribute("stroke","none"),T.fill?(v.setAttribute("fill",T.fillColor||T.color),v.setAttribute("fill-opacity",T.fillOpacity),v.setAttribute("fill-rule",T.fillRule||"evenodd")):v.setAttribute("fill","none"))},_updatePoly:function(f,v){this._setPath(f,ve(f._parts,v))},_updateCircle:function(f){var v=f._point,T=Math.max(Math.round(f._radius),1),A=Math.max(Math.round(f._radiusY),1)||T,V="a"+T+","+A+" 0 1,0 ",Q=f._empty()?"M0 0":"M"+(v.x-T)+","+v.y+V+T*2+",0 "+V+-T*2+",0 ";this._setPath(f,Q)},_setPath:function(f,v){f._path.setAttribute("d",v)},_bringToFront:function(f){Ni(f._path)},_bringToBack:function(f){hs(f._path)}});dt.vml&&Xo.include(Bm);function Mu(f){return dt.svg||dt.vml?new Xo(f):null}Ht.include({getRenderer:function(f){var v=f.options.renderer||this._getPaneRenderer(f.options.pane)||this.options.renderer||this._renderer;return v||(v=this._renderer=this._createRenderer()),this.hasLayer(v)||this.addLayer(v),v},_getPaneRenderer:function(f){if(f==="overlayPane"||f===void 0)return!1;var v=this._paneRenderers[f];return v===void 0&&(v=this._createRenderer({pane:f}),this._paneRenderers[f]=v),v},_createRenderer:function(f){return this.options.preferCanvas&&Xf(f)||Mu(f)}});var Vm=ys.extend({initialize:function(f,v){ys.prototype.initialize.call(this,this._boundsToLatLngs(f),v)},setBounds:function(f){return this.setLatLngs(this._boundsToLatLngs(f))},_boundsToLatLngs:function(f){return f=ce(f),[f.getSouthWest(),f.getNorthWest(),f.getNorthEast(),f.getSouthEast()]}});function qy(f,v){return new Vm(f,v)}Xo.create=oi,Xo.pointsToPath=ve,es.geometryToLayer=Oi,es.coordsToLatLng=ro,es.coordsToLatLngs=ga,es.latLngToCoords=so,es.latLngsToCoords=io,es.getFeature=Ii,es.asFeature=ao,Ht.mergeOptions({boxZoom:!0});var ac=Mr.extend({initialize:function(f){this._map=f,this._container=f._container,this._pane=f._panes.overlayPane,this._resetStateTimeout=0,f.on("unload",this._destroy,this)},addHooks:function(){Ct(this._container,"mousedown",this._onMouseDown,this)},removeHooks:function(){cn(this._container,"mousedown",this._onMouseDown,this)},moved:function(){return this._moved},_destroy:function(){wn(this._pane),delete this._pane},_resetState:function(){this._resetStateTimeout=0,this._moved=!1},_clearDeferredResetState:function(){this._resetStateTimeout!==0&&(clearTimeout(this._resetStateTimeout),this._resetStateTimeout=0)},_onMouseDown:function(f){if(!f.shiftKey||f.which!==1&&f.button!==1)return!1;this._clearDeferredResetState(),this._resetState(),Kt(),$a(),this._startPoint=this._map.mouseEventToContainerPoint(f),Ct(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseMove:function(f){this._moved||(this._moved=!0,this._box=Ot("div","leaflet-zoom-box",this._container),Dt(this._container,"leaflet-crosshair"),this._map.fire("boxzoomstart")),this._point=this._map.mouseEventToContainerPoint(f);var v=new H(this._point,this._startPoint),T=v.getSize();An(this._box,v.min),this._box.style.width=T.x+"px",this._box.style.height=T.y+"px"},_finish:function(){this._moved&&(wn(this._box),xn(this._container,"leaflet-crosshair")),Ti(),Ha(),cn(document,{contextmenu:Ur,mousemove:this._onMouseMove,mouseup:this._onMouseUp,keydown:this._onKeyDown},this)},_onMouseUp:function(f){if(!(f.which!==1&&f.button!==1)&&(this._finish(),!!this._moved)){this._clearDeferredResetState(),this._resetStateTimeout=setTimeout(o(this._resetState,this),0);var v=new ie(this._map.containerPointToLatLng(this._startPoint),this._map.containerPointToLatLng(this._point));this._map.fitBounds(v).fire("boxzoomend",{boxZoomBounds:v})}},_onKeyDown:function(f){f.keyCode===27&&(this._finish(),this._clearDeferredResetState(),this._resetState())}});Ht.addInitHook("addHandler","boxZoom",ac),Ht.mergeOptions({doubleClickZoom:!0});var Wm=Mr.extend({addHooks:function(){this._map.on("dblclick",this._onDoubleClick,this)},removeHooks:function(){this._map.off("dblclick",this._onDoubleClick,this)},_onDoubleClick:function(f){var v=this._map,T=v.getZoom(),A=v.options.zoomDelta,V=f.originalEvent.shiftKey?T-A:T+A;v.options.doubleClickZoom==="center"?v.setZoom(V):v.setZoomAround(f.containerPoint,V)}});Ht.addInitHook("addHandler","doubleClickZoom",Wm),Ht.mergeOptions({dragging:!0,inertia:!0,inertiaDeceleration:3400,inertiaMaxSpeed:1/0,easeLinearity:.2,worldCopyJump:!1,maxBoundsViscosity:0});var eh=Mr.extend({addHooks:function(){if(!this._draggable){var f=this._map;this._draggable=new Br(f._mapPane,f._container),this._draggable.on({dragstart:this._onDragStart,drag:this._onDrag,dragend:this._onDragEnd},this),this._draggable.on("predrag",this._onPreDragLimit,this),f.options.worldCopyJump&&(this._draggable.on("predrag",this._onPreDragWrap,this),f.on("zoomend",this._onZoomEnd,this),f.whenReady(this._onZoomEnd,this))}Dt(this._map._container,"leaflet-grab leaflet-touch-drag"),this._draggable.enable(),this._positions=[],this._times=[]},removeHooks:function(){xn(this._map._container,"leaflet-grab"),xn(this._map._container,"leaflet-touch-drag"),this._draggable.disable()},moved:function(){return this._draggable&&this._draggable._moved},moving:function(){return this._draggable&&this._draggable._moving},_onDragStart:function(){var f=this._map;if(f._stop(),this._map.options.maxBounds&&this._map.options.maxBoundsViscosity){var v=ce(this._map.options.maxBounds);this._offsetLimit=se(this._map.latLngToContainerPoint(v.getNorthWest()).multiplyBy(-1),this._map.latLngToContainerPoint(v.getSouthEast()).multiplyBy(-1).add(this._map.getSize())),this._viscosity=Math.min(1,Math.max(0,this._map.options.maxBoundsViscosity))}else this._offsetLimit=null;f.fire("movestart").fire("dragstart"),f.options.inertia&&(this._positions=[],this._times=[])},_onDrag:function(f){if(this._map.options.inertia){var v=this._lastTime=+new Date,T=this._lastPos=this._draggable._absPos||this._draggable._newPos;this._positions.push(T),this._times.push(v),this._prunePositions(v)}this._map.fire("move",f).fire("drag",f)},_prunePositions:function(f){for(;this._positions.length>1&&f-this._times[0]>50;)this._positions.shift(),this._times.shift()},_onZoomEnd:function(){var f=this._map.getSize().divideBy(2),v=this._map.latLngToLayerPoint([0,0]);this._initialWorldOffset=v.subtract(f).x,this._worldWidth=this._map.getPixelWorldBounds().getSize().x},_viscousLimit:function(f,v){return f-(f-v)*this._viscosity},_onPreDragLimit:function(){if(!(!this._viscosity||!this._offsetLimit)){var f=this._draggable._newPos.subtract(this._draggable._startPos),v=this._offsetLimit;f.x<v.min.x&&(f.x=this._viscousLimit(f.x,v.min.x)),f.y<v.min.y&&(f.y=this._viscousLimit(f.y,v.min.y)),f.x>v.max.x&&(f.x=this._viscousLimit(f.x,v.max.x)),f.y>v.max.y&&(f.y=this._viscousLimit(f.y,v.max.y)),this._draggable._newPos=this._draggable._startPos.add(f)}},_onPreDragWrap:function(){var f=this._worldWidth,v=Math.round(f/2),T=this._initialWorldOffset,A=this._draggable._newPos.x,V=(A-v+T)%f+v-T,Q=(A+v+T)%f-v-T,pe=Math.abs(V+T)<Math.abs(Q+T)?V:Q;this._draggable._absPos=this._draggable._newPos.clone(),this._draggable._newPos.x=pe},_onDragEnd:function(f){var v=this._map,T=v.options,A=!T.inertia||f.noInertia||this._times.length<2;if(v.fire("dragend",f),A)v.fire("moveend");else{this._prunePositions(+new Date);var V=this._lastPos.subtract(this._positions[0]),Q=(this._lastTime-this._times[0])/1e3,pe=T.easeLinearity,Ne=V.multiplyBy(pe/Q),Ee=Ne.distanceTo([0,0]),Be=Math.min(T.inertiaMaxSpeed,Ee),rt=Ne.multiplyBy(Be/Ee),Nt=Be/(T.inertiaDeceleration*pe),$t=rt.multiplyBy(-Nt/2).round();!$t.x&&!$t.y?v.fire("moveend"):($t=v._limitOffset($t,v.options.maxBounds),W(function(){v.panBy($t,{duration:Nt,easeLinearity:pe,noMoveStart:!0,animate:!0})}))}}});Ht.addInitHook("addHandler","dragging",eh),Ht.mergeOptions({keyboard:!0,keyboardPanDelta:80});var th=Mr.extend({keyCodes:{left:[37],right:[39],down:[40],up:[38],zoomIn:[187,107,61,171],zoomOut:[189,109,54,173]},initialize:function(f){this._map=f,this._setPanDelta(f.options.keyboardPanDelta),this._setZoomDelta(f.options.zoomDelta)},addHooks:function(){var f=this._map._container;f.tabIndex<=0&&(f.tabIndex="0"),Ct(f,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.on({focus:this._addHooks,blur:this._removeHooks},this)},removeHooks:function(){this._removeHooks(),cn(this._map._container,{focus:this._onFocus,blur:this._onBlur,mousedown:this._onMouseDown},this),this._map.off({focus:this._addHooks,blur:this._removeHooks},this)},_onMouseDown:function(){if(!this._focused){var f=document.body,v=document.documentElement,T=f.scrollTop||v.scrollTop,A=f.scrollLeft||v.scrollLeft;this._map._container.focus(),window.scrollTo(A,T)}},_onFocus:function(){this._focused=!0,this._map.fire("focus")},_onBlur:function(){this._focused=!1,this._map.fire("blur")},_setPanDelta:function(f){var v=this._panKeys={},T=this.keyCodes,A,V;for(A=0,V=T.left.length;A<V;A++)v[T.left[A]]=[-1*f,0];for(A=0,V=T.right.length;A<V;A++)v[T.right[A]]=[f,0];for(A=0,V=T.down.length;A<V;A++)v[T.down[A]]=[0,f];for(A=0,V=T.up.length;A<V;A++)v[T.up[A]]=[0,-1*f]},_setZoomDelta:function(f){var v=this._zoomKeys={},T=this.keyCodes,A,V;for(A=0,V=T.zoomIn.length;A<V;A++)v[T.zoomIn[A]]=f;for(A=0,V=T.zoomOut.length;A<V;A++)v[T.zoomOut[A]]=-f},_addHooks:function(){Ct(document,"keydown",this._onKeyDown,this)},_removeHooks:function(){cn(document,"keydown",this._onKeyDown,this)},_onKeyDown:function(f){if(!(f.altKey||f.ctrlKey||f.metaKey)){var v=f.keyCode,T=this._map,A;if(v in this._panKeys){if(!T._panAnim||!T._panAnim._inProgress)if(A=this._panKeys[v],f.shiftKey&&(A=re(A).multiplyBy(3)),T.options.maxBounds&&(A=T._limitOffset(re(A),T.options.maxBounds)),T.options.worldCopyJump){var V=T.wrapLatLng(T.unproject(T.project(T.getCenter()).add(A)));T.panTo(V)}else T.panBy(A)}else if(v in this._zoomKeys)T.setZoom(T.getZoom()+(f.shiftKey?3:1)*this._zoomKeys[v]);else if(v===27&&T._popup&&T._popup.options.closeOnEscapeKey)T.closePopup();else return;Ur(f)}}});Ht.addInitHook("addHandler","keyboard",th),Ht.mergeOptions({scrollWheelZoom:!0,wheelDebounceTime:40,wheelPxPerZoomLevel:60});var Tn=Mr.extend({addHooks:function(){Ct(this._map._container,"wheel",this._onWheelScroll,this),this._delta=0},removeHooks:function(){cn(this._map._container,"wheel",this._onWheelScroll,this)},_onWheelScroll:function(f){var v=Ul(f),T=this._map.options.wheelDebounceTime;this._delta+=v,this._lastMousePos=this._map.mouseEventToContainerPoint(f),this._startTime||(this._startTime=+new Date);var A=Math.max(T-(+new Date-this._startTime),0);clearTimeout(this._timer),this._timer=setTimeout(o(this._performZoom,this),A),Ur(f)},_performZoom:function(){var f=this._map,v=f.getZoom(),T=this._map.options.zoomSnap||0;f._stop();var A=this._delta/(this._map.options.wheelPxPerZoomLevel*4),V=4*Math.log(2/(1+Math.exp(-Math.abs(A))))/Math.LN2,Q=T?Math.ceil(V/T)*T:V,pe=f._limitZoom(v+(this._delta>0?Q:-Q))-v;this._delta=0,this._startTime=null,pe&&(f.options.scrollWheelZoom==="center"?f.setZoom(v+pe):f.setZoomAround(this._lastMousePos,v+pe))}});Ht.addInitHook("addHandler","scrollWheelZoom",Tn);var nh=600;Ht.mergeOptions({tapHold:dt.touchNative&&dt.safari&&dt.mobile,tapTolerance:15});var Ed=Mr.extend({addHooks:function(){Ct(this._map._container,"touchstart",this._onDown,this)},removeHooks:function(){cn(this._map._container,"touchstart",this._onDown,this)},_onDown:function(f){if(clearTimeout(this._holdTimeout),f.touches.length===1){var v=f.touches[0];this._startPos=this._newPos=new $(v.clientX,v.clientY),this._holdTimeout=setTimeout(o(function(){this._cancel(),this._isTapValid()&&(Ct(document,"touchend",Mn),Ct(document,"touchend touchcancel",this._cancelClickPrevent),this._simulateEvent("contextmenu",v))},this),nh),Ct(document,"touchend touchcancel contextmenu",this._cancel,this),Ct(document,"touchmove",this._onMove,this)}},_cancelClickPrevent:function f(){cn(document,"touchend",Mn),cn(document,"touchend touchcancel",f)},_cancel:function(){clearTimeout(this._holdTimeout),cn(document,"touchend touchcancel contextmenu",this._cancel,this),cn(document,"touchmove",this._onMove,this)},_onMove:function(f){var v=f.touches[0];this._newPos=new $(v.clientX,v.clientY)},_isTapValid:function(){return this._newPos.distanceTo(this._startPos)<=this._map.options.tapTolerance},_simulateEvent:function(f,v){var T=new MouseEvent(f,{bubbles:!0,cancelable:!0,view:window,screenX:v.screenX,screenY:v.screenY,clientX:v.clientX,clientY:v.clientY});T._simulated=!0,v.target.dispatchEvent(T)}});Ht.addInitHook("addHandler","tapHold",Ed),Ht.mergeOptions({touchZoom:dt.touch,bounceAtZoomLimits:!0});var oc=Mr.extend({addHooks:function(){Dt(this._map._container,"leaflet-touch-zoom"),Ct(this._map._container,"touchstart",this._onTouchStart,this)},removeHooks:function(){xn(this._map._container,"leaflet-touch-zoom"),cn(this._map._container,"touchstart",this._onTouchStart,this)},_onTouchStart:function(f){var v=this._map;if(!(!f.touches||f.touches.length!==2||v._animatingZoom||this._zooming)){var T=v.mouseEventToContainerPoint(f.touches[0]),A=v.mouseEventToContainerPoint(f.touches[1]);this._centerPoint=v.getSize()._divideBy(2),this._startLatLng=v.containerPointToLatLng(this._centerPoint),v.options.touchZoom!=="center"&&(this._pinchStartLatLng=v.containerPointToLatLng(T.add(A)._divideBy(2))),this._startDist=T.distanceTo(A),this._startZoom=v.getZoom(),this._moved=!1,this._zooming=!0,v._stop(),Ct(document,"touchmove",this._onTouchMove,this),Ct(document,"touchend touchcancel",this._onTouchEnd,this),Mn(f)}},_onTouchMove:function(f){if(!(!f.touches||f.touches.length!==2||!this._zooming)){var v=this._map,T=v.mouseEventToContainerPoint(f.touches[0]),A=v.mouseEventToContainerPoint(f.touches[1]),V=T.distanceTo(A)/this._startDist;if(this._zoom=v.getScaleZoom(V,this._startZoom),!v.options.bounceAtZoomLimits&&(this._zoom<v.getMinZoom()&&V<1||this._zoom>v.getMaxZoom()&&V>1)&&(this._zoom=v._limitZoom(this._zoom)),v.options.touchZoom==="center"){if(this._center=this._startLatLng,V===1)return}else{var Q=T._add(A)._divideBy(2)._subtract(this._centerPoint);if(V===1&&Q.x===0&&Q.y===0)return;this._center=v.unproject(v.project(this._pinchStartLatLng,this._zoom).subtract(Q),this._zoom)}this._moved||(v._moveStart(!0,!1),this._moved=!0),G(this._animRequest);var pe=o(v._move,v,this._center,this._zoom,{pinch:!0,round:!1},void 0);this._animRequest=W(pe,this,!0),Mn(f)}},_onTouchEnd:function(){if(!this._moved||!this._zooming){this._zooming=!1;return}this._zooming=!1,G(this._animRequest),cn(document,"touchmove",this._onTouchMove,this),cn(document,"touchend touchcancel",this._onTouchEnd,this),this._map.options.zoomAnimation?this._map._animateZoom(this._center,this._map._limitZoom(this._zoom),!0,this._map.options.zoomSnap):this._map._resetView(this._center,this._map._limitZoom(this._zoom))}});Ht.addInitHook("addHandler","touchZoom",oc),Ht.BoxZoom=ac,Ht.DoubleClickZoom=Wm,Ht.Drag=eh,Ht.Keyboard=th,Ht.ScrollWheelZoom=Tn,Ht.TapHold=Ed,Ht.TouchZoom=oc,t.Bounds=H,t.Browser=dt,t.CRS=te,t.Canvas=Qf,t.Circle=to,t.CircleMarker=eo,t.Class=Y,t.Control=wr,t.DivIcon=Pu,t.DivOverlay=g,t.DomEvent=Za,t.DomUtil=da,t.Draggable=Br,t.Evented=me,t.FeatureGroup=gs,t.GeoJSON=es,t.GridLayer=oo,t.Handler=Mr,t.Icon=ai,t.ImageOverlay=As,t.LatLng=oe,t.LatLngBounds=ie,t.Layer=Vr,t.LayerGroup=Os,t.LineUtil=Gl,t.Map=Ht,t.Marker=xs,t.Mixin=Uo,t.Path=Is,t.Point=$,t.PolyUtil=yd,t.Polygon=ys,t.Polyline=_r,t.Popup=ku,t.PosAnimation=Ka,t.Projection=jd,t.Rectangle=Vm,t.Renderer=Ai,t.SVG=Xo,t.SVGOverlay=Jo,t.TileLayer=lo,t.Tooltip=rc,t.Transformation=Te,t.Util=Z,t.VideoOverlay=Ko,t.bind=o,t.bounds=se,t.canvas=Xf,t.circle=pa,t.circleMarker=Ql,t.control=Ds,t.divIcon=zm,t.extend=s,t.featureGroup=Kl,t.geoJSON=Xl,t.geoJson=Wr,t.gridLayer=sc,t.icon=Jl,t.imageOverlay=ec,t.latLng=de,t.latLngBounds=ce,t.layerGroup=ma,t.map=Es,t.marker=Cd,t.point=re,t.polygon=kd,t.polyline=Td,t.popup=nc,t.rectangle=qy,t.setOptions=w,t.stamp=c,t.svg=Mu,t.svgOverlay=Qo,t.tileLayer=Jf,t.tooltip=Pd,t.transformation=je,t.version=r,t.videoOverlay=tc;var $m=window.L;t.noConflict=function(){return window.L=$m,this},window.L=t}))})(Kh,Kh.exports)),Kh.exports}var Xde=Qde();const Ar=bu(Xde),eue=({events:n,users:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(Ar.layerGroup()),a=E.useRef(null),{theme:o}=ed();return E.useEffect(()=>{r.current&&!t.current&&(t.current=Ar.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),s.current.addTo(t.current),Ar.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const l=o==="dark",h=l?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",p=l?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';a.current?(a.current.setUrl(h),t.current.attributionControl.setPrefix(p)):a.current=Ar.tileLayer(h,{attribution:p}).addTo(t.current)},[o]),E.useEffect(()=>{s.current.clearLayers();const l=new Map;n.forEach(h=>{if(h.latitude&&h.longitude){const p=l.get(h.userId);(!p||new Date(h.timestamp)>new Date(p.timestamp))&&l.set(h.userId,h)}});const c=new Map(e.map(h=>[h.id,h])),d=[];if(l.forEach(h=>{const p=c.get(h.userId);if(p&&h.latitude&&h.longitude){const x=Ar.divIcon({className:"",html:`<div class="user-marker" style="background-image: url(${p.photoUrl||`https://i.pravatar.cc/150?u=${p.id}`})"></div>`,iconSize:[48,48],iconAnchor:[24,56],popupAnchor:[0,-56]}),y=Ar.marker([h.latitude,h.longitude],{icon:x});y.bindPopup(`
                    <div class="user-marker-popup">
                        <p class="popup-name">${p.name}</p>
                        <p class="popup-time">Last seen: ${We(new Date(h.timestamp),"hh:mm a")}</p>
                    </div>
                `),s.current.addLayer(y),d.push(y)}}),d.length>0&&t.current){const h=Ar.featureGroup(d);t.current.fitBounds(h.getBounds().pad(.5))}else t.current&&t.current.setView([12.9716,77.5946],12)},[n,e]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},tue=({events:n,selectedUser:e})=>{const t=E.useRef(null),r=E.useRef(null),s=E.useRef(null),a=E.useRef(null),o=E.useRef(Ar.layerGroup()),l=E.useRef(null),{theme:c}=ed(),d=E.useMemo(()=>n.filter(h=>h.userId===e&&h.latitude&&h.longitude).sort((h,p)=>new Date(h.timestamp).getTime()-new Date(p.timestamp).getTime()),[n,e]);return E.useEffect(()=>{r.current&&!t.current&&(t.current=Ar.map(r.current,{zoomControl:!1}).setView([12.9716,77.5946],12),o.current.addTo(t.current),Ar.control.zoom({position:"bottomright"}).addTo(t.current)),setTimeout(()=>t.current?.invalidateSize(),100)},[]),E.useEffect(()=>{if(!t.current)return;const h=c==="dark",y=h?"https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png":"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",_=h?'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors &copy; <a href="https://carto.com/attributions">CARTO</a>':'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors';l.current?(l.current.setUrl(y),t.current.attributionControl.setPrefix(_)):l.current=Ar.tileLayer(y,{attribution:_}).addTo(t.current)},[c]),E.useEffect(()=>{if(!t.current)return;if(o.current.clearLayers(),s.current&&(t.current.removeLayer(s.current),s.current=null),a.current&&(t.current.removeLayer(a.current),a.current=null),d.length===0){t.current.setView([12.9716,77.5946],12);return}const h=d.map(I=>[I.latitude,I.longitude]);s.current=Ar.polyline(h,{color:"#00BFA6",weight:4}).addTo(t.current);const p=h[0],x=h[h.length-1],y=Ar.marker(p,{icon:Ar.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#00BFA6;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})}),_=Ar.marker(x,{icon:Ar.divIcon({className:"",html:'<div style="width:16px;height:16px;border-radius:50%;background-color:#EF4444;border:2px solid white;"></div>',iconSize:[16,16],iconAnchor:[8,8]})});o.current.addLayer(y),o.current.addLayer(_);let w=h[0][0],j=h[0][0],C=h[0][1],P=h[0][1];h.forEach(([I,F])=>{w=Math.min(w,I),j=Math.max(j,I),C=Math.min(C,F),P=Math.max(P,F)});const O=[w,C],M=[j,P];a.current=Ar.rectangle([O,M],{color:"#FFB700",weight:2,fillOpacity:.1}).addTo(t.current);const D=Ar.latLngBounds(O,M);t.current.fitBounds(D.pad(.2))},[d]),i.jsx("div",{ref:r,style:{height:"600px",width:"100%",borderRadius:"1rem",zIndex:0}})},nue=({event:n})=>i.jsxs("div",{className:"bg-card rounded-2xl border border-border overflow-hidden shadow-sm",children:[i.jsxs("div",{className:"p-3 bg-page flex justify-between items-center",children:[i.jsx("span",{className:"text-sm font-medium text-muted",children:"User"}),i.jsx("span",{className:"font-semibold text-primary-text",children:n.userName})]}),i.jsxs("div",{className:"p-3 space-y-3 text-sm",children:[i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Event"}),i.jsx("span",{className:"font-semibold capitalize text-primary-text",children:n.type.replace("-"," ")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Timestamp"}),i.jsx("span",{className:"text-primary-text",children:We(new Date(n.timestamp),"dd MMM, yy - hh:mm a")})]}),i.jsxs("div",{className:"flex justify-between items-center",children:[i.jsx("span",{className:"text-muted font-medium",children:"Location"}),n.latitude&&n.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${n.latitude},${n.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center text-accent hover:underline",children:[i.jsx(kl,{className:"h-4 w-4 mr-1"})," View on Map"]}):i.jsx("span",{className:"text-primary-text",children:"-"})]})]})]}),rue=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(!0),[c,d]=E.useState(We(new Date,"yyyy-MM-dd")),[h,p]=E.useState(We(new Date,"yyyy-MM-dd")),[x,y]=E.useState("all"),_=Rt("(max-width: 767px)"),w=E.useMemo(()=>s.filter(M=>M.role==="field_officer"),[s]),j=E.useCallback(async()=>{l(!0);try{const M=new Date(c);M.setHours(0,0,0,0);const D=new Date(h);D.setHours(23,59,59,999);const[I,F]=await Promise.all([ue.getAllAttendanceEvents(M.toISOString(),D.toISOString()),ue.getUsers()]);r(I),a(F)}catch(M){console.error("Failed to fetch tracking data",M)}finally{l(!1)}},[c,h]);E.useEffect(()=>{j()},[j]);const C=E.useMemo(()=>{let M=t;x!=="all"&&(M=M.filter(I=>I.userId===x));const D=new Map(s.map(I=>[I.id,I]));return M.map(I=>({...I,userName:D.get(I.userId)?.name||"Unknown User"})).sort((I,F)=>new Date(F.timestamp).getTime()-new Date(I.timestamp).getTime())},[t,s,x]),P=E.useMemo(()=>{const M=new Set(C.map(D=>D.userId));return s.filter(D=>M.has(D.id))},[C,s]),O=()=>o?i.jsx("div",{className:"flex justify-center items-center h-96",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):n==="map"?i.jsx(eue,{events:C,users:P}):n==="route"?x==="all"?i.jsx("div",{className:"text-center py-10 text-muted",children:"Please select a specific user to view their route coverage."}):i.jsx(tue,{events:C,selectedUser:x}):_?i.jsx("div",{className:"space-y-3",children:C.length===0?i.jsx("div",{className:"text-center py-10 text-muted",children:"No events found."}):C.map(M=>i.jsx(nue,{event:M},M.id))}):i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full divide-y divide-border responsive-table",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"User"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Event"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Timestamp"}),i.jsx("th",{scope:"col",className:"px-6 py-3 text-left text-xs font-medium text-muted uppercase",children:"Location"})]})}),i.jsx("tbody",{children:C.length===0?i.jsx("tr",{children:i.jsx("td",{colSpan:4,className:"text-center py-10 text-muted",children:"No events found."})}):C.map(M=>i.jsxs("tr",{children:[i.jsx("td",{"data-label":"User",className:"px-6 py-4 whitespace-nowrap font-medium",children:M.userName}),i.jsx("td",{"data-label":"Event",className:"px-6 py-4 whitespace-nowrap capitalize",children:M.type.replace("-"," ")}),i.jsx("td",{"data-label":"Timestamp",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:We(new Date(M.timestamp),"dd MMM, yyyy - hh:mm a")}),i.jsx("td",{"data-label":"Location",className:"px-6 py-4 whitespace-nowrap text-sm text-muted",children:M.latitude&&M.longitude?i.jsxs("a",{href:`https://www.google.com/maps/search/?api=1&query=${M.latitude},${M.longitude}`,target:"_blank",rel:"noopener noreferrer",className:"flex items-center md:justify-start justify-end text-accent hover:underline",children:[i.jsx(kl,{className:"h-4 w-4 mr-1"})," View on Map"]}):"-"})]},M.id))})]})});return i.jsxs("div",{className:"p-4 border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsxs("div",{className:"mb-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row justify-between sm:items-center gap-4",children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text flex-shrink-0",children:"User Activity Tracking"}),i.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-2 w-full sm:w-auto justify-end flex-wrap",children:[i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(En,{label:"",id:"start-date",value:c,onChange:d})}),i.jsx("div",{className:"w-full sm:w-40",children:i.jsx(En,{label:"",id:"end-date",value:h,onChange:p})}),i.jsx("div",{className:"w-full sm:w-48",children:i.jsxs(Ze,{label:"",id:"user-select",value:x,onChange:M=>y(M.target.value),children:[i.jsx("option",{value:"all",children:"All Users"}),w.map(M=>i.jsx("option",{value:M.id,children:M.name},M.id))]})})]})]}),i.jsx("div",{className:"mt-4",children:i.jsxs("div",{className:"bg-page p-1 rounded-full flex items-center w-fit",children:[i.jsxs("button",{onClick:()=>e("list"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="list"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(TJ,{className:"h-4 w-4"}),"List View"]}),i.jsxs("button",{onClick:()=>e("map"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="map"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(c3,{className:"h-4 w-4"}),"Map View"]}),i.jsxs("button",{onClick:()=>e("route"),className:`px-3 py-1 text-sm font-semibold rounded-full flex items-center gap-2 transition-colors duration-200 ${n==="route"?"bg-accent text-white shadow-sm":"text-muted hover:text-primary-text"}`,children:[i.jsx(RJ,{className:"h-4 w-4"}),"Route View"]})]})})]}),i.jsx("div",{className:"mt-6",children:O()})]})},sue=(n,e,t,r)=>{const a=n*Math.PI/180,o=t*Math.PI/180,l=(t-n)*Math.PI/180,c=(r-e)*Math.PI/180,d=Math.sin(l/2)*Math.sin(l/2)+Math.cos(a)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(d),Math.sqrt(1-d)))},iue=()=>{const{user:n}=jt(),{colorScheme:e}=an(),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(""),[c,d]=E.useState("100"),[h,p]=E.useState(""),[x,y]=E.useState(""),[_,w]=E.useState(""),[j,C]=E.useState(""),[P,O]=E.useState([]),[M,D]=E.useState(!0),[I,F]=E.useState(null),[q,B]=E.useState(null);E.useEffect(()=>{(async()=>{try{const[K,re]=await Promise.all([ue.getLocations(),ue.getUsers()]);r(K),a(re)}catch(K){console.error(K),F({message:"Failed to load locations or users.",type:"error"})}finally{D(!1)}})()},[]);const U=ot.useMemo(()=>{const $=new Map;return s.forEach(K=>$.set(K.id,K.name)),$},[s]),W=async()=>{try{const $=await ue.getLocations();r($)}catch($){console.error($),F({message:"Failed to refresh locations.",type:"error"})}},G=async()=>{try{const $=await ay(),{latitude:K,longitude:re}=$.coords;p(K.toString()),y(re.toString());try{const H=await mm(K,re);_||w(H),o||l(H)}catch(H){console.warn("Reverse geocode failed",H)}}catch($){console.error($),F({message:"Unable to retrieve current location.",type:"error"})}},Z=async()=>{const $=parseFloat(c),K=parseFloat(h),re=parseFloat(x);if(isNaN($)||$<10||$>1e3){F({message:"Radius must be between 10 and 1000 meters.",type:"error"});return}if(isNaN(K)||isNaN(re)){F({message:"Please provide valid latitude and longitude.",type:"error"});return}try{const H=_||await mm(K,re);if(!q&&t.some(ie=>sue(K,re,ie.latitude,ie.longitude)<10)){F({message:"A location already exists at these coordinates. Please use a different location.",type:"error"});return}q?(await ue.updateLocation(q,{name:o||H,latitude:K,longitude:re,radius:$,address:H}),F({message:"Location updated successfully.",type:"success"}),B(null)):(await ue.createLocation({name:o||H,latitude:K,longitude:re,radius:$,address:H,createdBy:n?.id||null}),F({message:"Location created successfully.",type:"success"})),l(""),d("100"),p(""),y(""),w(""),await W()}catch(H){console.error(H);const se=H?.message||(q?"Failed to update location.":"Failed to create location.");F({message:se,type:"error"})}},Y=async()=>{if(!j||P.length===0){F({message:"Please select a user and at least one location.",type:"error"});return}try{await Promise.all(P.map($=>ue.assignLocationToUser(j,$))),F({message:"Location(s) assigned to user.",type:"success"}),C(""),O([])}catch($){console.error($),F({message:"Failed to assign location(s).",type:"error"})}},ae=$=>{B($.id),l($.name||""),d($.radius.toString()),p($.latitude.toString()),y($.longitude.toString()),w($.address||""),window.scrollTo({top:0,behavior:"smooth"})},ee=()=>{B(null),l(""),d("100"),p(""),y(""),w("")},me=async $=>{if(window.confirm("Are you sure you want to delete this location? This will remove it from all users and the database."))try{await ue.deleteLocation($),F({message:"Location deleted successfully from all users and database.",type:"success"}),await W()}catch(K){console.error(K);const re=K?.message||"Failed to delete location.";F({message:re,type:"error"})}};return i.jsxs("div",{className:"p-4 md:p-6 w-full",children:[I&&i.jsx(pt,{message:I.message,type:I.type,onDismiss:()=>F(null)}),i.jsxs("div",{className:"border-0 shadow-none md:bg-card md:p-6 md:rounded-xl md:shadow-card",children:[i.jsx(na,{title:"Location Management"}),i.jsx("p",{className:"text-muted -mt-4 mb-6",children:"Define geofenced locations and assign them to staff. Only checkins within these locations will be accepted."})]}),i.jsxs("div",{className:"mt-6 space-y-6",children:[i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(kl,{className:"h-5 w-5 mr-2 text-muted"})," ",q?"Edit Location":"Add New Location"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[i.jsx(we,{label:"Name (optional)",id:"locName",value:o,onChange:$=>l($.target.value),placeholder:"e.g. Office HQ"}),i.jsx(we,{label:"Radius (meters)",id:"locRadius",type:"number",value:c,onChange:$=>d($.target.value),min:"10",max:"1000"}),i.jsx(we,{label:"Latitude",id:"locLat",type:"number",value:h,onChange:$=>p($.target.value),placeholder:"12.9716"}),i.jsx(we,{label:"Longitude",id:"locLng",type:"number",value:x,onChange:$=>y($.target.value),placeholder:"77.5946"}),i.jsx(we,{label:"Address (optional)",id:"locAddr",value:_,onChange:$=>w($.target.value),placeholder:"Street, City, State"})]}),i.jsxs("div",{className:"flex flex-wrap mt-4 gap-4",children:[i.jsxs(ne,{variant:"secondary",onClick:G,children:[i.jsx(d3,{className:"h-4 w-4 mr-2"})," Use Current Location"]}),q?i.jsxs(i.Fragment,{children:[i.jsxs(ne,{onClick:Z,children:[i.jsx(Cs,{className:"h-4 w-4 mr-2"})," Save Changes"]}),i.jsx(ne,{variant:"secondary",onClick:ee,children:"Cancel"})]}):i.jsxs(ne,{onClick:Z,children:[i.jsx(Vt,{className:"h-4 w-4 mr-2"})," Add Location"]})]})]}),i.jsxs("section",{className:"bg-card border border-border rounded-lg p-4",children:[i.jsxs("h3",{className:"text-lg font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(Ji,{className:"h-5 w-5 mr-2 text-muted"})," Assign Location to User"]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[i.jsxs(Ze,{label:"Select User",id:"assignUser",value:j,onChange:$=>C($.target.value),children:[i.jsx("option",{value:"",children:"-- Select User --"}),s.map($=>i.jsx("option",{value:$.id,children:$.name},$.id))]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Select Location(s)"}),i.jsx("div",{className:"border border-border rounded-lg p-3 max-h-48 overflow-y-auto bg-page",children:t.length===0?i.jsx("p",{className:"text-muted text-sm",children:"No locations available."}):t.map($=>i.jsxs("label",{className:"flex items-center justify-start gap-2 py-1 text-sm",children:[i.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-accent border-gray-300 rounded",checked:P.includes($.id),onChange:K=>{O(re=>K.target.checked?[...re,$.id]:re.filter(H=>H!==$.id))}}),i.jsx("span",{children:$.name||$.address||`${$.latitude.toFixed(4)}, ${$.longitude.toFixed(4)}`})]},$.id))})]})]}),i.jsx("div",{className:"flex justify-end mt-4",children:i.jsxs(ne,{onClick:Y,className:"w-full md:w-auto",children:[i.jsx(Cs,{className:"h-4 w-4 mr-2"})," Assign"]})})]}),i.jsxs("section",{children:[i.jsxs("h3",{className:"text-xl font-semibold text-primary-text mb-4 flex items-center",children:[i.jsx(kl,{className:"h-5 w-5 mr-2 text-muted"})," Existing Locations"]}),M?i.jsx("p",{children:"Loading..."}):t.length===0?i.jsx("p",{className:"text-muted text-center md:text-left",children:"No locations defined yet."}):i.jsxs("div",{className:"space-y-4 md:space-y-0",children:[i.jsx("div",{className:"md:hidden space-y-4",children:t.map($=>i.jsxs("div",{className:"bg-card rounded-lg shadow-card p-4 border border-border",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"font-bold text-primary-text",children:$.name||"Unnamed Location"}),i.jsx("p",{className:"text-sm text-muted",children:$.address})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("button",{type:"button",className:`p-1 ${e==="blue"?"text-blue-500 hover:text-blue-700":"text-[#006B3F] hover:text-[#005632]"}`,title:"Edit",onClick:()=>ae($),children:i.jsx(dr,{className:"h-5 w-5"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>me($.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border grid grid-cols-2 gap-4 text-sm",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Radius"}),i.jsxs("p",{children:[$.radius,"m"]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Coordinates"}),i.jsxs("p",{children:[$.latitude.toFixed(4),", ",$.longitude.toFixed(4)]})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created By"}),i.jsx("p",{children:$.createdByName||U.get($.createdBy||"")||"-"})]}),i.jsxs("div",{children:[i.jsx("p",{className:"text-muted",children:"Created At"}),i.jsx("p",{children:$.createdAt?new Date($.createdAt).toLocaleDateString():"-"})]})]})]},$.id))}),i.jsx("div",{className:"hidden md:block overflow-x-auto border border-border rounded-lg",children:i.jsxs("table",{className:"min-w-full border-collapse text-sm",children:[i.jsx("thead",{className:"bg-page text-primary-text",children:i.jsxs("tr",{children:[i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Name"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Radius (m)"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Coordinates"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Address"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created By"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Created At"}),i.jsx("th",{className:"p-3 border-b border-border text-left",children:"Actions"})]})}),i.jsx("tbody",{children:t.map($=>i.jsxs("tr",{className:"border-b border-border",children:[i.jsx("td",{className:"p-3",children:$.name||"-"}),i.jsx("td",{className:"p-3",children:$.radius}),i.jsxs("td",{className:"p-3",children:[$.latitude.toFixed(4),", ",$.longitude.toFixed(4)]}),i.jsx("td",{className:"p-3",children:$.address||"-"}),i.jsx("td",{className:"p-3",children:$.createdByName||U.get($.createdBy||"")||"-"}),i.jsx("td",{className:"p-3",children:$.createdAt?new Date($.createdAt).toLocaleString():"-"}),i.jsxs("td",{className:"p-3 whitespace-nowrap",children:[i.jsx("button",{type:"button",className:`mr-3 ${e==="blue"?"text-blue-600 hover:text-blue-800":"text-[#006B3F] hover:text-[#005632]"}`,title:"Edit",onClick:()=>ae($),children:i.jsx(dr,{className:"h-4 w-4"})}),i.jsx("button",{type:"button",className:"p-2 hover:bg-red-500/10 rounded-full transition-colors",title:"Delete",onClick:()=>me($.id),children:i.jsx(rn,{className:"h-5 w-5 text-red-500"})})]})]},$.id))})]})})]})]})]})]})},aue=({isOpen:n,onClose:e,onOverride:t,employeeName:r,bankName:s,reason:a})=>n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",children:[i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex-shrink-0 h-10 w-10 flex items-center justify-center rounded-full bg-red-100",children:i.jsx(Aa,{className:"h-6 w-6 text-red-600"})}),i.jsxs("div",{className:"ml-4 flex-1",children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text",children:"Verification Alert: Name Mismatch Found"}),i.jsxs("div",{className:"mt-2 text-sm text-muted space-y-2",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"Name on ID:"}),' "',r,'"']}),i.jsxs("p",{children:[i.jsx("strong",{children:"Name on Bank Proof:"}),' "',s,'"']}),a&&i.jsxs("p",{className:"mt-2 p-2 bg-page rounded-md",children:[i.jsx("strong",{children:"AI Analysis:"})," ",i.jsx("em",{children:a})]}),i.jsx("p",{className:"mt-2",children:"Please upload the correct documents. If the names are different for a valid reason (e.g., maiden name), you can override this warning, but it will require manual verification by an administrator."})]})]})]}),i.jsxs("div",{className:"mt-6 flex flex-col sm:flex-row-reverse gap-3",children:[i.jsx(ne,{onClick:t,variant:"danger",children:"Override & Proceed"}),i.jsx(ne,{onClick:e,variant:"secondary",children:"Re-upload Documents"})]})]})}):null,oue={documents:{aadhaar:!0,pan:!0,bankProof:!0,educationCertificate:!0,salarySlip:!0,uanProof:!0,familyAadhaar:!0},verifications:{requireBengaluruAddress:!0,requireDobVerification:!0}},lue=n=>{const e=Pt({id:xe().required(),relation:xe().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),phone:xe().when("relation",{is:"Child",then:r=>r.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:r=>r.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:n.documents.familyAadhaar?Wt().nonNullable("Aadhaar proof is required for each family member."):Wt().optional().nullable()}),t=Pt({id:xe().required(),document:n.documents.educationCertificate?Wt().nonNullable("Education certificate is required."):Wt().optional().nullable()});return Pt({photo:Wt().optional().nullable(),aadhaarLinkedMobile:xe().required("Aadhaar-linked mobile number is required.").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),alternateMobile:xe().optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),idProofType:xe().oneOf(["Aadhaar","PAN","Voter ID",""]).required(),idProofFront:Wt().nonNullable("Aadhaar (Front) is required."),idProofBack:Wt().nonNullable("Aadhaar (Back) is required."),bankProof:Wt().nonNullable("Bank proof document is required."),uanProof:Wt().nonNullable("UAN proof document is required."),salarySlip:n.documents.salarySlip?Wt().nonNullable("Salary slip is required."):Wt().optional().nullable(),family:js().of(e).optional(),education:js().of(t).optional()}).defined()},Qd=n=>new Promise((e,t)=>{const r=new FileReader;r.readAsDataURL(n),r.onload=()=>e({base64:r.result.split(",")[1],type:n.type}),r.onerror=s=>t(s)}),Uh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",cue=()=>{const n=St(),e=Yn(),{user:t}=jt(),{rulesByDesignation:r}=td(),[s,a]=E.useState(!1),[o,l]=E.useState(null),[c,d]=E.useState({isOpen:!1,employeeName:"",bankName:"",reason:""}),[h,p]=E.useState(window.innerWidth<768),x=e.data.organization.designation,y=E.useMemo(()=>x&&r[x]?r[x]:oue,[x,r]),_=E.useMemo(()=>lue(y),[y]);E.useEffect(()=>{const Y=()=>p(window.innerWidth<768);return window.addEventListener("resize",Y),()=>window.removeEventListener("resize",Y)},[]),t?.role;const{control:w,handleSubmit:j,formState:{errors:C},getValues:P,watch:O}=tn({resolver:In(_),defaultValues:{aadhaarLinkedMobile:"",alternateMobile:"",photo:null,idProofType:"Aadhaar",idProofFront:null,idProofBack:null,bankProof:null,salarySlip:null,uanProof:null,family:[],education:[]}}),{fields:M,append:D,remove:I}=Ns({control:w,name:"family"}),{fields:F,append:q,remove:B}=Ns({control:w,name:"education"});O("idProofType");const U=O("family"),W=async(Y,ae=!1)=>{a(!0),e.setRequiresManualVerification(ae);try{const ee={type:Xe.OBJECT,properties:{name:{type:Xe.STRING,description:"The person's full name as written on the card."},dob:{type:Xe.STRING,description:"The person's date of birth in YYYY-MM-DD format. If only year available, return YYYY-01-01."},gender:{type:Xe.STRING,description:"Gender: 'Male', 'Female', or 'Other'."},aadhaarNumber:{type:Xe.STRING,description:"The 12-digit Aadhaar number, if present."},panNumber:{type:Xe.STRING,description:"The 10-character PAN number, if present."},voterIdNumber:{type:Xe.STRING,description:"The Voter ID number, also known as EPIC number."}}},me={type:Xe.OBJECT,properties:{address:{type:Xe.OBJECT,description:"The full address on the back of an Aadhaar card, parsed into components.",properties:{line1:{type:Xe.STRING,description:"Full address line(s) excluding city, state, pincode. e.g., 'S/O: John Doe, 123 Maple Street, Anytown'"},city:{type:Xe.STRING},state:{type:Xe.STRING},pincode:{type:Xe.STRING}}}}},$={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING,description:"The account holder's full name."},accountNumber:{type:Xe.STRING,description:"The full bank account number."},ifscCode:{type:Xe.STRING,description:"The bank's IFSC code."},bankName:{type:Xe.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:Xe.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}}},K={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:Xe.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}}},re={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING}}},H={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING}}},se={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING},institution:{type:Xe.STRING},endYear:{type:Xe.STRING}}},ie=[Y.idProofFront?Qd(Y.idProofFront.file):Promise.resolve(null),(Y.idProofType==="Aadhaar"||Y.idProofType==="Voter ID")&&Y.idProofBack?Qd(Y.idProofBack.file):Promise.resolve(null),Y.bankProof?Qd(Y.bankProof.file):Promise.resolve(null),Y.salarySlip?Qd(Y.salarySlip.file):Promise.resolve(null),Y.uanProof?Qd(Y.uanProof.file):Promise.resolve(null),...Y.family.map(st=>st.idProof?Qd(st.idProof.file):Promise.resolve(null)),...Y.education.map(st=>st.document?Qd(st.document.file):Promise.resolve(null))],[ce,oe,de,te,ye,...Ce]=await Promise.all(ie),Re=Ce.slice(0,Y.family.length),Te=Ce.slice(Y.family.length),je=ce?ue.extractDataFromImage(ce.base64,ce.type,ee,Y.idProofType):Promise.resolve({}),ke=oe&&Y.idProofType==="Aadhaar"?ue.extractDataFromImage(oe.base64,oe.type,me,"Aadhaar"):Promise.resolve({}),Ue=de?ue.extractDataFromImage(de.base64,de.type,$,"Bank"):Promise.resolve({}),Ye=te?ue.extractDataFromImage(te.base64,te.type,K,"Salary"):Promise.resolve(null),ve=ye?ue.extractDataFromImage(ye.base64,ye.type,re,"UAN"):Promise.resolve(null),Oe=Re.map(st=>st?ue.extractDataFromImage(st.base64,st.type,H,"Aadhaar"):Promise.resolve({})),Ve=Te.map(st=>st?ue.extractDataFromImage(st.base64,st.type,se):Promise.resolve({})),[qe,X,le,he,Le,...Ie]=await Promise.all([je,ke,Ue,Ye,ve,...Oe,...Ve]),ze=Ie.slice(0,Re.length),et=Ie.slice(Re.length),tt={...qe,...X},ct=tt.name||"",ht=le.accountHolderName||"";if(!ae&&ct&&ht){const{isMatch:st,reason:Cn}=await ue.crossVerifyNames(ct,ht);if(!st){d({isOpen:!0,employeeName:ct,bankName:ht,reason:Cn}),a(!1);return}}const Et={idProofType:Y.idProofType,idProofFront:Y.idProofFront,idProofBack:Y.idProofBack,photo:Y.photo,mobile:Y.aadhaarLinkedMobile,alternateMobile:Y.alternateMobile},Mt={};if(tt.name){const st=tt.name.split(" ");Et.firstName=Uh(st.shift()||""),Et.lastName=Uh(st.pop()||""),Et.middleName=Uh(st.join(" ")),Et.preferredName=Et.firstName,Mt.name=!0}if(tt.dob)try{Et.dob=We(new Date(tt.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd"),Mt.dob=!0}catch{}if(tt.gender){const st=tt.gender.toLowerCase().trim();st.includes("male")||st.includes("purush")||st==="m"?Et.gender="Male":st.includes("female")||st.includes("mahila")||st==="f"?Et.gender="Female":st.includes("transgender")&&(Et.gender="Other")}(tt.aadhaarNumber||tt.panNumber||tt.voterIdNumber)&&(Et.idProofNumber=(tt.aadhaarNumber||tt.panNumber||tt.voterIdNumber).replace(/\s/g,""),Mt.idProofNumber=!0);const en={bankProof:Y.bankProof},Jt={};if(le.accountHolderName&&(en.accountHolderName=Uh(le.accountHolderName),Jt.accountHolderName=!0),le.accountNumber){const st=le.accountNumber.replace(/\D/g,"");en.accountNumber=st,en.confirmAccountNumber=st,Jt.accountNumber=!0}le.ifscCode&&(en.ifscCode=le.ifscCode.toUpperCase().replace(/\s/g,""),Jt.ifscCode=!0),le.bankName&&(en.bankName=le.bankName),le.branchName&&(en.branchName=le.branchName);const Zt={salarySlip:Y.salarySlip,document:Y.uanProof},on={},zt={},Sn={},qn=Le?.uanNumber||he?.uanNumber;if(qn){const st=qn.replace(/\D/g,"");st.length===12&&(Zt.uanNumber=st,Zt.hasPreviousPf=!0,zt.uanNumber=!0)}if(he?.pfNumber&&(Zt.pfNumber=he.pfNumber,Zt.hasPreviousPf=!0),he?.esiNumber){const st=he.esiNumber.replace(/\D/g,"");(st.length===10||st.length===17)&&(on.esiNumber=st,on.hasEsi=!0,Sn.esiNumber=!0)}const bn=ze.map((st,Cn)=>{const Rr=Y.family[Cn];let Jr="";if(st.dob)try{Jr=We(new Date(st.dob.replace(/[-./]/g,"/")),"yyyy-MM-dd")}catch{}return{id:`fam_preupload_${Date.now()}_${Cn}`,relation:Rr.relation,name:Uh(st.name)||"",dob:Jr,gender:"",occupation:"",dependent:!1,idProof:Rr.idProof,phone:Rr.phone}}),nr=et.map((st,Cn)=>{const Rr=Y.education[Cn];return{id:`edu_preupload_${Date.now()}_${Cn}`,degree:st.degree||"",institution:st.institution||"",startYear:"",endYear:st.endYear||"",document:Rr.document}});tt.address&&e.updateAddress({present:{...tt.address,country:"India",verifiedStatus:{line1:!0,city:!0,state:!0,pincode:!0,country:!0}},permanent:{...tt.address,country:"India"},sameAsPresent:!0}),e.updateBank(en),e.setBankVerifiedStatus(Jt),e.updateUan(Zt),e.setUanVerifiedStatus(zt),e.updateEsi(on),e.setEsiVerifiedStatus(Sn),e.updateFamily(bn),e.updateEducation(nr),e.updatePersonal(Et),e.setPersonalVerifiedStatus(Mt),l({message:"Application auto-filled! Please review.",type:"success"}),n("/onboarding/add/personal")}catch(ee){const me=ee instanceof Error?ee.message:"An unexpected error occurred.";console.error("Document processing failed:",ee),l({message:`Document processing failed: ${me}`,type:"error"}),a(!1)}},G=Y=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(Y,!1)},Z=()=>{d({isOpen:!1,employeeName:"",bankName:"",reason:""}),W(P(),!0)};return i.jsxs("div",{className:"relative",children:[s&&i.jsxs("div",{className:"absolute inset-0 bg-page/90 backdrop-blur-sm z-10 flex flex-col items-center justify-center rounded-xl animate-fade-in-scale",children:[i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"}),i.jsx("p",{className:"mt-4 text-lg font-semibold text-primary-text",children:"Processing Documents..."}),i.jsx("p",{className:"text-muted text-center max-w-xs",children:"Our AI is analyzing your files. This may take a moment."})]}),i.jsxs("div",{className:`bg-card p-8 rounded-xl shadow-card w-full transition-all ${s?"blur-sm pointer-events-none":""}`,children:[i.jsx(aue,{...c,onClose:()=>d({isOpen:!1,employeeName:"",bankName:"",reason:""}),onOverride:Z}),i.jsxs("form",{onSubmit:j(G),children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload documents to auto-fill the application."}),i.jsxs("div",{className:"space-y-8 mt-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"photo",control:w,render:({field:Y})=>i.jsx(vt,{label:"Profile Photo",file:Y.value,onFileChange:Y.onChange,allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]})}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"aadhaarLinkedMobile",control:w,render:({field:Y,fieldState:ae})=>i.jsx(we,{label:"Aadhaar Linked Mobile Number",type:"tel",...Y,error:ae.error?.message})}),i.jsx(_e,{name:"alternateMobile",control:w,render:({field:Y,fieldState:ae})=>i.jsx(we,{label:"Alternative Mobile Number (Optional)",type:"tel",...Y,error:ae.error?.message})})]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"idProofFront",control:w,render:({field:Y})=>i.jsx(vt,{label:"Aadhaar (Front Side)",file:Y.value,onFileChange:Y.onChange,error:C.idProofFront?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})}),i.jsx(_e,{name:"idProofBack",control:w,render:({field:Y})=>i.jsx(vt,{label:"Aadhaar (Back Side)",file:Y.value,onFileChange:Y.onChange,error:C.idProofBack?.message,allowCapture:!0,verificationStatus:e.data.personal.verifiedStatus?.idProofNumber})})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 items-start",children:[i.jsx(_e,{name:"bankProof",control:w,render:({field:Y})=>i.jsx(vt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:Y.value,onFileChange:Y.onChange,error:C.bankProof?.message,allowCapture:!0,verificationStatus:e.data.bank.verifiedStatus?.accountNumber})}),i.jsx(_e,{name:"uanProof",control:w,render:({field:Y})=>i.jsx(vt,{label:"UAN Proof Document",file:Y.value,onFileChange:Y.onChange,error:C.uanProof?.message,allowCapture:!0,verificationStatus:e.data.uan.verifiedStatus?.uanNumber})})]}),y.documents.salarySlip&&i.jsx(_e,{name:"salarySlip",control:w,render:({field:Y})=>i.jsx(vt,{label:"Latest Salary Slip",file:Y.value,onFileChange:Y.onChange,error:C.salarySlip?.message,allowCapture:!0})}),y.documents.educationCertificate&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[F.map((Y,ae)=>i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 relative",children:[i.jsx(_e,{name:`education.${ae}.document`,control:w,render:({field:ee,fieldState:me})=>i.jsx(vt,{label:"Certificate",file:ee.value,onFileChange:ee.onChange,error:me.error?.message,allowCapture:!0})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>B(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>q({id:`edu_upload_${Date.now()}`,document:null}),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Certificate"]})]})]}),y.documents.familyAadhaar&&i.jsxs("div",{className:"pt-6 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[M.map((Y,ae)=>{const me=U?.[ae]?.relation==="Child";return i.jsxs("div",{className:"p-4 border rounded-lg bg-page/50 grid grid-cols-1 md:grid-cols-3 gap-4 items-start relative",children:[i.jsx(_e,{name:`family.${ae}.relation`,control:w,render:({field:$,fieldState:K})=>i.jsxs(Ze,{label:"Relation",error:K.error?.message,...$,children:[" ",i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})," "]})}),i.jsx(_e,{name:`family.${ae}.phone`,control:w,render:({field:$,fieldState:K})=>i.jsx(we,{label:`Phone Number${me?" (Optional)":""}`,type:"tel",...$,error:K.error?.message})}),i.jsx("div",{className:"md:col-start-1 md:col-span-3",children:i.jsx(_e,{name:`family.${ae}.idProof`,control:w,render:({field:$,fieldState:K})=>i.jsx(vt,{label:"Aadhaar Card",file:$.value,onFileChange:$.onChange,error:K.error?.message,allowCapture:!0})})}),i.jsx(ne,{type:"button",variant:"icon",size:"sm",onClick:()=>I(ae),className:"!absolute top-2 right-2",children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]},Y.id)}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>D({id:`fam_upload_${Date.now()}`,relation:"",idProof:null,phone:""}),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-between items-center gap-4",children:[i.jsxs(ne,{type:"button",variant:"secondary",onClick:()=>n(-1),children:[i.jsx(Fa,{className:"mr-2 h-4 w-4"})," Back"]}),i.jsx(ne,{type:"submit",isLoading:s,children:"Process"})]})]})]})]})},due=({count:n=3})=>i.jsx("div",{className:"space-y-2.5",children:Array.from({length:n}).map((e,t)=>i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] p-3 rounded-xl flex gap-4 items-start border border-transparent",children:[i.jsx(Gr,{className:"w-12 h-12 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow space-y-2 mt-1",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx(Gr,{className:"h-4 w-1/2"}),i.jsx(Gr,{className:"h-5 w-20 rounded-full"})]}),i.jsx(Gr,{className:"h-3 w-1/3"}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"}),i.jsx(Gr,{className:"h-3 w-20"})]})]})]},t))}),nx=({label:n,checked:e})=>i.jsxs("div",{className:"flex items-center gap-1.5",children:[e?i.jsx(bm,{className:"h-4 w-4 text-emerald-400"}):i.jsx(m3,{className:"h-4 w-4 text-gray-500"}),i.jsx("span",{className:e?"text-gray-300":"text-gray-500",children:n})]}),uue=({submission:n})=>{const{esiCtcThreshold:e}=td(),{colorScheme:t}=an(),r=E.useMemo(()=>{const{personal:s,uan:a,esi:o,gmc:l}=n,c=s.salary!=null&&s.salary<=e;let d=!1;return c?d=!o.hasEsi||o.hasEsi&&!!o.esiNumber:l.isOptedIn===!0?d=!0:l.isOptedIn===!1&&(d=!!l.gmcPolicyCopy&&!!l.declarationAccepted),{aadhaar:!!s.idProofFront,uan:!a.hasPreviousPf||a.hasPreviousPf&&!!a.uanNumber,pf:!a.hasPreviousPf||a.hasPreviousPf&&!!a.uanNumber,esiGmc:d}},[n,e]);return i.jsx(Oa,{to:`/onboarding/add/personal?id=${n.id}`,className:"block focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-xl",children:i.jsxs("div",{className:"bg-[#041b0f] md:bg-[#243524] hover:border-emerald-500 p-3 rounded-xl flex gap-4 items-start border border-transparent transition-colors duration-200",children:[i.jsx("div",{className:"w-12 h-12 rounded-full overflow-hidden flex-shrink-0 border-2 border-gray-600",children:i.jsx(Gi,{photoUrl:n.personal.photo?.preview,seed:n.id})}),i.jsxs("div",{className:"flex-grow",children:[i.jsxs("div",{className:"flex justify-between items-start gap-2",children:[i.jsx("p",{className:"font-semibold text-green-400",children:`${n.personal.firstName} ${n.personal.lastName}`}),i.jsx("div",{className:"flex-shrink-0",children:i.jsx(z1,{status:n.status})})]}),i.jsx("p",{className:"text-sm text-gray-400",children:n.personal.mobile}),i.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-1.5 mt-3 text-xs",children:[i.jsx(nx,{label:"Aadhaar",checked:r.aadhaar}),i.jsx(nx,{label:"UAN",checked:r.uan}),i.jsx(nx,{label:"PF",checked:r.pf}),i.jsx(nx,{label:"ESI / GMC",checked:r.esiGmc})]})]})]})})},fue=()=>{const{colorScheme:n}=an(),[e,t]=E.useState([]),[r,s]=E.useState(!0),[a,o]=E.useState("in-progress"),[l,c]=E.useState(""),[d,h]=E.useState(null),p=St(),x=E.useRef(null);E.useEffect(()=>{(async()=>{s(!0);try{const P=await ue.getVerificationSubmissions();t(P)}catch{h({message:"Failed to load submissions.",type:"error"})}finally{s(!1)}})()},[]);const y=E.useMemo(()=>{const C={"in-progress":["pending","draft","rejected"],existing:["verified"]};return e.filter(P=>C[a].includes(P.status)).filter(P=>`${P.personal.firstName} ${P.personal.lastName}`.toLowerCase().includes(l.toLowerCase())||P.personal.mobile?.toLowerCase().includes(l.toLowerCase()))},[e,a,l]),_=()=>{p("/onboarding/select-organization")},w=()=>{x.current?.focus()},j=[{key:"in-progress",label:"IN PROGRESS"},{key:"existing",label:"EXISTING"}];return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header sticky top-0 z-10 bg-[#041b0f]/80 border-[#374151] backdrop-blur-sm border-b",children:[i.jsx("button",{onClick:()=>p("/onboarding"),"aria-label":"Go back",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsx("h1",{className:"text-lg font-semibold",children:"On Boarding"}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx("button",{onClick:w,"aria-label":"Search employee",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Ia,{className:"h-6 w-6"})}),i.jsx("button",{onClick:_,"aria-label":"Add new employee",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(Yc,{className:"h-6 w-6"})}),i.jsx("button",{onClick:()=>p("/profile"),"aria-label":"Exit to profile",className:"p-2 rounded-full focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-emerald-400 hover:bg-white/10",children:i.jsx(vi,{className:"h-6 w-6"})})]})]}),i.jsx("div",{className:"px-4 pt-4 pb-3 flex-shrink-0",children:i.jsx("div",{className:"flex",children:j.map(C=>i.jsx("button",{onClick:()=>o(C.key),className:`flex-1 py-2 text-sm font-semibold uppercase tracking-wider transition-colors duration-200 focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[#041b0f] focus-visible:ring-emerald-400 rounded-sm ${a===C.key?"border-b-2 border-emerald-500 text-emerald-600":"border-b-2 border-transparent text-gray-400 hover:text-white"}`,children:C.label},C.key))})}),i.jsxs("main",{className:"flex-1 overflow-y-auto px-4 space-y-2.5 pb-24",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-5 w-5 text-gray-500"}),i.jsx("input",{ref:x,type:"text",placeholder:"Search by name or number...",value:l,onChange:C=>c(C.target.value),className:"form-input w-full !pl-10 !h-12 !rounded-md"})]}),r?i.jsx("div",{className:"pt-4",children:i.jsx(due,{count:3})}):y.length>0?i.jsx("div",{className:"space-y-2.5",children:y.map(C=>i.jsx(uue,{submission:C},C.id))}):i.jsx("div",{className:"text-center pt-16 text-gray-500",children:i.jsxs("p",{children:["No ",a.replace("-"," ")," submissions found."]})})]})]})},hue=({status:n})=>{const e={"To Do":"bg-gray-500","In Progress":"bg-blue-500",Done:"bg-green-600"};return i.jsx("span",{className:`fo-status-badge ${e[n]}`,children:n})},mue=()=>{const{user:n}=jt(),{colorScheme:e}=an(),[t,r]=E.useState("tasks"),[s,a]=E.useState([]),[o,l]=E.useState([]),[c,d]=E.useState(!0);E.useEffect(()=>{if(!n)return;(async()=>{d(!0);try{const[x,y]=await Promise.all([ue.getTasks(),ue.getNotifications(n.id)]),_=x.filter(w=>w.assignedToId===n.id);a(_),l(y)}catch(x){console.error("Failed to load data for tasks page",x)}finally{d(!1)}})()},[n]);const h=p=>{const x=["HR","Admin","Ops Manager","Site Manager"];return x[p.charCodeAt(p.length-1)%x.length]};return i.jsxs("div",{className:"text-white",children:[i.jsx("header",{className:"p-4 flex-shrink-0 text-center fo-mobile-header sticky top-0 bg-[#041b0f]/80 border-[#374151] backdrop-blur-sm z-10 border-b",children:i.jsx("h1",{className:"font-semibold text-lg",children:"Tasks"})}),i.jsx("div",{className:"flex-shrink-0 p-4",children:i.jsxs("div",{className:"fo-tabs-container",children:[i.jsx("button",{onClick:()=>r("tasks"),className:`fo-tab-button ${t==="tasks"?"active":""}`,children:"Tasks"}),i.jsx("button",{onClick:()=>r("notifications"),className:`fo-tab-button ${t==="notifications"?"active":""}`,children:"Notifications"})]})}),i.jsx("main",{className:"p-4",children:c?i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})}):t==="tasks"?s.length>0?i.jsx("div",{className:"space-y-4",children:s.map(p=>i.jsxs("div",{className:"fo-task-card",children:[i.jsxs("div",{className:"fo-task-header",children:[i.jsx("p",{className:"fo-task-title",children:p.name}),i.jsx(hue,{status:p.status})]}),i.jsx("p",{className:"text-sm mb-2 text-gray-400",children:p.description}),i.jsxs("div",{className:"fo-task-meta flex justify-between items-center",children:[i.jsxs("span",{children:["Due: ",p.dueDate?We(new Date(p.dueDate),"dd MMM, yyyy"):"N/A"]}),i.jsxs("span",{children:["Assigned by: ",h(p.id)]})]})]},p.id))}):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(P1,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no assigned tasks."})]}):o.length>0?i.jsx("div",{className:"divide-y divide-border",children:o.map(p=>i.jsxs("div",{className:"fo-notification-item",children:[i.jsx(Of,{className:"h-5 w-5 text-yellow-400 flex-shrink-0 mt-0.5"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm text-gray-300",children:p.message}),i.jsx("p",{className:"text-xs text-muted mt-1",children:hu(new Date(p.createdAt),{addSuffix:!0})})]})]},p.id))}):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(Of,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"You have no notifications."})]})})]})},pue=({status:n})=>{const{colorScheme:e}=useBrandingStore(),r={Pending:"bg-yellow-900/50 text-yellow-300 border border-yellow-500/50",Approved:"bg-blue-900/50 text-blue-300 border border-blue-500/50",Issued:"bg-green-900/50 text-green-300 border border-green-500/50",Rejected:"bg-red-900/50 text-red-300 border border-red-500/50"};return i.jsx("span",{className:`fo-status-badge ${r[n]}`,children:n})},rx=({title:n,sizes:e,headers:t,control:r,quantityType:s})=>{const a=Array.from(new Set(e.map(l=>l.fit))),o=Array.from(new Set(e.map(l=>l.size))).sort((l,c)=>{const d=parseInt(String(l)),h=parseInt(String(c));return!isNaN(d)&&!isNaN(h)?d-h:String(l).localeCompare(String(c))});return i.jsxs("div",{className:"border border-border rounded-lg",children:[i.jsx("h4",{className:"p-3 font-semibold bg-accent text-white border-b border-accent",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-page",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:"Size"}),t.map(l=>i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted",children:l.label},String(l.key))),i.jsx("th",{className:"px-3 py-2 text-left font-medium text-muted w-24",children:"Quantity"})]})}),i.jsx("tbody",{className:"divide-y divide-border",children:o.map(l=>i.jsx(ot.Fragment,{children:a.map((c,d)=>{const h=e.find(p=>p.size===l&&p.fit===c);return h?i.jsxs("tr",{children:[d===0&&i.jsx("td",{rowSpan:a.filter(p=>e.some(x=>x.size===l&&x.fit===p)).length,className:"px-3 py-2 align-middle font-semibold border-r",children:l}),t.map(p=>i.jsx("td",{className:"px-3 py-2",children:h[p.key]},String(p.key))),i.jsx("td",{className:"px-3 py-2",children:i.jsx(_e,{name:`${s}.${h.id}`,control:r,render:({field:p})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${l} ${c}`,type:"number",...p,value:p.value||"",onChange:x=>p.onChange(parseInt(x.target.value)||null),className:"!py-1.5"})})})]},h.id):null})},l))})]})})]})},gue=({onSave:n,onCancel:e,sites:t,masterUniforms:r,initialData:s})=>{const{register:a,control:o,handleSubmit:l,watch:c,reset:d}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),{data:h}=Yn(),{user:p}=jt(),x=c("gender"),y=c("siteId");E.useEffect(()=>{if(s){const w={},j={};s.items.forEach(C=>{C.category==="Pants"?w[C.sizeId]=C.quantity:j[C.sizeId]=C.quantity}),d({siteId:s.siteId,gender:s.gender,pantsQuantities:w,shirtsQuantities:j})}else{const w=h.organization.organizationId||"",C=h.personal.gender==="Female"?"Ladies":"Gents";d({siteId:w,gender:C,pantsQuantities:{},shirtsQuantities:{}})}},[s,d,h]);const _=w=>{const j=t.find(M=>M.id===w.siteId);if(!j||!p)return;const C=x==="Gents"?[...r.gents.pants,...r.gents.shirts]:[...r.ladies.pants,...r.ladies.shirts],P=[];for(const[M,D]of Object.entries(w.pantsQuantities))if(D&&D>0){const I=C.find(F=>F.id===M);I&&P.push({sizeId:M,quantity:D,category:"Pants",sizeLabel:I.size,fit:I.fit})}for(const[M,D]of Object.entries(w.shirtsQuantities))if(D&&D>0){const I=C.find(F=>F.id===M);I&&P.push({sizeId:M,quantity:D,category:"Shirts",sizeLabel:I.size,fit:I.fit})}const O={id:s?.id||`new_${Date.now()}`,siteId:w.siteId,siteName:j.shortName,gender:w.gender,requestedDate:s?.requestedDate||new Date().toISOString(),status:s?.status||"Pending",items:P,source:"Individual",requestedById:p.id,requestedByName:p.name,employeeDetails:[{employeeName:`${h.personal.firstName} ${h.personal.lastName}`,employeeId:h.personal.employeeId,items:P.map(M=>({itemName:M.category,sizeLabel:M.sizeLabel,fit:M.fit,quantity:M.quantity}))}]};n(O)};return i.jsx("form",{onSubmit:l(_),children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Select Site",value:y,...a("siteId"),required:!0,disabled:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),t.map(w=>i.jsx("option",{value:w.id,children:w.shortName},w.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",value:x,...a("gender"),disabled:!0,children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:x==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(rx,{title:"Gents' Pants",sizes:r.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(rx,{title:"Gents' Shirts",sizes:r.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(rx,{title:"Ladies' Pants",sizes:r.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:o,quantityType:"pantsQuantities"}),i.jsx(rx,{title:"Ladies' Shirts",sizes:r.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:o,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t border-[#374151]",children:[i.jsx(ne,{type:"button",variant:"secondary",onClick:e,children:"Cancel"}),i.jsxs(ne,{type:"submit",children:[i.jsx(Cs,{className:"mr-2 h-4 w-4"})," Save Request"]})]})]})})},xue=()=>{const[n,e]=E.useState("list"),[t,r]=E.useState([]),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(null),[x,y]=E.useState(null),[_,w]=E.useState(null),j=St(),[C]=p4(),{updateUniforms:P}=Yn(),O=C.get("from")==="onboarding",M=async()=>{d(!0);try{const[U,W,G,Z]=await Promise.all([ue.getUniformRequests(),ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);r(U.sort((Y,ae)=>new Date(ae.requestedDate).getTime()-new Date(Y.requestedDate).getTime())),a(W),l({gents:G,ladies:Z})}catch{p({message:"Failed to load uniform data.",type:"error"})}finally{d(!1)}};E.useEffect(()=>{M()},[]),E.useEffect(()=>{O&&(e("form"),y(null))},[O]);const D=()=>{y(null),e("form")},I=U=>{y(U),e("form")},F=async U=>{if(O&&o){const W=U.gender==="Ladies"?[...o.ladies.pants,...o.ladies.shirts]:[...o.gents.pants,...o.gents.shirts],G=U.items.map(Z=>{const Y=W.find(me=>me.id===Z.sizeId),ae=Z.category==="Pants"?`${U.gender}' Pants`:`${U.gender}' Shirts`;return{itemId:`generic_${U.gender.toLowerCase()}_${Z.category==="Pants"?"pants":"shirts"}`,itemName:ae,sizeId:Z.sizeId,sizeLabel:Y?.size||"",fit:Y?.fit||"",quantity:Z.quantity}});P(G),await ue.submitUniformRequest(U),j(-1);return}try{U.id.startsWith("new_")?(await ue.submitUniformRequest(U),p({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(U),p({message:"Request updated.",type:"success"})),e("list"),M()}catch{p({message:"Failed to save request.",type:"error"})}},q=async()=>{if(_)try{await ue.deleteUniformRequest(_.id),p({message:"Request deleted.",type:"success"}),w(null),M()}catch{p({message:"Failed to delete request.",type:"error"})}},B=U=>U.reduce((W,G)=>W+G.quantity,0);if(c||!o)return i.jsx("div",{className:"flex justify-center items-center h-full",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-muted"})});if(n==="form"){const U=()=>{O?j(-1):e("list")};return i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center gap-4 fo-mobile-header",children:[i.jsx("button",{onClick:U,"aria-label":"Go back",children:i.jsx(Fa,{className:"h-6 w-6"})}),i.jsxs("h1",{children:[x?"Edit":"New"," Request"]})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsx(gue,{onSave:F,onCancel:U,sites:s,masterUniforms:o,initialData:x})})]})}return i.jsxs("div",{className:"h-full flex flex-col bg-[#041b0f] text-white",children:[h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)}),i.jsx(Kr,{isOpen:!!_,onClose:()=>w(null),onConfirm:q,title:"Confirm Deletion",children:"Are you sure you want to delete this uniform request? This cannot be undone."}),i.jsxs("header",{className:"p-4 flex-shrink-0 flex items-center justify-between fo-mobile-header",children:[i.jsx("h1",{className:"text-lg font-semibold",children:"Uniform Requests"}),i.jsx("button",{onClick:D,"aria-label":"New Uniform Request",className:"",children:i.jsx(Yc,{className:"h-6 w-6"})})]}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4 space-y-3",children:t.length>0?t.map(U=>i.jsxs("div",{className:"p-3 rounded-xl border bg-[#243524] border-[#374151]",children:[i.jsxs("div",{className:"flex justify-between items-start",children:[i.jsxs("div",{children:[i.jsx("p",{className:"font-semibold text-white",children:U.siteName}),i.jsx("p",{className:"text-xs text-gray-400",children:We(new Date(U.requestedDate),"dd MMM, yyyy")})]}),i.jsx(pue,{status:U.status})]}),i.jsxs("div",{className:"mt-3 flex justify-between items-end",children:[i.jsxs("div",{className:"text-sm text-gray-300",children:[i.jsxs("p",{children:[U.gender," Uniforms"]}),i.jsxs("p",{className:"font-semibold",children:[B(U.items)," Items"]})]}),U.status==="Pending"&&i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>I(U),children:i.jsx(dr,{className:"h-4 w-4 text-gray-400"})}),i.jsx(ne,{variant:"icon",size:"sm",onClick:()=>w(U),children:i.jsx(rn,{className:"h-4 w-4 text-red-500"})})]})]})]},U.id)):i.jsxs("div",{className:"text-center pt-16 text-muted",children:[i.jsx(Rf,{className:"h-12 w-12 mx-auto mb-4"}),i.jsx("p",{children:"No uniform requests found."}),i.jsxs(ne,{onClick:D,className:"mt-4",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Create First Request"]})]})})]})},yue=({priority:n})=>{const e={Low:"bg-blue-500 shadow-[0_0_8px_rgba(59,130,246,0.5)]",Medium:"bg-yellow-500 shadow-[0_0_8px_rgba(234,179,8,0.5)]",High:"bg-orange-500 shadow-[0_0_8px_rgba(249,115,22,0.5)]",Urgent:"bg-red-500 shadow-[0_0_8px_rgba(239,68,68,0.5)]"};return i.jsx("span",{className:`w-3 h-3 rounded-full ${e[n]}`,title:`Priority: ${n}`})},vue=({status:n})=>{const e={Open:"bg-emerald-500/10 text-emerald-500 border-emerald-500/20","In Progress":"bg-blue-500/10 text-blue-500 border-blue-500/20","Pending Requester":"bg-yellow-500/10 text-yellow-500 border-yellow-500/20",Resolved:"bg-purple-500/10 text-purple-500 border-purple-500/20",Closed:"bg-gray-500/10 text-gray-500 border-gray-500/20"};return i.jsx("span",{className:`px-2.5 py-0.5 rounded-full text-xs font-medium border ${e[n]}`,children:n})},bue=({ticket:n,onClick:e})=>i.jsxs("div",{onClick:e,className:"group bg-card hover:bg-accent/5 p-5 rounded-xl border border-border hover:border-accent cursor-pointer transition-all duration-300 flex flex-col justify-between h-full shadow-sm hover:shadow-md",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex justify-between items-start gap-3 mb-2",children:[i.jsx("h4",{className:"font-bold text-primary-text leading-snug group-hover:text-accent transition-colors line-clamp-2",children:n.title}),i.jsx("div",{className:"flex-shrink-0 mt-1",children:i.jsx(yue,{priority:n.priority})})]}),i.jsxs("p",{className:"text-xs text-muted font-mono",children:["#",n.ticketNumber]})]}),i.jsxs("div",{className:"mt-4 pt-4 border-t border-border/50",children:[i.jsxs("div",{className:"flex justify-between items-center text-xs text-muted mb-3",children:[i.jsxs("div",{className:"flex items-center gap-1.5",children:[i.jsx("div",{className:"w-5 h-5 rounded-full bg-gray-700 flex items-center justify-center text-[10px] text-white font-bold",children:n.raisedByName.charAt(0)}),i.jsx("span",{children:n.raisedByName})]}),i.jsx("span",{children:hu(new Date(n.raisedAt),{addSuffix:!0})})]}),i.jsx("div",{className:"flex justify-between items-center",children:i.jsx(vue,{status:n.status})})]})]}),HL=({user:n,onAction:e})=>{const{colorScheme:t}=an();return i.jsxs("div",{className:"flex items-center gap-4 p-3 rounded-xl bg-card border border-border hover:border-accent/50 transition-colors",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Gi,{photoUrl:n.photoUrl,seed:n.id,className:"w-12 h-12 rounded-full shadow-sm"}),i.jsx("span",{className:`absolute -bottom-0.5 -right-0.5 block h-4 w-4 rounded-full ${n.isAvailable?"bg-green-500 shadow-[0_0_10px_rgba(34,197,94,0.8)]":"bg-rose-600 shadow-[0_0_6px_rgba(225,29,72,0.6)]"} ring-2 ring-white`})]}),i.jsxs("div",{className:"flex-grow min-w-0",children:[i.jsx("p",{className:"text-sm font-bold text-primary-text truncate",children:n.name}),i.jsx("p",{className:"text-xs text-muted truncate",children:n.role.replace(/_/g," ").replace(/\b\w/g,r=>r.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Call",onClick:()=>e(n.phone),children:i.jsx(Af,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Message",onClick:()=>e(n.phone),children:i.jsx(xm,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",className:"hover:opacity-90 transition-opacity border",style:{backgroundColor:t==="blue"?"#1a3a6e":"#006B3F",color:"#FFFFFF",borderColor:t==="blue"?"#0f264a":"#005632"},title:"Video",onClick:()=>e(n.phone),children:i.jsx(x3,{className:"h-4 w-4"})})]})]})},wue=()=>{const n=St(),{user:e}=jt(),{colorScheme:t}=an(),[r,s]=E.useState([]),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState("All"),[y,_]=E.useState("All"),[w,j]=E.useState(""),[C,P]=E.useState(!1),[O,M]=E.useState(!1),D=Rt("(max-width: 767px)"),[I,F]=E.useState({status:"all",priority:"all",searchTerm:""});E.useEffect(()=>{(async()=>{if(e){c(!0);try{const[Z,Y]=await Promise.all([ue.getSupportTickets(),ue.getNearbyUsers()]);s(Z),o(Y.filter(ae=>ae.id!==e.id))}catch{h({message:"Failed to load support data.",type:"error"})}finally{c(!1)}}})()},[e]);const q=E.useMemo(()=>r.filter(G=>{const Z=I.status==="all"||G.status===I.status,Y=I.priority==="all"||G.priority===I.priority,ae=I.searchTerm===""||G.title.toLowerCase().includes(I.searchTerm.toLowerCase())||G.ticketNumber.toLowerCase().includes(I.searchTerm.toLowerCase())||G.description.toLowerCase().includes(I.searchTerm.toLowerCase());return Z&&Y&&ae}),[r,I]),B=E.useMemo(()=>{const G=r.filter(Z=>Z.status==="Resolved"&&Z.raisedById===e?.id);return{open:r.filter(Z=>Z.status==="Open").length,inProgress:r.filter(Z=>Z.status==="In Progress").length,pendingYourAction:G.length}},[r,e]),U=G=>{if(!G){h({message:"User does not have a phone number.",type:"error"});return}let Z=G.replace(/\D/g,"");if(Z.length>10&&(Z=Z.slice(-10)),Z.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${Z}`,"_blank")},W=({title:G,value:Z,icon:Y,colorClass:ae})=>i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl flex items-center justify-between transition-all",children:[i.jsxs("div",{children:[i.jsx("p",{className:"text-sm font-medium text-muted mb-1",children:G}),i.jsx("p",{className:`text-3xl font-bold ${ae.replace("bg-","text-").split(" ")[0]}`,children:Z})]}),i.jsx("div",{className:`p-3 rounded-full bg-opacity-10 ${ae.replace("text-","bg-")} ${ae}`,children:Y})]});return i.jsxs("div",{className:"w-full p-4 lg:p-8 space-y-8",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),i.jsx(Kr,{isOpen:O,onClose:()=>M(!1),title:"Nearby Available Support",onConfirm:()=>M(!1),confirmButtonText:"Close",children:i.jsx("div",{className:"space-y-3 max-h-[60vh] overflow-y-auto pr-1",children:a.length>0?a.map(G=>i.jsx(HL,{user:G,onAction:U},G.id)):i.jsxs("div",{className:"text-center py-8 text-muted",children:[i.jsx(Ji,{className:"h-10 w-10 mx-auto mb-2 opacity-20"}),i.jsx("p",{children:"No support staff found nearby."})]})})}),i.jsx("div",{className:"relative overflow-hidden rounded-3xl bg-transparent p-6 lg:p-10 transition-all",children:i.jsxs("div",{className:"relative z-10 flex flex-col lg:flex-row justify-between items-start lg:items-center gap-6",children:[i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[i.jsx("div",{className:"p-2 bg-emerald-50 rounded-lg backdrop-blur-sm",children:i.jsx(Ex,{className:"h-6 w-6 text-emerald-600"})}),i.jsx("h2",{className:"text-2xl lg:text-3xl font-bold text-primary-text",children:"Support & Audit"})]}),i.jsx("p",{className:"text-muted max-w-xl text-sm",children:"Track issues, request audits, and connect with support staff in real-time."})]}),i.jsxs("div",{className:"flex flex-wrap gap-2 w-full lg:w-auto",children:[D&&i.jsxs(ne,{onClick:()=>M(!0),variant:"secondary",className:"flex-1 lg:flex-none bg-gray-100 text-gray-900 hover:bg-gray-200 border-none shadow-none p-0 text-sm transition-colors",children:[i.jsx(xu,{className:"mr-1.5 h-3.5 w-3.5"})," Nearby"]}),i.jsxs(ne,{onClick:()=>n("/support/ticket/new"),className:"flex-1 lg:flex-none",children:[i.jsx(Vt,{className:"mr-1.5 h-3.5 w-3.5"})," New Ticket"]})]})]})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4 lg:gap-6",children:[i.jsx(W,{title:"Open Tickets",value:B.open,icon:i.jsx(Ex,{className:"h-6 w-6"}),colorClass:"text-rose-500"}),i.jsx(W,{title:"In Progress",value:B.inProgress,icon:i.jsx(_t,{className:"h-6 w-6"}),colorClass:"text-blue-500"}),i.jsx(W,{title:"Pending Your Action",value:B.pendingYourAction,icon:i.jsx(xu,{className:"h-6 w-6"}),colorClass:"text-amber-500"})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-8",children:[i.jsx("div",{className:"lg:col-span-2 space-y-6",children:i.jsxs("div",{className:"bg-transparent p-5 rounded-2xl",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 mb-6",children:[i.jsxs("div",{className:"relative flex-grow",children:[i.jsx(Ia,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-gray-400"}),i.jsx(we,{id:"search",placeholder:"Search tickets...",className:"pl-10 bg-gray-50 border-gray-200",value:I.searchTerm,onChange:G=>F(Z=>({...Z,searchTerm:G.target.value}))})]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ze,{value:I.status,onChange:G=>F(Z=>({...Z,status:G.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{children:"Open"}),i.jsx("option",{children:"In Progress"}),i.jsx("option",{value:"Pending Requester",children:"Pending"}),i.jsx("option",{children:"Resolved"}),i.jsx("option",{children:"Closed"})]})}),i.jsx("div",{className:"w-32 sm:w-40",children:i.jsxs(Ze,{value:I.priority,onChange:G=>F(Z=>({...Z,priority:G.target.value})),className:"bg-gray-50 border-gray-200",children:[i.jsx("option",{value:"all",children:"All Priority"}),i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]})]}),l?i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:q.length>0?q.map(G=>i.jsx(bue,{ticket:G,onClick:()=>n(`/support/ticket/${G.id}`)},G.id)):i.jsxs("div",{className:"col-span-full flex flex-col items-center justify-center py-12 text-muted",children:[i.jsx("div",{className:"p-4 bg-accent/5 rounded-full mb-3",children:i.jsx(Ia,{className:"h-8 w-8 opacity-50"})}),i.jsx("p",{children:"No tickets match your filters."})]})})]})}),i.jsx("aside",{className:"hidden lg:block space-y-6",children:i.jsxs("div",{className:"bg-card p-6 rounded-2xl border border-border shadow-sm sticky top-6",children:[i.jsxs("div",{className:"flex items-center justify-between mb-6",children:[i.jsxs("h3",{className:"font-bold text-lg text-primary-text flex items-center gap-2",children:[i.jsx(Ji,{className:"h-5 w-5 text-accent"})," Nearby Support"]}),i.jsxs("span",{className:"text-xs font-medium bg-accent/10 text-accent px-2 py-1 rounded-full",children:[a.filter(G=>G.isAvailable).length," Online"]})]}),i.jsx("div",{className:"space-y-3 max-h-[calc(100vh-200px)] overflow-y-auto pr-1 custom-scrollbar",children:a.length>0?a.map(G=>i.jsx(HL,{user:G,onAction:U},G.id)):i.jsx("div",{className:"text-center py-8 text-muted",children:i.jsx("p",{children:"No support staff found nearby."})})})]})})]})]})},_ue=({post:n,ticket:e,setTicket:t})=>{const{user:r}=jt(),[s,a]=E.useState(!1),[o,l]=E.useState(""),[c,d]=E.useState(!1),h=r?n.likes.includes(r.id):!1,p=async()=>{if(!r)return;const y=[...n.likes],_=h?n.likes.filter(w=>w!==r.id):[...n.likes,r.id];t(w=>w?{...w,posts:w.posts.map(j=>j.id===n.id?{...j,likes:_}:j)}:null);try{await ue.togglePostLike(n.id,r.id)}catch{t(j=>j?{...j,posts:j.posts.map(C=>C.id===n.id?{...C,likes:y}:C)}:null)}},x=async()=>{if(!(!o.trim()||!r)){d(!0);try{const y=await ue.addPostComment(n.id,{postId:n.id,authorId:r.id,authorName:r.name,content:o});t(_=>_?{..._,posts:_.posts.map(w=>w.id===n.id?{...w,comments:[...w.comments,y]}:w)}:null),l("")}catch{}finally{d(!1)}}};return i.jsx("div",{className:"bg-card p-4 rounded-xl shadow-card",children:i.jsxs("div",{className:"flex items-start gap-3",children:[i.jsx(Gi,{seed:n.authorId,className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-primary-text",children:n.authorName}),i.jsx("span",{className:"text-xs text-muted",children:n.authorRole.replace(/_/g," ")}),i.jsxs("span",{className:"text-xs text-muted",children:[" ",hu(new Date(n.createdAt),{addSuffix:!0})]})]}),i.jsx("p",{className:"text-sm text-muted mt-1 whitespace-pre-wrap",children:n.content}),i.jsxs("div",{className:"flex items-center gap-4 mt-3 text-sm text-muted",children:[i.jsxs("button",{onClick:p,className:`flex items-center gap-1.5 hover:text-accent transition-colors ${h?"text-accent font-semibold":""}`,children:[i.jsx(zJ,{className:`h-4 w-4 ${h?"fill-current":""}`}),i.jsxs("span",{children:[n.likes.length," Like",n.likes.length!==1&&"s"]})]}),i.jsxs("button",{onClick:()=>a(!s),className:"flex items-center gap-1.5 hover:text-accent transition-colors",children:[i.jsx(xm,{className:"h-4 w-4"}),i.jsxs("span",{children:[n.comments.length," Comment",n.comments.length!==1&&"s"]})]})]}),s&&i.jsxs("div",{className:"mt-4 space-y-3 pt-3 border-t border-border animate-fade-in-down",children:[n.comments.map(y=>i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Gi,{seed:y.authorId,className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"bg-page p-2 rounded-lg flex-grow",children:[i.jsxs("div",{className:"flex items-baseline gap-2",children:[i.jsx("span",{className:"font-semibold text-sm text-primary-text",children:y.authorName}),i.jsx("span",{className:"text-xs text-muted",children:hu(new Date(y.createdAt),{addSuffix:!0})})]}),i.jsx("p",{className:"text-sm text-muted",children:y.content})]})]},y.id)),i.jsxs("div",{className:"flex items-start gap-2",children:[i.jsx(Gi,{className:"w-8 h-8 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("textarea",{value:o,onChange:y=>l(y.target.value),placeholder:"Write a comment...",rows:2,className:"form-input text-sm"}),i.jsx("div",{className:"text-right mt-1",children:i.jsx(ne,{size:"sm",onClick:x,isLoading:c,children:"Post"})})]})]})]})]})]})})},jue=Pt({rating:cs().min(1,"Please select a rating.").required(),feedback:xe().required("Feedback is required to close the ticket.").min(10,"Please provide more detailed feedback.")}).defined(),Nue=({value:n,onChange:e})=>{const[t,r]=E.useState(0);return i.jsx("div",{className:"flex items-center justify-center gap-1",onMouseLeave:()=>r(0),children:[1,2,3,4,5].map(s=>i.jsx("button",{type:"button",onMouseEnter:()=>r(s),onClick:()=>e(s),className:"focus:outline-none",children:i.jsx(p3,{className:`h-8 w-8 cursor-pointer transition-colors ${(t||n)>=s?"text-yellow-400 fill-current":"text-gray-400"}`})},s))})},Sue=({isOpen:n,onClose:e,onSubmit:t})=>{const[r,s]=E.useState(!1),{register:a,handleSubmit:o,control:l,formState:{errors:c}}=tn({resolver:In(jue),defaultValues:{rating:0,feedback:""}}),d=h=>{s(!0),t(h.rating,h.feedback),s(!1)};return n?i.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-60 p-4",onClick:e,children:i.jsx("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-lg m-4 animate-fade-in-scale",onClick:h=>h.stopPropagation(),children:i.jsxs("form",{onSubmit:o(d),children:[i.jsx("h3",{className:"text-lg font-bold text-primary-text mb-2 text-center",children:"Ticket Resolved"}),i.jsx("p",{className:"text-sm text-muted text-center mb-4",children:"Please rate the support you received before closing this ticket."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx(_e,{name:"rating",control:l,render:({field:h})=>i.jsx(Nue,{value:h.value,onChange:h.onChange})}),c.rating&&i.jsx("p",{className:"mt-2 text-xs text-red-500 text-center",children:c.rating.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted text-center",children:"Your Feedback"}),i.jsx("textarea",{...a("feedback"),rows:4,className:`mt-1 form-input ${c.feedback?"form-input--error":""}`}),c.feedback&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:c.feedback.message})]})]}),i.jsxs("div",{className:"mt-6 flex justify-end space-x-3",children:[i.jsx(ne,{type:"button",onClick:e,variant:"secondary",children:"Not Now"}),i.jsx(ne,{type:"submit",isLoading:r,children:"Confirm & Close"})]})]})})}):null},Cue=({priority:n})=>{const e={Low:"bg-blue-100 text-blue-800 dark:bg-blue-900/50 dark:text-blue-300",Medium:"bg-yellow-100 text-yellow-800 dark:bg-yellow-900/50 dark:text-yellow-300",High:"bg-orange-100 text-orange-800 dark:bg-orange-900/50 dark:text-orange-300",Urgent:"bg-red-100 text-red-800 dark:bg-red-900/50 dark:text-red-300"};return i.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${e[n]}`,children:n})},Tue=({status:n})=>{const e={Open:"status-chip--pending","In Progress":"sync-chip--pending_sync","Pending Requester":"leave-status-chip--pending_hr_confirmation",Resolved:"leave-status-chip--approved",Closed:"status-chip--draft"};return i.jsx("span",{className:`status-chip ${e[n]}`,children:n})},kue=()=>{const{id:n}=Bf(),e=St(),{user:t}=jt(),[r,s]=E.useState(null),[a,o]=E.useState([]),[l,c]=E.useState(!0),[d,h]=E.useState(null),[p,x]=E.useState(""),[y,_]=E.useState(!1),[w,j]=E.useState(!1);Rt("(max-width: 1023px)"),E.useEffect(()=>{if(!n)return;(async()=>{c(!0);try{const[q,B]=await Promise.all([ue.getSupportTicketById(n),ue.getNearbyUsers()]);q?s(q):(h({message:"Ticket not found.",type:"error"}),e("/support")),o(B)}catch{h({message:"Failed to load ticket data.",type:"error"})}finally{c(!1)}})()},[n,e]);const C=async()=>{if(!(!p.trim()||!r||!t)){_(!0);try{const F=await ue.addTicketPost(r.id,{ticketId:r.id,authorId:t.id,authorName:t.name,authorRole:t.role,content:p});s(q=>q?{...q,posts:[...q.posts,F]}:null),x("")}catch{h({message:"Failed to add post.",type:"error"})}finally{_(!1)}}},P=async F=>{if(r)try{const q=await ue.updateSupportTicket(r.id,F);s(q),F.status&&h({message:`Ticket status updated to ${F.status}`,type:"success"})}catch{h({message:"Failed to update ticket.",type:"error"})}},O=async(F,q)=>{await P({status:"Closed",rating:F,feedback:q,closedAt:new Date().toISOString()}),j(!1)},M=F=>{if(!F){h({message:"User does not have a phone number.",type:"error"});return}let q=F.replace(/\D/g,"");if(q.length>10&&(q=q.slice(-10)),q.length!==10){h({message:"Invalid phone number format.",type:"error"});return}window.open(`https://wa.me/91${q}`,"_blank")};if(l)return i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-12 w-12 animate-spin text-accent"})});if(!r)return null;const D=t?.id===r.raisedById,I=()=>r.status==="Closed"?null:i.jsxs("div",{className:"flex flex-wrap gap-2",children:[r.status==="Open"&&i.jsx(ne,{onClick:()=>P({status:"In Progress",assignedToId:t?.id,assignedToName:t?.name}),children:"Assign to Me"}),r.status==="In Progress"&&t?.id===r.assignedToId&&i.jsx(ne,{onClick:()=>P({status:"Resolved",resolvedAt:new Date().toISOString()}),children:"Mark as Resolved"}),r.status==="Resolved"&&D&&i.jsx(ne,{onClick:()=>j(!0),children:"Close Ticket"})]});return i.jsxs("div",{className:"p-4",children:[d&&i.jsx(pt,{message:d.message,type:d.type,onDismiss:()=>h(null)}),w&&i.jsx(Sue,{isOpen:w,onClose:()=>j(!1),onSubmit:O}),i.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[i.jsx(ne,{variant:"icon",onClick:()=>e("/support"),children:i.jsx(Fa,{})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-xl md:text-2xl font-bold text-primary-text",children:r.title}),i.jsxs("p",{className:"text-xs text-muted",children:["#",r.ticketNumber]})]})]}),i.jsxs("div",{className:"lg:grid lg:grid-cols-3 lg:gap-6",children:[i.jsxs("main",{className:"lg:col-span-2 space-y-6",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card space-y-4",children:[i.jsxs("div",{className:"flex flex-wrap gap-4 justify-between items-start",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(Tue,{status:r.status}),i.jsx(Cue,{priority:r.priority})]}),i.jsxs("div",{className:"text-sm text-muted text-right",children:[i.jsxs("p",{children:["Raised by: ",i.jsx("span",{className:"font-semibold text-primary-text",children:r.raisedByName})]}),i.jsx("p",{children:We(new Date(r.raisedAt),"dd MMM, yyyy - hh:mm a")})]})]}),i.jsx("p",{className:"text-sm text-muted whitespace-pre-wrap",children:r.description}),r.attachmentUrl&&i.jsxs("div",{className:"mt-4",children:[i.jsx("h5",{className:"text-sm font-semibold text-primary-text mb-2",children:"Attachment"}),i.jsx("a",{href:r.attachmentUrl,target:"_blank",rel:"noopener noreferrer",className:"block border rounded-lg overflow-hidden max-w-xs hover:border-accent",children:i.jsx("img",{src:r.attachmentUrl,alt:"Attachment",className:"max-h-64 w-auto"})})]})]}),i.jsx("div",{className:"space-y-4",children:r.posts.map(F=>i.jsx(_ue,{post:F,ticket:r,setTicket:s},F.id))}),r.status!=="Closed"&&i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card flex items-start gap-3",children:[i.jsx(Gi,{className:"w-10 h-10 rounded-full flex-shrink-0"}),i.jsxs("div",{className:"w-full",children:[i.jsx("textarea",{value:p,onChange:F=>x(F.target.value),placeholder:"Add a public reply...",className:"form-input w-full",rows:3}),i.jsxs("div",{className:"mt-2 flex justify-between items-center",children:[i.jsx(ne,{variant:"icon",size:"sm",title:"Attach file",children:i.jsx(IJ,{className:"h-5 w-5"})}),i.jsxs(ne,{onClick:C,isLoading:y,children:[i.jsx(M1,{className:"mr-2 h-4"})," Post"]})]})]})]})]}),i.jsxs("aside",{className:"space-y-6 mt-6 lg:mt-0",children:[i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsx("h3",{className:"font-semibold text-primary-text mb-3",children:"Ticket Details"}),i.jsxs("div",{className:"space-y-2 text-sm",children:[i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Assigned To:"})," ",i.jsx("span",{className:"font-semibold",children:r.assignedToName||"Unassigned"})]}),i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Category:"})," ",i.jsx("span",{children:r.category})]}),r.resolvedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Resolved:"})," ",i.jsx("span",{children:We(new Date(r.resolvedAt),"dd MMM, yy")})]}),r.closedAt&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Closed:"})," ",i.jsx("span",{children:We(new Date(r.closedAt),"dd MMM, yy")})]}),r.rating&&i.jsxs("div",{className:"flex justify-between",children:[i.jsx("span",{className:"text-muted",children:"Rating:"})," ",i.jsxs("span",{className:"flex items-center gap-1",children:[r.rating," ",i.jsx(p3,{className:"h-4 w-4 text-yellow-400 fill-current"})]})]})]}),i.jsx("div",{className:"mt-4 pt-4 border-t border-border",children:I()})]}),i.jsxs("div",{className:"bg-card p-4 rounded-xl shadow-card",children:[i.jsxs("h3",{className:"font-semibold text-primary-text mb-3 flex items-center gap-2",children:[i.jsx(Ji,{className:"h-5 w-5 text-muted"})," Nearby Users"]}),i.jsx("div",{className:"space-y-3",children:a.map(F=>i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsxs("div",{className:"relative",children:[i.jsx(Gi,{photoUrl:F.photoUrl,seed:F.id,className:"w-10 h-10 rounded-full"}),i.jsx("span",{className:"absolute bottom-0 right-0 block h-2.5 w-2.5 rounded-full bg-green-400 ring-2 ring-card"})]}),i.jsxs("div",{className:"flex-grow",children:[i.jsx("p",{className:"text-sm font-semibold",children:F.name}),i.jsx("p",{className:"text-xs text-muted",children:F.role.replace(/_/g," ").replace(/\b\w/g,q=>q.toUpperCase())})]}),i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(Af,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(xm,{className:"h-4 w-4"})}),i.jsx(ne,{variant:"icon",size:"sm",title:"WhatsApp Chat",onClick:()=>M(F.phone),children:i.jsx(x3,{className:"h-4 w-4"})})]})]},F.id))})]})]})]})]})},Pue=Pt({id:xe().optional(),name:xe().required("Name is required"),email:xe().email("Invalid email").required("Email is required"),role:xe().required("Role is required"),password:xe().min(6,"Password must be at least 6 characters").required("Password is required for new users"),phone:xe().optional(),organizationId:xe().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:xe().optional(),reportingManagerId:xe().optional(),photoUrl:xe().optional().nullable()}).defined(),Mue=Pt({id:xe().optional(),name:xe().required("Name is required"),email:xe().email("Invalid email").required("Email is required"),role:xe().required("Role is required"),phone:xe().optional(),organizationId:xe().when("role",{is:"site_manager",then:n=>n.required("Site manager must be assigned to a site."),otherwise:n=>n.optional()}),organizationName:xe().optional(),reportingManagerId:xe().optional(),photoUrl:xe().optional().nullable()}).defined(),YL=()=>{const n=St(),{id:e}=Bf(),t=!!e,r=Rt("(max-width: 767px)"),[s,a]=E.useState(!1),[o,l]=E.useState([]),[c,d]=E.useState([]),[h,p]=E.useState(null),[x,y]=E.useState(null),_=t?Mue:Pue,{register:w,handleSubmit:j,formState:{errors:C},reset:P,watch:O,setValue:M}=tn({resolver:In(_)}),D=O("role");E.useEffect(()=>{(async()=>{try{const[B,U]=await Promise.all([ue.getOrganizations(),ue.getRoles()]);if(l(B),d(U),t&&e){const G=(await ue.getUsers()).find(Z=>Z.id===e);G&&(y(G),P(G))}else P({name:"",email:"",role:"field_officer"})}catch{p({message:"Failed to load form data.",type:"error"})}})()},[e,t,P]);const I=q=>{const B=q.target.value,U=o.find(W=>W.id===B);M("organizationId",B),M("organizationName",U?.shortName||"")},F=async q=>{a(!0);try{if(t&&e){const{password:B,...U}=q;await ue.updateUser(e,U),p({message:"User updated successfully!",type:"success"})}else{const{name:B,email:U,password:W,role:G,...Z}=q;if(!W)throw new Error("Password is required when creating a new user");const Y=await ue.createAuthUser({name:B,email:U,password:W,role:G});Z&&Object.keys(Z).length>0&&await ue.updateUser(Y.id,Z),await ue.createNotification({userId:Y.id,message:`Welcome ${Y.name}! Your account has been created.`,type:"greeting"}),p({message:"User created successfully!",type:"success"})}setTimeout(()=>n("/admin/users"),1500)}catch(B){p({message:B.message||"Failed to save user.",type:"error"})}finally{a(!1)}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit User":"Add User"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Yc,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-sm text-gray-400",children:t?"Update user information below.":"Create a new user account with initial credentials."})]}),i.jsxs("form",{onSubmit:j(F),className:"space-y-4",children:[i.jsx(we,{label:"Full Name",id:"name",registration:w("name"),error:C.name?.message}),i.jsx(we,{label:"Email",id:"email",type:"email",registration:w("email"),error:C.email?.message}),i.jsx(Ze,{label:"Role",id:"role",registration:w("role"),error:C.role?.message,children:c.map(q=>i.jsx("option",{value:q.id,children:q.displayName},q.id))}),!t&&i.jsx(we,{label:"Password",id:"password",type:"password",registration:w("password"),error:C.password?.message}),D==="site_manager"&&i.jsxs(Ze,{label:"Assigned Site",id:"organizationId",...w("organizationId"),error:C.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/users"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(F),disabled:s,className:"fo-btn-primary flex-1",children:s?"Saving...":t?"Save Changes":"Create User"})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Yc,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit User":"Add New User"}),i.jsx("p",{className:"text-muted",children:t?"Update user information below.":"Create a new user account with initial credentials."})]})]}),i.jsxs("form",{onSubmit:j(F),className:"space-y-6",children:[i.jsx(we,{label:"Full Name",id:"name",registration:w("name"),error:C.name?.message}),i.jsx(we,{label:"Email",id:"email",type:"email",registration:w("email"),error:C.email?.message}),i.jsx(Ze,{label:"Role",id:"role",registration:w("role"),error:C.role?.message,children:c.map(q=>i.jsx("option",{value:q.id,children:q.displayName},q.id))}),!t&&i.jsx(we,{label:"Password",id:"password",type:"password",registration:w("password"),error:C.password?.message}),D==="site_manager"&&i.jsxs(Ze,{label:"Assigned Site",id:"organizationId",...w("organizationId"),error:C.organizationId?.message,onChange:I,children:[i.jsx("option",{value:"",children:"Select a Site"}),o.map(q=>i.jsx("option",{value:q.id,children:q.shortName},q.id))]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/users"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,children:t?"Save Changes":"Create User"})]})]})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},Eue=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(!1),[c,d]=E.useState(null),h=async p=>{if(p.preventDefault(),!!t.trim()){l(!0);try{await ue.createPolicy({name:t.trim(),description:s.trim()}),d({message:"Policy created successfully!",type:"success"}),setTimeout(()=>n("/hr/policies-and-insurance"),1500)}catch{d({message:"Failed to save policy. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Policy"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(us,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new policy for your organization."})]}),i.jsxs("form",{onSubmit:h,className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/policies-and-insurance"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:h,disabled:o||!t.trim(),className:"fo-btn-primary flex-1",children:o?"Saving...":"Save Policy"})]}),c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(us,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Policy"}),i.jsx("p",{className:"text-muted",children:"Create a new policy for your organization."})]})]}),i.jsxs("form",{onSubmit:h,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Policy Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:p=>r(p.target.value),placeholder:"Policy Name (e.g., POSH)",className:"form-input",required:!0,disabled:o})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{id:"description",value:s,onChange:p=>a(p.target.value),placeholder:"Description",className:"form-input",rows:4,disabled:o})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/policies-and-insurance"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:o,disabled:!t.trim(),children:"Save Policy"})]})]})]}),c&&i.jsx(pt,{message:c.message,type:c.type,onDismiss:()=>d(null)})]})},Due=Pt({title:xe().required("Title is required"),description:xe().required("Description is required"),category:xe().oneOf(["Software Developer","Admin","Operational","HR Query","Other"]).required("Category is required"),priority:xe().oneOf(["Low","Medium","High","Urgent"]).required("Priority is required"),assignedToId:xe().optional().nullable(),attachment:Wt().optional().nullable()}).defined(),Oue=()=>{const n=St(),{user:e}=jt(),[t,r]=E.useState(!1),[s,a]=E.useState([]),[o,l]=E.useState(null),c=Rt("(max-width: 767px)"),{register:d,handleSubmit:h,control:p,formState:{errors:x}}=tn({resolver:In(Due),defaultValues:{category:"Software Developer",priority:"Medium",assignedToId:null,attachment:null}}),y=du({control:p,name:"category"});E.useEffect(()=>{ue.getUsers().then(a)},[]);const _=E.useMemo(()=>{if(!s)return[];switch(y){case"Software Developer":return s.filter(P=>P.role==="developer");case"Admin":return s.filter(P=>P.role==="admin");case"HR Query":return s.filter(P=>P.role==="hr");case"Operational":return s.filter(P=>["operation_manager","site_manager"].includes(P.role));default:const C=["admin","hr","developer","operation_manager","site_manager"];return s.filter(P=>C.includes(P.role))}},[s,y]),w=async C=>{if(e){r(!0);try{const P=s.find(O=>O.id===C.assignedToId);await ue.createSupportTicket({...C,attachment:C.attachment,status:"Open",raisedById:e.id,raisedByName:e.name,assignedToId:C.assignedToId||null,assignedToName:P?.name||null,resolvedAt:null,closedAt:null,rating:null,feedback:null}),l({message:"Ticket created successfully!",type:"success"}),setTimeout(()=>n("/support"),1500)}catch{l({message:"Failed to create ticket.",type:"error"})}finally{r(!1)}}},j="new-ticket-form";return c?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"New Support Ticket"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(zM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a support request or report an issue."})]}),i.jsxs("form",{id:j,onSubmit:h(w),className:"space-y-4",children:[i.jsx(we,{placeholder:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("textarea",{placeholder:"Description",...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsx(_e,{name:"category",control:p,render:({field:C})=>i.jsxs(Ze,{...C,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:C})=>i.jsxs(Ze,{...C,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:C})=>i.jsxs(Ze,{...C,value:C.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),_.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:C,fieldState:P})=>i.jsx(vt,{label:"Attach Screenshot or Document (Image only)",file:C.value,onFileChange:C.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/support"),disabled:t,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",form:j,disabled:t,className:"fo-btn-primary flex-1",children:t?"Creating...":"Create Ticket"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(zM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Create New Ticket"}),i.jsx("p",{className:"text-muted",children:"Submit a support request or report an issue."})]})]}),i.jsxs("form",{id:j,onSubmit:h(w),className:"space-y-6",children:[i.jsx(we,{label:"Title / Subject",...d("title"),error:x.title?.message}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-1",children:"Description"}),i.jsx("textarea",{...d("description"),rows:5,className:`form-input ${x.description?"form-input--error":""}`}),x.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:x.description.message})]}),i.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[i.jsx(_e,{name:"category",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Category",...C,error:x.category?.message,children:[i.jsx("option",{children:"Software Developer"}),i.jsx("option",{children:"Admin"}),i.jsx("option",{children:"Operational"}),i.jsx("option",{children:"HR Query"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:"priority",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Priority",...C,error:x.priority?.message,children:[i.jsx("option",{children:"Low"}),i.jsx("option",{children:"Medium"}),i.jsx("option",{children:"High"}),i.jsx("option",{children:"Urgent"})]})})]}),i.jsx(_e,{name:"assignedToId",control:p,render:({field:C})=>i.jsxs(Ze,{label:"Assigned To (Optional)",...C,value:C.value??"",error:x.assignedToId?.message,children:[i.jsx("option",{value:"",children:"Unassigned"}),_.map(P=>i.jsxs("option",{value:P.id,children:[P.name," (",P.role.replace(/_/g," "),")"]},P.id))]})}),i.jsx(_e,{name:"attachment",control:p,render:({field:C,fieldState:P})=>i.jsx(vt,{label:"Attach Screenshot or Document (Image only)",file:C.value,onFileChange:C.onChange,allowedTypes:["image/jpeg","image/png","image/webp"],error:P.error?.message})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/support"),variant:"secondary",disabled:t,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:t,children:"Create Ticket"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Iue=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`group_${Date.now()}`,name:t.trim(),locations:[],companies:[]};l({message:"Group created successfully!",type:"success"}),setTimeout(()=>n("/hr/entity-management"),1500)}catch{l({message:"Failed to create group. Please try again.",type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Group"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new organizational group."})]}),i.jsx("form",{onSubmit:c,className:"space-y-4",children:i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]})})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/entity-management"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Saving...":"Create Group"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Group"}),i.jsx("p",{className:"text-muted",children:"Create a new organizational group."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"name",className:"block text-sm font-medium text-muted mb-1",children:["Group Name ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"name",value:t,onChange:d=>r(d.target.value),placeholder:"Enter group name",className:"form-input",required:!0,disabled:s})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/entity-management"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Create Group"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},Aue=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,y]=E.useState(null),_=async w=>{if(w.preventDefault(),!(!s||!o||!c.trim())){p(!0);try{console.log("Granting comp off:",{userId:s,days:o,reason:c}),y({message:"Comp off granted successfully!",type:"success"}),setTimeout(()=>n("/hr/leave-management"),1500)}catch{y({message:"Failed to grant comp off.",type:"error"})}finally{p(!1)}}};return E.useEffect(()=>{(async()=>{try{const j=await ue.getUsers();r(j)}catch{y({message:"Failed to load users.",type:"error"})}})()},[]),e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Grant Comp Off"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(qM,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Grant comp off days to an employee."})]}),i.jsxs("form",{onSubmit:_,className:"space-y-4",children:[i.jsxs(Ze,{label:"Select Employee",id:"user",value:s,onChange:w=>a(w.target.value),error:!s&&s!==""?"Please select an employee":"",children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(w=>i.jsxs("option",{value:w.id,children:[w.name," - ",w.role]},w.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:w=>l(w.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:w=>d(w.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/hr/leave-management"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:_,disabled:h||!s||!o||!c.trim(),className:"fo-btn-primary flex-1",children:h?"Granting...":"Grant Comp Off"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(qM,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Grant Compensatory Off"}),i.jsx("p",{className:"text-muted",children:"Grant comp off days to an employee."})]})]}),i.jsxs("form",{onSubmit:_,className:"space-y-6",children:[i.jsxs(Ze,{label:"Select Employee",id:"user",value:s,onChange:w=>a(w.target.value),children:[i.jsx("option",{value:"",children:"Select an employee"}),t.map(w=>i.jsxs("option",{value:w.id,children:[w.name," - ",w.role]},w.id))]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"days",className:"block text-sm font-medium text-muted mb-1",children:["Number of Days ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("input",{id:"days",type:"number",step:"0.5",min:"0.5",value:o,onChange:w=>l(w.target.value),placeholder:"e.g. 1, 0.5, 2",className:"form-input",required:!0,disabled:h})]}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"reason",className:"block text-sm font-medium text-muted mb-1",children:["Reason ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"reason",value:c,onChange:w=>d(w.target.value),placeholder:"Reason for granting comp off",className:"form-input",rows:4,required:!0,disabled:h})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/hr/leave-management"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:h,disabled:!s||!o||!c.trim(),children:"Grant Comp Off"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]})},Rue=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(""),[o,l]=E.useState(""),[c,d]=E.useState(!1),[h,p]=E.useState(null),x=async y=>{if(y.preventDefault(),!(!t.trim()||!s.trim())){d(!0);try{const _={id:t.toLowerCase().replace(/\s+/g,"_"),name:t.trim(),description:s.trim(),permissions:o.split(",").map(C=>C.trim()).filter(Boolean)},w=await ue.getModules();if(w.some(C=>C.id===_.id)){p({message:"Module with this ID already exists.",type:"error"}),d(!1);return}const j=[...w,_];await ue.saveModules(j),p({message:"Module created successfully!",type:"success"}),setTimeout(()=>n("/admin/modules"),1500)}catch{p({message:"Failed to create module. Please try again.",type:"error"})}finally{d(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Module"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(ym,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new system module."})]}),i.jsxs("form",{onSubmit:x,className:"space-y-4",children:[i.jsx(we,{label:"Module Name",id:"name",value:t,onChange:y=>r(y.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c,error:!t.trim()&&t!==""?"Module name is required":""}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:y=>a(y.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:y=>l(y.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/modules"),disabled:c,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:x,disabled:c||!t.trim()||!s.trim(),className:"fo-btn-primary flex-1",children:c?"Creating...":"Create Module"})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(ym,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add New Module"}),i.jsx("p",{className:"text-muted",children:"Create a new system module."})]})]}),i.jsxs("form",{onSubmit:x,className:"space-y-6",children:[i.jsx(we,{label:"Module Name",id:"name",value:t,onChange:y=>r(y.target.value),placeholder:"e.g. HR Tasks & Management",required:!0,disabled:c}),i.jsxs("div",{children:[i.jsxs("label",{htmlFor:"description",className:"block text-sm font-medium text-muted mb-1",children:["Description ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("textarea",{id:"description",value:s,onChange:y=>a(y.target.value),placeholder:"Manage leaves, policies, insurance, uniforms, and tasks.",className:"form-input",rows:4,required:!0,disabled:c})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"permissions",className:"block text-sm font-medium text-muted mb-1",children:"Permissions (comma-separated)"}),i.jsx("input",{id:"permissions",value:o,onChange:y=>l(y.target.value),placeholder:"e.g. view_module, manage_module",className:"form-input",disabled:c})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/modules"),variant:"secondary",disabled:c,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:c,disabled:!t.trim()||!s.trim(),children:"Create Module"})]})]})]}),h&&i.jsx(pt,{message:h.message,type:h.type,onDismiss:()=>p(null)})]})},GL=()=>{const n=St(),{id:e}=Bf(),t=!!e,r=Rt("(max-width: 767px)"),{permissions:s,setRolePermissions:a,addRolePermissionEntry:o}=ta(),[l,c]=E.useState(""),[d,h]=E.useState(""),[p,x]=E.useState([]),[y,_]=E.useState(!1),[w,j]=E.useState(null);E.useEffect(()=>{(async()=>{try{if(t&&e){const D=(await ue.getRoles()).find(I=>I.id===e);if(D){c(D.id),h(D.displayName);const I=s[D.id]||[];x(I)}}}catch{j({message:"Failed to load data.",type:"error"})}})()},[e,t,s]);const C=O=>{x(M=>M.includes(O)?M.filter(D=>D!==O):[...M,O])},P=async O=>{if(O.preventDefault(),!(!l.trim()||!d.trim())){_(!0);try{const M=t?l:l.toLowerCase().replace(/\s+/g,"_"),D={id:M,displayName:d.trim()},I=await ue.getRoles();let F=[...I];if(t)F=F.map(q=>q.id===M?D:q);else{if(I.some(q=>q.id===M)){j({message:"Role ID already exists.",type:"error"}),_(!1);return}F.push(D)}await ue.saveRoles(F),a(M,p),t||o(D),j({message:`Role ${t?"updated":"created"} successfully!`,type:"success"}),setTimeout(()=>n("/admin/roles"),1500)}catch{j({message:"Failed to save role. Please try again.",type:"error"})}finally{_(!1)}}};return r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Role":"Add Role"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(vm,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Define role permissions and access control."})]}),i.jsxs("form",{onSubmit:P,className:"space-y-4",children:[i.jsx(we,{label:"Role ID",id:"roleId",value:l,onChange:O=>c(O.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:y||t}),i.jsx(we,{label:"Display Name",id:"displayName",value:d,onChange:O=>h(O.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:y}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-muted mb-2",children:"Permissions"}),i.jsx("div",{className:"space-y-2 max-h-64 overflow-y-auto",children:_m.map(O=>i.jsxs("label",{className:"flex items-center gap-2 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(O.key),onChange:()=>C(O.key),className:"form-checkbox",disabled:y}),i.jsx("span",{className:"text-sm",children:O.name})]},O.key))})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/roles"),disabled:y,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P,disabled:y||!l.trim()||!d.trim(),className:"fo-btn-primary flex-1",children:y?"Saving...":t?"Save Changes":"Create Role"})]}),w&&i.jsx(pt,{message:w.message,type:w.type,onDismiss:()=>j(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(vm,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Role":"Add New Role"}),i.jsx("p",{className:"text-muted",children:"Define role permissions and access control."})]})]}),i.jsxs("form",{onSubmit:P,className:"space-y-6",children:[i.jsx(we,{label:"Role ID",id:"roleId",value:l,onChange:O=>c(O.target.value),placeholder:"e.g. admin, hr, field_officer",required:!0,disabled:y||t}),i.jsx(we,{label:"Display Name",id:"displayName",value:d,onChange:O=>h(O.target.value),placeholder:"e.g. Admin, HR, Field Officer",required:!0,disabled:y}),i.jsxs("div",{children:[i.jsxs("label",{className:"block text-sm font-medium text-muted mb-2",children:["Permissions (",p.length," selected)"]}),i.jsx("div",{className:"border border-border rounded-lg p-4 space-y-2 max-h-96 overflow-y-auto",children:_m.map(O=>i.jsxs("label",{className:"flex items-center gap-3 p-2 rounded hover:bg-page cursor-pointer",children:[i.jsx("input",{type:"checkbox",checked:p.includes(O.key),onChange:()=>C(O.key),className:"form-checkbox",disabled:y}),i.jsxs("div",{children:[i.jsx("div",{className:"text-sm font-medium",children:O.name}),O.description&&i.jsx("div",{className:"text-xs text-muted",children:O.description})]})]},O.key))})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/roles"),variant:"secondary",disabled:y,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:y,disabled:!l.trim()||!d.trim(),children:t?"Save Changes":"Create Role"})]})]})]}),w&&i.jsx(pt,{message:w.message,type:w.type,onDismiss:()=>j(null)})]})},Lue=Pt({groupId:xe().required("Please select a group"),companyId:xe().required("Please select a company"),clientId:xe().required("Please select a client"),manpowerCount:cs().typeError("Must be a number").min(0,"Cannot be negative").required("Manpower count is required")}).defined(),Fue=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState([]),[s,a]=E.useState(!0),[o,l]=E.useState(!1),[c,d]=E.useState(""),[h,p]=E.useState(!1),[x,y]=E.useState(null),_=E.useRef(null),{register:w,handleSubmit:j,watch:C,formState:{errors:P},setValue:O}=tn({resolver:In(Lue)}),M=C("groupId"),D=C("companyId");E.useEffect(()=>{a(!0),ue.getOrganizationStructure().then(r).catch(()=>y({message:"Failed to load organization structure.",type:"error"})).finally(()=>a(!1))},[]),E.useEffect(()=>{O("companyId",""),O("clientId",""),d("")},[M,O]),E.useEffect(()=>{O("clientId",""),d("")},[D,O]),E.useEffect(()=>{const W=G=>{_.current&&!_.current.contains(G.target)&&p(!1)};return document.addEventListener("mousedown",W),()=>document.removeEventListener("mousedown",W)},[]);const I=E.useMemo(()=>t.find(W=>W.id===M)?.companies||[],[t,M]),F=E.useMemo(()=>I.find(W=>W.id===D)?.entities||[],[I,D]),q=E.useMemo(()=>c?F.filter(W=>W.name.toLowerCase().includes(c.toLowerCase())):F,[F,c]),B=W=>{O("clientId",W.id,{shouldValidate:!0}),d(W.name),p(!1)},U=async W=>{const G=F.find(Z=>Z.id===W.clientId);if(G){l(!0);try{if((await ue.getOrganizations()).some(ae=>ae.id===G.organizationId)){y({message:"A site for this client already exists.",type:"error"}),l(!1);return}const Y={id:G.organizationId||`site_${Date.now()}`,shortName:G.name,fullName:G.name,address:G.location||G.registeredAddress||"",manpowerApprovedCount:W.manpowerCount};await ue.createOrganization(Y),y({message:"Site added successfully!",type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch{y({message:"Failed to add site. Please try again.",type:"error"})}finally{l(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site from an existing client entity."})]}),s?i.jsx("div",{className:"flex justify-center py-8",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-4",children:[i.jsxs(Ze,{label:"Group",id:"groupId",registration:w("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ze,{label:"Company",id:"companyId",registration:w("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:_,children:[i.jsx(we,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),O("clientId","")},onFocus:()=>p(!0),disabled:!D,error:P.clientId?.message,autoComplete:"off"}),h&&q.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:q.map(W=>i.jsx("li",{onClick:()=>B(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(we,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:w("manpowerCount"),error:P.manpowerCount?.message})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:o,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:j(U),disabled:o||s,className:"fo-btn-primary flex-1",children:o?"Adding...":"Add Site"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Zi,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Add Site from Client"}),i.jsx("p",{className:"text-muted",children:"Create a new site from an existing client entity."})]})]}),s?i.jsx("div",{className:"flex justify-center py-12",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})}):i.jsxs("form",{onSubmit:j(U),className:"space-y-6",children:[i.jsxs(Ze,{label:"Group",id:"groupId",registration:w("groupId"),error:P.groupId?.message,children:[i.jsx("option",{value:"",children:"Select a Group"}),t.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs(Ze,{label:"Company",id:"companyId",registration:w("companyId"),error:P.companyId?.message,disabled:!M,children:[i.jsx("option",{value:"",children:"Select a Company"}),I.map(W=>i.jsx("option",{value:W.id,children:W.name},W.id))]}),i.jsxs("div",{className:"relative",ref:_,children:[i.jsx(we,{label:"Client",id:"clientSearch",value:c,onChange:W=>{d(W.target.value),p(!0),O("clientId","")},onFocus:()=>p(!0),disabled:!D,error:P.clientId?.message,autoComplete:"off"}),h&&q.length>0&&i.jsx("ul",{className:"absolute z-10 w-full bg-card border border-border rounded-lg mt-1 max-h-48 overflow-y-auto shadow-lg",children:q.map(W=>i.jsx("li",{onClick:()=>B(W),className:"px-3 py-2 text-sm cursor-pointer hover:bg-page",children:W.name},W.id))})]}),i.jsx(we,{label:"Approved Manpower Count",id:"manpowerCount",type:"number",registration:w("manpowerCount"),error:P.manpowerCount?.message}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:o,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:o,children:"Add Site"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]})},que=()=>{const n=St(),e=Rt("(max-width: 767px)"),[t,r]=E.useState(""),[s,a]=E.useState(!1),[o,l]=E.useState(null),c=async d=>{if(d.preventDefault(),!!t.trim()){a(!0);try{const h={id:`SITE-${t.toUpperCase().replace(/\s/g,"").substring(0,4)}-${Date.now()%1e3}`,shortName:t.trim(),fullName:t.trim(),address:"To be configured",provisionalCreationDate:new Date().toISOString()};await ue.createOrganization(h),l({message:`Provisional site '${t}' created.`,type:"success"}),setTimeout(()=>n("/admin/sites"),1500)}catch(h){const p=h?.message||h?.error?.message||"Failed to create site.";l({message:`Failed to create site: ${p}`,type:"error"})}finally{a(!1)}}};return e?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:"Quick Add Site"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(AS,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Create a new site with a 90-day grace period."})]}),i.jsxs("form",{onSubmit:c,className:"space-y-4",children:[i.jsx(we,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-xs text-muted",children:"This will create a new site with a 90-day grace period to complete the full configuration."})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/admin/sites"),disabled:s,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:c,disabled:s||!t.trim(),className:"fo-btn-primary flex-1",children:s?"Adding...":"Add Site"})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-2xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(AS,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:"Quick Add Provisional Site"}),i.jsx("p",{className:"text-muted",children:"Create a new site with a 90-day grace period to complete the full configuration."})]})]}),i.jsxs("form",{onSubmit:c,className:"space-y-6",children:[i.jsx(we,{label:"New Site Name",id:"quick-add-site-name",value:t,onChange:d=>r(d.target.value),placeholder:"e.g. New Project Site",required:!0,disabled:s,autoFocus:!0}),i.jsx("p",{className:"text-sm text-muted -mt-4",children:"This will create a new site with a 90-day grace period to complete the full configuration."}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/admin/sites"),variant:"secondary",disabled:s,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:s,disabled:!t.trim(),children:"Add Site"})]})]})]}),o&&i.jsx(pt,{message:o.message,type:o.type,onDismiss:()=>l(null)})]})},zue=Pt({name:xe().required("Task name is required"),description:xe().required("Description is required"),dueDate:xe().required("A due date is required").nullable(),priority:xe().oneOf(["Low","Medium","High"]).required("Priority is required"),assignedToId:xe().required("An assignee is required"),escalationLevel1UserId:xe().optional(),escalationLevel1DurationDays:cs().when("escalationLevel1UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationLevel2UserId:xe().optional(),escalationLevel2DurationDays:cs().when("escalationLevel2UserId",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()}),escalationEmail:xe().email("Must be a valid email address").optional(),escalationEmailDurationDays:cs().when("escalationEmail",{is:n=>!!n,then:n=>n.required("Duration is required").min(0).typeError("Must be a number"),otherwise:n=>n.optional().nullable()})}).defined(),ZL=()=>{const n=St(),{id:e}=Bf(),t=!!e,r=Rt("(max-width: 767px)"),{createTask:s,updateTask:a,tasks:o}=_C(),[l,c]=E.useState(!1),[d,h]=E.useState([]),[p,x]=E.useState(null),{permissions:y}=ta(),{fetchNotifications:_}=cy(),{theme:w}=ed(),{colorScheme:j}=an(),C=w==="dark",{register:P,handleSubmit:O,formState:{errors:M},reset:D,control:I,watch:F}=tn({resolver:In(zue),defaultValues:{priority:"Medium",assignedToId:"",dueDate:null}}),q=F("escalationLevel1UserId"),B=F("escalationLevel2UserId"),U=F("escalationEmail");E.useEffect(()=>{(async()=>{try{const K=await ue.getUsers();if(h(K),t&&e){let re=o.find(H=>H.id===e);re||(re=(await ue.getTasks()).find(se=>se.id===e)),re?D(re):(x({message:"Task not found.",type:"error"}),setTimeout(()=>n("/tasks"),2e3))}}catch{x({message:"Failed to load data.",type:"error"})}})()},[e,t,o,D,n]);const W=async $=>{c(!0);try{const K=d.find(H=>H.id===$.assignedToId),re={...$,assignedToName:K?.name};if(t&&e?(await a(e,re),x({message:"Task updated successfully!",type:"success"})):(await s(re),x({message:"Task created successfully.",type:"success"})),K){const ie=(y[K.role]||[]).includes("manage_tasks")?"/tasks":"/onboarding/tasks";(!t||t&&e)&&(await ue.createNotification({userId:K.id,type:"task_assigned",message:`You have been assigned a new task: "${$.name}"`,linkTo:ie}),_())}setTimeout(()=>n("/tasks"),1500)}catch{x({message:"Failed to save task.",type:"error"})}finally{c(!1)}},G=j==="blue"?"!bg-[#0f2548] !border-white/10 !text-white !placeholder-slate-400 !rounded-xl focus:!ring-blue-500 focus:!border-blue-500":"!bg-[#041b0f] !border-white/10 !text-white !placeholder-gray-500 !rounded-xl focus:!ring-emerald-500 focus:!border-emerald-500",Z="text-gray-300 font-medium mb-1.5 block",Y="",ae="block text-sm font-medium text-muted mb-1",ee=C?G:Y,me=C?Z:ae;return r?i.jsxs("div",{className:`h-full flex flex-col ${C?j==="blue"?"bg-[#0a1628] text-white":"bg-[#041b0f] text-white":""}`,children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Task":"Add Task"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:`${C?j==="blue"?"bg-[#0f2548] border border-white/10":"bg-[#152b1b] border border-white/10":"bg-card"} rounded-2xl p-6 space-y-6`,children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:`inline-block p-3 rounded-full mb-2 ${C?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(bm,{className:`h-8 w-8 ${C?"text-emerald-400":"text-accent-dark"}`})}),i.jsx("h2",{className:`text-xl font-bold ${C?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Assign tasks and set deadlines."})]}),i.jsxs("form",{onSubmit:O(W),className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"name",className:me,children:"Task Name"}),i.jsx(we,{id:"name",registration:P("name"),error:M.name?.message,className:ee,placeholder:C?"Enter task name":""})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"description",className:me,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...P("description"),className:C?`w-full ${ee} px-3 py-3 outline-none`:`mt-1 bg-card border ${M.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:C?"Enter task description":""}),M.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:M.description.message})]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:me,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:I,render:({field:$})=>i.jsx(En,{label:"",id:"dueDate",value:$.value,onChange:$.onChange,error:M.dueDate?.message,minDate:new Date,className:ee})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:me,children:"Priority"}),i.jsxs(Ze,{id:"priority",registration:P("priority"),error:M.priority?.message,className:ee,children:[i.jsx("option",{value:"Low",className:C?j==="blue"?"bg-[#0f2548]":"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:C?j==="blue"?"bg-[#0f2548]":"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:C?j==="blue"?"bg-[#0f2548]":"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"assignedToId",className:me,children:"Assign To"}),i.jsxs(Ze,{id:"assignedToId",registration:P("assignedToId"),error:M.assignedToId?.message,className:ee,children:[i.jsx("option",{value:"",className:C?j==="blue"?"bg-[#0f2548]":"bg-[#041b0f]":"",children:"Select User"}),d.map($=>i.jsxs("option",{value:$.id,className:C?j==="blue"?"bg-[#0f2548]":"bg-[#041b0f]":"",children:[$.name," (",$.role.replace(/_/g," "),")"]},$.id))]})]})]})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/tasks"),disabled:l,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:O(W),disabled:l,className:"fo-btn-primary flex-1",children:l?"Saving...":t?"Save Changes":"Create Task"})]}),p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)})]}):i.jsxs("div",{className:`p-4 md:p-6 ${C?"text-white":""}`,children:[i.jsxs("div",{className:`${C?j==="blue"?"bg-[#0f2548] border border-white/10":"bg-[#152b1b] border border-white/10":"bg-card"} p-8 rounded-xl shadow-card w-full max-w-3xl mx-auto`,children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:`p-3 rounded-full mr-4 ${C?"bg-emerald-500/20":"bg-accent-light"}`,children:i.jsx(bm,{className:`h-8 w-8 ${C?"text-emerald-400":"text-accent-dark"}`})}),i.jsxs("div",{children:[i.jsx("h2",{className:`text-2xl font-bold ${C?"text-white":"text-primary-text"}`,children:t?"Edit Task":"Create New Task"}),i.jsx("p",{className:C?"text-gray-400":"text-muted",children:"Assign tasks and set deadlines."})]})]}),i.jsxs("form",{onSubmit:O(W),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"name",className:me,children:"Task Name"}),i.jsx(we,{id:"name",registration:P("name"),error:M.name?.message,className:ee,placeholder:C?"Enter task name":""})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"description",className:me,children:"Description"}),i.jsx("textarea",{id:"description",rows:4,...P("description"),className:C?`w-full ${ee} px-3 py-3 outline-none`:`mt-1 bg-card border ${M.description?"border-red-500":"border-border"} rounded-lg px-3 py-2.5 w-full sm:text-sm focus:ring-1 focus:ring-accent`,placeholder:C?"Enter task description":""}),M.description&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:M.description.message})]}),i.jsxs("div",{children:[i.jsx("label",{className:me,children:"Due Date"}),i.jsx(_e,{name:"dueDate",control:I,render:({field:$})=>i.jsx(En,{label:"",id:"dueDate",value:$.value,onChange:$.onChange,error:M.dueDate?.message,minDate:new Date,className:ee})})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"priority",className:me,children:"Priority"}),i.jsxs(Ze,{id:"priority",registration:P("priority"),error:M.priority?.message,className:ee,children:[i.jsx("option",{value:"Low",className:C?"bg-[#041b0f]":"",children:"Low"}),i.jsx("option",{value:"Medium",className:C?"bg-[#041b0f]":"",children:"Medium"}),i.jsx("option",{value:"High",className:C?"bg-[#041b0f]":"",children:"High"})]})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"assignedToId",className:me,children:"Assign To"}),i.jsxs(Ze,{id:"assignedToId",registration:P("assignedToId"),error:M.assignedToId?.message,className:ee,children:[i.jsx("option",{value:"",className:C?"bg-[#041b0f]":"",children:"Select User"}),d.map($=>i.jsxs("option",{value:$.id,className:C?"bg-[#041b0f]":"",children:[$.name," (",$.role.replace(/_/g," "),")"]},$.id))]})]})]}),i.jsxs("div",{className:`pt-6 border-t ${C?"border-white/10":"border-border"}`,children:[i.jsx("h4",{className:`text-lg font-semibold ${C?"text-white":"text-primary-text"} mb-1`,children:"Escalation Matrix (Optional)"}),i.jsx("p",{className:`text-sm ${C?"text-gray-400":"text-muted"} mb-6`,children:"Define who gets notified if this task becomes overdue."}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1UserId",className:me,children:"Escalation Level 1"}),i.jsxs(Ze,{id:"escalationLevel1UserId",registration:P("escalationLevel1UserId"),error:M.escalationLevel1UserId?.message,className:ee,children:[i.jsx("option",{value:"",className:C?"bg-[#041b0f]":"",children:"Select User"}),d.map($=>i.jsx("option",{value:$.id,className:C?"bg-[#041b0f]":"",children:$.name},$.id))]})]}),q&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel1DurationDays",className:me,children:"Days until L1 Escalation"}),i.jsx(we,{id:"escalationLevel1DurationDays",type:"number",registration:P("escalationLevel1DurationDays"),error:M.escalationLevel1DurationDays?.message,className:ee})]}),i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2UserId",className:me,children:"Escalation Level 2"}),i.jsxs(Ze,{id:"escalationLevel2UserId",registration:P("escalationLevel2UserId"),error:M.escalationLevel2UserId?.message,className:ee,children:[i.jsx("option",{value:"",className:C?"bg-[#041b0f]":"",children:"Select User"}),d.map($=>i.jsx("option",{value:$.id,className:C?"bg-[#041b0f]":"",children:$.name},$.id))]})]}),B&&i.jsxs("div",{children:[i.jsx("label",{htmlFor:"escalationLevel2DurationDays",className:me,children:"Days until L2 Escalation"}),i.jsx(we,{id:"escalationLevel2DurationDays",type:"number",registration:P("escalationLevel2DurationDays"),error:M.escalationLevel2DurationDays?.message,className:ee})]}),i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmail",className:me,children:"Final Escalation Email"}),i.jsx(we,{id:"escalationEmail",type:"email",registration:P("escalationEmail"),error:M.escalationEmail?.message,className:ee,placeholder:C?"Enter email address":""})]}),U&&i.jsxs("div",{className:"md:col-span-2",children:[i.jsx("label",{htmlFor:"escalationEmailDurationDays",className:me,children:"Days until Final Escalation"}),i.jsx(we,{id:"escalationEmailDurationDays",type:"number",registration:P("escalationEmailDurationDays"),error:M.escalationEmailDurationDays?.message,className:ee})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/tasks"),variant:"secondary",disabled:l,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:l,children:t?"Save Changes":"Create Task"})]})]})]}),p&&i.jsx(pt,{message:p.message,type:p.type,onDismiss:()=>x(null)})]})},Pc=({title:n,sizes:e,headers:t,control:r,quantityType:s,quantities:a,readOnly:o=!1})=>{const l=Array.from(new Set(e.map(d=>d.fit))),c=Array.from(new Set(e.map(d=>d.size))).sort((d,h)=>{const p=parseInt(String(d)),x=parseInt(String(h));return!isNaN(p)&&!isNaN(x)?p-x:String(d).localeCompare(String(h))});return i.jsxs("div",{className:"border rounded-lg flex flex-col overflow-hidden bg-card",children:[i.jsx("h4",{className:"p-3 font-semibold bg-gray-50 dark:bg-white/5 border-b flex-shrink-0",children:n}),i.jsx("div",{className:"overflow-x-auto",children:i.jsxs("table",{className:"min-w-full text-sm",children:[i.jsx("thead",{className:"bg-gray-50 dark:bg-white/5",children:i.jsxs("tr",{children:[i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:"Size"}),t.map(d=>i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted",children:d.label},String(d.key))),i.jsx("th",{className:"px-2 py-2 text-left font-medium text-muted w-20",children:"Qty"})]})}),i.jsx("tbody",{className:"divide-y dark:divide-white/10",children:c.map(d=>i.jsx(ot.Fragment,{children:l.map((h,p)=>{const x=e.find(y=>y.size===d&&y.fit===h);return x?i.jsxs("tr",{children:[p===0&&i.jsx("td",{rowSpan:l.filter(y=>e.some(_=>_.size===d&&_.fit===y)).length,className:"px-2 py-2 align-middle font-semibold border-r dark:border-white/10",children:d}),t.map(y=>i.jsx("td",{className:"px-2 py-2",children:x[y.key]},String(y.key))),i.jsx("td",{className:"px-2 py-2",children:o?i.jsx("span",{className:"font-semibold block text-center pr-4",children:a?.[x.id]||0}):i.jsx(_e,{name:`${s}.${x.id}`,control:r,render:({field:y})=>i.jsx(we,{"aria-label":`Quantity for ${n} size ${d} ${h}`,type:"number",...y,value:y.value||"",onChange:_=>y.onChange(parseInt(_.target.value)||null),className:"!py-1.5"})})})]},x.id):null})},d))})]})})]})},KL=()=>{const n=St(),{id:e}=Bf(),t=!!e,r=Rt("(max-width: 767px)"),[s,a]=E.useState([]),[o,l]=E.useState(null),[c,d]=E.useState(!0),[h,p]=E.useState(!1),[x,y]=E.useState(null),[_,w]=E.useState(null),{register:j,control:C,handleSubmit:P,watch:O,reset:M}=tn({defaultValues:{siteId:"",gender:"Gents",pantsQuantities:{},shirtsQuantities:{}}}),D=O("gender");E.useEffect(()=>{(async()=>{d(!0);try{const[q,B,U]=await Promise.all([ue.getOrganizations(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);if(a(q),l({gents:B,ladies:U}),t&&e){const G=(await ue.getUniformRequests()).find(Z=>Z.id===e);if(G){w(G);const Z={},Y={};G.items.forEach(ae=>{ae.category==="Pants"?Z[ae.sizeId]=ae.quantity:Y[ae.sizeId]=ae.quantity}),M({siteId:G.siteId,gender:G.gender,pantsQuantities:Z,shirtsQuantities:Y})}else y({message:"Request not found.",type:"error"}),setTimeout(()=>n("/uniforms"),2e3)}}catch{y({message:"Failed to load data.",type:"error"})}finally{d(!1)}})()},[e,t,n,M]);const I=async F=>{if(!o)return;const q=s.find(B=>B.id===F.siteId);if(q){p(!0);try{const B=D==="Gents"?[...o.gents.pants,...o.gents.shirts]:[...o.ladies.pants,...o.ladies.shirts],U=[];for(const[G,Z]of Object.entries(F.pantsQuantities))if(Z&&Z>0){const Y=B.find(ae=>ae.id===G);Y&&U.push({sizeId:G,quantity:Z,category:"Pants",sizeLabel:Y.size,fit:Y.fit})}for(const[G,Z]of Object.entries(F.shirtsQuantities))if(Z&&Z>0){const Y=B.find(ae=>ae.id===G);Y&&U.push({sizeId:G,quantity:Z,category:"Shirts",sizeLabel:Y.size,fit:Y.fit})}const W={id:_?.id||`new_${Date.now()}`,siteId:F.siteId,siteName:q.shortName,gender:F.gender,requestedDate:_?.requestedDate||new Date().toISOString(),status:_?.status||"Pending",items:U};W.id.startsWith("new_")?(await ue.submitUniformRequest(W),y({message:"New request submitted.",type:"success"})):(await ue.updateUniformRequest(W),y({message:"Request updated.",type:"success"})),setTimeout(()=>n("/uniforms"),1500)}catch{y({message:"Failed to save request.",type:"error"})}finally{p(!1)}}};return c?i.jsx("div",{className:"flex justify-center items-center h-screen",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-emerald-600"})}):o?r?i.jsxs("div",{className:"h-full flex flex-col",children:[i.jsx("header",{className:"p-4 flex-shrink-0 fo-mobile-header",children:i.jsx("h1",{children:t?"Edit Request":"New Request"})}),i.jsx("main",{className:"flex-1 overflow-y-auto p-4",children:i.jsxs("div",{className:"bg-card rounded-2xl p-6 space-y-6",children:[i.jsxs("div",{className:"text-center",children:[i.jsx("div",{className:"inline-block bg-accent-light p-3 rounded-full mb-2",children:i.jsx(Rf,{className:"h-8 w-8 text-accent-dark"})}),i.jsx("h2",{className:"text-xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-sm text-gray-400",children:"Submit a request for new uniforms."})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs(Ze,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]}),i.jsx("div",{className:"space-y-6",children:D==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Pc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Pc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Pc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Pc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]})})]})]})}),i.jsxs("footer",{className:"p-4 flex-shrink-0 flex items-center gap-4",children:[i.jsx("button",{type:"button",onClick:()=>n("/uniforms"),disabled:h,className:"fo-btn-secondary px-6",children:"Cancel"}),i.jsx("button",{type:"submit",onClick:P(I),disabled:h,className:"fo-btn-primary flex-1",children:h?"Saving...":"Save Request"})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]}):i.jsxs("div",{className:"p-4 md:p-6",children:[i.jsxs("div",{className:"bg-card p-8 rounded-xl shadow-card w-full max-w-5xl mx-auto",children:[i.jsxs("div",{className:"flex items-center mb-6",children:[i.jsx("div",{className:"bg-accent-light p-3 rounded-full mr-4",children:i.jsx(Rf,{className:"h-8 w-8 text-accent-dark"})}),i.jsxs("div",{children:[i.jsx("h2",{className:"text-2xl font-bold text-primary-text",children:t?"Edit Uniform Request":"New Uniform Request"}),i.jsx("p",{className:"text-muted",children:"Submit a request for new uniforms."})]})]}),i.jsxs("form",{onSubmit:P(I),className:"space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Select Site",...j("siteId"),required:!0,children:[i.jsx("option",{value:"",children:"-- Select a Site --"}),s.map(F=>i.jsx("option",{value:F.id,children:F.shortName},F.id))]}),i.jsxs(Ze,{label:"Select Uniform Type",...j("gender"),children:[i.jsx("option",{children:"Gents"}),i.jsx("option",{children:"Ladies"})]})]}),i.jsx("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6",children:D==="Gents"?i.jsxs(i.Fragment,{children:[i.jsx(Pc,{title:"Gents' Pants",sizes:o.gents.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"tilesLoose",label:"TL"},{key:"bottomWaist",label:"BW"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Pc,{title:"Gents' Shirts",sizes:o.gents.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"chest",label:"C"},{key:"shoulder",label:"Sh"},{key:"collar",label:"Co"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]}):i.jsxs(i.Fragment,{children:[i.jsx(Pc,{title:"Ladies' Pants",sizes:o.ladies.pants,headers:[{key:"length",label:"L"},{key:"waist",label:"W"},{key:"hip",label:"H"},{key:"fit",label:"Fit"}],control:C,quantityType:"pantsQuantities"}),i.jsx(Pc,{title:"Ladies' Shirts",sizes:o.ladies.shirts,headers:[{key:"length",label:"L"},{key:"sleeves",label:"S"},{key:"bust",label:"B"},{key:"shoulder",label:"Sh"},{key:"fit",label:"Fit"}],control:C,quantityType:"shirtsQuantities"})]})}),i.jsxs("div",{className:"mt-8 pt-6 border-t flex justify-end gap-3",children:[i.jsx(ne,{type:"button",onClick:()=>n("/uniforms"),variant:"secondary",disabled:h,children:"Cancel"}),i.jsx(ne,{type:"submit",isLoading:h,children:h?"Saving...":"Save Request"})]})]})]}),x&&i.jsx(pt,{message:x.message,type:x.type,onDismiss:()=>y(null)})]}):null},vr=({label:n,isVerified:e,hasValue:t,error:r,registration:s,onManualInput:a,...o})=>{const{theme:l}=ed(),c=l==="dark",h=s?{...s,onChange:async p=>{a&&a(),s?.onChange&&await s.onChange(p)}}:void 0;return i.jsxs("div",{children:[i.jsxs("div",{className:"flex items-center mb-1",children:[i.jsx("label",{htmlFor:o.id,className:"block text-sm font-medium text-muted",children:n}),t&&(e?i.jsx("span",{className:`ml-2 flex items-center ${c?"text-green-400":"text-green-600"}`,title:"Verified from document",children:i.jsx(Ki,{className:"h-4 w-4"})}):i.jsx("span",{className:`ml-2 flex items-center ${c?"text-yellow-400":"text-yellow-500"}`,title:"Manually entered. Please verify.",children:i.jsx(Aa,{className:"h-4 w-4"})}))]}),i.jsx(we,{id:o.id,error:r,registration:h,label:"",...o})]})},Uue=Pt({employeeId:xe().required(),firstName:xe().required("First name is required"),middleName:xe().optional(),lastName:xe().required("Last name is required"),preferredName:xe().optional(),dob:xe().required("Date of birth is required"),gender:xe().oneOf(["Male","Female","Other",""]).required("Gender is required"),maritalStatus:xe().oneOf(["Single","Married","Divorced","Widowed",""]).required("Marital status is required"),bloodGroup:xe().oneOf(["","A+","A-","B+","B-","AB+","AB-","O+","O-"]).required("Blood group is required"),mobile:xe().required("Mobile number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian mobile number"),alternateMobile:xe().optional().nullable(),email:xe().email("Must be a valid email").required("Email is required"),idProofType:xe().oneOf(["Aadhaar","PAN","Voter ID",""]).optional(),idProofNumber:xe().optional(),photo:Wt().optional().nullable(),idProofFront:Wt().optional().nullable(),idProofBack:Wt().optional().nullable(),emergencyContactName:xe().required("Emergency contact name is required"),emergencyContactNumber:xe().required("Emergency contact number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit number"),relationship:xe().oneOf(["Spouse","Child","Father","Mother","Sibling","Other",""]).required("Relationship is required"),salary:cs().typeError("Salary must be a number").min(0).required("Salary is required").nullable(),verifiedStatus:Pt().optional()}).defined(),Bue=()=>{const{onValidated:n}=wi(),{data:e,updatePersonal:t,addOrUpdateEmergencyContactAsFamilyMember:r,setPersonalVerifiedStatus:s}=Yn(),{register:a,handleSubmit:o,formState:{errors:l},control:c,reset:d,watch:h}=tn({resolver:In(Uue),defaultValues:e.personal}),p=h();E.useEffect(()=>{d(e.personal)},[e.personal,d]),E.useEffect(()=>{let y;const _=h(w=>{clearTimeout(y),y=window.setTimeout(()=>{t(w)},500)});return()=>{_.unsubscribe(),clearTimeout(y)}},[h,t]);const x=async y=>{t(y),r(),await n()};return i.jsxs("form",{onSubmit:o(x),id:"personal-form",children:[i.jsx("div",{className:"text-left",children:i.jsx(Pr,{title:"Personal Details",subtitle:"Please provide your personal information as per your official documents."})}),i.jsxs("div",{className:"flex flex-col md:flex-row gap-8 md:items-start",children:[i.jsx("div",{className:"flex-shrink-0 mx-auto md:mx-0",children:i.jsx(_e,{name:"photo",control:c,render:({field:y})=>i.jsx($S,{file:y.value,onFileChange:_=>y.onChange(_)})})}),i.jsxs("div",{className:"w-full flex-grow grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:[i.jsx("div",{className:"md:col-span-3",children:i.jsx(we,{label:"Employee ID",id:"employeeId",registration:a("employeeId"),error:l.employeeId?.message,readOnly:!0,className:"bg-gray-100"})}),i.jsx(vr,{label:"First Name",id:"firstName",registration:a("firstName"),error:l.firstName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.firstName,onManualInput:()=>s({name:!1})}),i.jsx(we,{label:"Middle Name (Optional)",id:"middleName",registration:a("middleName")}),i.jsx(vr,{label:"Last Name",id:"lastName",registration:a("lastName"),error:l.lastName?.message,isVerified:e.personal.verifiedStatus?.name===!0,hasValue:!!p.lastName,onManualInput:()=>s({name:!1})}),i.jsx(we,{label:"Preferred Name (Optional)",id:"preferredName",registration:a("preferredName")}),i.jsx(_e,{name:"dob",control:c,render:({field:y})=>i.jsx(En,{label:"Date of Birth",id:"dob",error:l.dob?.message,value:y.value,onChange:_=>{y.onChange(_),s({dob:!1})},maxDate:new Date})}),i.jsxs(Ze,{label:"Gender",id:"gender",registration:a("gender"),error:l.gender?.message,children:[i.jsx("option",{value:"",children:"Select Gender"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]}),i.jsxs(Ze,{label:"Marital Status",id:"maritalStatus",registration:a("maritalStatus"),error:l.maritalStatus?.message,children:[i.jsx("option",{value:"",children:"Select Status"}),i.jsx("option",{children:"Single"}),i.jsx("option",{children:"Married"}),i.jsx("option",{children:"Divorced"}),i.jsx("option",{children:"Widowed"})]}),i.jsxs(Ze,{label:"Blood Group",id:"bloodGroup",registration:a("bloodGroup"),error:l.bloodGroup?.message,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"A+"}),i.jsx("option",{children:"A-"}),i.jsx("option",{children:"B+"}),i.jsx("option",{children:"B-"}),i.jsx("option",{children:"AB+"}),i.jsx("option",{children:"AB-"}),i.jsx("option",{children:"O+"}),i.jsx("option",{children:"O-"})]}),i.jsx(we,{label:"Mobile Number",id:"mobile",type:"tel",registration:a("mobile"),error:l.mobile?.message}),i.jsx(we,{label:"Alternate Mobile (Optional)",id:"alternateMobile",type:"tel",registration:a("alternateMobile")}),i.jsx(we,{label:"Email Address",id:"email",type:"email",registration:a("email"),error:l.email?.message}),i.jsx(we,{label:"Monthly Salary (Gross)",id:"salary",type:"number",registration:a("salary"),error:l.salary?.message}),i.jsxs("div",{className:"md:col-span-3 pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Emergency Contact"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-6",children:[i.jsx(we,{label:"Contact Name",id:"emergencyContactName",registration:a("emergencyContactName"),error:l.emergencyContactName?.message}),i.jsx(we,{label:"Contact Number",id:"emergencyContactNumber",type:"tel",registration:a("emergencyContactNumber"),error:l.emergencyContactNumber?.message}),i.jsxs(Ze,{label:"Relationship",id:"relationship",registration:a("relationship"),error:l.relationship?.message,children:[i.jsx("option",{value:"",children:"Select Relationship"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"}),i.jsx("option",{children:"Sibling"}),i.jsx("option",{children:"Other"})]})]})]})]})]})]})},JL=Pt({line1:xe().required("Address line 1 is required"),line2:xe().optional(),city:xe().required("City is required"),state:xe().required("State is required"),country:xe().required("Country is required"),pincode:xe().required("Pincode is required").matches(/^[1-9][0-9]{5}$/,"Must be a valid 6-digit Indian pincode"),verifiedStatus:Pt().optional()}).defined(),Vue=Pt({present:JL.required(),permanent:JL.required(),sameAsPresent:ls().required()}).defined(),Wue=()=>{const{onValidated:n}=wi(),{data:e,updateAddress:t,setAddressVerifiedStatus:r}=Yn(),{address:s}=yi(),[a,o]=E.useState(!1),[l,c]=E.useState(""),{register:d,handleSubmit:h,formState:{errors:p},control:x,setValue:y,trigger:_,getValues:w,reset:j,watch:C}=tn({resolver:In(Vue),defaultValues:e.address}),P=du({control:x,name:"sameAsPresent"}),O=du({control:x,name:"present"}),M=du({control:x,name:"permanent"});E.useEffect(()=>{j(e.address)},[e.address,j]),E.useEffect(()=>{let q;const B=C(U=>{clearTimeout(q),q=window.setTimeout(()=>{t(U)},500)});return()=>{B.unsubscribe(),clearTimeout(q)}},[C,t]),E.useEffect(()=>{P&&(y("permanent",O),_("permanent"))},[P,O,y,_]);const D=(q,B)=>{r(q,{[B]:!1})},I=async q=>{const B=q.target.value;if(D("present","pincode"),s.enablePincodeVerification&&/^[1-9][0-9]{5}$/.test(B)){o(!0),c("");try{const U=await ue.getPincodeDetails(B);y("present.city",U.city,{shouldValidate:!0}),y("present.state",U.state,{shouldValidate:!0}),r("present",{city:!0,state:!0,pincode:!0})}catch{c("Invalid Pincode. Please check and try again.")}finally{o(!1)}}},F=async q=>{t(q),await n()};return i.jsxs("form",{onSubmit:h(F),id:"address-form",children:[i.jsx(Pr,{title:"Address Details",subtitle:"Your communication and permanent address."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Present Address"}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(vr,{label:"Address Line 1",id:"present.line1",isVerified:!!e.address.present.verifiedStatus?.line1,hasValue:!!O?.line1,onManualInput:()=>D("present","line1"),error:p.present?.line1?.message,registration:d("present.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(we,{label:"Address Line 2 (Optional)",id:"present.line2",registration:d("present.line2")})}),i.jsx(vr,{label:"Country",id:"present.country",isVerified:!!e.address.present.verifiedStatus?.country,hasValue:!!O?.country,onManualInput:()=>D("present","country"),error:p.present?.country?.message,registration:d("present.country")}),i.jsxs("div",{className:"relative",children:[i.jsx(vr,{label:"Pincode",id:"present.pincode",type:"tel",isVerified:!!e.address.present.verifiedStatus?.pincode,hasValue:!!O?.pincode,error:p.present?.pincode?.message||l,registration:d("present.pincode"),onBlur:I}),a&&i.jsx(_t,{className:"absolute right-3 top-9 h-5 w-5 animate-spin text-muted"})]}),i.jsx(vr,{label:"City",id:"present.city",isVerified:!!e.address.present.verifiedStatus?.city,hasValue:!!O?.city,onManualInput:()=>D("present","city"),error:p.present?.city?.message,registration:d("present.city")}),i.jsx(vr,{label:"State",id:"present.state",isVerified:!!e.address.present.verifiedStatus?.state,hasValue:!!O?.state,onManualInput:()=>D("present","state"),error:p.present?.state?.message,registration:d("present.state")})]})]}),i.jsxs("div",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4",children:"Permanent Address"}),i.jsxs("div",{className:"flex items-center mb-4",children:[i.jsx("input",{id:"sameAsPresent",type:"checkbox",...d("sameAsPresent"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"sameAsPresent",className:"ml-2 block text-sm text-muted",children:"Same as Present Address"})]}),!P&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsx("div",{className:"sm:col-span-2",children:i.jsx(vr,{label:"Address Line 1",id:"permanent.line1",isVerified:!!e.address.permanent.verifiedStatus?.line1,hasValue:!!M?.line1,onManualInput:()=>D("permanent","line1"),error:p.permanent?.line1?.message,registration:d("permanent.line1")})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(we,{label:"Address Line 2 (Optional)",id:"permanent.line2",registration:d("permanent.line2")})}),i.jsx(vr,{label:"Country",id:"permanent.country",isVerified:!!e.address.permanent.verifiedStatus?.country,hasValue:!!M?.country,onManualInput:()=>D("permanent","country"),error:p.permanent?.country?.message,registration:d("permanent.country")}),i.jsx(vr,{label:"Pincode",id:"permanent.pincode",type:"tel",isVerified:!!e.address.permanent.verifiedStatus?.pincode,hasValue:!!M?.pincode,onManualInput:()=>D("permanent","pincode"),error:p.permanent?.pincode?.message,registration:d("permanent.pincode")}),i.jsx(vr,{label:"City",id:"permanent.city",isVerified:!!e.address.permanent.verifiedStatus?.city,hasValue:!!M?.city,onManualInput:()=>D("permanent","city"),error:p.permanent?.city?.message,registration:d("permanent.city")}),i.jsx(vr,{label:"State",id:"permanent.state",isVerified:!!e.address.permanent.verifiedStatus?.state,hasValue:!!M?.state,onManualInput:()=>D("permanent","state"),error:p.permanent?.state?.message,registration:d("permanent.state")})]})]})]})]})},$ue=Pt({designation:xe().required("Designation is required"),department:xe().required("Department is required"),reportingManager:xe().optional(),organizationId:xe().required("Organization is required"),organizationName:xe().required(),joiningDate:xe().required("Joining date is required"),workType:xe().oneOf(["Full-time","Part-time","Contract",""]).required("Work type is required"),site:xe().optional(),defaultSalary:cs().nullable().optional()}).defined(),Hue=()=>{const{onValidated:n}=wi(),{user:e}=jt(),{data:t,updateOrganization:r}=Yn(),[s,a]=E.useState([]),o=Rt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,watch:p,setValue:x,reset:y}=tn({resolver:In($ue),defaultValues:t.organization}),_=p("organizationId"),w=p("designation"),j=!!t.organization.organizationId;E.useEffect(()=>{ue.getOrganizations().then(a)},[]),E.useEffect(()=>{y(t.organization)},[t.organization,y]),E.useEffect(()=>{let P;const O=p(M=>{clearTimeout(P),P=window.setTimeout(()=>{r(M)},500)});return()=>{O.unsubscribe(),clearTimeout(P)}},[p,r]),E.useEffect(()=>{const P=s.find(O=>O.id===_);P&&x("organizationName",P.shortName)},[_,s,x]),E.useEffect(()=>{w&&ue.suggestDepartmentForDesignation(w).then(P=>{P&&x("department",P,{shouldValidate:!0})})},[w,x]);const C=async P=>{r(P),await n()};return o?i.jsx("form",{onSubmit:c(C),id:"organization-form",children:i.jsxs("div",{className:"space-y-6",children:[i.jsx("p",{className:"text-sm text-gray-400",children:"Provide the employment details for the new employee within the organization."}),i.jsxs("select",{...l("organizationId"),className:"pro-select pro-select-arrow",disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),d.organizationId&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.organizationId.message}),i.jsx("input",{placeholder:"Designation",...l("designation"),className:"form-input"}),i.jsx("input",{placeholder:"Department",...l("department"),className:"form-input"}),i.jsx("input",{placeholder:"Reporting Manager",...l("reportingManager"),className:"form-input"}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx("input",{type:"date",...P,className:"form-input"})}),d.joiningDate&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.joiningDate.message}),i.jsxs("select",{...l("workType"),className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]}),d.workType&&i.jsx("p",{className:"mt-1 text-xs text-red-500",children:d.workType.message})]})}):i.jsxs("form",{onSubmit:c(C),id:"organization-form",children:[i.jsx(Pr,{title:"Organization Details",subtitle:"Your employment details within the organization."}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsxs(Ze,{label:"Organization / Client",id:"organizationId",error:d.organizationId?.message,registration:l("organizationId"),disabled:j,children:[i.jsx("option",{value:"",children:"Select Organization"}),s.map(P=>i.jsx("option",{value:P.id,children:P.shortName},P.id))]}),i.jsx(we,{label:"Designation",id:"designation",error:d.designation?.message,registration:l("designation")}),i.jsx(we,{label:"Department",id:"department",error:d.department?.message,registration:l("department")}),i.jsx(we,{label:"Reporting Manager",id:"reportingManager",error:d.reportingManager?.message,registration:l("reportingManager")}),i.jsx(_e,{name:"joiningDate",control:h,render:({field:P})=>i.jsx(En,{label:"Joining Date",id:"joiningDate",error:d.joiningDate?.message,value:P.value,onChange:P.onChange})}),i.jsxs(Ze,{label:"Work Type",id:"workType",error:d.workType?.message,registration:l("workType"),children:[i.jsx("option",{value:"",children:"Select Work Type"}),i.jsx("option",{children:"Full-time"}),i.jsx("option",{children:"Part-time"}),i.jsx("option",{children:"Contract"})]})]})]})},Yue=()=>{const{onValidated:n,setToast:e}=wi(),{data:t,updateFamily:r}=Yn(),{rulesByDesignation:s}=td(),a=Rt("(max-width: 767px)"),o=t.organization.designation,l=E.useMemo(()=>{const G=o&&s[o];return G?G.documents.familyAadhaar:!1},[o,s]),c=Pt({id:xe().required(),relation:xe().oneOf(["Spouse","Child","Father","Mother",""]).required("Relation is required"),name:xe().required("Name is required"),dob:xe().required("Date of birth is required"),gender:xe().oneOf(["Male","Female","Other",""]).required("Gender is required"),occupation:xe().optional(),dependent:ls().required(),phone:xe().when("relation",{is:"Child",then:G=>G.optional().nullable().matches(/^[6-9][0-9]{9}$/,{message:"Must be a valid 10-digit number",excludeEmptyString:!0}),otherwise:G=>G.required("Phone number is required").matches(/^[6-9][0-9]{9}$/,"Must be a valid 10-digit Indian number")}),idProof:Wt().nullable().when([],{is:()=>l,then:G=>G.test("is-required","Aadhaar proof is required for this designation.",Z=>Z!=null).nullable(),otherwise:G=>G.optional().nullable()})}),d=Pt({family:js().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},watch:y,setValue:_}=tn({resolver:In(d),defaultValues:{family:t.family}}),{fields:w,append:j,remove:C}=Ns({control:h,name:"family"}),[P,O]=E.useState(!1),[M,D]=E.useState(null);E.useEffect(()=>{let G;const Z=y(Y=>{clearTimeout(G),G=window.setTimeout(()=>{r(Y.family)},500)});return()=>{Z.unsubscribe(),clearTimeout(G)}},[y,r]);const I=G=>Z=>{let Y=!1;if(Z.name){const ae=Z.name.toLowerCase().replace(/\b(\w)/g,ee=>ee.toUpperCase());_(`family.${G}.name`,ae,{shouldValidate:!0}),Y=!0}if(Z.dob)try{const ae=Z.dob.replace(/[/.]/g,"-"),ee=["dd-MM-yyyy","yyyy-MM-dd","MM-dd-yyyy","d-M-yyyy"];let me=null;for(const $ of ee){const K=B$(ae,$,new Date);if(!isNaN(K.getTime())){me=K;break}}if(me){const $=We(me,"yyyy-MM-dd");_(`family.${G}.dob`,$,{shouldValidate:!0}),Y=!0}}catch{console.error("Could not parse date from OCR:",Z.dob)}if(Z.gender){const ae=Z.gender.toLowerCase().trim();ae.includes("male")||ae.includes("purush")||ae==="m"?(_(`family.${G}.gender`,"Male",{shouldValidate:!0}),Y=!0):(ae.includes("female")||ae.includes("mahila")||ae==="f")&&(_(`family.${G}.gender`,"Female",{shouldValidate:!0}),Y=!0)}Y&&e({message:"Family member details auto-filled.",type:"success"})},F={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING},gender:{type:Xe.STRING}}},q=()=>{j({id:`fam_${Date.now()}`,relation:"",name:"",dob:"",gender:"",occupation:"",dependent:!1,idProof:null,phone:""})},B=G=>{D(G),O(!0)},U=()=>{M!==null&&(C(M),O(!1),D(null))},W=async G=>{r(G.family),await n()};return a?i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List your immediate family members."}),i.jsx("div",{className:"space-y-4",children:w.map((G,Z)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>B(Z),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove family member",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`family.${Z}.relation`,control:h,render:({field:Y})=>i.jsxs("select",{...Y,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"Select Relation"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${Z}.name`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Full Name",...Y,className:"form-input"})}),i.jsx(_e,{name:`family.${Z}.dob`,control:h,render:({field:Y})=>i.jsx("input",{type:"date",placeholder:"Date of Birth",...Y,className:"form-input"})}),i.jsx(_e,{name:`family.${Z}.phone`,control:h,render:({field:Y})=>i.jsx("input",{placeholder:"Phone Number",type:"tel",...Y,className:"form-input"})})]},G.id))}),i.jsxs(ne,{type:"button",onClick:q,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]}):i.jsxs("form",{onSubmit:p(W),id:"family-form",children:[i.jsx(Kr,{isOpen:P,onClose:()=>O(!1),onConfirm:U,title:"Confirm Deletion",children:"Are you sure you want to remove this family member? This action cannot be undone."}),i.jsx(Pr,{title:"Family Details",subtitle:"List your immediate family members."}),i.jsx("div",{className:"space-y-6",children:w.map((G,Z)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>B(Z),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${G.name}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-4",children:[i.jsx(_e,{name:`family.${Z}.relation`,control:h,render:({field:Y})=>i.jsxs(Ze,{label:"Relation",id:Y.name,error:x.family?.[Z]?.relation?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Spouse"}),i.jsx("option",{children:"Child"}),i.jsx("option",{children:"Father"}),i.jsx("option",{children:"Mother"})]})}),i.jsx(_e,{name:`family.${Z}.name`,control:h,render:({field:Y})=>i.jsx(we,{label:"Full Name",id:Y.name,error:x.family?.[Z]?.name?.message,...Y})}),i.jsx(_e,{name:`family.${Z}.dob`,control:h,render:({field:Y})=>i.jsx(En,{label:"Date of Birth",id:Y.name,value:Y.value,onChange:Y.onChange,error:x.family?.[Z]?.dob?.message,maxDate:new Date})}),i.jsx(_e,{name:`family.${Z}.gender`,control:h,render:({field:Y})=>i.jsxs(Ze,{label:"Gender",id:Y.name,error:x.family?.[Z]?.gender?.message,...Y,children:[i.jsx("option",{value:"",children:"Select"}),i.jsx("option",{children:"Male"}),i.jsx("option",{children:"Female"}),i.jsx("option",{children:"Other"})]})}),i.jsx(_e,{name:`family.${Z}.phone`,control:h,render:({field:Y})=>i.jsx(we,{label:"Phone Number",id:Y.name,type:"tel",error:x.family?.[Z]?.phone?.message,...Y,value:Y.value??""})}),i.jsx(_e,{name:`family.${Z}.occupation`,control:h,render:({field:Y})=>i.jsx(we,{label:"Occupation (Optional)",id:Y.name,...Y,value:Y.value??""})}),i.jsx("div",{className:"col-span-full md:col-span-1 flex items-center pt-5",children:i.jsx(_e,{name:`family.${Z}.dependent`,control:h,render:({field:Y})=>i.jsx(Dn,{id:Y.name,label:"Is a dependent?",checked:Y.value,onChange:Y.onChange})})}),i.jsx("div",{className:"col-span-full",children:i.jsx(_e,{name:`family.${Z}.idProof`,control:h,render:({field:Y,fieldState:ae})=>i.jsx(vt,{label:`Aadhaar Proof ${l?"(Mandatory)":"(Optional)"}`,file:Y.value,onFileChange:Y.onChange,onOcrComplete:I(Z),ocrSchema:F,setToast:e,error:ae.error?.message,docType:"Aadhaar"})})})]})]},G.id))}),i.jsxs(ne,{type:"button",onClick:q,variant:"outline",className:"mt-6",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Family Member"]})]})},Gue=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),{data:r,updateEducation:s,updateEducationRecord:a}=Yn(),o=Rt("(max-width: 767px)"),l=E.useMemo(()=>/manager|admin|head/i.test(r.organization.designation),[r.organization.designation]),c=E.useMemo(()=>Pt({id:xe().required(),degree:xe().required("Degree is required"),institution:xe().required("Institution is required"),startYear:xe().required("Start year is required").matches(/^\d{4}$/,"Must be a 4-digit year"),endYear:xe().required("End year is required").matches(/^\d{4}$/,"Must be a 4-digit year").test("is-after-start-year","End year must be on or after start year",function(Z){const{startYear:Y}=this.parent;return!Y||!Z||parseInt(Z)>=parseInt(Y)}),percentage:cs().nullable().min(0).max(100).optional(),grade:xe().optional(),document:Wt().nullable().when([],{is:()=>l,then:Z=>Z.required("Certificate is mandatory for this role.").nullable(),otherwise:Z=>Z.optional().nullable()})}).defined(),[l]),d=Pt({education:js().of(c).required()}),{control:h,handleSubmit:p,formState:{errors:x},setValue:y,reset:_,watch:w}=tn({resolver:In(d),context:{isAdminOrManager:l},mode:"onBlur"}),{fields:j,append:C,remove:P}=Ns({control:h,name:"education"}),[O,M]=E.useState(!1),[D,I]=E.useState(null);E.useEffect(()=>{_({education:r.education})},[r.education,_]),E.useEffect(()=>{let Z;const Y=w(ae=>{clearTimeout(Z),Z=window.setTimeout(()=>{s(ae.education)},500)});return()=>{Y.unsubscribe(),clearTimeout(Z)}},[w,s]);const F=()=>{C({id:`edu_${Date.now()}`,degree:"",institution:"",startYear:"",endYear:""})},q=Z=>{I(Z),M(!0)},B=()=>{D!==null&&(P(D),M(!1),I(null))},U=async Z=>{s(Z.education),await n()},W=Z=>Y=>{const ae=j[Z].id,ee={};if(Y.degree&&(y(`education.${Z}.degree`,Y.degree,{shouldValidate:!0}),ee.degree=Y.degree),Y.institution&&(y(`education.${Z}.institution`,Y.institution,{shouldValidate:!0}),ee.institution=Y.institution),Y.endYear){const me=Y.endYear.toString();y(`education.${Z}.endYear`,me,{shouldValidate:!0}),ee.endYear=me}Object.keys(ee).length>0&&(a(ae,ee),e({message:"Education details auto-filled.",type:"success"}))},G={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING,description:"The name of the degree, diploma, or certificate."},institution:{type:Xe.STRING,description:"The name of the university, college, or institution."},endYear:{type:Xe.STRING,description:"The year of completion or graduation as a 4-digit number."}},required:["degree","institution","endYear"]};return o?i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"List educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-4",children:j.map((Z,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative space-y-4",children:[i.jsx("button",{type:"button",onClick:()=>q(Y),className:"absolute top-2 right-2 p-1 text-red-500 rounded-full z-10","aria-label":"Remove qualification",children:i.jsx(rn,{className:"h-5 w-5"})}),i.jsx(_e,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Degree / Certificate",...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Institution / University",...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx("input",{placeholder:"Year of Completion",type:"text",maxLength:4,...ae,className:"form-input"})}),i.jsx(_e,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:ee})=>i.jsx(vt,{label:`Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,error:ee.error?.message,allowCapture:!0})})]},Z.id))}),i.jsxs(ne,{type:"button",onClick:F,variant:"secondary",className:"mt-6 w-full flex items-center justify-center",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]}):i.jsxs("form",{onSubmit:p(U),id:"education-form",children:[i.jsx(Kr,{isOpen:O,onClose:()=>M(!1),onConfirm:B,title:"Confirm Deletion",children:"Are you sure you want to remove this education record? This action cannot be undone."}),i.jsx(Pr,{title:"Education Details",subtitle:"List your educational qualifications, starting with the most recent."}),i.jsx("div",{className:"space-y-6",children:j.map((Z,Y)=>i.jsxs("div",{className:"p-4 border border-border rounded-xl relative",children:[i.jsx("button",{type:"button",onClick:()=>q(Y),className:"absolute top-2 right-2 p-1 text-red-500 hover:bg-red-100 rounded-full","aria-label":`Remove ${Z.degree}`,children:i.jsx(rn,{className:"h-4 w-4"})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`education.${Y}.degree`,control:h,render:({field:ae})=>i.jsx(we,{label:"Degree / Certificate",id:ae.name,error:x.education?.[Y]?.degree?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.institution`,control:h,render:({field:ae})=>i.jsx(we,{label:"Institution / University",id:ae.name,error:x.education?.[Y]?.institution?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.startYear`,control:h,render:({field:ae})=>i.jsx(we,{label:"Start Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.startYear?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.endYear`,control:h,render:({field:ae})=>i.jsx(we,{label:"End Year",id:ae.name,type:"text",maxLength:4,error:x.education?.[Y]?.endYear?.message,...ae})}),i.jsx(_e,{name:`education.${Y}.percentage`,control:h,render:({field:ae})=>i.jsx(we,{label:"Percentage (Optional)",id:ae.name,type:"number",error:x.education?.[Y]?.percentage?.message,...ae,value:ae.value??""})}),i.jsx(_e,{name:`education.${Y}.grade`,control:h,render:({field:ae})=>i.jsx(we,{label:"Grade (Optional)",id:ae.name,type:"text",error:x.education?.[Y]?.grade?.message,...ae,value:ae.value??""})}),i.jsx("div",{className:"sm:col-span-2",children:i.jsx(_e,{name:`education.${Y}.document`,control:h,render:({field:ae,fieldState:ee})=>i.jsx(vt,{label:`Upload Certificate ${l?"(Mandatory)":"(Optional)"}`,file:ae.value,onFileChange:ae.onChange,onOcrComplete:W(Y),ocrSchema:G,setToast:e,error:ee.error?.message})})})]})]},Z.id))}),i.jsxs(ne,{type:"button",onClick:F,variant:"outline",className:"mt-6",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})},t1=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",Zue=xe().matches(/^[a-zA-Z\s.'-]*$/,"Name can only contain letters and spaces").transform(t1),Kue=Pt({accountHolderName:Zue.required("Account holder name is required"),accountNumber:xe().required("Account number is required").matches(/^[0-9]+$/,"Must be only digits"),confirmAccountNumber:xe().oneOf([F1("accountNumber")],"Account numbers must match").required("Please confirm your account number"),ifscCode:xe().required("IFSC code is required").transform(n=>n.toUpperCase()).matches(/^[A-Z]{4}0[A-Z0-9]{6}$/,"Invalid IFSC code format (e.g., SBIN0123456)"),bankName:xe().required("Bank name is required"),branchName:xe().required("Branch name is required"),bankProof:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),Jue=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),{data:r,updateBank:s,setBankVerifiedStatus:a}=Yn(),o=Rt("(max-width: 767px)"),{register:l,handleSubmit:c,formState:{errors:d},control:h,setValue:p,watch:x,reset:y}=tn({resolver:In(Kue),defaultValues:r.bank});E.useEffect(()=>{y(r.bank)},[r.bank,y]),E.useEffect(()=>{let M;const D=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x(),w=async M=>{s(M),await n()},j=M=>{const D=M.target.value;p("accountHolderName",t1(D),{shouldValidate:!0})},C=M=>{const D={};M.forEach(I=>{D[I]=!1}),a(D)},P=M=>{const D={},I={};if(M.accountHolderName){const F=t1(M.accountHolderName);p("accountHolderName",F,{shouldValidate:!0}),D.accountHolderName=F,I.accountHolderName=!0}if(M.accountNumber){const F=M.accountNumber.replace(/\D/g,"");p("accountNumber",F,{shouldValidate:!0}),p("confirmAccountNumber",F,{shouldValidate:!0}),D.accountNumber=F,D.confirmAccountNumber=F,I.accountNumber=!0}if(M.ifscCode){const F=M.ifscCode.toUpperCase().replace(/\s/g,"");p("ifscCode",F,{shouldValidate:!0}),D.ifscCode=F,I.ifscCode=!0}M.bankName&&(p("bankName",M.bankName,{shouldValidate:!0}),D.bankName=M.bankName),M.branchName&&(p("branchName",M.branchName,{shouldValidate:!0}),D.branchName=M.branchName),Object.keys(D).length>0&&s(D),a(I),e({message:"Bank details extracted. Please review.",type:"success"})},O={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING,description:"The account holder's full name."},accountNumber:{type:Xe.STRING,description:"The full bank account number."},ifscCode:{type:Xe.STRING,description:"The bank's IFSC code."},bankName:{type:Xe.STRING,description:"The name of the bank (e.g., 'State Bank of India')."},branchName:{type:Xe.STRING,description:"The name of the bank branch (e.g., 'Koramangala Branch')."}},required:["accountHolderName","accountNumber","ifscCode","bankName","branchName"]};return o?i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("input",{placeholder:"Account Holder Name",...l("accountHolderName"),onBlur:j,className:"form-input"}),i.jsx("input",{placeholder:"Bank Name",...l("bankName"),className:"form-input"}),i.jsx("input",{placeholder:"Account Number",...l("accountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"Confirm Account Number",...l("confirmAccountNumber"),className:"form-input"}),i.jsx("input",{placeholder:"IFSC Code",...l("ifscCode"),className:"form-input"}),i.jsx("input",{placeholder:"Branch Name",...l("branchName"),className:"form-input"}),i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(vt,{label:"Upload Bank Proof (Optional)",file:M.value,onFileChange:M.onChange,allowCapture:!0})})]})]}):i.jsxs("form",{onSubmit:c(w),id:"bank-form",children:[i.jsx(Pr,{title:"Bank Details",subtitle:"Your salary will be credited to this account."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx(_e,{name:"bankProof",control:h,render:({field:M})=>i.jsx(vt,{label:"Upload Bank Proof (Cancelled Cheque/Passbook)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:O,setToast:e})}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 pt-6 border-t",children:[i.jsx(vr,{label:"Account Holder Name",id:"accountHolderName",hasValue:!!_.accountHolderName,isVerified:r.bank.verifiedStatus?.accountHolderName===!0,onManualInput:()=>C(["accountHolderName"]),error:d.accountHolderName?.message,registration:l("accountHolderName"),onBlur:j}),i.jsx(vr,{label:"Bank Name",id:"bankName",hasValue:!!_.bankName,isVerified:!1,error:d.bankName?.message,registration:l("bankName")}),i.jsx(vr,{label:"Account Number",id:"accountNumber",hasValue:!!_.accountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>C(["accountNumber"]),error:d.accountNumber?.message,registration:l("accountNumber")}),i.jsx(vr,{label:"Confirm Account Number",id:"confirmAccountNumber",hasValue:!!_.confirmAccountNumber,isVerified:r.bank.verifiedStatus?.accountNumber===!0,onManualInput:()=>C(["accountNumber"]),error:d.confirmAccountNumber?.message,registration:l("confirmAccountNumber")}),i.jsx(vr,{label:"IFSC Code",id:"ifscCode",hasValue:!!_.ifscCode,isVerified:r.bank.verifiedStatus?.ifscCode===!0,onManualInput:()=>C(["ifscCode"]),error:d.ifscCode?.message,registration:l("ifscCode")}),i.jsx(vr,{label:"Branch Name",id:"branchName",hasValue:!!_.branchName,isVerified:!1,error:d.branchName?.message,registration:l("branchName")})]})]})]})},Que=Pt({hasPreviousPf:ls().required(),uanNumber:xe().when("hasPreviousPf",{is:!0,then:n=>n.required("UAN Number is required").matches(/^[0-9]{12}$/,"UAN must be 12 digits"),otherwise:n=>n.optional().nullable()}),pfNumber:xe().when("hasPreviousPf",{is:!0,then:n=>n.optional().nullable(),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),salarySlip:Wt().optional().nullable(),verifiedStatus:Pt().optional()}).defined(),Xue=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),{data:r,updateUan:s,setUanVerifiedStatus:a}=Yn(),o=Rt("(max-width: 767px)"),{register:l,control:c,handleSubmit:d,formState:{errors:h},setValue:p,watch:x,reset:y}=tn({resolver:In(Que),defaultValues:r.uan});E.useEffect(()=>{y(r.uan)},[r.uan,y]),E.useEffect(()=>{let M;const D=x(I=>{clearTimeout(M),M=window.setTimeout(()=>{s(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[x,s]);const _=x("hasPreviousPf"),w=x(),j=async M=>{s(M),await n()},C=()=>{a({uanNumber:!1})},P=M=>{if(M.uanNumber){const D=M.uanNumber.replace(/\D/g,"");if(D.length===12){const I={uanNumber:D,hasPreviousPf:!0};p("uanNumber",D,{shouldValidate:!0}),p("hasPreviousPf",!0,{shouldValidate:!0}),s(I),a({uanNumber:!0}),e({message:"UAN extracted successfully.",type:"success"})}}},O={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."}},required:["uanNumber"]};return o?i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...l("hasPreviousPf"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Do you have a previous PF account or UAN?"})]}),_&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"UAN Number",...l("uanNumber"),className:"form-input"}),i.jsx("input",{placeholder:"PF Number (Optional)",...l("pfNumber"),className:"form-input"}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(vt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,allowCapture:!0,costingItemName:"EPF UAN Lookup"})})]})]})]}):i.jsxs("form",{onSubmit:d(j),id:"uan-form",children:[i.jsx(Pr,{title:"UAN / PF Details",subtitle:"Provide your Universal Account Number if you have one."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasPreviousPf",type:"checkbox",...l("hasPreviousPf"),className:"h-4 w-4 text-accent border-gray-300 rounded focus:ring-accent"}),i.jsx("label",{htmlFor:"hasPreviousPf",className:"ml-2 block text-sm text-muted",children:"Do you have a previous PF account or UAN?"})]}),r.uan.salarySlip&&i.jsxs("div",{className:"pt-4 border-t",children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-2",children:"Reference Salary Slip"}),i.jsx(vt,{label:"",file:r.uan.salarySlip,onFileChange:()=>{}})]}),_&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(vr,{label:"UAN Number",id:"uanNumber",hasValue:!!w.uanNumber,isVerified:r.uan.verifiedStatus?.uanNumber===!0,onManualInput:C,registration:l("uanNumber"),error:h.uanNumber?.message}),i.jsx(we,{label:"PF Number (Optional)",id:"pfNumber",registration:l("pfNumber"),error:h.pfNumber?.message})]}),i.jsx(_e,{name:"document",control:c,render:({field:M})=>i.jsx(vt,{label:"Upload Proof (Payslip, etc.)",file:M.value,onFileChange:M.onChange,onOcrComplete:P,ocrSchema:O,setToast:e,costingItemName:"EPF UAN Lookup"})})]})]})]})},efe=Pt({hasEsi:ls().required(),esiNumber:xe().when("hasEsi",{is:!0,then:n=>n.required("ESI Number is required").matches(/^(\d{10}|\d{17})$/,"ESI number must be 10 or 17 digits"),otherwise:n=>n.optional().nullable()}),esiRegistrationDate:xe().when("hasEsi",{is:!0,then:n=>n.required("Registration date is required").test("not-in-future","Registration date cannot be in the future",e=>e?new Date(e.replace(/-/g,"/"))<=new Date:!0),otherwise:n=>n.optional().nullable()}),esicBranch:xe().when("hasEsi",{is:!0,then:n=>n.required("ESIC Branch is required"),otherwise:n=>n.optional().nullable()}),document:Wt().optional().nullable(),verifiedStatus:Pt().optional()}),tfe=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),{data:r,updateEsi:s,setEsiVerifiedStatus:a}=Yn(),{esiCtcThreshold:o,enableEsiRule:l}=td(),c=Rt("(max-width: 767px)"),{register:d,control:h,handleSubmit:p,formState:{errors:x},reset:y,setValue:_,watch:w}=tn({resolver:In(efe),defaultValues:r.esi}),j=w("hasEsi"),C=w(),P=r.personal.salary!=null&&r.personal.salary<=o;E.useEffect(()=>{y(r.esi)},[r.esi,y]),E.useEffect(()=>{let F;const q=w(B=>{clearTimeout(F),F=window.setTimeout(()=>{s(B)},500)});return()=>{q.unsubscribe(),clearTimeout(F)}},[w,s]),E.useEffect(()=>{P||r.esi.hasEsi&&s({hasEsi:!1,esiNumber:"",esiRegistrationDate:"",esicBranch:""})},[P,r.esi.hasEsi,s]);const O=async F=>{s(F),await n()},M=()=>{a({esiNumber:!1})},D=F=>{if(F.esiNumber){const q=F.esiNumber.replace(/\D/g,"");if(q.length===10||q.length===17){const B={esiNumber:q,hasEsi:!0};_("esiNumber",q,{shouldValidate:!0}),_("hasEsi",!0,{shouldValidate:!0}),s(B),a({esiNumber:!0}),e({message:"ESI Number extracted successfully.",type:"success"})}}},I={type:Xe.OBJECT,properties:{esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}},required:["esiNumber"]};if(c){if(!l||!P){const F=l?`Employee is not eligible for ESI as their gross salary is above the ${o.toLocaleString()} threshold.`:"ESI enrollment is currently disabled by company policy. This step is not applicable.";return i.jsx("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"esi-form",children:i.jsxs("div",{className:"flex items-start gap-3 p-4 bg-blue-900/40 rounded-lg border border-blue-500/50",children:[i.jsx(cu,{className:"h-5 w-5 text-blue-400 mt-0.5 flex-shrink-0"}),i.jsx("p",{className:"text-sm text-blue-300",children:F})]})})}return i.jsxs("form",{onSubmit:p(O),id:"esi-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",...d("hasEsi"),className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"space-y-4 animate-fade-in-down",children:[i.jsx("input",{placeholder:"ESI Number",...d("esiNumber"),className:"form-input"}),i.jsx("input",{type:"date",...d("esiRegistrationDate"),className:"form-input"}),i.jsx("input",{placeholder:"ESIC Branch",...d("esicBranch"),className:"form-input"}),i.jsx(_e,{name:"document",control:h,render:({field:F})=>i.jsx(vt,{label:"Upload ESI Card",file:F.value,onFileChange:F.onChange,allowCapture:!0,costingItemName:"ESI Card OCR"})})]})]})]})}return l?P?i.jsxs("form",{onSubmit:p(O),id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Provide your Employee's State Insurance number if applicable."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"flex items-center",children:[i.jsx("input",{id:"hasEsi",type:"checkbox",...d("hasEsi"),className:"h-4 w-4 text-accent"}),i.jsx("label",{htmlFor:"hasEsi",className:"ml-2 block text-sm text-muted",children:"Are you covered under ESI?"})]}),j&&i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6 animate-fade-in-down",children:[i.jsxs("div",{className:"space-y-6",children:[i.jsx(vr,{label:"ESI Number",id:"esiNumber",hasValue:!!C.esiNumber,isVerified:r.esi.verifiedStatus?.esiNumber===!0,onManualInput:M,registration:d("esiNumber"),error:x.esiNumber?.message}),i.jsx(_e,{name:"esiRegistrationDate",control:h,render:({field:F})=>i.jsx(En,{label:"ESI Registration Date",id:"esiRegistrationDate",error:x.esiRegistrationDate?.message,value:F.value,onChange:F.onChange,maxDate:new Date})}),i.jsx(we,{label:"ESIC Branch",id:"esicBranch",registration:d("esicBranch"),error:x.esicBranch?.message})]}),i.jsx(_e,{name:"document",control:h,render:({field:F})=>i.jsx(vt,{label:"Upload ESI Card",file:F.value,onFileChange:F.onChange,onOcrComplete:D,ocrSchema:I,setToast:e,costingItemName:"ESI Card OCR"})})]})]})]}):i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(cu,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsxs("p",{className:"text-sm text-blue-700",children:["Employee is not eligible for ESI as their gross salary is above the $",o.toLocaleString()," threshold."]})]})]}):i.jsxs("form",{onSubmit:async F=>{F.preventDefault(),await n()},id:"esi-form",children:[i.jsx(Pr,{title:"ESI Details",subtitle:"Employee's State Insurance eligibility."}),i.jsxs("div",{className:"mt-4 flex items-center bg-blue-50 p-4 rounded-lg",children:[i.jsx(cu,{className:"h-5 w-5 text-blue-500 mr-3"}),i.jsx("p",{className:"text-sm text-blue-700",children:"ESI enrollment is currently disabled by company policy. This step is not applicable."})]})]})},nfe=Pt({isOptedIn:ls().nullable().required("Please choose whether you want to avail Group Medical Cover."),selectedSpouseId:xe().optional(),selectedChildIds:js().of(xe().required()).optional(),gmcPolicyCopy:Wt().when("isOptedIn",{is:!1,then:n=>n.required("Please upload GMC policy copy (PNG, JPG, PDF up to 5MB)."),otherwise:n=>n.optional().nullable()}),declarationAccepted:ls().when("isOptedIn",{is:!1,then:n=>n.oneOf([!0],"Please accept the declaration to proceed."),otherwise:n=>n.optional()}),policyAmount:xe().optional().nullable(),nomineeName:xe().optional().nullable(),nomineeRelation:xe().optional().nullable(),wantsToAddDependents:ls().optional().nullable(),optOutReason:xe().optional().nullable(),alternateInsuranceProvider:xe().optional().nullable(),alternateInsuranceStartDate:xe().optional().nullable(),alternateInsuranceEndDate:xe().optional().nullable(),alternateInsuranceCoverage:xe().optional().nullable()}).defined(),rfe=()=>{const{onValidated:n}=wi(),{user:e}=jt(),{data:t,updateGmc:r}=Yn(),s=Rt("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},watch:c,reset:d,setValue:h,getValues:p}=tn({resolver:In(nfe),defaultValues:t.gmc}),x=c("isOptedIn"),y=c("selectedSpouseId"),_=c("selectedChildIds")||[],w=E.useMemo(()=>t.family.find(M=>M.relation==="Spouse"),[t.family]),j=E.useMemo(()=>t.family.filter(M=>M.relation==="Child"),[t.family]),C=E.useMemo(()=>{const M=[];return w&&M.push(w),M.push(...j),M},[w,j]);E.useEffect(()=>{if(t.gmc.isOptedIn===!0){const M=!t.gmc.selectedSpouseId&&(!t.gmc.selectedChildIds||t.gmc.selectedChildIds.length===0),D=w||j.length>0;M&&D&&(h("selectedSpouseId",w?.id||"",{shouldDirty:!0}),h("selectedChildIds",j.map(I=>I.id),{shouldDirty:!0}))}},[t.gmc.isOptedIn,w,j,h,t.gmc.selectedSpouseId,t.gmc.selectedChildIds]),E.useEffect(()=>{d(t.gmc)},[t.gmc,d]),E.useEffect(()=>{let M;const D=c(I=>{clearTimeout(M),M=window.setTimeout(()=>{r(I)},500)});return()=>{D.unsubscribe(),clearTimeout(M)}},[c,r]);const P=async M=>{const D={...M};M.isOptedIn?(D.gmcPolicyCopy=null,D.declarationAccepted=!1):(D.selectedSpouseId="",D.selectedChildIds=[]),r(D),await n()},O=(M,D)=>{if(M.relation==="Spouse")h("selectedSpouseId",D?M.id:"",{shouldDirty:!0});else{const I=p("selectedChildIds")||[],F=D?[...I,M.id]:I.filter(q=>q!==M.id);h("selectedChildIds",F,{shouldDirty:!0})}};return s?i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx("p",{className:"text-md font-semibold",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-[#32cd32] bg-[#243524]":"border-[#374151]"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent bg-transparent border-muted"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),x===!0&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-sm font-medium text-gray-400",children:"Select Dependents"}),C.map(M=>{const D=M.relation==="Spouse"?y===M.id:_.includes(M.id);return i.jsx(Dn,{id:`dep-mob-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:I=>O(M,I)},M.id)})]}),x===!1&&i.jsxs("div",{className:"pt-4 space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(vt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,error:D.error?.message,allowCapture:!0})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("label",{className:"flex items-center gap-3 p-4 bg-[#243524] rounded-lg border border-[#374151]",children:[i.jsx("input",{type:"checkbox",checked:M.value??!1,onChange:M.onChange,className:"h-5 w-5 rounded text-accent focus:ring-accent bg-transparent border-[#9ca89c]"}),i.jsx("span",{children:"I declare I will not avail company GMC and the uploaded policy is valid."})]})})]})]})]}):i.jsxs("form",{onSubmit:o(P),id:"gmc-form",children:[i.jsx(Pr,{title:"Group Medical Cover (GMC)",subtitle:"Please choose whether to enroll in the company's insurance plan."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Would you like to Avail Group Medical Cover?"}),i.jsx(_e,{name:"isOptedIn",control:a,render:({field:M})=>i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!0?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!0),checked:M.value===!0,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"Yes"})]}),i.jsxs("label",{className:`flex items-center p-4 rounded-lg border-2 cursor-pointer flex-1 ${M.value===!1?"border-accent bg-accent-light":"border-border"}`,children:[i.jsx("input",{type:"radio",name:M.name,onBlur:M.onBlur,ref:M.ref,onChange:()=>M.onChange(!1),checked:M.value===!1,className:"h-4 w-4 text-accent focus:ring-accent"}),i.jsx("span",{className:"ml-3 text-sm font-medium",children:"No"})]})]})}),l.isOptedIn&&i.jsx("p",{className:"mt-1 text-xs text-red-600",children:l.isOptedIn.message})]}),x===!0&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx("label",{className:"text-md font-semibold text-primary-text mb-2 block",children:"Select Dependents for Policy"}),i.jsx("p",{className:"text-sm text-muted -mt-2 mb-2",children:"Spouse and children are included by default. Uncheck any dependents you do not want to include."}),i.jsx("div",{className:"space-y-2 p-4 border rounded-lg bg-page",children:C.length>0?C.map(M=>{const D=M.relation==="Spouse"?y===M.id:_.includes(M.id);return i.jsx(Dn,{id:`dep-${M.id}`,label:`${M.name} (${M.relation})`,checked:D,onChange:I=>O(M,I)},M.id)}):i.jsx("p",{className:"text-sm text-muted",children:'No spouse or children added. Please add them in the "Family Details" section to include them in the policy.'})})]}),x===!1&&i.jsxs("div",{className:"pt-4 border-t space-y-4 animate-fade-in-down",children:[i.jsx(_e,{name:"gmcPolicyCopy",control:a,render:({field:M,fieldState:D})=>i.jsx(vt,{label:"Upload GMC Policy Copy",file:M.value,onFileChange:M.onChange,allowedTypes:["image/png","image/jpeg","application/pdf"],error:D.error?.message})}),i.jsx(_e,{name:"declarationAccepted",control:a,render:({field:M,fieldState:D})=>i.jsxs("div",{className:"space-y-1",children:[i.jsx(Dn,{id:"declarationAccepted",label:"I declare that I will not avail company GMC and the uploaded policy is valid.",checked:M.value??!1,onChange:M.onChange}),D.error&&i.jsx("p",{className:"text-xs text-red-600",children:D.error.message})]})})]})]})]})},sfe=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),r=St(),{data:s,updateUniforms:a}=Yn(),o=Rt("(max-width: 767px)"),[l,c]=E.useState(!0),[d,h]=E.useState(null),{gender:p}=s.personal,{organizationId:x,department:y,designation:_}=s.organization,{control:w,handleSubmit:j,reset:C,watch:P}=tn(),{fields:O,replace:M}=Ns({control:w,name:"uniforms"});E.useEffect(()=>{(async()=>{c(!0);try{const[B,U,W]=await Promise.all([ue.getAllSiteUniformDetails(),ue.getMasterGentsUniforms(),ue.getMasterLadiesUniforms()]);h({details:B,gents:U,ladies:W})}catch{e({message:"Failed to load uniform configuration.",type:"error"})}finally{c(!1)}})()},[e]);const D=E.useMemo(()=>{if(!d||!x||!y||!_)return[];const q=d.details[x];if(!q)return[];const B=q.departments.find(W=>W.department===y);return B?B.designations.find(W=>W.designation===_)?.items||[]:[]},[d,x,y,_]);E.useEffect(()=>{const q=D.map(B=>{const U=s.uniforms.find(G=>G.itemId===B.id),W=B.name.toLowerCase().includes("pant")?"Pants":"Shirts";return{itemId:B.id,itemName:B.name,category:W,sizeId:U?.sizeId||"",quantity:U?.quantity||1}});M(q)},[D,s.uniforms,M]),E.useEffect(()=>{let q;const B=P(U=>{clearTimeout(q),q=window.setTimeout(()=>{const W=U,G=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],Z=(W.uniforms||[]).filter(Y=>Y.sizeId&&Y.quantity>0).map(Y=>{const ae=G.find(ee=>ee.id===Y.sizeId);return{itemId:Y.itemId,itemName:Y.itemName,sizeId:Y.sizeId,sizeLabel:ae?.size||"",fit:ae?.fit||"",quantity:Y.quantity}});a(Z)},500)});return()=>{B.unsubscribe(),clearTimeout(q)}},[P,a,p,d]);const I=async q=>{const B=p==="Female"?[...d?.ladies.pants||[],...d?.ladies.shirts||[]]:[...d?.gents.pants||[],...d?.gents.shirts||[]],U=q.uniforms.filter(W=>W.sizeId&&W.quantity>0).map(W=>{const G=B.find(Z=>Z.id===W.sizeId);return{itemId:W.itemId,itemName:W.itemName,sizeId:W.sizeId,sizeLabel:G?.size||"",fit:G?.fit||"",quantity:W.quantity}});a(U),await n()};if(l)return i.jsx("div",{className:"flex justify-center items-center h-64",children:i.jsx(_t,{className:"h-8 w-8 animate-spin text-accent"})});if(D.length===0&&s.uniforms.length>0)return i.jsxs("form",{onSubmit:async q=>{q.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"The following items have been selected for this employee."}),i.jsxs("div",{className:"space-y-4",children:[s.uniforms.map(q=>i.jsx("div",{className:`p-4 border rounded-lg flex justify-between items-center ${o?"bg-[#243524] border-border":"bg-page"}`,children:i.jsxs("div",{children:[i.jsx("p",{className:`font-semibold ${o?"text-white":"text-primary-text"}`,children:q.itemName}),i.jsxs("p",{className:`text-sm ${o?"text-gray-400":"text-muted"}`,children:["Size: ",q.sizeLabel,", Fit: ",q.fit,", Quantity: ",q.quantity]})]})},q.itemId+q.sizeId)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(dr,{className:"mr-2 h-4 w-4"}),"Edit Uniform Selection"]})]})]});if(!p||D.length===0){const q=p?"No uniform requirements found for the selected site, department, and designation.":"Please select a gender in 'Personal Details' to view uniform options.",B=p&&D.length===0;return i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"uniform-form",children:[!o&&i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsxs("div",{className:`text-center p-8 rounded-lg ${o?"":"bg-page"}`,children:[i.jsx(Rf,{className:`h-12 w-12 mx-auto ${o?"text-gray-500":"text-muted"}`}),i.jsx("p",{className:`mt-4 ${o?"text-gray-400":"text-muted"}`,children:q}),B&&i.jsxs("div",{className:"mt-6",children:[i.jsx("p",{className:`text-sm mb-4 ${o?"text-gray-500":"text-muted"}`,children:"You can proceed to the next step, or create a new site-level request if uniforms are needed."}),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/uniforms?from=onboarding"),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"}),"Create Site Uniform Request"]})]})]})]})}const F=p==="Female"?d?.ladies:d?.gents;return o?i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-4",children:O.map((q,B)=>{const U=q.category==="Pants"?F?.pants:F?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl space-y-4",children:[i.jsx("h4",{className:"font-semibold text-primary-text",children:q.itemName}),i.jsx(_e,{name:`uniforms.${B}.sizeId`,control:w,render:({field:W})=>i.jsxs("select",{...W,className:"pro-select pro-select-arrow",children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map(G=>i.jsxs("option",{value:G.id,children:["Size: ",G.size," - ",G.fit]},G.id))]})}),i.jsx(_e,{name:`uniforms.${B}.quantity`,control:w,render:({field:W})=>i.jsx("input",{type:"number",min:"1",...W,className:"form-input"})})]},q.id)})})]}):i.jsxs("form",{onSubmit:j(I),id:"uniform-form",children:[i.jsx(Pr,{title:"Uniform Details",subtitle:"Provide uniform measurements for the employee."}),i.jsx("div",{className:"space-y-6",children:O.map((q,B)=>{const U=q.category==="Pants"?F?.pants:F?.shirts;return i.jsxs("div",{className:"p-4 border border-border rounded-xl bg-page/50",children:[i.jsx("h4",{className:"font-semibold text-primary-text mb-2",children:q.itemName}),i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[i.jsx(_e,{name:`uniforms.${B}.sizeId`,control:w,rules:{required:"Please select a size"},render:({field:W,fieldState:G})=>i.jsxs(Ze,{label:"Size & Fit",error:G.error?.message,...W,children:[i.jsx("option",{value:"",children:"-- Select Size --"}),U?.map(Z=>i.jsxs("option",{value:Z.id,children:["Size: ",Z.size," - ",Z.fit]},Z.id))]})}),i.jsx(_e,{name:`uniforms.${B}.quantity`,control:w,rules:{required:!0,min:1},render:({field:W})=>i.jsx(we,{label:"Quantity",type:"number",min:"1",...W})})]})]},q.id)})})]})},Bh=n=>n?n.toLowerCase().replace(/\b(\w)/g,e=>e.toUpperCase()):"",ife=()=>{const{onValidated:n,setToast:e}=wi(),{user:t}=jt(),r=St(),{data:s,updatePersonal:a,updateBank:o,addEducationRecord:l,updateFamilyMember:c,updateEducationRecord:d,updateUan:h,updateEsi:p,updateGmc:x}=Yn(),y=Rt("(max-width: 767px)"),_=U=>{const W={};if(U.name){const G=U.name.split(" ");W.firstName=Bh(G.shift()||""),W.lastName=Bh(G.pop()||""),W.middleName=Bh(G.join(" "))}if(U.dob)try{const G=new Date(U.dob);isNaN(G.getTime())||(W.dob=We(G,"yyyy-MM-dd"))}catch{}U.aadhaarNumber&&(W.idProofNumber=U.aadhaarNumber.replace(/\s/g,""),W.idProofType="Aadhaar"),a(W)},w=U=>{const W={};if(U.accountHolderName&&(W.accountHolderName=Bh(U.accountHolderName)),U.accountNumber){const G=U.accountNumber.replace(/\D/g,"");W.accountNumber=G,W.confirmAccountNumber=G}U.ifscCode&&(W.ifscCode=U.ifscCode.toUpperCase().replace(/\s/g,"")),o(W)},j=U=>{const W={};U.uanNumber&&(W.uanNumber=U.uanNumber.replace(/\D/g,""),W.hasPreviousPf=!0),h(W)},C=U=>{const W={};U.esiNumber&&(W.esiNumber=U.esiNumber.replace(/\D/g,""),W.hasEsi=!0),p(W)},P=U=>W=>{const G={};if(W.name&&(G.name=Bh(W.name)),W.dob)try{const Z=new Date(W.dob);isNaN(Z.getTime())||(G.dob=We(Z,"yyyy-MM-dd"))}catch{}c(U,G)},O=U=>W=>{const G={};W.degree&&(G.degree=W.degree),W.institution&&(G.institution=W.institution),W.endYear&&(G.endYear=W.endYear.toString()),d(U,G)},M={type:Xe.OBJECT,properties:{name:{type:Xe.STRING},dob:{type:Xe.STRING},aadhaarNumber:{type:Xe.STRING}}},D={type:Xe.OBJECT,properties:{accountHolderName:{type:Xe.STRING},accountNumber:{type:Xe.STRING},ifscCode:{type:Xe.STRING}}},I={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING,description:"The 12-digit Universal Account Number (UAN)."},pfNumber:{type:Xe.STRING,description:"The Provident Fund (PF) account number."},esiNumber:{type:Xe.STRING,description:"The 10 or 17-digit ESI number."}}},F={type:Xe.OBJECT,properties:{uanNumber:{type:Xe.STRING}}},q={type:Xe.OBJECT,properties:{esiNumber:{type:Xe.STRING}}},B={type:Xe.OBJECT,properties:{degree:{type:Xe.STRING},institution:{type:Xe.STRING},endYear:{type:Xe.STRING}}};return y?i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-4",children:[i.jsx(vt,{label:"ID Proof (Front Side)",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"ID Proof (Back Side)",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:_,ocrSchema:M,setToast:e,allowCapture:!0,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Profile Photo",file:s.personal.photo,onFileChange:U=>a({photo:U}),allowCapture:!0,allowedTypes:["image/jpeg","image/png","image/webp"]}),i.jsx(vt,{label:"Bank Proof",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:w,ocrSchema:D,setToast:e,allowCapture:!0,docType:"Bank"}),i.jsx(vt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),C(U)},ocrSchema:I,setToast:e,allowCapture:!0,docType:"Salary"}),s.uan.hasPreviousPf&&i.jsx(vt,{label:"UAN Document",file:s.uan.document,onFileChange:U=>h({document:U}),onOcrComplete:j,ocrSchema:F,setToast:e,allowCapture:!0,docType:"UAN"}),s.esi.hasEsi&&i.jsx(vt,{label:"ESI Document",file:s.esi.document,onFileChange:U=>p({document:U}),onOcrComplete:C,ocrSchema:q,setToast:e,allowCapture:!0}),s.gmc.isOptedIn===!1&&i.jsx(vt,{label:"GMC Policy Copy",file:s.gmc.gmcPolicyCopy,onFileChange:U=>x({gmcPolicyCopy:U}),allowCapture:!0}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(vt,{label:`Certificate for ${U.degree||"Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:O(U.id),ocrSchema:B,setToast:e,allowCapture:!0},U.id)),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/add/education"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add / Edit Qualifications"})]})]})]}),i.jsxs("div",{className:"mt-6 pt-6 border-t border-[#374151]",children:[i.jsx("h4",{className:"form-header-title mb-4",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(vt,{label:`ID Proof for ${U.name||"Family Member"}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,allowCapture:!0,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-gray-400",children:"No family members added."}),i.jsxs(ne,{type:"button",onClick:()=>r("/onboarding/add/family"),variant:"secondary",className:"w-full flex items-center justify-center",children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"}),i.jsx("span",{children:"Add/Edit on Family Page"})]})]})]})]})]}):i.jsxs("form",{onSubmit:async U=>{U.preventDefault(),await n()},id:"documents-form",children:[i.jsx(Pr,{title:"Document Collection",subtitle:"Upload supporting documents. You can also do this within each relevant section."}),i.jsxs("div",{className:"space-y-6",children:[i.jsx("section",{children:i.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-6",children:[i.jsx(vt,{label:"Employee ID Proof (Aadhaar/PAN) - Front Side",file:s.personal.idProofFront,onFileChange:U=>a({idProofFront:U}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Employee ID Proof (Aadhaar/PAN) - Back Side",file:s.personal.idProofBack,onFileChange:U=>a({idProofBack:U}),onOcrComplete:_,ocrSchema:M,setToast:e,docType:s.personal.idProofType||"Aadhaar"}),i.jsx(vt,{label:"Bank Proof (Passbook/Cancelled Cheque)",file:s.bank.bankProof,onFileChange:U=>o({bankProof:U}),onOcrComplete:w,ocrSchema:D,setToast:e,docType:"Bank"}),i.jsx(vt,{label:"Latest Salary Slip (Optional, for UAN/ESI)",file:s.uan.salarySlip,onFileChange:U=>h({salarySlip:U}),onOcrComplete:U=>{j(U),C(U)},ocrSchema:I,setToast:e,docType:"Salary"})]})}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Education Certificates"}),i.jsxs("div",{className:"space-y-4",children:[s.education.map(U=>i.jsx(vt,{label:`Certificate for ${U.degree||"New Qualification"}`,file:U.document,onFileChange:W=>d(U.id,{document:W}),onOcrComplete:O(U.id),ocrSchema:B,setToast:e},U.id)),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>l(),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Add Qualification"]})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Family Member Documents"}),i.jsxs("div",{className:"space-y-4",children:[s.family.map(U=>i.jsx(vt,{label:`ID Proof for ${U.name||`(${U.relation})`}`,file:U.idProof,onFileChange:W=>c(U.id,{idProof:W}),onOcrComplete:P(U.id),ocrSchema:M,setToast:e,docType:"Aadhaar"},U.id)),s.family.length===0&&i.jsx("p",{className:"text-sm text-muted",children:"No family members added yet."}),i.jsxs(ne,{type:"button",variant:"outline",onClick:()=>r("/onboarding/add/family"),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"})," Go to Family Page to Add/Edit"]})]})]})]})]})},afe=Pt({signatureImage:Wt().required("A signature image is mandatory.").nullable(),fingerprints:Pt().shape({leftThumb:Wt().optional().nullable(),leftIndex:Wt().optional().nullable(),leftMiddle:Wt().optional().nullable(),leftRing:Wt().optional().nullable(),leftLittle:Wt().optional().nullable(),rightThumb:Wt().optional().nullable(),rightIndex:Wt().optional().nullable(),rightMiddle:Wt().optional().nullable(),rightRing:Wt().optional().nullable(),rightLittle:Wt().optional().nullable()})}).defined(),ofe=[{hand:"Left",key:"leftThumb",name:"Thumb"},{hand:"Left",key:"leftIndex",name:"Index"},{hand:"Left",key:"leftMiddle",name:"Middle"},{hand:"Left",key:"leftRing",name:"Ring"},{hand:"Left",key:"leftLittle",name:"Little"},{hand:"Right",key:"rightThumb",name:"Thumb"},{hand:"Right",key:"rightIndex",name:"Index"},{hand:"Right",key:"rightMiddle",name:"Middle"},{hand:"Right",key:"rightRing",name:"Ring"},{hand:"Right",key:"rightLittle",name:"Little"}],lfe=()=>{const{onValidated:n}=wi(),{data:e,updateBiometrics:t}=Yn(),{user:r}=jt(),s=Rt("(max-width: 767px)"),{control:a,handleSubmit:o,formState:{errors:l},reset:c,watch:d}=tn({resolver:In(afe),defaultValues:e.biometrics});E.useEffect(()=>{c(e.biometrics)},[e.biometrics,c]),E.useEffect(()=>{const y=d(_=>{t(_)});return()=>y.unsubscribe()},[d,t]);const h=async(y,_)=>{try{const w=await ue.verifyFingerprintImage(y,_);return w.containsFingerprints?{success:!0,reason:""}:{success:!1,reason:w.reason||"Image does not appear to contain fingerprints. Please upload a clear scan."}}catch(w){return{success:!1,reason:w.message||"AI verification failed."}}},p=async y=>{t(y),await n()},x=y=>ofe.filter(_=>_.hand===y).map(_=>i.jsx(_e,{name:`fingerprints.${_.key}`,control:a,render:({field:w})=>i.jsx(vt,{label:`${y} ${_.name}`,file:w.value,onFileChange:w.onChange,onVerification:h,allowCapture:!0})},_.key));return i.jsxs("form",{onSubmit:o(p),id:"biometrics-form",children:[!s&&i.jsx(Pr,{title:"Biometrics",subtitle:"Please provide fingerprint scans and a mandatory signature."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("div",{children:[i.jsxs("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:["Signature ",i.jsx("span",{className:"text-red-500",children:"*"})]}),i.jsx("div",{className:"w-full",children:i.jsx(_e,{name:"signatureImage",control:a,render:({field:y,fieldState:_})=>i.jsx(vt,{label:"Upload or capture a signature",file:y.value,onFileChange:y.onChange,allowCapture:!0,error:_.error?.message})})})]}),i.jsx("div",{className:s?"":"my-8 border-t border-border"}),i.jsxs("div",{children:[i.jsx("h4",{className:`text-lg font-semibold text-center mb-4 ${s?"form-header-title":"text-primary-text"}`,children:"Fingerprints (Optional)"}),i.jsx("p",{className:`text-center mb-6 ${s?"text-gray-400":"text-muted"}`,children:"Upload scans for all 10 fingerprints, one image per finger."}),i.jsxs("div",{className:"w-full grid grid-cols-2 md:grid-cols-5 gap-4",children:[x("Left"),x("Right")]})]})]})]})},Mc=({label:n,value:e})=>i.jsxs("div",{children:[i.jsx("dt",{className:"text-sm font-medium text-muted",children:n}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),Ec=({label:n,value:e,status:t,isVerifying:r})=>i.jsxs("div",{children:[i.jsxs("dt",{className:"text-sm font-medium text-muted flex items-center",children:[n,r&&i.jsx(_t,{className:"h-4 w-4 text-muted animate-spin ml-2"}),!r&&t===!0&&i.jsx("span",{title:"Verified from document",className:"ml-2",children:i.jsx(Ki,{className:"h-4 w-4 text-green-500"})}),!r&&t===!1&&i.jsx("span",{title:"Verification Failed",className:"ml-2",children:i.jsx(gm,{className:"h-4 w-4 text-red-500"})})]}),i.jsx("dd",{className:"mt-1 text-sm text-primary-text",children:e||"-"})]}),$i=({label:n,value:e})=>i.jsxs("div",{className:"flex justify-between items-start py-2",children:[i.jsx("span",{className:"text-sm text-gray-400",children:n}),i.jsx("span",{className:"text-sm text-white font-medium text-right max-w-[60%]",children:e||"-"})]}),cfe=()=>{const{onSubmit:n,isSubmitting:e}=wi(),{user:t}=jt(),{data:r,logVerificationUsage:s,setPersonalVerifiedStatus:a,setBankVerifiedStatus:o,setUanVerifiedStatus:l}=Yn(),{perfiosApi:c}=yi(),d=St(),[h,p]=E.useState(window.innerWidth<768);E.useEffect(()=>{const D=()=>p(window.innerWidth<768);return window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)},[]);const x=t?.role==="field_officer"&&h,[y,_]=E.useState("idle"),[w,j]=E.useState(""),C=E.useMemo(()=>Object.entries(r.biometrics.fingerprints).filter(([,D])=>D!==null).map(([D])=>D.replace(/([A-Z])/g," $1").replace(/^./,I=>I.toUpperCase())),[r.biometrics.fingerprints]),P=async()=>{_("verifying"),j("");let D=!0;const I=[];try{s("Bank AC Verification Advanced");const F=await ue.verifyBankAccountWithPerfios({name:r.bank.accountHolderName,dob:r.personal.dob,aadhaar:r.personal.idProofNumber||null,pan:null,bank:{accountNumber:r.bank.accountNumber,ifsc:r.bank.ifscCode},uan:r.uan.uanNumber||null,esi:r.esi.esiNumber||null});if(I.push(`Bank: ${F.message}`),o({accountNumber:F.verifiedFields.accountNumber,accountHolderName:F.verifiedFields.accountHolderName}),F.success||(D=!1),r.personal.idProofType==="Aadhaar"&&r.personal.idProofNumber){s("Aadhaar Verification");const q=await ue.verifyAadhaar(r.personal.idProofNumber);I.push(`Aadhaar: ${q.message}`),a({idProofNumber:q.success}),q.success||(D=!1)}if(r.uan.hasPreviousPf&&r.uan.uanNumber){s("EPF UAN Lookup");const q=await ue.lookupUan(r.uan.uanNumber);I.push(`UAN: ${q.message}`),l({uanNumber:q.verifiedFields.uan}),q.success||(D=!1)}await ue.updateOnboarding(Yn.getState().data),j(I.join(`
`)),_(D?"success":"failed")}catch(F){_("failed"),j(F.message||"An unexpected error occurred during verification.")}},O=()=>{d(`/onboarding/pdf/${r.id||"draft"}`)},M=(y==="success"||!c.enabled)&&r.formsGenerated;return x?i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx("p",{className:"text-sm text-gray-400 mb-6",children:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-6",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Personal Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx($i,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`}),i.jsx($i,{label:"Email",value:r.personal.email}),i.jsx($i,{label:"Mobile",value:r.personal.mobile}),i.jsx($i,{label:"Date of Birth",value:r.personal.dob})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Organization Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx($i,{label:"Site",value:r.organization.organizationName}),i.jsx($i,{label:"Designation",value:r.organization.designation}),i.jsx($i,{label:"Department",value:r.organization.department})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Bank Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx($i,{label:"Account Holder",value:r.bank.accountHolderName}),i.jsx($i,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4)}),i.jsx($i,{label:"IFSC Code",value:r.bank.ifscCode})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Uniform Details"}),i.jsxs("div",{className:"divide-y divide-border",children:[i.jsx($i,{label:"Uniform Required",value:r.uniforms.length>0?"Yes":"No"}),r.uniforms.map(D=>i.jsx($i,{label:D.itemName,value:`${D.quantity} x Size ${D.sizeLabel} (${D.fit})`},D.itemId))]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"fo-section-title mb-2",children:"Biometrics"}),r.biometrics.signatureImage&&i.jsxs("div",{className:"mb-4",children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Signature"}),i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24 bg-white border rounded-md mx-auto"})]}),C.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"fo-section-title mb-2 text-base",children:"Fingerprints"}),i.jsx("ul",{className:"text-sm text-center text-gray-400 list-disc list-inside",children:C.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}):i.jsxs("form",{onSubmit:async D=>{D.preventDefault(),await n()},id:"review-form",children:[i.jsx(Pr,{title:"Review & Submit",subtitle:"Please review all your details carefully before submitting."}),i.jsxs("div",{className:"space-y-8",children:[i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Personal Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Ec,{label:"Full Name",value:`${r.personal.firstName} ${r.personal.lastName}`,status:r.personal.verifiedStatus?.name,isVerifying:!1}),i.jsx(Mc,{label:"Email",value:r.personal.email}),i.jsx(Mc,{label:"Mobile",value:r.personal.mobile}),i.jsx(Ec,{label:"Date of Birth",value:r.personal.dob,status:r.personal.verifiedStatus?.dob,isVerifying:!1}),i.jsx(Mc,{label:"Gender",value:r.personal.gender}),i.jsx(Ec,{label:"Aadhaar Number",value:r.personal.idProofNumber,status:r.personal.verifiedStatus?.idProofNumber,isVerifying:y==="verifying"})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Organization Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Mc,{label:"Site / Client",value:r.organization.organizationName}),i.jsx(Mc,{label:"Designation",value:r.organization.designation}),i.jsx(Mc,{label:"Department",value:r.organization.department}),i.jsx(Mc,{label:"Joining Date",value:r.organization.joiningDate})]})]}),i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Bank & Statutory Details"}),i.jsxs("dl",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-x-4 gap-y-6",children:[i.jsx(Ec,{label:"Account Holder",value:r.bank.accountHolderName,status:r.bank.verifiedStatus?.accountHolderName,isVerifying:y==="verifying"}),i.jsx(Ec,{label:"Account Number",value:"*".repeat(Math.max(0,r.bank.accountNumber.length-4))+r.bank.accountNumber.slice(-4),status:r.bank.verifiedStatus?.accountNumber,isVerifying:y==="verifying"}),i.jsx(Ec,{label:"IFSC Code",value:r.bank.ifscCode,status:r.bank.verifiedStatus?.ifscCode,isVerifying:y==="verifying"}),i.jsx(Mc,{label:"Bank Name",value:r.bank.bankName}),r.uan.hasPreviousPf&&i.jsx(Ec,{label:"UAN",value:r.uan.uanNumber,status:r.uan.verifiedStatus?.uanNumber,isVerifying:y==="verifying"}),r.esi.hasEsi&&i.jsx(Ec,{label:"ESI Number",value:r.esi.esiNumber,status:r.esi.verifiedStatus?.esiNumber,isVerifying:y==="verifying"})]})]}),r.uniforms.length>0&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Uniform Details"}),i.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:r.uniforms.map(D=>i.jsxs("div",{className:"bg-page p-3 rounded-md",children:[i.jsx("p",{className:"font-semibold text-sm",children:D.itemName}),i.jsxs("p",{className:"text-xs text-muted",children:["Size: ",D.sizeLabel," (",D.fit,")"]}),i.jsxs("p",{className:"text-xs text-muted",children:["Qty: ",D.quantity]})]},D.itemId))})]}),r.biometrics.signatureImage&&i.jsxs("section",{children:[i.jsx("h4",{className:"text-md font-semibold text-primary-text mb-4 border-b pb-2",children:"Biometrics"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Signature"}),i.jsx("div",{className:"mt-2 p-2 border rounded-lg inline-block bg-page",children:i.jsx("img",{src:r.biometrics.signatureImage.preview,alt:"Signature",className:"h-24"})})]}),C.length>0&&i.jsxs("div",{children:[i.jsx("h5",{className:"font-semibold text-primary-text",children:"Fingerprints Uploaded"}),i.jsx("ul",{className:"mt-2 list-disc list-inside text-sm text-muted columns-2",children:C.map(D=>i.jsx("li",{children:D},D))})]})]})]})]}),c.enabled&&i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Third-Party Verification"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Run a background check against official records."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is required before you can submit the application."}),y==="failed"&&i.jsx("p",{className:"text-sm text-red-600 mt-2",children:w}),y==="success"&&i.jsx("p",{className:"text-sm text-green-600 mt-2",children:w})]}),i.jsxs(ne,{onClick:P,isLoading:y==="verifying",disabled:y==="success",children:[y==="idle"&&i.jsxs(i.Fragment,{children:[i.jsx(ly,{className:"mr-2 h-4 w-4"})," Verify Details"]}),y==="verifying"&&"Verifying...",y==="failed"&&"Retry Verification",y==="success"&&i.jsxs(i.Fragment,{children:[i.jsx(Ki,{className:"mr-2 h-4 w-4"})," Verified"]})]})]})]}),i.jsxs("div",{className:"mt-8 pt-6 border-t",children:[i.jsx("h3",{className:"text-lg font-semibold text-primary-text mb-4",children:"Generate Official Forms"}),i.jsxs("div",{className:"p-4 bg-page rounded-lg flex flex-col sm:flex-row items-center justify-between gap-4",children:[i.jsxs("div",{className:"flex-1",children:[i.jsx("p",{className:"font-medium",children:"Generate and review the official PDF documents."}),i.jsx("p",{className:"text-sm text-muted",children:"This step is mandatory before final submission."})]}),r.formsGenerated?i.jsxs("div",{className:"flex items-center gap-2 font-semibold text-green-600",children:[i.jsx(Ki,{className:"h-5 w-5"}),i.jsx("span",{children:"Forms Generated & Confirmed"})]}):i.jsxs(ne,{onClick:O,children:[i.jsx(us,{className:"mr-2 h-4 w-4"})," Generate & Review Forms"]})]})]}),i.jsx("div",{className:"mt-8 pt-6 border-t",children:i.jsxs("div",{className:"flex items-start",children:[i.jsx("div",{className:"flex items-center h-5",children:i.jsx("input",{id:"confirmation",name:"confirmation",type:"checkbox",required:!0,className:"focus:ring-accent h-4 w-4 text-accent border-gray-300 rounded",disabled:!M})}),i.jsxs("div",{className:"ml-3 text-sm",children:[i.jsx("label",{htmlFor:"confirmation",className:`font-medium ${M?"text-gray-700":"text-gray-400"}`,children:"Declaration"}),i.jsx("p",{className:`${M?"text-muted":"text-gray-400"}`,children:"I hereby declare that the information provided is true and correct to the best of my knowledge."})]})]})})]})},Hn=({requiredPermission:n,children:e})=>{const{user:t,isInitialized:r}=jt(),{permissions:s}=ta();return r?t?(s[t.role]||[]).includes(n)?e?i.jsx(i.Fragment,{children:e}):i.jsx(_f,{}):i.jsx(bl,{to:"/forbidden",replace:!0}):i.jsx(bl,{to:"/auth/login",replace:!0}):null},dfe=({onIdle:n,idleTimeout:e,promptTimeout:t,disabled:r=!1})=>{const[s,a]=E.useState(!1),[o,l]=E.useState(t),c=E.useRef(null),d=E.useRef(null),h=E.useRef(null),p=["mousemove","keydown","mousedown","scroll","touchstart"],x=E.useCallback(()=>{r||(a(!1),l(t),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current),c.current=window.setTimeout(()=>{a(!0)},e))},[e,t,r]);return E.useEffect(()=>{if(!r)return s&&(d.current=window.setTimeout(n,t),h.current=window.setInterval(()=>{l(y=>Math.max(0,y-1e3))},1e3)),()=>{d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[s,n,t,r]),E.useEffect(()=>{if(r)return;const y=()=>x();return p.forEach(_=>{window.addEventListener(_,y)}),x(),()=>{p.forEach(_=>{window.removeEventListener(_,y)}),c.current&&clearTimeout(c.current),d.current&&clearTimeout(d.current),h.current&&clearInterval(h.current)}},[x,r]),{isIdle:s,countdown:o,reset:x}},ufe=1800*1e3,ffe=120*1e3,hfe=()=>{const{logout:n}=jt(),e=St(),t=()=>{n(),e("/auth/login",{replace:!0})},r=Rt("(max-width: 768px)"),{isIdle:s,countdown:a,reset:o}=dfe({onIdle:t,idleTimeout:ufe,promptTimeout:ffe,disabled:r});return s?i.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center bg-black bg-opacity-70 backdrop-blur-sm","aria-modal":"true",role:"dialog",children:i.jsxs("div",{className:"bg-card rounded-xl shadow-card p-6 w-full max-w-md m-4 text-center animate-fade-in-scale",children:[i.jsx(u3,{className:"h-16 w-16 text-yellow-500 mx-auto mb-4"}),i.jsx("h3",{className:"text-xl font-bold text-primary-text",children:"Are you still there?"}),i.jsx("p",{className:"mt-2 text-muted",children:"For your security, you will be logged out due to inactivity."}),i.jsx("div",{className:"my-6 text-4xl font-bold text-accent",children:Math.ceil(a/1e3)}),i.jsx("p",{className:"text-sm text-muted mb-6",children:"Click the button below to stay logged in."}),i.jsx("div",{className:"flex justify-center gap-4",children:i.jsx(ne,{onClick:o,variant:"primary",size:"lg",children:"Stay Logged In"})})]})}):null},mfe=()=>{const{pathname:n}=Zr();return E.useEffect(()=>{window.scrollTo(0,0);const e=document.querySelector("main");e&&e.scrollTo(0,0);const t=document.getElementById("root");t&&t.scrollTo(0,0)},[n]),null},pfe=()=>{const{theme:n,isAutomatic:e,_setThemeInternal:t}=ed(),{colorScheme:r}=an(),s=Rt("(max-width: 767px)");return E.useEffect(()=>{const a=document.body;let o="light";e?s?o=r==="blue"?"light":"dark":o="light":o=n,t(o),o==="dark"?a.classList.add("pro-dark-theme"):a.classList.remove("pro-dark-theme")},[n,e,s,t,r]),null},gfe=()=>{const{colorScheme:n}=an();return E.useEffect(()=>{const e=document.body;e.classList.remove("blue-theme","green-theme","purple-theme","red-theme","amber-theme"),e.classList.add(`${n}-theme`)},[n]),null},px="app:lastPath",xfe=["/auth","/splash","/pending-approval","/forbidden"],n1=n=>n==="/"||n==="/#"||n==="/index.html"?!1:!xfe.some(e=>n.startsWith(e)),yfe=()=>{const{user:n,isInitialized:e}=jt(),t=Zr(),r=Rt("(max-width: 767px)");return e?n?n.role==="unverified"?i.jsx(bl,{to:"/pending-approval",replace:!0}):i.jsx(xQ,{children:r?i.jsx(GJ,{}):i.jsx(HJ,{})}):(n1(t.pathname+t.search)&&localStorage.setItem(px,t.pathname+t.search),i.jsx(bl,{to:"/auth/login",replace:!0})):null},vfe=()=>{const{user:n,isInitialized:e,setUser:t,setInitialized:r,resetAttendance:s,setLoading:a,isLoginAnimationPending:o}=jt(),{init:l}=td(),{initRoles:c}=ta(),{initSettings:d}=yi(),h=St(),p=Zr();return E.useEffect(()=>{n&&n1(p.pathname+p.search)&&localStorage.setItem(px,p.pathname+p.search)},[n,p.pathname,p.search]),E.useEffect(()=>{let x=!0;const y=setTimeout(()=>{x&&(console.warn("App initialization is taking too long. Proceeding without a session."),a(!1),r(!0))},3e4);(async()=>{a(!0);try{let{data:{session:j},error:C}=await Me.auth.getSession();if(C&&console.error("Error fetching initial session:",C.message),!j){const P=localStorage.getItem("supabase.auth.rememberMe");if(P){console.log("Attempting to restore session from long-term token...");try{const{data:O,error:M}=await Me.auth.setSession({refresh_token:P});M?(console.error("Failed to restore session from long-term token:",M.message),localStorage.removeItem("supabase.auth.rememberMe")):j=O.session}catch(O){console.error("Exception while restoring session from long-term token:",O)}}}if(j)try{const P=await Ca.getAppUserProfile(j.user);x&&t(P)}catch(P){console.error("Failed to fetch user profile during initialization:",P),x&&(t(null),s())}else x&&(t(null),s())}catch(j){console.error("Error during app initialization:",j),x&&(t(null),s())}finally{clearTimeout(y),x&&(a(!1),r(!0))}})();const{data:{subscription:w}}=Me.auth.onAuthStateChange((j,C)=>{if(j==="PASSWORD_RECOVERY"){h("/auth/update-password",{replace:!0});return}C?.user?setTimeout(async()=>{try{const P=await Ca.getAppUserProfile(C.user);if(x&&(t(P),P))try{const O=`greetingSent_${P.id}`;localStorage.getItem(O)||(await ue.createNotification({userId:P.id,message:`Good morning, ${P.name||"there"}! Welcome to Paradigm Services.`,type:"greeting"}),localStorage.setItem(O,"1"))}catch(O){console.error("Failed to send login greeting notification",O)}}catch(P){console.error("Failed to fetch user profile after auth change:",P),x&&(t(null),s(),Yn.getState().reset())}},0):x&&(t(null),s(),Yn.getState().reset())});return()=>{x=!1,w?.unsubscribe(),clearTimeout(y)}},[t,r,s,a]),E.useEffect(()=>{n&&e&&((async()=>{try{const{settings:y,roles:_,holidays:w}=await ue.getInitialAppData(),j=await ue.getRecurringHolidays();y.enrollmentRules&&l(y.enrollmentRules),_&&c(_),y.attendanceSettings&&w&&d({holidays:w,attendanceSettings:y.attendanceSettings,recurringHolidays:j||[]})}catch(y){console.error("Failed to load initial application data:",y)}})(),jt.getState().checkAttendanceStatus())},[n,e,l,c,d]),E.useEffect(()=>{if(e&&p.pathname!=="/auth/update-password"&&n&&!o&&(p.pathname.startsWith("/auth")&&p.pathname!=="/auth/logout"||p.pathname==="/"||p.pathname==="/splash")){const x=localStorage.getItem(px);x&&n1(x)&&x!=="/"&&x!=="/#"?(localStorage.removeItem(px),h(x,{replace:!0})):n.role==="unverified"?h("/pending-approval",{replace:!0}):h("/profile",{replace:!0})}},[e,n,p.pathname,h,o]),e?i.jsxs(i.Fragment,{children:[i.jsx(mfe,{}),i.jsx(pfe,{}),i.jsx(gfe,{}),n&&i.jsx(hfe,{}),i.jsxs(Iz,{children:[i.jsxs($e,{path:"/auth",element:i.jsx(KJ,{}),children:[i.jsx($e,{index:!0,element:i.jsx(bl,{to:"login",replace:!0})}),i.jsx($e,{path:"login",element:i.jsx(NX,{})}),i.jsx($e,{path:"signup",element:i.jsx(CX,{})}),i.jsx($e,{path:"forgot-password",element:i.jsx(kX,{})}),i.jsx($e,{path:"update-password",element:i.jsx(EX,{})}),i.jsx($e,{path:"logout",element:i.jsx(DX,{})})]}),i.jsx($e,{path:"/pending-approval",element:n&&n.role==="unverified"?i.jsx(OX,{}):i.jsx(bl,{to:"/auth/login",replace:!0})}),i.jsx($e,{path:"/forbidden",element:i.jsx(IX,{})}),i.jsxs($e,{path:"/",element:i.jsx(XJ,{children:i.jsx(yfe,{})}),children:[i.jsx($e,{index:!0,element:i.jsx(bl,{to:"/profile",replace:!0})}),i.jsx($e,{path:"profile",element:i.jsx(kse,{})}),i.jsx($e,{path:"mobile-home",element:i.jsx(bQ,{})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"create_enrollment"}),children:[i.jsx($e,{path:"onboarding",element:i.jsx(AX,{})}),i.jsx($e,{path:"onboarding/select-organization",element:i.jsx(RX,{})}),i.jsx($e,{path:"onboarding/pre-upload",element:i.jsx(cue,{})}),i.jsx($e,{path:"onboarding/submissions",element:i.jsx(fue,{})}),i.jsx($e,{path:"onboarding/tasks",element:i.jsx(mue,{})}),i.jsx($e,{path:"onboarding/uniforms",element:i.jsx(xue,{})}),i.jsxs($e,{path:"onboarding/add",element:i.jsx(LX,{}),children:[i.jsx($e,{path:"personal",element:i.jsx(Bue,{})}),i.jsx($e,{path:"address",element:i.jsx(Wue,{})}),i.jsx($e,{path:"organization",element:i.jsx(Hue,{})}),i.jsx($e,{path:"family",element:i.jsx(Yue,{})}),i.jsx($e,{path:"education",element:i.jsx(Gue,{})}),i.jsx($e,{path:"bank",element:i.jsx(Jue,{})}),i.jsx($e,{path:"uan",element:i.jsx(Xue,{})}),i.jsx($e,{path:"esi",element:i.jsx(tfe,{})}),i.jsx($e,{path:"gmc",element:i.jsx(rfe,{})}),i.jsx($e,{path:"uniform",element:i.jsx(sfe,{})}),i.jsx($e,{path:"documents",element:i.jsx(ife,{})}),i.jsx($e,{path:"biometrics",element:i.jsx(lfe,{})}),i.jsx($e,{path:"review",element:i.jsx(cfe,{})})]}),i.jsx($e,{path:"onboarding/pdf/:id",element:i.jsx(Ude,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_all_submissions"}),children:i.jsx($e,{path:"verification/dashboard",element:i.jsx(UX,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_users"}),children:[i.jsx($e,{path:"admin/users",element:i.jsx(WX,{})}),i.jsx($e,{path:"admin/users/add",element:i.jsx(YL,{})}),i.jsx($e,{path:"admin/users/edit/:id",element:i.jsx(YL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_sites"}),children:[i.jsx($e,{path:"admin/sites",element:i.jsx(dse,{})}),i.jsx($e,{path:"admin/sites/add",element:i.jsx(Fue,{})}),i.jsx($e,{path:"admin/sites/quick-add",element:i.jsx(que,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_roles_and_permissions"}),children:[i.jsx($e,{path:"admin/roles",element:i.jsx(fse,{})}),i.jsx($e,{path:"admin/roles/add",element:i.jsx(GL,{})}),i.jsx($e,{path:"admin/roles/edit/:id",element:i.jsx(GL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_modules"}),children:[i.jsx($e,{path:"admin/modules",element:i.jsx(gse,{})}),i.jsx($e,{path:"admin/modules/add",element:i.jsx(Rue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_approval_workflow"}),children:[i.jsx($e,{path:"admin/approval-workflow",element:i.jsx(qce,{})}),i.jsx($e,{path:"admin/approval-workflow/chart",element:i.jsx(zce,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_developer_settings"}),children:i.jsx($e,{path:"developer/api",element:i.jsx(wse,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_operations_dashboard"}),children:[i.jsx($e,{path:"operations/dashboard",element:i.jsx(jse,{})}),i.jsx($e,{path:"operations/team-activity",element:i.jsx(Nse,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_site_dashboard"}),children:i.jsx($e,{path:"site/dashboard",element:i.jsx(Cse,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_own_attendance"}),children:[i.jsx($e,{path:"attendance/dashboard",element:i.jsx(wce,{})}),i.jsx($e,{path:"attendance/locations",element:i.jsx(Nce,{})}),i.jsx($e,{path:"attendance/check-in",element:i.jsx(qL,{})}),i.jsx($e,{path:"attendance/check-out",element:i.jsx(qL,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"apply_for_leave"}),children:i.jsx($e,{path:"leaves/dashboard",element:i.jsx(Oce,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx($e,{path:"hr/attendance-settings",element:i.jsx(Sce,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_leave_requests"}),children:[i.jsx($e,{path:"hr/leave-management",element:i.jsx(Lce,{})}),i.jsx($e,{path:"hr/leave-management/grant-comp-off",element:i.jsx(Aue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"view_entity_management"}),children:[i.jsx($e,{path:"hr/entities",element:i.jsx(Ode,{})}),i.jsx($e,{path:"hr/entity-management/add-group",element:i.jsx(Iue,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_policies"}),children:[i.jsx($e,{path:"hr/policies-and-insurance",element:i.jsx(qde,{})}),i.jsx($e,{path:"hr/policies/add",element:i.jsx(Eue,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_enrollment_rules"}),children:i.jsx($e,{path:"hr/enrollment-rules",element:i.jsx(zde,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_field_officer_tracking"}),children:i.jsx($e,{path:"hr/field-officer-tracking",element:i.jsx(rue,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"manage_attendance_rules"}),children:i.jsx($e,{path:"hr/locations",element:i.jsx(iue,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_uniforms"}),children:[i.jsx($e,{path:"uniforms",element:i.jsx(Wde,{})}),i.jsx($e,{path:"uniforms/request/new",element:i.jsx(KL,{})}),i.jsx($e,{path:"uniforms/request/edit/:id",element:i.jsx(KL,{})})]}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_verification_costing"}),children:i.jsx($e,{path:"billing/cost-analysis",element:i.jsx(Yde,{})})}),i.jsx($e,{element:i.jsx(Hn,{requiredPermission:"view_invoice_summary"}),children:i.jsx($e,{path:"billing/summary",element:i.jsx(Kde,{})})}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"manage_tasks"}),children:[i.jsx($e,{path:"tasks",element:i.jsx(Wce,{})}),i.jsx($e,{path:"tasks/add",element:i.jsx(ZL,{})}),i.jsx($e,{path:"tasks/edit/:id",element:i.jsx(ZL,{})})]}),i.jsxs($e,{element:i.jsx(Hn,{requiredPermission:"access_support_desk"}),children:[i.jsx($e,{path:"support",element:i.jsx(wue,{})}),i.jsx($e,{path:"support/ticket/new",element:i.jsx(Oue,{})}),i.jsx($e,{path:"support/ticket/:id",element:i.jsx(kue,{})})]})]}),i.jsx($e,{path:"*",element:i.jsx(bl,{to:"/",replace:!0})})]})]}):i.jsx(vQ,{})},X6=document.getElementById("root");if(!X6)throw new Error("Could not find root element to mount to");const bfe=Vq.createRoot(X6);bfe.render(i.jsx(ot.StrictMode,{children:i.jsx(Vz,{children:i.jsx(vfe,{})})}));export{HM as E,O1 as W,Nf as _,bu as a,oQ as b,wfe as c,XL as g};
